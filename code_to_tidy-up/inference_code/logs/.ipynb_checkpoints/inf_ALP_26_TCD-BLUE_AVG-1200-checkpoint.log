unload conda/22.11.1  : OK 
load conda/22.11.1  : OK 
envs_dirs : /work/scratch/env/barrouz/conda_env/
pkgs_dirs : /work/scratch/env/barrouz/pkgs_conda
INPUT_PATH /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/26.txt
OUTPUT_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
DEM_PATH /work/CAMPUS/etudes/Neige/DEM
TCD_PATH /work/datalake/static_aux/TreeCoverDensity
MODELS_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
KEEP_REFL 0
MASK 1
start
/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/26.txt
muscate/SPOTWORLDHERITAGE/2004/12/30/SPOT4-HRVIR1-XS_20041230-105954-938_L1C_049-259-5_D_V1-0/SPOT4-HRVIR1-XS_20041230-105954-938_L1C_049-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20041230-105954-938_L1C_049-259-5_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041230-105954-938_L1C_049-259-5_D_V1-0.zip
run script
2024-01-09T18:52:42.317    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:52:42.319    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041230-105954-938_L1C_049-259-5_D_V1-0.zip
2024-01-09T18:52:42.319    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:52:42.319    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:52:42.320    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:52:42.320    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:52:42.320    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:52:42.320    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:52:42.320    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:52:42.320    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041230-105954-938_L1C_049-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2004/12/31/SPOT4-HRVIR2-XS_20041231-104035-966_L1C_049-259-3_D_V1-0/SPOT4-HRVIR2-XS_20041231-104035-966_L1C_049-259-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20041231-104035-966_L1C_049-259-3_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20041231-104035-966_L1C_049-259-3_D_V1-0.zip
run script
2024-01-09T18:53:10.330    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:53:10.331    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20041231-104035-966_L1C_049-259-3_D_V1-0.zip
2024-01-09T18:53:10.331    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:53:10.331    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:53:10.331    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:53:10.331    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:53:10.331    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:53:10.331    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:53:10.332    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:53:10.332    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20041231-104035-966_L1C_049-259-3_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 1 0 0]
 [1 1 1 ... 1 0 0]
 [1 1 1 ... 1 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2004/12/31/SPOT4-HRVIR2-XS_20041231-104037-771_L1C_049-259-5_D_V1-0/SPOT4-HRVIR2-XS_20041231-104037-771_L1C_049-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20041231-104037-771_L1C_049-259-5_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20041231-104037-771_L1C_049-259-5_D_V1-0.zip
run script
2024-01-09T18:53:27.438    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:53:27.439    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20041231-104037-771_L1C_049-259-5_D_V1-0.zip
2024-01-09T18:53:27.439    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:53:27.439    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:53:27.439    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:53:27.439    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:53:27.439    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:53:27.439    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:53:27.439    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:53:27.439    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20041231-104037-771_L1C_049-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2004/09/07/SPOT4-HRVIR1-XS_20040907-105144-759_L1C_049-261-8_D_V1-0/SPOT4-HRVIR1-XS_20040907-105144-759_L1C_049-261-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20040907-105144-759_L1C_049-261-8_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20040907-105144-759_L1C_049-261-8_D_V1-0.zip
run script
2024-01-09T18:53:40.675    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:53:40.676    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20040907-105144-759_L1C_049-261-8_D_V1-0.zip
2024-01-09T18:53:40.676    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:53:40.676    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:53:40.676    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:53:40.676    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:53:40.676    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:53:40.676    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:53:40.676    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:53:40.676    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20040907-105144-759_L1C_049-261-8_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2004/09/07/SPOT4-HRVIR1-XS_20040907-105145-908_L1C_049-262-0_D_V1-0/SPOT4-HRVIR1-XS_20040907-105145-908_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20040907-105145-908_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20040907-105145-908_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T18:53:43.781    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:53:43.782    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20040907-105145-908_L1C_049-262-0_D_V1-0.zip
2024-01-09T18:53:43.782    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:53:43.782    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:53:43.782    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:53:43.782    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:53:43.782    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:53:43.782    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:53:43.783    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:53:43.783    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20040907-105145-908_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2004/04/16/SPOT4-HRVIR1-XS_20040416-101841-194_L1C_050-254-5_D_V1-0/SPOT4-HRVIR1-XS_20040416-101841-194_L1C_050-254-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20040416-101841-194_L1C_050-254-5_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20040416-101841-194_L1C_050-254-5_D_V1-0.zip
run script
2024-01-09T18:53:47.039    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:53:47.040    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20040416-101841-194_L1C_050-254-5_D_V1-0.zip
2024-01-09T18:53:47.040    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:53:47.040    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:53:47.040    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:53:47.040    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:53:47.040    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:53:47.040    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:53:47.040    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:53:47.040    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20040416-101841-194_L1C_050-254-5_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2004/07/02/SPOT4-HRVIR1-XS_20040702-103820-151_L1C_050-254-0_D_V1-0/SPOT4-HRVIR1-XS_20040702-103820-151_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20040702-103820-151_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20040702-103820-151_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T18:53:50.297    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:53:50.298    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20040702-103820-151_L1C_050-254-0_D_V1-0.zip
2024-01-09T18:53:50.298    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:53:50.298    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:53:50.298    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:53:50.298    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:53:50.298    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:53:50.298    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:53:50.298    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:53:50.298    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20040702-103820-151_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2004/07/02/SPOT4-HRVIR1-XS_20040702-103825-565_L1C_050-254-6_D_V1-0/SPOT4-HRVIR1-XS_20040702-103825-565_L1C_050-254-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20040702-103825-565_L1C_050-254-6_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20040702-103825-565_L1C_050-254-6_D_V1-0.zip
run script
2024-01-09T18:53:53.729    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:53:53.730    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20040702-103825-565_L1C_050-254-6_D_V1-0.zip
2024-01-09T18:53:53.730    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:53:53.730    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:53:53.730    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:53:53.730    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:53:53.730    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:53:53.731    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:53:53.731    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:53:53.731    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T18:53:55.647    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 184). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20040702-103825-565_L1C_050-254-6_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2004/07/02/SPOT4-HRVIR2-XS_20040702-103916-641_L1C_050-260-8_D_V1-0/SPOT4-HRVIR2-XS_20040702-103916-641_L1C_050-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20040702-103916-641_L1C_050-260-8_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20040702-103916-641_L1C_050-260-8_D_V1-0.zip
run script
2024-01-09T18:53:58.907    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:53:58.907    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20040702-103916-641_L1C_050-260-8_D_V1-0.zip
2024-01-09T18:53:58.907    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:53:58.907    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:53:58.907    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:53:58.907    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:53:58.908    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:53:58.908    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:53:58.908    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:53:58.908    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20040702-103916-641_L1C_050-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2004/07/02/SPOT4-HRVIR2-XS_20040702-103917-739_L1C_050-261-0_D_V1-0/SPOT4-HRVIR2-XS_20040702-103917-739_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20040702-103917-739_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20040702-103917-739_L1C_050-261-0_D_V1-0.zip
run script
2024-01-09T18:55:36.012    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:55:36.013    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20040702-103917-739_L1C_050-261-0_D_V1-0.zip
2024-01-09T18:55:36.014    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:55:36.014    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:55:36.014    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:55:36.014    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:55:36.015    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:55:36.015    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:55:36.015    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:55:36.015    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20040702-103917-739_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2004/07/02/SPOT4-HRVIR2-XS_20040702-103926-065_L1C_050-262-0_D_V1-0/SPOT4-HRVIR2-XS_20040702-103926-065_L1C_050-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20040702-103926-065_L1C_050-262-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20040702-103926-065_L1C_050-262-0_D_V1-0.zip
run script
2024-01-09T18:57:20.817    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:57:20.818    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20040702-103926-065_L1C_050-262-0_D_V1-0.zip
2024-01-09T18:57:20.818    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:57:20.818    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:57:20.819    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:57:20.819    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:57:20.819    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:57:20.819    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:57:20.819    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:57:20.819    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20040702-103926-065_L1C_050-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2004/07/02/SPOT4-HRVIR2-XS_20040702-103934-187_L1C_050-262-9_D_V1-0/SPOT4-HRVIR2-XS_20040702-103934-187_L1C_050-262-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20040702-103934-187_L1C_050-262-9_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20040702-103934-187_L1C_050-262-9_D_V1-0.zip
run script
2024-01-09T18:58:43.254    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:58:43.255    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20040702-103934-187_L1C_050-262-9_D_V1-0.zip
2024-01-09T18:58:43.255    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:58:43.255    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:58:43.255    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:58:43.256    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:58:43.256    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:58:43.256    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:58:43.256    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:58:43.256    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20040702-103934-187_L1C_050-262-9_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2004/11/08/SPOT4-HRVIR1-XS_20041108-105921-249_L1C_050-257-9_D_V1-0/SPOT4-HRVIR1-XS_20041108-105921-249_L1C_050-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20041108-105921-249_L1C_050-257-9_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041108-105921-249_L1C_050-257-9_D_V1-0.zip
run script
2024-01-09T18:59:14.283    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:59:14.284    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041108-105921-249_L1C_050-257-9_D_V1-0.zip
2024-01-09T18:59:14.284    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:59:14.285    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:59:14.285    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:59:14.285    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:59:14.285    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:59:14.285    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:59:14.285    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:59:14.285    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T19:02:19.491    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 53). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041108-105921-249_L1C_050-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2004/11/08/SPOT4-HRVIR1-XS_20041108-105921-556_L1C_050-258-0_D_V1-0/SPOT4-HRVIR1-XS_20041108-105921-556_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20041108-105921-556_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041108-105921-556_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T19:02:22.706    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:02:22.707    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041108-105921-556_L1C_050-258-0_D_V1-0.zip
2024-01-09T19:02:22.707    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:02:22.708    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:02:22.708    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:02:22.708    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:02:22.708    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:02:22.708    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:02:22.708    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:02:22.708    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T19:04:50.411    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 990). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041108-105921-556_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2004/11/08/SPOT4-HRVIR1-XS_20041108-105926-971_L1C_050-258-6_D_V1-0/SPOT4-HRVIR1-XS_20041108-105926-971_L1C_050-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20041108-105926-971_L1C_050-258-6_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041108-105926-971_L1C_050-258-6_D_V1-0.zip
run script
2024-01-09T19:04:53.724    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:04:53.725    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041108-105926-971_L1C_050-258-6_D_V1-0.zip
2024-01-09T19:04:53.725    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:04:53.725    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:04:53.725    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:04:53.725    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:04:53.725    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:04:53.725    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:04:53.725    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:04:53.725    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041108-105926-971_L1C_050-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2004/11/13/SPOT4-HRVIR1-XS_20041113-110311-869_L1C_050-257-7_D_V1-0/SPOT4-HRVIR1-XS_20041113-110311-869_L1C_050-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20041113-110311-869_L1C_050-257-7_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041113-110311-869_L1C_050-257-7_D_V1-0.zip
run script
2024-01-09T19:07:31.079    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:07:31.080    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041113-110311-869_L1C_050-257-7_D_V1-0.zip
2024-01-09T19:07:31.080    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:07:31.081    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:07:31.081    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:07:31.081    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:07:31.081    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:07:31.081    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:07:31.081    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:07:31.081    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041113-110311-869_L1C_050-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2004/11/13/SPOT4-HRVIR1-XS_20041113-110314-014_L1C_050-258-0_D_V1-0/SPOT4-HRVIR1-XS_20041113-110314-014_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20041113-110314-014_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041113-110314-014_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T19:11:30.762    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:11:30.764    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041113-110314-014_L1C_050-258-0_D_V1-0.zip
2024-01-09T19:11:30.764    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:11:30.764    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:11:30.764    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:11:30.764    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:11:30.764    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:11:30.764    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:11:30.764    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:11:30.764    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T19:15:08.337    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 132). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041113-110314-014_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 2 ... 2 2 2]
 [1 2 2 ... 2 2 2]
 [1 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2004/11/13/SPOT4-HRVIR1-XS_20041113-110322-479_L1C_050-259-0_D_V1-0/SPOT4-HRVIR1-XS_20041113-110322-479_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20041113-110322-479_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041113-110322-479_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T19:15:11.884    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:15:11.885    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041113-110322-479_L1C_050-259-0_D_V1-0.zip
2024-01-09T19:15:11.885    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:15:11.886    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:15:11.886    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:15:11.886    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:15:11.886    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:15:11.886    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:15:11.886    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:15:11.886    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T19:17:35.071    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (107 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041113-110322-479_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2004/11/13/SPOT4-HRVIR1-XS_20041113-110324-283_L1C_050-259-2_D_V1-0/SPOT4-HRVIR1-XS_20041113-110324-283_L1C_050-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20041113-110324-283_L1C_050-259-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041113-110324-283_L1C_050-259-2_D_V1-0.zip
run script
2024-01-09T19:17:38.360    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:17:38.361    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041113-110324-283_L1C_050-259-2_D_V1-0.zip
2024-01-09T19:17:38.362    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:17:38.362    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:17:38.362    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:17:38.362    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:17:38.362    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:17:38.362    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:17:38.362    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:17:38.362    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041113-110324-283_L1C_050-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2004/12/05/SPOT4-HRVIR2-XS_20041205-104006-088_L1C_050-257-4_D_V1-0/SPOT4-HRVIR2-XS_20041205-104006-088_L1C_050-257-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20041205-104006-088_L1C_050-257-4_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20041205-104006-088_L1C_050-257-4_D_V1-0.zip
run script
2024-01-09T19:19:55.181    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:19:55.182    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20041205-104006-088_L1C_050-257-4_D_V1-0.zip
2024-01-09T19:19:55.183    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:19:55.183    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:19:55.183    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:19:55.183    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:19:55.183    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:19:55.183    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:19:55.183    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:19:55.183    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20041205-104006-088_L1C_050-257-4_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 2 2]
 [2 2 2 ... 1 2 2]
 [2 2 2 ... 1 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2004/12/05/SPOT4-HRVIR2-XS_20041205-104010-772_L1C_050-258-0_D_V1-0/SPOT4-HRVIR2-XS_20041205-104010-772_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20041205-104010-772_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20041205-104010-772_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T19:22:57.047    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:22:57.048    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20041205-104010-772_L1C_050-258-0_D_V1-0.zip
2024-01-09T19:22:57.048    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:22:57.048    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:22:57.048    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:22:57.048    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:22:57.048    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:22:57.048    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:22:57.048    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:22:57.048    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T19:24:52.452    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 438). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20041205-104010-772_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2004/12/05/SPOT4-HRVIR2-XS_20041205-104014-381_L1C_050-258-4_D_V1-0/SPOT4-HRVIR2-XS_20041205-104014-381_L1C_050-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20041205-104014-381_L1C_050-258-4_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20041205-104014-381_L1C_050-258-4_D_V1-0.zip
run script
2024-01-09T19:24:55.692    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:24:55.693    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20041205-104014-381_L1C_050-258-4_D_V1-0.zip
2024-01-09T19:24:55.693    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:24:55.693    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:24:55.693    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:24:55.693    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:24:55.694    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:24:55.694    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:24:55.694    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:24:55.694    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T19:26:52.797    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 48). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20041205-104014-381_L1C_050-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2004/12/10/SPOT4-HRVIR1-XS_20041210-104403-486_L1C_050-257-7_D_V1-0/SPOT4-HRVIR1-XS_20041210-104403-486_L1C_050-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20041210-104403-486_L1C_050-257-7_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041210-104403-486_L1C_050-257-7_D_V1-0.zip
run script
2024-01-09T19:26:56.342    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:26:56.343    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041210-104403-486_L1C_050-257-7_D_V1-0.zip
2024-01-09T19:26:56.343    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:26:56.343    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:26:56.343    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:26:56.343    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:26:56.343    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:26:56.343    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:26:56.343    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:26:56.343    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041210-104403-486_L1C_050-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2004/12/10/SPOT4-HRVIR1-XS_20041210-104405-483_L1C_050-258-0_D_V1-0/SPOT4-HRVIR1-XS_20041210-104405-483_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20041210-104405-483_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041210-104405-483_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T19:29:39.839    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:29:39.840    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041210-104405-483_L1C_050-258-0_D_V1-0.zip
2024-01-09T19:29:39.840    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:29:39.840    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:29:39.840    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:29:39.840    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:29:39.840    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:29:39.841    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:29:39.841    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:29:39.841    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T19:31:41.769    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 219). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041210-104405-483_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2004/12/10/SPOT4-HRVIR1-XS_20041210-104409-093_L1C_050-258-4_D_V1-0/SPOT4-HRVIR1-XS_20041210-104409-093_L1C_050-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20041210-104409-093_L1C_050-258-4_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041210-104409-093_L1C_050-258-4_D_V1-0.zip
run script
2024-01-09T19:31:45.318    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:31:45.319    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041210-104409-093_L1C_050-258-4_D_V1-0.zip
2024-01-09T19:31:45.320    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:31:45.320    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:31:45.320    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:31:45.320    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:31:45.320    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:31:45.320    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:31:45.320    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:31:45.320    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T19:33:48.367    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 48). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041210-104409-093_L1C_050-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2004/11/03/SPOT4-HRVIR1-XS_20041103-105527-993_L1C_050-258-0_D_V1-0/SPOT4-HRVIR1-XS_20041103-105527-993_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20041103-105527-993_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041103-105527-993_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T19:33:51.862    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:33:51.863    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041103-105527-993_L1C_050-258-0_D_V1-0.zip
2024-01-09T19:33:51.863    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:33:51.863    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:33:51.863    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:33:51.863    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:33:51.863    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:33:51.863    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:33:51.863    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:33:51.863    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T19:36:10.991    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 474). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041103-105527-993_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2004/11/03/SPOT4-HRVIR1-XS_20041103-105535-212_L1C_050-258-8_D_V1-0/SPOT4-HRVIR1-XS_20041103-105535-212_L1C_050-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20041103-105535-212_L1C_050-258-8_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041103-105535-212_L1C_050-258-8_D_V1-0.zip
run script
2024-01-09T19:36:14.413    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:36:14.413    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041103-105535-212_L1C_050-258-8_D_V1-0.zip
2024-01-09T19:36:14.413    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:36:14.413    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:36:14.414    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:36:14.414    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:36:14.414    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:36:14.414    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:36:14.414    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:36:14.414    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T19:38:36.151    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (294 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20041103-105535-212_L1C_050-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2004/11/10/SPOT4-HRVIR2-XS_20041110-102046-072_L1C_050-258-2_D_V1-0/SPOT4-HRVIR2-XS_20041110-102046-072_L1C_050-258-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20041110-102046-072_L1C_050-258-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20041110-102046-072_L1C_050-258-2_D_V1-0.zip
run script
2024-01-09T19:38:39.843    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:38:39.845    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20041110-102046-072_L1C_050-258-2_D_V1-0.zip
2024-01-09T19:38:39.845    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:38:39.845    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:38:39.845    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:38:39.845    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:38:39.845    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:38:39.845    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:38:39.846    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:38:39.846    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20041110-102046-072_L1C_050-258-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2004/12/06/SPOT4-HRVIR2-XS_20041206-102051-063_L1C_050-258-0_D_V1-0/SPOT4-HRVIR2-XS_20041206-102051-063_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20041206-102051-063_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20041206-102051-063_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T19:41:58.448    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:41:58.449    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20041206-102051-063_L1C_050-258-0_D_V1-0.zip
2024-01-09T19:41:58.449    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:41:58.449    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:41:58.449    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:41:58.449    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:41:58.449    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:41:58.449    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:41:58.450    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:41:58.450    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T19:44:21.066    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 518). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20041206-102051-063_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2004/12/06/SPOT4-HRVIR2-XS_20041206-102052-868_L1C_050-258-2_D_V1-0/SPOT4-HRVIR2-XS_20041206-102052-868_L1C_050-258-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20041206-102052-868_L1C_050-258-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20041206-102052-868_L1C_050-258-2_D_V1-0.zip
run script
2024-01-09T19:44:24.479    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:44:24.480    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20041206-102052-868_L1C_050-258-2_D_V1-0.zip
2024-01-09T19:44:24.480    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:44:24.480    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:44:24.481    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:44:24.481    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:44:24.481    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:44:24.481    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:44:24.481    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:44:24.481    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20041206-102052-868_L1C_050-258-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2004/06/26/SPOT4-HRVIR2-XS_20040626-105342-388_L1C_051-254-0_D_V1-0/SPOT4-HRVIR2-XS_20040626-105342-388_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20040626-105342-388_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20040626-105342-388_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T19:47:04.451    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:47:04.453    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20040626-105342-388_L1C_051-254-0_D_V1-0.zip
2024-01-09T19:47:04.453    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:47:04.453    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:47:04.453    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:47:04.453    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:47:04.453    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:47:04.453    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:47:04.453    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:47:04.453    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20040626-105342-388_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2004/06/26/SPOT4-HRVIR2-XS_20040626-105346-900_L1C_051-254-5_D_V1-0/SPOT4-HRVIR2-XS_20040626-105346-900_L1C_051-254-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20040626-105346-900_L1C_051-254-5_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20040626-105346-900_L1C_051-254-5_D_V1-0.zip
run script
2024-01-09T19:47:07.975    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:47:07.975    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20040626-105346-900_L1C_051-254-5_D_V1-0.zip
2024-01-09T19:47:07.975    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:47:07.975    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:47:07.975    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:47:07.975    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:47:07.975    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:47:07.976    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:47:07.976    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:47:07.976    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T19:47:10.021    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 518). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20040626-105346-900_L1C_051-254-5_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2004/07/03/SPOT4-HRVIR1-XS_20040703-101858-864_L1C_051-254-0_D_V1-0/SPOT4-HRVIR1-XS_20040703-101858-864_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20040703-101858-864_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20040703-101858-864_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T19:47:13.392    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:47:13.393    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20040703-101858-864_L1C_051-254-0_D_V1-0.zip
2024-01-09T19:47:13.393    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:47:13.393    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:47:13.393    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:47:13.393    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:47:13.393    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:47:13.393    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:47:13.393    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:47:13.393    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR1-XS_20040703-101858-864_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2004/07/03/SPOT4-HRVIR2-XS_20040703-102002-991_L1C_051-261-6_D_V1-0/SPOT4-HRVIR2-XS_20040703-102002-991_L1C_051-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20040703-102002-991_L1C_051-261-6_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20040703-102002-991_L1C_051-261-6_D_V1-0.zip
run script
2024-01-09T19:47:16.891    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:47:16.891    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20040703-102002-991_L1C_051-261-6_D_V1-0.zip
2024-01-09T19:47:16.891    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:47:16.891    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:47:16.891    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:47:16.891    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:47:16.891    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:47:16.891    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:47:16.891    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:47:16.891    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20040703-102002-991_L1C_051-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2004/07/06/SPOT4-HRVIR2-XS_20040706-110128-100_L1C_051-254-0_D_V1-0/SPOT4-HRVIR2-XS_20040706-110128-100_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20040706-110128-100_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20040706-110128-100_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T19:49:06.920    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:49:06.921    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20040706-110128-100_L1C_051-254-0_D_V1-0.zip
2024-01-09T19:49:06.921    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:49:06.921    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:49:06.921    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:49:06.921    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:49:06.921    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:49:06.921    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:49:06.921    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:49:06.922    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20040706-110128-100_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2004/04/04/SPOT4-HRVIR2-XS_20040404-105041-388_L1C_051-261-5_D_V1-0/SPOT4-HRVIR2-XS_20040404-105041-388_L1C_051-261-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20040404-105041-388_L1C_051-261-5_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20040404-105041-388_L1C_051-261-5_D_V1-0.zip
run script
2024-01-09T19:49:10.089    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:49:10.089    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20040404-105041-388_L1C_051-261-5_D_V1-0.zip
2024-01-09T19:49:10.089    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:49:10.089    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:49:10.089    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:49:10.089    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:49:10.090    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:49:10.090    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:49:10.090    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:49:10.090    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT4-HRVIR2-XS_20040404-105041-388_L1C_051-261-5_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/01/27/SPOT1-HRV1-XS_19870127-103853-713_L1C_046-263-0_D_V1-0/SPOT1-HRV1-XS_19870127-103853-713_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19870127-103853-713_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870127-103853-713_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T19:50:58.679    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:50:58.680    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870127-103853-713_L1C_046-263-0_D_V1-0.zip
2024-01-09T19:50:58.680    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:50:58.680    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:50:58.680    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:50:58.681    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:50:58.681    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:50:58.681    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:50:58.681    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:50:58.681    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870127-103853-713_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/01/31/SPOT1-HRV1-XS_19870131-110201-230_L1C_046-263-0_D_V1-0/SPOT1-HRV1-XS_19870131-110201-230_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19870131-110201-230_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870131-110201-230_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T19:51:19.159    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:51:19.160    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870131-110201-230_L1C_046-263-0_D_V1-0.zip
2024-01-09T19:51:19.160    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:51:19.160    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:51:19.160    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:51:19.160    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:51:19.160    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:51:19.160    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:51:19.161    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:51:19.161    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870131-110201-230_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/01/31/SPOT1-HRV2-XS_19870131-110132-452_L1C_049-260-0_D_V1-0/SPOT1-HRV2-XS_19870131-110132-452_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19870131-110132-452_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870131-110132-452_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T19:51:46.540    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:51:46.541    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870131-110132-452_L1C_049-260-0_D_V1-0.zip
2024-01-09T19:51:46.541    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:51:46.541    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:51:46.541    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:51:46.541    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:51:46.541    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:51:46.541    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:51:46.541    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:51:46.541    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870131-110132-452_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/01/31/SPOT1-HRV2-XS_19870131-110140-905_L1C_049-261-0_D_V1-0/SPOT1-HRV2-XS_19870131-110140-905_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19870131-110140-905_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870131-110140-905_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T19:52:13.245    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:52:13.247    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870131-110140-905_L1C_049-261-0_D_V1-0.zip
2024-01-09T19:52:13.247    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:52:13.247    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:52:13.247    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:52:13.247    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:52:13.247    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:52:13.247    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:52:13.247    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:52:13.247    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870131-110140-905_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1987/01/31/SPOT1-HRV2-XS_19870131-110149-363_L1C_049-262-0_D_V1-0/SPOT1-HRV2-XS_19870131-110149-363_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19870131-110149-363_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870131-110149-363_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T19:52:16.448    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:52:16.449    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870131-110149-363_L1C_049-262-0_D_V1-0.zip
2024-01-09T19:52:16.450    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:52:16.450    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:52:16.450    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:52:16.450    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:52:16.450    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:52:16.450    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:52:16.450    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:52:16.450    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870131-110149-363_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1987/09/28/SPOT1-HRV2-XS_19870928-104638-802_L1C_046-263-0_D_V1-0/SPOT1-HRV2-XS_19870928-104638-802_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19870928-104638-802_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870928-104638-802_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T19:52:19.366    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:52:19.366    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870928-104638-802_L1C_046-263-0_D_V1-0.zip
2024-01-09T19:52:19.366    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:52:19.366    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:52:19.366    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:52:19.366    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:52:19.366    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:52:19.366    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:52:19.366    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:52:19.366    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870928-104638-802_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/09/28/SPOT1-HRV2-XS_19870928-104543-485_L1C_050-257-0_D_V1-0/SPOT1-HRV2-XS_19870928-104543-485_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19870928-104543-485_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870928-104543-485_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T19:52:41.434    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:52:41.436    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870928-104543-485_L1C_050-257-0_D_V1-0.zip
2024-01-09T19:52:41.436    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:52:41.436    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:52:41.436    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:52:41.436    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:52:41.436    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:52:41.436    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:52:41.436    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:52:41.436    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870928-104543-485_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [1 1 0 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/09/28/SPOT1-HRV2-XS_19870928-104551-826_L1C_050-258-0_D_V1-0/SPOT1-HRV2-XS_19870928-104551-826_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19870928-104551-826_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870928-104551-826_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T19:56:21.719    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:56:21.720    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870928-104551-826_L1C_050-258-0_D_V1-0.zip
2024-01-09T19:56:21.720    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:56:21.720    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:56:21.720    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:56:21.720    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:56:21.720    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:56:21.720    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:56:21.720    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:56:21.720    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T19:58:29.053    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 222). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870928-104551-826_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1987/09/28/SPOT1-HRV2-XS_19870928-104600-174_L1C_050-259-0_D_V1-0/SPOT1-HRV2-XS_19870928-104600-174_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19870928-104600-174_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870928-104600-174_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T19:58:32.087    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:58:32.088    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870928-104600-174_L1C_050-259-0_D_V1-0.zip
2024-01-09T19:58:32.089    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:58:32.089    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:58:32.089    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:58:32.089    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:58:32.089    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:58:32.089    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:58:32.089    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:58:32.089    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870928-104600-174_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/09/28/SPOT1-HRV2-XS_19870928-104608-295_L1C_050-259-9_D_V1-0/SPOT1-HRV2-XS_19870928-104608-295_L1C_050-259-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19870928-104608-295_L1C_050-259-9_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870928-104608-295_L1C_050-259-9_D_V1-0.zip
run script
2024-01-09T20:01:11.191    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:01:11.193    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870928-104608-295_L1C_050-259-9_D_V1-0.zip
2024-01-09T20:01:11.193    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:01:11.193    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:01:11.193    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:01:11.193    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:01:11.193    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:01:11.193    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:01:11.193    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:01:11.193    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870928-104608-295_L1C_050-259-9_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/09/28/SPOT1-HRV2-XS_19870928-104518-504_L1C_051-254-0_D_V1-0/SPOT1-HRV2-XS_19870928-104518-504_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19870928-104518-504_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870928-104518-504_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T20:03:10.513    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:03:10.514    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870928-104518-504_L1C_051-254-0_D_V1-0.zip
2024-01-09T20:03:10.514    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:03:10.514    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:03:10.515    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:03:10.515    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:03:10.515    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:03:10.515    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:03:10.515    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:03:10.515    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870928-104518-504_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1987/09/28/SPOT1-HRV2-XS_19870928-104526-824_L1C_051-255-0_D_V1-0/SPOT1-HRV2-XS_19870928-104526-824_L1C_051-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19870928-104526-824_L1C_051-255-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870928-104526-824_L1C_051-255-0_D_V1-0.zip
run script
2024-01-09T20:03:13.566    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:03:13.568    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870928-104526-824_L1C_051-255-0_D_V1-0.zip
2024-01-09T20:03:13.568    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:03:13.568    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:03:13.568    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:03:13.568    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:03:13.568    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:03:13.568    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:03:13.568    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:03:13.568    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870928-104526-824_L1C_051-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/03/14/SPOT1-HRV1-XS_19870314-105241-443_L1C_047-254-9_D_V1-0/SPOT1-HRV1-XS_19870314-105241-443_L1C_047-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19870314-105241-443_L1C_047-254-9_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870314-105241-443_L1C_047-254-9_D_V1-0.zip
run script
2024-01-09T20:04:20.753    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:04:20.754    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870314-105241-443_L1C_047-254-9_D_V1-0.zip
2024-01-09T20:04:20.754    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:04:20.754    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:04:20.754    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:04:20.754    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:04:20.755    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:04:20.755    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:04:20.755    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:04:20.755    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870314-105241-443_L1C_047-254-9_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/03/10/SPOT1-HRV1-XS_19870310-102924-930_L1C_048-254-0_D_V1-0/SPOT1-HRV1-XS_19870310-102924-930_L1C_048-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19870310-102924-930_L1C_048-254-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870310-102924-930_L1C_048-254-0_D_V1-0.zip
run script
2024-01-09T20:04:33.395    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:04:33.396    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870310-102924-930_L1C_048-254-0_D_V1-0.zip
2024-01-09T20:04:33.396    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:04:33.396    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:04:33.396    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:04:33.396    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:04:33.396    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:04:33.397    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:04:33.397    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:04:33.397    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870310-102924-930_L1C_048-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1987/03/10/SPOT1-HRV1-XS_19870310-102933-139_L1C_048-255-0_D_V1-0/SPOT1-HRV1-XS_19870310-102933-139_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19870310-102933-139_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870310-102933-139_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T20:04:36.304    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:04:36.305    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870310-102933-139_L1C_048-255-0_D_V1-0.zip
2024-01-09T20:04:36.305    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:04:36.305    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:04:36.305    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:04:36.305    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:04:36.305    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:04:36.305    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:04:36.305    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:04:36.305    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870310-102933-139_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/03/10/SPOT1-HRV1-XS_19870310-102941-357_L1C_048-256-0_D_V1-0/SPOT1-HRV1-XS_19870310-102941-357_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19870310-102941-357_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870310-102941-357_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T20:04:56.152    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:04:56.154    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870310-102941-357_L1C_048-256-0_D_V1-0.zip
2024-01-09T20:04:56.154    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:04:56.154    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:04:56.154    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:04:56.154    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:04:56.154    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:04:56.154    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:04:56.154    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:04:56.154    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870310-102941-357_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/03/10/SPOT1-HRV1-XS_19870310-102949-587_L1C_048-257-0_D_V1-0/SPOT1-HRV1-XS_19870310-102949-587_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19870310-102949-587_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870310-102949-587_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T20:05:44.051    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:05:44.052    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870310-102949-587_L1C_048-257-0_D_V1-0.zip
2024-01-09T20:05:44.052    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:05:44.052    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:05:44.052    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:05:44.052    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:05:44.052    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:05:44.052    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:05:44.052    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:05:44.053    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870310-102949-587_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [1 0 0 ... 2 2 2]
 [1 0 0 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/03/10/SPOT1-HRV1-XS_19870310-102957-708_L1C_048-257-9_D_V1-0/SPOT1-HRV1-XS_19870310-102957-708_L1C_048-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19870310-102957-708_L1C_048-257-9_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870310-102957-708_L1C_048-257-9_D_V1-0.zip
run script
2024-01-09T20:06:14.167    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:06:14.167    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870310-102957-708_L1C_048-257-9_D_V1-0.zip
2024-01-09T20:06:14.167    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:06:14.167    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:06:14.167    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:06:14.167    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:06:14.167    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:06:14.167    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:06:14.167    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:06:14.168    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870310-102957-708_L1C_048-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/03/10/SPOT1-HRV1-XS_19870310-102957-826_L1C_048-258-0_D_V1-0/SPOT1-HRV1-XS_19870310-102957-826_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19870310-102957-826_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870310-102957-826_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T20:06:24.032    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:06:24.033    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870310-102957-826_L1C_048-258-0_D_V1-0.zip
2024-01-09T20:06:24.034    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:06:24.034    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:06:24.034    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:06:24.034    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:06:24.034    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:06:24.034    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:06:24.034    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:06:24.034    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870310-102957-826_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/03/10/SPOT1-HRV2-XS_19870310-102921-724_L1C_051-254-0_D_V1-0/SPOT1-HRV2-XS_19870310-102921-724_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19870310-102921-724_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870310-102921-724_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T20:06:34.046    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:06:34.046    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870310-102921-724_L1C_051-254-0_D_V1-0.zip
2024-01-09T20:06:34.046    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:06:34.046    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:06:34.046    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:06:34.046    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:06:34.046    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:06:34.046    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:06:34.046    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:06:34.046    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870310-102921-724_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1987/03/10/SPOT1-HRV2-XS_19870310-102929-957_L1C_051-255-0_D_V1-0/SPOT1-HRV2-XS_19870310-102929-957_L1C_051-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19870310-102929-957_L1C_051-255-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870310-102929-957_L1C_051-255-0_D_V1-0.zip
run script
2024-01-09T20:06:37.064    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:06:37.065    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870310-102929-957_L1C_051-255-0_D_V1-0.zip
2024-01-09T20:06:37.065    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:06:37.065    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:06:37.065    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:06:37.065    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:06:37.065    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:06:37.065    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:06:37.066    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:06:37.066    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870310-102929-957_L1C_051-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/03/10/SPOT1-HRV2-XS_19870310-102946-452_L1C_051-257-0_D_V1-0/SPOT1-HRV2-XS_19870310-102946-452_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19870310-102946-452_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870310-102946-452_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T20:07:35.355    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:07:35.356    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870310-102946-452_L1C_051-257-0_D_V1-0.zip
2024-01-09T20:07:35.356    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:07:35.356    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:07:35.356    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:07:35.356    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:07:35.357    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:07:35.357    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:07:35.357    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:07:35.357    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870310-102946-452_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 1 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/03/10/SPOT1-HRV2-XS_19870310-102954-574_L1C_051-257-9_D_V1-0/SPOT1-HRV2-XS_19870310-102954-574_L1C_051-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19870310-102954-574_L1C_051-257-9_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870310-102954-574_L1C_051-257-9_D_V1-0.zip
run script
2024-01-09T20:11:07.712    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:11:07.712    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870310-102954-574_L1C_051-257-9_D_V1-0.zip
2024-01-09T20:11:07.713    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:11:07.713    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:11:07.713    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:11:07.713    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:11:07.713    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:11:07.713    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:11:07.713    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:11:07.713    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T20:12:56.298    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 400). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870310-102954-574_L1C_051-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1987/08/07/SPOT1-HRV1-XS_19870807-104513-858_L1C_048-254-0_D_V1-0/SPOT1-HRV1-XS_19870807-104513-858_L1C_048-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19870807-104513-858_L1C_048-254-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870807-104513-858_L1C_048-254-0_D_V1-0.zip
run script
2024-01-09T20:12:59.275    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:12:59.276    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870807-104513-858_L1C_048-254-0_D_V1-0.zip
2024-01-09T20:12:59.276    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:12:59.276    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:12:59.276    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:12:59.276    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:12:59.277    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:12:59.277    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:12:59.277    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:12:59.277    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870807-104513-858_L1C_048-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1987/08/07/SPOT1-HRV1-XS_19870807-104538-756_L1C_048-257-0_D_V1-0/SPOT1-HRV1-XS_19870807-104538-756_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19870807-104538-756_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870807-104538-756_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T20:13:02.304    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:13:02.305    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870807-104538-756_L1C_048-257-0_D_V1-0.zip
2024-01-09T20:13:02.306    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:13:02.306    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:13:02.306    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:13:02.306    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:13:02.306    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:13:02.306    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:13:02.306    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:13:02.306    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870807-104538-756_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/08/07/SPOT1-HRV1-XS_19870807-104547-070_L1C_048-258-0_D_V1-0/SPOT1-HRV1-XS_19870807-104547-070_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19870807-104547-070_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870807-104547-070_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T20:13:47.235    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:13:47.236    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870807-104547-070_L1C_048-258-0_D_V1-0.zip
2024-01-09T20:13:47.236    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:13:47.236    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:13:47.236    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:13:47.236    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:13:47.236    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:13:47.236    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:13:47.236    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:13:47.236    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870807-104547-070_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/08/07/SPOT1-HRV1-XS_19870807-104555-390_L1C_048-259-0_D_V1-0/SPOT1-HRV1-XS_19870807-104555-390_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19870807-104555-390_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870807-104555-390_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T20:14:04.184    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:14:04.185    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870807-104555-390_L1C_048-259-0_D_V1-0.zip
2024-01-09T20:14:04.185    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:14:04.185    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:14:04.185    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:14:04.185    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:14:04.185    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:14:04.186    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:14:04.186    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:14:04.186    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870807-104555-390_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1987/08/07/SPOT1-HRV1-XS_19870807-104603-511_L1C_048-259-9_D_V1-0/SPOT1-HRV1-XS_19870807-104603-511_L1C_048-259-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19870807-104603-511_L1C_048-259-9_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870807-104603-511_L1C_048-259-9_D_V1-0.zip
run script
2024-01-09T20:14:07.477    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:14:07.478    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870807-104603-511_L1C_048-259-9_D_V1-0.zip
2024-01-09T20:14:07.478    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:14:07.478    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:14:07.478    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:14:07.478    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:14:07.479    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:14:07.479    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:14:07.479    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:14:07.479    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870807-104603-511_L1C_048-259-9_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1987/08/07/SPOT1-HRV1-XS_19870807-104603-719_L1C_048-260-0_D_V1-0/SPOT1-HRV1-XS_19870807-104603-719_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19870807-104603-719_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870807-104603-719_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T20:14:10.651    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:14:10.651    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870807-104603-719_L1C_048-260-0_D_V1-0.zip
2024-01-09T20:14:10.651    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:14:10.651    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:14:10.651    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:14:10.651    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:14:10.651    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:14:10.651    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:14:10.651    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:14:10.652    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870807-104603-719_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1987/08/13/SPOT1-HRV1-XS_19870813-103013-920_L1C_048-257-0_D_V1-0/SPOT1-HRV1-XS_19870813-103013-920_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19870813-103013-920_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870813-103013-920_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T20:14:13.910    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:14:13.911    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870813-103013-920_L1C_048-257-0_D_V1-0.zip
2024-01-09T20:14:13.911    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:14:13.911    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:14:13.911    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:14:13.911    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:14:13.911    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:14:13.911    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:14:13.911    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:14:13.911    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870813-103013-920_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1987/08/13/SPOT1-HRV1-XS_19870813-103022-156_L1C_048-258-0_D_V1-0/SPOT1-HRV1-XS_19870813-103022-156_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19870813-103022-156_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870813-103022-156_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T20:14:16.931    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:14:16.931    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870813-103022-156_L1C_048-258-0_D_V1-0.zip
2024-01-09T20:14:16.931    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:14:16.931    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:14:16.931    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:14:16.931    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:14:16.931    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:14:16.932    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:14:16.932    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:14:16.932    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870813-103022-156_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1987/08/13/SPOT1-HRV1-XS_19870813-103030-277_L1C_048-258-9_D_V1-0/SPOT1-HRV1-XS_19870813-103030-277_L1C_048-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19870813-103030-277_L1C_048-258-9_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870813-103030-277_L1C_048-258-9_D_V1-0.zip
run script
2024-01-09T20:14:20.121    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:14:20.121    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870813-103030-277_L1C_048-258-9_D_V1-0.zip
2024-01-09T20:14:20.121    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:14:20.121    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:14:20.122    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:14:20.122    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:14:20.122    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:14:20.122    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:14:20.122    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:14:20.122    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870813-103030-277_L1C_048-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1987/08/13/SPOT1-HRV1-XS_19870813-103030-401_L1C_048-259-0_D_V1-0/SPOT1-HRV1-XS_19870813-103030-401_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19870813-103030-401_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870813-103030-401_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T20:14:23.242    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:14:23.243    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870813-103030-401_L1C_048-259-0_D_V1-0.zip
2024-01-09T20:14:23.243    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:14:23.243    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:14:23.243    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:14:23.243    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:14:23.243    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:14:23.243    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:14:23.243    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:14:23.243    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870813-103030-401_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1987/08/13/SPOT1-HRV2-XS_19870813-103012-677_L1C_049-257-0_D_V1-0/SPOT1-HRV2-XS_19870813-103012-677_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19870813-103012-677_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870813-103012-677_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T20:14:26.494    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:14:26.495    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870813-103012-677_L1C_049-257-0_D_V1-0.zip
2024-01-09T20:14:26.495    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:14:26.495    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:14:26.495    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:14:26.496    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:14:26.496    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:14:26.496    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:14:26.496    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:14:26.496    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870813-103012-677_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/08/13/SPOT1-HRV2-XS_19870813-103020-919_L1C_049-258-0_D_V1-0/SPOT1-HRV2-XS_19870813-103020-919_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19870813-103020-919_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870813-103020-919_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T20:15:42.387    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:15:42.389    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870813-103020-919_L1C_049-258-0_D_V1-0.zip
2024-01-09T20:15:42.389    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:15:42.389    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:15:42.389    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:15:42.389    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:15:42.389    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:15:42.389    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:15:42.389    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:15:42.389    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870813-103020-919_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/08/13/SPOT1-HRV2-XS_19870813-103029-041_L1C_049-258-9_D_V1-0/SPOT1-HRV2-XS_19870813-103029-041_L1C_049-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19870813-103029-041_L1C_049-258-9_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870813-103029-041_L1C_049-258-9_D_V1-0.zip
run script
2024-01-09T20:16:39.236    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:16:39.237    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870813-103029-041_L1C_049-258-9_D_V1-0.zip
2024-01-09T20:16:39.237    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:16:39.238    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:16:39.238    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:16:39.238    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:16:39.238    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:16:39.238    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:16:39.238    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:16:39.238    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870813-103029-041_L1C_049-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/08/13/SPOT1-HRV2-XS_19870813-103029-173_L1C_049-259-0_D_V1-0/SPOT1-HRV2-XS_19870813-103029-173_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19870813-103029-173_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870813-103029-173_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T20:17:20.660    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:17:20.661    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870813-103029-173_L1C_049-259-0_D_V1-0.zip
2024-01-09T20:17:20.661    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:17:20.661    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:17:20.662    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:17:20.662    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:17:20.662    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:17:20.662    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:17:20.662    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:17:20.662    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870813-103029-173_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/07/02/SPOT1-HRV1-XS_19870702-103759-633_L1C_048-258-0_D_V1-0/SPOT1-HRV1-XS_19870702-103759-633_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19870702-103759-633_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870702-103759-633_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T20:18:06.020    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:18:06.022    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870702-103759-633_L1C_048-258-0_D_V1-0.zip
2024-01-09T20:18:06.022    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:18:06.022    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:18:06.022    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:18:06.022    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:18:06.022    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:18:06.022    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:18:06.022    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:18:06.022    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870702-103759-633_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/07/02/SPOT1-HRV1-XS_19870702-103807-911_L1C_048-259-0_D_V1-0/SPOT1-HRV1-XS_19870702-103807-911_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19870702-103807-911_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870702-103807-911_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T20:18:16.891    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:18:16.892    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870702-103807-911_L1C_048-259-0_D_V1-0.zip
2024-01-09T20:18:16.892    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:18:16.892    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:18:16.893    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:18:16.893    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:18:16.893    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:18:16.893    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:18:16.893    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:18:16.893    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870702-103807-911_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1987/07/02/SPOT1-HRV1-XS_19870702-103816-201_L1C_048-260-0_D_V1-0/SPOT1-HRV1-XS_19870702-103816-201_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19870702-103816-201_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870702-103816-201_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T20:18:19.721    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:18:19.721    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870702-103816-201_L1C_048-260-0_D_V1-0.zip
2024-01-09T20:18:19.721    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:18:19.721    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:18:19.721    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:18:19.721    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:18:19.721    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:18:19.721    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:18:19.721    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:18:19.721    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870702-103816-201_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1987/07/02/SPOT1-HRV1-XS_19870702-103824-494_L1C_048-261-0_D_V1-0/SPOT1-HRV1-XS_19870702-103824-494_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19870702-103824-494_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870702-103824-494_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T20:18:22.890    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:18:22.891    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870702-103824-494_L1C_048-261-0_D_V1-0.zip
2024-01-09T20:18:22.891    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:18:22.891    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:18:22.891    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:18:22.892    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:18:22.892    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:18:22.892    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:18:22.892    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:18:22.892    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870702-103824-494_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1987/02/06/SPOT1-HRV2-XS_19870206-104604-157_L1C_048-260-0_D_V1-0/SPOT1-HRV2-XS_19870206-104604-157_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19870206-104604-157_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870206-104604-157_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T20:18:26.007    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:18:26.008    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870206-104604-157_L1C_048-260-0_D_V1-0.zip
2024-01-09T20:18:26.008    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:18:26.008    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:18:26.008    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:18:26.008    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:18:26.008    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:18:26.008    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:18:26.008    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:18:26.008    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870206-104604-157_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1987/02/06/SPOT1-HRV2-XS_19870206-104612-489_L1C_048-261-0_D_V1-0/SPOT1-HRV2-XS_19870206-104612-489_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19870206-104612-489_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870206-104612-489_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T20:18:28.949    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:18:28.949    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870206-104612-489_L1C_048-261-0_D_V1-0.zip
2024-01-09T20:18:28.949    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:18:28.949    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:18:28.949    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:18:28.949    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:18:28.949    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:18:28.949    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:18:28.949    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:18:28.949    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870206-104612-489_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1987/09/02/SPOT1-HRV1-XS_19870902-104618-613_L1C_048-261-0_D_V1-0/SPOT1-HRV1-XS_19870902-104618-613_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19870902-104618-613_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870902-104618-613_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T20:18:32.328    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:18:32.328    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870902-104618-613_L1C_048-261-0_D_V1-0.zip
2024-01-09T20:18:32.328    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:18:32.328    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:18:32.328    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:18:32.328    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:18:32.329    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:18:32.329    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:18:32.329    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:18:32.329    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870902-104618-613_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1987/10/19/SPOT1-HRV1-XS_19871019-104138-840_L1C_049-255-0_D_V1-0/SPOT1-HRV1-XS_19871019-104138-840_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19871019-104138-840_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19871019-104138-840_L1C_049-255-0_D_V1-0.zip
run script
2024-01-09T20:18:35.162    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:18:35.162    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19871019-104138-840_L1C_049-255-0_D_V1-0.zip
2024-01-09T20:18:35.162    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:18:35.162    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:18:35.162    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:18:35.162    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:18:35.162    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:18:35.162    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:18:35.162    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:18:35.163    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19871019-104138-840_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/10/19/SPOT1-HRV1-XS_19871019-104147-121_L1C_049-256-0_D_V1-0/SPOT1-HRV1-XS_19871019-104147-121_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19871019-104147-121_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19871019-104147-121_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T20:19:15.080    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:19:15.081    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19871019-104147-121_L1C_049-256-0_D_V1-0.zip
2024-01-09T20:19:15.081    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:19:15.081    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:19:15.081    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:19:15.081    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:19:15.081    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:19:15.081    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:19:15.081    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:19:15.081    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19871019-104147-121_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/10/19/SPOT1-HRV1-XS_19871019-104203-707_L1C_049-258-0_D_V1-0/SPOT1-HRV1-XS_19871019-104203-707_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19871019-104203-707_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19871019-104203-707_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T20:20:45.774    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:20:45.775    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19871019-104203-707_L1C_049-258-0_D_V1-0.zip
2024-01-09T20:20:45.775    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:20:45.775    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:20:45.775    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:20:45.776    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:20:45.776    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:20:45.776    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:20:45.776    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:20:45.776    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19871019-104203-707_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/10/19/SPOT1-HRV1-XS_19871019-104212-009_L1C_049-259-0_D_V1-0/SPOT1-HRV1-XS_19871019-104212-009_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19871019-104212-009_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19871019-104212-009_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T20:21:35.035    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:21:35.035    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19871019-104212-009_L1C_049-259-0_D_V1-0.zip
2024-01-09T20:21:35.035    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:21:35.035    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:21:35.035    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:21:35.035    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:21:35.035    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:21:35.035    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:21:35.035    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:21:35.035    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19871019-104212-009_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [1 1 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/10/19/SPOT1-HRV1-XS_19871019-104236-762_L1C_049-261-9_D_V1-0/SPOT1-HRV1-XS_19871019-104236-762_L1C_049-261-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19871019-104236-762_L1C_049-261-9_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19871019-104236-762_L1C_049-261-9_D_V1-0.zip
run script
2024-01-09T20:22:08.651    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:22:08.652    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19871019-104236-762_L1C_049-261-9_D_V1-0.zip
2024-01-09T20:22:08.652    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:22:08.652    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:22:08.652    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:22:08.652    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:22:08.652    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:22:08.652    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:22:08.653    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:22:08.653    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19871019-104236-762_L1C_049-261-9_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1987/10/19/SPOT1-HRV2-XS_19871019-104128-237_L1C_051-254-0_D_V1-0/SPOT1-HRV2-XS_19871019-104128-237_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19871019-104128-237_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19871019-104128-237_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T20:22:11.694    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:22:11.694    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19871019-104128-237_L1C_051-254-0_D_V1-0.zip
2024-01-09T20:22:11.694    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:22:11.694    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:22:11.694    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:22:11.694    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:22:11.694    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:22:11.694    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:22:11.694    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:22:11.694    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19871019-104128-237_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1987/10/19/SPOT1-HRV2-XS_19871019-104144-832_L1C_051-256-0_D_V1-0/SPOT1-HRV2-XS_19871019-104144-832_L1C_051-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19871019-104144-832_L1C_051-256-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19871019-104144-832_L1C_051-256-0_D_V1-0.zip
run script
2024-01-09T20:22:14.831    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:22:14.831    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19871019-104144-832_L1C_051-256-0_D_V1-0.zip
2024-01-09T20:22:14.831    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:22:14.831    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:22:14.831    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:22:14.831    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:22:14.831    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:22:14.831    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:22:14.831    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:22:14.831    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19871019-104144-832_L1C_051-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/10/19/SPOT1-HRV2-XS_19871019-104201-460_L1C_051-258-0_D_V1-0/SPOT1-HRV2-XS_19871019-104201-460_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19871019-104201-460_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19871019-104201-460_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T20:25:33.912    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:25:33.913    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19871019-104201-460_L1C_051-258-0_D_V1-0.zip
2024-01-09T20:25:33.914    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:25:33.914    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:25:33.914    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:25:33.914    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:25:33.914    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:25:33.914    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:25:33.914    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:25:33.914    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T20:27:31.259    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 218). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19871019-104201-460_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1987/10/19/SPOT1-HRV2-XS_19871019-104209-784_L1C_051-259-0_D_V1-0/SPOT1-HRV2-XS_19871019-104209-784_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19871019-104209-784_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19871019-104209-784_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T20:27:34.292    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:27:34.293    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19871019-104209-784_L1C_051-259-0_D_V1-0.zip
2024-01-09T20:27:34.293    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:27:34.293    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:27:34.293    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:27:34.293    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:27:34.293    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:27:34.294    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:27:34.294    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:27:34.294    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19871019-104209-784_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/01/22/SPOT1-HRV2-XS_19870122-103453-342_L1C_049-262-0_D_V1-0/SPOT1-HRV2-XS_19870122-103453-342_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19870122-103453-342_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870122-103453-342_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T20:30:11.923    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:30:11.924    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870122-103453-342_L1C_049-262-0_D_V1-0.zip
2024-01-09T20:30:11.924    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:30:11.924    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:30:11.924    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:30:11.924    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:30:11.924    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:30:11.925    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:30:11.925    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:30:11.925    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870122-103453-342_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1987/06/01/SPOT1-HRV2-XS_19870601-103430-830_L1C_049-262-0_D_V1-0/SPOT1-HRV2-XS_19870601-103430-830_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19870601-103430-830_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870601-103430-830_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T20:30:14.910    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:30:14.912    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870601-103430-830_L1C_049-262-0_D_V1-0.zip
2024-01-09T20:30:14.912    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:30:14.912    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:30:14.912    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:30:14.912    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:30:14.912    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:30:14.912    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:30:14.912    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:30:14.912    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870601-103430-830_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1987/03/09/SPOT1-HRV2-XS_19870309-104841-481_L1C_050-254-0_D_V1-0/SPOT1-HRV2-XS_19870309-104841-481_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19870309-104841-481_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870309-104841-481_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T20:30:17.926    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:30:17.927    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870309-104841-481_L1C_050-254-0_D_V1-0.zip
2024-01-09T20:30:17.928    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:30:17.928    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:30:17.928    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:30:17.928    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:30:17.928    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:30:17.928    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:30:17.928    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:30:17.928    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870309-104841-481_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1987/03/09/SPOT1-HRV2-XS_19870309-104849-829_L1C_050-255-0_D_V1-0/SPOT1-HRV2-XS_19870309-104849-829_L1C_050-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19870309-104849-829_L1C_050-255-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870309-104849-829_L1C_050-255-0_D_V1-0.zip
run script
2024-01-09T20:30:21.178    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:30:21.180    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870309-104849-829_L1C_050-255-0_D_V1-0.zip
2024-01-09T20:30:21.180    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:30:21.180    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:30:21.180    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:30:21.180    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:30:21.180    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:30:21.180    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:30:21.181    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:30:21.181    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870309-104849-829_L1C_050-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/10/24/SPOT1-HRV2-XS_19871024-104545-303_L1C_050-257-0_D_V1-0/SPOT1-HRV2-XS_19871024-104545-303_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19871024-104545-303_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19871024-104545-303_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T20:31:24.912    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:31:24.914    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19871024-104545-303_L1C_050-257-0_D_V1-0.zip
2024-01-09T20:31:24.914    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:31:24.914    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:31:24.914    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:31:24.914    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:31:24.914    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:31:24.914    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:31:24.914    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:31:24.915    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19871024-104545-303_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/10/24/SPOT1-HRV2-XS_19871024-104553-644_L1C_050-258-0_D_V1-0/SPOT1-HRV2-XS_19871024-104553-644_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19871024-104553-644_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19871024-104553-644_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T20:35:03.768    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:35:03.769    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19871024-104553-644_L1C_050-258-0_D_V1-0.zip
2024-01-09T20:35:03.769    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:35:03.769    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:35:03.769    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:35:03.770    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:35:03.770    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:35:03.770    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:35:03.770    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:35:03.770    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T20:37:09.632    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 223). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19871024-104553-644_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1987/10/24/SPOT1-HRV2-XS_19871024-104601-766_L1C_050-258-9_D_V1-0/SPOT1-HRV2-XS_19871024-104601-766_L1C_050-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19871024-104601-766_L1C_050-258-9_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19871024-104601-766_L1C_050-258-9_D_V1-0.zip
run script
2024-01-09T20:37:12.641    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:37:12.642    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19871024-104601-766_L1C_050-258-9_D_V1-0.zip
2024-01-09T20:37:12.643    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:37:12.643    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:37:12.643    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:37:12.643    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:37:12.643    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:37:12.643    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:37:12.643    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:37:12.643    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19871024-104601-766_L1C_050-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/10/24/SPOT1-HRV2-XS_19871024-104536-968_L1C_051-256-0_D_V1-0/SPOT1-HRV2-XS_19871024-104536-968_L1C_051-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19871024-104536-968_L1C_051-256-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19871024-104536-968_L1C_051-256-0_D_V1-0.zip
run script
2024-01-09T20:39:56.007    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:39:56.008    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19871024-104536-968_L1C_051-256-0_D_V1-0.zip
2024-01-09T20:39:56.008    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:39:56.008    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:39:56.008    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:39:56.008    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:39:56.008    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:39:56.008    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:39:56.009    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:39:56.009    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19871024-104536-968_L1C_051-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/02/28/SPOT1-HRV2-XS_19870228-102252-118_L1C_050-262-0_D_V1-0/SPOT1-HRV2-XS_19870228-102252-118_L1C_050-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19870228-102252-118_L1C_050-262-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870228-102252-118_L1C_050-262-0_D_V1-0.zip
run script
2024-01-09T20:43:28.915    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:43:28.917    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870228-102252-118_L1C_050-262-0_D_V1-0.zip
2024-01-09T20:43:28.917    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:43:28.917    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:43:28.917    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:43:28.917    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:43:28.917    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:43:28.917    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:43:28.917    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:43:28.917    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870228-102252-118_L1C_050-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/09/18/SPOT1-HRV1-XS_19870918-103735-356_L1C_051-254-0_D_V1-0/SPOT1-HRV1-XS_19870918-103735-356_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19870918-103735-356_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870918-103735-356_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T20:44:39.534    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:44:39.535    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870918-103735-356_L1C_051-254-0_D_V1-0.zip
2024-01-09T20:44:39.535    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:44:39.535    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:44:39.535    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:44:39.535    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:44:39.535    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:44:39.535    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:44:39.535    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:44:39.535    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870918-103735-356_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1987/09/18/SPOT1-HRV1-XS_19870918-103743-477_L1C_051-254-9_D_V1-0/SPOT1-HRV1-XS_19870918-103743-477_L1C_051-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19870918-103743-477_L1C_051-254-9_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870918-103743-477_L1C_051-254-9_D_V1-0.zip
run script
2024-01-09T20:44:42.560    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:44:42.561    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870918-103743-477_L1C_051-254-9_D_V1-0.zip
2024-01-09T20:44:42.561    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:44:42.562    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:44:42.562    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:44:42.562    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:44:42.562    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:44:42.562    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:44:42.562    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:44:42.562    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870918-103743-477_L1C_051-254-9_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/09/18/SPOT1-HRV1-XS_19870918-103743-628_L1C_051-255-0_D_V1-0/SPOT1-HRV1-XS_19870918-103743-628_L1C_051-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19870918-103743-628_L1C_051-255-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870918-103743-628_L1C_051-255-0_D_V1-0.zip
run script
2024-01-09T20:45:38.729    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:45:38.730    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870918-103743-628_L1C_051-255-0_D_V1-0.zip
2024-01-09T20:45:38.730    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:45:38.730    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:45:38.730    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:45:38.730    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:45:38.730    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:45:38.730    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:45:38.730    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:45:38.730    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870918-103743-628_L1C_051-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/01/01/SPOT1-HRV1-XS_19870101-103853-117_L1C_051-262-0_D_V1-0/SPOT1-HRV1-XS_19870101-103853-117_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19870101-103853-117_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870101-103853-117_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T20:46:37.060    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:46:37.061    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870101-103853-117_L1C_051-262-0_D_V1-0.zip
2024-01-09T20:46:37.061    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:46:37.061    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:46:37.061    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:46:37.061    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:46:37.061    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:46:37.061    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:46:37.061    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:46:37.061    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870101-103853-117_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/01/01/SPOT1-HRV1-XS_19870101-103901-449_L1C_051-263-0_D_V1-0/SPOT1-HRV1-XS_19870101-103901-449_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19870101-103901-449_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870101-103901-449_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T20:48:04.867    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:48:04.868    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870101-103901-449_L1C_051-263-0_D_V1-0.zip
2024-01-09T20:48:04.868    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:48:04.868    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:48:04.868    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:48:04.868    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:48:04.868    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:48:04.869    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:48:04.869    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:48:04.869    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19870101-103901-449_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/01/01/SPOT1-HRV2-XS_19870101-103834-567_L1C_052-260-0_D_V1-0/SPOT1-HRV2-XS_19870101-103834-567_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19870101-103834-567_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870101-103834-567_L1C_052-260-0_D_V1-0.zip
run script
2024-01-09T20:48:35.837    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:48:35.839    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870101-103834-567_L1C_052-260-0_D_V1-0.zip
2024-01-09T20:48:35.839    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:48:35.839    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:48:35.839    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:48:35.839    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:48:35.839    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:48:35.839    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:48:35.839    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:48:35.839    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870101-103834-567_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/01/01/SPOT1-HRV2-XS_19870101-103842-902_L1C_052-261-0_D_V1-0/SPOT1-HRV2-XS_19870101-103842-902_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19870101-103842-902_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870101-103842-902_L1C_052-261-0_D_V1-0.zip
run script
2024-01-09T20:51:26.243    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:51:26.258    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870101-103842-902_L1C_052-261-0_D_V1-0.zip
2024-01-09T20:51:26.258    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:51:26.258    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:51:26.259    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:51:26.259    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:51:26.259    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:51:26.259    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:51:26.259    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:51:26.259    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870101-103842-902_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/01/01/SPOT1-HRV2-XS_19870101-103851-243_L1C_052-262-0_D_V1-0/SPOT1-HRV2-XS_19870101-103851-243_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19870101-103851-243_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870101-103851-243_L1C_052-262-0_D_V1-0.zip
run script
2024-01-09T20:54:34.949    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:54:34.950    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870101-103851-243_L1C_052-262-0_D_V1-0.zip
2024-01-09T20:54:34.950    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:54:34.950    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:54:34.950    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:54:34.950    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:54:34.950    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:54:34.951    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:54:34.951    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:54:34.951    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870101-103851-243_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/12/21/SPOT1-HRV1-XS_19871221-103021-016_L1C_052-258-0_D_V1-0/SPOT1-HRV1-XS_19871221-103021-016_L1C_052-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19871221-103021-016_L1C_052-258-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19871221-103021-016_L1C_052-258-0_D_V1-0.zip
run script
2024-01-09T20:57:12.731    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:57:12.733    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19871221-103021-016_L1C_052-258-0_D_V1-0.zip
2024-01-09T20:57:12.733    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:57:12.733    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:57:12.733    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:57:12.733    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:57:12.733    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:57:12.733    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:57:12.733    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:57:12.733    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19871221-103021-016_L1C_052-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/12/21/SPOT1-HRV1-XS_19871221-103029-297_L1C_052-259-0_D_V1-0/SPOT1-HRV1-XS_19871221-103029-297_L1C_052-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19871221-103029-297_L1C_052-259-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19871221-103029-297_L1C_052-259-0_D_V1-0.zip
run script
2024-01-09T20:59:42.125    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:59:42.126    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19871221-103029-297_L1C_052-259-0_D_V1-0.zip
2024-01-09T20:59:42.126    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:59:42.126    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:59:42.126    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:59:42.126    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:59:42.126    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:59:42.126    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:59:42.126    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:59:42.126    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19871221-103029-297_L1C_052-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/12/21/SPOT1-HRV1-XS_19871221-103037-587_L1C_052-260-0_D_V1-0/SPOT1-HRV1-XS_19871221-103037-587_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19871221-103037-587_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19871221-103037-587_L1C_052-260-0_D_V1-0.zip
run script
2024-01-09T21:02:39.271    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:02:39.272    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19871221-103037-587_L1C_052-260-0_D_V1-0.zip
2024-01-09T21:02:39.272    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:02:39.272    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:02:39.272    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:02:39.272    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:02:39.272    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:02:39.272    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:02:39.272    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:02:39.273    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19871221-103037-587_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/12/21/SPOT1-HRV1-XS_19871221-103045-886_L1C_052-261-0_D_V1-0/SPOT1-HRV1-XS_19871221-103045-886_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19871221-103045-886_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19871221-103045-886_L1C_052-261-0_D_V1-0.zip
run script
2024-01-09T21:05:27.565    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:05:27.566    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19871221-103045-886_L1C_052-261-0_D_V1-0.zip
2024-01-09T21:05:27.566    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:05:27.566    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:05:27.566    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:05:27.567    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:05:27.567    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:05:27.567    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:05:27.567    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:05:27.567    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19871221-103045-886_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 1 ... 2 2 2]
 [0 0 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/12/21/SPOT1-HRV1-XS_19871221-103054-191_L1C_052-262-0_D_V1-0/SPOT1-HRV1-XS_19871221-103054-191_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19871221-103054-191_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19871221-103054-191_L1C_052-262-0_D_V1-0.zip
run script
2024-01-09T21:08:25.380    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:08:25.381    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19871221-103054-191_L1C_052-262-0_D_V1-0.zip
2024-01-09T21:08:25.381    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:08:25.381    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:08:25.381    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:08:25.381    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:08:25.381    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:08:25.381    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:08:25.381    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:08:25.381    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV1-XS_19871221-103054-191_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 2 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/03/26/SPOT1-HRV2-XS_19870326-102224-479_L1C_052-261-0_D_V1-0/SPOT1-HRV2-XS_19870326-102224-479_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19870326-102224-479_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870326-102224-479_L1C_052-261-0_D_V1-0.zip
run script
2024-01-09T21:10:47.503    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:10:47.505    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870326-102224-479_L1C_052-261-0_D_V1-0.zip
2024-01-09T21:10:47.505    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:10:47.505    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:10:47.505    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:10:47.505    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:10:47.505    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:10:47.505    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:10:47.505    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:10:47.505    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870326-102224-479_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 1 1 ... 2 2 2]
 [2 1 1 ... 2 2 2]
 [2 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/03/26/SPOT1-HRV2-XS_19870326-102232-754_L1C_052-262-0_D_V1-0/SPOT1-HRV2-XS_19870326-102232-754_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19870326-102232-754_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870326-102232-754_L1C_052-262-0_D_V1-0.zip
run script
2024-01-09T21:14:00.611    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:14:00.613    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870326-102232-754_L1C_052-262-0_D_V1-0.zip
2024-01-09T21:14:00.613    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:14:00.613    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:14:00.613    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:14:00.613    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:14:00.613    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:14:00.613    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:14:00.613    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:14:00.613    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870326-102232-754_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/08/28/SPOT1-HRV2-XS_19870828-104220-430_L1C_053-261-0_D_V1-0/SPOT1-HRV2-XS_19870828-104220-430_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19870828-104220-430_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870828-104220-430_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T21:16:44.254    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:16:44.256    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870828-104220-430_L1C_053-261-0_D_V1-0.zip
2024-01-09T21:16:44.256    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:16:44.256    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:16:44.256    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:16:44.256    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:16:44.256    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:16:44.256    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:16:44.256    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:16:44.256    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870828-104220-430_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1987/08/28/SPOT1-HRV2-XS_19870828-104228-799_L1C_053-262-0_D_V1-0/SPOT1-HRV2-XS_19870828-104228-799_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19870828-104228-799_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870828-104228-799_L1C_053-262-0_D_V1-0.zip
run script
2024-01-09T21:19:46.457    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:19:46.458    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870828-104228-799_L1C_053-262-0_D_V1-0.zip
2024-01-09T21:19:46.458    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:19:46.458    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:19:46.458    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:19:46.459    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:19:46.459    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:19:46.459    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:19:46.459    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:19:46.459    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT1-HRV2-XS_19870828-104228-799_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/12/28/SPOT5-HRG2-XS_20131228-102338-689_L1C_046-263-9_D_V1-0/SPOT5-HRG2-XS_20131228-102338-689_L1C_046-263-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20131228-102338-689_L1C_046-263-9_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131228-102338-689_L1C_046-263-9_D_V1-0.zip
run script
2024-01-09T21:22:43.009    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:22:43.011    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131228-102338-689_L1C_046-263-9_D_V1-0.zip
2024-01-09T21:22:43.011    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:22:43.011    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:22:43.011    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:22:43.011    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:22:43.011    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:22:43.011    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:22:43.011    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:22:43.011    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131228-102338-689_L1C_046-263-9_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/12/17/SPOT5-HRG2-XS_20131217-103431-724_L1C_047-254-9_D_V1-0/SPOT5-HRG2-XS_20131217-103431-724_L1C_047-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20131217-103431-724_L1C_047-254-9_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131217-103431-724_L1C_047-254-9_D_V1-0.zip
run script
2024-01-09T21:24:50.489    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:24:50.490    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131217-103431-724_L1C_047-254-9_D_V1-0.zip
2024-01-09T21:24:50.490    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:24:50.490    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:24:50.490    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:24:50.491    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:24:50.491    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:24:50.491    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:24:50.491    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:24:50.491    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131217-103431-724_L1C_047-254-9_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/12/17/SPOT5-HRG1-XS_20131217-103439-788_L1C_047-255-9_D_V1-0/SPOT5-HRG1-XS_20131217-103439-788_L1C_047-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20131217-103439-788_L1C_047-255-9_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131217-103439-788_L1C_047-255-9_D_V1-0.zip
run script
2024-01-09T21:25:09.058    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:25:09.059    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131217-103439-788_L1C_047-255-9_D_V1-0.zip
2024-01-09T21:25:09.059    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:25:09.059    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:25:09.059    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:25:09.059    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:25:09.059    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:25:09.059    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:25:09.059    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:25:09.060    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131217-103439-788_L1C_047-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/12/17/SPOT5-HRG2-XS_20131217-103432-013_L1C_047-255-0_D_V1-0/SPOT5-HRG2-XS_20131217-103432-013_L1C_047-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20131217-103432-013_L1C_047-255-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131217-103432-013_L1C_047-255-0_D_V1-0.zip
run script
2024-01-09T21:25:26.892    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:25:26.893    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131217-103432-013_L1C_047-255-0_D_V1-0.zip
2024-01-09T21:25:26.893    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:25:26.894    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:25:26.894    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:25:26.894    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:25:26.894    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:25:26.894    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:25:26.894    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:25:26.894    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131217-103432-013_L1C_047-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/12/17/SPOT5-HRG2-XS_20131217-103432-927_L1C_047-255-1_D_V1-0/SPOT5-HRG2-XS_20131217-103432-927_L1C_047-255-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20131217-103432-927_L1C_047-255-1_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131217-103432-927_L1C_047-255-1_D_V1-0.zip
run script
2024-01-09T21:25:44.114    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:25:44.116    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131217-103432-927_L1C_047-255-1_D_V1-0.zip
2024-01-09T21:25:44.116    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:25:44.116    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:25:44.116    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:25:44.116    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:25:44.116    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:25:44.116    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:25:44.116    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:25:44.116    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131217-103432-927_L1C_047-255-1_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/12/17/SPOT5-HRG1-XS_20131217-103440-101_L1C_047-256-0_D_V1-0/SPOT5-HRG1-XS_20131217-103440-101_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20131217-103440-101_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131217-103440-101_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T21:26:00.764    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:26:00.765    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131217-103440-101_L1C_047-256-0_D_V1-0.zip
2024-01-09T21:26:00.765    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:26:00.765    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:26:00.765    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:26:00.766    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:26:00.766    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:26:00.766    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:26:00.766    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:26:00.766    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T21:26:11.159    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (508 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131217-103440-101_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2013/12/17/SPOT5-HRG1-XS_20131217-103440-992_L1C_047-256-1_D_V1-0/SPOT5-HRG1-XS_20131217-103440-992_L1C_047-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20131217-103440-992_L1C_047-256-1_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131217-103440-992_L1C_047-256-1_D_V1-0.zip
run script
2024-01-09T21:26:17.105    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:26:17.106    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131217-103440-992_L1C_047-256-1_D_V1-0.zip
2024-01-09T21:26:17.106    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:26:17.106    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:26:17.107    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:26:17.107    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:26:17.107    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:26:17.107    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:26:17.107    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:26:17.107    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T21:26:25.438    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (524 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131217-103440-992_L1C_047-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2013/11/11/SPOT5-HRG2-XS_20131111-102945-951_L1C_047-260-1_D_V1-0/SPOT5-HRG2-XS_20131111-102945-951_L1C_047-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20131111-102945-951_L1C_047-260-1_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131111-102945-951_L1C_047-260-1_D_V1-0.zip
run script
2024-01-09T21:26:31.060    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:26:31.061    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131111-102945-951_L1C_047-260-1_D_V1-0.zip
2024-01-09T21:26:31.061    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:26:31.061    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:26:31.061    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:26:31.061    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:26:31.061    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:26:31.062    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:26:31.062    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:26:31.062    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131111-102945-951_L1C_047-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/03/01/SPOT5-HRG1-XS_20130301-104515-729_L1C_048-254-0_D_V1-0/SPOT5-HRG1-XS_20130301-104515-729_L1C_048-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130301-104515-729_L1C_048-254-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130301-104515-729_L1C_048-254-0_D_V1-0.zip
run script
2024-01-09T21:26:36.203    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:26:36.204    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130301-104515-729_L1C_048-254-0_D_V1-0.zip
2024-01-09T21:26:36.204    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:26:36.204    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:26:36.204    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:26:36.204    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:26:36.204    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:26:36.204    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:26:36.204    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:26:36.204    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130301-104515-729_L1C_048-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/03/01/SPOT5-HRG1-XS_20130301-104524-152_L1C_048-255-0_D_V1-0/SPOT5-HRG1-XS_20130301-104524-152_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130301-104524-152_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130301-104524-152_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T21:26:42.110    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:26:42.111    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130301-104524-152_L1C_048-255-0_D_V1-0.zip
2024-01-09T21:26:42.111    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:26:42.111    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:26:42.111    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:26:42.111    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:26:42.111    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:26:42.111    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:26:42.112    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:26:42.112    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130301-104524-152_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/03/01/SPOT5-HRG1-XS_20130301-104532-550_L1C_048-256-0_D_V1-0/SPOT5-HRG1-XS_20130301-104532-550_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130301-104532-550_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130301-104532-550_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T21:27:18.103    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:27:18.104    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130301-104532-550_L1C_048-256-0_D_V1-0.zip
2024-01-09T21:27:18.104    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:27:18.105    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:27:18.105    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:27:18.105    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:27:18.105    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:27:18.105    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:27:18.105    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:27:18.105    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130301-104532-550_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/03/01/SPOT5-HRG1-XS_20130301-104534-355_L1C_048-256-2_D_V1-0/SPOT5-HRG1-XS_20130301-104534-355_L1C_048-256-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130301-104534-355_L1C_048-256-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130301-104534-355_L1C_048-256-2_D_V1-0.zip
run script
2024-01-09T21:28:06.603    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:28:06.604    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130301-104534-355_L1C_048-256-2_D_V1-0.zip
2024-01-09T21:28:06.604    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:28:06.605    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:28:06.605    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:28:06.605    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:28:06.605    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:28:06.605    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:28:06.605    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:28:06.605    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130301-104534-355_L1C_048-256-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/03/01/SPOT5-HRG2-XS_20130301-104558-805_L1C_048-259-2_D_V1-0/SPOT5-HRG2-XS_20130301-104558-805_L1C_048-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130301-104558-805_L1C_048-259-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130301-104558-805_L1C_048-259-2_D_V1-0.zip
run script
2024-01-09T21:28:47.240    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:28:47.241    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130301-104558-805_L1C_048-259-2_D_V1-0.zip
2024-01-09T21:28:47.241    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:28:47.241    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:28:47.241    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:28:47.241    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:28:47.242    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:28:47.242    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:28:47.242    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:28:47.242    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130301-104558-805_L1C_048-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/03/18/SPOT5-HRG1-XS_20130318-101738-241_L1C_048-254-0_D_V1-0/SPOT5-HRG1-XS_20130318-101738-241_L1C_048-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130318-101738-241_L1C_048-254-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130318-101738-241_L1C_048-254-0_D_V1-0.zip
run script
2024-01-09T21:28:52.089    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:28:52.090    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130318-101738-241_L1C_048-254-0_D_V1-0.zip
2024-01-09T21:28:52.091    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:28:52.091    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:28:52.091    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:28:52.091    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:28:52.091    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:28:52.091    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:28:52.091    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:28:52.091    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130318-101738-241_L1C_048-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/03/18/SPOT5-HRG1-XS_20130318-101746-495_L1C_048-255-0_D_V1-0/SPOT5-HRG1-XS_20130318-101746-495_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130318-101746-495_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130318-101746-495_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T21:28:56.423    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:28:56.424    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130318-101746-495_L1C_048-255-0_D_V1-0.zip
2024-01-09T21:28:56.425    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:28:56.425    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:28:56.425    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:28:56.425    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:28:56.425    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:28:56.425    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:28:56.425    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:28:56.425    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130318-101746-495_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/03/18/SPOT5-HRG2-XS_20130318-101816-923_L1C_048-258-6_D_V1-0/SPOT5-HRG2-XS_20130318-101816-923_L1C_048-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130318-101816-923_L1C_048-258-6_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130318-101816-923_L1C_048-258-6_D_V1-0.zip
run script
2024-01-09T21:29:23.679    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:29:23.680    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130318-101816-923_L1C_048-258-6_D_V1-0.zip
2024-01-09T21:29:23.680    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:29:23.680    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:29:23.680    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:29:23.681    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:29:23.681    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:29:23.681    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:29:23.681    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:29:23.681    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130318-101816-923_L1C_048-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/03/18/SPOT5-HRG2-XS_20130318-101819-763_L1C_048-259-0_D_V1-0/SPOT5-HRG2-XS_20130318-101819-763_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130318-101819-763_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130318-101819-763_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T21:29:29.287    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:29:29.288    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130318-101819-763_L1C_048-259-0_D_V1-0.zip
2024-01-09T21:29:29.288    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:29:29.288    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:29:29.288    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:29:29.288    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:29:29.288    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:29:29.289    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:29:29.289    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:29:29.289    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130318-101819-763_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/03/18/SPOT5-HRG2-XS_20130318-101821-568_L1C_048-259-2_D_V1-0/SPOT5-HRG2-XS_20130318-101821-568_L1C_048-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130318-101821-568_L1C_048-259-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130318-101821-568_L1C_048-259-2_D_V1-0.zip
run script
2024-01-09T21:29:34.844    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:29:34.845    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130318-101821-568_L1C_048-259-2_D_V1-0.zip
2024-01-09T21:29:34.845    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:29:34.845    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:29:34.845    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:29:34.845    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:29:34.845    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:29:34.845    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:29:34.845    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:29:34.845    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130318-101821-568_L1C_048-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/03/18/SPOT5-HRG2-XS_20130318-101833-480_L1C_048-260-6_D_V1-0/SPOT5-HRG2-XS_20130318-101833-480_L1C_048-260-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130318-101833-480_L1C_048-260-6_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130318-101833-480_L1C_048-260-6_D_V1-0.zip
run script
2024-01-09T21:29:40.223    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:29:40.225    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130318-101833-480_L1C_048-260-6_D_V1-0.zip
2024-01-09T21:29:40.225    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:29:40.225    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:29:40.225    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:29:40.225    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:29:40.225    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:29:40.225    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:29:40.225    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:29:40.226    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130318-101833-480_L1C_048-260-6_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/05/25/SPOT5-HRG1-XS_20130525-100644-659_L1C_048-254-0_D_V1-0/SPOT5-HRG1-XS_20130525-100644-659_L1C_048-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130525-100644-659_L1C_048-254-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130525-100644-659_L1C_048-254-0_D_V1-0.zip
run script
2024-01-09T21:29:44.315    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:29:44.316    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130525-100644-659_L1C_048-254-0_D_V1-0.zip
2024-01-09T21:29:44.316    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:29:44.316    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:29:44.316    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:29:44.316    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:29:44.316    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:29:44.316    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:29:44.316    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:29:44.316    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130525-100644-659_L1C_048-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/05/25/SPOT5-HRG1-XS_20130525-100646-464_L1C_048-254-2_D_V1-0/SPOT5-HRG1-XS_20130525-100646-464_L1C_048-254-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130525-100646-464_L1C_048-254-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130525-100646-464_L1C_048-254-2_D_V1-0.zip
run script
2024-01-09T21:29:48.238    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:29:48.240    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130525-100646-464_L1C_048-254-2_D_V1-0.zip
2024-01-09T21:29:48.240    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:29:48.240    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:29:48.240    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:29:48.240    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:29:48.240    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:29:48.240    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:29:48.240    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:29:48.240    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130525-100646-464_L1C_048-254-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/06/15/SPOT5-HRG1-XS_20130615-100157-955_L1C_048-254-6_D_V1-0/SPOT5-HRG1-XS_20130615-100157-955_L1C_048-254-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130615-100157-955_L1C_048-254-6_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130615-100157-955_L1C_048-254-6_D_V1-0.zip
run script
2024-01-09T21:29:56.045    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:29:56.047    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130615-100157-955_L1C_048-254-6_D_V1-0.zip
2024-01-09T21:29:56.047    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:29:56.047    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:29:56.047    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:29:56.047    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:29:56.047    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:29:56.047    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:29:56.047    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:29:56.047    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130615-100157-955_L1C_048-254-6_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/06/15/SPOT5-HRG1-XS_20130615-100200-747_L1C_048-255-0_D_V1-0/SPOT5-HRG1-XS_20130615-100200-747_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130615-100200-747_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130615-100200-747_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T21:30:09.699    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:30:09.701    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130615-100200-747_L1C_048-255-0_D_V1-0.zip
2024-01-09T21:30:09.701    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:30:09.701    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:30:09.701    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:30:09.701    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:30:09.701    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:30:09.701    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:30:09.701    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:30:09.701    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130615-100200-747_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/06/15/SPOT5-HRG1-XS_20130615-100202-551_L1C_048-255-2_D_V1-0/SPOT5-HRG1-XS_20130615-100202-551_L1C_048-255-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130615-100202-551_L1C_048-255-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130615-100202-551_L1C_048-255-2_D_V1-0.zip
run script
2024-01-09T21:30:38.434    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:30:38.436    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130615-100202-551_L1C_048-255-2_D_V1-0.zip
2024-01-09T21:30:38.436    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:30:38.436    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:30:38.436    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:30:38.436    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:30:38.437    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:30:38.437    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:30:38.437    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:30:38.437    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130615-100202-551_L1C_048-255-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/07/11/SPOT5-HRG1-XS_20130711-100040-803_L1C_048-254-0_D_V1-0/SPOT5-HRG1-XS_20130711-100040-803_L1C_048-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130711-100040-803_L1C_048-254-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130711-100040-803_L1C_048-254-0_D_V1-0.zip
run script
2024-01-09T21:31:15.269    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:31:15.270    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130711-100040-803_L1C_048-254-0_D_V1-0.zip
2024-01-09T21:31:15.271    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:31:15.271    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:31:15.271    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:31:15.271    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:31:15.271    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:31:15.271    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:31:15.271    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:31:15.271    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130711-100040-803_L1C_048-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/07/11/SPOT5-HRG1-XS_20130711-100049-033_L1C_048-255-0_D_V1-0/SPOT5-HRG1-XS_20130711-100049-033_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130711-100049-033_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130711-100049-033_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T21:31:21.419    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:31:21.420    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130711-100049-033_L1C_048-255-0_D_V1-0.zip
2024-01-09T21:31:21.421    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:31:21.421    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:31:21.421    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:31:21.421    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:31:21.421    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:31:21.421    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:31:21.421    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:31:21.421    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130711-100049-033_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/07/11/SPOT5-HRG1-XS_20130711-100057-239_L1C_048-256-0_D_V1-0/SPOT5-HRG1-XS_20130711-100057-239_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130711-100057-239_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130711-100057-239_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T21:31:51.861    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:31:51.862    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130711-100057-239_L1C_048-256-0_D_V1-0.zip
2024-01-09T21:31:51.863    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:31:51.863    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:31:51.863    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:31:51.863    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:31:51.863    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:31:51.863    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:31:51.863    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:31:51.863    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130711-100057-239_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/07/11/SPOT5-HRG1-XS_20130711-100059-044_L1C_048-256-2_D_V1-0/SPOT5-HRG1-XS_20130711-100059-044_L1C_048-256-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130711-100059-044_L1C_048-256-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130711-100059-044_L1C_048-256-2_D_V1-0.zip
run script
2024-01-09T21:32:51.599    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:32:51.601    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130711-100059-044_L1C_048-256-2_D_V1-0.zip
2024-01-09T21:32:51.601    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:32:51.601    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:32:51.601    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:32:51.601    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:32:51.601    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:32:51.601    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:32:51.601    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:32:51.601    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130711-100059-044_L1C_048-256-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/07/11/SPOT5-HRG2-XS_20130711-100039-204_L1C_049-254-0_D_V1-0/SPOT5-HRG2-XS_20130711-100039-204_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130711-100039-204_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130711-100039-204_L1C_049-254-0_D_V1-0.zip
run script
2024-01-09T21:33:43.371    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:33:43.373    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130711-100039-204_L1C_049-254-0_D_V1-0.zip
2024-01-09T21:33:43.373    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:33:43.373    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:33:43.373    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:33:43.373    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:33:43.373    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:33:43.373    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:33:43.373    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:33:43.383    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130711-100039-204_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/07/11/SPOT5-HRG2-XS_20130711-100047-409_L1C_049-255-0_D_V1-0/SPOT5-HRG2-XS_20130711-100047-409_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130711-100047-409_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130711-100047-409_L1C_049-255-0_D_V1-0.zip
run script
2024-01-09T21:33:49.154    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:33:49.155    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130711-100047-409_L1C_049-255-0_D_V1-0.zip
2024-01-09T21:33:49.155    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:33:49.155    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:33:49.156    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:33:49.156    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:33:49.156    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:33:49.156    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:33:49.156    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:33:49.156    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130711-100047-409_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/07/11/SPOT5-HRG2-XS_20130711-100048-324_L1C_049-255-1_D_V1-0/SPOT5-HRG2-XS_20130711-100048-324_L1C_049-255-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130711-100048-324_L1C_049-255-1_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130711-100048-324_L1C_049-255-1_D_V1-0.zip
run script
2024-01-09T21:34:52.154    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:34:52.155    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130711-100048-324_L1C_049-255-1_D_V1-0.zip
2024-01-09T21:34:52.155    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:34:52.156    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:34:52.156    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:34:52.156    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:34:52.156    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:34:52.156    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:34:52.156    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:34:52.156    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130711-100048-324_L1C_049-255-1_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/07/11/SPOT5-HRG1-XS_20130711-100139-149_L1C_052-261-6_D_V1-0/SPOT5-HRG1-XS_20130711-100139-149_L1C_052-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130711-100139-149_L1C_052-261-6_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130711-100139-149_L1C_052-261-6_D_V1-0.zip
run script
2024-01-09T21:36:13.839    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:36:13.840    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130711-100139-149_L1C_052-261-6_D_V1-0.zip
2024-01-09T21:36:13.840    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:36:13.840    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:36:13.841    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:36:13.841    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:36:13.841    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:36:13.841    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:36:13.841    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:36:13.841    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T21:39:52.271    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 91). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130711-100139-149_L1C_052-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2013/07/11/SPOT5-HRG1-XS_20130711-100142-037_L1C_052-262-0_D_V1-0/SPOT5-HRG1-XS_20130711-100142-037_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130711-100142-037_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130711-100142-037_L1C_052-262-0_D_V1-0.zip
run script
2024-01-09T21:39:57.885    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:39:57.887    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130711-100142-037_L1C_052-262-0_D_V1-0.zip
2024-01-09T21:39:57.887    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:39:57.887    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:39:57.887    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:39:57.887    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:39:57.887    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:39:57.887    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:39:57.887    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:39:57.887    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130711-100142-037_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/07/11/SPOT5-HRG1-XS_20130711-100142-927_L1C_052-262-1_D_V1-0/SPOT5-HRG1-XS_20130711-100142-927_L1C_052-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130711-100142-927_L1C_052-262-1_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130711-100142-927_L1C_052-262-1_D_V1-0.zip
run script
2024-01-09T21:43:25.275    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:43:25.277    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130711-100142-927_L1C_052-262-1_D_V1-0.zip
2024-01-09T21:43:25.277    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:43:25.277    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:43:25.277    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:43:25.277    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:43:25.277    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:43:25.277    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:43:25.277    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:43:25.277    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130711-100142-927_L1C_052-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/07/11/SPOT5-HRG2-XS_20130711-100135-176_L1C_055-261-6_D_V1-0/SPOT5-HRG2-XS_20130711-100135-176_L1C_055-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130711-100135-176_L1C_055-261-6_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130711-100135-176_L1C_055-261-6_D_V1-0.zip
run script
2024-01-09T21:46:38.629    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:46:38.630    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130711-100135-176_L1C_055-261-6_D_V1-0.zip
2024-01-09T21:46:38.630    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:46:38.630    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:46:38.630    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:46:38.630    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:46:38.630    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:46:38.630    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:46:38.630    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:46:38.630    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T21:48:00.694    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 534). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130711-100135-176_L1C_055-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2013/07/11/SPOT5-HRG2-XS_20130711-100138-064_L1C_055-262-0_D_V1-0/SPOT5-HRG2-XS_20130711-100138-064_L1C_055-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130711-100138-064_L1C_055-262-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130711-100138-064_L1C_055-262-0_D_V1-0.zip
run script
2024-01-09T21:48:04.438    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:48:04.439    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130711-100138-064_L1C_055-262-0_D_V1-0.zip
2024-01-09T21:48:04.439    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:48:04.439    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:48:04.439    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:48:04.439    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:48:04.439    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:48:04.439    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:48:04.439    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:48:04.439    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130711-100138-064_L1C_055-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/07/11/SPOT5-HRG2-XS_20130711-100139-868_L1C_055-262-2_D_V1-0/SPOT5-HRG2-XS_20130711-100139-868_L1C_055-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130711-100139-868_L1C_055-262-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130711-100139-868_L1C_055-262-2_D_V1-0.zip
run script
2024-01-09T21:49:36.020    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:49:36.022    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130711-100139-868_L1C_055-262-2_D_V1-0.zip
2024-01-09T21:49:36.022    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:49:36.022    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:49:36.022    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:49:36.022    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:49:36.022    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:49:36.022    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:49:36.022    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:49:36.022    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130711-100139-868_L1C_055-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/07/16/SPOT5-HRG1-XS_20130716-100417-154_L1C_048-254-0_D_V1-0/SPOT5-HRG1-XS_20130716-100417-154_L1C_048-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130716-100417-154_L1C_048-254-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130716-100417-154_L1C_048-254-0_D_V1-0.zip
run script
2024-01-09T21:51:14.907    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:51:14.908    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130716-100417-154_L1C_048-254-0_D_V1-0.zip
2024-01-09T21:51:14.908    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:51:14.908    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:51:14.908    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:51:14.908    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:51:14.908    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:51:14.908    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:51:14.908    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:51:14.908    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130716-100417-154_L1C_048-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/07/16/SPOT5-HRG1-XS_20130716-100425-384_L1C_048-255-0_D_V1-0/SPOT5-HRG1-XS_20130716-100425-384_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130716-100425-384_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130716-100425-384_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T21:51:19.968    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:51:19.969    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130716-100425-384_L1C_048-255-0_D_V1-0.zip
2024-01-09T21:51:19.969    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:51:19.969    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:51:19.969    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:51:19.969    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:51:19.969    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:51:19.969    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:51:19.969    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:51:19.970    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130716-100425-384_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/07/16/SPOT5-HRG1-XS_20130716-100433-614_L1C_048-256-0_D_V1-0/SPOT5-HRG1-XS_20130716-100433-614_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130716-100433-614_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130716-100433-614_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T21:51:47.850    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:51:47.851    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130716-100433-614_L1C_048-256-0_D_V1-0.zip
2024-01-09T21:51:47.851    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:51:47.851    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:51:47.853    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:51:47.853    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:51:47.853    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:51:47.853    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:51:47.853    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:51:47.853    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130716-100433-614_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/07/16/SPOT5-HRG1-XS_20130716-100435-419_L1C_048-256-2_D_V1-0/SPOT5-HRG1-XS_20130716-100435-419_L1C_048-256-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130716-100435-419_L1C_048-256-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130716-100435-419_L1C_048-256-2_D_V1-0.zip
run script
2024-01-09T21:52:39.245    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:52:39.246    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130716-100435-419_L1C_048-256-2_D_V1-0.zip
2024-01-09T21:52:39.246    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:52:39.246    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:52:39.246    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:52:39.246    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:52:39.246    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:52:39.246    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:52:39.246    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:52:39.246    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130716-100435-419_L1C_048-256-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/07/16/SPOT5-HRG1-XS_20130716-100506-112_L1C_048-259-9_D_V1-0/SPOT5-HRG1-XS_20130716-100506-112_L1C_048-259-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130716-100506-112_L1C_048-259-9_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130716-100506-112_L1C_048-259-9_D_V1-0.zip
run script
2024-01-09T21:53:23.647    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:53:23.648    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130716-100506-112_L1C_048-259-9_D_V1-0.zip
2024-01-09T21:53:23.648    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:53:23.648    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:53:23.648    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:53:23.648    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:53:23.648    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:53:23.649    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:53:23.649    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:53:23.649    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130716-100506-112_L1C_048-259-9_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/07/16/SPOT5-HRG1-XS_20130716-100506-232_L1C_048-260-0_D_V1-0/SPOT5-HRG1-XS_20130716-100506-232_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130716-100506-232_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130716-100506-232_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T21:53:29.922    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:53:29.924    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130716-100506-232_L1C_048-260-0_D_V1-0.zip
2024-01-09T21:53:29.924    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:53:29.924    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:53:29.924    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:53:29.924    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:53:29.924    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:53:29.924    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:53:29.924    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:53:29.924    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130716-100506-232_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/07/16/SPOT5-HRG1-XS_20130716-100508-951_L1C_048-260-3_D_V1-0/SPOT5-HRG1-XS_20130716-100508-951_L1C_048-260-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130716-100508-951_L1C_048-260-3_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130716-100508-951_L1C_048-260-3_D_V1-0.zip
run script
2024-01-09T21:53:35.436    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:53:35.437    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130716-100508-951_L1C_048-260-3_D_V1-0.zip
2024-01-09T21:53:35.438    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:53:35.438    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:53:35.438    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:53:35.438    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:53:35.438    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:53:35.438    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:53:35.438    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:53:35.438    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130716-100508-951_L1C_048-260-3_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/03/27/SPOT5-HRG1-XS_20130327-104433-079_L1C_048-256-6_D_V1-0/SPOT5-HRG1-XS_20130327-104433-079_L1C_048-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130327-104433-079_L1C_048-256-6_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130327-104433-079_L1C_048-256-6_D_V1-0.zip
run script
2024-01-09T21:53:40.634    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:53:40.636    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130327-104433-079_L1C_048-256-6_D_V1-0.zip
2024-01-09T21:53:40.636    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:53:40.636    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:53:40.636    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:53:40.636    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:53:40.636    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:53:40.636    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:53:40.636    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:53:40.636    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130327-104433-079_L1C_048-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/03/27/SPOT5-HRG1-XS_20130327-104436-087_L1C_048-257-0_D_V1-0/SPOT5-HRG1-XS_20130327-104436-087_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130327-104436-087_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130327-104436-087_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T21:55:01.990    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:55:01.992    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130327-104436-087_L1C_048-257-0_D_V1-0.zip
2024-01-09T21:55:01.992    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:55:01.992    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:55:01.992    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:55:01.992    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:55:01.992    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:55:01.992    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:55:01.992    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:55:01.992    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130327-104436-087_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/03/27/SPOT5-HRG1-XS_20130327-104444-509_L1C_048-258-0_D_V1-0/SPOT5-HRG1-XS_20130327-104444-509_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130327-104444-509_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130327-104444-509_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T21:56:06.237    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:56:06.238    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130327-104444-509_L1C_048-258-0_D_V1-0.zip
2024-01-09T21:56:06.238    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:56:06.238    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:56:06.238    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:56:06.238    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:56:06.238    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:56:06.238    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:56:06.238    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:56:06.238    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T21:56:23.287    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 14). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130327-104444-509_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2013/03/27/SPOT5-HRG1-XS_20130327-104452-932_L1C_048-259-0_D_V1-0/SPOT5-HRG1-XS_20130327-104452-932_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130327-104452-932_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130327-104452-932_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T21:56:29.162    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:56:29.163    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130327-104452-932_L1C_048-259-0_D_V1-0.zip
2024-01-09T21:56:29.163    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:56:29.164    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:56:29.164    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:56:29.164    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:56:29.164    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:56:29.164    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:56:29.164    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:56:29.164    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130327-104452-932_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/03/27/SPOT5-HRG1-XS_20130327-104501-378_L1C_048-260-0_D_V1-0/SPOT5-HRG1-XS_20130327-104501-378_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130327-104501-378_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130327-104501-378_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T21:56:35.045    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:56:35.046    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130327-104501-378_L1C_048-260-0_D_V1-0.zip
2024-01-09T21:56:35.046    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:56:35.046    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:56:35.046    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:56:35.046    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:56:35.046    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:56:35.046    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:56:35.046    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:56:35.046    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130327-104501-378_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/03/27/SPOT5-HRG1-XS_20130327-104503-183_L1C_048-260-2_D_V1-0/SPOT5-HRG1-XS_20130327-104503-183_L1C_048-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130327-104503-183_L1C_048-260-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130327-104503-183_L1C_048-260-2_D_V1-0.zip
run script
2024-01-09T21:56:41.171    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:56:41.173    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130327-104503-183_L1C_048-260-2_D_V1-0.zip
2024-01-09T21:56:41.173    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:56:41.173    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:56:41.173    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:56:41.173    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:56:41.173    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:56:41.173    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:56:41.173    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:56:41.173    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130327-104503-183_L1C_048-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/04/03/SPOT5-HRG1-XS_20130403-100934-942_L1C_048-256-6_D_V1-0/SPOT5-HRG1-XS_20130403-100934-942_L1C_048-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130403-100934-942_L1C_048-256-6_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130403-100934-942_L1C_048-256-6_D_V1-0.zip
run script
2024-01-09T21:56:46.522    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:56:46.523    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130403-100934-942_L1C_048-256-6_D_V1-0.zip
2024-01-09T21:56:46.523    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:56:46.523    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:56:46.523    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:56:46.523    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:56:46.523    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:56:46.523    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:56:46.523    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:56:46.523    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130403-100934-942_L1C_048-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/03/SPOT5-HRG1-XS_20130403-100937-757_L1C_048-257-0_D_V1-0/SPOT5-HRG1-XS_20130403-100937-757_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130403-100937-757_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130403-100937-757_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T21:57:10.103    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:57:10.104    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130403-100937-757_L1C_048-257-0_D_V1-0.zip
2024-01-09T21:57:10.104    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:57:10.104    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:57:10.104    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:57:10.104    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:57:10.105    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:57:10.105    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:57:10.105    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:57:10.105    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T21:57:14.572    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (95 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130403-100937-757_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2013/04/03/SPOT5-HRG1-XS_20130403-100946-011_L1C_048-258-0_D_V1-0/SPOT5-HRG1-XS_20130403-100946-011_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130403-100946-011_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130403-100946-011_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T21:57:20.023    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:57:20.025    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130403-100946-011_L1C_048-258-0_D_V1-0.zip
2024-01-09T21:57:20.025    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:57:20.025    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:57:20.025    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:57:20.025    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:57:20.025    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:57:20.025    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:57:20.025    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:57:20.025    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130403-100946-011_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/04/03/SPOT5-HRG1-XS_20130403-100954-265_L1C_048-259-0_D_V1-0/SPOT5-HRG1-XS_20130403-100954-265_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130403-100954-265_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130403-100954-265_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T21:57:25.611    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:57:25.613    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130403-100954-265_L1C_048-259-0_D_V1-0.zip
2024-01-09T21:57:25.613    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:57:25.613    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:57:25.613    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:57:25.613    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:57:25.613    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:57:25.613    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:57:25.613    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:57:25.613    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130403-100954-265_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/04/03/SPOT5-HRG1-XS_20130403-100956-070_L1C_048-259-2_D_V1-0/SPOT5-HRG1-XS_20130403-100956-070_L1C_048-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130403-100956-070_L1C_048-259-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130403-100956-070_L1C_048-259-2_D_V1-0.zip
run script
2024-01-09T21:57:31.082    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:57:31.084    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130403-100956-070_L1C_048-259-2_D_V1-0.zip
2024-01-09T21:57:31.084    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:57:31.084    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:57:31.084    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:57:31.084    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:57:31.084    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:57:31.084    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:57:31.084    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:57:31.084    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130403-100956-070_L1C_048-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/04/03/SPOT5-HRG1-XS_20130403-101007-945_L1C_048-260-6_D_V1-0/SPOT5-HRG1-XS_20130403-101007-945_L1C_048-260-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130403-101007-945_L1C_048-260-6_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130403-101007-945_L1C_048-260-6_D_V1-0.zip
run script
2024-01-09T21:57:36.752    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:57:36.755    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130403-101007-945_L1C_048-260-6_D_V1-0.zip
2024-01-09T21:57:36.755    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:57:36.755    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:57:36.755    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:57:36.755    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:57:36.755    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:57:36.755    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:57:36.755    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:57:36.755    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130403-101007-945_L1C_048-260-6_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/04/03/SPOT5-HRG1-XS_20130403-101010-809_L1C_048-261-0_D_V1-0/SPOT5-HRG1-XS_20130403-101010-809_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130403-101010-809_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130403-101010-809_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T21:57:42.655    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:57:42.656    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130403-101010-809_L1C_048-261-0_D_V1-0.zip
2024-01-09T21:57:42.656    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:57:42.656    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:57:42.656    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:57:42.656    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:57:42.656    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:57:42.657    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:57:42.657    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:57:42.657    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130403-101010-809_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/04/03/SPOT5-HRG2-XS_20130403-101011-943_L1C_051-261-6_D_V1-0/SPOT5-HRG2-XS_20130403-101011-943_L1C_051-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130403-101011-943_L1C_051-261-6_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130403-101011-943_L1C_051-261-6_D_V1-0.zip
run script
2024-01-09T21:57:48.301    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:57:48.302    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130403-101011-943_L1C_051-261-6_D_V1-0.zip
2024-01-09T21:57:48.302    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:57:48.302    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:57:48.302    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:57:48.302    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:57:48.302    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:57:48.302    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:57:48.302    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:57:48.302    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130403-101011-943_L1C_051-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/03/SPOT5-HRG2-XS_20130403-101013-748_L1C_051-261-8_D_V1-0/SPOT5-HRG2-XS_20130403-101013-748_L1C_051-261-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130403-101013-748_L1C_051-261-8_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130403-101013-748_L1C_051-261-8_D_V1-0.zip
run script
2024-01-09T22:00:29.698    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:00:29.699    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130403-101013-748_L1C_051-261-8_D_V1-0.zip
2024-01-09T22:00:29.700    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:00:29.700    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:00:29.700    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:00:29.700    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:00:29.700    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:00:29.700    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:00:29.700    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:00:29.700    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130403-101013-748_L1C_051-261-8_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/06/04/SPOT5-HRG1-XS_20130604-101421-882_L1C_048-256-6_D_V1-0/SPOT5-HRG1-XS_20130604-101421-882_L1C_048-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130604-101421-882_L1C_048-256-6_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130604-101421-882_L1C_048-256-6_D_V1-0.zip
run script
2024-01-09T22:03:05.194    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:03:05.195    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130604-101421-882_L1C_048-256-6_D_V1-0.zip
2024-01-09T22:03:05.195    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:03:05.195    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:03:05.195    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:03:05.195    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:03:05.195    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:03:05.195    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:03:05.196    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:03:05.196    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130604-101421-882_L1C_048-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/06/04/SPOT5-HRG1-XS_20130604-101424-721_L1C_048-257-0_D_V1-0/SPOT5-HRG1-XS_20130604-101424-721_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130604-101424-721_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130604-101424-721_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T22:03:38.795    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:03:38.796    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130604-101424-721_L1C_048-257-0_D_V1-0.zip
2024-01-09T22:03:38.796    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:03:38.797    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:03:38.797    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:03:38.797    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:03:38.797    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:03:38.797    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:03:38.797    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:03:38.797    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130604-101424-721_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/06/04/SPOT5-HRG1-XS_20130604-101426-526_L1C_048-257-2_D_V1-0/SPOT5-HRG1-XS_20130604-101426-526_L1C_048-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130604-101426-526_L1C_048-257-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130604-101426-526_L1C_048-257-2_D_V1-0.zip
run script
2024-01-09T22:04:04.234    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:04:04.235    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130604-101426-526_L1C_048-257-2_D_V1-0.zip
2024-01-09T22:04:04.235    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:04:04.236    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:04:04.236    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:04:04.236    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:04:04.236    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:04:04.236    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:04:04.236    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:04:04.236    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130604-101426-526_L1C_048-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/06/25/SPOT5-HRG1-XS_20130625-100928-688_L1C_048-256-6_D_V1-0/SPOT5-HRG1-XS_20130625-100928-688_L1C_048-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130625-100928-688_L1C_048-256-6_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130625-100928-688_L1C_048-256-6_D_V1-0.zip
run script
2024-01-09T22:04:25.036    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:04:25.037    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130625-100928-688_L1C_048-256-6_D_V1-0.zip
2024-01-09T22:04:25.037    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:04:25.037    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:04:25.037    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:04:25.037    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:04:25.038    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:04:25.038    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:04:25.038    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:04:25.038    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130625-100928-688_L1C_048-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/06/25/SPOT5-HRG1-XS_20130625-100932-418_L1C_048-257-1_D_V1-0/SPOT5-HRG1-XS_20130625-100932-418_L1C_048-257-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130625-100932-418_L1C_048-257-1_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130625-100932-418_L1C_048-257-1_D_V1-0.zip
run script
2024-01-09T22:04:59.537    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:04:59.538    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130625-100932-418_L1C_048-257-1_D_V1-0.zip
2024-01-09T22:04:59.538    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:04:59.538    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:04:59.538    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:04:59.538    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:04:59.538    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:04:59.538    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:04:59.538    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:04:59.539    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130625-100932-418_L1C_048-257-1_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/08/06/SPOT5-HRG1-XS_20130806-095938-846_L1C_048-256-6_D_V1-0/SPOT5-HRG1-XS_20130806-095938-846_L1C_048-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130806-095938-846_L1C_048-256-6_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130806-095938-846_L1C_048-256-6_D_V1-0.zip
run script
2024-01-09T22:05:24.983    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:05:24.984    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130806-095938-846_L1C_048-256-6_D_V1-0.zip
2024-01-09T22:05:24.984    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:05:24.985    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:05:24.985    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:05:24.985    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:05:24.985    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:05:24.985    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:05:24.985    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:05:24.985    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130806-095938-846_L1C_048-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/08/06/SPOT5-HRG1-XS_20130806-095941-662_L1C_048-257-0_D_V1-0/SPOT5-HRG1-XS_20130806-095941-662_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130806-095941-662_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130806-095941-662_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T22:06:04.994    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:06:04.995    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130806-095941-662_L1C_048-257-0_D_V1-0.zip
2024-01-09T22:06:04.995    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:06:04.995    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:06:04.995    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:06:04.995    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:06:04.995    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:06:04.995    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:06:04.995    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:06:04.996    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130806-095941-662_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/08/06/SPOT5-HRG1-XS_20130806-095943-467_L1C_048-257-2_D_V1-0/SPOT5-HRG1-XS_20130806-095943-467_L1C_048-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130806-095943-467_L1C_048-257-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130806-095943-467_L1C_048-257-2_D_V1-0.zip
run script
2024-01-09T22:06:39.242    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:06:39.243    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130806-095943-467_L1C_048-257-2_D_V1-0.zip
2024-01-09T22:06:39.243    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:06:39.243    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:06:39.243    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:06:39.243    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:06:39.243    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:06:39.243    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:06:39.243    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:06:39.243    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130806-095943-467_L1C_048-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/08/06/SPOT5-HRG2-XS_20130806-095915-146_L1C_049-254-0_D_V1-0/SPOT5-HRG2-XS_20130806-095915-146_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130806-095915-146_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130806-095915-146_L1C_049-254-0_D_V1-0.zip
run script
2024-01-09T22:07:07.005    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:07:07.007    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130806-095915-146_L1C_049-254-0_D_V1-0.zip
2024-01-09T22:07:07.007    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:07:07.007    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:07:07.007    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:07:07.007    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:07:07.007    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:07:07.007    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:07:07.007    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:07:07.007    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130806-095915-146_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/08/06/SPOT5-HRG2-XS_20130806-095923-376_L1C_049-255-0_D_V1-0/SPOT5-HRG2-XS_20130806-095923-376_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130806-095923-376_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130806-095923-376_L1C_049-255-0_D_V1-0.zip
run script
2024-01-09T22:07:12.160    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:07:12.161    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130806-095923-376_L1C_049-255-0_D_V1-0.zip
2024-01-09T22:07:12.161    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:07:12.161    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:07:12.161    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:07:12.161    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:07:12.161    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:07:12.162    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:07:12.162    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:07:12.162    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130806-095923-376_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/08/06/SPOT5-HRG2-XS_20130806-095958-539_L1C_052-259-6_D_V1-0/SPOT5-HRG2-XS_20130806-095958-539_L1C_052-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130806-095958-539_L1C_052-259-6_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130806-095958-539_L1C_052-259-6_D_V1-0.zip
run script
2024-01-09T22:08:18.105    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:08:18.106    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130806-095958-539_L1C_052-259-6_D_V1-0.zip
2024-01-09T22:08:18.106    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:08:18.106    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:08:18.107    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:08:18.107    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:08:18.107    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:08:18.107    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:08:18.107    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:08:18.107    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130806-095958-539_L1C_052-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 1 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 1 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/08/06/SPOT5-HRG2-XS_20130806-100001-403_L1C_052-260-0_D_V1-0/SPOT5-HRG2-XS_20130806-100001-403_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130806-100001-403_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130806-100001-403_L1C_052-260-0_D_V1-0.zip
run script
2024-01-09T22:12:24.957    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:12:24.958    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130806-100001-403_L1C_052-260-0_D_V1-0.zip
2024-01-09T22:12:24.958    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:12:24.958    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:12:24.958    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:12:24.958    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:12:24.958    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:12:24.959    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:12:24.959    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:12:24.959    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130806-100001-403_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/08/06/SPOT5-HRG2-XS_20130806-100009-681_L1C_052-261-0_D_V1-0/SPOT5-HRG2-XS_20130806-100009-681_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130806-100009-681_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130806-100009-681_L1C_052-261-0_D_V1-0.zip
run script
2024-01-09T22:16:07.210    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:16:07.211    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130806-100009-681_L1C_052-261-0_D_V1-0.zip
2024-01-09T22:16:07.211    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:16:07.211    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:16:07.211    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:16:07.211    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:16:07.211    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:16:07.211    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:16:07.211    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:16:07.211    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130806-100009-681_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/08/06/SPOT5-HRG2-XS_20130806-100011-486_L1C_052-261-2_D_V1-0/SPOT5-HRG2-XS_20130806-100011-486_L1C_052-261-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130806-100011-486_L1C_052-261-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130806-100011-486_L1C_052-261-2_D_V1-0.zip
run script
2024-01-09T22:20:02.426    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:20:02.428    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130806-100011-486_L1C_052-261-2_D_V1-0.zip
2024-01-09T22:20:02.428    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:20:02.428    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:20:02.428    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:20:02.428    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:20:02.428    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:20:02.428    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:20:02.428    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:20:02.428    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130806-100011-486_L1C_052-261-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/08/31/SPOT5-HRG1-XS_20130831-101740-888_L1C_048-256-6_D_V1-0/SPOT5-HRG1-XS_20130831-101740-888_L1C_048-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130831-101740-888_L1C_048-256-6_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130831-101740-888_L1C_048-256-6_D_V1-0.zip
run script
2024-01-09T22:24:00.087    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:24:00.088    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130831-101740-888_L1C_048-256-6_D_V1-0.zip
2024-01-09T22:24:00.088    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:24:00.088    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:24:00.088    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:24:00.088    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:24:00.088    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:24:00.088    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:24:00.088    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:24:00.088    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130831-101740-888_L1C_048-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/08/31/SPOT5-HRG1-XS_20130831-101743-752_L1C_048-257-0_D_V1-0/SPOT5-HRG1-XS_20130831-101743-752_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130831-101743-752_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130831-101743-752_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T22:24:36.094    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:24:36.095    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130831-101743-752_L1C_048-257-0_D_V1-0.zip
2024-01-09T22:24:36.095    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:24:36.095    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:24:36.095    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:24:36.095    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:24:36.095    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:24:36.095    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:24:36.095    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:24:36.095    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130831-101743-752_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/08/31/SPOT5-HRG1-XS_20130831-101745-557_L1C_048-257-2_D_V1-0/SPOT5-HRG1-XS_20130831-101745-557_L1C_048-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130831-101745-557_L1C_048-257-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130831-101745-557_L1C_048-257-2_D_V1-0.zip
run script
2024-01-09T22:25:00.434    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:25:00.436    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130831-101745-557_L1C_048-257-2_D_V1-0.zip
2024-01-09T22:25:00.436    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:25:00.436    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:25:00.436    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:25:00.436    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:25:00.436    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:25:00.436    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:25:00.436    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:25:00.436    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0ERROR 1: /tmp/slurm-4016224/OUTPUT/SPOT5/2013/8/31/SPOT5-HRG1-XS_20130831-101745-557_L1C_048-257-2_C_V1-0/31TGL/FSC_20130831T101745_SPOT5_31TGL/nodata.tif, band 1: Split bands are read-only.
...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130831-101745-557_L1C_048-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/09/01/SPOT5-HRG1-XS_20130901-095821-769_L1C_048-256-7_D_V1-0/SPOT5-HRG1-XS_20130901-095821-769_L1C_048-256-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130901-095821-769_L1C_048-256-7_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130901-095821-769_L1C_048-256-7_D_V1-0.zip
run script
2024-01-09T22:25:17.410    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:25:17.411    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130901-095821-769_L1C_048-256-7_D_V1-0.zip
2024-01-09T22:25:17.411    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:25:17.411    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:25:17.411    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:25:17.411    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:25:17.411    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:25:17.411    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:25:17.411    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:25:17.412    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130901-095821-769_L1C_048-256-7_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/09/01/SPOT5-HRG1-XS_20130901-095823-670_L1C_048-257-0_D_V1-0/SPOT5-HRG1-XS_20130901-095823-670_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130901-095823-670_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130901-095823-670_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T22:25:55.602    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:25:55.603    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130901-095823-670_L1C_048-257-0_D_V1-0.zip
2024-01-09T22:25:55.603    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:25:55.603    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:25:55.603    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:25:55.603    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:25:55.603    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:25:55.603    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:25:55.604    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:25:55.604    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130901-095823-670_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [2 0 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/09/01/SPOT5-HRG1-XS_20130901-095825-475_L1C_048-257-2_D_V1-0/SPOT5-HRG1-XS_20130901-095825-475_L1C_048-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130901-095825-475_L1C_048-257-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130901-095825-475_L1C_048-257-2_D_V1-0.zip
run script
2024-01-09T22:26:31.953    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:26:31.954    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130901-095825-475_L1C_048-257-2_D_V1-0.zip
2024-01-09T22:26:31.954    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:26:31.954    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:26:31.954    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:26:31.954    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:26:31.954    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:26:31.954    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:26:31.954    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:26:31.954    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130901-095825-475_L1C_048-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/09/01/SPOT5-HRG2-XS_20130901-095844-939_L1C_055-260-6_D_V1-0/SPOT5-HRG2-XS_20130901-095844-939_L1C_055-260-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130901-095844-939_L1C_055-260-6_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130901-095844-939_L1C_055-260-6_D_V1-0.zip
run script
2024-01-09T22:27:00.317    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:27:00.318    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130901-095844-939_L1C_055-260-6_D_V1-0.zip
2024-01-09T22:27:00.318    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:27:00.319    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:27:00.319    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:27:00.319    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:27:00.319    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:27:00.319    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:27:00.319    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:27:00.319    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130901-095844-939_L1C_055-260-6_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 2 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/09/01/SPOT5-HRG2-XS_20130901-095847-827_L1C_055-261-0_D_V1-0/SPOT5-HRG2-XS_20130901-095847-827_L1C_055-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130901-095847-827_L1C_055-261-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130901-095847-827_L1C_055-261-0_D_V1-0.zip
run script
2024-01-09T22:28:11.254    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:28:11.256    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130901-095847-827_L1C_055-261-0_D_V1-0.zip
2024-01-09T22:28:11.256    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:28:11.256    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:28:11.256    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:28:11.256    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:28:11.256    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:28:11.256    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:28:11.256    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:28:11.256    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130901-095847-827_L1C_055-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/09/01/SPOT5-HRG2-XS_20130901-095849-632_L1C_055-261-2_D_V1-0/SPOT5-HRG2-XS_20130901-095849-632_L1C_055-261-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130901-095849-632_L1C_055-261-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130901-095849-632_L1C_055-261-2_D_V1-0.zip
run script
2024-01-09T22:29:27.911    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:29:27.912    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130901-095849-632_L1C_055-261-2_D_V1-0.zip
2024-01-09T22:29:27.912    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:29:27.912    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:29:27.912    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:29:27.913    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:29:27.913    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:29:27.913    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:29:27.913    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:29:27.913    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130901-095849-632_L1C_055-261-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/09/22/SPOT5-HRG2-XS_20130922-095336-645_L1C_048-257-9_D_V1-0/SPOT5-HRG2-XS_20130922-095336-645_L1C_048-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130922-095336-645_L1C_048-257-9_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130922-095336-645_L1C_048-257-9_D_V1-0.zip
run script
2024-01-09T22:30:56.489    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:30:56.490    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130922-095336-645_L1C_048-257-9_D_V1-0.zip
2024-01-09T22:30:56.490    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:30:56.490    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:30:56.490    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:30:56.490    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:30:56.490    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:30:56.490    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:30:56.490    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:30:56.491    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:31:41.045    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 130). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130922-095336-645_L1C_048-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2013/09/22/SPOT5-HRG2-XS_20130922-095336-741_L1C_048-258-0_D_V1-0/SPOT5-HRG2-XS_20130922-095336-741_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130922-095336-741_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130922-095336-741_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T22:31:45.912    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:31:45.914    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130922-095336-741_L1C_048-258-0_D_V1-0.zip
2024-01-09T22:31:45.914    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:31:45.914    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:31:45.914    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:31:45.914    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:31:45.914    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:31:45.914    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:31:45.914    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:31:45.914    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:32:32.124    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 522). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130922-095336-741_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2013/09/22/SPOT5-HRG2-XS_20130922-095338-546_L1C_048-258-2_D_V1-0/SPOT5-HRG2-XS_20130922-095338-546_L1C_048-258-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130922-095338-546_L1C_048-258-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130922-095338-546_L1C_048-258-2_D_V1-0.zip
run script
2024-01-09T22:32:37.521    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:32:37.522    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130922-095338-546_L1C_048-258-2_D_V1-0.zip
2024-01-09T22:32:37.522    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:32:37.523    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:32:37.523    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:32:37.523    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:32:37.523    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:32:37.523    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:32:37.523    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:32:37.523    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130922-095338-546_L1C_048-258-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/10/28/SPOT5-HRG2-XS_20131028-095919-528_L1C_048-257-9_D_V1-0/SPOT5-HRG2-XS_20131028-095919-528_L1C_048-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20131028-095919-528_L1C_048-257-9_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131028-095919-528_L1C_048-257-9_D_V1-0.zip
run script
2024-01-09T22:33:21.545    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:33:21.548    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131028-095919-528_L1C_048-257-9_D_V1-0.zip
2024-01-09T22:33:21.552    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:33:21.554    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:33:21.557    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:33:21.560    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:33:21.563    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:33:21.566    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:33:21.569    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:33:21.571    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:34:02.726    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 226). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131028-095919-528_L1C_048-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2013/10/28/SPOT5-HRG2-XS_20131028-095919-648_L1C_048-258-0_D_V1-0/SPOT5-HRG2-XS_20131028-095919-648_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20131028-095919-648_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131028-095919-648_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T22:34:08.765    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:34:08.766    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131028-095919-648_L1C_048-258-0_D_V1-0.zip
2024-01-09T22:34:08.766    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:34:08.766    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:34:08.766    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:34:08.766    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:34:08.766    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:34:08.766    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:34:08.766    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:34:08.767    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:34:50.022    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (0 x 908). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131028-095919-648_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2013/10/28/SPOT5-HRG2-XS_20131028-095927-926_L1C_048-259-0_D_V1-0/SPOT5-HRG2-XS_20131028-095927-926_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20131028-095927-926_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131028-095927-926_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T22:34:55.919    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:34:55.921    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131028-095927-926_L1C_048-259-0_D_V1-0.zip
2024-01-09T22:34:55.921    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:34:55.921    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:34:55.921    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:34:55.921    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:34:55.921    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:34:55.921    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:34:55.921    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:34:55.921    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131028-095927-926_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/10/28/SPOT5-HRG2-XS_20131028-095949-979_L1C_049-261-7_D_V1-0/SPOT5-HRG2-XS_20131028-095949-979_L1C_049-261-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20131028-095949-979_L1C_049-261-7_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131028-095949-979_L1C_049-261-7_D_V1-0.zip
run script
2024-01-09T22:35:22.283    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:35:22.285    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131028-095949-979_L1C_049-261-7_D_V1-0.zip
2024-01-09T22:35:22.285    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:35:22.285    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:35:22.285    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:35:22.285    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:35:22.285    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:35:22.285    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:35:22.285    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:35:22.285    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:35:29.414    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (228 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131028-095949-979_L1C_049-261-7_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2013/10/28/SPOT5-HRG2-XS_20131028-095951-952_L1C_049-262-0_D_V1-0/SPOT5-HRG2-XS_20131028-095951-952_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20131028-095951-952_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131028-095951-952_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T22:35:35.233    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:35:35.233    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131028-095951-952_L1C_049-262-0_D_V1-0.zip
2024-01-09T22:35:35.233    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:35:35.233    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:35:35.233    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:35:35.234    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:35:35.234    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:35:35.234    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:35:35.234    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:35:35.234    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131028-095951-952_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/10/28/SPOT5-HRG2-XS_20131028-095953-757_L1C_049-262-2_D_V1-0/SPOT5-HRG2-XS_20131028-095953-757_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20131028-095953-757_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131028-095953-757_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T22:35:41.014    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:35:41.015    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131028-095953-757_L1C_049-262-2_D_V1-0.zip
2024-01-09T22:35:41.016    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:35:41.016    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:35:41.016    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:35:41.016    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:35:41.016    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:35:41.016    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:35:41.016    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:35:41.016    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131028-095953-757_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/06/10/SPOT5-HRG1-XS_20130610-095856-539_L1C_048-258-9_D_V1-0/SPOT5-HRG1-XS_20130610-095856-539_L1C_048-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130610-095856-539_L1C_048-258-9_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130610-095856-539_L1C_048-258-9_D_V1-0.zip
run script
2024-01-09T22:35:46.145    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:35:46.146    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130610-095856-539_L1C_048-258-9_D_V1-0.zip
2024-01-09T22:35:46.147    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:35:46.147    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:35:46.147    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:35:46.147    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:35:46.147    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:35:46.147    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:35:46.147    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:35:46.147    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130610-095856-539_L1C_048-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/06/10/SPOT5-HRG1-XS_20130610-095858-440_L1C_048-259-2_D_V1-0/SPOT5-HRG1-XS_20130610-095858-440_L1C_048-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130610-095858-440_L1C_048-259-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130610-095858-440_L1C_048-259-2_D_V1-0.zip
run script
2024-01-09T22:36:19.037    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:36:19.039    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130610-095858-440_L1C_048-259-2_D_V1-0.zip
2024-01-09T22:36:19.039    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:36:19.039    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:36:19.039    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:36:19.039    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:36:19.039    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:36:19.039    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:36:19.039    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:36:19.039    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130610-095858-440_L1C_048-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/12/24/SPOT5-HRG2-XS_20131224-095951-359_L1C_048-258-2_D_V1-0/SPOT5-HRG2-XS_20131224-095951-359_L1C_048-258-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20131224-095951-359_L1C_048-258-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131224-095951-359_L1C_048-258-2_D_V1-0.zip
run script
2024-01-09T22:36:47.164    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:36:47.165    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131224-095951-359_L1C_048-258-2_D_V1-0.zip
2024-01-09T22:36:47.165    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:36:47.165    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:36:47.166    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:36:47.166    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:36:47.166    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:36:47.166    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:36:47.166    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:36:47.166    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131224-095951-359_L1C_048-258-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/12/24/SPOT5-HRG1-XS_20131224-095947-377_L1C_050-257-9_D_V1-0/SPOT5-HRG1-XS_20131224-095947-377_L1C_050-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20131224-095947-377_L1C_050-257-9_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131224-095947-377_L1C_050-257-9_D_V1-0.zip
run script
2024-01-09T22:37:25.279    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:37:25.280    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131224-095947-377_L1C_050-257-9_D_V1-0.zip
2024-01-09T22:37:25.280    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:37:25.280    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:37:25.280    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:37:25.280    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:37:25.280    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:37:25.280    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:37:25.280    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:37:25.280    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:39:49.216    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 428). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131224-095947-377_L1C_050-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2013/12/24/SPOT5-HRG1-XS_20131224-095947-521_L1C_050-258-0_D_V1-0/SPOT5-HRG1-XS_20131224-095947-521_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20131224-095947-521_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131224-095947-521_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T22:39:53.839    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:39:53.840    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131224-095947-521_L1C_050-258-0_D_V1-0.zip
2024-01-09T22:39:53.840    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:39:53.840    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:39:53.840    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:39:53.840    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:39:53.840    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:39:53.840    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:39:53.840    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:39:53.840    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:42:12.007    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 219). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131224-095947-521_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2013/12/24/SPOT5-HRG1-XS_20131224-095949-326_L1C_050-258-2_D_V1-0/SPOT5-HRG1-XS_20131224-095949-326_L1C_050-258-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20131224-095949-326_L1C_050-258-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131224-095949-326_L1C_050-258-2_D_V1-0.zip
run script
2024-01-09T22:42:16.686    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:42:16.687    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131224-095949-326_L1C_050-258-2_D_V1-0.zip
2024-01-09T22:42:16.687    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:42:16.687    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:42:16.687    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:42:16.687    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:42:16.688    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:42:16.688    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:42:16.688    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:42:16.688    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131224-095949-326_L1C_050-258-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/06/03/SPOT5-HRG1-XS_20130603-103404-896_L1C_048-259-6_D_V1-0/SPOT5-HRG1-XS_20130603-103404-896_L1C_048-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130603-103404-896_L1C_048-259-6_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130603-103404-896_L1C_048-259-6_D_V1-0.zip
run script
2024-01-09T22:44:55.502    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:44:55.503    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130603-103404-896_L1C_048-259-6_D_V1-0.zip
2024-01-09T22:44:55.503    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:44:55.503    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:44:55.503    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:44:55.503    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:44:55.503    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:44:55.504    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:44:55.504    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:44:55.504    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130603-103404-896_L1C_048-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/06/03/SPOT5-HRG1-XS_20130603-103407-855_L1C_048-260-0_D_V1-0/SPOT5-HRG1-XS_20130603-103407-855_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130603-103407-855_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130603-103407-855_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T22:45:01.217    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:45:01.218    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130603-103407-855_L1C_048-260-0_D_V1-0.zip
2024-01-09T22:45:01.218    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:45:01.218    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:45:01.218    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:45:01.218    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:45:01.218    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:45:01.218    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:45:01.218    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:45:01.218    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130603-103407-855_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/06/03/SPOT5-HRG1-XS_20130603-103409-660_L1C_048-260-2_D_V1-0/SPOT5-HRG1-XS_20130603-103409-660_L1C_048-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130603-103409-660_L1C_048-260-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130603-103409-660_L1C_048-260-2_D_V1-0.zip
run script
2024-01-09T22:45:07.104    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:45:07.105    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130603-103409-660_L1C_048-260-2_D_V1-0.zip
2024-01-09T22:45:07.105    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:45:07.105    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:45:07.106    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:45:07.106    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:45:07.106    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:45:07.106    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:45:07.106    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:45:07.106    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130603-103409-660_L1C_048-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/11/07/SPOT5-HRG1-XS_20131107-100644-348_L1C_048-259-3_D_V1-0/SPOT5-HRG1-XS_20131107-100644-348_L1C_048-259-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20131107-100644-348_L1C_048-259-3_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131107-100644-348_L1C_048-259-3_D_V1-0.zip
run script
2024-01-09T22:45:12.895    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:45:12.896    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131107-100644-348_L1C_048-259-3_D_V1-0.zip
2024-01-09T22:45:12.896    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:45:12.896    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:45:12.896    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:45:12.896    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:45:12.897    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:45:12.897    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:45:12.897    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:45:12.897    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131107-100644-348_L1C_048-259-3_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/11/07/SPOT5-HRG1-XS_20131107-100646-153_L1C_048-259-5_D_V1-0/SPOT5-HRG1-XS_20131107-100646-153_L1C_048-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20131107-100646-153_L1C_048-259-5_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131107-100646-153_L1C_048-259-5_D_V1-0.zip
run script
2024-01-09T22:45:18.418    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:45:18.420    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131107-100646-153_L1C_048-259-5_D_V1-0.zip
2024-01-09T22:45:18.420    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:45:18.420    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:45:18.420    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:45:18.420    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:45:18.420    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:45:18.420    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:45:18.420    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:45:18.420    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131107-100646-153_L1C_048-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/11/07/SPOT5-HRG2-XS_20131107-100623-160_L1C_049-256-9_D_V1-0/SPOT5-HRG2-XS_20131107-100623-160_L1C_049-256-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20131107-100623-160_L1C_049-256-9_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131107-100623-160_L1C_049-256-9_D_V1-0.zip
run script
2024-01-09T22:45:23.764    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:45:23.766    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131107-100623-160_L1C_049-256-9_D_V1-0.zip
2024-01-09T22:45:23.766    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:45:23.766    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:45:23.766    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:45:23.766    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:45:23.766    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:45:23.766    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:45:23.766    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:45:23.766    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131107-100623-160_L1C_049-256-9_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/11/07/SPOT5-HRG2-XS_20131107-100623-304_L1C_049-257-0_D_V1-0/SPOT5-HRG2-XS_20131107-100623-304_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20131107-100623-304_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131107-100623-304_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T22:48:13.910    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:48:13.911    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131107-100623-304_L1C_049-257-0_D_V1-0.zip
2024-01-09T22:48:13.911    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:48:13.911    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:48:13.911    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:48:13.911    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:48:13.911    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:48:13.911    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:48:13.911    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:48:13.911    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131107-100623-304_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/11/07/SPOT5-HRG2-XS_20131107-100625-999_L1C_049-257-3_D_V1-0/SPOT5-HRG2-XS_20131107-100625-999_L1C_049-257-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20131107-100625-999_L1C_049-257-3_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131107-100625-999_L1C_049-257-3_D_V1-0.zip
run script
2024-01-09T22:51:03.229    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:51:03.229    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131107-100625-999_L1C_049-257-3_D_V1-0.zip
2024-01-09T22:51:03.229    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:51:03.229    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:51:03.229    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:51:03.229    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:51:03.229    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:51:03.229    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:51:03.229    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:51:03.230    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:53:28.004    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (276 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131107-100625-999_L1C_049-257-3_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2013/11/07/SPOT5-HRG2-XS_20131107-100706-293_L1C_052-262-6_D_V1-0/SPOT5-HRG2-XS_20131107-100706-293_L1C_052-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20131107-100706-293_L1C_052-262-6_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131107-100706-293_L1C_052-262-6_D_V1-0.zip
run script
2024-01-09T22:53:33.444    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:53:33.445    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131107-100706-293_L1C_052-262-6_D_V1-0.zip
2024-01-09T22:53:33.445    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:53:33.445    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:53:33.445    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:53:33.445    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:53:33.445    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:53:33.445    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:53:33.445    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:53:33.445    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131107-100706-293_L1C_052-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/11/07/SPOT5-HRG2-XS_20131107-100709-205_L1C_052-263-0_D_V1-0/SPOT5-HRG2-XS_20131107-100709-205_L1C_052-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20131107-100709-205_L1C_052-263-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131107-100709-205_L1C_052-263-0_D_V1-0.zip
run script
2024-01-09T22:55:49.533    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:55:49.534    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131107-100709-205_L1C_052-263-0_D_V1-0.zip
2024-01-09T22:55:49.534    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:55:49.534    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:55:49.534    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:55:49.534    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:55:49.534    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:55:49.534    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:55:49.534    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:55:49.534    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20131107-100709-205_L1C_052-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/02/25/SPOT5-HRG1-XS_20130225-102314-305_L1C_048-260-6_D_V1-0/SPOT5-HRG1-XS_20130225-102314-305_L1C_048-260-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130225-102314-305_L1C_048-260-6_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130225-102314-305_L1C_048-260-6_D_V1-0.zip
run script
2024-01-09T22:57:10.916    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:57:10.917    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130225-102314-305_L1C_048-260-6_D_V1-0.zip
2024-01-09T22:57:10.917    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:57:10.917    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:57:10.917    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:57:10.917    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:57:10.917    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:57:10.917    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:57:10.917    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:57:10.917    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130225-102314-305_L1C_048-260-6_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/02/25/SPOT5-HRG1-XS_20130225-102317-193_L1C_048-261-0_D_V1-0/SPOT5-HRG1-XS_20130225-102317-193_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130225-102317-193_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130225-102317-193_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T22:57:16.655    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:57:16.657    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130225-102317-193_L1C_048-261-0_D_V1-0.zip
2024-01-09T22:57:16.657    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:57:16.657    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:57:16.657    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:57:16.657    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:57:16.657    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:57:16.657    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:57:16.657    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:57:16.657    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130225-102317-193_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/06/30/SPOT5-HRG1-XS_20130630-101343-895_L1C_048-260-8_D_V1-0/SPOT5-HRG1-XS_20130630-101343-895_L1C_048-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130630-101343-895_L1C_048-260-8_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130630-101343-895_L1C_048-260-8_D_V1-0.zip
run script
2024-01-09T22:57:21.920    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:57:21.922    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130630-101343-895_L1C_048-260-8_D_V1-0.zip
2024-01-09T22:57:21.922    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:57:21.922    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:57:21.922    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:57:21.922    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:57:21.922    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:57:21.922    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:57:21.922    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:57:21.922    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130630-101343-895_L1C_048-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/06/30/SPOT5-HRG2-XS_20130630-101324-346_L1C_049-258-6_D_V1-0/SPOT5-HRG2-XS_20130630-101324-346_L1C_049-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130630-101324-346_L1C_049-258-6_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130630-101324-346_L1C_049-258-6_D_V1-0.zip
run script
2024-01-09T22:57:27.360    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:57:27.362    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130630-101324-346_L1C_049-258-6_D_V1-0.zip
2024-01-09T22:57:27.362    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:57:27.362    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:57:27.362    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:57:27.362    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:57:27.362    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:57:27.362    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:57:27.362    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:57:27.362    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130630-101324-346_L1C_049-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/06/30/SPOT5-HRG2-XS_20130630-101327-210_L1C_049-259-0_D_V1-0/SPOT5-HRG2-XS_20130630-101327-210_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130630-101327-210_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130630-101327-210_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T22:58:59.011    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:58:59.012    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130630-101327-210_L1C_049-259-0_D_V1-0.zip
2024-01-09T22:58:59.012    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:58:59.012    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:58:59.012    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:58:59.012    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:58:59.012    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:58:59.012    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:58:59.012    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:58:59.013    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130630-101327-210_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/06/30/SPOT5-HRG2-XS_20130630-101335-512_L1C_049-260-0_D_V1-0/SPOT5-HRG2-XS_20130630-101335-512_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130630-101335-512_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130630-101335-512_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T23:00:23.984    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:00:23.986    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130630-101335-512_L1C_049-260-0_D_V1-0.zip
2024-01-09T23:00:23.986    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:00:23.986    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:00:23.986    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:00:23.986    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:00:23.986    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:00:23.986    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:00:23.986    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:00:23.986    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130630-101335-512_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/06/30/SPOT5-HRG2-XS_20130630-101337-316_L1C_049-260-2_D_V1-0/SPOT5-HRG2-XS_20130630-101337-316_L1C_049-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130630-101337-316_L1C_049-260-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130630-101337-316_L1C_049-260-2_D_V1-0.zip
run script
2024-01-09T23:01:15.478    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:01:15.479    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130630-101337-316_L1C_049-260-2_D_V1-0.zip
2024-01-09T23:01:15.479    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:01:15.479    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:01:15.479    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:01:15.479    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:01:15.479    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:01:15.479    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:01:15.480    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:01:15.480    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T23:01:18.812    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 222). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130630-101337-316_L1C_049-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2013/06/30/SPOT5-HRG1-XS_20130630-101344-954_L1C_049-261-0_D_V1-0/SPOT5-HRG1-XS_20130630-101344-954_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130630-101344-954_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130630-101344-954_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T23:01:24.651    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:01:24.652    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130630-101344-954_L1C_049-261-0_D_V1-0.zip
2024-01-09T23:01:24.652    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:01:24.652    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:01:24.652    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:01:24.652    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:01:24.652    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:01:24.652    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:01:24.652    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:01:24.652    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130630-101344-954_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/06/30/SPOT5-HRG1-XS_20130630-101345-868_L1C_049-261-1_D_V1-0/SPOT5-HRG1-XS_20130630-101345-868_L1C_049-261-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130630-101345-868_L1C_049-261-1_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130630-101345-868_L1C_049-261-1_D_V1-0.zip
run script
2024-01-09T23:01:30.391    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:01:30.393    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130630-101345-868_L1C_049-261-1_D_V1-0.zip
2024-01-09T23:01:30.393    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:01:30.393    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:01:30.393    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:01:30.393    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:01:30.393    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:01:30.393    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:01:30.393    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:01:30.393    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130630-101345-868_L1C_049-261-1_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/06/30/SPOT5-HRG2-XS_20130630-101350-155_L1C_049-261-7_D_V1-0/SPOT5-HRG2-XS_20130630-101350-155_L1C_049-261-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130630-101350-155_L1C_049-261-7_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130630-101350-155_L1C_049-261-7_D_V1-0.zip
run script
2024-01-09T23:01:35.318    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:01:35.319    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130630-101350-155_L1C_049-261-7_D_V1-0.zip
2024-01-09T23:01:35.319    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:01:35.319    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:01:35.319    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:01:35.319    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:01:35.319    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:01:35.320    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:01:35.320    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:01:35.320    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T23:01:42.029    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (228 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130630-101350-155_L1C_049-261-7_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2013/06/30/SPOT5-HRG2-XS_20130630-101352-128_L1C_049-262-0_D_V1-0/SPOT5-HRG2-XS_20130630-101352-128_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130630-101352-128_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130630-101352-128_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T23:01:47.172    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:01:47.173    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130630-101352-128_L1C_049-262-0_D_V1-0.zip
2024-01-09T23:01:47.173    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:01:47.173    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:01:47.173    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:01:47.173    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:01:47.173    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:01:47.173    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:01:47.173    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:01:47.173    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130630-101352-128_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/06/30/SPOT5-HRG2-XS_20130630-101355-738_L1C_049-262-4_D_V1-0/SPOT5-HRG2-XS_20130630-101355-738_L1C_049-262-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130630-101355-738_L1C_049-262-4_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130630-101355-738_L1C_049-262-4_D_V1-0.zip
run script
2024-01-09T23:01:52.362    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:01:52.363    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130630-101355-738_L1C_049-262-4_D_V1-0.zip
2024-01-09T23:01:52.363    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:01:52.363    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:01:52.363    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:01:52.363    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:01:52.363    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:01:52.363    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:01:52.363    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:01:52.363    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130630-101355-738_L1C_049-262-4_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/02/19/SPOT5-HRG2-XS_20130219-103754-084_L1C_049-254-0_D_V1-0/SPOT5-HRG2-XS_20130219-103754-084_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130219-103754-084_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130219-103754-084_L1C_049-254-0_D_V1-0.zip
run script
2024-01-09T23:01:58.310    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:01:58.312    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130219-103754-084_L1C_049-254-0_D_V1-0.zip
2024-01-09T23:01:58.312    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:01:58.312    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:01:58.312    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:01:58.312    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:01:58.312    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:01:58.312    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:01:58.312    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:01:58.312    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130219-103754-084_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/02/19/SPOT5-HRG2-XS_20130219-103802-458_L1C_049-255-0_D_V1-0/SPOT5-HRG2-XS_20130219-103802-458_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130219-103802-458_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130219-103802-458_L1C_049-255-0_D_V1-0.zip
run script
2024-01-09T23:02:04.838    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:02:04.840    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130219-103802-458_L1C_049-255-0_D_V1-0.zip
2024-01-09T23:02:04.840    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:02:04.840    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:02:04.840    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:02:04.840    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:02:04.840    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:02:04.840    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:02:04.840    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:02:04.840    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130219-103802-458_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/02/19/SPOT5-HRG2-XS_20130219-103804-263_L1C_049-255-2_D_V1-0/SPOT5-HRG2-XS_20130219-103804-263_L1C_049-255-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130219-103804-263_L1C_049-255-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130219-103804-263_L1C_049-255-2_D_V1-0.zip
run script
2024-01-09T23:03:26.276    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:03:26.277    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130219-103804-263_L1C_049-255-2_D_V1-0.zip
2024-01-09T23:03:26.277    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:03:26.277    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:03:26.277    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:03:26.277    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:03:26.277    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:03:26.277    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:03:26.277    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:03:26.277    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130219-103804-263_L1C_049-255-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/24/SPOT5-HRG1-XS_20130424-100416-401_L1C_049-254-0_D_V1-0/SPOT5-HRG1-XS_20130424-100416-401_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130424-100416-401_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130424-100416-401_L1C_049-254-0_D_V1-0.zip
run script
2024-01-09T23:05:10.020    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:05:10.022    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130424-100416-401_L1C_049-254-0_D_V1-0.zip
2024-01-09T23:05:10.022    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:05:10.022    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:05:10.022    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:05:10.022    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:05:10.022    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:05:10.022    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:05:10.022    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:05:10.022    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130424-100416-401_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/04/24/SPOT5-HRG1-XS_20130424-100424-606_L1C_049-255-0_D_V1-0/SPOT5-HRG1-XS_20130424-100424-606_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130424-100424-606_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130424-100424-606_L1C_049-255-0_D_V1-0.zip
run script
2024-01-09T23:05:15.864    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:05:15.865    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130424-100424-606_L1C_049-255-0_D_V1-0.zip
2024-01-09T23:05:15.865    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:05:15.865    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:05:15.866    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:05:15.866    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:05:15.866    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:05:15.866    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:05:15.866    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:05:15.866    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130424-100424-606_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/24/SPOT5-HRG1-XS_20130424-100432-836_L1C_049-256-0_D_V1-0/SPOT5-HRG1-XS_20130424-100432-836_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130424-100432-836_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130424-100432-836_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T23:06:28.934    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:06:28.935    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130424-100432-836_L1C_049-256-0_D_V1-0.zip
2024-01-09T23:06:28.936    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:06:28.936    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:06:28.936    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:06:28.936    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:06:28.936    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:06:28.936    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:06:28.936    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:06:28.936    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130424-100432-836_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/24/SPOT5-HRG1-XS_20130424-100435-556_L1C_049-256-3_D_V1-0/SPOT5-HRG1-XS_20130424-100435-556_L1C_049-256-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130424-100435-556_L1C_049-256-3_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130424-100435-556_L1C_049-256-3_D_V1-0.zip
run script
2024-01-09T23:09:57.909    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:09:57.911    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130424-100435-556_L1C_049-256-3_D_V1-0.zip
2024-01-09T23:09:57.911    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:09:57.911    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:09:57.911    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:09:57.911    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:09:57.911    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:09:57.911    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:09:57.911    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:09:57.911    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130424-100435-556_L1C_049-256-3_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/24/SPOT5-HRG2-XS_20130424-100438-524_L1C_049-256-6_D_V1-0/SPOT5-HRG2-XS_20130424-100438-524_L1C_049-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130424-100438-524_L1C_049-256-6_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130424-100438-524_L1C_049-256-6_D_V1-0.zip
run script
2024-01-09T23:13:13.880    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:13:13.882    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130424-100438-524_L1C_049-256-6_D_V1-0.zip
2024-01-09T23:13:13.882    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:13:13.882    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:13:13.882    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:13:13.882    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:13:13.882    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:13:13.882    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:13:13.882    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:13:13.882    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130424-100438-524_L1C_049-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/24/SPOT5-HRG2-XS_20130424-100441-339_L1C_049-257-0_D_V1-0/SPOT5-HRG2-XS_20130424-100441-339_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130424-100441-339_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130424-100441-339_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T23:16:18.948    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:16:18.949    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130424-100441-339_L1C_049-257-0_D_V1-0.zip
2024-01-09T23:16:18.949    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:16:18.949    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:16:18.949    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:16:18.949    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:16:18.950    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:16:18.950    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:16:18.950    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:16:18.950    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130424-100441-339_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/24/SPOT5-HRG2-XS_20130424-100442-254_L1C_049-257-1_D_V1-0/SPOT5-HRG2-XS_20130424-100442-254_L1C_049-257-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130424-100442-254_L1C_049-257-1_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130424-100442-254_L1C_049-257-1_D_V1-0.zip
run script
2024-01-09T23:19:06.041    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:19:06.042    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130424-100442-254_L1C_049-257-1_D_V1-0.zip
2024-01-09T23:19:06.042    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:19:06.042    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:19:06.042    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:19:06.042    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:19:06.042    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:19:06.042    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:19:06.042    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:19:06.043    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T23:21:31.924    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (374 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130424-100442-254_L1C_049-257-1_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2013/04/24/SPOT5-HRG2-XS_20130424-100507-853_L1C_049-260-1_D_V1-0/SPOT5-HRG2-XS_20130424-100507-853_L1C_049-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130424-100507-853_L1C_049-260-1_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130424-100507-853_L1C_049-260-1_D_V1-0.zip
run script
2024-01-09T23:21:37.949    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:21:37.951    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130424-100507-853_L1C_049-260-1_D_V1-0.zip
2024-01-09T23:21:37.951    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:21:37.951    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:21:37.951    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:21:37.951    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:21:37.951    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:21:37.951    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:21:37.951    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:21:37.951    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130424-100507-853_L1C_049-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/24/SPOT5-HRG2-XS_20130424-100510-548_L1C_049-260-4_D_V1-0/SPOT5-HRG2-XS_20130424-100510-548_L1C_049-260-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130424-100510-548_L1C_049-260-4_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130424-100510-548_L1C_049-260-4_D_V1-0.zip
run script
2024-01-09T23:22:04.239    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:22:04.240    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130424-100510-548_L1C_049-260-4_D_V1-0.zip
2024-01-09T23:22:04.241    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:22:04.241    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:22:04.241    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:22:04.241    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:22:04.241    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:22:04.241    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:22:04.241    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:22:04.241    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130424-100510-548_L1C_049-260-4_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/24/SPOT5-HRG1-XS_20130424-100501-184_L1C_052-259-7_D_V1-0/SPOT5-HRG1-XS_20130424-100501-184_L1C_052-259-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130424-100501-184_L1C_052-259-7_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130424-100501-184_L1C_052-259-7_D_V1-0.zip
run script
2024-01-09T23:22:31.966    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:22:31.967    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130424-100501-184_L1C_052-259-7_D_V1-0.zip
2024-01-09T23:22:31.967    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:22:31.967    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:22:31.967    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:22:31.967    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:22:31.968    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:22:31.968    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:22:31.968    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:22:31.968    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T23:26:22.554    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 312). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130424-100501-184_L1C_052-259-7_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2013/04/24/SPOT5-HRG1-XS_20130424-100503-133_L1C_052-260-0_D_V1-0/SPOT5-HRG1-XS_20130424-100503-133_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130424-100503-133_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130424-100503-133_L1C_052-260-0_D_V1-0.zip
run script
2024-01-09T23:26:28.093    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:26:28.094    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130424-100503-133_L1C_052-260-0_D_V1-0.zip
2024-01-09T23:26:28.094    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:26:28.094    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:26:28.094    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:26:28.094    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:26:28.094    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:26:28.094    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:26:28.094    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:26:28.094    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130424-100503-133_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/24/SPOT5-HRG1-XS_20130424-100504-023_L1C_052-260-1_D_V1-0/SPOT5-HRG1-XS_20130424-100504-023_L1C_052-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130424-100504-023_L1C_052-260-1_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130424-100504-023_L1C_052-260-1_D_V1-0.zip
run script
2024-01-09T23:30:04.696    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:30:04.698    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130424-100504-023_L1C_052-260-1_D_V1-0.zip
2024-01-09T23:30:04.698    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:30:04.698    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:30:04.698    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:30:04.698    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:30:04.698    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:30:04.698    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:30:04.698    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:30:04.698    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130424-100504-023_L1C_052-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/07/06/SPOT5-HRG2-XS_20130706-095702-355_L1C_049-254-0_D_V1-0/SPOT5-HRG2-XS_20130706-095702-355_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130706-095702-355_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130706-095702-355_L1C_049-254-0_D_V1-0.zip
run script
2024-01-09T23:33:41.814    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:33:41.815    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130706-095702-355_L1C_049-254-0_D_V1-0.zip
2024-01-09T23:33:41.815    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:33:41.815    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:33:41.815    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:33:41.815    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:33:41.815    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:33:41.815    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:33:41.815    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:33:41.815    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130706-095702-355_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/07/06/SPOT5-HRG2-XS_20130706-095710-560_L1C_049-255-0_D_V1-0/SPOT5-HRG2-XS_20130706-095710-560_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130706-095710-560_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130706-095710-560_L1C_049-255-0_D_V1-0.zip
run script
2024-01-09T23:33:47.370    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:33:47.372    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130706-095710-560_L1C_049-255-0_D_V1-0.zip
2024-01-09T23:33:47.372    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:33:47.372    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:33:47.372    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:33:47.372    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:33:47.372    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:33:47.372    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:33:47.372    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:33:47.372    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130706-095710-560_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/07/06/SPOT5-HRG2-XS_20130706-095711-475_L1C_049-255-1_D_V1-0/SPOT5-HRG2-XS_20130706-095711-475_L1C_049-255-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130706-095711-475_L1C_049-255-1_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130706-095711-475_L1C_049-255-1_D_V1-0.zip
run script
2024-01-09T23:34:59.569    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:34:59.570    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130706-095711-475_L1C_049-255-1_D_V1-0.zip
2024-01-09T23:34:59.571    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:34:59.571    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:34:59.571    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:34:59.571    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:34:59.571    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:34:59.571    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:34:59.571    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:34:59.571    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130706-095711-475_L1C_049-255-1_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/07/06/SPOT5-HRG1-XS_20130706-095700-635_L1C_050-254-0_D_V1-0/SPOT5-HRG1-XS_20130706-095700-635_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130706-095700-635_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130706-095700-635_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T23:36:26.776    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:36:26.777    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130706-095700-635_L1C_050-254-0_D_V1-0.zip
2024-01-09T23:36:26.777    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:36:26.777    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:36:26.777    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:36:26.777    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:36:26.777    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:36:26.777    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:36:26.777    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:36:26.777    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130706-095700-635_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/07/25/SPOT5-HRG2-XS_20130725-103044-764_L1C_049-254-0_D_V1-0/SPOT5-HRG2-XS_20130725-103044-764_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130725-103044-764_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130725-103044-764_L1C_049-254-0_D_V1-0.zip
run script
2024-01-09T23:36:32.411    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:36:32.412    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130725-103044-764_L1C_049-254-0_D_V1-0.zip
2024-01-09T23:36:32.412    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:36:32.413    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:36:32.413    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:36:32.413    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:36:32.413    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:36:32.413    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:36:32.413    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:36:32.413    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130725-103044-764_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/07/25/SPOT5-HRG2-XS_20130725-103053-138_L1C_049-255-0_D_V1-0/SPOT5-HRG2-XS_20130725-103053-138_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130725-103053-138_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130725-103053-138_L1C_049-255-0_D_V1-0.zip
run script
2024-01-09T23:36:37.796    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:36:37.796    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130725-103053-138_L1C_049-255-0_D_V1-0.zip
2024-01-09T23:36:37.796    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:36:37.796    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:36:37.796    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:36:37.796    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:36:37.796    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:36:37.796    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:36:37.796    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:36:37.796    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130725-103053-138_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/07/25/SPOT5-HRG2-XS_20130725-103141-261_L1C_049-260-7_D_V1-0/SPOT5-HRG2-XS_20130725-103141-261_L1C_049-260-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130725-103141-261_L1C_049-260-7_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130725-103141-261_L1C_049-260-7_D_V1-0.zip
run script
2024-01-09T23:37:57.588    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:37:57.590    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130725-103141-261_L1C_049-260-7_D_V1-0.zip
2024-01-09T23:37:57.590    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:37:57.590    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:37:57.590    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:37:57.590    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:37:57.590    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:37:57.590    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:37:57.590    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:37:57.590    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130725-103141-261_L1C_049-260-7_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/07/25/SPOT5-HRG2-XS_20130725-103143-331_L1C_049-261-0_D_V1-0/SPOT5-HRG2-XS_20130725-103143-331_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130725-103143-331_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130725-103143-331_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T23:38:03.820    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:38:03.822    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130725-103143-331_L1C_049-261-0_D_V1-0.zip
2024-01-09T23:38:03.822    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:38:03.822    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:38:03.822    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:38:03.822    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:38:03.822    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:38:03.822    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:38:03.822    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:38:03.822    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130725-103143-331_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/07/25/SPOT5-HRG2-XS_20130725-103145-136_L1C_049-261-2_D_V1-0/SPOT5-HRG2-XS_20130725-103145-136_L1C_049-261-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130725-103145-136_L1C_049-261-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130725-103145-136_L1C_049-261-2_D_V1-0.zip
run script
2024-01-09T23:38:09.572    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:38:09.574    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130725-103145-136_L1C_049-261-2_D_V1-0.zip
2024-01-09T23:38:09.574    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:38:09.574    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:38:09.574    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:38:09.574    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:38:09.574    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:38:09.574    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:38:09.574    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:38:09.574    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130725-103145-136_L1C_049-261-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/08/04/SPOT5-HRG2-XS_20130804-103752-870_L1C_049-254-0_D_V1-0/SPOT5-HRG2-XS_20130804-103752-870_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130804-103752-870_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130804-103752-870_L1C_049-254-0_D_V1-0.zip
run script
2024-01-09T23:38:15.541    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:38:15.542    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130804-103752-870_L1C_049-254-0_D_V1-0.zip
2024-01-09T23:38:15.542    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:38:15.542    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:38:15.542    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:38:15.542    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:38:15.542    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:38:15.542    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:38:15.542    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:38:15.542    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130804-103752-870_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/08/04/SPOT5-HRG2-XS_20130804-103801-317_L1C_049-255-0_D_V1-0/SPOT5-HRG2-XS_20130804-103801-317_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130804-103801-317_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130804-103801-317_L1C_049-255-0_D_V1-0.zip
run script
2024-01-09T23:38:21.228    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:38:21.228    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130804-103801-317_L1C_049-255-0_D_V1-0.zip
2024-01-09T23:38:21.228    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:38:21.228    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:38:21.229    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:38:21.229    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:38:21.229    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:38:21.229    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:38:21.229    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:38:21.229    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130804-103801-317_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/08/05/SPOT5-HRG2-XS_20130805-101835-433_L1C_049-254-0_D_V1-0/SPOT5-HRG2-XS_20130805-101835-433_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130805-101835-433_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130805-101835-433_L1C_049-254-0_D_V1-0.zip
run script
2024-01-09T23:39:51.236    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:39:51.237    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130805-101835-433_L1C_049-254-0_D_V1-0.zip
2024-01-09T23:39:51.237    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:39:51.237    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:39:51.237    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:39:51.237    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:39:51.237    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:39:51.237    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:39:51.237    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:39:51.237    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130805-101835-433_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/08/05/SPOT5-HRG2-XS_20130805-101843-735_L1C_049-255-0_D_V1-0/SPOT5-HRG2-XS_20130805-101843-735_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130805-101843-735_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130805-101843-735_L1C_049-255-0_D_V1-0.zip
run script
2024-01-09T23:39:56.398    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:39:56.399    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130805-101843-735_L1C_049-255-0_D_V1-0.zip
2024-01-09T23:39:56.399    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:39:56.399    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:39:56.399    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:39:56.399    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:39:56.399    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:39:56.400    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:39:56.400    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:39:56.400    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130805-101843-735_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/08/05/SPOT5-HRG2-XS_20130805-101844-649_L1C_049-255-1_D_V1-0/SPOT5-HRG2-XS_20130805-101844-649_L1C_049-255-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130805-101844-649_L1C_049-255-1_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130805-101844-649_L1C_049-255-1_D_V1-0.zip
run script
2024-01-09T23:41:03.814    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:41:03.815    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130805-101844-649_L1C_049-255-1_D_V1-0.zip
2024-01-09T23:41:03.815    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:41:03.815    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:41:03.815    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:41:03.815    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:41:03.815    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:41:03.816    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:41:03.816    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:41:03.816    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130805-101844-649_L1C_049-255-1_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/01/24/SPOT5-HRG2-XS_20130124-103915-367_L1C_049-255-0_D_V1-0/SPOT5-HRG2-XS_20130124-103915-367_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130124-103915-367_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130124-103915-367_L1C_049-255-0_D_V1-0.zip
run script
2024-01-09T23:42:24.885    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:42:24.886    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130124-103915-367_L1C_049-255-0_D_V1-0.zip
2024-01-09T23:42:24.886    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:42:24.886    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:42:24.886    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:42:24.887    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:42:24.887    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:42:24.887    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:42:24.887    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:42:24.887    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130124-103915-367_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/01/24/SPOT5-HRG2-XS_20130124-103917-172_L1C_049-255-2_D_V1-0/SPOT5-HRG2-XS_20130124-103917-172_L1C_049-255-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130124-103917-172_L1C_049-255-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130124-103917-172_L1C_049-255-2_D_V1-0.zip
run script
2024-01-09T23:43:39.787    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:43:39.788    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130124-103917-172_L1C_049-255-2_D_V1-0.zip
2024-01-09T23:43:39.788    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:43:39.788    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:43:39.789    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:43:39.789    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:43:39.789    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:43:39.789    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:43:39.789    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:43:39.789    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130124-103917-172_L1C_049-255-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/01/24/SPOT5-HRG1-XS_20130124-103921-811_L1C_050-255-9_D_V1-0/SPOT5-HRG1-XS_20130124-103921-811_L1C_050-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130124-103921-811_L1C_050-255-9_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130124-103921-811_L1C_050-255-9_D_V1-0.zip
run script
2024-01-09T23:45:21.377    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:45:21.378    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130124-103921-811_L1C_050-255-9_D_V1-0.zip
2024-01-09T23:45:21.378    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:45:21.378    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:45:21.378    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:45:21.378    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:45:21.378    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:45:21.378    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:45:21.378    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:45:21.379    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130124-103921-811_L1C_050-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/01/24/SPOT5-HRG1-XS_20130124-103922-966_L1C_050-256-1_D_V1-0/SPOT5-HRG1-XS_20130124-103922-966_L1C_050-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130124-103922-966_L1C_050-256-1_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130124-103922-966_L1C_050-256-1_D_V1-0.zip
run script
2024-01-09T23:50:04.293    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:50:04.294    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130124-103922-966_L1C_050-256-1_D_V1-0.zip
2024-01-09T23:50:04.295    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:50:04.295    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:50:04.295    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:50:04.295    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:50:04.295    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:50:04.295    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:50:04.295    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:50:04.295    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130124-103922-966_L1C_050-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/01/25/SPOT5-HRG2-XS_20130125-101957-438_L1C_049-255-0_D_V1-0/SPOT5-HRG2-XS_20130125-101957-438_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130125-101957-438_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130125-101957-438_L1C_049-255-0_D_V1-0.zip
run script
2024-01-09T23:54:49.435    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:54:49.436    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130125-101957-438_L1C_049-255-0_D_V1-0.zip
2024-01-09T23:54:49.436    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:54:49.436    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:54:49.437    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:54:49.437    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:54:49.437    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:54:49.437    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:54:49.437    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:54:49.437    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130125-101957-438_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/01/25/SPOT5-HRG2-XS_20130125-102000-158_L1C_049-255-3_D_V1-0/SPOT5-HRG2-XS_20130125-102000-158_L1C_049-255-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130125-102000-158_L1C_049-255-3_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130125-102000-158_L1C_049-255-3_D_V1-0.zip
run script
2024-01-09T23:55:49.767    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:55:49.768    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130125-102000-158_L1C_049-255-3_D_V1-0.zip
2024-01-09T23:55:49.769    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:55:49.769    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:55:49.769    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:55:49.769    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:55:49.769    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:55:49.769    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:55:49.769    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:55:49.769    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130125-102000-158_L1C_049-255-3_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/07/26/SPOT5-HRG1-XS_20130726-101139-899_L1C_049-255-6_D_V1-0/SPOT5-HRG1-XS_20130726-101139-899_L1C_049-255-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130726-101139-899_L1C_049-255-6_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130726-101139-899_L1C_049-255-6_D_V1-0.zip
run script
2024-01-09T23:57:31.565    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:57:31.567    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130726-101139-899_L1C_049-255-6_D_V1-0.zip
2024-01-09T23:57:31.567    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:57:31.567    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:57:31.567    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:57:31.567    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:57:31.567    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:57:31.567    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:57:31.567    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:57:31.567    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130726-101139-899_L1C_049-255-6_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/07/26/SPOT5-HRG1-XS_20130726-101142-739_L1C_049-256-0_D_V1-0/SPOT5-HRG1-XS_20130726-101142-739_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130726-101142-739_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130726-101142-739_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T23:59:53.210    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:59:53.211    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130726-101142-739_L1C_049-256-0_D_V1-0.zip
2024-01-09T23:59:53.211    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:59:53.211    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:59:53.211    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:59:53.211    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:59:53.211    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:59:53.211    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:59:53.211    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:59:53.211    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130726-101142-739_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/07/26/SPOT5-HRG1-XS_20130726-101144-544_L1C_049-256-2_D_V1-0/SPOT5-HRG1-XS_20130726-101144-544_L1C_049-256-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130726-101144-544_L1C_049-256-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130726-101144-544_L1C_049-256-2_D_V1-0.zip
run script
2024-01-10T00:02:48.181    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:02:48.182    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130726-101144-544_L1C_049-256-2_D_V1-0.zip
2024-01-10T00:02:48.182    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:02:48.182    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:02:48.182    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:02:48.182    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:02:48.182    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:02:48.182    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:02:48.182    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:02:48.182    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130726-101144-544_L1C_049-256-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/07/31/SPOT5-HRG1-XS_20130731-101514-596_L1C_049-255-6_D_V1-0/SPOT5-HRG1-XS_20130731-101514-596_L1C_049-255-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130731-101514-596_L1C_049-255-6_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130731-101514-596_L1C_049-255-6_D_V1-0.zip
run script
2024-01-10T00:05:30.379    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:05:30.380    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130731-101514-596_L1C_049-255-6_D_V1-0.zip
2024-01-10T00:05:30.380    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:05:30.380    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:05:30.380    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:05:30.381    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:05:30.381    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:05:30.381    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:05:30.381    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:05:30.381    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130731-101514-596_L1C_049-255-6_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/07/31/SPOT5-HRG1-XS_20130731-101517-459_L1C_049-256-0_D_V1-0/SPOT5-HRG1-XS_20130731-101517-459_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130731-101517-459_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130731-101517-459_L1C_049-256-0_D_V1-0.zip
run script
2024-01-10T00:07:58.506    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:07:58.507    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130731-101517-459_L1C_049-256-0_D_V1-0.zip
2024-01-10T00:07:58.507    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:07:58.508    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:07:58.508    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:07:58.508    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:07:58.508    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:07:58.508    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:07:58.508    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:07:58.508    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130731-101517-459_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/07/31/SPOT5-HRG1-XS_20130731-101519-264_L1C_049-256-2_D_V1-0/SPOT5-HRG1-XS_20130731-101519-264_L1C_049-256-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130731-101519-264_L1C_049-256-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130731-101519-264_L1C_049-256-2_D_V1-0.zip
run script
2024-01-10T00:10:54.231    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:10:54.232    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130731-101519-264_L1C_049-256-2_D_V1-0.zip
2024-01-10T00:10:54.233    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:10:54.233    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:10:54.233    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:10:54.233    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:10:54.233    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:10:54.233    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:10:54.233    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:10:54.233    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130731-101519-264_L1C_049-256-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/08/01/SPOT5-HRG1-XS_20130801-095553-852_L1C_049-255-6_D_V1-0/SPOT5-HRG1-XS_20130801-095553-852_L1C_049-255-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130801-095553-852_L1C_049-255-6_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130801-095553-852_L1C_049-255-6_D_V1-0.zip
run script
2024-01-10T00:13:44.520    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:13:44.521    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130801-095553-852_L1C_049-255-6_D_V1-0.zip
2024-01-10T00:13:44.522    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:13:44.522    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:13:44.522    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:13:44.522    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:13:44.522    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:13:44.522    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:13:44.522    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:13:44.522    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130801-095553-852_L1C_049-255-6_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/08/01/SPOT5-HRG1-XS_20130801-095556-667_L1C_049-256-0_D_V1-0/SPOT5-HRG1-XS_20130801-095556-667_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130801-095556-667_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130801-095556-667_L1C_049-256-0_D_V1-0.zip
run script
2024-01-10T00:16:34.674    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:16:34.675    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130801-095556-667_L1C_049-256-0_D_V1-0.zip
2024-01-10T00:16:34.675    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:16:34.675    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:16:34.675    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:16:34.675    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:16:34.675    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:16:34.675    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:16:34.675    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:16:34.675    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130801-095556-667_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/08/01/SPOT5-HRG1-XS_20130801-095558-472_L1C_049-256-2_D_V1-0/SPOT5-HRG1-XS_20130801-095558-472_L1C_049-256-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130801-095558-472_L1C_049-256-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130801-095558-472_L1C_049-256-2_D_V1-0.zip
run script
2024-01-10T00:19:58.848    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:19:58.849    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130801-095558-472_L1C_049-256-2_D_V1-0.zip
2024-01-10T00:19:58.849    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:19:58.849    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:19:58.849    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:19:58.849    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:19:58.849    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:19:58.849    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:19:58.849    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:19:58.849    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130801-095558-472_L1C_049-256-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/08/01/SPOT5-HRG1-XS_20130801-095644-922_L1C_049-261-7_D_V1-0/SPOT5-HRG1-XS_20130801-095644-922_L1C_049-261-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130801-095644-922_L1C_049-261-7_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130801-095644-922_L1C_049-261-7_D_V1-0.zip
run script
2024-01-10T00:23:14.320    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:23:14.321    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130801-095644-922_L1C_049-261-7_D_V1-0.zip
2024-01-10T00:23:14.321    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:23:14.321    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:23:14.321    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:23:14.321    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:23:14.321    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:23:14.321    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:23:14.321    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:23:14.321    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130801-095644-922_L1C_049-261-7_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/08/01/SPOT5-HRG1-XS_20130801-095646-872_L1C_049-262-0_D_V1-0/SPOT5-HRG1-XS_20130801-095646-872_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130801-095646-872_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130801-095646-872_L1C_049-262-0_D_V1-0.zip
run script
2024-01-10T00:23:33.260    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:23:33.261    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130801-095646-872_L1C_049-262-0_D_V1-0.zip
2024-01-10T00:23:33.261    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:23:33.261    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:23:33.261    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:23:33.262    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:23:33.262    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:23:33.262    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:23:33.262    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:23:33.262    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T00:23:41.724    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (906 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130801-095646-872_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2013/08/01/SPOT5-HRG1-XS_20130801-095650-481_L1C_049-262-4_D_V1-0/SPOT5-HRG1-XS_20130801-095650-481_L1C_049-262-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130801-095650-481_L1C_049-262-4_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130801-095650-481_L1C_049-262-4_D_V1-0.zip
run script
2024-01-10T00:23:46.849    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:23:46.851    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130801-095650-481_L1C_049-262-4_D_V1-0.zip
2024-01-10T00:23:46.851    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:23:46.851    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:23:46.851    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:23:46.851    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:23:46.851    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:23:46.851    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:23:46.851    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:23:46.851    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130801-095650-481_L1C_049-262-4_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/08/01/SPOT5-HRG2-XS_20130801-095600-719_L1C_050-256-6_D_V1-0/SPOT5-HRG2-XS_20130801-095600-719_L1C_050-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130801-095600-719_L1C_050-256-6_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130801-095600-719_L1C_050-256-6_D_V1-0.zip
run script
2024-01-10T00:23:52.565    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:23:52.566    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130801-095600-719_L1C_050-256-6_D_V1-0.zip
2024-01-10T00:23:52.566    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:23:52.566    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:23:52.566    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:23:52.566    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:23:52.566    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:23:52.566    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:23:52.566    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:23:52.566    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130801-095600-719_L1C_050-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 1 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/08/01/SPOT5-HRG2-XS_20130801-095603-535_L1C_051-257-0_D_V1-0/SPOT5-HRG2-XS_20130801-095603-535_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130801-095603-535_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130801-095603-535_L1C_051-257-0_D_V1-0.zip
run script
2024-01-10T00:28:39.801    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:28:39.802    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130801-095603-535_L1C_051-257-0_D_V1-0.zip
2024-01-10T00:28:39.802    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:28:39.802    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:28:39.802    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:28:39.803    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:28:39.803    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:28:39.803    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:28:39.803    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:28:39.803    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130801-095603-535_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/08/01/SPOT5-HRG2-XS_20130801-095625-452_L1C_051-259-6_D_V1-0/SPOT5-HRG2-XS_20130801-095625-452_L1C_051-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130801-095625-452_L1C_051-259-6_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130801-095625-452_L1C_051-259-6_D_V1-0.zip
run script
2024-01-10T00:33:27.098    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:33:27.099    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130801-095625-452_L1C_051-259-6_D_V1-0.zip
2024-01-10T00:33:27.099    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:33:27.099    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:33:27.099    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:33:27.099    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:33:27.100    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:33:27.100    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:33:27.100    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:33:27.100    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130801-095625-452_L1C_051-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/08/01/SPOT5-HRG2-XS_20130801-095628-291_L1C_051-260-0_D_V1-0/SPOT5-HRG2-XS_20130801-095628-291_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130801-095628-291_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130801-095628-291_L1C_051-260-0_D_V1-0.zip
run script
2024-01-10T00:37:13.530    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:37:13.531    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130801-095628-291_L1C_051-260-0_D_V1-0.zip
2024-01-10T00:37:13.531    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:37:13.531    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:37:13.531    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:37:13.531    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:37:13.531    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:37:13.531    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:37:13.531    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:37:13.532    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130801-095628-291_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/08/01/SPOT5-HRG2-XS_20130801-095631-010_L1C_051-260-3_D_V1-0/SPOT5-HRG2-XS_20130801-095631-010_L1C_051-260-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130801-095631-010_L1C_051-260-3_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130801-095631-010_L1C_051-260-3_D_V1-0.zip
run script
2024-01-10T00:40:27.465    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:40:27.466    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130801-095631-010_L1C_051-260-3_D_V1-0.zip
2024-01-10T00:40:27.466    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:40:27.466    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:40:27.466    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:40:27.466    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:40:27.466    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:40:27.467    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:40:27.467    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:40:27.467    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130801-095631-010_L1C_051-260-3_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/13/SPOT5-HRG1-XS_20130413-101646-889_L1C_049-256-6_D_V1-0/SPOT5-HRG1-XS_20130413-101646-889_L1C_049-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130413-101646-889_L1C_049-256-6_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130413-101646-889_L1C_049-256-6_D_V1-0.zip
run script
2024-01-10T00:43:56.130    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:43:56.131    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130413-101646-889_L1C_049-256-6_D_V1-0.zip
2024-01-10T00:43:56.131    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:43:56.131    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:43:56.131    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:43:56.131    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:43:56.131    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:43:56.131    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:43:56.132    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:43:56.132    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130413-101646-889_L1C_049-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/13/SPOT5-HRG1-XS_20130413-101649-753_L1C_049-257-0_D_V1-0/SPOT5-HRG1-XS_20130413-101649-753_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130413-101649-753_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130413-101649-753_L1C_049-257-0_D_V1-0.zip
run script
2024-01-10T00:46:53.035    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:46:53.036    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130413-101649-753_L1C_049-257-0_D_V1-0.zip
2024-01-10T00:46:53.036    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:46:53.036    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:46:53.036    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:46:53.036    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:46:53.036    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:46:53.036    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:46:53.036    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:46:53.036    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130413-101649-753_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/13/SPOT5-HRG1-XS_20130413-101651-557_L1C_049-257-2_D_V1-0/SPOT5-HRG1-XS_20130413-101651-557_L1C_049-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130413-101651-557_L1C_049-257-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130413-101651-557_L1C_049-257-2_D_V1-0.zip
run script
2024-01-10T00:49:05.019    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:49:05.020    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130413-101651-557_L1C_049-257-2_D_V1-0.zip
2024-01-10T00:49:05.020    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:49:05.020    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:49:05.020    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:49:05.020    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:49:05.020    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:49:05.021    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:49:05.021    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:49:05.021    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130413-101651-557_L1C_049-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/13/SPOT5-HRG1-XS_20130413-101715-540_L1C_049-260-0_D_V1-0/SPOT5-HRG1-XS_20130413-101715-540_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130413-101715-540_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130413-101715-540_L1C_049-260-0_D_V1-0.zip
run script
2024-01-10T00:51:12.834    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:51:12.836    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130413-101715-540_L1C_049-260-0_D_V1-0.zip
2024-01-10T00:51:12.836    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:51:12.836    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:51:12.836    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:51:12.836    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:51:12.836    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:51:12.836    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:51:12.836    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:51:12.836    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130413-101715-540_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/04/13/SPOT5-HRG1-XS_20130413-101718-259_L1C_049-260-3_D_V1-0/SPOT5-HRG1-XS_20130413-101718-259_L1C_049-260-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20130413-101718-259_L1C_049-260-3_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130413-101718-259_L1C_049-260-3_D_V1-0.zip
run script
2024-01-10T00:51:17.726    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:51:17.727    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130413-101718-259_L1C_049-260-3_D_V1-0.zip
2024-01-10T00:51:17.727    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:51:17.727    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:51:17.727    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:51:17.728    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:51:17.728    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:51:17.728    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:51:17.728    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:51:17.728    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20130413-101718-259_L1C_049-260-3_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/04/13/SPOT5-HRG2-XS_20130413-101622-915_L1C_051-254-0_D_V1-0/SPOT5-HRG2-XS_20130413-101622-915_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130413-101622-915_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130413-101622-915_L1C_051-254-0_D_V1-0.zip
run script
2024-01-10T00:51:22.857    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:51:22.858    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130413-101622-915_L1C_051-254-0_D_V1-0.zip
2024-01-10T00:51:22.859    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:51:22.859    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:51:22.859    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:51:22.859    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:51:22.859    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:51:22.859    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:51:22.859    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:51:22.859    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130413-101622-915_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2013/04/13/SPOT5-HRG2-XS_20130413-101653-170_L1C_051-257-6_D_V1-0/SPOT5-HRG2-XS_20130413-101653-170_L1C_051-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130413-101653-170_L1C_051-257-6_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130413-101653-170_L1C_051-257-6_D_V1-0.zip
run script
2024-01-10T00:51:28.275    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:51:28.275    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130413-101653-170_L1C_051-257-6_D_V1-0.zip
2024-01-10T00:51:28.275    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:51:28.276    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:51:28.276    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:51:28.276    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:51:28.276    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:51:28.276    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:51:28.276    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:51:28.276    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130413-101653-170_L1C_051-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/13/SPOT5-HRG2-XS_20130413-101656-034_L1C_051-258-0_D_V1-0/SPOT5-HRG2-XS_20130413-101656-034_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130413-101656-034_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130413-101656-034_L1C_051-258-0_D_V1-0.zip
run script
2024-01-10T00:55:32.980    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:55:32.982    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130413-101656-034_L1C_051-258-0_D_V1-0.zip
2024-01-10T00:55:32.982    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:55:32.982    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:55:32.982    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:55:32.982    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:55:32.982    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:55:32.982    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:55:32.982    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:55:32.982    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T00:58:02.975    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 834). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130413-101656-034_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2013/04/13/SPOT5-HRG2-XS_20130413-101704-336_L1C_051-259-0_D_V1-0/SPOT5-HRG2-XS_20130413-101704-336_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20130413-101704-336_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130413-101704-336_L1C_051-259-0_D_V1-0.zip
run script
2024-01-10T00:58:07.845    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:58:07.845    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130413-101704-336_L1C_051-259-0_D_V1-0.zip
2024-01-10T00:58:07.845    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:58:07.845    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:58:07.845    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:58:07.845    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:58:07.845    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:58:07.845    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:58:07.845    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:58:07.845    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG2-XS_20130413-101704-336_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/11/27/SPOT5-HRG1-XS_20131127-102039-433_L1C_049-256-9_D_V1-0/SPOT5-HRG1-XS_20131127-102039-433_L1C_049-256-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20131127-102039-433_L1C_049-256-9_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131127-102039-433_L1C_049-256-9_D_V1-0.zip
run script
2024-01-10T01:01:30.572    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:01:30.573    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131127-102039-433_L1C_049-256-9_D_V1-0.zip
2024-01-10T01:01:30.573    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:01:30.573    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:01:30.573    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:01:30.573    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:01:30.573    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:01:30.574    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:01:30.574    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:01:30.574    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131127-102039-433_L1C_049-256-9_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/11/27/SPOT5-HRG1-XS_20131127-102039-674_L1C_049-257-0_D_V1-0/SPOT5-HRG1-XS_20131127-102039-674_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20131127-102039-674_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131127-102039-674_L1C_049-257-0_D_V1-0.zip
run script
2024-01-10T01:05:11.470    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:05:11.481    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131127-102039-674_L1C_049-257-0_D_V1-0.zip
2024-01-10T01:05:11.481    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:05:11.481    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:05:11.482    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:05:11.482    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:05:11.482    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:05:11.482    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:05:11.482    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:05:11.482    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131127-102039-674_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/11/27/SPOT5-HRG1-XS_20131127-102041-479_L1C_049-257-2_D_V1-0/SPOT5-HRG1-XS_20131127-102041-479_L1C_049-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20131127-102041-479_L1C_049-257-2_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131127-102041-479_L1C_049-257-2_D_V1-0.zip
run script
2024-01-10T01:09:07.579    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:09:07.580    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131127-102041-479_L1C_049-257-2_D_V1-0.zip
2024-01-10T01:09:07.580    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:09:07.580    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:09:07.580    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:09:07.580    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:09:07.581    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:09:07.581    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:09:07.581    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:09:07.581    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131127-102041-479_L1C_049-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 0 ... 2 2 2]
 [1 1 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/12/02/SPOT5-HRG1-XS_20131202-102411-667_L1C_049-256-9_D_V1-0/SPOT5-HRG1-XS_20131202-102411-667_L1C_049-256-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20131202-102411-667_L1C_049-256-9_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131202-102411-667_L1C_049-256-9_D_V1-0.zip
run script
2024-01-10T01:12:44.113    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:12:44.114    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131202-102411-667_L1C_049-256-9_D_V1-0.zip
2024-01-10T01:12:44.114    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:12:44.114    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:12:44.114    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:12:44.114    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:12:44.114    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:12:44.114    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:12:44.114    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:12:44.115    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131202-102411-667_L1C_049-256-9_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 1 0 ... 2 2 2]
 [0 1 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/12/02/SPOT5-HRG1-XS_20131202-102411-931_L1C_049-257-0_D_V1-0/SPOT5-HRG1-XS_20131202-102411-931_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20131202-102411-931_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131202-102411-931_L1C_049-257-0_D_V1-0.zip
run script
2024-01-10T01:16:54.399    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:16:54.401    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131202-102411-931_L1C_049-257-0_D_V1-0.zip
2024-01-10T01:16:54.401    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:16:54.401    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:16:54.401    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:16:54.401    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:16:54.401    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:16:54.402    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:16:54.402    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:16:54.402    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016224/INPUT/SPOT5-HRG1-XS_20131202-102411-931_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016224/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 1 0 ... 2 2 2]
 [0 1 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
end
[2024-01-10 01:20:57.547499312+00:00] cnes_level2/barrouz/4016224:  Account (env) = cnes_level2
[2024-01-10 01:20:57.548983460+00:00] cnes_level2/barrouz/4016224:     User (env) = barrouz
[2024-01-10 01:20:57.550432849+00:00] cnes_level2/barrouz/4016224:        GroupId = cesbio(426000053)
[2024-01-10 01:20:57.551859198+00:00] cnes_level2/barrouz/4016224:         UserId = barrouz(9134)
[2024-01-10 01:20:57.553230348+00:00] cnes_level2/barrouz/4016224:        Account = cnes_level2
[2024-01-10 01:20:57.554514159+00:00] cnes_level2/barrouz/4016224:        Account = cnes_level2
[2024-01-10 01:20:57.555808270+00:00] cnes_level2/barrouz/4016224:      Partition = cpu2022
[2024-01-10 01:20:57.557151320+00:00] cnes_level2/barrouz/4016224:            QOS = cpu_2022_1280
[2024-01-10 01:20:57.558441491+00:00] cnes_level2/barrouz/4016224:        JobName = inf_ALP_26_TCD-BLUE_AVG-1200
[2024-01-10 01:20:57.559819081+00:00] cnes_level2/barrouz/4016224:     SubmitTime = 2024-01-09T10:51:59
[2024-01-10 01:20:57.561103712+00:00] cnes_level2/barrouz/4016224:        RunTime = 06:28:29
[2024-01-10 01:20:57.562348464+00:00] cnes_level2/barrouz/4016224:      TimeLimit = 1-16:00:00
[2024-01-10 01:20:57.563580636+00:00] cnes_level2/barrouz/4016224:   EligibleTime = 2024-01-09T10:51:59
[2024-01-10 01:20:57.564853947+00:00] cnes_level2/barrouz/4016224:      StartTime = 2024-01-09T18:52:28
[2024-01-10 01:20:57.566249626+00:00] cnes_level2/barrouz/4016224:        EndTime = 2024-01-10T01:20:57
[2024-01-10 01:20:57.567640176+00:00] cnes_level2/barrouz/4016224:       ExitCode = 0:0
[2024-01-10 01:20:57.568904728+00:00] cnes_level2/barrouz/4016224:       NodeList = trex050
[2024-01-10 01:20:57.570147169+00:00] cnes_level2/barrouz/4016224:      BatchHost = trex050
[2024-01-10 01:20:57.571415691+00:00] cnes_level2/barrouz/4016224:           TRES = 
[2024-01-10 01:20:57.572628043+00:00] cnes_level2/barrouz/4016224:        Command = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
[2024-01-10 01:20:57.573876225+00:00] cnes_level2/barrouz/4016224:        WorkDir = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code
[2024-01-10 01:20:57.575093187+00:00] cnes_level2/barrouz/4016224:         StdErr = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_26_TCD-BLUE_AVG-1200.log
[2024-01-10 01:20:57.576320038+00:00] cnes_level2/barrouz/4016224:         StdOut = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_26_TCD-BLUE_AVG-1200.log

#########################################
#        EVIDEN - CNES                  #
#        Job Accounting                 #
#########################################
Cluster              : trex
JobIDRaw             : 4016224
JobID                : 4016224
JobName              : inf_ALP_26_TCD-BLUE_AVG-1200
Account              : cnes_level2
User                 : barrouz(9134), cesbio(426000053)
Partition            : cpu2022
QOS                  : cpu_2022_1280
Nodelist             : trex050 (1)
State                : COMPLETED  (Exitcode=0:0, DerivedExitCode=0:0, Restarts=0)
Submit date          : 2024-01-09T10:51:59
Start time           : 2024-01-09T18:52:28
End time             : 2024-01-10T01:20:57
Elapsed time         : 06:28:29  (Timelimit=1-16:00:00, Suspended=00:00:00)
TEI                  : 2 days, 3:47:52
Command              : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
StdOut               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_26_TCD-BLUE_AVG-1200.log
StdErr               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_26_TCD-BLUE_AVG-1200.log

STEP(s) : 2
--------- 
   StepID  | JobName      State       Exit   Start               End                 Elapsed   TotalCPU   CPUTime    ConsumedEnergy MaxDiskRead MaxDiskWrite     MaxRSS MaxRSSTask MaxRSSNode NNodes UserCPU    NodeList
   ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 
   batch   | batch        COMPLETED   0:0    2024-01-09T18:52:28 2024-01-10T01:20:57 06:28:29  1-03:55:51 2-03:47:52      0.186875M  205427.85M    80874.99M  99213224K          0    trex050      1 19:28:30   trex050
   extern  | extern       COMPLETED   0:0    2024-01-09T18:52:28 2024-01-10T01:20:57 06:28:29  00:00.001  2-03:47:52      0.186875M       0.00M        0.00M      1684K          0    trex050      1 00:00:00   trex050

