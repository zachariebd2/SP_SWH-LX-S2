unload conda/22.11.1  : OK 
load conda/22.11.1  : OK 
envs_dirs : /work/scratch/env/barrouz/conda_env/
pkgs_dirs : /work/scratch/env/barrouz/pkgs_conda
INPUT_PATH /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/PYR/32.txt
OUTPUT_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
DEM_PATH /work/CAMPUS/etudes/Neige/DEM
TCD_PATH /work/datalake/static_aux/TreeCoverDensity
MODELS_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
KEEP_REFL 0
MASK 1
start
/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/PYR/32.txt
muscate/SPOTWORLDHERITAGE/1993/12/22/SPOT3-HRV2-XS_19931222-110611-083_L1C_043-262-8_D_V1-0/SPOT3-HRV2-XS_19931222-110611-083_L1C_043-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19931222-110611-083_L1C_043-262-8_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT3-HRV2-XS_19931222-110611-083_L1C_043-262-8_D_V1-0.zip
run script
2024-01-10T09:18:27.012    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T09:18:27.014    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT3-HRV2-XS_19931222-110611-083_L1C_043-262-8_D_V1-0.zip
2024-01-10T09:18:27.014    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T09:18:27.014    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T09:18:27.014    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T09:18:27.014    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T09:18:27.014    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T09:18:27.014    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T09:18:27.014    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T09:18:27.014    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT3-HRV2-XS_19931222-110611-083_L1C_043-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1993/12/22/SPOT3-HRV2-XS_19931222-110612-271_L1C_043-263-0_D_V1-0/SPOT3-HRV2-XS_19931222-110612-271_L1C_043-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19931222-110612-271_L1C_043-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT3-HRV2-XS_19931222-110612-271_L1C_043-263-0_D_V1-0.zip
run script
2024-01-10T09:19:46.208    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T09:19:46.210    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT3-HRV2-XS_19931222-110612-271_L1C_043-263-0_D_V1-0.zip
2024-01-10T09:19:46.210    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T09:19:46.210    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T09:19:46.210    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T09:19:46.210    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T09:19:46.210    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T09:19:46.210    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T09:19:46.210    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T09:19:46.210    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT3-HRV2-XS_19931222-110612-271_L1C_043-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1993/12/22/SPOT3-HRV2-XS_19931222-110620-685_L1C_043-264-0_D_V1-0/SPOT3-HRV2-XS_19931222-110620-685_L1C_043-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19931222-110620-685_L1C_043-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT3-HRV2-XS_19931222-110620-685_L1C_043-264-0_D_V1-0.zip
run script
2024-01-10T09:21:17.751    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T09:21:17.752    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT3-HRV2-XS_19931222-110620-685_L1C_043-264-0_D_V1-0.zip
2024-01-10T09:21:17.752    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T09:21:17.752    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T09:21:17.752    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T09:21:17.752    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T09:21:17.752    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T09:21:17.752    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T09:21:17.752    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T09:21:17.752    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT3-HRV2-XS_19931222-110620-685_L1C_043-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1993/12/02/SPOT3-HRV1-XS_19931202-105041-794_L1C_043-263-6_D_V1-0/SPOT3-HRV1-XS_19931202-105041-794_L1C_043-263-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19931202-105041-794_L1C_043-263-6_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT3-HRV1-XS_19931202-105041-794_L1C_043-263-6_D_V1-0.zip
run script
2024-01-10T09:23:18.987    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T09:23:18.989    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT3-HRV1-XS_19931202-105041-794_L1C_043-263-6_D_V1-0.zip
2024-01-10T09:23:18.989    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T09:23:18.989    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T09:23:18.989    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T09:23:18.989    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T09:23:18.989    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T09:23:18.989    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T09:23:18.989    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T09:23:18.989    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT3-HRV1-XS_19931202-105041-794_L1C_043-263-6_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1993/12/02/SPOT3-HRV1-XS_19931202-105044-700_L1C_043-264-0_D_V1-0/SPOT3-HRV1-XS_19931202-105044-700_L1C_043-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19931202-105044-700_L1C_043-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT3-HRV1-XS_19931202-105044-700_L1C_043-264-0_D_V1-0.zip
run script
2024-01-10T09:25:08.908    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T09:25:08.909    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT3-HRV1-XS_19931202-105044-700_L1C_043-264-0_D_V1-0.zip
2024-01-10T09:25:08.909    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T09:25:08.909    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T09:25:08.909    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T09:25:08.909    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T09:25:08.909    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T09:25:08.910    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T09:25:08.910    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T09:25:08.910    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT3-HRV1-XS_19931202-105044-700_L1C_043-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1993/12/07/SPOT3-HRV2-XS_19931207-105433-085_L1C_043-263-5_D_V1-0/SPOT3-HRV2-XS_19931207-105433-085_L1C_043-263-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19931207-105433-085_L1C_043-263-5_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT3-HRV2-XS_19931207-105433-085_L1C_043-263-5_D_V1-0.zip
run script
2024-01-10T09:27:00.286    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T09:27:00.287    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT3-HRV2-XS_19931207-105433-085_L1C_043-263-5_D_V1-0.zip
2024-01-10T09:27:00.287    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T09:27:00.287    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T09:27:00.287    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T09:27:00.287    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T09:27:00.287    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T09:27:00.287    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T09:27:00.287    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T09:27:00.287    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT3-HRV2-XS_19931207-105433-085_L1C_043-263-5_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1993/12/07/SPOT3-HRV2-XS_19931207-105436-918_L1C_043-264-0_D_V1-0/SPOT3-HRV2-XS_19931207-105436-918_L1C_043-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19931207-105436-918_L1C_043-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT3-HRV2-XS_19931207-105436-918_L1C_043-264-0_D_V1-0.zip
run script
2024-01-10T09:28:51.031    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T09:28:51.032    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT3-HRV2-XS_19931207-105436-918_L1C_043-264-0_D_V1-0.zip
2024-01-10T09:28:51.033    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T09:28:51.033    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T09:28:51.033    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T09:28:51.033    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T09:28:51.033    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T09:28:51.033    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T09:28:51.033    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T09:28:51.033    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT3-HRV2-XS_19931207-105436-918_L1C_043-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/25/SPOT1-HRV2-XS_19920825-111528-657_L1C_037-262-5_D_V1-0/SPOT1-HRV2-XS_19920825-111528-657_L1C_037-262-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920825-111528-657_L1C_037-262-5_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920825-111528-657_L1C_037-262-5_D_V1-0.zip
run script
2024-01-10T09:30:40.836    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T09:30:40.837    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920825-111528-657_L1C_037-262-5_D_V1-0.zip
2024-01-10T09:30:40.837    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T09:30:40.837    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T09:30:40.837    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T09:30:40.838    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T09:30:40.838    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T09:30:40.838    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T09:30:40.838    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T09:30:40.838    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920825-111528-657_L1C_037-262-5_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/25/SPOT1-HRV2-XS_19920825-111532-552_L1C_037-263-0_D_V1-0/SPOT1-HRV2-XS_19920825-111532-552_L1C_037-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920825-111532-552_L1C_037-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920825-111532-552_L1C_037-263-0_D_V1-0.zip
run script
2024-01-10T09:31:29.348    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T09:31:29.349    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920825-111532-552_L1C_037-263-0_D_V1-0.zip
2024-01-10T09:31:29.349    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T09:31:29.349    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T09:31:29.349    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T09:31:29.349    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T09:31:29.350    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T09:31:29.350    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T09:31:29.350    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T09:31:29.350    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920825-111532-552_L1C_037-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/07/19/SPOT1-HRV2-XS_19920719-112718-859_L1C_037-263-3_D_V1-0/SPOT1-HRV2-XS_19920719-112718-859_L1C_037-263-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920719-112718-859_L1C_037-263-3_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920719-112718-859_L1C_037-263-3_D_V1-0.zip
run script
2024-01-10T09:32:48.193    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T09:32:48.195    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920719-112718-859_L1C_037-263-3_D_V1-0.zip
2024-01-10T09:32:48.195    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T09:32:48.195    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T09:32:48.195    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T09:32:48.196    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T09:32:48.196    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T09:32:48.196    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T09:32:48.196    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T09:32:48.196    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920719-112718-859_L1C_037-263-3_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/30/SPOT1-HRV2-XS_19920830-111924-758_L1C_037-263-0_D_V1-0/SPOT1-HRV2-XS_19920830-111924-758_L1C_037-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920830-111924-758_L1C_037-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920830-111924-758_L1C_037-263-0_D_V1-0.zip
run script
2024-01-10T09:34:37.033    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T09:34:37.034    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920830-111924-758_L1C_037-263-0_D_V1-0.zip
2024-01-10T09:34:37.034    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T09:34:37.034    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T09:34:37.035    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T09:34:37.035    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T09:34:37.035    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T09:34:37.035    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T09:34:37.035    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T09:34:37.035    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920830-111924-758_L1C_037-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/05/04/SPOT1-HRV1-XS_19920504-104852-279_L1C_038-263-0_D_V1-0/SPOT1-HRV1-XS_19920504-104852-279_L1C_038-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920504-104852-279_L1C_038-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920504-104852-279_L1C_038-263-0_D_V1-0.zip
run script
2024-01-10T09:36:05.290    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T09:36:05.291    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920504-104852-279_L1C_038-263-0_D_V1-0.zip
2024-01-10T09:36:05.291    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T09:36:05.291    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T09:36:05.291    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T09:36:05.291    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T09:36:05.291    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T09:36:05.292    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T09:36:05.292    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T09:36:05.292    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920504-104852-279_L1C_038-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/05/14/SPOT1-HRV1-XS_19920514-105632-061_L1C_038-263-0_D_V1-0/SPOT1-HRV1-XS_19920514-105632-061_L1C_038-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920514-105632-061_L1C_038-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920514-105632-061_L1C_038-263-0_D_V1-0.zip
run script
2024-01-10T09:37:26.183    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T09:37:26.184    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920514-105632-061_L1C_038-263-0_D_V1-0.zip
2024-01-10T09:37:26.184    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T09:37:26.184    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T09:37:26.184    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T09:37:26.184    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T09:37:26.184    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T09:37:26.184    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T09:37:26.184    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T09:37:26.184    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920514-105632-061_L1C_038-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 2 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/05/14/SPOT1-HRV1-XS_19920514-105640-378_L1C_038-264-0_D_V1-0/SPOT1-HRV1-XS_19920514-105640-378_L1C_038-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920514-105640-378_L1C_038-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920514-105640-378_L1C_038-264-0_D_V1-0.zip
run script
2024-01-10T09:38:44.521    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T09:38:44.523    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920514-105640-378_L1C_038-264-0_D_V1-0.zip
2024-01-10T09:38:44.523    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T09:38:44.523    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T09:38:44.523    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T09:38:44.523    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T09:38:44.523    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T09:38:44.523    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T09:38:44.523    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T09:38:44.524    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920514-105640-378_L1C_038-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/05/14/SPOT1-HRV2-XS_19920514-105628-370_L1C_041-263-0_D_V1-0/SPOT1-HRV2-XS_19920514-105628-370_L1C_041-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920514-105628-370_L1C_041-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920514-105628-370_L1C_041-263-0_D_V1-0.zip
run script
2024-01-10T09:40:35.223    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T09:40:35.224    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920514-105628-370_L1C_041-263-0_D_V1-0.zip
2024-01-10T09:40:35.224    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T09:40:35.224    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T09:40:35.224    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T09:40:35.224    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T09:40:35.224    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T09:40:35.224    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T09:40:35.224    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T09:40:35.224    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920514-105628-370_L1C_041-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/05/14/SPOT1-HRV2-XS_19920514-105636-718_L1C_041-264-0_D_V1-0/SPOT1-HRV2-XS_19920514-105636-718_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920514-105636-718_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920514-105636-718_L1C_041-264-0_D_V1-0.zip
run script
2024-01-10T09:42:05.761    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T09:42:05.762    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920514-105636-718_L1C_041-264-0_D_V1-0.zip
2024-01-10T09:42:05.762    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T09:42:05.763    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T09:42:05.763    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T09:42:05.763    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T09:42:05.763    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T09:42:05.763    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T09:42:05.763    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T09:42:05.763    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920514-105636-718_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/07/14/SPOT1-HRV1-XS_19920714-112323-284_L1C_038-263-0_D_V1-0/SPOT1-HRV1-XS_19920714-112323-284_L1C_038-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920714-112323-284_L1C_038-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920714-112323-284_L1C_038-263-0_D_V1-0.zip
run script
2024-01-10T09:44:09.590    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T09:44:09.591    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920714-112323-284_L1C_038-263-0_D_V1-0.zip
2024-01-10T09:44:09.591    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T09:44:09.591    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T09:44:09.591    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T09:44:09.591    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T09:44:09.591    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T09:44:09.591    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T09:44:09.592    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T09:44:09.592    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920714-112323-284_L1C_038-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/07/14/SPOT1-HRV1-XS_19920714-112331-775_L1C_038-264-0_D_V1-0/SPOT1-HRV1-XS_19920714-112331-775_L1C_038-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920714-112331-775_L1C_038-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920714-112331-775_L1C_038-264-0_D_V1-0.zip
run script
2024-01-10T09:45:57.418    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T09:45:57.419    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920714-112331-775_L1C_038-264-0_D_V1-0.zip
2024-01-10T09:45:57.419    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T09:45:57.419    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T09:45:57.420    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T09:45:57.420    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T09:45:57.420    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T09:45:57.420    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T09:45:57.420    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T09:45:57.420    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920714-112331-775_L1C_038-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/07/15/SPOT1-HRV1-XS_19920715-110406-644_L1C_038-263-0_D_V1-0/SPOT1-HRV1-XS_19920715-110406-644_L1C_038-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920715-110406-644_L1C_038-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920715-110406-644_L1C_038-263-0_D_V1-0.zip
run script
2024-01-10T09:48:32.177    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T09:48:32.179    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920715-110406-644_L1C_038-263-0_D_V1-0.zip
2024-01-10T09:48:32.179    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T09:48:32.179    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T09:48:32.179    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T09:48:32.179    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T09:48:32.179    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T09:48:32.179    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T09:48:32.179    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T09:48:32.179    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920715-110406-644_L1C_038-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/07/15/SPOT1-HRV1-XS_19920715-110411-156_L1C_038-263-5_D_V1-0/SPOT1-HRV1-XS_19920715-110411-156_L1C_038-263-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920715-110411-156_L1C_038-263-5_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920715-110411-156_L1C_038-263-5_D_V1-0.zip
run script
2024-01-10T09:49:51.096    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T09:49:51.097    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920715-110411-156_L1C_038-263-5_D_V1-0.zip
2024-01-10T09:49:51.097    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T09:49:51.097    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T09:49:51.097    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T09:49:51.097    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T09:49:51.098    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T09:49:51.098    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T09:49:51.098    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T09:49:51.098    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920715-110411-156_L1C_038-263-5_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 0 1 1]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/07/15/SPOT1-HRV2-XS_19920715-110402-547_L1C_041-263-0_D_V1-0/SPOT1-HRV2-XS_19920715-110402-547_L1C_041-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920715-110402-547_L1C_041-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920715-110402-547_L1C_041-263-0_D_V1-0.zip
run script
2024-01-10T09:51:39.422    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T09:51:39.423    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920715-110402-547_L1C_041-263-0_D_V1-0.zip
2024-01-10T09:51:39.423    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T09:51:39.424    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T09:51:39.424    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T09:51:39.424    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T09:51:39.424    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T09:51:39.424    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T09:51:39.424    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T09:51:39.424    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920715-110402-547_L1C_041-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/07/15/SPOT1-HRV2-XS_19920715-110410-934_L1C_041-264-0_D_V1-0/SPOT1-HRV2-XS_19920715-110410-934_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920715-110410-934_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920715-110410-934_L1C_041-264-0_D_V1-0.zip
run script
2024-01-10T09:53:13.888    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T09:53:13.889    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920715-110410-934_L1C_041-264-0_D_V1-0.zip
2024-01-10T09:53:13.890    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T09:53:13.890    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T09:53:13.890    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T09:53:13.890    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T09:53:13.890    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T09:53:13.890    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T09:53:13.890    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T09:53:13.890    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920715-110410-934_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/05/08/SPOT1-HRV2-XS_19920508-111208-741_L1C_038-264-0_D_V1-0/SPOT1-HRV2-XS_19920508-111208-741_L1C_038-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920508-111208-741_L1C_038-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920508-111208-741_L1C_038-264-0_D_V1-0.zip
run script
2024-01-10T09:55:33.247    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T09:55:33.248    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920508-111208-741_L1C_038-264-0_D_V1-0.zip
2024-01-10T09:55:33.248    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T09:55:33.248    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T09:55:33.248    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T09:55:33.249    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T09:55:33.249    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T09:55:33.249    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T09:55:33.249    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T09:55:33.249    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920508-111208-741_L1C_038-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/20/SPOT1-HRV2-XS_19920820-111146-284_L1C_038-264-0_D_V1-0/SPOT1-HRV2-XS_19920820-111146-284_L1C_038-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920820-111146-284_L1C_038-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920820-111146-284_L1C_038-264-0_D_V1-0.zip
run script
2024-01-10T09:57:32.181    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T09:57:32.182    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920820-111146-284_L1C_038-264-0_D_V1-0.zip
2024-01-10T09:57:32.182    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T09:57:32.182    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T09:57:32.182    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T09:57:32.182    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T09:57:32.182    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T09:57:32.182    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T09:57:32.182    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T09:57:32.182    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920820-111146-284_L1C_038-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/09/05/SPOT1-HRV1-XS_19920905-110354-490_L1C_039-262-6_D_V1-0/SPOT1-HRV1-XS_19920905-110354-490_L1C_039-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920905-110354-490_L1C_039-262-6_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920905-110354-490_L1C_039-262-6_D_V1-0.zip
run script
2024-01-10T09:59:31.878    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T09:59:31.880    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920905-110354-490_L1C_039-262-6_D_V1-0.zip
2024-01-10T09:59:31.880    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T09:59:31.880    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T09:59:31.880    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T09:59:31.880    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T09:59:31.880    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T09:59:31.880    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T09:59:31.880    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T09:59:31.880    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920905-110354-490_L1C_039-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/09/05/SPOT1-HRV1-XS_19920905-110404-654_L1C_039-263-8_D_V1-0/SPOT1-HRV1-XS_19920905-110404-654_L1C_039-263-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920905-110404-654_L1C_039-263-8_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920905-110404-654_L1C_039-263-8_D_V1-0.zip
run script
2024-01-10T10:00:32.813    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:00:32.815    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920905-110404-654_L1C_039-263-8_D_V1-0.zip
2024-01-10T10:00:32.815    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:00:32.815    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:00:32.815    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:00:32.815    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:00:32.815    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:00:32.815    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:00:32.815    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:00:32.815    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920905-110404-654_L1C_039-263-8_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/09/05/SPOT1-HRV1-XS_19920905-110405-794_L1C_039-264-0_D_V1-0/SPOT1-HRV1-XS_19920905-110405-794_L1C_039-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920905-110405-794_L1C_039-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920905-110405-794_L1C_039-264-0_D_V1-0.zip
run script
2024-01-10T10:02:52.372    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:02:52.374    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920905-110405-794_L1C_039-264-0_D_V1-0.zip
2024-01-10T10:02:52.374    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:02:52.374    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:02:52.374    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:02:52.374    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:02:52.374    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:02:52.374    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:02:52.374    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:02:52.374    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920905-110405-794_L1C_039-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/09/05/SPOT1-HRV2-XS_19920905-110354-192_L1C_041-263-0_D_V1-0/SPOT1-HRV2-XS_19920905-110354-192_L1C_041-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920905-110354-192_L1C_041-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920905-110354-192_L1C_041-263-0_D_V1-0.zip
run script
2024-01-10T10:04:43.008    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:04:43.009    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920905-110354-192_L1C_041-263-0_D_V1-0.zip
2024-01-10T10:04:43.009    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:04:43.009    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:04:43.009    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:04:43.010    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:04:43.010    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:04:43.010    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:04:43.010    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:04:43.010    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920905-110354-192_L1C_041-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/09/05/SPOT1-HRV2-XS_19920905-110402-584_L1C_041-264-0_D_V1-0/SPOT1-HRV2-XS_19920905-110402-584_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920905-110402-584_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920905-110402-584_L1C_041-264-0_D_V1-0.zip
run script
2024-01-10T10:06:13.417    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:06:13.419    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920905-110402-584_L1C_041-264-0_D_V1-0.zip
2024-01-10T10:06:13.419    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:06:13.419    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:06:13.419    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:06:13.419    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:06:13.419    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:06:13.419    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:06:13.419    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:06:13.419    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920905-110402-584_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/10/SPOT1-HRV1-XS_19920810-110359-173_L1C_039-263-0_D_V1-0/SPOT1-HRV1-XS_19920810-110359-173_L1C_039-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920810-110359-173_L1C_039-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920810-110359-173_L1C_039-263-0_D_V1-0.zip
run script
2024-01-10T10:08:20.522    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:08:20.523    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920810-110359-173_L1C_039-263-0_D_V1-0.zip
2024-01-10T10:08:20.523    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:08:20.523    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:08:20.523    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:08:20.523    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:08:20.523    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:08:20.523    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:08:20.523    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:08:20.523    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920810-110359-173_L1C_039-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/10/SPOT1-HRV1-XS_19920810-110407-533_L1C_039-264-0_D_V1-0/SPOT1-HRV1-XS_19920810-110407-533_L1C_039-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920810-110407-533_L1C_039-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920810-110407-533_L1C_039-264-0_D_V1-0.zip
run script
2024-01-10T10:09:36.259    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:09:36.260    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920810-110407-533_L1C_039-264-0_D_V1-0.zip
2024-01-10T10:09:36.260    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:09:36.260    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:09:36.261    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:09:36.261    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:09:36.261    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:09:36.261    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:09:36.261    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:09:36.261    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920810-110407-533_L1C_039-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/10/SPOT1-HRV2-XS_19920810-110337-128_L1C_048-262-0_D_V1-0/SPOT1-HRV2-XS_19920810-110337-128_L1C_048-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920810-110337-128_L1C_048-262-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920810-110337-128_L1C_048-262-0_D_V1-0.zip
run script
2024-01-10T10:11:27.629    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:11:27.630    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920810-110337-128_L1C_048-262-0_D_V1-0.zip
2024-01-10T10:11:27.630    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:11:27.630    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:11:27.630    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:11:27.630    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:11:27.630    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:11:27.630    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:11:27.630    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:11:27.630    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920810-110337-128_L1C_048-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1992/09/01/SPOT1-HRV1-XS_19920901-104045-457_L1C_039-263-0_D_V1-0/SPOT1-HRV1-XS_19920901-104045-457_L1C_039-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920901-104045-457_L1C_039-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920901-104045-457_L1C_039-263-0_D_V1-0.zip
run script
2024-01-10T10:11:30.723    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:11:30.723    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920901-104045-457_L1C_039-263-0_D_V1-0.zip
2024-01-10T10:11:30.723    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:11:30.723    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:11:30.723    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:11:30.723    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:11:30.723    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:11:30.724    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:11:30.724    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:11:30.724    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920901-104045-457_L1C_039-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/09/01/SPOT1-HRV1-XS_19920901-104053-729_L1C_039-264-0_D_V1-0/SPOT1-HRV1-XS_19920901-104053-729_L1C_039-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920901-104053-729_L1C_039-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920901-104053-729_L1C_039-264-0_D_V1-0.zip
run script
2024-01-10T10:13:01.172    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:13:01.174    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920901-104053-729_L1C_039-264-0_D_V1-0.zip
2024-01-10T10:13:01.174    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:13:01.174    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:13:01.174    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:13:01.174    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:13:01.174    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:13:01.174    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:13:01.174    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:13:01.174    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920901-104053-729_L1C_039-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/09/20/SPOT1-HRV2-XS_19920920-111531-100_L1C_039-263-0_D_V1-0/SPOT1-HRV2-XS_19920920-111531-100_L1C_039-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920920-111531-100_L1C_039-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920920-111531-100_L1C_039-263-0_D_V1-0.zip
run script
2024-01-10T10:15:13.146    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:15:13.147    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920920-111531-100_L1C_039-263-0_D_V1-0.zip
2024-01-10T10:15:13.147    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:15:13.147    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:15:13.148    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:15:13.148    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:15:13.148    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:15:13.148    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:15:13.148    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:15:13.148    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920920-111531-100_L1C_039-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/09/20/SPOT1-HRV2-XS_19920920-111532-003_L1C_039-263-1_D_V1-0/SPOT1-HRV2-XS_19920920-111532-003_L1C_039-263-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920920-111532-003_L1C_039-263-1_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920920-111532-003_L1C_039-263-1_D_V1-0.zip
run script
2024-01-10T10:16:43.059    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:16:43.060    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920920-111532-003_L1C_039-263-1_D_V1-0.zip
2024-01-10T10:16:43.060    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:16:43.061    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:16:43.061    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:16:43.061    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:16:43.061    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:16:43.061    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:16:43.061    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:16:43.061    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920920-111532-003_L1C_039-263-1_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/09/25/SPOT1-HRV2-XS_19920925-111926-805_L1C_039-263-7_D_V1-0/SPOT1-HRV2-XS_19920925-111926-805_L1C_039-263-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920925-111926-805_L1C_039-263-7_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920925-111926-805_L1C_039-263-7_D_V1-0.zip
run script
2024-01-10T10:18:19.663    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:18:19.664    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920925-111926-805_L1C_039-263-7_D_V1-0.zip
2024-01-10T10:18:19.664    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:18:19.664    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:18:19.664    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:18:19.664    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:18:19.664    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:18:19.664    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:18:19.664    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:18:19.665    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920925-111926-805_L1C_039-263-7_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/09/25/SPOT1-HRV2-XS_19920925-111928-962_L1C_039-264-0_D_V1-0/SPOT1-HRV2-XS_19920925-111928-962_L1C_039-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920925-111928-962_L1C_039-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920925-111928-962_L1C_039-264-0_D_V1-0.zip
run script
2024-01-10T10:20:43.263    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:20:43.264    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920925-111928-962_L1C_039-264-0_D_V1-0.zip
2024-01-10T10:20:43.264    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:20:43.264    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:20:43.264    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:20:43.264    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:20:43.264    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:20:43.264    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:20:43.264    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:20:43.264    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920925-111928-962_L1C_039-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/05/SPOT1-HRV1-XS_19920805-110007-853_L1C_040-263-0_D_V1-0/SPOT1-HRV1-XS_19920805-110007-853_L1C_040-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920805-110007-853_L1C_040-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920805-110007-853_L1C_040-263-0_D_V1-0.zip
run script
2024-01-10T10:23:04.203    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:23:04.204    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920805-110007-853_L1C_040-263-0_D_V1-0.zip
2024-01-10T10:23:04.204    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:23:04.204    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:23:04.204    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:23:04.204    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:23:04.204    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:23:04.204    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:23:04.204    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:23:04.204    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920805-110007-853_L1C_040-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/05/SPOT1-HRV1-XS_19920805-110016-206_L1C_040-264-0_D_V1-0/SPOT1-HRV1-XS_19920805-110016-206_L1C_040-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920805-110016-206_L1C_040-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920805-110016-206_L1C_040-264-0_D_V1-0.zip
run script
2024-01-10T10:24:30.459    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:24:30.460    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920805-110016-206_L1C_040-264-0_D_V1-0.zip
2024-01-10T10:24:30.460    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:24:30.460    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:24:30.461    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:24:30.461    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:24:30.461    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:24:30.461    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:24:30.461    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:24:30.461    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920805-110016-206_L1C_040-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/22/SPOT1-HRV2-XS_19920422-111954-178_L1C_040-264-0_D_V1-0/SPOT1-HRV2-XS_19920422-111954-178_L1C_040-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920422-111954-178_L1C_040-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920422-111954-178_L1C_040-264-0_D_V1-0.zip
run script
2024-01-10T10:26:17.274    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:26:17.275    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920422-111954-178_L1C_040-264-0_D_V1-0.zip
2024-01-10T10:26:17.275    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:26:17.275    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:26:17.275    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:26:17.275    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:26:17.275    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:26:17.276    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:26:17.276    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:26:17.276    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920422-111954-178_L1C_040-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/22/SPOT1-HRV2-XS_19920422-111942-597_L1C_041-262-6_D_V1-0/SPOT1-HRV2-XS_19920422-111942-597_L1C_041-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920422-111942-597_L1C_041-262-6_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920422-111942-597_L1C_041-262-6_D_V1-0.zip
run script
2024-01-10T10:29:09.029    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:29:09.030    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920422-111942-597_L1C_041-262-6_D_V1-0.zip
2024-01-10T10:29:09.030    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:29:09.031    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:29:09.031    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:29:09.031    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:29:09.031    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:29:09.031    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:29:09.031    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:29:09.031    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920422-111942-597_L1C_041-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/22/SPOT1-HRV2-XS_19920422-111945-677_L1C_041-263-0_D_V1-0/SPOT1-HRV2-XS_19920422-111945-677_L1C_041-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920422-111945-677_L1C_041-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920422-111945-677_L1C_041-263-0_D_V1-0.zip
run script
2024-01-10T10:30:23.374    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:30:23.375    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920422-111945-677_L1C_041-263-0_D_V1-0.zip
2024-01-10T10:30:23.375    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:30:23.375    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:30:23.375    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:30:23.375    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:30:23.375    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:30:23.375    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:30:23.375    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:30:23.375    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920422-111945-677_L1C_041-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/03/29/SPOT1-HRV1-XS_19920329-104058-715_L1C_041-263-0_D_V1-0/SPOT1-HRV1-XS_19920329-104058-715_L1C_041-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920329-104058-715_L1C_041-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920329-104058-715_L1C_041-263-0_D_V1-0.zip
run script
2024-01-10T10:32:19.587    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:32:19.588    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920329-104058-715_L1C_041-263-0_D_V1-0.zip
2024-01-10T10:32:19.588    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:32:19.588    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:32:19.588    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:32:19.588    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:32:19.588    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:32:19.588    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:32:19.589    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:32:19.589    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920329-104058-715_L1C_041-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/03/29/SPOT1-HRV1-XS_19920329-104106-993_L1C_041-264-0_D_V1-0/SPOT1-HRV1-XS_19920329-104106-993_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920329-104106-993_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920329-104106-993_L1C_041-264-0_D_V1-0.zip
run script
2024-01-10T10:33:52.168    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:33:52.170    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920329-104106-993_L1C_041-264-0_D_V1-0.zip
2024-01-10T10:33:52.170    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:33:52.170    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:33:52.170    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:33:52.170    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:33:52.170    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:33:52.170    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:33:52.170    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:33:52.170    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920329-104106-993_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/03/29/SPOT1-HRV2-XS_19920329-104056-838_L1C_043-262-9_D_V1-0/SPOT1-HRV2-XS_19920329-104056-838_L1C_043-262-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920329-104056-838_L1C_043-262-9_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920329-104056-838_L1C_043-262-9_D_V1-0.zip
run script
2024-01-10T10:36:06.561    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:36:06.562    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920329-104056-838_L1C_043-262-9_D_V1-0.zip
2024-01-10T10:36:06.562    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:36:06.562    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:36:06.562    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:36:06.563    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:36:06.563    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:36:06.563    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:36:06.563    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:36:06.563    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920329-104056-838_L1C_043-262-9_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/03/29/SPOT1-HRV2-XS_19920329-104105-284_L1C_043-264-0_D_V1-0/SPOT1-HRV2-XS_19920329-104105-284_L1C_043-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920329-104105-284_L1C_043-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920329-104105-284_L1C_043-264-0_D_V1-0.zip
run script
2024-01-10T10:37:31.484    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:37:31.485    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920329-104105-284_L1C_043-264-0_D_V1-0.zip
2024-01-10T10:37:31.485    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:37:31.485    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:37:31.485    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:37:31.485    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:37:31.485    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:37:31.485    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:37:31.485    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:37:31.485    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920329-104105-284_L1C_043-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/23/SPOT1-HRV1-XS_19920423-110035-663_L1C_041-263-8_D_V1-0/SPOT1-HRV1-XS_19920423-110035-663_L1C_041-263-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920423-110035-663_L1C_041-263-8_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920423-110035-663_L1C_041-263-8_D_V1-0.zip
run script
2024-01-10T10:39:25.394    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:39:25.396    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920423-110035-663_L1C_041-263-8_D_V1-0.zip
2024-01-10T10:39:25.396    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:39:25.396    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:39:25.396    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:39:25.396    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:39:25.396    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:39:25.396    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:39:25.396    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:39:25.396    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920423-110035-663_L1C_041-263-8_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/23/SPOT1-HRV2-XS_19920423-110010-098_L1C_048-262-0_D_V1-0/SPOT1-HRV2-XS_19920423-110010-098_L1C_048-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920423-110010-098_L1C_048-262-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920423-110010-098_L1C_048-262-0_D_V1-0.zip
run script
2024-01-10T10:41:30.077    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:41:30.079    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920423-110010-098_L1C_048-262-0_D_V1-0.zip
2024-01-10T10:41:30.079    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:41:30.079    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:41:30.079    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:41:30.079    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:41:30.079    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:41:30.079    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:41:30.079    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:41:30.079    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920423-110010-098_L1C_048-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1992/05/19/SPOT1-HRV1-XS_19920519-110022-302_L1C_041-263-0_D_V1-0/SPOT1-HRV1-XS_19920519-110022-302_L1C_041-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920519-110022-302_L1C_041-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920519-110022-302_L1C_041-263-0_D_V1-0.zip
run script
2024-01-10T10:41:32.906    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:41:32.908    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920519-110022-302_L1C_041-263-0_D_V1-0.zip
2024-01-10T10:41:32.908    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:41:32.908    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:41:32.908    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:41:32.908    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:41:32.908    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:41:32.908    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:41:32.908    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:41:32.908    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920519-110022-302_L1C_041-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/05/19/SPOT1-HRV1-XS_19920519-110023-204_L1C_041-263-1_D_V1-0/SPOT1-HRV1-XS_19920519-110023-204_L1C_041-263-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920519-110023-204_L1C_041-263-1_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920519-110023-204_L1C_041-263-1_D_V1-0.zip
run script
2024-01-10T10:42:58.040    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:42:58.041    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920519-110023-204_L1C_041-263-1_D_V1-0.zip
2024-01-10T10:42:58.041    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:42:58.041    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:42:58.041    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:42:58.041    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:42:58.041    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:42:58.041    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:42:58.042    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:42:58.042    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920519-110023-204_L1C_041-263-1_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/05/19/SPOT1-HRV2-XS_19920519-110020-316_L1C_042-263-0_D_V1-0/SPOT1-HRV2-XS_19920519-110020-316_L1C_042-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920519-110020-316_L1C_042-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920519-110020-316_L1C_042-263-0_D_V1-0.zip
run script
2024-01-10T10:44:32.987    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:44:32.988    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920519-110020-316_L1C_042-263-0_D_V1-0.zip
2024-01-10T10:44:32.989    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:44:32.989    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:44:32.989    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:44:32.989    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:44:32.989    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:44:32.989    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:44:32.989    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:44:32.989    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920519-110020-316_L1C_042-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [0 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/05/19/SPOT1-HRV2-XS_19920519-110023-926_L1C_042-263-4_D_V1-0/SPOT1-HRV2-XS_19920519-110023-926_L1C_042-263-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920519-110023-926_L1C_042-263-4_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920519-110023-926_L1C_042-263-4_D_V1-0.zip
run script
2024-01-10T10:45:58.344    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:45:58.345    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920519-110023-926_L1C_042-263-4_D_V1-0.zip
2024-01-10T10:45:58.345    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:45:58.345    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:45:58.345    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:45:58.345    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:45:58.345    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:45:58.345    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:45:58.345    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:45:58.345    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920519-110023-926_L1C_042-263-4_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/07/20/SPOT1-HRV1-XS_19920720-110753-657_L1C_041-263-0_D_V1-0/SPOT1-HRV1-XS_19920720-110753-657_L1C_041-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920720-110753-657_L1C_041-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920720-110753-657_L1C_041-263-0_D_V1-0.zip
run script
2024-01-10T10:47:43.760    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:47:43.761    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920720-110753-657_L1C_041-263-0_D_V1-0.zip
2024-01-10T10:47:43.761    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:47:43.761    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:47:43.761    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:47:43.761    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:47:43.761    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:47:43.761    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:47:43.761    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:47:43.761    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920720-110753-657_L1C_041-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/07/20/SPOT1-HRV1-XS_19920720-110802-067_L1C_041-264-0_D_V1-0/SPOT1-HRV1-XS_19920720-110802-067_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920720-110802-067_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920720-110802-067_L1C_041-264-0_D_V1-0.zip
run script
2024-01-10T10:49:18.497    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:49:18.498    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920720-110802-067_L1C_041-264-0_D_V1-0.zip
2024-01-10T10:49:18.498    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:49:18.499    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:49:18.499    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:49:18.499    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:49:18.499    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:49:18.499    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:49:18.499    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:49:18.499    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920720-110802-067_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/07/31/SPOT1-HRV1-XS_19920731-105616-956_L1C_041-263-0_D_V1-0/SPOT1-HRV1-XS_19920731-105616-956_L1C_041-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920731-105616-956_L1C_041-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920731-105616-956_L1C_041-263-0_D_V1-0.zip
run script
2024-01-10T10:51:35.893    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:51:35.895    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920731-105616-956_L1C_041-263-0_D_V1-0.zip
2024-01-10T10:51:35.895    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:51:35.895    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:51:35.895    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:51:35.895    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:51:35.895    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:51:35.895    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:51:35.895    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:51:35.895    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920731-105616-956_L1C_041-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/07/31/SPOT1-HRV1-XS_19920731-105625-295_L1C_041-264-0_D_V1-0/SPOT1-HRV1-XS_19920731-105625-295_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920731-105625-295_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920731-105625-295_L1C_041-264-0_D_V1-0.zip
run script
2024-01-10T10:53:00.309    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:53:00.310    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920731-105625-295_L1C_041-264-0_D_V1-0.zip
2024-01-10T10:53:00.310    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:53:00.311    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:53:00.311    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:53:00.311    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:53:00.311    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:53:00.311    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:53:00.311    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:53:00.311    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920731-105625-295_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/07/31/SPOT1-HRV2-XS_19920731-105612-453_L1C_042-262-6_D_V1-0/SPOT1-HRV2-XS_19920731-105612-453_L1C_042-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920731-105612-453_L1C_042-262-6_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920731-105612-453_L1C_042-262-6_D_V1-0.zip
run script
2024-01-10T10:55:01.265    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:55:01.266    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920731-105612-453_L1C_042-262-6_D_V1-0.zip
2024-01-10T10:55:01.266    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:55:01.266    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:55:01.266    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:55:01.266    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:55:01.267    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:55:01.267    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:55:01.267    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:55:01.267    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920731-105612-453_L1C_042-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/07/31/SPOT1-HRV2-XS_19920731-105615-380_L1C_042-263-0_D_V1-0/SPOT1-HRV2-XS_19920731-105615-380_L1C_042-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920731-105615-380_L1C_042-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920731-105615-380_L1C_042-263-0_D_V1-0.zip
run script
2024-01-10T10:55:50.774    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:55:50.775    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920731-105615-380_L1C_042-263-0_D_V1-0.zip
2024-01-10T10:55:50.775    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:55:50.776    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:55:50.776    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:55:50.776    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:55:50.776    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:55:50.776    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:55:50.776    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:55:50.776    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T10:57:02.333    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1274 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920731-105615-380_L1C_042-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1992/07/31/SPOT1-HRV2-XS_19920731-105623-733_L1C_042-264-0_D_V1-0/SPOT1-HRV2-XS_19920731-105623-733_L1C_042-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920731-105623-733_L1C_042-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920731-105623-733_L1C_042-264-0_D_V1-0.zip
run script
2024-01-10T10:57:05.286    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:57:05.286    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920731-105623-733_L1C_042-264-0_D_V1-0.zip
2024-01-10T10:57:05.286    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:57:05.286    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:57:05.286    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:57:05.286    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:57:05.286    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:57:05.286    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:57:05.287    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:57:05.287    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920731-105623-733_L1C_042-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/19/SPOT1-HRV1-XS_19920419-103725-042_L1C_041-264-0_D_V1-0/SPOT1-HRV1-XS_19920419-103725-042_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920419-103725-042_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920419-103725-042_L1C_041-264-0_D_V1-0.zip
run script
2024-01-10T10:58:49.532    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T10:58:49.533    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920419-103725-042_L1C_041-264-0_D_V1-0.zip
2024-01-10T10:58:49.533    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T10:58:49.533    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T10:58:49.533    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T10:58:49.533    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T10:58:49.533    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T10:58:49.533    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T10:58:49.533    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T10:58:49.533    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920419-103725-042_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/19/SPOT1-HRV2-XS_19920419-103712-953_L1C_045-263-0_D_V1-0/SPOT1-HRV2-XS_19920419-103712-953_L1C_045-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920419-103712-953_L1C_045-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920419-103712-953_L1C_045-263-0_D_V1-0.zip
run script
2024-01-10T11:01:06.227    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:01:06.229    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920419-103712-953_L1C_045-263-0_D_V1-0.zip
2024-01-10T11:01:06.229    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:01:06.229    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:01:06.229    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:01:06.229    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:01:06.229    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:01:06.229    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:01:06.229    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:01:06.229    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920419-103712-953_L1C_045-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/19/SPOT1-HRV2-XS_19920419-103721-246_L1C_045-264-0_D_V1-0/SPOT1-HRV2-XS_19920419-103721-246_L1C_045-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920419-103721-246_L1C_045-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920419-103721-246_L1C_045-264-0_D_V1-0.zip
run script
2024-01-10T11:02:22.833    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:02:22.834    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920419-103721-246_L1C_045-264-0_D_V1-0.zip
2024-01-10T11:02:22.834    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:02:22.834    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:02:22.834    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:02:22.834    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:02:22.834    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:02:22.834    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:02:22.834    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:02:22.834    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920419-103721-246_L1C_045-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/19/SPOT1-HRV2-XS_19920419-103729-545_L1C_045-265-0_D_V1-0/SPOT1-HRV2-XS_19920419-103729-545_L1C_045-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920419-103729-545_L1C_045-265-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920419-103729-545_L1C_045-265-0_D_V1-0.zip
run script
2024-01-10T11:04:07.992    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:04:07.993    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920419-103729-545_L1C_045-265-0_D_V1-0.zip
2024-01-10T11:04:07.993    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:04:07.993    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:04:07.993    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:04:07.993    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:04:07.993    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:04:07.993    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:04:07.993    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:04:07.993    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920419-103729-545_L1C_045-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/05/09/SPOT1-HRV2-XS_19920509-105246-621_L1C_041-264-0_D_V1-0/SPOT1-HRV2-XS_19920509-105246-621_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920509-105246-621_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920509-105246-621_L1C_041-264-0_D_V1-0.zip
run script
2024-01-10T11:04:37.563    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:04:37.564    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920509-105246-621_L1C_041-264-0_D_V1-0.zip
2024-01-10T11:04:37.564    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:04:37.564    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:04:37.564    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:04:37.564    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:04:37.564    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:04:37.564    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:04:37.564    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:04:37.564    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920509-105246-621_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/07/26/SPOT1-HRV1-XS_19920726-105223-537_L1C_042-262-8_D_V1-0/SPOT1-HRV1-XS_19920726-105223-537_L1C_042-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920726-105223-537_L1C_042-262-8_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920726-105223-537_L1C_042-262-8_D_V1-0.zip
run script
2024-01-10T11:06:40.971    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:06:40.972    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920726-105223-537_L1C_042-262-8_D_V1-0.zip
2024-01-10T11:06:40.981    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:06:40.981    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:06:40.982    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:06:40.982    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:06:40.982    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:06:40.982    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:06:40.982    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:06:40.982    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920726-105223-537_L1C_042-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 2 2]
 [2 2 2 ... 0 0 2]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/10/18/SPOT1-HRV1-XS_19921018-103636-350_L1C_043-263-0_D_V1-0/SPOT1-HRV1-XS_19921018-103636-350_L1C_043-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19921018-103636-350_L1C_043-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19921018-103636-350_L1C_043-263-0_D_V1-0.zip
run script
2024-01-10T11:08:00.985    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:08:00.987    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19921018-103636-350_L1C_043-263-0_D_V1-0.zip
2024-01-10T11:08:00.987    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:08:00.987    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:08:00.987    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:08:00.987    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:08:00.987    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:08:00.987    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:08:00.987    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:08:00.987    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19921018-103636-350_L1C_043-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/10/18/SPOT1-HRV1-XS_19921018-103644-631_L1C_043-264-0_D_V1-0/SPOT1-HRV1-XS_19921018-103644-631_L1C_043-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19921018-103644-631_L1C_043-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19921018-103644-631_L1C_043-264-0_D_V1-0.zip
run script
2024-01-10T11:09:41.999    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:09:42.000    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19921018-103644-631_L1C_043-264-0_D_V1-0.zip
2024-01-10T11:09:42.000    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:09:42.000    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:09:42.000    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:09:42.001    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:09:42.001    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:09:42.001    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:09:42.001    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:09:42.001    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19921018-103644-631_L1C_043-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/16/SPOT1-HRV2-XS_19920816-104822-671_L1C_044-263-0_D_V1-0/SPOT1-HRV2-XS_19920816-104822-671_L1C_044-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920816-104822-671_L1C_044-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920816-104822-671_L1C_044-263-0_D_V1-0.zip
run script
2024-01-10T11:11:56.102    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:11:56.103    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920816-104822-671_L1C_044-263-0_D_V1-0.zip
2024-01-10T11:11:56.103    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:11:56.104    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:11:56.104    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:11:56.104    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:11:56.104    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:11:56.104    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:11:56.104    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:11:56.104    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920816-104822-671_L1C_044-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/16/SPOT1-HRV2-XS_19920816-104831-006_L1C_044-264-0_D_V1-0/SPOT1-HRV2-XS_19920816-104831-006_L1C_044-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920816-104831-006_L1C_044-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920816-104831-006_L1C_044-264-0_D_V1-0.zip
run script
2024-01-10T11:13:25.253    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:13:25.254    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920816-104831-006_L1C_044-264-0_D_V1-0.zip
2024-01-10T11:13:25.254    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:13:25.254    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:13:25.254    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:13:25.254    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:13:25.254    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:13:25.254    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:13:25.254    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:13:25.254    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T11:13:27.488    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (213 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920816-104831-006_L1C_044-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1992/08/16/SPOT1-HRV2-XS_19920816-104839-350_L1C_044-265-0_D_V1-0/SPOT1-HRV2-XS_19920816-104839-350_L1C_044-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920816-104839-350_L1C_044-265-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920816-104839-350_L1C_044-265-0_D_V1-0.zip
run script
2024-01-10T11:13:30.551    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:13:30.552    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920816-104839-350_L1C_044-265-0_D_V1-0.zip
2024-01-10T11:13:30.552    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:13:30.552    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:13:30.552    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:13:30.552    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:13:30.553    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:13:30.553    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:13:30.553    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:13:30.553    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920816-104839-350_L1C_044-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/26/SPOT1-HRV2-XS_19920826-105605-644_L1C_044-263-0_D_V1-0/SPOT1-HRV2-XS_19920826-105605-644_L1C_044-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920826-105605-644_L1C_044-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920826-105605-644_L1C_044-263-0_D_V1-0.zip
run script
2024-01-10T11:14:01.955    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:14:01.956    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920826-105605-644_L1C_044-263-0_D_V1-0.zip
2024-01-10T11:14:01.956    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:14:01.956    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:14:01.956    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:14:01.956    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:14:01.956    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:14:01.956    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:14:01.956    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:14:01.956    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920826-105605-644_L1C_044-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/26/SPOT1-HRV2-XS_19920826-105614-025_L1C_044-264-0_D_V1-0/SPOT1-HRV2-XS_19920826-105614-025_L1C_044-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920826-105614-025_L1C_044-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920826-105614-025_L1C_044-264-0_D_V1-0.zip
run script
2024-01-10T11:15:25.126    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:15:25.127    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920826-105614-025_L1C_044-264-0_D_V1-0.zip
2024-01-10T11:15:25.127    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:15:25.127    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:15:25.128    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:15:25.128    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:15:25.128    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:15:25.128    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:15:25.128    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:15:25.128    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920826-105614-025_L1C_044-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/26/SPOT1-HRV2-XS_19920826-105622-408_L1C_044-265-0_D_V1-0/SPOT1-HRV2-XS_19920826-105622-408_L1C_044-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920826-105622-408_L1C_044-265-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920826-105622-408_L1C_044-265-0_D_V1-0.zip
run script
2024-01-10T11:17:23.019    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:17:23.019    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920826-105622-408_L1C_044-265-0_D_V1-0.zip
2024-01-10T11:17:23.019    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:17:23.019    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:17:23.019    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:17:23.019    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:17:23.019    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:17:23.020    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:17:23.020    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:17:23.020    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920826-105622-408_L1C_044-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/09/06/SPOT1-HRV2-XS_19920906-104432-143_L1C_044-263-0_D_V1-0/SPOT1-HRV2-XS_19920906-104432-143_L1C_044-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920906-104432-143_L1C_044-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920906-104432-143_L1C_044-263-0_D_V1-0.zip
run script
2024-01-10T11:17:57.052    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:17:57.056    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920906-104432-143_L1C_044-263-0_D_V1-0.zip
2024-01-10T11:17:57.056    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:17:57.056    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:17:57.056    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:17:57.056    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:17:57.056    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:17:57.056    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:17:57.056    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:17:57.057    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920906-104432-143_L1C_044-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/09/06/SPOT1-HRV2-XS_19920906-104440-463_L1C_044-264-0_D_V1-0/SPOT1-HRV2-XS_19920906-104440-463_L1C_044-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920906-104440-463_L1C_044-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920906-104440-463_L1C_044-264-0_D_V1-0.zip
run script
2024-01-10T11:19:20.486    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:19:20.488    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920906-104440-463_L1C_044-264-0_D_V1-0.zip
2024-01-10T11:19:20.488    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:19:20.488    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:19:20.488    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:19:20.488    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:19:20.488    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:19:20.488    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:19:20.488    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:19:20.488    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920906-104440-463_L1C_044-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/09/06/SPOT1-HRV2-XS_19920906-104448-790_L1C_044-265-0_D_V1-0/SPOT1-HRV2-XS_19920906-104448-790_L1C_044-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920906-104448-790_L1C_044-265-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920906-104448-790_L1C_044-265-0_D_V1-0.zip
run script
2024-01-10T11:21:10.304    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:21:10.305    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920906-104448-790_L1C_044-265-0_D_V1-0.zip
2024-01-10T11:21:10.306    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:21:10.306    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:21:10.306    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:21:10.306    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:21:10.306    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:21:10.306    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:21:10.306    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:21:10.306    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920906-104448-790_L1C_044-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/09/16/SPOT1-HRV2-XS_19920916-105215-358_L1C_044-263-0_D_V1-0/SPOT1-HRV2-XS_19920916-105215-358_L1C_044-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920916-105215-358_L1C_044-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920916-105215-358_L1C_044-263-0_D_V1-0.zip
run script
2024-01-10T11:21:42.517    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:21:42.518    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920916-105215-358_L1C_044-263-0_D_V1-0.zip
2024-01-10T11:21:42.518    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:21:42.519    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:21:42.519    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:21:42.519    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:21:42.519    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:21:42.519    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:21:42.519    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:21:42.519    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920916-105215-358_L1C_044-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/09/16/SPOT1-HRV2-XS_19920916-105223-717_L1C_044-264-0_D_V1-0/SPOT1-HRV2-XS_19920916-105223-717_L1C_044-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920916-105223-717_L1C_044-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920916-105223-717_L1C_044-264-0_D_V1-0.zip
run script
2024-01-10T11:23:01.140    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:23:01.141    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920916-105223-717_L1C_044-264-0_D_V1-0.zip
2024-01-10T11:23:01.142    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:23:01.142    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:23:01.142    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:23:01.142    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:23:01.142    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:23:01.142    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:23:01.142    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:23:01.142    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920916-105223-717_L1C_044-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/09/16/SPOT1-HRV2-XS_19920916-105232-083_L1C_044-265-0_D_V1-0/SPOT1-HRV2-XS_19920916-105232-083_L1C_044-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920916-105232-083_L1C_044-265-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920916-105232-083_L1C_044-265-0_D_V1-0.zip
run script
2024-01-10T11:24:47.989    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:24:47.991    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920916-105232-083_L1C_044-265-0_D_V1-0.zip
2024-01-10T11:24:47.991    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:24:47.991    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:24:47.991    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:24:47.991    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:24:47.991    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:24:47.991    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:24:47.991    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:24:47.991    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920916-105232-083_L1C_044-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/10/22/SPOT1-HRV2-XS_19921022-105941-913_L1C_044-263-0_D_V1-0/SPOT1-HRV2-XS_19921022-105941-913_L1C_044-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19921022-105941-913_L1C_044-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19921022-105941-913_L1C_044-263-0_D_V1-0.zip
run script
2024-01-10T11:25:19.842    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:25:19.843    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19921022-105941-913_L1C_044-263-0_D_V1-0.zip
2024-01-10T11:25:19.843    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:25:19.843    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:25:19.843    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:25:19.843    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:25:19.843    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:25:19.843    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:25:19.843    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:25:19.843    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T11:25:21.776    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (164 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19921022-105941-913_L1C_044-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1992/10/22/SPOT1-HRV2-XS_19921022-105950-314_L1C_044-264-0_D_V1-0/SPOT1-HRV2-XS_19921022-105950-314_L1C_044-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19921022-105950-314_L1C_044-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19921022-105950-314_L1C_044-264-0_D_V1-0.zip
run script
2024-01-10T11:25:24.726    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:25:24.727    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19921022-105950-314_L1C_044-264-0_D_V1-0.zip
2024-01-10T11:25:24.727    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:25:24.727    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:25:24.727    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:25:24.727    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:25:24.727    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:25:24.727    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:25:24.727    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:25:24.727    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19921022-105950-314_L1C_044-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/10/22/SPOT1-HRV2-XS_19921022-105958-719_L1C_044-265-0_D_V1-0/SPOT1-HRV2-XS_19921022-105958-719_L1C_044-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19921022-105958-719_L1C_044-265-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19921022-105958-719_L1C_044-265-0_D_V1-0.zip
run script
2024-01-10T11:27:29.430    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:27:29.431    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19921022-105958-719_L1C_044-265-0_D_V1-0.zip
2024-01-10T11:27:29.431    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:27:29.431    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:27:29.431    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:27:29.431    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:27:29.431    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:27:29.431    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:27:29.431    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:27:29.431    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19921022-105958-719_L1C_044-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/10/27/SPOT1-HRV2-XS_19921027-110328-766_L1C_044-263-0_D_V1-0/SPOT1-HRV2-XS_19921027-110328-766_L1C_044-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19921027-110328-766_L1C_044-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19921027-110328-766_L1C_044-263-0_D_V1-0.zip
run script
2024-01-10T11:28:05.176    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:28:05.177    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19921027-110328-766_L1C_044-263-0_D_V1-0.zip
2024-01-10T11:28:05.177    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:28:05.177    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:28:05.177    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:28:05.178    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:28:05.178    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:28:05.178    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:28:05.178    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:28:05.178    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19921027-110328-766_L1C_044-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/10/27/SPOT1-HRV2-XS_19921027-110337-194_L1C_044-264-0_D_V1-0/SPOT1-HRV2-XS_19921027-110337-194_L1C_044-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19921027-110337-194_L1C_044-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19921027-110337-194_L1C_044-264-0_D_V1-0.zip
run script
2024-01-10T11:29:36.661    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:29:36.662    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19921027-110337-194_L1C_044-264-0_D_V1-0.zip
2024-01-10T11:29:36.662    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:29:36.662    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:29:36.662    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:29:36.663    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:29:36.663    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:29:36.663    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:29:36.663    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:29:36.663    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19921027-110337-194_L1C_044-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/10/27/SPOT1-HRV2-XS_19921027-110345-626_L1C_044-265-0_D_V1-0/SPOT1-HRV2-XS_19921027-110345-626_L1C_044-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19921027-110345-626_L1C_044-265-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19921027-110345-626_L1C_044-265-0_D_V1-0.zip
run script
2024-01-10T11:31:51.166    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:31:51.168    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19921027-110345-626_L1C_044-265-0_D_V1-0.zip
2024-01-10T11:31:51.168    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:31:51.168    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:31:51.168    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:31:51.168    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:31:51.168    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:31:51.168    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:31:51.168    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:31:51.168    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19921027-110345-626_L1C_044-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/09/11/SPOT1-HRV2-XS_19920911-104832-385_L1C_044-264-0_D_V1-0/SPOT1-HRV2-XS_19920911-104832-385_L1C_044-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920911-104832-385_L1C_044-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920911-104832-385_L1C_044-264-0_D_V1-0.zip
run script
2024-01-10T11:32:28.322    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:32:28.323    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920911-104832-385_L1C_044-264-0_D_V1-0.zip
2024-01-10T11:32:28.323    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:32:28.323    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:32:28.324    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:32:28.324    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:32:28.324    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:32:28.324    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:32:28.324    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:32:28.324    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920911-104832-385_L1C_044-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/09/11/SPOT1-HRV2-XS_19920911-104840-729_L1C_044-265-0_D_V1-0/SPOT1-HRV2-XS_19920911-104840-729_L1C_044-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920911-104840-729_L1C_044-265-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920911-104840-729_L1C_044-265-0_D_V1-0.zip
run script
2024-01-10T11:34:13.620    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:34:13.621    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920911-104840-729_L1C_044-265-0_D_V1-0.zip
2024-01-10T11:34:13.621    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:34:13.621    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:34:13.621    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:34:13.622    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:34:13.622    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:34:13.622    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:34:13.622    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:34:13.622    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920911-104840-729_L1C_044-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 0 ... 0 0 0]
 [0 2 2 ... 0 0 0]
 [0 0 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/24/SPOT1-HRV1-XS_19920424-104105-307_L1C_045-263-0_D_V1-0/SPOT1-HRV1-XS_19920424-104105-307_L1C_045-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920424-104105-307_L1C_045-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920424-104105-307_L1C_045-263-0_D_V1-0.zip
run script
2024-01-10T11:34:45.850    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:34:45.851    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920424-104105-307_L1C_045-263-0_D_V1-0.zip
2024-01-10T11:34:45.851    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:34:45.851    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:34:45.851    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:34:45.851    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:34:45.851    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:34:45.851    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:34:45.851    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:34:45.851    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920424-104105-307_L1C_045-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/24/SPOT1-HRV1-XS_19920424-104113-615_L1C_045-264-0_D_V1-0/SPOT1-HRV1-XS_19920424-104113-615_L1C_045-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920424-104113-615_L1C_045-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920424-104113-615_L1C_045-264-0_D_V1-0.zip
run script
2024-01-10T11:36:05.733    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:36:05.734    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920424-104113-615_L1C_045-264-0_D_V1-0.zip
2024-01-10T11:36:05.734    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:36:05.734    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:36:05.734    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:36:05.734    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:36:05.734    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:36:05.734    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:36:05.734    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:36:05.734    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920424-104113-615_L1C_045-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/24/SPOT1-HRV1-XS_19920424-104121-929_L1C_045-265-0_D_V1-0/SPOT1-HRV1-XS_19920424-104121-929_L1C_045-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920424-104121-929_L1C_045-265-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920424-104121-929_L1C_045-265-0_D_V1-0.zip
run script
2024-01-10T11:37:45.513    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:37:45.514    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920424-104121-929_L1C_045-265-0_D_V1-0.zip
2024-01-10T11:37:45.514    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:37:45.514    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:37:45.514    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:37:45.514    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:37:45.514    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:37:45.515    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:37:45.515    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:37:45.515    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T11:37:47.025    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (100 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920424-104121-929_L1C_045-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1992/06/09/SPOT1-HRV2-XS_19920609-105623-604_L1C_046-263-0_D_V1-0/SPOT1-HRV2-XS_19920609-105623-604_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920609-105623-604_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920609-105623-604_L1C_046-263-0_D_V1-0.zip
run script
2024-01-10T11:37:49.666    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:37:49.669    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920609-105623-604_L1C_046-263-0_D_V1-0.zip
2024-01-10T11:37:49.669    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:37:49.669    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:37:49.669    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:37:49.669    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:37:49.669    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:37:49.669    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:37:49.669    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:37:49.669    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920609-105623-604_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/06/09/SPOT1-HRV2-XS_19920609-105626-311_L1C_046-263-3_D_V1-0/SPOT1-HRV2-XS_19920609-105626-311_L1C_046-263-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19920609-105626-311_L1C_046-263-3_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920609-105626-311_L1C_046-263-3_D_V1-0.zip
run script
2024-01-10T11:38:25.400    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:38:25.401    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920609-105626-311_L1C_046-263-3_D_V1-0.zip
2024-01-10T11:38:25.401    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:38:25.401    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:38:25.401    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:38:25.401    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:38:25.402    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:38:25.402    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:38:25.402    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:38:25.402    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV2-XS_19920609-105626-311_L1C_046-263-3_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/11/SPOT1-HRV1-XS_19920811-104431-674_L1C_046-263-0_D_V1-0/SPOT1-HRV1-XS_19920811-104431-674_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920811-104431-674_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920811-104431-674_L1C_046-263-0_D_V1-0.zip
run script
2024-01-10T11:39:18.135    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:39:18.137    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920811-104431-674_L1C_046-263-0_D_V1-0.zip
2024-01-10T11:39:18.137    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:39:18.137    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:39:18.137    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:39:18.137    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:39:18.137    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:39:18.137    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:39:18.137    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:39:18.137    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920811-104431-674_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/11/SPOT1-HRV1-XS_19920811-104440-004_L1C_046-264-0_D_V1-0/SPOT1-HRV1-XS_19920811-104440-004_L1C_046-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920811-104440-004_L1C_046-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920811-104440-004_L1C_046-264-0_D_V1-0.zip
run script
2024-01-10T11:39:53.019    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:39:53.020    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920811-104440-004_L1C_046-264-0_D_V1-0.zip
2024-01-10T11:39:53.020    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:39:53.020    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:39:53.020    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:39:53.020    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:39:53.020    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:39:53.020    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:39:53.020    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:39:53.020    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920811-104440-004_L1C_046-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/11/SPOT1-HRV1-XS_19920811-104448-342_L1C_046-265-0_D_V1-0/SPOT1-HRV1-XS_19920811-104448-342_L1C_046-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920811-104448-342_L1C_046-265-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920811-104448-342_L1C_046-265-0_D_V1-0.zip
run script
2024-01-10T11:40:55.546    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:40:55.547    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920811-104448-342_L1C_046-265-0_D_V1-0.zip
2024-01-10T11:40:55.547    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:40:55.547    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:40:55.547    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:40:55.547    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:40:55.547    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:40:55.547    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:40:55.548    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:40:55.548    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920811-104448-342_L1C_046-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/14/SPOT1-HRV1-XS_19920414-103332-972_L1C_047-265-0_D_V1-0/SPOT1-HRV1-XS_19920414-103332-972_L1C_047-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920414-103332-972_L1C_047-265-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920414-103332-972_L1C_047-265-0_D_V1-0.zip
run script
2024-01-10T11:41:18.413    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:41:18.414    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920414-103332-972_L1C_047-265-0_D_V1-0.zip
2024-01-10T11:41:18.414    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:41:18.414    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:41:18.414    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:41:18.414    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:41:18.414    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:41:18.414    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:41:18.414    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:41:18.414    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920414-103332-972_L1C_047-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/30/SPOT1-HRV1-XS_19920430-102549-434_L1C_047-265-0_D_V1-0/SPOT1-HRV1-XS_19920430-102549-434_L1C_047-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19920430-102549-434_L1C_047-265-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920430-102549-434_L1C_047-265-0_D_V1-0.zip
run script
2024-01-10T11:41:28.137    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:41:28.139    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920430-102549-434_L1C_047-265-0_D_V1-0.zip
2024-01-10T11:41:28.139    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:41:28.139    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:41:28.139    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:41:28.139    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:41:28.139    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:41:28.139    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:41:28.139    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:41:28.139    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT1-HRV1-XS_19920430-102549-434_L1C_047-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/05/08/SPOT2-HRV1-XS_19990508-105958-293_L1C_037-262-1_D_V1-0/SPOT2-HRV1-XS_19990508-105958-293_L1C_037-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990508-105958-293_L1C_037-262-1_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990508-105958-293_L1C_037-262-1_D_V1-0.zip
run script
2024-01-10T11:41:39.417    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:41:39.418    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990508-105958-293_L1C_037-262-1_D_V1-0.zip
2024-01-10T11:41:39.418    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:41:39.418    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:41:39.418    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:41:39.418    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:41:39.418    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:41:39.418    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:41:39.418    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:41:39.418    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990508-105958-293_L1C_037-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/05/24/SPOT2-HRV2-XS_19990524-105220-977_L1C_037-262-7_D_V1-0/SPOT2-HRV2-XS_19990524-105220-977_L1C_037-262-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990524-105220-977_L1C_037-262-7_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990524-105220-977_L1C_037-262-7_D_V1-0.zip
run script
2024-01-10T11:41:46.183    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:41:46.184    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990524-105220-977_L1C_037-262-7_D_V1-0.zip
2024-01-10T11:41:46.184    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:41:46.185    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:41:46.185    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:41:46.185    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:41:46.185    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:41:46.185    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:41:46.185    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:41:46.185    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990524-105220-977_L1C_037-262-7_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/05/24/SPOT2-HRV1-XS_19990524-105221-257_L1C_039-263-0_D_V1-0/SPOT2-HRV1-XS_19990524-105221-257_L1C_039-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990524-105221-257_L1C_039-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990524-105221-257_L1C_039-263-0_D_V1-0.zip
run script
2024-01-10T11:42:47.453    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:42:47.455    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990524-105221-257_L1C_039-263-0_D_V1-0.zip
2024-01-10T11:42:47.455    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:42:47.455    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:42:47.455    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:42:47.455    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:42:47.455    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:42:47.455    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:42:47.455    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:42:47.455    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990524-105221-257_L1C_039-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/05/28/SPOT2-HRV1-XS_19990528-111532-183_L1C_037-262-7_D_V1-0/SPOT2-HRV1-XS_19990528-111532-183_L1C_037-262-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990528-111532-183_L1C_037-262-7_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990528-111532-183_L1C_037-262-7_D_V1-0.zip
run script
2024-01-10T11:44:08.538    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:44:08.539    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990528-111532-183_L1C_037-262-7_D_V1-0.zip
2024-01-10T11:44:08.539    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:44:08.539    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:44:08.539    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:44:08.539    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:44:08.539    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:44:08.539    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:44:08.539    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:44:08.540    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990528-111532-183_L1C_037-262-7_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/05/28/SPOT2-HRV2-XS_19990528-111530-736_L1C_039-263-0_D_V1-0/SPOT2-HRV2-XS_19990528-111530-736_L1C_039-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990528-111530-736_L1C_039-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990528-111530-736_L1C_039-263-0_D_V1-0.zip
run script
2024-01-10T11:45:05.898    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:45:05.899    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990528-111530-736_L1C_039-263-0_D_V1-0.zip
2024-01-10T11:45:05.899    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:45:05.899    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:45:05.899    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:45:05.899    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:45:05.899    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:45:05.899    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:45:05.899    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:45:05.899    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T11:45:07.698    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (156 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990528-111530-736_L1C_039-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1999/10/31/SPOT2-HRV2-XS_19991031-111454-349_L1C_037-262-7_D_V1-0/SPOT2-HRV2-XS_19991031-111454-349_L1C_037-262-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19991031-111454-349_L1C_037-262-7_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991031-111454-349_L1C_037-262-7_D_V1-0.zip
run script
2024-01-10T11:45:10.499    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:45:10.500    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991031-111454-349_L1C_037-262-7_D_V1-0.zip
2024-01-10T11:45:10.500    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:45:10.500    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:45:10.500    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:45:10.500    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:45:10.500    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:45:10.500    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:45:10.500    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:45:10.500    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991031-111454-349_L1C_037-262-7_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/12/07/SPOT2-HRV1-XS_19991207-110255-908_L1C_037-262-2_D_V1-0/SPOT2-HRV1-XS_19991207-110255-908_L1C_037-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991207-110255-908_L1C_037-262-2_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991207-110255-908_L1C_037-262-2_D_V1-0.zip
run script
2024-01-10T11:46:08.687    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:46:08.688    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991207-110255-908_L1C_037-262-2_D_V1-0.zip
2024-01-10T11:46:08.688    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:46:08.688    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:46:08.688    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:46:08.688    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:46:08.688    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:46:08.688    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:46:08.688    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:46:08.689    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T11:46:20.716    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (24 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991207-110255-908_L1C_037-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1999/12/07/SPOT2-HRV1-XS_19991207-110302-424_L1C_037-263-0_D_V1-0/SPOT2-HRV1-XS_19991207-110302-424_L1C_037-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991207-110302-424_L1C_037-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991207-110302-424_L1C_037-263-0_D_V1-0.zip
run script
2024-01-10T11:46:23.532    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:46:23.532    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991207-110302-424_L1C_037-263-0_D_V1-0.zip
2024-01-10T11:46:23.532    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:46:23.533    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:46:23.533    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:46:23.533    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:46:23.533    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:46:23.533    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:46:23.533    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:46:23.533    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991207-110302-424_L1C_037-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/12/07/SPOT2-HRV2-XS_19991207-110300-920_L1C_038-263-0_D_V1-0/SPOT2-HRV2-XS_19991207-110300-920_L1C_038-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19991207-110300-920_L1C_038-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991207-110300-920_L1C_038-263-0_D_V1-0.zip
run script
2024-01-10T11:47:37.899    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:47:37.901    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991207-110300-920_L1C_038-263-0_D_V1-0.zip
2024-01-10T11:47:37.901    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:47:37.901    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:47:37.901    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:47:37.901    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:47:37.901    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:47:37.901    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:47:37.901    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:47:37.901    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991207-110300-920_L1C_038-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 2 2]
 [0 0 0 ... 0 2 2]
 [0 0 0 ... 0 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/12/07/SPOT2-HRV2-XS_19991207-110309-258_L1C_038-264-0_D_V1-0/SPOT2-HRV2-XS_19991207-110309-258_L1C_038-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19991207-110309-258_L1C_038-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991207-110309-258_L1C_038-264-0_D_V1-0.zip
run script
2024-01-10T11:48:56.028    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:48:56.029    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991207-110309-258_L1C_038-264-0_D_V1-0.zip
2024-01-10T11:48:56.029    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:48:56.029    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:48:56.029    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:48:56.029    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:48:56.029    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:48:56.030    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:48:56.030    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:48:56.030    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991207-110309-258_L1C_038-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/01/23/SPOT2-HRV1-XS_19990123-111916-637_L1C_037-263-0_D_V1-0/SPOT2-HRV1-XS_19990123-111916-637_L1C_037-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990123-111916-637_L1C_037-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990123-111916-637_L1C_037-263-0_D_V1-0.zip
run script
2024-01-10T11:50:53.196    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:50:53.197    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990123-111916-637_L1C_037-263-0_D_V1-0.zip
2024-01-10T11:50:53.197    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:50:53.197    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:50:53.197    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:50:53.197    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:50:53.197    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:50:53.198    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:50:53.198    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:50:53.198    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990123-111916-637_L1C_037-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/01/24/SPOT2-HRV2-XS_19990124-105957-786_L1C_037-263-0_D_V1-0/SPOT2-HRV2-XS_19990124-105957-786_L1C_037-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990124-105957-786_L1C_037-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990124-105957-786_L1C_037-263-0_D_V1-0.zip
run script
2024-01-10T11:52:14.191    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:52:14.192    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990124-105957-786_L1C_037-263-0_D_V1-0.zip
2024-01-10T11:52:14.192    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:52:14.192    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:52:14.192    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:52:14.192    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:52:14.193    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:52:14.193    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:52:14.193    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:52:14.193    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990124-105957-786_L1C_037-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/03/01/SPOT2-HRV2-XS_19990301-110757-001_L1C_037-263-5_D_V1-0/SPOT2-HRV2-XS_19990301-110757-001_L1C_037-263-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990301-110757-001_L1C_037-263-5_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990301-110757-001_L1C_037-263-5_D_V1-0.zip
run script
2024-01-10T11:53:30.911    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:53:30.912    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990301-110757-001_L1C_037-263-5_D_V1-0.zip
2024-01-10T11:53:30.912    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:53:30.913    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:53:30.913    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:53:30.913    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:53:30.913    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:53:30.913    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:53:30.913    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:53:30.913    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990301-110757-001_L1C_037-263-5_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/25/SPOT2-HRV2-XS_19990725-110005-529_L1C_037-263-0_D_V1-0/SPOT2-HRV2-XS_19990725-110005-529_L1C_037-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990725-110005-529_L1C_037-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990725-110005-529_L1C_037-263-0_D_V1-0.zip
run script
2024-01-10T11:55:13.070    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:55:13.072    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990725-110005-529_L1C_037-263-0_D_V1-0.zip
2024-01-10T11:55:13.072    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:55:13.072    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:55:13.072    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:55:13.072    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:55:13.072    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:55:13.072    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:55:13.072    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:55:13.072    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990725-110005-529_L1C_037-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/25/SPOT2-HRV1-XS_19990725-105956-965_L1C_040-262-4_D_V1-0/SPOT2-HRV1-XS_19990725-105956-965_L1C_040-262-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990725-105956-965_L1C_040-262-4_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990725-105956-965_L1C_040-262-4_D_V1-0.zip
run script
2024-01-10T11:56:29.321    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:56:29.322    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990725-105956-965_L1C_040-262-4_D_V1-0.zip
2024-01-10T11:56:29.322    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:56:29.322    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:56:29.322    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:56:29.322    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:56:29.322    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:56:29.322    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:56:29.322    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:56:29.322    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990725-105956-965_L1C_040-262-4_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/25/SPOT2-HRV1-XS_19990725-110001-685_L1C_040-263-0_D_V1-0/SPOT2-HRV1-XS_19990725-110001-685_L1C_040-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990725-110001-685_L1C_040-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990725-110001-685_L1C_040-263-0_D_V1-0.zip
run script
2024-01-10T11:57:04.616    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:57:04.618    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990725-110001-685_L1C_040-263-0_D_V1-0.zip
2024-01-10T11:57:04.618    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:57:04.618    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:57:04.618    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:57:04.618    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:57:04.618    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:57:04.618    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:57:04.618    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:57:04.618    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990725-110001-685_L1C_040-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/25/SPOT2-HRV1-XS_19990725-110010-023_L1C_040-264-0_D_V1-0/SPOT2-HRV1-XS_19990725-110010-023_L1C_040-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990725-110010-023_L1C_040-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990725-110010-023_L1C_040-264-0_D_V1-0.zip
run script
2024-01-10T11:58:32.302    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T11:58:32.302    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990725-110010-023_L1C_040-264-0_D_V1-0.zip
2024-01-10T11:58:32.303    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T11:58:32.303    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T11:58:32.303    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T11:58:32.303    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T11:58:32.303    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T11:58:32.303    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T11:58:32.303    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T11:58:32.303    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990725-110010-023_L1C_040-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/08/31/SPOT2-HRV1-XS_19990831-104817-711_L1C_037-263-0_D_V1-0/SPOT2-HRV1-XS_19990831-104817-711_L1C_037-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990831-104817-711_L1C_037-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990831-104817-711_L1C_037-263-0_D_V1-0.zip
run script
2024-01-10T12:00:27.285    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:00:27.286    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990831-104817-711_L1C_037-263-0_D_V1-0.zip
2024-01-10T12:00:27.286    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:00:27.286    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:00:27.286    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:00:27.286    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:00:27.286    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:00:27.286    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:00:27.286    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:00:27.286    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990831-104817-711_L1C_037-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/28/SPOT2-HRV1-XS_19990628-111917-403_L1C_038-262-6_D_V1-0/SPOT2-HRV1-XS_19990628-111917-403_L1C_038-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990628-111917-403_L1C_038-262-6_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990628-111917-403_L1C_038-262-6_D_V1-0.zip
run script
2024-01-10T12:01:51.711    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:01:51.712    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990628-111917-403_L1C_038-262-6_D_V1-0.zip
2024-01-10T12:01:51.712    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:01:51.712    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:01:51.712    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:01:51.712    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:01:51.712    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:01:51.712    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:01:51.712    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:01:51.712    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990628-111917-403_L1C_038-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 2 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/28/SPOT2-HRV1-XS_19990628-111920-417_L1C_038-263-0_D_V1-0/SPOT2-HRV1-XS_19990628-111920-417_L1C_038-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990628-111920-417_L1C_038-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990628-111920-417_L1C_038-263-0_D_V1-0.zip
run script
2024-01-10T12:02:48.897    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:02:48.898    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990628-111920-417_L1C_038-263-0_D_V1-0.zip
2024-01-10T12:02:48.898    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:02:48.898    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:02:48.898    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:02:48.898    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:02:48.898    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:02:48.898    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:02:48.898    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:02:48.898    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990628-111920-417_L1C_038-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 0 0]
 [2 2 2 ... 2 0 0]
 [2 2 2 ... 2 2 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/28/SPOT2-HRV1-XS_19990628-111928-848_L1C_038-264-0_D_V1-0/SPOT2-HRV1-XS_19990628-111928-848_L1C_038-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990628-111928-848_L1C_038-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990628-111928-848_L1C_038-264-0_D_V1-0.zip
run script
2024-01-10T12:04:16.726    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:04:16.727    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990628-111928-848_L1C_038-264-0_D_V1-0.zip
2024-01-10T12:04:16.728    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:04:16.728    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:04:16.728    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:04:16.728    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:04:16.728    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:04:16.728    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:04:16.728    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:04:16.728    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990628-111928-848_L1C_038-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/28/SPOT2-HRV2-XS_19990628-111917-526_L1C_040-262-9_D_V1-0/SPOT2-HRV2-XS_19990628-111917-526_L1C_040-262-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990628-111917-526_L1C_040-262-9_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990628-111917-526_L1C_040-262-9_D_V1-0.zip
run script
2024-01-10T12:06:24.869    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:06:24.870    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990628-111917-526_L1C_040-262-9_D_V1-0.zip
2024-01-10T12:06:24.870    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:06:24.870    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:06:24.870    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:06:24.870    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:06:24.870    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:06:24.871    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:06:24.871    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:06:24.871    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990628-111917-526_L1C_040-262-9_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 0]
 [2 2 2 ... 2 2 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/28/SPOT2-HRV2-XS_19990628-111926-315_L1C_040-264-0_D_V1-0/SPOT2-HRV2-XS_19990628-111926-315_L1C_040-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990628-111926-315_L1C_040-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990628-111926-315_L1C_040-264-0_D_V1-0.zip
run script
2024-01-10T12:08:11.214    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:08:11.215    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990628-111926-315_L1C_040-264-0_D_V1-0.zip
2024-01-10T12:08:11.216    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:08:11.216    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:08:11.216    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:08:11.216    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:08:11.216    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:08:11.216    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:08:11.216    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:08:11.216    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990628-111926-315_L1C_040-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/29/SPOT2-HRV1-XS_19990629-105959-113_L1C_038-262-5_D_V1-0/SPOT2-HRV1-XS_19990629-105959-113_L1C_038-262-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990629-105959-113_L1C_038-262-5_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990629-105959-113_L1C_038-262-5_D_V1-0.zip
run script
2024-01-10T12:10:47.271    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:10:47.272    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990629-105959-113_L1C_038-262-5_D_V1-0.zip
2024-01-10T12:10:47.273    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:10:47.273    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:10:47.273    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:10:47.273    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:10:47.273    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:10:47.273    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:10:47.273    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:10:47.273    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990629-105959-113_L1C_038-262-5_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/29/SPOT2-HRV1-XS_19990629-110002-912_L1C_038-263-0_D_V1-0/SPOT2-HRV1-XS_19990629-110002-912_L1C_038-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990629-110002-912_L1C_038-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990629-110002-912_L1C_038-263-0_D_V1-0.zip
run script
2024-01-10T12:11:28.643    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:11:28.645    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990629-110002-912_L1C_038-263-0_D_V1-0.zip
2024-01-10T12:11:28.645    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:11:28.645    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:11:28.645    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:11:28.645    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:11:28.645    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:11:28.645    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:11:28.645    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:11:28.645    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990629-110002-912_L1C_038-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/29/SPOT2-HRV1-XS_19990629-110011-232_L1C_039-264-0_D_V1-0/SPOT2-HRV1-XS_19990629-110011-232_L1C_039-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990629-110011-232_L1C_039-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990629-110011-232_L1C_039-264-0_D_V1-0.zip
run script
2024-01-10T12:12:46.395    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:12:46.396    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990629-110011-232_L1C_039-264-0_D_V1-0.zip
2024-01-10T12:12:46.396    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:12:46.396    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:12:46.396    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:12:46.396    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:12:46.396    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:12:46.396    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:12:46.396    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:12:46.396    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990629-110011-232_L1C_039-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/29/SPOT2-HRV2-XS_19990629-105959-149_L1C_040-262-7_D_V1-0/SPOT2-HRV2-XS_19990629-105959-149_L1C_040-262-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990629-105959-149_L1C_040-262-7_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990629-105959-149_L1C_040-262-7_D_V1-0.zip
run script
2024-01-10T12:14:39.165    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:14:39.166    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990629-105959-149_L1C_040-262-7_D_V1-0.zip
2024-01-10T12:14:39.167    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:14:39.167    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:14:39.167    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:14:39.167    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:14:39.167    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:14:39.167    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:14:39.167    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:14:39.167    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990629-105959-149_L1C_040-262-7_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/29/SPOT2-HRV2-XS_19990629-110001-155_L1C_040-263-0_D_V1-0/SPOT2-HRV2-XS_19990629-110001-155_L1C_040-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990629-110001-155_L1C_040-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990629-110001-155_L1C_040-263-0_D_V1-0.zip
run script
2024-01-10T12:15:43.279    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:15:43.280    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990629-110001-155_L1C_040-263-0_D_V1-0.zip
2024-01-10T12:15:43.280    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:15:43.280    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:15:43.280    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:15:43.281    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:15:43.281    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:15:43.281    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:15:43.281    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:15:43.281    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990629-110001-155_L1C_040-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/29/SPOT2-HRV2-XS_19990629-110009-488_L1C_040-264-0_D_V1-0/SPOT2-HRV2-XS_19990629-110009-488_L1C_040-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990629-110009-488_L1C_040-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990629-110009-488_L1C_040-264-0_D_V1-0.zip
run script
2024-01-10T12:17:08.881    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:17:08.882    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990629-110009-488_L1C_040-264-0_D_V1-0.zip
2024-01-10T12:17:08.882    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:17:08.882    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:17:08.883    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:17:08.883    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:17:08.883    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:17:08.883    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:17:08.883    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:17:08.884    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T12:18:47.016    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (404 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990629-110009-488_L1C_040-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1999/06/29/SPOT2-HRV2-XS_19990629-110013-097_L1C_040-264-4_D_V1-0/SPOT2-HRV2-XS_19990629-110013-097_L1C_040-264-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990629-110013-097_L1C_040-264-4_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990629-110013-097_L1C_040-264-4_D_V1-0.zip
run script
2024-01-10T12:18:50.002    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:18:50.002    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990629-110013-097_L1C_040-264-4_D_V1-0.zip
2024-01-10T12:18:50.003    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:18:50.003    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:18:50.003    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:18:50.003    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:18:50.003    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:18:50.003    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:18:50.003    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:18:50.003    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990629-110013-097_L1C_040-264-4_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/05/SPOT2-HRV1-XS_19990705-104432-874_L1C_038-262-5_D_V1-0/SPOT2-HRV1-XS_19990705-104432-874_L1C_038-262-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990705-104432-874_L1C_038-262-5_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990705-104432-874_L1C_038-262-5_D_V1-0.zip
run script
2024-01-10T12:20:09.246    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:20:09.247    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990705-104432-874_L1C_038-262-5_D_V1-0.zip
2024-01-10T12:20:09.248    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:20:09.248    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:20:09.248    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:20:09.248    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:20:09.248    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:20:09.248    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:20:09.248    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:20:09.248    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990705-104432-874_L1C_038-262-5_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 0 ... 0 2 2]
 [2 2 0 ... 0 0 2]
 [2 2 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/05/SPOT2-HRV1-XS_19990705-104436-625_L1C_038-263-0_D_V1-0/SPOT2-HRV1-XS_19990705-104436-625_L1C_038-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990705-104436-625_L1C_038-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990705-104436-625_L1C_038-263-0_D_V1-0.zip
run script
2024-01-10T12:20:58.208    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:20:58.210    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990705-104436-625_L1C_038-263-0_D_V1-0.zip
2024-01-10T12:20:58.210    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:20:58.210    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:20:58.210    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:20:58.210    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:20:58.210    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:20:58.210    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:20:58.210    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:20:58.210    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990705-104436-625_L1C_038-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 0 0 2]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/05/SPOT2-HRV1-XS_19990705-104444-894_L1C_038-264-0_D_V1-0/SPOT2-HRV1-XS_19990705-104444-894_L1C_038-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990705-104444-894_L1C_038-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990705-104444-894_L1C_038-264-0_D_V1-0.zip
run script
2024-01-10T12:22:31.856    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:22:31.857    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990705-104444-894_L1C_038-264-0_D_V1-0.zip
2024-01-10T12:22:31.857    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:22:31.858    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:22:31.858    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:22:31.858    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:22:31.858    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:22:31.858    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:22:31.858    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:22:31.858    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990705-104444-894_L1C_038-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/05/SPOT2-HRV2-XS_19990705-104432-934_L1C_040-262-7_D_V1-0/SPOT2-HRV2-XS_19990705-104432-934_L1C_040-262-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990705-104432-934_L1C_040-262-7_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990705-104432-934_L1C_040-262-7_D_V1-0.zip
run script
2024-01-10T12:24:45.013    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:24:45.014    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990705-104432-934_L1C_040-262-7_D_V1-0.zip
2024-01-10T12:24:45.014    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:24:45.015    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:24:45.015    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:24:45.015    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:24:45.015    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:24:45.015    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:24:45.015    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:24:45.015    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990705-104432-934_L1C_040-262-7_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/05/SPOT2-HRV2-XS_19990705-104434-887_L1C_040-263-0_D_V1-0/SPOT2-HRV2-XS_19990705-104434-887_L1C_040-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990705-104434-887_L1C_040-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990705-104434-887_L1C_040-263-0_D_V1-0.zip
run script
2024-01-10T12:25:55.072    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:25:55.073    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990705-104434-887_L1C_040-263-0_D_V1-0.zip
2024-01-10T12:25:55.073    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:25:55.073    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:25:55.073    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:25:55.073    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:25:55.073    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:25:55.073    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:25:55.073    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:25:55.073    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990705-104434-887_L1C_040-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/05/SPOT2-HRV2-XS_19990705-104443-168_L1C_040-264-0_D_V1-0/SPOT2-HRV2-XS_19990705-104443-168_L1C_040-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990705-104443-168_L1C_040-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990705-104443-168_L1C_040-264-0_D_V1-0.zip
run script
2024-01-10T12:27:31.016    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:27:31.018    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990705-104443-168_L1C_040-264-0_D_V1-0.zip
2024-01-10T12:27:31.018    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:27:31.018    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:27:31.018    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:27:31.018    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:27:31.018    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:27:31.018    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:27:31.018    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:27:31.018    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990705-104443-168_L1C_040-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/24/SPOT2-HRV1-XS_19990724-111918-125_L1C_038-262-5_D_V1-0/SPOT2-HRV1-XS_19990724-111918-125_L1C_038-262-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990724-111918-125_L1C_038-262-5_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990724-111918-125_L1C_038-262-5_D_V1-0.zip
run script
2024-01-10T12:29:40.686    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:29:40.687    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990724-111918-125_L1C_038-262-5_D_V1-0.zip
2024-01-10T12:29:40.687    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:29:40.688    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:29:40.688    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:29:40.688    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:29:40.688    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:29:40.688    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:29:40.688    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:29:40.688    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990724-111918-125_L1C_038-262-5_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/24/SPOT2-HRV1-XS_19990724-111922-042_L1C_038-263-0_D_V1-0/SPOT2-HRV1-XS_19990724-111922-042_L1C_038-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990724-111922-042_L1C_038-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990724-111922-042_L1C_038-263-0_D_V1-0.zip
run script
2024-01-10T12:30:28.031    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:30:28.032    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990724-111922-042_L1C_038-263-0_D_V1-0.zip
2024-01-10T12:30:28.032    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:30:28.032    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:30:28.032    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:30:28.033    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:30:28.033    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:30:28.033    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:30:28.033    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:30:28.033    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990724-111922-042_L1C_038-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/24/SPOT2-HRV1-XS_19990724-111930-473_L1C_038-264-0_D_V1-0/SPOT2-HRV1-XS_19990724-111930-473_L1C_038-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990724-111930-473_L1C_038-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990724-111930-473_L1C_038-264-0_D_V1-0.zip
run script
2024-01-10T12:31:54.901    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:31:54.902    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990724-111930-473_L1C_038-264-0_D_V1-0.zip
2024-01-10T12:31:54.902    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:31:54.902    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:31:54.903    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:31:54.903    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:31:54.903    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:31:54.903    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:31:54.903    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:31:54.903    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990724-111930-473_L1C_038-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/24/SPOT2-HRV2-XS_19990724-111918-246_L1C_040-262-8_D_V1-0/SPOT2-HRV2-XS_19990724-111918-246_L1C_040-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990724-111918-246_L1C_040-262-8_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990724-111918-246_L1C_040-262-8_D_V1-0.zip
run script
2024-01-10T12:34:01.593    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:34:01.594    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990724-111918-246_L1C_040-262-8_D_V1-0.zip
2024-01-10T12:34:01.594    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:34:01.594    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:34:01.594    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:34:01.594    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:34:01.594    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:34:01.594    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:34:01.594    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:34:01.594    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990724-111918-246_L1C_040-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/24/SPOT2-HRV2-XS_19990724-111919-482_L1C_040-263-0_D_V1-0/SPOT2-HRV2-XS_19990724-111919-482_L1C_040-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990724-111919-482_L1C_040-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990724-111919-482_L1C_040-263-0_D_V1-0.zip
run script
2024-01-10T12:35:32.601    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:35:32.602    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990724-111919-482_L1C_040-263-0_D_V1-0.zip
2024-01-10T12:35:32.602    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:35:32.602    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:35:32.602    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:35:32.602    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:35:32.602    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:35:32.602    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:35:32.602    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:35:32.602    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990724-111919-482_L1C_040-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/24/SPOT2-HRV2-XS_19990724-111927-941_L1C_040-264-0_D_V1-0/SPOT2-HRV2-XS_19990724-111927-941_L1C_040-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990724-111927-941_L1C_040-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990724-111927-941_L1C_040-264-0_D_V1-0.zip
run script
2024-01-10T12:37:21.471    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:37:21.472    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990724-111927-941_L1C_040-264-0_D_V1-0.zip
2024-01-10T12:37:21.473    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:37:21.473    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:37:21.473    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:37:21.473    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:37:21.473    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:37:21.473    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:37:21.473    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:37:21.473    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990724-111927-941_L1C_040-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/10/SPOT2-HRV1-XS_19991010-111850-749_L1C_038-262-6_D_V1-0/SPOT2-HRV1-XS_19991010-111850-749_L1C_038-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991010-111850-749_L1C_038-262-6_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991010-111850-749_L1C_038-262-6_D_V1-0.zip
run script
2024-01-10T12:39:40.234    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:39:40.235    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991010-111850-749_L1C_038-262-6_D_V1-0.zip
2024-01-10T12:39:40.235    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:39:40.235    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:39:40.235    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:39:40.235    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:39:40.235    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:39:40.235    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:39:40.235    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:39:40.235    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991010-111850-749_L1C_038-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/10/SPOT2-HRV1-XS_19991010-111853-757_L1C_038-263-0_D_V1-0/SPOT2-HRV1-XS_19991010-111853-757_L1C_038-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991010-111853-757_L1C_038-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991010-111853-757_L1C_038-263-0_D_V1-0.zip
run script
2024-01-10T12:40:35.433    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:40:35.434    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991010-111853-757_L1C_038-263-0_D_V1-0.zip
2024-01-10T12:40:35.434    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:40:35.434    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:40:35.435    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:40:35.435    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:40:35.435    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:40:35.435    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:40:35.435    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:40:35.435    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991010-111853-757_L1C_038-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/10/SPOT2-HRV1-XS_19991010-111902-189_L1C_038-264-0_D_V1-0/SPOT2-HRV1-XS_19991010-111902-189_L1C_038-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991010-111902-189_L1C_038-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991010-111902-189_L1C_038-264-0_D_V1-0.zip
run script
2024-01-10T12:42:01.060    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:42:01.061    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991010-111902-189_L1C_038-264-0_D_V1-0.zip
2024-01-10T12:42:01.061    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:42:01.061    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:42:01.061    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:42:01.061    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:42:01.062    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:42:01.062    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:42:01.062    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:42:01.062    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991010-111902-189_L1C_038-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/10/SPOT2-HRV2-XS_19991010-111849-973_L1C_040-262-8_D_V1-0/SPOT2-HRV2-XS_19991010-111849-973_L1C_040-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19991010-111849-973_L1C_040-262-8_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991010-111849-973_L1C_040-262-8_D_V1-0.zip
run script
2024-01-10T12:44:06.245    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:44:06.246    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991010-111849-973_L1C_040-262-8_D_V1-0.zip
2024-01-10T12:44:06.247    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:44:06.247    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:44:06.247    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:44:06.247    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:44:06.247    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:44:06.247    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:44:06.247    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:44:06.247    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991010-111849-973_L1C_040-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/10/SPOT2-HRV2-XS_19991010-111851-206_L1C_040-263-0_D_V1-0/SPOT2-HRV2-XS_19991010-111851-206_L1C_040-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19991010-111851-206_L1C_040-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991010-111851-206_L1C_040-263-0_D_V1-0.zip
run script
2024-01-10T12:45:35.989    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:45:35.990    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991010-111851-206_L1C_040-263-0_D_V1-0.zip
2024-01-10T12:45:35.990    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:45:35.990    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:45:35.990    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:45:35.990    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:45:35.990    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:45:35.991    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:45:35.991    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:45:35.991    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991010-111851-206_L1C_040-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/10/SPOT2-HRV2-XS_19991010-111859-662_L1C_040-264-0_D_V1-0/SPOT2-HRV2-XS_19991010-111859-662_L1C_040-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19991010-111859-662_L1C_040-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991010-111859-662_L1C_040-264-0_D_V1-0.zip
run script
2024-01-10T12:47:22.347    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:47:22.349    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991010-111859-662_L1C_040-264-0_D_V1-0.zip
2024-01-10T12:47:22.349    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:47:22.349    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:47:22.349    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:47:22.349    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:47:22.349    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:47:22.349    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:47:22.349    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:47:22.349    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991010-111859-662_L1C_040-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/19/SPOT2-HRV1-XS_19990719-111539-723_L1C_038-264-0_D_V1-0/SPOT2-HRV1-XS_19990719-111539-723_L1C_038-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990719-111539-723_L1C_038-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990719-111539-723_L1C_038-264-0_D_V1-0.zip
run script
2024-01-10T12:49:47.318    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:49:47.319    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990719-111539-723_L1C_038-264-0_D_V1-0.zip
2024-01-10T12:49:47.319    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:49:47.319    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:49:47.319    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:49:47.319    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:49:47.319    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:49:47.319    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:49:47.320    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:49:47.320    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990719-111539-723_L1C_038-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/19/SPOT2-HRV1-XS_19990719-111531-312_L1C_039-263-0_D_V1-0/SPOT2-HRV1-XS_19990719-111531-312_L1C_039-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990719-111531-312_L1C_039-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990719-111531-312_L1C_039-263-0_D_V1-0.zip
run script
2024-01-10T12:51:49.681    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:51:49.682    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990719-111531-312_L1C_039-263-0_D_V1-0.zip
2024-01-10T12:51:49.682    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:51:49.682    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:51:49.682    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:51:49.682    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:51:49.682    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:51:49.682    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:51:49.682    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:51:49.682    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990719-111531-312_L1C_039-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/23/SPOT2-HRV1-XS_19990623-111523-785_L1C_039-262-7_D_V1-0/SPOT2-HRV1-XS_19990623-111523-785_L1C_039-262-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990623-111523-785_L1C_039-262-7_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990623-111523-785_L1C_039-262-7_D_V1-0.zip
run script
2024-01-10T12:53:09.284    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:53:09.285    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990623-111523-785_L1C_039-262-7_D_V1-0.zip
2024-01-10T12:53:09.285    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:53:09.285    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:53:09.286    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:53:09.286    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:53:09.286    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:53:09.286    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:53:09.286    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:53:09.286    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990623-111523-785_L1C_039-262-7_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/23/SPOT2-HRV1-XS_19990623-111525-869_L1C_039-263-0_D_V1-0/SPOT2-HRV1-XS_19990623-111525-869_L1C_039-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990623-111525-869_L1C_039-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990623-111525-869_L1C_039-263-0_D_V1-0.zip
run script
2024-01-10T12:54:11.510    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:54:11.511    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990623-111525-869_L1C_039-263-0_D_V1-0.zip
2024-01-10T12:54:11.511    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:54:11.511    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:54:11.511    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:54:11.511    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:54:11.511    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:54:11.511    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:54:11.511    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:54:11.511    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990623-111525-869_L1C_039-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/23/SPOT2-HRV1-XS_19990623-111534-277_L1C_039-264-0_D_V1-0/SPOT2-HRV1-XS_19990623-111534-277_L1C_039-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990623-111534-277_L1C_039-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990623-111534-277_L1C_039-264-0_D_V1-0.zip
run script
2024-01-10T12:55:32.912    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:55:32.913    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990623-111534-277_L1C_039-264-0_D_V1-0.zip
2024-01-10T12:55:32.913    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:55:32.913    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:55:32.913    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:55:32.913    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:55:32.913    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:55:32.913    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:55:32.913    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:55:32.913    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990623-111534-277_L1C_039-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/23/SPOT2-HRV2-XS_19990623-111523-616_L1C_040-262-9_D_V1-0/SPOT2-HRV2-XS_19990623-111523-616_L1C_040-262-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990623-111523-616_L1C_040-262-9_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990623-111523-616_L1C_040-262-9_D_V1-0.zip
run script
2024-01-10T12:57:37.045    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:57:37.046    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990623-111523-616_L1C_040-262-9_D_V1-0.zip
2024-01-10T12:57:37.046    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:57:37.046    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:57:37.046    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:57:37.046    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:57:37.046    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:57:37.046    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:57:37.046    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:57:37.046    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990623-111523-616_L1C_040-262-9_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/23/SPOT2-HRV2-XS_19990623-111532-340_L1C_040-264-0_D_V1-0/SPOT2-HRV2-XS_19990623-111532-340_L1C_040-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990623-111532-340_L1C_040-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990623-111532-340_L1C_040-264-0_D_V1-0.zip
run script
2024-01-10T12:59:14.972    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T12:59:14.973    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990623-111532-340_L1C_040-264-0_D_V1-0.zip
2024-01-10T12:59:14.974    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T12:59:14.974    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T12:59:14.974    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T12:59:14.974    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T12:59:14.974    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T12:59:14.974    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T12:59:14.974    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T12:59:14.974    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990623-111532-340_L1C_040-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/09/SPOT2-HRV1-XS_19990709-110745-746_L1C_039-262-6_D_V1-0/SPOT2-HRV1-XS_19990709-110745-746_L1C_039-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990709-110745-746_L1C_039-262-6_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990709-110745-746_L1C_039-262-6_D_V1-0.zip
run script
2024-01-10T13:01:16.027    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:01:16.028    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990709-110745-746_L1C_039-262-6_D_V1-0.zip
2024-01-10T13:01:16.028    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:01:16.028    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:01:16.029    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:01:16.029    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:01:16.029    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:01:16.029    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:01:16.029    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:01:16.029    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990709-110745-746_L1C_039-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/09/SPOT2-HRV1-XS_19990709-110748-685_L1C_039-263-0_D_V1-0/SPOT2-HRV1-XS_19990709-110748-685_L1C_039-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990709-110748-685_L1C_039-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990709-110748-685_L1C_039-263-0_D_V1-0.zip
run script
2024-01-10T13:02:04.459    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:02:04.460    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990709-110748-685_L1C_039-263-0_D_V1-0.zip
2024-01-10T13:02:04.460    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:02:04.460    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:02:04.460    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:02:04.460    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:02:04.460    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:02:04.460    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:02:04.460    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:02:04.460    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990709-110748-685_L1C_039-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/09/SPOT2-HRV1-XS_19990709-110757-044_L1C_039-264-0_D_V1-0/SPOT2-HRV1-XS_19990709-110757-044_L1C_039-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990709-110757-044_L1C_039-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990709-110757-044_L1C_039-264-0_D_V1-0.zip
run script
2024-01-10T13:03:21.106    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:03:21.107    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990709-110757-044_L1C_039-264-0_D_V1-0.zip
2024-01-10T13:03:21.107    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:03:21.107    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:03:21.107    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:03:21.107    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:03:21.107    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:03:21.108    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:03:21.108    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:03:21.108    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990709-110757-044_L1C_039-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/09/SPOT2-HRV2-XS_19990709-110745-586_L1C_040-262-8_D_V1-0/SPOT2-HRV2-XS_19990709-110745-586_L1C_040-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990709-110745-586_L1C_040-262-8_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990709-110745-586_L1C_040-262-8_D_V1-0.zip
run script
2024-01-10T13:05:20.469    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:05:20.470    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990709-110745-586_L1C_040-262-8_D_V1-0.zip
2024-01-10T13:05:20.470    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:05:20.470    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:05:20.470    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:05:20.471    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:05:20.471    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:05:20.471    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:05:20.471    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:05:20.471    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990709-110745-586_L1C_040-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/09/SPOT2-HRV2-XS_19990709-110746-739_L1C_040-263-0_D_V1-0/SPOT2-HRV2-XS_19990709-110746-739_L1C_040-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990709-110746-739_L1C_040-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990709-110746-739_L1C_040-263-0_D_V1-0.zip
run script
2024-01-10T13:06:39.448    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:06:39.450    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990709-110746-739_L1C_040-263-0_D_V1-0.zip
2024-01-10T13:06:39.450    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:06:39.450    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:06:39.450    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:06:39.450    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:06:39.450    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:06:39.450    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:06:39.450    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:06:39.450    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990709-110746-739_L1C_040-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/09/SPOT2-HRV2-XS_19990709-110755-113_L1C_040-264-0_D_V1-0/SPOT2-HRV2-XS_19990709-110755-113_L1C_040-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990709-110755-113_L1C_040-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990709-110755-113_L1C_040-264-0_D_V1-0.zip
run script
2024-01-10T13:08:17.227    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:08:17.228    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990709-110755-113_L1C_040-264-0_D_V1-0.zip
2024-01-10T13:08:17.228    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:08:17.228    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:08:17.228    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:08:17.228    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:08:17.228    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:08:17.228    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:08:17.228    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:08:17.228    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990709-110755-113_L1C_040-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/05/SPOT2-HRV1-XS_19991005-111503-632_L1C_039-262-6_D_V1-0/SPOT2-HRV1-XS_19991005-111503-632_L1C_039-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991005-111503-632_L1C_039-262-6_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991005-111503-632_L1C_039-262-6_D_V1-0.zip
run script
2024-01-10T13:10:16.700    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:10:16.701    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991005-111503-632_L1C_039-262-6_D_V1-0.zip
2024-01-10T13:10:16.701    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:10:16.701    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:10:16.701    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:10:16.701    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:10:16.701    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:10:16.701    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:10:16.701    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:10:16.701    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991005-111503-632_L1C_039-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/05/SPOT2-HRV1-XS_19991005-111506-619_L1C_039-263-0_D_V1-0/SPOT2-HRV1-XS_19991005-111506-619_L1C_039-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991005-111506-619_L1C_039-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991005-111506-619_L1C_039-263-0_D_V1-0.zip
run script
2024-01-10T13:11:13.333    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:11:13.334    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991005-111506-619_L1C_039-263-0_D_V1-0.zip
2024-01-10T13:11:13.334    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:11:13.334    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:11:13.334    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:11:13.334    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:11:13.335    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:11:13.335    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:11:13.335    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:11:13.335    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991005-111506-619_L1C_039-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/05/SPOT2-HRV1-XS_19991005-111509-326_L1C_039-263-3_D_V1-0/SPOT2-HRV1-XS_19991005-111509-326_L1C_039-263-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991005-111509-326_L1C_039-263-3_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991005-111509-326_L1C_039-263-3_D_V1-0.zip
run script
2024-01-10T13:12:44.325    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:12:44.326    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991005-111509-326_L1C_039-263-3_D_V1-0.zip
2024-01-10T13:12:44.326    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:12:44.326    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:12:44.326    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:12:44.326    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:12:44.326    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:12:44.326    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:12:44.327    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:12:44.327    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991005-111509-326_L1C_039-263-3_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/05/SPOT2-HRV2-XS_19991005-111503-094_L1C_040-262-8_D_V1-0/SPOT2-HRV2-XS_19991005-111503-094_L1C_040-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19991005-111503-094_L1C_040-262-8_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991005-111503-094_L1C_040-262-8_D_V1-0.zip
run script
2024-01-10T13:15:35.922    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:15:35.923    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991005-111503-094_L1C_040-262-8_D_V1-0.zip
2024-01-10T13:15:35.923    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:15:35.924    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:15:35.924    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:15:35.924    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:15:35.924    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:15:35.924    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:15:35.924    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:15:35.924    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991005-111503-094_L1C_040-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/05/SPOT2-HRV2-XS_19991005-111504-297_L1C_040-263-0_D_V1-0/SPOT2-HRV2-XS_19991005-111504-297_L1C_040-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19991005-111504-297_L1C_040-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991005-111504-297_L1C_040-263-0_D_V1-0.zip
run script
2024-01-10T13:17:03.577    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:17:03.579    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991005-111504-297_L1C_040-263-0_D_V1-0.zip
2024-01-10T13:17:03.579    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:17:03.579    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:17:03.579    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:17:03.579    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:17:03.579    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:17:03.579    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:17:03.579    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:17:03.579    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991005-111504-297_L1C_040-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/05/13/SPOT2-HRV1-XS_19990513-110355-510_L1C_039-263-1_D_V1-0/SPOT2-HRV1-XS_19990513-110355-510_L1C_039-263-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990513-110355-510_L1C_039-263-1_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990513-110355-510_L1C_039-263-1_D_V1-0.zip
run script
2024-01-10T13:18:49.177    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:18:49.178    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990513-110355-510_L1C_039-263-1_D_V1-0.zip
2024-01-10T13:18:49.178    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:18:49.178    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:18:49.178    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:18:49.178    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:18:49.178    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:18:49.178    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:18:49.178    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:18:49.178    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990513-110355-510_L1C_039-263-1_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 2 2]
 [2 2 2 ... 0 0 2]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/05/13/SPOT2-HRV2-XS_19990513-110348-654_L1C_040-262-5_D_V1-0/SPOT2-HRV2-XS_19990513-110348-654_L1C_040-262-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990513-110348-654_L1C_040-262-5_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990513-110348-654_L1C_040-262-5_D_V1-0.zip
run script
2024-01-10T13:20:15.497    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:20:15.499    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990513-110348-654_L1C_040-262-5_D_V1-0.zip
2024-01-10T13:20:15.499    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:20:15.499    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:20:15.499    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:20:15.499    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:20:15.499    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:20:15.499    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:20:15.499    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:20:15.499    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990513-110348-654_L1C_040-262-5_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/05/13/SPOT2-HRV2-XS_19990513-110352-489_L1C_040-263-0_D_V1-0/SPOT2-HRV2-XS_19990513-110352-489_L1C_040-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990513-110352-489_L1C_040-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990513-110352-489_L1C_040-263-0_D_V1-0.zip
run script
2024-01-10T13:21:02.268    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:21:02.270    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990513-110352-489_L1C_040-263-0_D_V1-0.zip
2024-01-10T13:21:02.270    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:21:02.270    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:21:02.270    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:21:02.270    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:21:02.270    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:21:02.270    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:21:02.270    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:21:02.270    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990513-110352-489_L1C_040-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/05/13/SPOT2-HRV2-XS_19990513-110356-099_L1C_040-263-4_D_V1-0/SPOT2-HRV2-XS_19990513-110356-099_L1C_040-263-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990513-110356-099_L1C_040-263-4_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990513-110356-099_L1C_040-263-4_D_V1-0.zip
run script
2024-01-10T13:22:33.630    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:22:33.631    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990513-110356-099_L1C_040-263-4_D_V1-0.zip
2024-01-10T13:22:33.631    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:22:33.631    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:22:33.631    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:22:33.631    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:22:33.631    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:22:33.631    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:22:33.632    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:22:33.632    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990513-110356-099_L1C_040-263-4_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/30/SPOT2-HRV2-XS_19990730-110358-068_L1C_039-263-5_D_V1-0/SPOT2-HRV2-XS_19990730-110358-068_L1C_039-263-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990730-110358-068_L1C_039-263-5_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990730-110358-068_L1C_039-263-5_D_V1-0.zip
run script
2024-01-10T13:24:46.814    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:24:46.816    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990730-110358-068_L1C_039-263-5_D_V1-0.zip
2024-01-10T13:24:46.816    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:24:46.816    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:24:46.816    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:24:46.816    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:24:46.816    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:24:46.816    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:24:46.816    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:24:46.816    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990730-110358-068_L1C_039-263-5_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/30/SPOT2-HRV2-XS_19990730-110401-900_L1C_039-264-0_D_V1-0/SPOT2-HRV2-XS_19990730-110401-900_L1C_039-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990730-110401-900_L1C_039-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990730-110401-900_L1C_039-264-0_D_V1-0.zip
run script
2024-01-10T13:27:24.555    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:27:24.556    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990730-110401-900_L1C_039-264-0_D_V1-0.zip
2024-01-10T13:27:24.556    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:27:24.557    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:27:24.557    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:27:24.557    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:27:24.557    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:27:24.557    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:27:24.557    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:27:24.557    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990730-110401-900_L1C_039-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/04/06/SPOT2-HRV1-XS_19990406-111532-108_L1C_040-262-8_D_V1-0/SPOT2-HRV1-XS_19990406-111532-108_L1C_040-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990406-111532-108_L1C_040-262-8_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990406-111532-108_L1C_040-262-8_D_V1-0.zip
run script
2024-01-10T13:29:19.764    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:29:19.765    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990406-111532-108_L1C_040-262-8_D_V1-0.zip
2024-01-10T13:29:19.765    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:29:19.765    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:29:19.765    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:29:19.765    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:29:19.765    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:29:19.765    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:29:19.766    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:29:19.766    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990406-111532-108_L1C_040-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/05/07/SPOT2-HRV2-XS_19990507-111915-875_L1C_040-262-4_D_V1-0/SPOT2-HRV2-XS_19990507-111915-875_L1C_040-262-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990507-111915-875_L1C_040-262-4_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990507-111915-875_L1C_040-262-4_D_V1-0.zip
run script
2024-01-10T13:30:44.804    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:30:44.805    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990507-111915-875_L1C_040-262-4_D_V1-0.zip
2024-01-10T13:30:44.805    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:30:44.806    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:30:44.806    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:30:44.806    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:30:44.806    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:30:44.806    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:30:44.806    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:30:44.806    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990507-111915-875_L1C_040-262-4_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/05/07/SPOT2-HRV1-XS_19990507-111916-212_L1C_042-263-0_D_V1-0/SPOT2-HRV1-XS_19990507-111916-212_L1C_042-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990507-111916-212_L1C_042-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990507-111916-212_L1C_042-263-0_D_V1-0.zip
run script
2024-01-10T13:31:27.086    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:31:27.087    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990507-111916-212_L1C_042-263-0_D_V1-0.zip
2024-01-10T13:31:27.087    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:31:27.087    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:31:27.087    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:31:27.087    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:31:27.088    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:31:27.088    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:31:27.088    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:31:27.088    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990507-111916-212_L1C_042-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/14/SPOT2-HRV2-XS_19990714-111137-792_L1C_040-263-0_D_V1-0/SPOT2-HRV2-XS_19990714-111137-792_L1C_040-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990714-111137-792_L1C_040-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990714-111137-792_L1C_040-263-0_D_V1-0.zip
run script
2024-01-10T13:33:20.944    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:33:20.946    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990714-111137-792_L1C_040-263-0_D_V1-0.zip
2024-01-10T13:33:20.946    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:33:20.946    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:33:20.946    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:33:20.946    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:33:20.946    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:33:20.946    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:33:20.946    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:33:20.946    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990714-111137-792_L1C_040-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/14/SPOT2-HRV1-XS_19990714-111137-509_L1C_043-263-3_D_V1-0/SPOT2-HRV1-XS_19990714-111137-509_L1C_043-263-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990714-111137-509_L1C_043-263-3_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990714-111137-509_L1C_043-263-3_D_V1-0.zip
run script
2024-01-10T13:34:59.950    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:34:59.952    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990714-111137-509_L1C_043-263-3_D_V1-0.zip
2024-01-10T13:34:59.952    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:34:59.952    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:34:59.952    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:34:59.952    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:34:59.952    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:34:59.952    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:34:59.952    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:34:59.952    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990714-111137-509_L1C_043-263-3_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/11/16/SPOT2-HRV2-XS_19991116-110658-921_L1C_040-263-0_D_V1-0/SPOT2-HRV2-XS_19991116-110658-921_L1C_040-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19991116-110658-921_L1C_040-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991116-110658-921_L1C_040-263-0_D_V1-0.zip
run script
2024-01-10T13:37:08.444    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:37:08.445    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991116-110658-921_L1C_040-263-0_D_V1-0.zip
2024-01-10T13:37:08.445    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:37:08.445    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:37:08.445    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:37:08.445    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:37:08.445    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:37:08.445    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:37:08.445    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:37:08.445    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991116-110658-921_L1C_040-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/11/16/SPOT2-HRV2-XS_19991116-110707-302_L1C_040-264-0_D_V1-0/SPOT2-HRV2-XS_19991116-110707-302_L1C_040-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19991116-110707-302_L1C_040-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991116-110707-302_L1C_040-264-0_D_V1-0.zip
run script
2024-01-10T13:38:41.035    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:38:41.036    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991116-110707-302_L1C_040-264-0_D_V1-0.zip
2024-01-10T13:38:41.036    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:38:41.036    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:38:41.036    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:38:41.037    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:38:41.037    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:38:41.037    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:38:41.037    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:38:41.037    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991116-110707-302_L1C_040-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/11/16/SPOT2-HRV1-XS_19991116-110703-277_L1C_043-264-0_D_V1-0/SPOT2-HRV1-XS_19991116-110703-277_L1C_043-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991116-110703-277_L1C_043-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991116-110703-277_L1C_043-264-0_D_V1-0.zip
run script
2024-01-10T13:40:49.308    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:40:49.309    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991116-110703-277_L1C_043-264-0_D_V1-0.zip
2024-01-10T13:40:49.309    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:40:49.309    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:40:49.309    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:40:49.309    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:40:49.309    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:40:49.309    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:40:49.309    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:40:49.310    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991116-110703-277_L1C_043-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/12/13/SPOT2-HRV1-XS_19991213-104733-266_L1C_040-263-0_D_V1-0/SPOT2-HRV1-XS_19991213-104733-266_L1C_040-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991213-104733-266_L1C_040-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991213-104733-266_L1C_040-263-0_D_V1-0.zip
run script
2024-01-10T13:42:57.806    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:42:57.808    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991213-104733-266_L1C_040-263-0_D_V1-0.zip
2024-01-10T13:42:57.808    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:42:57.808    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:42:57.808    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:42:57.808    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:42:57.808    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:42:57.808    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:42:57.808    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:42:57.808    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991213-104733-266_L1C_040-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 2 2]
 [2 2 2 ... 0 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/12/13/SPOT2-HRV1-XS_19991213-104741-553_L1C_040-264-0_D_V1-0/SPOT2-HRV1-XS_19991213-104741-553_L1C_040-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991213-104741-553_L1C_040-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991213-104741-553_L1C_040-264-0_D_V1-0.zip
run script
2024-01-10T13:44:24.728    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:44:24.729    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991213-104741-553_L1C_040-264-0_D_V1-0.zip
2024-01-10T13:44:24.729    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:44:24.729    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:44:24.729    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:44:24.729    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:44:24.729    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:44:24.729    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:44:24.729    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:44:24.729    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T13:46:12.415    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (204 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991213-104741-553_L1C_040-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1999/12/13/SPOT2-HRV2-XS_19991213-104731-823_L1C_041-263-0_D_V1-0/SPOT2-HRV2-XS_19991213-104731-823_L1C_041-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19991213-104731-823_L1C_041-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991213-104731-823_L1C_041-263-0_D_V1-0.zip
run script
2024-01-10T13:46:15.467    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:46:15.468    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991213-104731-823_L1C_041-263-0_D_V1-0.zip
2024-01-10T13:46:15.468    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:46:15.468    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:46:15.468    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:46:15.468    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:46:15.468    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:46:15.469    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:46:15.469    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:46:15.469    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991213-104731-823_L1C_041-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/12/13/SPOT2-HRV2-XS_19991213-104740-119_L1C_041-264-0_D_V1-0/SPOT2-HRV2-XS_19991213-104740-119_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19991213-104740-119_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991213-104740-119_L1C_041-264-0_D_V1-0.zip
run script
2024-01-10T13:47:44.609    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:47:44.610    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991213-104740-119_L1C_041-264-0_D_V1-0.zip
2024-01-10T13:47:44.610    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:47:44.610    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:47:44.610    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:47:44.611    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:47:44.611    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:47:44.611    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:47:44.611    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:47:44.611    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991213-104740-119_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/12/23/SPOT2-HRV1-XS_19991223-105515-634_L1C_040-263-0_D_V1-0/SPOT2-HRV1-XS_19991223-105515-634_L1C_040-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991223-105515-634_L1C_040-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991223-105515-634_L1C_040-263-0_D_V1-0.zip
run script
2024-01-10T13:49:52.023    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:49:52.024    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991223-105515-634_L1C_040-263-0_D_V1-0.zip
2024-01-10T13:49:52.024    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:49:52.025    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:49:52.025    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:49:52.025    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:49:52.025    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:49:52.025    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:49:52.025    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:49:52.025    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991223-105515-634_L1C_040-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/12/23/SPOT2-HRV1-XS_19991223-105523-945_L1C_040-264-0_D_V1-0/SPOT2-HRV1-XS_19991223-105523-945_L1C_040-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991223-105523-945_L1C_040-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991223-105523-945_L1C_040-264-0_D_V1-0.zip
run script
2024-01-10T13:51:06.243    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:51:06.244    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991223-105523-945_L1C_040-264-0_D_V1-0.zip
2024-01-10T13:51:06.244    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:51:06.244    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:51:06.244    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:51:06.244    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:51:06.244    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:51:06.244    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:51:06.244    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:51:06.244    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991223-105523-945_L1C_040-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/12/23/SPOT2-HRV2-XS_19991223-105522-218_L1C_041-264-0_D_V1-0/SPOT2-HRV2-XS_19991223-105522-218_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19991223-105522-218_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991223-105522-218_L1C_041-264-0_D_V1-0.zip
run script
2024-01-10T13:52:46.639    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:52:46.639    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991223-105522-218_L1C_041-264-0_D_V1-0.zip
2024-01-10T13:52:46.639    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:52:46.639    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:52:46.639    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:52:46.639    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:52:46.639    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:52:46.640    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:52:46.640    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:52:46.640    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991223-105522-218_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/12/03/SPOT2-HRV2-XS_19991203-103943-776_L1C_041-262-8_D_V1-0/SPOT2-HRV2-XS_19991203-103943-776_L1C_041-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19991203-103943-776_L1C_041-262-8_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991203-103943-776_L1C_041-262-8_D_V1-0.zip
run script
2024-01-10T13:54:48.592    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:54:48.593    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991203-103943-776_L1C_041-262-8_D_V1-0.zip
2024-01-10T13:54:48.593    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:54:48.593    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:54:48.593    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:54:48.593    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:54:48.593    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:54:48.594    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:54:48.594    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:54:48.594    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991203-103943-776_L1C_041-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/12/03/SPOT2-HRV1-XS_19991203-103943-517_L1C_044-263-1_D_V1-0/SPOT2-HRV1-XS_19991203-103943-517_L1C_044-263-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991203-103943-517_L1C_044-263-1_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991203-103943-517_L1C_044-263-1_D_V1-0.zip
run script
2024-01-10T13:56:38.024    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:56:38.025    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991203-103943-517_L1C_044-263-1_D_V1-0.zip
2024-01-10T13:56:38.025    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:56:38.025    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:56:38.025    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:56:38.026    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:56:38.026    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:56:38.026    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:56:38.026    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:56:38.026    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991203-103943-517_L1C_044-263-1_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/12/17/SPOT2-HRV2-XS_19991217-111042-013_L1C_041-263-0_D_V1-0/SPOT2-HRV2-XS_19991217-111042-013_L1C_041-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19991217-111042-013_L1C_041-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991217-111042-013_L1C_041-263-0_D_V1-0.zip
run script
2024-01-10T13:58:15.948    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:58:15.949    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991217-111042-013_L1C_041-263-0_D_V1-0.zip
2024-01-10T13:58:15.950    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:58:15.950    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:58:15.950    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:58:15.950    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:58:15.950    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:58:15.950    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:58:15.950    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:58:15.950    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991217-111042-013_L1C_041-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/12/17/SPOT2-HRV2-XS_19991217-111050-427_L1C_041-264-0_D_V1-0/SPOT2-HRV2-XS_19991217-111050-427_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19991217-111050-427_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991217-111050-427_L1C_041-264-0_D_V1-0.zip
run script
2024-01-10T13:59:51.128    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T13:59:51.129    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991217-111050-427_L1C_041-264-0_D_V1-0.zip
2024-01-10T13:59:51.129    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T13:59:51.129    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T13:59:51.129    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T13:59:51.129    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T13:59:51.129    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T13:59:51.129    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T13:59:51.129    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T13:59:51.129    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991217-111050-427_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/12/29/SPOT2-HRV1-XS_19991229-103942-376_L1C_041-263-0_D_V1-0/SPOT2-HRV1-XS_19991229-103942-376_L1C_041-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991229-103942-376_L1C_041-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991229-103942-376_L1C_041-263-0_D_V1-0.zip
run script
2024-01-10T14:02:10.038    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:02:10.039    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991229-103942-376_L1C_041-263-0_D_V1-0.zip
2024-01-10T14:02:10.039    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:02:10.039    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:02:10.039    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:02:10.039    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:02:10.039    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:02:10.039    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:02:10.039    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:02:10.039    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991229-103942-376_L1C_041-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/12/29/SPOT2-HRV1-XS_19991229-103950-648_L1C_041-264-0_D_V1-0/SPOT2-HRV1-XS_19991229-103950-648_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991229-103950-648_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991229-103950-648_L1C_041-264-0_D_V1-0.zip
run script
2024-01-10T14:03:48.650    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:03:48.651    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991229-103950-648_L1C_041-264-0_D_V1-0.zip
2024-01-10T14:03:48.651    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:03:48.651    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:03:48.651    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:03:48.651    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:03:48.652    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:03:48.652    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:03:48.652    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:03:48.652    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991229-103950-648_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/12/29/SPOT2-HRV2-XS_19991229-103939-353_L1C_044-263-0_D_V1-0/SPOT2-HRV2-XS_19991229-103939-353_L1C_044-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19991229-103939-353_L1C_044-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991229-103939-353_L1C_044-263-0_D_V1-0.zip
run script
2024-01-10T14:06:12.274    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:06:12.275    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991229-103939-353_L1C_044-263-0_D_V1-0.zip
2024-01-10T14:06:12.275    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:06:12.276    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:06:12.276    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:06:12.276    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:06:12.276    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:06:12.276    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:06:12.276    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:06:12.276    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T14:06:14.503    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (312 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991229-103939-353_L1C_044-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1999/12/29/SPOT2-HRV2-XS_19991229-103947-643_L1C_044-264-0_D_V1-0/SPOT2-HRV2-XS_19991229-103947-643_L1C_044-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19991229-103947-643_L1C_044-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991229-103947-643_L1C_044-264-0_D_V1-0.zip
run script
2024-01-10T14:06:17.397    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:06:17.397    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991229-103947-643_L1C_044-264-0_D_V1-0.zip
2024-01-10T14:06:17.397    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:06:17.397    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:06:17.397    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:06:17.398    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:06:17.398    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:06:17.398    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:06:17.398    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:06:17.398    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991229-103947-643_L1C_044-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/12/29/SPOT2-HRV2-XS_19991229-103955-939_L1C_044-265-0_D_V1-0/SPOT2-HRV2-XS_19991229-103955-939_L1C_044-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19991229-103955-939_L1C_044-265-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991229-103955-939_L1C_044-265-0_D_V1-0.zip
run script
2024-01-10T14:08:11.541    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:08:11.541    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991229-103955-939_L1C_044-265-0_D_V1-0.zip
2024-01-10T14:08:11.541    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:08:11.541    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:08:11.542    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:08:11.542    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:08:11.542    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:08:11.542    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:08:11.542    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:08:11.542    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991229-103955-939_L1C_044-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/26/SPOT2-HRV1-XS_19990726-104040-288_L1C_042-263-1_D_V1-0/SPOT2-HRV1-XS_19990726-104040-288_L1C_042-263-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990726-104040-288_L1C_042-263-1_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990726-104040-288_L1C_042-263-1_D_V1-0.zip
run script
2024-01-10T14:08:44.302    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:08:44.303    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990726-104040-288_L1C_042-263-1_D_V1-0.zip
2024-01-10T14:08:44.303    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:08:44.303    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:08:44.303    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:08:44.303    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:08:44.303    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:08:44.304    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:08:44.304    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:08:44.304    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990726-104040-288_L1C_042-263-1_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/04/SPOT2-HRV1-XS_19990704-110400-712_L1C_042-264-0_D_V1-0/SPOT2-HRV1-XS_19990704-110400-712_L1C_042-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990704-110400-712_L1C_042-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990704-110400-712_L1C_042-264-0_D_V1-0.zip
run script
2024-01-10T14:10:22.777    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:10:22.779    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990704-110400-712_L1C_042-264-0_D_V1-0.zip
2024-01-10T14:10:22.779    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:10:22.779    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:10:22.779    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:10:22.779    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:10:22.779    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:10:22.779    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:10:22.779    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:10:22.779    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990704-110400-712_L1C_042-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/04/SPOT2-HRV1-XS_19990704-110401-614_L1C_042-264-1_D_V1-0/SPOT2-HRV1-XS_19990704-110401-614_L1C_042-264-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990704-110401-614_L1C_042-264-1_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990704-110401-614_L1C_042-264-1_D_V1-0.zip
run script
2024-01-10T14:12:53.975    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:12:53.976    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990704-110401-614_L1C_042-264-1_D_V1-0.zip
2024-01-10T14:12:53.976    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:12:53.976    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:12:53.977    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:12:53.977    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:12:53.977    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:12:53.977    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:12:53.977    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:12:53.977    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990704-110401-614_L1C_042-264-1_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/05/02/SPOT2-HRV2-XS_19990502-111528-565_L1C_043-263-1_D_V1-0/SPOT2-HRV2-XS_19990502-111528-565_L1C_043-263-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990502-111528-565_L1C_043-263-1_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990502-111528-565_L1C_043-263-1_D_V1-0.zip
run script
2024-01-10T14:14:56.938    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:14:56.939    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990502-111528-565_L1C_043-263-1_D_V1-0.zip
2024-01-10T14:14:56.939    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:14:56.939    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:14:56.939    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:14:56.939    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:14:56.940    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:14:56.940    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:14:56.940    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:14:56.940    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990502-111528-565_L1C_043-263-1_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/11/11/SPOT2-HRV2-XS_19991111-110305-921_L1C_043-263-0_D_V1-0/SPOT2-HRV2-XS_19991111-110305-921_L1C_043-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19991111-110305-921_L1C_043-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991111-110305-921_L1C_043-263-0_D_V1-0.zip
run script
2024-01-10T14:16:49.835    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:16:49.837    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991111-110305-921_L1C_043-263-0_D_V1-0.zip
2024-01-10T14:16:49.837    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:16:49.837    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:16:49.837    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:16:49.837    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:16:49.837    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:16:49.837    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:16:49.837    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:16:49.837    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991111-110305-921_L1C_043-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/11/11/SPOT2-HRV2-XS_19991111-110314-310_L1C_043-264-0_D_V1-0/SPOT2-HRV2-XS_19991111-110314-310_L1C_043-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19991111-110314-310_L1C_043-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991111-110314-310_L1C_043-264-0_D_V1-0.zip
run script
2024-01-10T14:18:17.173    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:18:17.173    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991111-110314-310_L1C_043-264-0_D_V1-0.zip
2024-01-10T14:18:17.173    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:18:17.174    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:18:17.174    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:18:17.174    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:18:17.174    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:18:17.174    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:18:17.174    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:18:17.174    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991111-110314-310_L1C_043-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/11/07/SPOT2-HRV2-XS_19991107-103953-440_L1C_044-262-5_D_V1-0/SPOT2-HRV2-XS_19991107-103953-440_L1C_044-262-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19991107-103953-440_L1C_044-262-5_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991107-103953-440_L1C_044-262-5_D_V1-0.zip
run script
2024-01-10T14:20:15.049    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:20:15.050    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991107-103953-440_L1C_044-262-5_D_V1-0.zip
2024-01-10T14:20:15.050    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:20:15.051    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:20:15.051    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:20:15.051    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:20:15.051    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:20:15.051    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:20:15.051    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:20:15.051    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991107-103953-440_L1C_044-262-5_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/18/SPOT2-HRV1-XS_19990618-111126-694_L1C_044-263-0_D_V1-0/SPOT2-HRV1-XS_19990618-111126-694_L1C_044-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990618-111126-694_L1C_044-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990618-111126-694_L1C_044-263-0_D_V1-0.zip
run script
2024-01-10T14:20:57.555    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:20:57.556    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990618-111126-694_L1C_044-263-0_D_V1-0.zip
2024-01-10T14:20:57.557    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:20:57.557    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:20:57.557    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:20:57.557    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:20:57.557    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:20:57.557    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:20:57.557    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:20:57.557    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990618-111126-694_L1C_044-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 2 2]
 [2 2 2 ... 0 0 2]
 [2 2 2 ... 0 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/18/SPOT2-HRV2-XS_19990618-111124-766_L1C_045-263-0_D_V1-0/SPOT2-HRV2-XS_19990618-111124-766_L1C_045-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990618-111124-766_L1C_045-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990618-111124-766_L1C_045-263-0_D_V1-0.zip
run script
2024-01-10T14:22:37.468    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:22:37.469    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990618-111124-766_L1C_045-263-0_D_V1-0.zip
2024-01-10T14:22:37.469    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:22:37.470    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:22:37.470    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:22:37.470    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:22:37.470    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:22:37.470    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:22:37.470    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:22:37.470    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990618-111124-766_L1C_045-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/18/SPOT2-HRV2-XS_19990618-111127-473_L1C_045-263-3_D_V1-0/SPOT2-HRV2-XS_19990618-111127-473_L1C_045-263-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990618-111127-473_L1C_045-263-3_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990618-111127-473_L1C_045-263-3_D_V1-0.zip
run script
2024-01-10T14:23:54.307    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:23:54.307    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990618-111127-473_L1C_045-263-3_D_V1-0.zip
2024-01-10T14:23:54.307    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:23:54.307    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:23:54.308    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:23:54.308    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:23:54.308    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:23:54.308    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:23:54.308    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:23:54.308    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990618-111127-473_L1C_045-263-3_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/11/27/SPOT2-HRV1-XS_19991127-105514-987_L1C_044-263-0_D_V1-0/SPOT2-HRV1-XS_19991127-105514-987_L1C_044-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991127-105514-987_L1C_044-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991127-105514-987_L1C_044-263-0_D_V1-0.zip
run script
2024-01-10T14:25:35.840    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:25:35.841    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991127-105514-987_L1C_044-263-0_D_V1-0.zip
2024-01-10T14:25:35.841    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:25:35.841    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:25:35.841    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:25:35.841    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:25:35.841    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:25:35.841    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:25:35.841    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:25:35.841    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991127-105514-987_L1C_044-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/11/27/SPOT2-HRV1-XS_19991127-105523-343_L1C_044-264-0_D_V1-0/SPOT2-HRV1-XS_19991127-105523-343_L1C_044-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991127-105523-343_L1C_044-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991127-105523-343_L1C_044-264-0_D_V1-0.zip
run script
2024-01-10T14:26:51.949    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:26:51.950    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991127-105523-343_L1C_044-264-0_D_V1-0.zip
2024-01-10T14:26:51.950    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:26:51.950    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:26:51.950    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:26:51.950    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:26:51.950    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:26:51.950    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:26:51.950    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:26:51.950    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991127-105523-343_L1C_044-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/11/27/SPOT2-HRV1-XS_19991127-105531-706_L1C_044-265-0_D_V1-0/SPOT2-HRV1-XS_19991127-105531-706_L1C_044-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991127-105531-706_L1C_044-265-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991127-105531-706_L1C_044-265-0_D_V1-0.zip
run script
2024-01-10T14:28:40.984    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:28:40.985    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991127-105531-706_L1C_044-265-0_D_V1-0.zip
2024-01-10T14:28:40.985    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:28:40.985    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:28:40.985    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:28:40.985    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:28:40.985    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:28:40.985    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:28:40.985    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:28:40.985    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991127-105531-706_L1C_044-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/11/27/SPOT2-HRV2-XS_19991127-105513-053_L1C_046-263-0_D_V1-0/SPOT2-HRV2-XS_19991127-105513-053_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19991127-105513-053_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991127-105513-053_L1C_046-263-0_D_V1-0.zip
run script
2024-01-10T14:29:13.935    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:29:13.936    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991127-105513-053_L1C_046-263-0_D_V1-0.zip
2024-01-10T14:29:13.936    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:29:13.936    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:29:13.936    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:29:13.936    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:29:13.936    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:29:13.937    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:29:13.937    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:29:13.937    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991127-105513-053_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/11/27/SPOT2-HRV2-XS_19991127-105521-424_L1C_046-264-0_D_V1-0/SPOT2-HRV2-XS_19991127-105521-424_L1C_046-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19991127-105521-424_L1C_046-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991127-105521-424_L1C_046-264-0_D_V1-0.zip
run script
2024-01-10T14:29:48.948    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:29:48.949    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991127-105521-424_L1C_046-264-0_D_V1-0.zip
2024-01-10T14:29:48.949    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:29:48.949    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:29:48.949    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:29:48.949    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:29:48.949    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:29:48.949    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:29:48.949    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:29:48.949    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991127-105521-424_L1C_046-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/11/28/SPOT2-HRV1-XS_19991128-103554-623_L1C_044-263-0_D_V1-0/SPOT2-HRV1-XS_19991128-103554-623_L1C_044-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991128-103554-623_L1C_044-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991128-103554-623_L1C_044-263-0_D_V1-0.zip
run script
2024-01-10T14:30:56.862    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:30:56.863    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991128-103554-623_L1C_044-263-0_D_V1-0.zip
2024-01-10T14:30:56.863    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:30:56.863    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:30:56.863    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:30:56.863    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:30:56.863    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:30:56.863    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:30:56.863    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:30:56.864    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T14:30:58.957    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (160 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991128-103554-623_L1C_044-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1999/11/28/SPOT2-HRV1-XS_19991128-103602-901_L1C_044-264-0_D_V1-0/SPOT2-HRV1-XS_19991128-103602-901_L1C_044-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991128-103602-901_L1C_044-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991128-103602-901_L1C_044-264-0_D_V1-0.zip
run script
2024-01-10T14:31:01.883    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:31:01.883    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991128-103602-901_L1C_044-264-0_D_V1-0.zip
2024-01-10T14:31:01.883    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:31:01.883    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:31:01.883    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:31:01.883    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:31:01.883    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:31:01.883    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:31:01.883    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:31:01.883    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991128-103602-901_L1C_044-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/11/28/SPOT2-HRV1-XS_19991128-103611-188_L1C_044-265-0_D_V1-0/SPOT2-HRV1-XS_19991128-103611-188_L1C_044-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991128-103611-188_L1C_044-265-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991128-103611-188_L1C_044-265-0_D_V1-0.zip
run script
2024-01-10T14:33:09.854    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:33:09.855    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991128-103611-188_L1C_044-265-0_D_V1-0.zip
2024-01-10T14:33:09.856    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:33:09.856    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:33:09.856    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:33:09.856    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:33:09.856    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:33:09.856    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:33:09.856    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:33:09.856    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991128-103611-188_L1C_044-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 2 ... 0 0 2]
 [0 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/11/28/SPOT2-HRV2-XS_19991128-103601-196_L1C_046-264-0_D_V1-0/SPOT2-HRV2-XS_19991128-103601-196_L1C_046-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19991128-103601-196_L1C_046-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991128-103601-196_L1C_046-264-0_D_V1-0.zip
run script
2024-01-10T14:33:44.611    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:33:44.612    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991128-103601-196_L1C_046-264-0_D_V1-0.zip
2024-01-10T14:33:44.612    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:33:44.612    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:33:44.612    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:33:44.612    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:33:44.613    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:33:44.613    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:33:44.613    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:33:44.613    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991128-103601-196_L1C_046-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/12/02/SPOT2-HRV1-XS_19991202-105901-843_L1C_044-263-0_D_V1-0/SPOT2-HRV1-XS_19991202-105901-843_L1C_044-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991202-105901-843_L1C_044-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991202-105901-843_L1C_044-263-0_D_V1-0.zip
run script
2024-01-10T14:34:42.126    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:34:42.127    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991202-105901-843_L1C_044-263-0_D_V1-0.zip
2024-01-10T14:34:42.127    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:34:42.127    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:34:42.127    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:34:42.127    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:34:42.127    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:34:42.127    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:34:42.127    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:34:42.128    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991202-105901-843_L1C_044-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/12/02/SPOT2-HRV1-XS_19991202-105910-223_L1C_044-264-0_D_V1-0/SPOT2-HRV1-XS_19991202-105910-223_L1C_044-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991202-105910-223_L1C_044-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991202-105910-223_L1C_044-264-0_D_V1-0.zip
run script
2024-01-10T14:36:01.003    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:36:01.005    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991202-105910-223_L1C_044-264-0_D_V1-0.zip
2024-01-10T14:36:01.005    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:36:01.005    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:36:01.005    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:36:01.005    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:36:01.005    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:36:01.006    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:36:01.006    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:36:01.006    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991202-105910-223_L1C_044-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/12/02/SPOT2-HRV1-XS_19991202-105918-609_L1C_044-265-0_D_V1-0/SPOT2-HRV1-XS_19991202-105918-609_L1C_044-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991202-105918-609_L1C_044-265-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991202-105918-609_L1C_044-265-0_D_V1-0.zip
run script
2024-01-10T14:37:50.589    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:37:50.591    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991202-105918-609_L1C_044-265-0_D_V1-0.zip
2024-01-10T14:37:50.591    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:37:50.591    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:37:50.591    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:37:50.591    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:37:50.591    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:37:50.591    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:37:50.591    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:37:50.591    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19991202-105918-609_L1C_044-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/12/02/SPOT2-HRV2-XS_19991202-105859-752_L1C_046-263-0_D_V1-0/SPOT2-HRV2-XS_19991202-105859-752_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19991202-105859-752_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991202-105859-752_L1C_046-263-0_D_V1-0.zip
run script
2024-01-10T14:38:24.229    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:38:24.231    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991202-105859-752_L1C_046-263-0_D_V1-0.zip
2024-01-10T14:38:24.231    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:38:24.231    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:38:24.231    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:38:24.231    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:38:24.231    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:38:24.231    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:38:24.231    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:38:24.231    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991202-105859-752_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/12/02/SPOT2-HRV2-XS_19991202-105908-154_L1C_046-264-0_D_V1-0/SPOT2-HRV2-XS_19991202-105908-154_L1C_046-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19991202-105908-154_L1C_046-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991202-105908-154_L1C_046-264-0_D_V1-0.zip
run script
2024-01-10T14:38:56.744    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:38:56.744    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991202-105908-154_L1C_046-264-0_D_V1-0.zip
2024-01-10T14:38:56.744    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:38:56.744    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:38:56.744    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:38:56.744    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:38:56.744    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:38:56.744    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:38:56.745    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:38:56.745    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991202-105908-154_L1C_046-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/12/02/SPOT2-HRV2-XS_19991202-105916-558_L1C_046-265-0_D_V1-0/SPOT2-HRV2-XS_19991202-105916-558_L1C_046-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19991202-105916-558_L1C_046-265-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991202-105916-558_L1C_046-265-0_D_V1-0.zip
run script
2024-01-10T14:40:01.357    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:40:01.358    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991202-105916-558_L1C_046-265-0_D_V1-0.zip
2024-01-10T14:40:01.358    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:40:01.358    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:40:01.358    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:40:01.358    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:40:01.358    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:40:01.359    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:40:01.359    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:40:01.359    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991202-105916-558_L1C_046-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/12/24/SPOT2-HRV2-XS_19991224-103550-002_L1C_044-263-0_D_V1-0/SPOT2-HRV2-XS_19991224-103550-002_L1C_044-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19991224-103550-002_L1C_044-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991224-103550-002_L1C_044-263-0_D_V1-0.zip
run script
2024-01-10T14:40:25.462    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:40:25.464    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991224-103550-002_L1C_044-263-0_D_V1-0.zip
2024-01-10T14:40:25.464    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:40:25.464    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:40:25.464    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:40:25.464    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:40:25.464    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:40:25.464    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:40:25.464    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:40:25.464    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991224-103550-002_L1C_044-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/12/24/SPOT2-HRV2-XS_19991224-103558-283_L1C_044-264-0_D_V1-0/SPOT2-HRV2-XS_19991224-103558-283_L1C_044-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19991224-103558-283_L1C_044-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991224-103558-283_L1C_044-264-0_D_V1-0.zip
run script
2024-01-10T14:41:44.283    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:41:44.284    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991224-103558-283_L1C_044-264-0_D_V1-0.zip
2024-01-10T14:41:44.284    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:41:44.284    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:41:44.284    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:41:44.284    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:41:44.284    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:41:44.284    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:41:44.284    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:41:44.284    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991224-103558-283_L1C_044-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/12/24/SPOT2-HRV2-XS_19991224-103606-570_L1C_044-265-0_D_V1-0/SPOT2-HRV2-XS_19991224-103606-570_L1C_044-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19991224-103606-570_L1C_044-265-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991224-103606-570_L1C_044-265-0_D_V1-0.zip
run script
2024-01-10T14:43:39.180    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:43:39.181    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991224-103606-570_L1C_044-265-0_D_V1-0.zip
2024-01-10T14:43:39.181    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:43:39.181    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:43:39.181    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:43:39.181    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:43:39.181    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:43:39.182    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:43:39.182    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:43:39.182    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19991224-103606-570_L1C_044-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 2 2]
 [2 2 2 ... 1 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/14/SPOT2-HRV2-XS_19990614-104818-149_L1C_045-263-0_D_V1-0/SPOT2-HRV2-XS_19990614-104818-149_L1C_045-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990614-104818-149_L1C_045-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990614-104818-149_L1C_045-263-0_D_V1-0.zip
run script
2024-01-10T14:44:11.470    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:44:11.471    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990614-104818-149_L1C_045-263-0_D_V1-0.zip
2024-01-10T14:44:11.471    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:44:11.471    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:44:11.472    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:44:11.472    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:44:11.472    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:44:11.472    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:44:11.472    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:44:11.472    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990614-104818-149_L1C_045-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/14/SPOT2-HRV2-XS_19990614-104820-856_L1C_045-263-3_D_V1-0/SPOT2-HRV2-XS_19990614-104820-856_L1C_045-263-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990614-104820-856_L1C_045-263-3_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990614-104820-856_L1C_045-263-3_D_V1-0.zip
run script
2024-01-10T14:45:04.438    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:45:04.440    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990614-104820-856_L1C_045-263-3_D_V1-0.zip
2024-01-10T14:45:04.440    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:45:04.440    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:45:04.440    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:45:04.440    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:45:04.440    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:45:04.440    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:45:04.440    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:45:04.440    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990614-104820-856_L1C_045-263-3_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/24/SPOT2-HRV2-XS_19990624-105600-379_L1C_045-263-0_D_V1-0/SPOT2-HRV2-XS_19990624-105600-379_L1C_045-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990624-105600-379_L1C_045-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990624-105600-379_L1C_045-263-0_D_V1-0.zip
run script
2024-01-10T14:46:19.723    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:46:19.724    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990624-105600-379_L1C_045-263-0_D_V1-0.zip
2024-01-10T14:46:19.724    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:46:19.724    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:46:19.725    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:46:19.725    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:46:19.725    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:46:19.725    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:46:19.725    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:46:19.725    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990624-105600-379_L1C_045-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 2]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/25/SPOT2-HRV1-XS_19990625-103641-426_L1C_045-263-0_D_V1-0/SPOT2-HRV1-XS_19990625-103641-426_L1C_045-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990625-103641-426_L1C_045-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990625-103641-426_L1C_045-263-0_D_V1-0.zip
run script
2024-01-10T14:47:19.039    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:47:19.041    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990625-103641-426_L1C_045-263-0_D_V1-0.zip
2024-01-10T14:47:19.041    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:47:19.041    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:47:19.041    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:47:19.041    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:47:19.041    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:47:19.041    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:47:19.041    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:47:19.041    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990625-103641-426_L1C_045-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/25/SPOT2-HRV1-XS_19990625-103647-742_L1C_045-263-7_D_V1-0/SPOT2-HRV1-XS_19990625-103647-742_L1C_045-263-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990625-103647-742_L1C_045-263-7_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990625-103647-742_L1C_045-263-7_D_V1-0.zip
run script
2024-01-10T14:48:14.411    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:48:14.413    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990625-103647-742_L1C_045-263-7_D_V1-0.zip
2024-01-10T14:48:14.413    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:48:14.413    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:48:14.413    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:48:14.413    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:48:14.413    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:48:14.413    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:48:14.413    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:48:14.414    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990625-103647-742_L1C_045-263-7_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 2 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/08/09/SPOT2-HRV2-XS_19990809-111122-040_L1C_045-263-0_D_V1-0/SPOT2-HRV2-XS_19990809-111122-040_L1C_045-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990809-111122-040_L1C_045-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990809-111122-040_L1C_045-263-0_D_V1-0.zip
run script
2024-01-10T14:49:34.267    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:49:34.268    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990809-111122-040_L1C_045-263-0_D_V1-0.zip
2024-01-10T14:49:34.269    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:49:34.269    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:49:34.269    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:49:34.269    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:49:34.269    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:49:34.269    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:49:34.269    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:49:34.269    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990809-111122-040_L1C_045-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/08/09/SPOT2-HRV2-XS_19990809-111123-845_L1C_045-263-2_D_V1-0/SPOT2-HRV2-XS_19990809-111123-845_L1C_045-263-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990809-111123-845_L1C_045-263-2_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990809-111123-845_L1C_045-263-2_D_V1-0.zip
run script
2024-01-10T14:50:47.210    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:50:47.212    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990809-111123-845_L1C_045-263-2_D_V1-0.zip
2024-01-10T14:50:47.212    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:50:47.212    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:50:47.212    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:50:47.212    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:50:47.212    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:50:47.212    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:50:47.212    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:50:47.212    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990809-111123-845_L1C_045-263-2_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/02/10/SPOT2-HRV1-XS_19990210-103305-374_L1C_045-264-6_D_V1-0/SPOT2-HRV1-XS_19990210-103305-374_L1C_045-264-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990210-103305-374_L1C_045-264-6_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990210-103305-374_L1C_045-264-6_D_V1-0.zip
run script
2024-01-10T14:52:13.237    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:52:13.240    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990210-103305-374_L1C_045-264-6_D_V1-0.zip
2024-01-10T14:52:13.240    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:52:13.240    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:52:13.240    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:52:13.240    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:52:13.240    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:52:13.240    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:52:13.240    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:52:13.240    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990210-103305-374_L1C_045-264-6_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/04/08/SPOT2-HRV1-XS_19990408-103703-867_L1C_045-264-5_D_V1-0/SPOT2-HRV1-XS_19990408-103703-867_L1C_045-264-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990408-103703-867_L1C_045-264-5_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990408-103703-867_L1C_045-264-5_D_V1-0.zip
run script
2024-01-10T14:53:18.001    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:53:18.003    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990408-103703-867_L1C_045-264-5_D_V1-0.zip
2024-01-10T14:53:18.003    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:53:18.003    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:53:18.003    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:53:18.003    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:53:18.003    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:53:18.003    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:53:18.003    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:53:18.003    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990408-103703-867_L1C_045-264-5_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/04/12/SPOT2-HRV2-XS_19990412-110017-906_L1C_045-264-8_D_V1-0/SPOT2-HRV2-XS_19990412-110017-906_L1C_045-264-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990412-110017-906_L1C_045-264-8_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990412-110017-906_L1C_045-264-8_D_V1-0.zip
run script
2024-01-10T14:54:21.516    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:54:21.517    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990412-110017-906_L1C_045-264-8_D_V1-0.zip
2024-01-10T14:54:21.517    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:54:21.517    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:54:21.517    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:54:21.517    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:54:21.517    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:54:21.517    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:54:21.518    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:54:21.518    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990412-110017-906_L1C_045-264-8_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/04/13/SPOT2-HRV1-XS_19990413-104057-423_L1C_045-264-6_D_V1-0/SPOT2-HRV1-XS_19990413-104057-423_L1C_045-264-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990413-104057-423_L1C_045-264-6_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990413-104057-423_L1C_045-264-6_D_V1-0.zip
run script
2024-01-10T14:55:01.462    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:55:01.463    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990413-104057-423_L1C_045-264-6_D_V1-0.zip
2024-01-10T14:55:01.463    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:55:01.463    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:55:01.463    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:55:01.463    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:55:01.463    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:55:01.463    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:55:01.464    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:55:01.464    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990413-104057-423_L1C_045-264-6_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/04/13/SPOT2-HRV1-XS_19990413-104100-311_L1C_045-265-0_D_V1-0/SPOT2-HRV1-XS_19990413-104100-311_L1C_045-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990413-104100-311_L1C_045-265-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990413-104100-311_L1C_045-265-0_D_V1-0.zip
run script
2024-01-10T14:55:54.135    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:55:54.136    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990413-104100-311_L1C_045-265-0_D_V1-0.zip
2024-01-10T14:55:54.136    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:55:54.137    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:55:54.137    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:55:54.137    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:55:54.137    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:55:54.137    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:55:54.137    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:55:54.137    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990413-104100-311_L1C_045-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/04/18/SPOT2-HRV2-XS_19990418-104447-689_L1C_045-264-4_D_V1-0/SPOT2-HRV2-XS_19990418-104447-689_L1C_045-264-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990418-104447-689_L1C_045-264-4_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990418-104447-689_L1C_045-264-4_D_V1-0.zip
run script
2024-01-10T14:56:20.526    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:56:20.527    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990418-104447-689_L1C_045-264-4_D_V1-0.zip
2024-01-10T14:56:20.527    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:56:20.527    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:56:20.527    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:56:20.527    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:56:20.528    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:56:20.528    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:56:20.528    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:56:20.528    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990418-104447-689_L1C_045-264-4_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/26/SPOT2-HRV1-XS_19990926-104802-555_L1C_046-263-0_D_V1-0/SPOT2-HRV1-XS_19990926-104802-555_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990926-104802-555_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990926-104802-555_L1C_046-263-0_D_V1-0.zip
run script
2024-01-10T14:57:29.612    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:57:29.613    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990926-104802-555_L1C_046-263-0_D_V1-0.zip
2024-01-10T14:57:29.613    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:57:29.613    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:57:29.613    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:57:29.613    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:57:29.613    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:57:29.613    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:57:29.613    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:57:29.613    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990926-104802-555_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/26/SPOT2-HRV1-XS_19990926-104804-360_L1C_046-263-2_D_V1-0/SPOT2-HRV1-XS_19990926-104804-360_L1C_046-263-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990926-104804-360_L1C_046-263-2_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990926-104804-360_L1C_046-263-2_D_V1-0.zip
run script
2024-01-10T14:58:05.328    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:58:05.329    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990926-104804-360_L1C_046-263-2_D_V1-0.zip
2024-01-10T14:58:05.329    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:58:05.329    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:58:05.329    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:58:05.329    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:58:05.329    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:58:05.329    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:58:05.329    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:58:05.329    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV1-XS_19990926-104804-360_L1C_046-263-2_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/05/25/SPOT2-HRV2-XS_19990525-103242-458_L1C_048-262-0_D_V1-0/SPOT2-HRV2-XS_19990525-103242-458_L1C_048-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990525-103242-458_L1C_048-262-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990525-103242-458_L1C_048-262-0_D_V1-0.zip
run script
2024-01-10T14:58:50.621    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:58:50.622    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990525-103242-458_L1C_048-262-0_D_V1-0.zip
2024-01-10T14:58:50.622    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:58:50.623    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:58:50.623    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:58:50.623    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:58:50.623    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:58:50.623    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:58:50.623    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:58:50.623    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT2-HRV2-XS_19990525-103242-458_L1C_048-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1999/09/29/SPOT4-HRVIR1-XS_19990929-110122-959_L1C_036-262-5_D_V1-0/SPOT4-HRVIR1-XS_19990929-110122-959_L1C_036-262-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19990929-110122-959_L1C_036-262-5_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990929-110122-959_L1C_036-262-5_D_V1-0.zip
run script
2024-01-10T14:58:53.603    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:58:53.604    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990929-110122-959_L1C_036-262-5_D_V1-0.zip
2024-01-10T14:58:53.604    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:58:53.604    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:58:53.604    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:58:53.604    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:58:53.604    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:58:53.604    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:58:53.604    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:58:53.604    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990929-110122-959_L1C_036-262-5_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/29/SPOT4-HRVIR1-XS_19990929-110126-755_L1C_036-263-0_D_V1-0/SPOT4-HRVIR1-XS_19990929-110126-755_L1C_036-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19990929-110126-755_L1C_036-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990929-110126-755_L1C_036-263-0_D_V1-0.zip
run script
2024-01-10T14:59:19.412    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:59:19.414    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990929-110126-755_L1C_036-263-0_D_V1-0.zip
2024-01-10T14:59:19.414    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:59:19.414    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:59:19.414    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:59:19.414    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:59:19.414    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:59:19.414    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:59:19.414    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:59:19.414    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990929-110126-755_L1C_036-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/29/SPOT4-HRVIR2-XS_19990929-110112-853_L1C_046-262-8_D_V1-0/SPOT4-HRVIR2-XS_19990929-110112-853_L1C_046-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19990929-110112-853_L1C_046-262-8_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990929-110112-853_L1C_046-262-8_D_V1-0.zip
run script
2024-01-10T14:59:59.778    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T14:59:59.779    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990929-110112-853_L1C_046-262-8_D_V1-0.zip
2024-01-10T14:59:59.779    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T14:59:59.779    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T14:59:59.779    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T14:59:59.779    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T14:59:59.779    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T14:59:59.780    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T14:59:59.780    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T14:59:59.780    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990929-110112-853_L1C_046-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/04/04/SPOT4-HRVIR1-XS_19990404-112542-856_L1C_037-262-1_D_V1-0/SPOT4-HRVIR1-XS_19990404-112542-856_L1C_037-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19990404-112542-856_L1C_037-262-1_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990404-112542-856_L1C_037-262-1_D_V1-0.zip
run script
2024-01-10T15:00:37.556    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:00:37.557    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990404-112542-856_L1C_037-262-1_D_V1-0.zip
2024-01-10T15:00:37.557    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:00:37.557    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:00:37.557    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:00:37.557    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:00:37.558    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:00:37.558    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:00:37.558    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:00:37.558    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990404-112542-856_L1C_037-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/04/04/SPOT4-HRVIR2-XS_19990404-112547-407_L1C_039-263-0_D_V1-0/SPOT4-HRVIR2-XS_19990404-112547-407_L1C_039-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19990404-112547-407_L1C_039-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990404-112547-407_L1C_039-263-0_D_V1-0.zip
run script
2024-01-10T15:00:49.976    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:00:49.977    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990404-112547-407_L1C_039-263-0_D_V1-0.zip
2024-01-10T15:00:49.977    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:00:49.977    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:00:49.977    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:00:49.977    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:00:49.977    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:00:49.977    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:00:49.977    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:00:49.978    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990404-112547-407_L1C_039-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 0 2]
 [2 2 2 ... 2 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/11/24/SPOT4-HRVIR2-XS_19991124-112500-084_L1C_037-262-2_D_V1-0/SPOT4-HRVIR2-XS_19991124-112500-084_L1C_037-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19991124-112500-084_L1C_037-262-2_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991124-112500-084_L1C_037-262-2_D_V1-0.zip
run script
2024-01-10T15:02:36.790    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:02:36.790    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991124-112500-084_L1C_037-262-2_D_V1-0.zip
2024-01-10T15:02:36.791    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:02:36.791    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:02:36.791    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:02:36.791    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:02:36.791    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:02:36.791    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:02:36.791    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:02:36.791    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991124-112500-084_L1C_037-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/11/24/SPOT4-HRVIR1-XS_19991124-112500-737_L1C_038-262-5_D_V1-0/SPOT4-HRVIR1-XS_19991124-112500-737_L1C_038-262-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19991124-112500-737_L1C_038-262-5_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19991124-112500-737_L1C_038-262-5_D_V1-0.zip
run script
2024-01-10T15:03:01.179    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:03:01.180    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19991124-112500-737_L1C_038-262-5_D_V1-0.zip
2024-01-10T15:03:01.180    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:03:01.181    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:03:01.181    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:03:01.181    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:03:01.181    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:03:01.181    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:03:01.181    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:03:01.181    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19991124-112500-737_L1C_038-262-5_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/12/06/SPOT4-HRVIR1-XS_19991206-105422-122_L1C_037-262-6_D_V1-0/SPOT4-HRVIR1-XS_19991206-105422-122_L1C_037-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19991206-105422-122_L1C_037-262-6_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19991206-105422-122_L1C_037-262-6_D_V1-0.zip
run script
2024-01-10T15:03:58.429    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:03:58.430    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19991206-105422-122_L1C_037-262-6_D_V1-0.zip
2024-01-10T15:03:58.430    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:03:58.430    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:03:58.430    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:03:58.430    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:03:58.431    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:03:58.431    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:03:58.431    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:03:58.431    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T15:04:44.453    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (406 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19991206-105422-122_L1C_037-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1999/12/06/SPOT4-HRVIR2-XS_19991206-105421-840_L1C_038-262-7_D_V1-0/SPOT4-HRVIR2-XS_19991206-105421-840_L1C_038-262-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19991206-105421-840_L1C_038-262-7_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991206-105421-840_L1C_038-262-7_D_V1-0.zip
run script
2024-01-10T15:04:47.956    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:04:47.956    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991206-105421-840_L1C_038-262-7_D_V1-0.zip
2024-01-10T15:04:47.956    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:04:47.956    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:04:47.956    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:04:47.956    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:04:47.956    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:04:47.957    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:04:47.957    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:04:47.957    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991206-105421-840_L1C_038-262-7_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/04/10/SPOT4-HRVIR1-XS_19990410-111019-183_L1C_038-262-9_D_V1-0/SPOT4-HRVIR1-XS_19990410-111019-183_L1C_038-262-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19990410-111019-183_L1C_038-262-9_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990410-111019-183_L1C_038-262-9_D_V1-0.zip
run script
2024-01-10T15:05:47.013    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:05:47.014    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990410-111019-183_L1C_038-262-9_D_V1-0.zip
2024-01-10T15:05:47.014    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:05:47.014    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:05:47.014    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:05:47.014    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:05:47.014    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:05:47.014    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:05:47.014    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:05:47.014    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990410-111019-183_L1C_038-262-9_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/04/10/SPOT4-HRVIR1-XS_19990410-111019-433_L1C_038-263-0_D_V1-0/SPOT4-HRVIR1-XS_19990410-111019-433_L1C_038-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19990410-111019-433_L1C_038-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990410-111019-433_L1C_038-263-0_D_V1-0.zip
run script
2024-01-10T15:07:03.948    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:07:03.949    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990410-111019-433_L1C_038-263-0_D_V1-0.zip
2024-01-10T15:07:03.949    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:07:03.949    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:07:03.949    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:07:03.949    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:07:03.949    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:07:03.949    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:07:03.950    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:07:03.950    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990410-111019-433_L1C_038-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 2]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/05/06/SPOT4-HRVIR1-XS_19990506-111010-367_L1C_038-262-9_D_V1-0/SPOT4-HRVIR1-XS_19990506-111010-367_L1C_038-262-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19990506-111010-367_L1C_038-262-9_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990506-111010-367_L1C_038-262-9_D_V1-0.zip
run script
2024-01-10T15:08:23.192    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:08:23.193    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990506-111010-367_L1C_038-262-9_D_V1-0.zip
2024-01-10T15:08:23.193    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:08:23.194    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:08:23.194    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:08:23.194    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:08:23.194    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:08:23.194    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:08:23.194    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:08:23.194    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990506-111010-367_L1C_038-262-9_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/05/06/SPOT4-HRVIR1-XS_19990506-111010-620_L1C_038-263-0_D_V1-0/SPOT4-HRVIR1-XS_19990506-111010-620_L1C_038-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19990506-111010-620_L1C_038-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990506-111010-620_L1C_038-263-0_D_V1-0.zip
run script
2024-01-10T15:09:40.624    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:09:40.625    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990506-111010-620_L1C_038-263-0_D_V1-0.zip
2024-01-10T15:09:40.625    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:09:40.625    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:09:40.625    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:09:40.625    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:09:40.625    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:09:40.625    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:09:40.625    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:09:40.625    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990506-111010-620_L1C_038-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/07/SPOT4-HRVIR1-XS_19990707-111709-062_L1C_038-262-6_D_V1-0/SPOT4-HRVIR1-XS_19990707-111709-062_L1C_038-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19990707-111709-062_L1C_038-262-6_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990707-111709-062_L1C_038-262-6_D_V1-0.zip
run script
2024-01-10T15:10:59.709    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:10:59.710    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990707-111709-062_L1C_038-262-6_D_V1-0.zip
2024-01-10T15:10:59.710    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:10:59.710    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:10:59.710    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:10:59.710    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:10:59.710    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:10:59.710    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:10:59.711    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:10:59.711    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990707-111709-062_L1C_038-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/07/SPOT4-HRVIR1-XS_19990707-111712-073_L1C_038-263-0_D_V1-0/SPOT4-HRVIR1-XS_19990707-111712-073_L1C_038-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19990707-111712-073_L1C_038-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990707-111712-073_L1C_038-263-0_D_V1-0.zip
run script
2024-01-10T15:11:55.699    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:11:55.700    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990707-111712-073_L1C_038-263-0_D_V1-0.zip
2024-01-10T15:11:55.700    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:11:55.700    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:11:55.701    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:11:55.701    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:11:55.701    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:11:55.701    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:11:55.701    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:11:55.701    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990707-111712-073_L1C_038-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 2 2 0]
 [0 0 0 ... 2 2 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/07/SPOT4-HRVIR1-XS_19990707-111720-502_L1C_038-264-0_D_V1-0/SPOT4-HRVIR1-XS_19990707-111720-502_L1C_038-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19990707-111720-502_L1C_038-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990707-111720-502_L1C_038-264-0_D_V1-0.zip
run script
2024-01-10T15:13:24.186    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:13:24.187    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990707-111720-502_L1C_038-264-0_D_V1-0.zip
2024-01-10T15:13:24.187    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:13:24.188    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:13:24.188    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:13:24.188    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:13:24.188    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:13:24.188    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:13:24.188    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:13:24.188    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990707-111720-502_L1C_038-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/07/SPOT4-HRVIR2-XS_19990707-111709-165_L1C_040-262-9_D_V1-0/SPOT4-HRVIR2-XS_19990707-111709-165_L1C_040-262-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19990707-111709-165_L1C_040-262-9_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990707-111709-165_L1C_040-262-9_D_V1-0.zip
run script
2024-01-10T15:15:30.189    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:15:30.190    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990707-111709-165_L1C_040-262-9_D_V1-0.zip
2024-01-10T15:15:30.190    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:15:30.190    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:15:30.190    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:15:30.190    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:15:30.190    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:15:30.190    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:15:30.191    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:15:30.191    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990707-111709-165_L1C_040-262-9_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/07/SPOT4-HRVIR2-XS_19990707-111717-948_L1C_040-264-0_D_V1-0/SPOT4-HRVIR2-XS_19990707-111717-948_L1C_040-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19990707-111717-948_L1C_040-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990707-111717-948_L1C_040-264-0_D_V1-0.zip
run script
2024-01-10T15:17:10.892    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:17:10.894    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990707-111717-948_L1C_040-264-0_D_V1-0.zip
2024-01-10T15:17:10.894    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:17:10.894    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:17:10.894    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:17:10.894    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:17:10.894    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:17:10.894    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:17:10.894    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:17:10.894    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990707-111717-948_L1C_040-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/07/SPOT4-HRVIR2-XS_19990707-111720-655_L1C_040-264-3_D_V1-0/SPOT4-HRVIR2-XS_19990707-111720-655_L1C_040-264-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19990707-111720-655_L1C_040-264-3_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990707-111720-655_L1C_040-264-3_D_V1-0.zip
run script
2024-01-10T15:19:31.590    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:19:31.591    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990707-111720-655_L1C_040-264-3_D_V1-0.zip
2024-01-10T15:19:31.591    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:19:31.591    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:19:31.591    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:19:31.591    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:19:31.591    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:19:31.591    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:19:31.591    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:19:31.591    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T15:19:34.669    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (196 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990707-111720-655_L1C_040-264-3_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1999/07/08/SPOT4-HRVIR1-XS_19990708-105750-139_L1C_038-262-6_D_V1-0/SPOT4-HRVIR1-XS_19990708-105750-139_L1C_038-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19990708-105750-139_L1C_038-262-6_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990708-105750-139_L1C_038-262-6_D_V1-0.zip
run script
2024-01-10T15:19:37.589    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:19:37.589    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990708-105750-139_L1C_038-262-6_D_V1-0.zip
2024-01-10T15:19:37.589    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:19:37.589    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:19:37.589    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:19:37.590    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:19:37.590    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:19:37.590    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:19:37.590    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:19:37.590    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990708-105750-139_L1C_038-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/08/SPOT4-HRVIR1-XS_19990708-105753-036_L1C_038-263-0_D_V1-0/SPOT4-HRVIR1-XS_19990708-105753-036_L1C_038-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19990708-105753-036_L1C_038-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990708-105753-036_L1C_038-263-0_D_V1-0.zip
run script
2024-01-10T15:20:25.148    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:20:25.149    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990708-105753-036_L1C_038-263-0_D_V1-0.zip
2024-01-10T15:20:25.149    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:20:25.149    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:20:25.149    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:20:25.149    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:20:25.150    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:20:25.150    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:20:25.150    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:20:25.150    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990708-105753-036_L1C_038-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/08/SPOT4-HRVIR1-XS_19990708-105802-259_L1C_038-264-1_D_V1-0/SPOT4-HRVIR1-XS_19990708-105802-259_L1C_038-264-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19990708-105802-259_L1C_038-264-1_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990708-105802-259_L1C_038-264-1_D_V1-0.zip
run script
2024-01-10T15:21:39.786    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:21:39.787    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990708-105802-259_L1C_038-264-1_D_V1-0.zip
2024-01-10T15:21:39.787    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:21:39.787    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:21:39.787    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:21:39.787    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:21:39.787    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:21:39.787    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:21:39.787    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:21:39.787    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990708-105802-259_L1C_038-264-1_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/08/SPOT4-HRVIR2-XS_19990708-105750-188_L1C_040-262-8_D_V1-0/SPOT4-HRVIR2-XS_19990708-105750-188_L1C_040-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19990708-105750-188_L1C_040-262-8_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990708-105750-188_L1C_040-262-8_D_V1-0.zip
run script
2024-01-10T15:23:26.964    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:23:26.965    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990708-105750-188_L1C_040-262-8_D_V1-0.zip
2024-01-10T15:23:26.965    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:23:26.965    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:23:26.965    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:23:26.965    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:23:26.965    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:23:26.965    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:23:26.965    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:23:26.965    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990708-105750-188_L1C_040-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/08/SPOT4-HRVIR2-XS_19990708-105751-291_L1C_040-263-0_D_V1-0/SPOT4-HRVIR2-XS_19990708-105751-291_L1C_040-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19990708-105751-291_L1C_040-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990708-105751-291_L1C_040-263-0_D_V1-0.zip
run script
2024-01-10T15:24:35.517    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:24:35.518    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990708-105751-291_L1C_040-263-0_D_V1-0.zip
2024-01-10T15:24:35.518    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:24:35.518    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:24:35.518    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:24:35.518    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:24:35.518    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:24:35.518    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:24:35.518    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:24:35.518    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990708-105751-291_L1C_040-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/08/SPOT4-HRVIR2-XS_19990708-105759-624_L1C_040-264-0_D_V1-0/SPOT4-HRVIR2-XS_19990708-105759-624_L1C_040-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19990708-105759-624_L1C_040-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990708-105759-624_L1C_040-264-0_D_V1-0.zip
run script
2024-01-10T15:25:54.114    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:25:54.115    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990708-105759-624_L1C_040-264-0_D_V1-0.zip
2024-01-10T15:25:54.115    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:25:54.115    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:25:54.115    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:25:54.115    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:25:54.115    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:25:54.115    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:25:54.115    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:25:54.115    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T15:27:28.449    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (207 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990708-105759-624_L1C_040-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1999/07/08/SPOT4-HRVIR2-XS_19990708-105802-331_L1C_040-264-3_D_V1-0/SPOT4-HRVIR2-XS_19990708-105802-331_L1C_040-264-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19990708-105802-331_L1C_040-264-3_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990708-105802-331_L1C_040-264-3_D_V1-0.zip
run script
2024-01-10T15:27:31.447    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:27:31.448    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990708-105802-331_L1C_040-264-3_D_V1-0.zip
2024-01-10T15:27:31.448    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:27:31.448    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:27:31.448    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:27:31.448    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:27:31.448    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:27:31.448    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:27:31.448    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:27:31.449    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990708-105802-331_L1C_040-264-3_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/17/SPOT4-HRVIR2-XS_19990717-112437-997_L1C_038-262-4_D_V1-0/SPOT4-HRVIR2-XS_19990717-112437-997_L1C_038-262-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19990717-112437-997_L1C_038-262-4_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990717-112437-997_L1C_038-262-4_D_V1-0.zip
run script
2024-01-10T15:28:52.108    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:28:52.109    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990717-112437-997_L1C_038-262-4_D_V1-0.zip
2024-01-10T15:28:52.109    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:28:52.110    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:28:52.110    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:28:52.110    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:28:52.110    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:28:52.110    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:28:52.110    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:28:52.110    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990717-112437-997_L1C_038-262-4_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/17/SPOT4-HRVIR2-XS_19990717-112438-900_L1C_038-262-5_D_V1-0/SPOT4-HRVIR2-XS_19990717-112438-900_L1C_038-262-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19990717-112438-900_L1C_038-262-5_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990717-112438-900_L1C_038-262-5_D_V1-0.zip
run script
2024-01-10T15:29:37.847    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:29:37.848    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990717-112438-900_L1C_038-262-5_D_V1-0.zip
2024-01-10T15:29:37.848    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:29:37.848    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:29:37.848    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:29:37.848    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:29:37.848    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:29:37.848    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:29:37.848    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:29:37.849    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990717-112438-900_L1C_038-262-5_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/04/SPOT4-HRVIR1-XS_19991004-110515-013_L1C_038-262-6_D_V1-0/SPOT4-HRVIR1-XS_19991004-110515-013_L1C_038-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19991004-110515-013_L1C_038-262-6_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19991004-110515-013_L1C_038-262-6_D_V1-0.zip
run script
2024-01-10T15:30:33.494    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:30:33.495    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19991004-110515-013_L1C_038-262-6_D_V1-0.zip
2024-01-10T15:30:33.495    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:30:33.495    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:30:33.495    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:30:33.495    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:30:33.495    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:30:33.496    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:30:33.496    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:30:33.496    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19991004-110515-013_L1C_038-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/04/SPOT4-HRVIR2-XS_19991004-110514-851_L1C_040-262-8_D_V1-0/SPOT4-HRVIR2-XS_19991004-110514-851_L1C_040-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19991004-110514-851_L1C_040-262-8_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991004-110514-851_L1C_040-262-8_D_V1-0.zip
run script
2024-01-10T15:31:22.761    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:31:22.763    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991004-110514-851_L1C_040-262-8_D_V1-0.zip
2024-01-10T15:31:22.763    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:31:22.763    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:31:22.763    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:31:22.763    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:31:22.763    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:31:22.763    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:31:22.763    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:31:22.763    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991004-110514-851_L1C_040-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/04/SPOT4-HRVIR2-XS_19991004-110516-000_L1C_040-263-0_D_V1-0/SPOT4-HRVIR2-XS_19991004-110516-000_L1C_040-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19991004-110516-000_L1C_040-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991004-110516-000_L1C_040-263-0_D_V1-0.zip
run script
2024-01-10T15:32:33.619    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:32:33.620    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991004-110516-000_L1C_040-263-0_D_V1-0.zip
2024-01-10T15:32:33.620    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:32:33.620    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:32:33.620    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:32:33.620    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:32:33.620    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:32:33.620    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:32:33.620    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:32:33.620    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991004-110516-000_L1C_040-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/04/SPOT4-HRVIR2-XS_19991004-110522-317_L1C_040-263-7_D_V1-0/SPOT4-HRVIR2-XS_19991004-110522-317_L1C_040-263-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19991004-110522-317_L1C_040-263-7_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991004-110522-317_L1C_040-263-7_D_V1-0.zip
run script
2024-01-10T15:33:56.524    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:33:56.525    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991004-110522-317_L1C_040-263-7_D_V1-0.zip
2024-01-10T15:33:56.525    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:33:56.525    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:33:56.525    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:33:56.525    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:33:56.525    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:33:56.525    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:33:56.525    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:33:56.525    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991004-110522-317_L1C_040-263-7_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/04/SPOT4-HRVIR2-XS_19991004-110455-137_L1C_048-262-0_D_V1-0/SPOT4-HRVIR2-XS_19991004-110455-137_L1C_048-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19991004-110455-137_L1C_048-262-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991004-110455-137_L1C_048-262-0_D_V1-0.zip
run script
2024-01-10T15:35:42.194    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:35:42.195    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991004-110455-137_L1C_048-262-0_D_V1-0.zip
2024-01-10T15:35:42.195    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:35:42.196    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:35:42.196    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:35:42.196    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:35:42.196    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:35:42.196    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:35:42.196    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:35:42.196    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991004-110455-137_L1C_048-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1999/10/10/SPOT4-HRVIR1-XS_19991010-104949-711_L1C_038-262-6_D_V1-0/SPOT4-HRVIR1-XS_19991010-104949-711_L1C_038-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19991010-104949-711_L1C_038-262-6_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19991010-104949-711_L1C_038-262-6_D_V1-0.zip
run script
2024-01-10T15:35:45.394    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:35:45.394    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19991010-104949-711_L1C_038-262-6_D_V1-0.zip
2024-01-10T15:35:45.394    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:35:45.394    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:35:45.394    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:35:45.395    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:35:45.395    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:35:45.395    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:35:45.395    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:35:45.395    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19991010-104949-711_L1C_038-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/10/SPOT4-HRVIR1-XS_19991010-104952-581_L1C_038-263-0_D_V1-0/SPOT4-HRVIR1-XS_19991010-104952-581_L1C_038-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19991010-104952-581_L1C_038-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19991010-104952-581_L1C_038-263-0_D_V1-0.zip
run script
2024-01-10T15:36:36.611    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:36:36.612    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19991010-104952-581_L1C_038-263-0_D_V1-0.zip
2024-01-10T15:36:36.612    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:36:36.613    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:36:36.613    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:36:36.613    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:36:36.613    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:36:36.613    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:36:36.613    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:36:36.613    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19991010-104952-581_L1C_038-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/10/SPOT4-HRVIR1-XS_19991010-105000-871_L1C_039-264-0_D_V1-0/SPOT4-HRVIR1-XS_19991010-105000-871_L1C_039-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19991010-105000-871_L1C_039-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19991010-105000-871_L1C_039-264-0_D_V1-0.zip
run script
2024-01-10T15:37:56.123    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:37:56.124    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19991010-105000-871_L1C_039-264-0_D_V1-0.zip
2024-01-10T15:37:56.124    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:37:56.124    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:37:56.124    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:37:56.125    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:37:56.125    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:37:56.125    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:37:56.125    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:37:56.125    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19991010-105000-871_L1C_039-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/10/SPOT4-HRVIR1-XS_19991010-105001-774_L1C_039-264-1_D_V1-0/SPOT4-HRVIR1-XS_19991010-105001-774_L1C_039-264-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19991010-105001-774_L1C_039-264-1_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19991010-105001-774_L1C_039-264-1_D_V1-0.zip
run script
2024-01-10T15:39:59.090    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:39:59.091    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19991010-105001-774_L1C_039-264-1_D_V1-0.zip
2024-01-10T15:39:59.091    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:39:59.092    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:39:59.092    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:39:59.092    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:39:59.092    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:39:59.092    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:39:59.092    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:39:59.092    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19991010-105001-774_L1C_039-264-1_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/10/SPOT4-HRVIR2-XS_19991010-104949-814_L1C_040-262-8_D_V1-0/SPOT4-HRVIR2-XS_19991010-104949-814_L1C_040-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19991010-104949-814_L1C_040-262-8_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991010-104949-814_L1C_040-262-8_D_V1-0.zip
run script
2024-01-10T15:42:05.710    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:42:05.711    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991010-104949-814_L1C_040-262-8_D_V1-0.zip
2024-01-10T15:42:05.711    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:42:05.711    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:42:05.711    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:42:05.711    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:42:05.711    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:42:05.711    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:42:05.711    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:42:05.712    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991010-104949-814_L1C_040-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/10/SPOT4-HRVIR2-XS_19991010-104950-891_L1C_040-263-0_D_V1-0/SPOT4-HRVIR2-XS_19991010-104950-891_L1C_040-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19991010-104950-891_L1C_040-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991010-104950-891_L1C_040-263-0_D_V1-0.zip
run script
2024-01-10T15:43:32.034    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:43:32.035    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991010-104950-891_L1C_040-263-0_D_V1-0.zip
2024-01-10T15:43:32.035    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:43:32.036    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:43:32.036    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:43:32.036    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:43:32.036    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:43:32.036    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:43:32.036    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:43:32.036    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991010-104950-891_L1C_040-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/10/SPOT4-HRVIR2-XS_19991010-104959-190_L1C_040-264-0_D_V1-0/SPOT4-HRVIR2-XS_19991010-104959-190_L1C_040-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19991010-104959-190_L1C_040-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991010-104959-190_L1C_040-264-0_D_V1-0.zip
run script
2024-01-10T15:45:11.392    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:45:11.394    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991010-104959-190_L1C_040-264-0_D_V1-0.zip
2024-01-10T15:45:11.394    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:45:11.394    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:45:11.394    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:45:11.394    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:45:11.394    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:45:11.394    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:45:11.394    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:45:11.394    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991010-104959-190_L1C_040-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/10/SPOT4-HRVIR2-XS_19991010-105001-897_L1C_040-264-3_D_V1-0/SPOT4-HRVIR2-XS_19991010-105001-897_L1C_040-264-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19991010-105001-897_L1C_040-264-3_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991010-105001-897_L1C_040-264-3_D_V1-0.zip
run script
2024-01-10T15:47:14.587    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:47:14.588    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991010-105001-897_L1C_040-264-3_D_V1-0.zip
2024-01-10T15:47:14.588    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:47:14.588    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:47:14.588    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:47:14.588    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:47:14.589    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:47:14.589    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:47:14.589    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:47:14.589    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991010-105001-897_L1C_040-264-3_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/08/03/SPOT4-HRVIR1-XS_19990803-105743-058_L1C_038-263-0_D_V1-0/SPOT4-HRVIR1-XS_19990803-105743-058_L1C_038-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19990803-105743-058_L1C_038-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990803-105743-058_L1C_038-263-0_D_V1-0.zip
run script
2024-01-10T15:48:52.954    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:48:52.955    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990803-105743-058_L1C_038-263-0_D_V1-0.zip
2024-01-10T15:48:52.955    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:48:52.955    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:48:52.955    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:48:52.955    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:48:52.955    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:48:52.955    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:48:52.956    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:48:52.956    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990803-105743-058_L1C_038-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/08/08/SPOT4-HRVIR1-XS_19990808-110133-264_L1C_038-263-0_D_V1-0/SPOT4-HRVIR1-XS_19990808-110133-264_L1C_038-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19990808-110133-264_L1C_038-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990808-110133-264_L1C_038-263-0_D_V1-0.zip
run script
2024-01-10T15:50:18.312    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:50:18.313    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990808-110133-264_L1C_038-263-0_D_V1-0.zip
2024-01-10T15:50:18.313    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:50:18.313    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:50:18.313    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:50:18.313    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:50:18.313    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:50:18.313    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:50:18.313    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:50:18.313    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990808-110133-264_L1C_038-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/08/29/SPOT4-HRVIR1-XS_19990829-105723-626_L1C_038-263-0_D_V1-0/SPOT4-HRVIR1-XS_19990829-105723-626_L1C_038-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19990829-105723-626_L1C_038-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990829-105723-626_L1C_038-263-0_D_V1-0.zip
run script
2024-01-10T15:51:40.858    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:51:40.859    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990829-105723-626_L1C_038-263-0_D_V1-0.zip
2024-01-10T15:51:40.860    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:51:40.860    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:51:40.860    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:51:40.860    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:51:40.860    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:51:40.860    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:51:40.860    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:51:40.860    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990829-105723-626_L1C_038-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/08/29/SPOT4-HRVIR1-XS_19990829-105731-943_L1C_038-264-0_D_V1-0/SPOT4-HRVIR1-XS_19990829-105731-943_L1C_038-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19990829-105731-943_L1C_038-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990829-105731-943_L1C_038-264-0_D_V1-0.zip
run script
2024-01-10T15:53:05.627    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:53:05.628    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990829-105731-943_L1C_038-264-0_D_V1-0.zip
2024-01-10T15:53:05.628    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:53:05.628    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:53:05.628    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:53:05.628    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:53:05.628    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:53:05.628    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:53:05.628    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:53:05.629    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990829-105731-943_L1C_038-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/09/SPOT4-HRVIR1-XS_19991009-110911-236_L1C_038-263-0_D_V1-0/SPOT4-HRVIR1-XS_19991009-110911-236_L1C_038-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19991009-110911-236_L1C_038-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19991009-110911-236_L1C_038-263-0_D_V1-0.zip
run script
2024-01-10T15:54:51.936    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:54:51.937    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19991009-110911-236_L1C_038-263-0_D_V1-0.zip
2024-01-10T15:54:51.938    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:54:51.938    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:54:51.938    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:54:51.938    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:54:51.938    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:54:51.938    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:54:51.938    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:54:51.938    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19991009-110911-236_L1C_038-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/09/SPOT4-HRVIR1-XS_19991009-110919-620_L1C_038-264-0_D_V1-0/SPOT4-HRVIR1-XS_19991009-110919-620_L1C_038-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19991009-110919-620_L1C_038-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19991009-110919-620_L1C_038-264-0_D_V1-0.zip
run script
2024-01-10T15:56:10.884    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:56:10.885    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19991009-110919-620_L1C_038-264-0_D_V1-0.zip
2024-01-10T15:56:10.886    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:56:10.886    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:56:10.886    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:56:10.886    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:56:10.886    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:56:10.886    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:56:10.886    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:56:10.886    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19991009-110919-620_L1C_038-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/09/SPOT4-HRVIR1-XS_19991009-110920-522_L1C_038-264-1_D_V1-0/SPOT4-HRVIR1-XS_19991009-110920-522_L1C_038-264-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19991009-110920-522_L1C_038-264-1_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19991009-110920-522_L1C_038-264-1_D_V1-0.zip
run script
2024-01-10T15:58:06.540    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:58:06.541    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19991009-110920-522_L1C_038-264-1_D_V1-0.zip
2024-01-10T15:58:06.541    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:58:06.541    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:58:06.541    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:58:06.541    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:58:06.541    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:58:06.541    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:58:06.542    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:58:06.542    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19991009-110920-522_L1C_038-264-1_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/09/SPOT4-HRVIR1-XS_19991009-110908-276_L1C_039-262-6_D_V1-0/SPOT4-HRVIR1-XS_19991009-110908-276_L1C_039-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19991009-110908-276_L1C_039-262-6_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19991009-110908-276_L1C_039-262-6_D_V1-0.zip
run script
2024-01-10T15:59:55.871    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T15:59:55.872    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19991009-110908-276_L1C_039-262-6_D_V1-0.zip
2024-01-10T15:59:55.872    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T15:59:55.872    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T15:59:55.872    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T15:59:55.872    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T15:59:55.872    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T15:59:55.872    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T15:59:55.872    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T15:59:55.872    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19991009-110908-276_L1C_039-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/09/SPOT4-HRVIR2-XS_19991009-110908-848_L1C_040-262-9_D_V1-0/SPOT4-HRVIR2-XS_19991009-110908-848_L1C_040-262-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19991009-110908-848_L1C_040-262-9_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991009-110908-848_L1C_040-262-9_D_V1-0.zip
run script
2024-01-10T16:00:46.981    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T16:00:46.982    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991009-110908-848_L1C_040-262-9_D_V1-0.zip
2024-01-10T16:00:46.982    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T16:00:46.982    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T16:00:46.982    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T16:00:46.982    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T16:00:46.983    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T16:00:46.983    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T16:00:46.983    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T16:00:46.983    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991009-110908-848_L1C_040-262-9_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/09/SPOT4-HRVIR2-XS_19991009-110909-122_L1C_040-263-0_D_V1-0/SPOT4-HRVIR2-XS_19991009-110909-122_L1C_040-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19991009-110909-122_L1C_040-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991009-110909-122_L1C_040-263-0_D_V1-0.zip
run script
2024-01-10T16:02:17.121    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T16:02:17.123    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991009-110909-122_L1C_040-263-0_D_V1-0.zip
2024-01-10T16:02:17.123    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T16:02:17.123    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T16:02:17.123    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T16:02:17.123    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T16:02:17.123    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T16:02:17.123    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T16:02:17.123    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T16:02:17.123    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991009-110909-122_L1C_040-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/09/SPOT4-HRVIR2-XS_19991009-110917-520_L1C_040-264-0_D_V1-0/SPOT4-HRVIR2-XS_19991009-110917-520_L1C_040-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19991009-110917-520_L1C_040-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991009-110917-520_L1C_040-264-0_D_V1-0.zip
run script
2024-01-10T16:03:52.175    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T16:03:52.176    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991009-110917-520_L1C_040-264-0_D_V1-0.zip
2024-01-10T16:03:52.176    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T16:03:52.176    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T16:03:52.176    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T16:03:52.176    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T16:03:52.177    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T16:03:52.177    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T16:03:52.177    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T16:03:52.177    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991009-110917-520_L1C_040-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/09/SPOT4-HRVIR2-XS_19991009-110920-227_L1C_040-264-3_D_V1-0/SPOT4-HRVIR2-XS_19991009-110920-227_L1C_040-264-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19991009-110920-227_L1C_040-264-3_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991009-110920-227_L1C_040-264-3_D_V1-0.zip
run script
2024-01-10T16:05:48.141    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T16:05:48.142    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991009-110920-227_L1C_040-264-3_D_V1-0.zip
2024-01-10T16:05:48.142    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T16:05:48.142    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T16:05:48.142    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T16:05:48.142    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T16:05:48.142    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T16:05:48.142    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T16:05:48.143    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T16:05:48.143    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T16:07:19.429    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (738 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19991009-110920-227_L1C_040-264-3_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1999/03/10/SPOT4-HRVIR2-XS_19990310-110658-712_L1C_038-264-0_D_V1-0/SPOT4-HRVIR2-XS_19990310-110658-712_L1C_038-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19990310-110658-712_L1C_038-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990310-110658-712_L1C_038-264-0_D_V1-0.zip
run script
2024-01-10T16:07:22.397    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T16:07:22.397    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990310-110658-712_L1C_038-264-0_D_V1-0.zip
2024-01-10T16:07:22.397    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T16:07:22.397    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T16:07:22.397    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T16:07:22.397    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T16:07:22.397    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T16:07:22.397    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T16:07:22.397    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T16:07:22.397    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990310-110658-712_L1C_038-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/02/SPOT4-HRVIR1-XS_19990702-111333-887_L1C_038-264-0_D_V1-0/SPOT4-HRVIR1-XS_19990702-111333-887_L1C_038-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19990702-111333-887_L1C_038-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990702-111333-887_L1C_038-264-0_D_V1-0.zip
run script
2024-01-10T16:09:17.693    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T16:09:17.694    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990702-111333-887_L1C_038-264-0_D_V1-0.zip
2024-01-10T16:09:17.694    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T16:09:17.694    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T16:09:17.695    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T16:09:17.695    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T16:09:17.695    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T16:09:17.695    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T16:09:17.695    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T16:09:17.695    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990702-111333-887_L1C_038-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/02/SPOT4-HRVIR1-XS_19990702-111334-790_L1C_038-264-1_D_V1-0/SPOT4-HRVIR1-XS_19990702-111334-790_L1C_038-264-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19990702-111334-790_L1C_038-264-1_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990702-111334-790_L1C_038-264-1_D_V1-0.zip
run script
2024-01-10T16:11:21.263    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T16:11:21.264    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990702-111334-790_L1C_038-264-1_D_V1-0.zip
2024-01-10T16:11:21.264    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T16:11:21.264    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T16:11:21.264    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T16:11:21.264    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T16:11:21.264    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T16:11:21.264    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T16:11:21.264    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T16:11:21.264    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990702-111334-790_L1C_038-264-1_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/02/SPOT4-HRVIR1-XS_19990702-111322-496_L1C_039-262-6_D_V1-0/SPOT4-HRVIR1-XS_19990702-111322-496_L1C_039-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19990702-111322-496_L1C_039-262-6_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990702-111322-496_L1C_039-262-6_D_V1-0.zip
run script
2024-01-10T16:13:23.111    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T16:13:23.112    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990702-111322-496_L1C_039-262-6_D_V1-0.zip
2024-01-10T16:13:23.112    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T16:13:23.112    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T16:13:23.112    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T16:13:23.113    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T16:13:23.113    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T16:13:23.113    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T16:13:23.113    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T16:13:23.113    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990702-111322-496_L1C_039-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/02/SPOT4-HRVIR1-XS_19990702-111325-483_L1C_039-263-0_D_V1-0/SPOT4-HRVIR1-XS_19990702-111325-483_L1C_039-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19990702-111325-483_L1C_039-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990702-111325-483_L1C_039-263-0_D_V1-0.zip
run script
2024-01-10T16:14:16.390    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T16:14:16.391    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990702-111325-483_L1C_039-263-0_D_V1-0.zip
2024-01-10T16:14:16.391    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T16:14:16.391    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T16:14:16.391    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T16:14:16.391    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T16:14:16.391    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T16:14:16.391    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T16:14:16.391    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T16:14:16.392    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR1-XS_19990702-111325-483_L1C_039-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 2 2]
 [0 0 0 ... 0 2 2]
 [0 0 0 ... 0 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/02/SPOT4-HRVIR2-XS_19990702-111322-842_L1C_040-262-9_D_V1-0/SPOT4-HRVIR2-XS_19990702-111322-842_L1C_040-262-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19990702-111322-842_L1C_040-262-9_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990702-111322-842_L1C_040-262-9_D_V1-0.zip
run script
2024-01-10T16:15:39.285    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T16:15:39.286    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990702-111322-842_L1C_040-262-9_D_V1-0.zip
2024-01-10T16:15:39.286    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T16:15:39.286    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T16:15:39.286    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T16:15:39.286    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T16:15:39.286    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T16:15:39.286    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T16:15:39.286    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T16:15:39.286    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990702-111322-842_L1C_040-262-9_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/02/SPOT4-HRVIR2-XS_19990702-111323-146_L1C_040-263-0_D_V1-0/SPOT4-HRVIR2-XS_19990702-111323-146_L1C_040-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19990702-111323-146_L1C_040-263-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990702-111323-146_L1C_040-263-0_D_V1-0.zip
run script
2024-01-10T16:17:15.670    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T16:17:15.671    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990702-111323-146_L1C_040-263-0_D_V1-0.zip
2024-01-10T16:17:15.671    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T16:17:15.671    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T16:17:15.671    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T16:17:15.671    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T16:17:15.672    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T16:17:15.672    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T16:17:15.672    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T16:17:15.672    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990702-111323-146_L1C_040-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/02/SPOT4-HRVIR2-XS_19990702-111331-571_L1C_040-264-0_D_V1-0/SPOT4-HRVIR2-XS_19990702-111331-571_L1C_040-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19990702-111331-571_L1C_040-264-0_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990702-111331-571_L1C_040-264-0_D_V1-0.zip
run script
2024-01-10T16:18:57.836    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T16:18:57.837    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990702-111331-571_L1C_040-264-0_D_V1-0.zip
2024-01-10T16:18:57.837    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T16:18:57.837    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T16:18:57.837    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T16:18:57.837    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T16:18:57.838    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T16:18:57.838    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T16:18:57.838    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T16:18:57.838    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990702-111331-571_L1C_040-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/02/SPOT4-HRVIR2-XS_19990702-111334-278_L1C_040-264-3_D_V1-0/SPOT4-HRVIR2-XS_19990702-111334-278_L1C_040-264-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19990702-111334-278_L1C_040-264-3_D_V1-0.zip
/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990702-111334-278_L1C_040-264-3_D_V1-0.zip
run script
2024-01-10T16:21:07.412    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T16:21:07.413    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990702-111334-278_L1C_040-264-3_D_V1-0.zip
2024-01-10T16:21:07.413    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T16:21:07.413    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T16:21:07.413    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T16:21:07.414    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T16:21:07.414    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T16:21:07.414    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T16:21:07.414    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T16:21:07.414    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016379/INPUT/SPOT4-HRVIR2-XS_19990702-111334-278_L1C_040-264-3_D_V1-0.zip', job_dir='/tmp/slurm-4016379/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
end
[2024-01-10 16:22:43.789943520+00:00] cnes_level2/barrouz/4016379:  Account (env) = cnes_level2
[2024-01-10 16:22:43.791144449+00:00] cnes_level2/barrouz/4016379:     User (env) = barrouz
[2024-01-10 16:22:43.792322859+00:00] cnes_level2/barrouz/4016379:        GroupId = cesbio(426000053)
[2024-01-10 16:22:43.793494748+00:00] cnes_level2/barrouz/4016379:         UserId = barrouz(9134)
[2024-01-10 16:22:43.794738727+00:00] cnes_level2/barrouz/4016379:        Account = cnes_level2
[2024-01-10 16:22:43.796001906+00:00] cnes_level2/barrouz/4016379:        Account = cnes_level2
[2024-01-10 16:22:43.797271605+00:00] cnes_level2/barrouz/4016379:      Partition = cpu2022
[2024-01-10 16:22:43.798584053+00:00] cnes_level2/barrouz/4016379:            QOS = cpu_2022_1280
[2024-01-10 16:22:43.799826952+00:00] cnes_level2/barrouz/4016379:        JobName = inf_PYR_32_TCD-ONLY_AVG-1200
[2024-01-10 16:22:43.801089071+00:00] cnes_level2/barrouz/4016379:     SubmitTime = 2024-01-09T10:53:13
[2024-01-10 16:22:43.802397549+00:00] cnes_level2/barrouz/4016379:        RunTime = 07:04:22
[2024-01-10 16:22:43.803640188+00:00] cnes_level2/barrouz/4016379:      TimeLimit = 1-16:00:00
[2024-01-10 16:22:43.805033326+00:00] cnes_level2/barrouz/4016379:   EligibleTime = 2024-01-09T10:53:13
[2024-01-10 16:22:43.806286695+00:00] cnes_level2/barrouz/4016379:      StartTime = 2024-01-10T09:18:21
[2024-01-10 16:22:43.807549393+00:00] cnes_level2/barrouz/4016379:        EndTime = 2024-01-10T16:22:43
[2024-01-10 16:22:43.808825002+00:00] cnes_level2/barrouz/4016379:       ExitCode = 0:0
[2024-01-10 16:22:43.810052411+00:00] cnes_level2/barrouz/4016379:       NodeList = trex057
[2024-01-10 16:22:43.811305840+00:00] cnes_level2/barrouz/4016379:      BatchHost = trex057
[2024-01-10 16:22:43.812546159+00:00] cnes_level2/barrouz/4016379:           TRES = 
[2024-01-10 16:22:43.813828318+00:00] cnes_level2/barrouz/4016379:        Command = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
[2024-01-10 16:22:43.815108076+00:00] cnes_level2/barrouz/4016379:        WorkDir = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code
[2024-01-10 16:22:43.816284226+00:00] cnes_level2/barrouz/4016379:         StdErr = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_PYR_32_TCD-ONLY_AVG-1200.log
[2024-01-10 16:22:43.817551144+00:00] cnes_level2/barrouz/4016379:         StdOut = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_PYR_32_TCD-ONLY_AVG-1200.log

#########################################
#        EVIDEN - CNES                  #
#        Job Accounting                 #
#########################################
Cluster              : trex
JobIDRaw             : 4016379
JobID                : 4016379
JobName              : inf_PYR_32_TCD-ONLY_AVG-1200
Account              : cnes_level2
User                 : barrouz(9134), cesbio(426000053)
Partition            : cpu2022
QOS                  : cpu_2022_1280
Nodelist             : trex057 (1)
State                : COMPLETED  (Exitcode=0:0, DerivedExitCode=0:0, Restarts=0)
Submit date          : 2024-01-09T10:53:13
Start time           : 2024-01-10T09:18:21
End time             : 2024-01-10T16:22:43
Elapsed time         : 07:04:22  (Timelimit=1-16:00:00, Suspended=00:00:00)
TEI                  : 2 days, 8:34:56
Command              : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
StdOut               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_PYR_32_TCD-ONLY_AVG-1200.log
StdErr               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_PYR_32_TCD-ONLY_AVG-1200.log

STEP(s) : 2
--------- 
   StepID  | JobName      State       Exit   Start               End                 Elapsed   TotalCPU   CPUTime    ConsumedEnergy MaxDiskRead MaxDiskWrite     MaxRSS MaxRSSTask MaxRSSNode NNodes UserCPU    NodeList
   ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 
   batch   | batch        COMPLETED   0:0    2024-01-10T09:18:21 2024-01-10T16:22:43 07:04:22  1-11:39:12 2-08:34:56       0.14875G  201069.52M    85562.96M  91549896K          0    trex057      1 1-01:28:22 trex057
   extern  | extern       COMPLETED   0:0    2024-01-10T09:18:21 2024-01-10T16:22:43 07:04:22  00:00:00   2-08:34:56       0.14875G       0.00M        0.00M      1708K          0    trex057      1 00:00:00   trex057

