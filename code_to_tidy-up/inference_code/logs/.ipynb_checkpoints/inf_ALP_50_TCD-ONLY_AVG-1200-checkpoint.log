unload conda/22.11.1  : OK 
load conda/22.11.1  : OK 
envs_dirs : /work/scratch/env/barrouz/conda_env/
pkgs_dirs : /work/scratch/env/barrouz/pkgs_conda
INPUT_PATH /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/50.txt
OUTPUT_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
DEM_PATH /work/CAMPUS/etudes/Neige/DEM
TCD_PATH /work/datalake/static_aux/TreeCoverDensity
MODELS_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
KEEP_REFL 0
MASK 1
start
/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/50.txt
muscate/SPOTWORLDHERITAGE/2009/08/16/SPOT4-HRVIR2-XS_20090816-104923-723_L1C_050-261-0_D_V1-0/SPOT4-HRVIR2-XS_20090816-104923-723_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090816-104923-723_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090816-104923-723_L1C_050-261-0_D_V1-0.zip
run script
2024-01-09T11:31:19.911    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:31:19.912    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090816-104923-723_L1C_050-261-0_D_V1-0.zip
2024-01-09T11:31:19.912    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:31:19.912    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:31:19.912    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:31:19.912    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:31:19.912    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:31:19.912    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:31:19.912    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:31:19.913    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090816-104923-723_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/16/SPOT4-HRVIR1-XS_20090816-104906-484_L1C_053-259-5_D_V1-0/SPOT4-HRVIR1-XS_20090816-104906-484_L1C_053-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090816-104906-484_L1C_053-259-5_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090816-104906-484_L1C_053-259-5_D_V1-0.zip
run script
2024-01-09T11:32:26.352    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:32:26.353    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090816-104906-484_L1C_053-259-5_D_V1-0.zip
2024-01-09T11:32:26.353    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:32:26.353    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:32:26.353    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:32:26.353    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:32:26.353    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:32:26.353    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:32:26.354    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:32:26.354    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090816-104906-484_L1C_053-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/16/SPOT4-HRVIR1-XS_20090816-104910-461_L1C_053-260-0_D_V1-0/SPOT4-HRVIR1-XS_20090816-104910-461_L1C_053-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090816-104910-461_L1C_053-260-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090816-104910-461_L1C_053-260-0_D_V1-0.zip
run script
2024-01-09T11:35:24.981    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:35:24.982    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090816-104910-461_L1C_053-260-0_D_V1-0.zip
2024-01-09T11:35:24.982    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:35:24.982    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:35:24.982    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:35:24.983    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:35:24.983    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:35:24.983    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:35:24.983    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:35:24.983    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:36:03.877    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 128). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090816-104910-461_L1C_053-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/08/16/SPOT4-HRVIR1-XS_20090816-104918-952_L1C_053-261-0_D_V1-0/SPOT4-HRVIR1-XS_20090816-104918-952_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090816-104918-952_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090816-104918-952_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T11:36:07.737    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:36:07.739    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090816-104918-952_L1C_053-261-0_D_V1-0.zip
2024-01-09T11:36:07.739    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:36:07.739    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:36:07.739    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:36:07.739    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:36:07.739    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:36:07.739    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:36:07.739    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:36:07.739    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090816-104918-952_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/16/SPOT4-HRVIR1-XS_20090816-104923-464_L1C_053-261-5_D_V1-0/SPOT4-HRVIR1-XS_20090816-104923-464_L1C_053-261-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090816-104923-464_L1C_053-261-5_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090816-104923-464_L1C_053-261-5_D_V1-0.zip
run script
2024-01-09T11:39:32.714    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:39:32.715    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090816-104923-464_L1C_053-261-5_D_V1-0.zip
2024-01-09T11:39:32.715    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:39:32.715    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:39:32.715    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:39:32.716    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:39:32.716    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:39:32.716    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:39:32.716    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:39:32.716    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090816-104923-464_L1C_053-261-5_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/01/SPOT4-HRVIR1-XS_20090801-103748-192_L1C_050-259-8_D_V1-0/SPOT4-HRVIR1-XS_20090801-103748-192_L1C_050-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090801-103748-192_L1C_050-259-8_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090801-103748-192_L1C_050-259-8_D_V1-0.zip
run script
2024-01-09T11:42:52.320    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:42:52.321    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090801-103748-192_L1C_050-259-8_D_V1-0.zip
2024-01-09T11:42:52.321    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:42:52.321    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:42:52.321    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:42:52.321    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:42:52.321    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:42:52.321    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:42:52.321    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:42:52.321    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:44:04.211    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 670). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090801-103748-192_L1C_050-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/08/01/SPOT4-HRVIR1-XS_20090801-103749-320_L1C_050-260-0_D_V1-0/SPOT4-HRVIR1-XS_20090801-103749-320_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090801-103749-320_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090801-103749-320_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T11:44:08.588    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:44:08.590    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090801-103749-320_L1C_050-260-0_D_V1-0.zip
2024-01-09T11:44:08.590    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:44:08.590    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:44:08.590    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:44:08.590    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:44:08.590    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:44:08.590    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:44:08.590    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:44:08.590    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090801-103749-320_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/11/09/SPOT4-HRVIR2-XS_20091109-101316-413_L1C_050-259-6_D_V1-0/SPOT4-HRVIR2-XS_20091109-101316-413_L1C_050-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20091109-101316-413_L1C_050-259-6_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20091109-101316-413_L1C_050-259-6_D_V1-0.zip
run script
2024-01-09T11:45:20.447    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:45:20.448    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20091109-101316-413_L1C_050-259-6_D_V1-0.zip
2024-01-09T11:45:20.448    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:45:20.448    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:45:20.448    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:45:20.448    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:45:20.448    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:45:20.448    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:45:20.448    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:45:20.448    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20091109-101316-413_L1C_050-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/05/21/SPOT4-HRVIR1-XS_20090521-102220-037_L1C_051-254-0_D_V1-0/SPOT4-HRVIR1-XS_20090521-102220-037_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090521-102220-037_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090521-102220-037_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T11:46:54.086    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:46:54.087    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090521-102220-037_L1C_051-254-0_D_V1-0.zip
2024-01-09T11:46:54.087    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:46:54.087    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:46:54.087    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:46:54.087    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:46:54.087    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:46:54.088    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:46:54.088    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:46:54.088    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090521-102220-037_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/09/13/SPOT4-HRVIR2-XS_20090913-100933-169_L1C_051-254-4_D_V1-0/SPOT4-HRVIR2-XS_20090913-100933-169_L1C_051-254-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090913-100933-169_L1C_051-254-4_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090913-100933-169_L1C_051-254-4_D_V1-0.zip
run script
2024-01-09T11:46:58.438    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:46:58.439    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090913-100933-169_L1C_051-254-4_D_V1-0.zip
2024-01-09T11:46:58.439    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:46:58.439    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:46:58.440    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:46:58.440    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:46:58.440    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:46:58.440    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:46:58.440    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:46:58.440    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090913-100933-169_L1C_051-254-4_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/09/13/SPOT4-HRVIR2-XS_20090913-100951-374_L1C_051-256-6_D_V1-0/SPOT4-HRVIR2-XS_20090913-100951-374_L1C_051-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090913-100951-374_L1C_051-256-6_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090913-100951-374_L1C_051-256-6_D_V1-0.zip
run script
2024-01-09T11:47:02.686    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:47:02.687    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090913-100951-374_L1C_051-256-6_D_V1-0.zip
2024-01-09T11:47:02.687    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:47:02.687    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:47:02.687    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:47:02.688    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:47:02.688    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:47:02.688    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:47:02.688    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:47:02.688    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090913-100951-374_L1C_051-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/16/SPOT4-HRVIR2-XS_20090616-102226-552_L1C_051-256-9_D_V1-0/SPOT4-HRVIR2-XS_20090616-102226-552_L1C_051-256-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090616-102226-552_L1C_051-256-9_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090616-102226-552_L1C_051-256-9_D_V1-0.zip
run script
2024-01-09T11:50:00.183    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:50:00.184    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090616-102226-552_L1C_051-256-9_D_V1-0.zip
2024-01-09T11:50:00.184    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:50:00.184    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:50:00.184    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:50:00.184    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:50:00.184    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:50:00.184    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:50:00.184    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:50:00.184    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090616-102226-552_L1C_051-256-9_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/16/SPOT4-HRVIR2-XS_20090616-102234-951_L1C_051-258-0_D_V1-0/SPOT4-HRVIR2-XS_20090616-102234-951_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090616-102234-951_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090616-102234-951_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T11:52:47.851    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:52:47.852    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090616-102234-951_L1C_051-258-0_D_V1-0.zip
2024-01-09T11:52:47.852    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:52:47.852    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:52:47.852    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:52:47.852    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:52:47.852    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:52:47.852    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:52:47.852    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:52:47.853    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:53:56.041    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 566). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090616-102234-951_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/06/26/SPOT4-HRVIR1-XS_20090626-103002-835_L1C_051-257-0_D_V1-0/SPOT4-HRVIR1-XS_20090626-103002-835_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090626-103002-835_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090626-103002-835_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T11:53:59.876    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:53:59.877    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090626-103002-835_L1C_051-257-0_D_V1-0.zip
2024-01-09T11:53:59.877    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:53:59.877    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:53:59.877    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:53:59.877    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:53:59.877    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:53:59.877    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:53:59.877    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:53:59.877    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090626-103002-835_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/26/SPOT4-HRVIR1-XS_20090626-103011-140_L1C_051-258-0_D_V1-0/SPOT4-HRVIR1-XS_20090626-103011-140_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090626-103011-140_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090626-103011-140_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T11:56:48.788    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:56:48.789    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090626-103011-140_L1C_051-258-0_D_V1-0.zip
2024-01-09T11:56:48.789    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:56:48.789    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:56:48.789    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:56:48.789    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:56:48.789    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:56:48.789    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:56:48.790    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:56:48.790    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:58:01.107    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 586). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090626-103011-140_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/06/26/SPOT4-HRVIR1-XS_20090626-103019-451_L1C_051-259-0_D_V1-0/SPOT4-HRVIR1-XS_20090626-103019-451_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090626-103019-451_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090626-103019-451_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T11:58:05.137    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:58:05.138    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090626-103019-451_L1C_051-259-0_D_V1-0.zip
2024-01-09T11:58:05.138    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:58:05.138    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:58:05.138    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:58:05.139    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:58:05.139    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:58:05.139    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:58:05.139    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:58:05.139    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090626-103019-451_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 2]
 [2 2 2 ... 0 0 2]
 [2 2 2 ... 2 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 0]
 [2 2 2 ... 2 2 0]
 [2 2 2 ... 2 2 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 2 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/26/SPOT4-HRVIR1-XS_20090626-103027-768_L1C_051-260-0_D_V1-0/SPOT4-HRVIR1-XS_20090626-103027-768_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090626-103027-768_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090626-103027-768_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T12:00:50.088    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:00:50.089    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090626-103027-768_L1C_051-260-0_D_V1-0.zip
2024-01-09T12:00:50.089    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:00:50.089    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:00:50.090    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:00:50.090    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:00:50.090    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:00:50.090    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:00:50.090    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:00:50.090    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090626-103027-768_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/26/SPOT4-HRVIR1-XS_20090626-103036-094_L1C_051-261-0_D_V1-0/SPOT4-HRVIR1-XS_20090626-103036-094_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090626-103036-094_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090626-103036-094_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T12:03:06.307    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:03:06.308    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090626-103036-094_L1C_051-261-0_D_V1-0.zip
2024-01-09T12:03:06.308    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:03:06.308    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:03:06.308    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:03:06.308    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:03:06.308    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:03:06.308    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:03:06.308    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:03:06.308    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090626-103036-094_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/07/SPOT4-HRVIR1-XS_20090807-102206-439_L1C_051-258-6_D_V1-0/SPOT4-HRVIR1-XS_20090807-102206-439_L1C_051-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090807-102206-439_L1C_051-258-6_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090807-102206-439_L1C_051-258-6_D_V1-0.zip
run script
2024-01-09T12:05:20.671    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:05:20.673    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090807-102206-439_L1C_051-258-6_D_V1-0.zip
2024-01-09T12:05:20.673    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:05:20.673    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:05:20.673    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:05:20.673    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:05:20.673    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:05:20.673    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:05:20.673    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:05:20.673    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090807-102206-439_L1C_051-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/07/SPOT4-HRVIR1-XS_20090807-102209-297_L1C_051-259-0_D_V1-0/SPOT4-HRVIR1-XS_20090807-102209-297_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090807-102209-297_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090807-102209-297_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T12:08:04.391    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:08:04.392    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090807-102209-297_L1C_051-259-0_D_V1-0.zip
2024-01-09T12:08:04.392    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:08:04.392    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:08:04.392    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:08:04.392    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:08:04.392    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:08:04.392    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:08:04.392    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:08:04.392    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090807-102209-297_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/07/SPOT4-HRVIR1-XS_20090807-102217-575_L1C_051-260-0_D_V1-0/SPOT4-HRVIR1-XS_20090807-102217-575_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090807-102217-575_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090807-102217-575_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T12:10:46.215    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:10:46.216    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090807-102217-575_L1C_051-260-0_D_V1-0.zip
2024-01-09T12:10:46.216    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:10:46.216    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:10:46.216    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:10:46.216    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:10:46.216    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:10:46.216    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:10:46.216    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:10:46.216    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090807-102217-575_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/07/SPOT4-HRVIR1-XS_20090807-102225-862_L1C_051-261-0_D_V1-0/SPOT4-HRVIR1-XS_20090807-102225-862_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090807-102225-862_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090807-102225-862_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T12:13:02.843    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:13:02.844    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090807-102225-862_L1C_051-261-0_D_V1-0.zip
2024-01-09T12:13:02.844    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:13:02.844    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:13:02.844    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:13:02.844    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:13:02.844    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:13:02.844    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:13:02.844    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:13:02.845    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090807-102225-862_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 0 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/06/SPOT4-HRVIR1-XS_20090806-104127-796_L1C_051-259-0_D_V1-0/SPOT4-HRVIR1-XS_20090806-104127-796_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090806-104127-796_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090806-104127-796_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T12:15:17.821    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:15:17.823    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090806-104127-796_L1C_051-259-0_D_V1-0.zip
2024-01-09T12:15:17.823    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:15:17.823    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:15:17.823    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:15:17.823    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:15:17.823    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:15:17.823    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:15:17.823    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:15:17.823    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090806-104127-796_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/06/SPOT4-HRVIR1-XS_20090806-104136-188_L1C_051-260-0_D_V1-0/SPOT4-HRVIR1-XS_20090806-104136-188_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090806-104136-188_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090806-104136-188_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T12:18:15.697    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:18:15.698    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090806-104136-188_L1C_051-260-0_D_V1-0.zip
2024-01-09T12:18:15.698    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:18:15.698    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:18:15.698    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:18:15.698    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:18:15.698    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:18:15.698    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:18:15.698    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:18:15.699    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090806-104136-188_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/06/SPOT4-HRVIR1-XS_20090806-104110-765_L1C_052-256-9_D_V1-0/SPOT4-HRVIR1-XS_20090806-104110-765_L1C_052-256-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090806-104110-765_L1C_052-256-9_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090806-104110-765_L1C_052-256-9_D_V1-0.zip
run script
2024-01-09T12:20:48.188    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:20:48.189    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090806-104110-765_L1C_052-256-9_D_V1-0.zip
2024-01-09T12:20:48.189    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:20:48.189    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:20:48.189    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:20:48.189    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:20:48.189    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:20:48.189    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:20:48.189    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:20:48.189    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090806-104110-765_L1C_052-256-9_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/06/SPOT4-HRVIR1-XS_20090806-104111-020_L1C_052-257-0_D_V1-0/SPOT4-HRVIR1-XS_20090806-104111-020_L1C_052-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090806-104111-020_L1C_052-257-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090806-104111-020_L1C_052-257-0_D_V1-0.zip
run script
2024-01-09T12:23:49.727    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:23:49.728    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090806-104111-020_L1C_052-257-0_D_V1-0.zip
2024-01-09T12:23:49.728    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:23:49.728    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:23:49.728    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:23:49.728    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:23:49.728    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:23:49.728    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:23:49.728    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:23:49.728    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090806-104111-020_L1C_052-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/06/SPOT4-HRVIR1-XS_20090806-104119-404_L1C_052-258-0_D_V1-0/SPOT4-HRVIR1-XS_20090806-104119-404_L1C_052-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090806-104119-404_L1C_052-258-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090806-104119-404_L1C_052-258-0_D_V1-0.zip
run script
2024-01-09T12:26:51.162    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:26:51.164    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090806-104119-404_L1C_052-258-0_D_V1-0.zip
2024-01-09T12:26:51.164    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:26:51.164    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:26:51.164    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:26:51.164    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:26:51.164    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:26:51.164    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:26:51.164    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:26:51.164    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090806-104119-404_L1C_052-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/18/SPOT4-HRVIR2-XS_20090818-101039-672_L1C_051-260-5_D_V1-0/SPOT4-HRVIR2-XS_20090818-101039-672_L1C_051-260-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090818-101039-672_L1C_051-260-5_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090818-101039-672_L1C_051-260-5_D_V1-0.zip
run script
2024-01-09T12:29:42.198    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:29:42.199    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090818-101039-672_L1C_051-260-5_D_V1-0.zip
2024-01-09T12:29:42.199    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:29:42.199    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:29:42.200    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:29:42.200    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:29:42.200    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:29:42.200    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:29:42.200    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:29:42.200    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090818-101039-672_L1C_051-260-5_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/18/SPOT4-HRVIR2-XS_20090818-101043-408_L1C_051-261-0_D_V1-0/SPOT4-HRVIR2-XS_20090818-101043-408_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090818-101043-408_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090818-101043-408_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T12:32:23.489    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:32:23.491    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090818-101043-408_L1C_051-261-0_D_V1-0.zip
2024-01-09T12:32:23.491    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:32:23.491    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:32:23.491    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:32:23.492    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:32:23.492    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:32:23.492    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:32:23.492    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:32:23.492    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090818-101043-408_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/18/SPOT4-HRVIR2-XS_20090818-101051-668_L1C_051-262-0_D_V1-0/SPOT4-HRVIR2-XS_20090818-101051-668_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090818-101051-668_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090818-101051-668_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T12:35:00.482    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:35:00.484    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090818-101051-668_L1C_051-262-0_D_V1-0.zip
2024-01-09T12:35:00.484    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:35:00.484    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:35:00.484    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:35:00.484    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:35:00.484    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:35:00.484    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:35:00.484    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:35:00.484    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090818-101051-668_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/18/SPOT4-HRVIR2-XS_20090818-101058-888_L1C_051-262-8_D_V1-0/SPOT4-HRVIR2-XS_20090818-101058-888_L1C_051-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090818-101058-888_L1C_051-262-8_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090818-101058-888_L1C_051-262-8_D_V1-0.zip
run script
2024-01-09T12:37:03.242    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:37:03.244    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090818-101058-888_L1C_051-262-8_D_V1-0.zip
2024-01-09T12:37:03.244    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:37:03.244    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:37:03.244    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:37:03.244    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:37:03.244    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:37:03.244    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:37:03.244    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:37:03.244    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090818-101058-888_L1C_051-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/18/SPOT4-HRVIR2-XS_20090818-101021-633_L1C_053-258-5_D_V1-0/SPOT4-HRVIR2-XS_20090818-101021-633_L1C_053-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090818-101021-633_L1C_053-258-5_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090818-101021-633_L1C_053-258-5_D_V1-0.zip
run script
2024-01-09T12:38:04.118    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:38:04.119    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090818-101021-633_L1C_053-258-5_D_V1-0.zip
2024-01-09T12:38:04.119    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:38:04.119    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:38:04.119    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:38:04.119    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:38:04.119    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:38:04.119    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:38:04.119    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:38:04.119    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090818-101021-633_L1C_053-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/18/SPOT4-HRVIR1-XS_20090818-101031-832_L1C_053-259-7_D_V1-0/SPOT4-HRVIR1-XS_20090818-101031-832_L1C_053-259-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090818-101031-832_L1C_053-259-7_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090818-101031-832_L1C_053-259-7_D_V1-0.zip
run script
2024-01-09T12:40:00.548    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:40:00.549    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090818-101031-832_L1C_053-259-7_D_V1-0.zip
2024-01-09T12:40:00.549    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:40:00.549    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:40:00.549    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:40:00.549    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:40:00.549    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:40:00.549    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:40:00.550    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:40:00.550    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:42:15.071    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 1034). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090818-101031-832_L1C_053-259-7_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/08/18/SPOT4-HRVIR2-XS_20090818-101025-360_L1C_053-259-0_D_V1-0/SPOT4-HRVIR2-XS_20090818-101025-360_L1C_053-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090818-101025-360_L1C_053-259-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090818-101025-360_L1C_053-259-0_D_V1-0.zip
run script
2024-01-09T12:42:19.053    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:42:19.054    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090818-101025-360_L1C_053-259-0_D_V1-0.zip
2024-01-09T12:42:19.054    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:42:19.054    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:42:19.054    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:42:19.054    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:42:19.054    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:42:19.054    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:42:19.054    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:42:19.054    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090818-101025-360_L1C_053-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/18/SPOT4-HRVIR1-XS_20090818-101033-763_L1C_053-260-0_D_V1-0/SPOT4-HRVIR1-XS_20090818-101033-763_L1C_053-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090818-101033-763_L1C_053-260-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090818-101033-763_L1C_053-260-0_D_V1-0.zip
run script
2024-01-09T12:44:30.267    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:44:30.269    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090818-101033-763_L1C_053-260-0_D_V1-0.zip
2024-01-09T12:44:30.269    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:44:30.269    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:44:30.269    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:44:30.269    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:44:30.269    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:44:30.269    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:44:30.269    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:44:30.269    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090818-101033-763_L1C_053-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/18/SPOT4-HRVIR1-XS_20090818-101042-020_L1C_053-261-0_D_V1-0/SPOT4-HRVIR1-XS_20090818-101042-020_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090818-101042-020_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090818-101042-020_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T12:46:44.949    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:46:44.951    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090818-101042-020_L1C_053-261-0_D_V1-0.zip
2024-01-09T12:46:44.951    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:46:44.951    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:46:44.951    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:46:44.951    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:46:44.951    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:46:44.951    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:46:44.951    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:46:44.951    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090818-101042-020_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/07/28/SPOT4-HRVIR1-XS_20090728-101457-636_L1C_051-262-2_D_V1-0/SPOT4-HRVIR1-XS_20090728-101457-636_L1C_051-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090728-101457-636_L1C_051-262-2_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090728-101457-636_L1C_051-262-2_D_V1-0.zip
run script
2024-01-09T12:49:23.645    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:49:23.646    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090728-101457-636_L1C_051-262-2_D_V1-0.zip
2024-01-09T12:49:23.646    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:49:23.647    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:49:23.647    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:49:23.647    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:49:23.647    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:49:23.647    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:49:23.647    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:49:23.647    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090728-101457-636_L1C_051-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/07/28/SPOT4-HRVIR1-XS_20090728-101502-144_L1C_051-262-7_D_V1-0/SPOT4-HRVIR1-XS_20090728-101502-144_L1C_051-262-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090728-101502-144_L1C_051-262-7_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090728-101502-144_L1C_051-262-7_D_V1-0.zip
run script
2024-01-09T12:50:40.343    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:50:40.344    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090728-101502-144_L1C_051-262-7_D_V1-0.zip
2024-01-09T12:50:40.344    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:50:40.344    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:50:40.344    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:50:40.344    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:50:40.344    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:50:40.344    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:50:40.344    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:50:40.344    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090728-101502-144_L1C_051-262-7_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/10/24/SPOT4-HRVIR2-XS_20091024-102134-372_L1C_051-262-5_D_V1-0/SPOT4-HRVIR2-XS_20091024-102134-372_L1C_051-262-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20091024-102134-372_L1C_051-262-5_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20091024-102134-372_L1C_051-262-5_D_V1-0.zip
run script
2024-01-09T12:51:24.093    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:51:24.094    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20091024-102134-372_L1C_051-262-5_D_V1-0.zip
2024-01-09T12:51:24.094    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:51:24.094    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:51:24.094    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:51:24.094    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:51:24.094    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:51:24.094    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:51:24.094    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:51:24.095    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20091024-102134-372_L1C_051-262-5_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/10/24/SPOT4-HRVIR2-XS_20091024-102136-177_L1C_051-262-7_D_V1-0/SPOT4-HRVIR2-XS_20091024-102136-177_L1C_051-262-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20091024-102136-177_L1C_051-262-7_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20091024-102136-177_L1C_051-262-7_D_V1-0.zip
run script
2024-01-09T12:52:22.350    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:52:22.351    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20091024-102136-177_L1C_051-262-7_D_V1-0.zip
2024-01-09T12:52:22.352    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:52:22.352    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:52:22.352    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:52:22.352    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:52:22.352    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:52:22.352    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:52:22.352    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:52:22.352    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20091024-102136-177_L1C_051-262-7_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/17/SPOT4-HRVIR2-XS_20090817-102945-276_L1C_053-258-9_D_V1-0/SPOT4-HRVIR2-XS_20090817-102945-276_L1C_053-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090817-102945-276_L1C_053-258-9_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090817-102945-276_L1C_053-258-9_D_V1-0.zip
run script
2024-01-09T12:53:08.168    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:53:08.169    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090817-102945-276_L1C_053-258-9_D_V1-0.zip
2024-01-09T12:53:08.169    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:53:08.169    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:53:08.169    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:53:08.169    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:53:08.170    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:53:08.170    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:53:08.170    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:53:08.170    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090817-102945-276_L1C_053-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [0 0 0 0]
 [0 0 0 0]
 [0 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/17/SPOT4-HRVIR2-XS_20090817-102945-483_L1C_053-259-0_D_V1-0/SPOT4-HRVIR2-XS_20090817-102945-483_L1C_053-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090817-102945-483_L1C_053-259-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090817-102945-483_L1C_053-259-0_D_V1-0.zip
run script
2024-01-09T12:55:05.467    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:55:05.468    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090817-102945-483_L1C_053-259-0_D_V1-0.zip
2024-01-09T12:55:05.468    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:55:05.468    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:55:05.468    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:55:05.468    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:55:05.468    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:55:05.468    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:55:05.468    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:55:05.468    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090817-102945-483_L1C_053-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/17/SPOT4-HRVIR2-XS_20090817-102953-818_L1C_053-260-0_D_V1-0/SPOT4-HRVIR2-XS_20090817-102953-818_L1C_053-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090817-102953-818_L1C_053-260-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090817-102953-818_L1C_053-260-0_D_V1-0.zip
run script
2024-01-09T12:57:03.987    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:57:03.988    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090817-102953-818_L1C_053-260-0_D_V1-0.zip
2024-01-09T12:57:03.988    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:57:03.988    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:57:03.988    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:57:03.988    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:57:03.988    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:57:03.988    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:57:03.989    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:57:03.989    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090817-102953-818_L1C_053-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/17/SPOT4-HRVIR2-XS_20090817-103002-159_L1C_053-261-0_D_V1-0/SPOT4-HRVIR2-XS_20090817-103002-159_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090817-103002-159_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090817-103002-159_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T12:59:04.781    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:59:04.782    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090817-103002-159_L1C_053-261-0_D_V1-0.zip
2024-01-09T12:59:04.782    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:59:04.782    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:59:04.783    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:59:04.783    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:59:04.783    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:59:04.783    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:59:04.783    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:59:04.783    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090817-103002-159_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/02/SPOT4-HRVIR1-XS_20090802-101826-530_L1C_053-260-0_D_V1-0/SPOT4-HRVIR1-XS_20090802-101826-530_L1C_053-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090802-101826-530_L1C_053-260-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090802-101826-530_L1C_053-260-0_D_V1-0.zip
run script
2024-01-09T13:01:35.701    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:01:35.702    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090802-101826-530_L1C_053-260-0_D_V1-0.zip
2024-01-09T13:01:35.702    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:01:35.702    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:01:35.702    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:01:35.702    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:01:35.702    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:01:35.702    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:01:35.702    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:01:35.702    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090802-101826-530_L1C_053-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/02/SPOT4-HRVIR1-XS_20090802-101834-809_L1C_053-261-0_D_V1-0/SPOT4-HRVIR1-XS_20090802-101834-809_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090802-101834-809_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090802-101834-809_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T13:03:32.316    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:03:32.317    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090802-101834-809_L1C_053-261-0_D_V1-0.zip
2024-01-09T13:03:32.317    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:03:32.317    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:03:32.319    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:03:32.319    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:03:32.319    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:03:32.319    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:03:32.319    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:03:32.319    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090802-101834-809_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/01/SPOT4-HRVIR1-XS_20090601-101132-691_L1C_053-261-0_D_V1-0/SPOT4-HRVIR1-XS_20090601-101132-691_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090601-101132-691_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090601-101132-691_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T13:06:02.800    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:06:02.801    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090601-101132-691_L1C_053-261-0_D_V1-0.zip
2024-01-09T13:06:02.801    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:06:02.802    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:06:02.802    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:06:02.802    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:06:02.802    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:06:02.802    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:06:02.802    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:06:02.802    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090601-101132-691_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/01/SPOT4-HRVIR1-XS_20090601-101143-664_L1C_053-262-3_D_V1-0/SPOT4-HRVIR1-XS_20090601-101143-664_L1C_053-262-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090601-101143-664_L1C_053-262-3_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090601-101143-664_L1C_053-262-3_D_V1-0.zip
run script
2024-01-09T13:08:44.993    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:08:44.994    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090601-101143-664_L1C_053-262-3_D_V1-0.zip
2024-01-09T13:08:44.994    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:08:44.995    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:08:44.995    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:08:44.995    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:08:44.995    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:08:44.995    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:08:44.995    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:08:44.995    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090601-101143-664_L1C_053-262-3_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/01/SPOT4-HRVIR2-XS_20090601-101143-141_L1C_054-262-4_D_V1-0/SPOT4-HRVIR2-XS_20090601-101143-141_L1C_054-262-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090601-101143-141_L1C_054-262-4_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090601-101143-141_L1C_054-262-4_D_V1-0.zip
run script
2024-01-09T13:10:59.603    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:10:59.604    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090601-101143-141_L1C_054-262-4_D_V1-0.zip
2024-01-09T13:10:59.604    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:10:59.604    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:10:59.605    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:10:59.605    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:10:59.605    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:10:59.605    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:10:59.605    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:10:59.605    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090601-101143-141_L1C_054-262-4_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/04/04/SPOT4-HRVIR1-XS_20090404-102728-643_L1C_054-260-7_D_V1-0/SPOT4-HRVIR1-XS_20090404-102728-643_L1C_054-260-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090404-102728-643_L1C_054-260-7_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090404-102728-643_L1C_054-260-7_D_V1-0.zip
run script
2024-01-09T13:12:18.762    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:12:18.763    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090404-102728-643_L1C_054-260-7_D_V1-0.zip
2024-01-09T13:12:18.763    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:12:18.763    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:12:18.764    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:12:18.764    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:12:18.764    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:12:18.764    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:12:18.764    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:12:18.764    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090404-102728-643_L1C_054-260-7_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/05/20/SPOT4-HRVIR1-XS_20090520-104230-389_L1C_054-260-7_D_V1-0/SPOT4-HRVIR1-XS_20090520-104230-389_L1C_054-260-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090520-104230-389_L1C_054-260-7_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090520-104230-389_L1C_054-260-7_D_V1-0.zip
run script
2024-01-09T13:13:49.358    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:13:49.359    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090520-104230-389_L1C_054-260-7_D_V1-0.zip
2024-01-09T13:13:49.359    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:13:49.359    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:13:49.359    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:13:49.359    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:13:49.359    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:13:49.359    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:13:49.359    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:13:49.359    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090520-104230-389_L1C_054-260-7_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 0 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/04/15/SPOT4-HRVIR2-XS_20090415-101548-628_L1C_055-260-8_D_V1-0/SPOT4-HRVIR2-XS_20090415-101548-628_L1C_055-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090415-101548-628_L1C_055-260-8_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090415-101548-628_L1C_055-260-8_D_V1-0.zip
run script
2024-01-09T13:15:40.803    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:15:40.805    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090415-101548-628_L1C_055-260-8_D_V1-0.zip
2024-01-09T13:15:40.805    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:15:40.805    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:15:40.805    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:15:40.805    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:15:40.805    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:15:40.805    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:15:40.805    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:15:40.805    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR2-XS_20090415-101548-628_L1C_055-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/05/27/SPOT4-HRVIR1-XS_20090527-100741-081_L1C_055-260-8_D_V1-0/SPOT4-HRVIR1-XS_20090527-100741-081_L1C_055-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090527-100741-081_L1C_055-260-8_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090527-100741-081_L1C_055-260-8_D_V1-0.zip
run script
2024-01-09T13:16:45.087    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:16:45.088    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090527-100741-081_L1C_055-260-8_D_V1-0.zip
2024-01-09T13:16:45.088    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:16:45.088    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:16:45.088    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:16:45.088    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:16:45.088    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:16:45.089    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:16:45.089    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:16:45.089    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090527-100741-081_L1C_055-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/07/18/SPOT4-HRVIR1-XS_20090718-100704-029_L1C_055-261-0_D_V1-0/SPOT4-HRVIR1-XS_20090718-100704-029_L1C_055-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090718-100704-029_L1C_055-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090718-100704-029_L1C_055-261-0_D_V1-0.zip
run script
2024-01-09T13:18:40.487    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:18:40.489    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090718-100704-029_L1C_055-261-0_D_V1-0.zip
2024-01-09T13:18:40.489    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:18:40.489    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:18:40.489    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:18:40.489    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:18:40.489    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:18:40.489    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:18:40.489    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:18:40.489    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090718-100704-029_L1C_055-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/07/18/SPOT4-HRVIR1-XS_20090718-100712-291_L1C_055-262-0_D_V1-0/SPOT4-HRVIR1-XS_20090718-100712-291_L1C_055-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090718-100712-291_L1C_055-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090718-100712-291_L1C_055-262-0_D_V1-0.zip
run script
2024-01-09T13:19:47.940    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:19:47.941    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090718-100712-291_L1C_055-262-0_D_V1-0.zip
2024-01-09T13:19:47.941    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:19:47.941    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:19:47.941    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:19:47.941    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:19:47.941    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:19:47.941    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:19:47.941    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:19:47.942    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090718-100712-291_L1C_055-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/07/18/SPOT4-HRVIR1-XS_20090718-100715-901_L1C_055-262-4_D_V1-0/SPOT4-HRVIR1-XS_20090718-100715-901_L1C_055-262-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090718-100715-901_L1C_055-262-4_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090718-100715-901_L1C_055-262-4_D_V1-0.zip
run script
2024-01-09T13:20:59.158    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:20:59.159    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090718-100715-901_L1C_055-262-4_D_V1-0.zip
2024-01-09T13:20:59.159    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:20:59.159    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:20:59.159    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:20:59.159    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:20:59.159    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:20:59.160    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:20:59.160    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:20:59.160    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT4-HRVIR1-XS_20090718-100715-901_L1C_055-262-4_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/03/29/SPOT2-HRV2-XS_19940329-104256-252_L1C_046-263-0_D_V1-0/SPOT2-HRV2-XS_19940329-104256-252_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940329-104256-252_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940329-104256-252_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T13:22:05.373    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:22:05.375    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940329-104256-252_L1C_046-263-0_D_V1-0.zip
2024-01-09T13:22:05.375    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:22:05.375    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:22:05.375    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:22:05.375    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:22:05.375    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:22:05.375    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:22:05.375    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:22:05.375    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940329-104256-252_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/03/29/SPOT2-HRV2-XS_19940329-104257-154_L1C_046-263-1_D_V1-0/SPOT2-HRV2-XS_19940329-104257-154_L1C_046-263-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940329-104257-154_L1C_046-263-1_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940329-104257-154_L1C_046-263-1_D_V1-0.zip
run script
2024-01-09T13:22:48.094    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:22:48.095    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940329-104257-154_L1C_046-263-1_D_V1-0.zip
2024-01-09T13:22:48.095    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:22:48.095    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:22:48.096    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:22:48.096    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:22:48.096    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:22:48.096    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:22:48.096    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:22:48.096    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940329-104257-154_L1C_046-263-1_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/05/14/SPOT2-HRV2-XS_19940514-105819-008_L1C_046-263-0_D_V1-0/SPOT2-HRV2-XS_19940514-105819-008_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940514-105819-008_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940514-105819-008_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T13:23:33.631    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:23:33.632    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940514-105819-008_L1C_046-263-0_D_V1-0.zip
2024-01-09T13:23:33.632    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:23:33.632    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:23:33.632    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:23:33.632    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:23:33.632    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:23:33.633    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:23:33.633    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:23:33.633    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940514-105819-008_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 0]
 [2 2 2 ... 2 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/07/27/SPOT2-HRV2-XS_19940727-103503-274_L1C_046-263-0_D_V1-0/SPOT2-HRV2-XS_19940727-103503-274_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940727-103503-274_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940727-103503-274_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T13:24:05.983    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:24:05.984    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940727-103503-274_L1C_046-263-0_D_V1-0.zip
2024-01-09T13:24:05.984    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:24:05.984    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:24:05.984    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:24:05.984    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:24:05.984    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:24:05.984    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:24:05.984    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:24:05.984    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940727-103503-274_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/01/26/SPOT2-HRV1-XS_19940126-103351-958_L1C_047-255-0_D_V1-0/SPOT2-HRV1-XS_19940126-103351-958_L1C_047-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940126-103351-958_L1C_047-255-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940126-103351-958_L1C_047-255-0_D_V1-0.zip
run script
2024-01-09T13:24:54.910    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:24:54.912    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940126-103351-958_L1C_047-255-0_D_V1-0.zip
2024-01-09T13:24:54.912    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:24:54.912    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:24:54.912    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:24:54.912    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:24:54.912    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:24:54.912    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:24:54.912    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:24:54.912    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940126-103351-958_L1C_047-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/01/26/SPOT2-HRV1-XS_19940126-103400-191_L1C_047-256-0_D_V1-0/SPOT2-HRV1-XS_19940126-103400-191_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940126-103400-191_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940126-103400-191_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T13:25:05.139    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:25:05.140    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940126-103400-191_L1C_047-256-0_D_V1-0.zip
2024-01-09T13:25:05.140    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:25:05.140    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:25:05.140    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:25:05.141    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:25:05.141    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:25:05.141    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:25:05.141    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:25:05.141    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T13:25:08.661    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (862 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940126-103400-191_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1994/01/26/SPOT2-HRV1-XS_19940126-103408-430_L1C_047-257-0_D_V1-0/SPOT2-HRV1-XS_19940126-103408-430_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940126-103408-430_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940126-103408-430_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T13:25:11.993    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:25:11.995    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940126-103408-430_L1C_047-257-0_D_V1-0.zip
2024-01-09T13:25:11.995    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:25:11.995    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:25:11.995    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:25:11.995    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:25:11.995    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:25:11.995    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:25:11.995    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:25:11.995    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940126-103408-430_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/01/26/SPOT2-HRV1-XS_19940126-103433-682_L1C_051-260-5_D_V1-0/SPOT2-HRV1-XS_19940126-103433-682_L1C_051-260-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940126-103433-682_L1C_051-260-5_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940126-103433-682_L1C_051-260-5_D_V1-0.zip
run script
2024-01-09T13:25:15.873    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:25:15.873    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940126-103433-682_L1C_051-260-5_D_V1-0.zip
2024-01-09T13:25:15.874    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:25:15.874    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:25:15.874    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:25:15.874    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:25:15.874    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:25:15.874    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:25:15.874    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:25:15.874    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940126-103433-682_L1C_051-260-5_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 1 ... 2 2 2]
 [0 0 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/01/26/SPOT2-HRV1-XS_19940126-103437-475_L1C_051-261-0_D_V1-0/SPOT2-HRV1-XS_19940126-103437-475_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940126-103437-475_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940126-103437-475_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T13:27:23.718    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:27:23.720    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940126-103437-475_L1C_051-261-0_D_V1-0.zip
2024-01-09T13:27:23.720    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:27:23.720    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:27:23.720    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:27:23.720    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:27:23.720    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:27:23.720    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:27:23.720    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:27:23.720    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940126-103437-475_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/01/26/SPOT2-HRV1-XS_19940126-103445-786_L1C_051-262-0_D_V1-0/SPOT2-HRV1-XS_19940126-103445-786_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940126-103445-786_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940126-103445-786_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T13:30:03.234    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:30:03.236    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940126-103445-786_L1C_051-262-0_D_V1-0.zip
2024-01-09T13:30:03.236    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:30:03.236    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:30:03.236    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:30:03.236    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:30:03.236    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:30:03.236    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:30:03.236    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:30:03.236    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940126-103445-786_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/01/26/SPOT2-HRV1-XS_19940126-103454-106_L1C_051-263-0_D_V1-0/SPOT2-HRV1-XS_19940126-103454-106_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940126-103454-106_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940126-103454-106_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T13:31:35.718    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:31:35.719    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940126-103454-106_L1C_051-263-0_D_V1-0.zip
2024-01-09T13:31:35.720    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:31:35.720    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:31:35.720    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:31:35.720    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:31:35.720    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:31:35.720    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:31:35.720    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:31:35.720    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940126-103454-106_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/02/26/SPOT2-HRV1-XS_19940226-103750-358_L1C_047-255-0_D_V1-0/SPOT2-HRV1-XS_19940226-103750-358_L1C_047-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940226-103750-358_L1C_047-255-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940226-103750-358_L1C_047-255-0_D_V1-0.zip
run script
2024-01-09T13:32:14.670    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:32:14.671    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940226-103750-358_L1C_047-255-0_D_V1-0.zip
2024-01-09T13:32:14.671    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:32:14.671    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:32:14.671    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:32:14.671    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:32:14.671    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:32:14.671    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:32:14.671    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:32:14.671    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940226-103750-358_L1C_047-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/02/26/SPOT2-HRV1-XS_19940226-103758-606_L1C_047-256-0_D_V1-0/SPOT2-HRV1-XS_19940226-103758-606_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940226-103758-606_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940226-103758-606_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T13:32:24.399    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:32:24.400    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940226-103758-606_L1C_047-256-0_D_V1-0.zip
2024-01-09T13:32:24.400    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:32:24.400    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:32:24.400    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:32:24.400    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:32:24.401    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:32:24.401    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:32:24.401    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:32:24.401    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T13:32:27.585    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (862 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940226-103758-606_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1994/02/26/SPOT2-HRV1-XS_19940226-103832-681_L1C_051-260-6_D_V1-0/SPOT2-HRV1-XS_19940226-103832-681_L1C_051-260-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940226-103832-681_L1C_051-260-6_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940226-103832-681_L1C_051-260-6_D_V1-0.zip
run script
2024-01-09T13:32:30.745    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:32:30.747    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940226-103832-681_L1C_051-260-6_D_V1-0.zip
2024-01-09T13:32:30.747    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:32:30.747    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:32:30.747    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:32:30.747    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:32:30.747    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:32:30.747    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:32:30.747    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:32:30.747    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940226-103832-681_L1C_051-260-6_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/02/26/SPOT2-HRV1-XS_19940226-103835-590_L1C_051-261-0_D_V1-0/SPOT2-HRV1-XS_19940226-103835-590_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940226-103835-590_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940226-103835-590_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T13:34:37.772    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:34:37.773    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940226-103835-590_L1C_051-261-0_D_V1-0.zip
2024-01-09T13:34:37.773    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:34:37.773    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:34:37.773    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:34:37.773    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:34:37.773    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:34:37.773    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:34:37.773    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:34:37.773    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940226-103835-590_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/02/26/SPOT2-HRV1-XS_19940226-103843-919_L1C_051-262-0_D_V1-0/SPOT2-HRV1-XS_19940226-103843-919_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940226-103843-919_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940226-103843-919_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T13:37:40.669    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:37:40.670    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940226-103843-919_L1C_051-262-0_D_V1-0.zip
2024-01-09T13:37:40.670    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:37:40.670    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:37:40.671    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:37:40.671    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:37:40.671    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:37:40.671    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:37:40.671    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:37:40.671    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940226-103843-919_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/02/26/SPOT2-HRV1-XS_19940226-103852-257_L1C_051-263-0_D_V1-0/SPOT2-HRV1-XS_19940226-103852-257_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940226-103852-257_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940226-103852-257_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T13:39:12.387    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:39:12.388    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940226-103852-257_L1C_051-263-0_D_V1-0.zip
2024-01-09T13:39:12.389    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:39:12.389    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:39:12.389    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:39:12.389    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:39:12.389    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:39:12.389    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:39:12.389    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:39:12.389    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940226-103852-257_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/03/08/SPOT2-HRV2-XS_19940308-104540-451_L1C_047-255-5_D_V1-0/SPOT2-HRV2-XS_19940308-104540-451_L1C_047-255-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940308-104540-451_L1C_047-255-5_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940308-104540-451_L1C_047-255-5_D_V1-0.zip
run script
2024-01-09T13:39:52.080    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:39:52.081    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940308-104540-451_L1C_047-255-5_D_V1-0.zip
2024-01-09T13:39:52.081    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:39:52.081    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:39:52.082    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:39:52.082    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:39:52.082    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:39:52.082    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:39:52.082    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:39:52.082    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T13:39:54.211    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (163 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940308-104540-451_L1C_047-255-5_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1994/03/08/SPOT2-HRV2-XS_19940308-104544-226_L1C_047-256-0_D_V1-0/SPOT2-HRV2-XS_19940308-104544-226_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940308-104544-226_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940308-104544-226_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T13:39:57.387    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:39:57.387    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940308-104544-226_L1C_047-256-0_D_V1-0.zip
2024-01-09T13:39:57.387    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:39:57.387    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:39:57.387    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:39:57.388    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:39:57.388    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:39:57.388    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:39:57.388    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:39:57.388    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940308-104544-226_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/03/08/SPOT2-HRV2-XS_19940308-104552-519_L1C_047-257-0_D_V1-0/SPOT2-HRV2-XS_19940308-104552-519_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940308-104552-519_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940308-104552-519_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T13:40:00.730    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:40:00.731    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940308-104552-519_L1C_047-257-0_D_V1-0.zip
2024-01-09T13:40:00.731    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:40:00.731    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:40:00.731    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:40:00.731    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:40:00.731    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:40:00.731    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:40:00.731    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:40:00.731    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940308-104552-519_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/03/09/SPOT2-HRV1-XS_19940309-102621-089_L1C_047-255-5_D_V1-0/SPOT2-HRV1-XS_19940309-102621-089_L1C_047-255-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940309-102621-089_L1C_047-255-5_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940309-102621-089_L1C_047-255-5_D_V1-0.zip
run script
2024-01-09T13:40:04.015    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:40:04.016    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940309-102621-089_L1C_047-255-5_D_V1-0.zip
2024-01-09T13:40:04.016    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:40:04.016    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:40:04.016    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:40:04.016    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:40:04.016    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:40:04.016    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:40:04.016    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:40:04.016    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940309-102621-089_L1C_047-255-5_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/03/09/SPOT2-HRV1-XS_19940309-102624-777_L1C_047-256-0_D_V1-0/SPOT2-HRV1-XS_19940309-102624-777_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940309-102624-777_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940309-102624-777_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T13:40:07.970    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:40:07.971    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940309-102624-777_L1C_047-256-0_D_V1-0.zip
2024-01-09T13:40:07.971    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:40:07.971    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:40:07.971    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:40:07.971    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:40:07.971    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:40:07.971    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:40:07.971    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:40:07.971    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940309-102624-777_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/03/09/SPOT2-HRV1-XS_19940309-102632-985_L1C_047-257-0_D_V1-0/SPOT2-HRV1-XS_19940309-102632-985_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940309-102632-985_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940309-102632-985_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T13:40:11.820    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:40:11.821    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940309-102632-985_L1C_047-257-0_D_V1-0.zip
2024-01-09T13:40:11.821    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:40:11.821    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:40:11.821    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:40:11.821    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:40:11.821    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:40:11.822    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:40:11.822    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:40:11.822    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940309-102632-985_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/03/09/SPOT2-HRV1-XS_19940309-102641-203_L1C_047-258-0_D_V1-0/SPOT2-HRV1-XS_19940309-102641-203_L1C_047-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940309-102641-203_L1C_047-258-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940309-102641-203_L1C_047-258-0_D_V1-0.zip
run script
2024-01-09T13:40:15.197    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:40:15.198    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940309-102641-203_L1C_047-258-0_D_V1-0.zip
2024-01-09T13:40:15.198    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:40:15.198    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:40:15.198    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:40:15.198    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:40:15.198    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:40:15.198    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:40:15.199    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:40:15.199    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940309-102641-203_L1C_047-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/03/09/SPOT2-HRV1-XS_19940309-102652-140_L1C_047-259-3_D_V1-0/SPOT2-HRV1-XS_19940309-102652-140_L1C_047-259-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940309-102652-140_L1C_047-259-3_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940309-102652-140_L1C_047-259-3_D_V1-0.zip
run script
2024-01-09T13:40:18.604    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:40:18.605    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940309-102652-140_L1C_047-259-3_D_V1-0.zip
2024-01-09T13:40:18.605    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:40:18.606    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:40:18.606    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:40:18.606    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:40:18.606    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:40:18.606    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:40:18.606    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:40:18.606    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940309-102652-140_L1C_047-259-3_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/07/05/SPOT2-HRV2-XS_19940705-105704-602_L1C_047-255-0_D_V1-0/SPOT2-HRV2-XS_19940705-105704-602_L1C_047-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940705-105704-602_L1C_047-255-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940705-105704-602_L1C_047-255-0_D_V1-0.zip
run script
2024-01-09T13:40:21.818    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:40:21.819    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940705-105704-602_L1C_047-255-0_D_V1-0.zip
2024-01-09T13:40:21.819    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:40:21.819    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:40:21.819    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:40:21.819    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:40:21.819    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:40:21.819    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:40:21.819    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:40:21.819    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940705-105704-602_L1C_047-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/07/05/SPOT2-HRV2-XS_19940705-105712-967_L1C_047-256-0_D_V1-0/SPOT2-HRV2-XS_19940705-105712-967_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940705-105712-967_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940705-105712-967_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T13:40:30.280    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:40:30.281    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940705-105712-967_L1C_047-256-0_D_V1-0.zip
2024-01-09T13:40:30.281    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:40:30.281    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:40:30.281    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:40:30.281    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:40:30.281    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:40:30.281    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:40:30.281    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:40:30.281    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940705-105712-967_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/07/05/SPOT2-HRV2-XS_19940705-105755-554_L1C_049-261-4_D_V1-0/SPOT2-HRV2-XS_19940705-105755-554_L1C_049-261-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940705-105755-554_L1C_049-261-4_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940705-105755-554_L1C_049-261-4_D_V1-0.zip
run script
2024-01-09T13:40:33.542    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:40:33.543    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940705-105755-554_L1C_049-261-4_D_V1-0.zip
2024-01-09T13:40:33.543    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:40:33.543    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:40:33.543    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:40:33.543    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:40:33.543    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:40:33.543    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:40:33.543    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:40:33.543    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940705-105755-554_L1C_049-261-4_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/07/05/SPOT2-HRV2-XS_19940705-105800-370_L1C_049-262-0_D_V1-0/SPOT2-HRV2-XS_19940705-105800-370_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940705-105800-370_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940705-105800-370_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T13:40:36.858    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:40:36.859    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940705-105800-370_L1C_049-262-0_D_V1-0.zip
2024-01-09T13:40:36.859    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:40:36.859    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:40:36.859    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:40:36.859    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:40:36.859    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:40:36.859    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:40:36.859    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:40:36.859    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940705-105800-370_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/04/23/SPOT2-HRV2-XS_19940423-110111-700_L1C_047-256-0_D_V1-0/SPOT2-HRV2-XS_19940423-110111-700_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940423-110111-700_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940423-110111-700_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T13:40:40.418    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:40:40.418    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940423-110111-700_L1C_047-256-0_D_V1-0.zip
2024-01-09T13:40:40.418    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:40:40.418    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:40:40.418    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:40:40.418    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:40:40.418    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:40:40.419    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:40:40.419    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:40:40.419    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940423-110111-700_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/04/23/SPOT2-HRV2-XS_19940423-110120-108_L1C_047-257-0_D_V1-0/SPOT2-HRV2-XS_19940423-110120-108_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940423-110120-108_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940423-110120-108_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T13:41:01.722    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:41:01.723    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940423-110120-108_L1C_047-257-0_D_V1-0.zip
2024-01-09T13:41:01.723    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:41:01.723    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:41:01.723    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:41:01.723    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:41:01.723    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:41:01.723    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:41:01.723    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:41:01.723    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940423-110120-108_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/04/23/SPOT2-HRV2-XS_19940423-110128-521_L1C_047-258-0_D_V1-0/SPOT2-HRV2-XS_19940423-110128-521_L1C_047-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940423-110128-521_L1C_047-258-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940423-110128-521_L1C_047-258-0_D_V1-0.zip
run script
2024-01-09T13:41:04.863    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:41:04.864    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940423-110128-521_L1C_047-258-0_D_V1-0.zip
2024-01-09T13:41:04.864    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:41:04.864    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:41:04.864    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:41:04.864    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:41:04.864    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:41:04.864    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:41:04.865    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:41:04.865    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940423-110128-521_L1C_047-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/04/23/SPOT2-HRV2-XS_19940423-110132-131_L1C_047-258-4_D_V1-0/SPOT2-HRV2-XS_19940423-110132-131_L1C_047-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940423-110132-131_L1C_047-258-4_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940423-110132-131_L1C_047-258-4_D_V1-0.zip
run script
2024-01-09T13:41:08.793    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:41:08.795    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940423-110132-131_L1C_047-258-4_D_V1-0.zip
2024-01-09T13:41:08.795    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:41:08.795    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:41:08.795    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:41:08.795    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:41:08.795    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:41:08.795    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:41:08.795    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:41:08.795    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940423-110132-131_L1C_047-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/04/23/SPOT2-HRV2-XS_19940423-110103-022_L1C_048-254-9_D_V1-0/SPOT2-HRV2-XS_19940423-110103-022_L1C_048-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940423-110103-022_L1C_048-254-9_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940423-110103-022_L1C_048-254-9_D_V1-0.zip
run script
2024-01-09T13:41:12.040    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:41:12.041    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940423-110103-022_L1C_048-254-9_D_V1-0.zip
2024-01-09T13:41:12.041    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:41:12.041    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:41:12.041    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:41:12.041    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:41:12.041    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:41:12.041    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:41:12.041    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:41:12.041    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940423-110103-022_L1C_048-254-9_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/04/23/SPOT2-HRV2-XS_19940423-110103-296_L1C_048-255-0_D_V1-0/SPOT2-HRV2-XS_19940423-110103-296_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940423-110103-296_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940423-110103-296_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T13:41:28.080    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:41:28.081    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940423-110103-296_L1C_048-255-0_D_V1-0.zip
2024-01-09T13:41:28.081    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:41:28.082    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:41:28.082    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:41:28.082    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:41:28.082    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:41:28.082    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:41:28.082    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:41:28.082    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940423-110103-296_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/03/02/SPOT2-HRV1-XS_19940302-110117-520_L1C_047-257-1_D_V1-0/SPOT2-HRV1-XS_19940302-110117-520_L1C_047-257-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940302-110117-520_L1C_047-257-1_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940302-110117-520_L1C_047-257-1_D_V1-0.zip
run script
2024-01-09T13:41:45.174    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:41:45.175    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940302-110117-520_L1C_047-257-1_D_V1-0.zip
2024-01-09T13:41:45.175    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:41:45.175    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:41:45.175    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:41:45.175    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:41:45.175    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:41:45.176    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:41:45.176    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:41:45.176    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940302-110117-520_L1C_047-257-1_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/04/30/SPOT2-HRV1-XS_19940430-102616-058_L1C_048-254-9_D_V1-0/SPOT2-HRV1-XS_19940430-102616-058_L1C_048-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940430-102616-058_L1C_048-254-9_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940430-102616-058_L1C_048-254-9_D_V1-0.zip
run script
2024-01-09T13:41:48.819    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:41:48.820    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940430-102616-058_L1C_048-254-9_D_V1-0.zip
2024-01-09T13:41:48.820    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:41:48.820    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:41:48.820    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:41:48.820    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:41:48.820    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:41:48.820    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:41:48.820    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:41:48.821    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940430-102616-058_L1C_048-254-9_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/04/30/SPOT2-HRV1-XS_19940430-102616-130_L1C_048-255-0_D_V1-0/SPOT2-HRV1-XS_19940430-102616-130_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940430-102616-130_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940430-102616-130_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T13:42:05.406    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:42:05.407    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940430-102616-130_L1C_048-255-0_D_V1-0.zip
2024-01-09T13:42:05.407    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:42:05.407    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:42:05.407    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:42:05.407    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:42:05.407    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:42:05.408    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:42:05.408    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:42:05.408    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940430-102616-130_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/04/30/SPOT2-HRV1-XS_19940430-102624-333_L1C_048-256-0_D_V1-0/SPOT2-HRV1-XS_19940430-102624-333_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940430-102624-333_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940430-102624-333_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T13:42:22.271    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:42:22.273    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940430-102624-333_L1C_048-256-0_D_V1-0.zip
2024-01-09T13:42:22.273    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:42:22.273    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:42:22.273    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:42:22.273    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:42:22.274    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:42:22.274    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:42:22.274    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:42:22.274    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940430-102624-333_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/04/30/SPOT2-HRV1-XS_19940430-102630-650_L1C_048-256-7_D_V1-0/SPOT2-HRV1-XS_19940430-102630-650_L1C_048-256-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940430-102630-650_L1C_048-256-7_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940430-102630-650_L1C_048-256-7_D_V1-0.zip
run script
2024-01-09T13:42:53.633    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:42:53.634    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940430-102630-650_L1C_048-256-7_D_V1-0.zip
2024-01-09T13:42:53.634    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:42:53.635    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:42:53.635    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:42:53.635    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:42:53.635    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:42:53.635    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:42:53.635    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:42:53.635    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940430-102630-650_L1C_048-256-7_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/07/01/SPOT2-HRV1-XS_19940701-103345-088_L1C_048-254-0_D_V1-0/SPOT2-HRV1-XS_19940701-103345-088_L1C_048-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940701-103345-088_L1C_048-254-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940701-103345-088_L1C_048-254-0_D_V1-0.zip
run script
2024-01-09T13:43:18.205    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:43:18.207    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940701-103345-088_L1C_048-254-0_D_V1-0.zip
2024-01-09T13:43:18.207    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:43:18.207    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:43:18.207    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:43:18.207    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:43:18.207    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:43:18.207    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:43:18.207    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:43:18.208    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940701-103345-088_L1C_048-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/07/01/SPOT2-HRV1-XS_19940701-103353-312_L1C_048-255-0_D_V1-0/SPOT2-HRV1-XS_19940701-103353-312_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940701-103353-312_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940701-103353-312_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T13:43:21.791    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:43:21.792    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940701-103353-312_L1C_048-255-0_D_V1-0.zip
2024-01-09T13:43:21.792    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:43:21.792    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:43:21.792    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:43:21.792    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:43:21.793    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:43:21.793    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:43:21.793    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:43:21.793    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940701-103353-312_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/07/01/SPOT2-HRV1-XS_19940701-103401-545_L1C_048-256-0_D_V1-0/SPOT2-HRV1-XS_19940701-103401-545_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940701-103401-545_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940701-103401-545_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T13:43:38.637    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:43:38.638    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940701-103401-545_L1C_048-256-0_D_V1-0.zip
2024-01-09T13:43:38.638    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:43:38.638    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:43:38.638    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:43:38.638    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:43:38.638    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:43:38.638    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:43:38.638    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:43:38.638    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940701-103401-545_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/07/01/SPOT2-HRV1-XS_19940701-103404-252_L1C_048-256-3_D_V1-0/SPOT2-HRV1-XS_19940701-103404-252_L1C_048-256-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940701-103404-252_L1C_048-256-3_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940701-103404-252_L1C_048-256-3_D_V1-0.zip
run script
2024-01-09T13:44:09.923    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:44:09.924    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940701-103404-252_L1C_048-256-3_D_V1-0.zip
2024-01-09T13:44:09.924    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:44:09.924    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:44:09.924    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:44:09.924    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:44:09.924    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:44:09.924    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:44:09.925    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:44:09.925    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940701-103404-252_L1C_048-256-3_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/07/01/SPOT2-HRV2-XS_19940701-103423-395_L1C_049-258-7_D_V1-0/SPOT2-HRV2-XS_19940701-103423-395_L1C_049-258-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940701-103423-395_L1C_049-258-7_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940701-103423-395_L1C_049-258-7_D_V1-0.zip
run script
2024-01-09T13:44:36.701    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:44:36.702    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940701-103423-395_L1C_049-258-7_D_V1-0.zip
2024-01-09T13:44:36.702    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:44:36.702    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:44:36.702    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:44:36.702    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:44:36.702    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:44:36.702    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:44:36.702    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:44:36.702    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940701-103423-395_L1C_049-258-7_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/07/01/SPOT2-HRV2-XS_19940701-103425-344_L1C_049-259-0_D_V1-0/SPOT2-HRV2-XS_19940701-103425-344_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940701-103425-344_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940701-103425-344_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T13:45:14.345    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:45:14.346    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940701-103425-344_L1C_049-259-0_D_V1-0.zip
2024-01-09T13:45:14.347    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:45:14.347    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:45:14.347    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:45:14.347    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:45:14.347    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:45:14.347    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:45:14.347    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:45:14.347    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940701-103425-344_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/07/01/SPOT2-HRV2-XS_19940701-103433-619_L1C_049-260-0_D_V1-0/SPOT2-HRV2-XS_19940701-103433-619_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940701-103433-619_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940701-103433-619_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T13:45:48.843    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:45:48.844    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940701-103433-619_L1C_049-260-0_D_V1-0.zip
2024-01-09T13:45:48.844    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:45:48.844    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:45:48.844    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:45:48.844    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:45:48.844    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:45:48.844    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:45:48.844    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:45:48.844    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940701-103433-619_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/07/01/SPOT2-HRV2-XS_19940701-103441-903_L1C_049-261-0_D_V1-0/SPOT2-HRV2-XS_19940701-103441-903_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940701-103441-903_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940701-103441-903_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T13:46:05.729    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:46:05.731    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940701-103441-903_L1C_049-261-0_D_V1-0.zip
2024-01-09T13:46:05.731    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:46:05.731    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:46:05.731    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:46:05.731    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:46:05.731    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:46:05.731    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:46:05.731    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:46:05.731    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940701-103441-903_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/07/01/SPOT2-HRV2-XS_19940701-103450-193_L1C_049-262-0_D_V1-0/SPOT2-HRV2-XS_19940701-103450-193_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940701-103450-193_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940701-103450-193_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T13:46:10.142    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:46:10.143    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940701-103450-193_L1C_049-262-0_D_V1-0.zip
2024-01-09T13:46:10.143    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:46:10.143    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:46:10.144    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:46:10.144    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:46:10.144    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:46:10.144    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:46:10.144    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:46:10.144    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940701-103450-193_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/07/01/SPOT2-HRV2-XS_19940701-103341-554_L1C_051-254-0_D_V1-0/SPOT2-HRV2-XS_19940701-103341-554_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940701-103341-554_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940701-103341-554_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T13:46:14.186    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:46:14.187    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940701-103341-554_L1C_051-254-0_D_V1-0.zip
2024-01-09T13:46:14.188    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:46:14.188    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:46:14.188    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:46:14.188    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:46:14.188    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:46:14.188    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:46:14.188    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:46:14.188    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940701-103341-554_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/07/01/SPOT2-HRV2-XS_19940701-103349-805_L1C_051-255-0_D_V1-0/SPOT2-HRV2-XS_19940701-103349-805_L1C_051-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940701-103349-805_L1C_051-255-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940701-103349-805_L1C_051-255-0_D_V1-0.zip
run script
2024-01-09T13:46:17.994    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:46:17.995    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940701-103349-805_L1C_051-255-0_D_V1-0.zip
2024-01-09T13:46:17.995    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:46:17.996    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:46:17.996    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:46:17.996    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:46:17.996    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:46:17.996    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:46:17.996    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:46:17.996    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940701-103349-805_L1C_051-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/07/01/SPOT2-HRV2-XS_19940701-103404-381_L1C_051-256-7_D_V1-0/SPOT2-HRV2-XS_19940701-103404-381_L1C_051-256-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940701-103404-381_L1C_051-256-7_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940701-103404-381_L1C_051-256-7_D_V1-0.zip
run script
2024-01-09T13:47:03.862    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:47:03.863    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940701-103404-381_L1C_051-256-7_D_V1-0.zip
2024-01-09T13:47:03.863    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:47:03.863    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:47:03.863    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:47:03.863    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:47:03.864    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:47:03.864    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:47:03.864    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:47:03.864    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940701-103404-381_L1C_051-256-7_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 1]
 [2 2 2 ... 0 0 1]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/03/24/SPOT2-HRV2-XS_19940324-103759-708_L1C_048-255-6_D_V1-0/SPOT2-HRV2-XS_19940324-103759-708_L1C_048-255-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940324-103759-708_L1C_048-255-6_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940324-103759-708_L1C_048-255-6_D_V1-0.zip
run script
2024-01-09T13:50:05.928    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:50:05.929    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940324-103759-708_L1C_048-255-6_D_V1-0.zip
2024-01-09T13:50:05.929    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:50:05.929    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:50:05.929    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:50:05.929    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:50:05.929    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:50:05.929    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:50:05.929    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:50:05.929    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940324-103759-708_L1C_048-255-6_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/03/24/SPOT2-HRV2-XS_19940324-103802-548_L1C_048-256-0_D_V1-0/SPOT2-HRV2-XS_19940324-103802-548_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940324-103802-548_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940324-103802-548_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T13:50:56.203    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:50:56.204    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940324-103802-548_L1C_048-256-0_D_V1-0.zip
2024-01-09T13:50:56.204    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:50:56.204    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:50:56.204    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:50:56.204    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:50:56.204    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:50:56.204    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:50:56.204    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:50:56.204    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940324-103802-548_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/03/24/SPOT2-HRV2-XS_19940324-103807-060_L1C_048-256-5_D_V1-0/SPOT2-HRV2-XS_19940324-103807-060_L1C_048-256-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940324-103807-060_L1C_048-256-5_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940324-103807-060_L1C_048-256-5_D_V1-0.zip
run script
2024-01-09T13:51:56.569    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:51:56.570    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940324-103807-060_L1C_048-256-5_D_V1-0.zip
2024-01-09T13:51:56.570    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:51:56.570    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:51:56.570    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:51:56.570    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:51:56.570    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:51:56.570    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:51:56.571    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:51:56.571    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940324-103807-060_L1C_048-256-5_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/03/24/SPOT2-HRV2-XS_19940324-103826-028_L1C_049-258-8_D_V1-0/SPOT2-HRV2-XS_19940324-103826-028_L1C_049-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940324-103826-028_L1C_049-258-8_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940324-103826-028_L1C_049-258-8_D_V1-0.zip
run script
2024-01-09T13:52:50.907    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:52:50.908    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940324-103826-028_L1C_049-258-8_D_V1-0.zip
2024-01-09T13:52:50.908    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:52:50.908    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:52:50.908    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:52:50.908    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:52:50.908    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:52:50.909    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:52:50.909    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:52:50.909    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940324-103826-028_L1C_049-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/03/24/SPOT2-HRV2-XS_19940324-103827-090_L1C_049-259-0_D_V1-0/SPOT2-HRV2-XS_19940324-103827-090_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940324-103827-090_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940324-103827-090_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T13:53:25.098    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:53:25.099    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940324-103827-090_L1C_049-259-0_D_V1-0.zip
2024-01-09T13:53:25.099    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:53:25.099    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:53:25.099    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:53:25.099    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:53:25.099    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:53:25.099    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:53:25.100    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:53:25.100    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940324-103827-090_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [2 1 1 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/03/24/SPOT2-HRV2-XS_19940324-103835-380_L1C_049-260-0_D_V1-0/SPOT2-HRV2-XS_19940324-103835-380_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940324-103835-380_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940324-103835-380_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T13:53:55.037    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:53:55.038    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940324-103835-380_L1C_049-260-0_D_V1-0.zip
2024-01-09T13:53:55.038    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:53:55.038    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:53:55.038    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:53:55.038    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:53:55.038    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:53:55.038    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:53:55.038    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:53:55.038    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940324-103835-380_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/03/24/SPOT2-HRV2-XS_19940324-103843-679_L1C_049-261-0_D_V1-0/SPOT2-HRV2-XS_19940324-103843-679_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940324-103843-679_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940324-103843-679_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T13:54:07.198    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:54:07.199    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940324-103843-679_L1C_049-261-0_D_V1-0.zip
2024-01-09T13:54:07.199    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:54:07.199    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:54:07.199    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:54:07.199    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:54:07.199    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:54:07.199    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:54:07.199    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:54:07.199    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940324-103843-679_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/03/24/SPOT2-HRV2-XS_19940324-103851-987_L1C_049-262-0_D_V1-0/SPOT2-HRV2-XS_19940324-103851-987_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940324-103851-987_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940324-103851-987_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T13:54:10.750    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:54:10.751    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940324-103851-987_L1C_049-262-0_D_V1-0.zip
2024-01-09T13:54:10.751    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:54:10.751    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:54:10.751    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:54:10.751    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:54:10.751    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:54:10.751    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:54:10.751    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:54:10.751    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940324-103851-987_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/10/03/SPOT2-HRV1-XS_19941003-102638-182_L1C_048-260-0_D_V1-0/SPOT2-HRV1-XS_19941003-102638-182_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19941003-102638-182_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941003-102638-182_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T13:54:14.368    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:54:14.369    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941003-102638-182_L1C_048-260-0_D_V1-0.zip
2024-01-09T13:54:14.370    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:54:14.370    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:54:14.370    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:54:14.370    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:54:14.370    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:54:14.370    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:54:14.370    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:54:14.370    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941003-102638-182_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/10/03/SPOT2-HRV1-XS_19941003-102646-433_L1C_048-261-0_D_V1-0/SPOT2-HRV1-XS_19941003-102646-433_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19941003-102646-433_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941003-102646-433_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T13:54:17.995    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:54:17.996    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941003-102646-433_L1C_048-261-0_D_V1-0.zip
2024-01-09T13:54:17.997    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:54:17.997    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:54:17.997    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:54:17.997    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:54:17.997    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:54:17.997    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:54:17.997    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:54:17.997    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941003-102646-433_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/01/21/SPOT2-HRV2-XS_19940121-102947-754_L1C_049-254-0_D_V1-0/SPOT2-HRV2-XS_19940121-102947-754_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940121-102947-754_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940121-102947-754_L1C_049-254-0_D_V1-0.zip
run script
2024-01-09T13:54:21.259    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:54:21.260    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940121-102947-754_L1C_049-254-0_D_V1-0.zip
2024-01-09T13:54:21.260    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:54:21.260    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:54:21.260    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:54:21.261    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:54:21.261    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:54:21.261    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:54:21.261    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:54:21.261    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940121-102947-754_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/01/21/SPOT2-HRV2-XS_19940121-102955-972_L1C_049-255-0_D_V1-0/SPOT2-HRV2-XS_19940121-102955-972_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940121-102955-972_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940121-102955-972_L1C_049-255-0_D_V1-0.zip
run script
2024-01-09T13:54:24.764    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:54:24.765    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940121-102955-972_L1C_049-255-0_D_V1-0.zip
2024-01-09T13:54:24.765    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:54:24.765    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:54:24.766    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:54:24.766    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:54:24.766    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:54:24.766    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:54:24.766    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:54:24.766    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940121-102955-972_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/01/21/SPOT2-HRV2-XS_19940121-103004-199_L1C_049-256-0_D_V1-0/SPOT2-HRV2-XS_19940121-103004-199_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940121-103004-199_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940121-103004-199_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T13:55:06.451    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:55:06.452    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940121-103004-199_L1C_049-256-0_D_V1-0.zip
2024-01-09T13:55:06.452    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:55:06.452    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:55:06.452    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:55:06.452    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:55:06.452    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:55:06.453    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:55:06.453    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:55:06.453    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940121-103004-199_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/01/21/SPOT2-HRV2-XS_19940121-103011-418_L1C_049-256-8_D_V1-0/SPOT2-HRV2-XS_19940121-103011-418_L1C_049-256-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940121-103011-418_L1C_049-256-8_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940121-103011-418_L1C_049-256-8_D_V1-0.zip
run script
2024-01-09T13:56:44.953    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:56:44.954    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940121-103011-418_L1C_049-256-8_D_V1-0.zip
2024-01-09T13:56:44.954    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:56:44.954    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:56:44.954    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:56:44.954    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:56:44.954    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:56:44.954    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:56:44.954    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:56:44.954    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940121-103011-418_L1C_049-256-8_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/01/21/SPOT2-HRV2-XS_19940121-103031-301_L1C_051-259-5_D_V1-0/SPOT2-HRV2-XS_19940121-103031-301_L1C_051-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940121-103031-301_L1C_051-259-5_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940121-103031-301_L1C_051-259-5_D_V1-0.zip
run script
2024-01-09T13:58:08.694    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:58:08.695    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940121-103031-301_L1C_051-259-5_D_V1-0.zip
2024-01-09T13:58:08.695    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:58:08.695    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:58:08.696    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:58:08.696    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:58:08.696    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:58:08.696    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:58:08.696    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:58:08.696    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940121-103031-301_L1C_051-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/01/21/SPOT2-HRV2-XS_19940121-103035-070_L1C_051-260-0_D_V1-0/SPOT2-HRV2-XS_19940121-103035-070_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940121-103035-070_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940121-103035-070_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T14:00:44.142    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:00:44.143    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940121-103035-070_L1C_051-260-0_D_V1-0.zip
2024-01-09T14:00:44.143    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:00:44.143    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:00:44.143    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:00:44.143    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:00:44.144    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:00:44.144    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:00:44.144    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:00:44.144    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940121-103035-070_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/01/21/SPOT2-HRV2-XS_19940121-103043-357_L1C_051-261-0_D_V1-0/SPOT2-HRV2-XS_19940121-103043-357_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940121-103043-357_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940121-103043-357_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T14:02:51.490    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:02:51.524    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940121-103043-357_L1C_051-261-0_D_V1-0.zip
2024-01-09T14:02:51.524    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:02:51.524    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:02:51.525    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:02:51.525    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:02:51.525    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:02:51.525    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:02:51.525    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:02:51.525    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940121-103043-357_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [2 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/01/21/SPOT2-HRV2-XS_19940121-103051-653_L1C_051-262-0_D_V1-0/SPOT2-HRV2-XS_19940121-103051-653_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940121-103051-653_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940121-103051-653_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T14:04:55.873    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:04:55.874    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940121-103051-653_L1C_051-262-0_D_V1-0.zip
2024-01-09T14:04:55.874    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:04:55.874    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:04:55.875    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:04:55.875    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:04:55.875    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:04:55.875    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:04:55.875    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:04:55.875    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940121-103051-653_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/01/21/SPOT2-HRV2-XS_19940121-103058-872_L1C_051-262-8_D_V1-0/SPOT2-HRV2-XS_19940121-103058-872_L1C_051-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940121-103058-872_L1C_051-262-8_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940121-103058-872_L1C_051-262-8_D_V1-0.zip
run script
2024-01-09T14:06:32.507    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:06:32.508    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940121-103058-872_L1C_051-262-8_D_V1-0.zip
2024-01-09T14:06:32.508    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:06:32.508    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:06:32.508    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:06:32.511    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:06:32.515    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:06:32.517    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:06:32.520    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:06:32.523    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940121-103058-872_L1C_051-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/02/16/SPOT2-HRV1-XS_19940216-102955-086_L1C_049-254-0_D_V1-0/SPOT2-HRV1-XS_19940216-102955-086_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940216-102955-086_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940216-102955-086_L1C_049-254-0_D_V1-0.zip
run script
2024-01-09T14:07:24.122    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:07:24.123    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940216-102955-086_L1C_049-254-0_D_V1-0.zip
2024-01-09T14:07:24.123    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:07:24.123    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:07:24.123    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:07:24.123    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:07:24.124    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:07:24.124    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:07:24.124    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:07:24.124    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940216-102955-086_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/02/16/SPOT2-HRV1-XS_19940216-102959-598_L1C_049-254-5_D_V1-0/SPOT2-HRV1-XS_19940216-102959-598_L1C_049-254-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940216-102959-598_L1C_049-254-5_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940216-102959-598_L1C_049-254-5_D_V1-0.zip
run script
2024-01-09T14:07:27.642    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:07:27.643    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940216-102959-598_L1C_049-254-5_D_V1-0.zip
2024-01-09T14:07:27.643    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:07:27.643    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:07:27.643    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:07:27.643    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:07:27.643    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:07:27.643    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:07:27.643    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:07:27.643    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940216-102959-598_L1C_049-254-5_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/02/16/SPOT2-HRV2-XS_19940216-102953-813_L1C_051-254-0_D_V1-0/SPOT2-HRV2-XS_19940216-102953-813_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940216-102953-813_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940216-102953-813_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T14:07:31.064    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:07:31.066    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940216-102953-813_L1C_051-254-0_D_V1-0.zip
2024-01-09T14:07:31.066    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:07:31.066    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:07:31.066    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:07:31.066    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:07:31.066    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:07:31.066    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:07:31.066    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:07:31.066    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940216-102953-813_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/02/16/SPOT2-HRV2-XS_19940216-103000-130_L1C_051-254-7_D_V1-0/SPOT2-HRV2-XS_19940216-103000-130_L1C_051-254-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940216-103000-130_L1C_051-254-7_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940216-103000-130_L1C_051-254-7_D_V1-0.zip
run script
2024-01-09T14:07:34.764    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:07:34.766    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940216-103000-130_L1C_051-254-7_D_V1-0.zip
2024-01-09T14:07:34.766    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:07:34.766    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:07:34.766    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:07:34.766    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:07:34.766    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:07:34.766    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:07:34.766    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:07:34.766    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940216-103000-130_L1C_051-254-7_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/03/23/SPOT2-HRV2-XS_19940323-105719-470_L1C_049-256-0_D_V1-0/SPOT2-HRV2-XS_19940323-105719-470_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940323-105719-470_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940323-105719-470_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T14:07:56.416    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:07:56.417    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940323-105719-470_L1C_049-256-0_D_V1-0.zip
2024-01-09T14:07:56.417    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:07:56.417    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:07:56.417    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:07:56.417    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:07:56.417    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:07:56.417    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:07:56.417    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:07:56.417    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940323-105719-470_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/03/23/SPOT2-HRV2-XS_19940323-105727-869_L1C_049-257-0_D_V1-0/SPOT2-HRV2-XS_19940323-105727-869_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940323-105727-869_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940323-105727-869_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T14:09:46.212    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:09:46.213    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940323-105727-869_L1C_049-257-0_D_V1-0.zip
2024-01-09T14:09:46.213    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:09:46.213    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:09:46.213    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:09:46.213    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:09:46.213    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:09:46.213    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:09:46.213    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:09:46.213    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940323-105727-869_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/03/23/SPOT2-HRV2-XS_19940323-105736-273_L1C_049-258-0_D_V1-0/SPOT2-HRV2-XS_19940323-105736-273_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940323-105736-273_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940323-105736-273_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T14:11:07.493    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:11:07.495    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940323-105736-273_L1C_049-258-0_D_V1-0.zip
2024-01-09T14:11:07.495    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:11:07.495    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:11:07.495    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:11:07.495    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:11:07.495    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:11:07.495    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:11:07.495    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:11:07.495    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T14:11:57.528    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 214). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940323-105736-273_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1994/03/23/SPOT2-HRV2-XS_19940323-105744-683_L1C_049-259-0_D_V1-0/SPOT2-HRV2-XS_19940323-105744-683_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940323-105744-683_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940323-105744-683_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T14:12:00.921    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:12:00.922    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940323-105744-683_L1C_049-259-0_D_V1-0.zip
2024-01-09T14:12:00.922    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:12:00.922    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:12:00.923    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:12:00.923    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:12:00.923    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:12:00.923    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:12:00.923    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:12:00.923    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940323-105744-683_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/03/23/SPOT2-HRV2-XS_19940323-105750-098_L1C_049-259-6_D_V1-0/SPOT2-HRV2-XS_19940323-105750-098_L1C_049-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940323-105750-098_L1C_049-259-6_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940323-105750-098_L1C_049-259-6_D_V1-0.zip
run script
2024-01-09T14:12:36.621    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:12:36.622    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940323-105750-098_L1C_049-259-6_D_V1-0.zip
2024-01-09T14:12:36.622    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:12:36.622    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:12:36.622    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:12:36.623    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:12:36.623    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:12:36.623    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:12:36.623    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:12:36.623    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940323-105750-098_L1C_049-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/03/23/SPOT2-HRV2-XS_19940323-105809-253_L1C_049-261-9_D_V1-0/SPOT2-HRV2-XS_19940323-105809-253_L1C_049-261-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940323-105809-253_L1C_049-261-9_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940323-105809-253_L1C_049-261-9_D_V1-0.zip
run script
2024-01-09T14:12:55.897    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:12:55.898    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940323-105809-253_L1C_049-261-9_D_V1-0.zip
2024-01-09T14:12:55.898    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:12:55.898    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:12:55.898    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:12:55.899    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:12:55.899    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:12:55.899    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:12:55.899    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:12:55.899    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940323-105809-253_L1C_049-261-9_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/11/08/SPOT2-HRV1-XS_19941108-103341-322_L1C_049-257-5_D_V1-0/SPOT2-HRV1-XS_19941108-103341-322_L1C_049-257-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19941108-103341-322_L1C_049-257-5_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941108-103341-322_L1C_049-257-5_D_V1-0.zip
run script
2024-01-09T14:12:59.587    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:12:59.587    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941108-103341-322_L1C_049-257-5_D_V1-0.zip
2024-01-09T14:12:59.587    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:12:59.587    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:12:59.587    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:12:59.587    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:12:59.587    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:12:59.587    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:12:59.587    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:12:59.587    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941108-103341-322_L1C_049-257-5_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/11/08/SPOT2-HRV1-XS_19941108-103345-067_L1C_049-258-0_D_V1-0/SPOT2-HRV1-XS_19941108-103345-067_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19941108-103345-067_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941108-103345-067_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T14:13:49.365    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:13:49.367    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941108-103345-067_L1C_049-258-0_D_V1-0.zip
2024-01-09T14:13:49.367    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:13:49.367    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:13:49.367    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:13:49.367    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:13:49.367    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:13:49.367    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:13:49.367    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:13:49.367    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941108-103345-067_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/11/08/SPOT2-HRV1-XS_19941108-103401-605_L1C_049-260-0_D_V1-0/SPOT2-HRV1-XS_19941108-103401-605_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19941108-103401-605_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941108-103401-605_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T14:14:28.261    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:14:28.263    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941108-103401-605_L1C_049-260-0_D_V1-0.zip
2024-01-09T14:14:28.263    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:14:28.263    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:14:28.263    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:14:28.263    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:14:28.263    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:14:28.263    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:14:28.263    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:14:28.263    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941108-103401-605_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/11/08/SPOT2-HRV1-XS_19941108-103409-889_L1C_049-261-0_D_V1-0/SPOT2-HRV1-XS_19941108-103409-889_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19941108-103409-889_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941108-103409-889_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T14:14:36.169    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:14:36.170    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941108-103409-889_L1C_049-261-0_D_V1-0.zip
2024-01-09T14:14:36.171    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:14:36.171    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:14:36.171    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:14:36.171    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:14:36.171    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:14:36.171    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:14:36.171    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:14:36.171    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941108-103409-889_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/11/08/SPOT2-HRV1-XS_19941108-103309-555_L1C_051-254-0_D_V1-0/SPOT2-HRV1-XS_19941108-103309-555_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19941108-103309-555_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941108-103309-555_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T14:14:39.496    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:14:39.496    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941108-103309-555_L1C_051-254-0_D_V1-0.zip
2024-01-09T14:14:39.496    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:14:39.496    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:14:39.497    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:14:39.497    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:14:39.497    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:14:39.497    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:14:39.497    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:14:39.497    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941108-103309-555_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/11/08/SPOT2-HRV1-XS_19941108-103317-806_L1C_051-255-0_D_V1-0/SPOT2-HRV1-XS_19941108-103317-806_L1C_051-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19941108-103317-806_L1C_051-255-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941108-103317-806_L1C_051-255-0_D_V1-0.zip
run script
2024-01-09T14:14:42.897    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:14:42.897    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941108-103317-806_L1C_051-255-0_D_V1-0.zip
2024-01-09T14:14:42.897    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:14:42.897    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:14:42.898    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:14:42.898    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:14:42.898    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:14:42.898    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:14:42.898    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:14:42.898    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941108-103317-806_L1C_051-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/12/14/SPOT2-HRV1-XS_19941214-104121-219_L1C_049-259-0_D_V1-0/SPOT2-HRV1-XS_19941214-104121-219_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19941214-104121-219_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941214-104121-219_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T14:15:31.802    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:15:31.802    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941214-104121-219_L1C_049-259-0_D_V1-0.zip
2024-01-09T14:15:31.802    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:15:31.802    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:15:31.802    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:15:31.802    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:15:31.803    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:15:31.803    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:15:31.803    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:15:31.803    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941214-104121-219_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/12/14/SPOT2-HRV1-XS_19941214-104129-527_L1C_049-260-0_D_V1-0/SPOT2-HRV1-XS_19941214-104129-527_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19941214-104129-527_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941214-104129-527_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T14:15:58.143    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:15:58.144    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941214-104129-527_L1C_049-260-0_D_V1-0.zip
2024-01-09T14:15:58.144    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:15:58.144    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:15:58.144    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:15:58.144    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:15:58.144    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:15:58.145    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:15:58.145    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:15:58.145    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T14:16:00.830    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (222 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941214-104129-527_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1994/12/14/SPOT2-HRV1-XS_19941214-104137-847_L1C_049-261-0_D_V1-0/SPOT2-HRV1-XS_19941214-104137-847_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19941214-104137-847_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941214-104137-847_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T14:16:03.859    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:16:03.859    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941214-104137-847_L1C_049-261-0_D_V1-0.zip
2024-01-09T14:16:03.859    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:16:03.859    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:16:03.859    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:16:03.859    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:16:03.859    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:16:03.859    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:16:03.860    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:16:03.860    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941214-104137-847_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/12/14/SPOT2-HRV1-XS_19941214-104146-170_L1C_049-262-0_D_V1-0/SPOT2-HRV1-XS_19941214-104146-170_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19941214-104146-170_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941214-104146-170_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T14:16:07.420    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:16:07.421    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941214-104146-170_L1C_049-262-0_D_V1-0.zip
2024-01-09T14:16:07.421    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:16:07.421    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:16:07.421    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:16:07.421    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:16:07.421    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:16:07.422    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:16:07.422    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:16:07.422    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941214-104146-170_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/09/07/SPOT2-HRV1-XS_19940907-102649-895_L1C_049-260-5_D_V1-0/SPOT2-HRV1-XS_19940907-102649-895_L1C_049-260-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940907-102649-895_L1C_049-260-5_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940907-102649-895_L1C_049-260-5_D_V1-0.zip
run script
2024-01-09T14:16:10.777    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:16:10.778    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940907-102649-895_L1C_049-260-5_D_V1-0.zip
2024-01-09T14:16:10.779    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:16:10.779    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:16:10.779    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:16:10.779    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:16:10.779    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:16:10.779    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:16:10.779    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:16:10.779    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940907-102649-895_L1C_049-260-5_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/09/07/SPOT2-HRV1-XS_19940907-102653-640_L1C_049-261-0_D_V1-0/SPOT2-HRV1-XS_19940907-102653-640_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940907-102653-640_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940907-102653-640_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T14:16:14.274    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:16:14.276    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940907-102653-640_L1C_049-261-0_D_V1-0.zip
2024-01-09T14:16:14.276    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:16:14.276    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:16:14.276    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:16:14.276    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:16:14.276    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:16:14.276    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:16:14.276    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:16:14.276    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940907-102653-640_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/09/07/SPOT2-HRV1-XS_19940907-102701-903_L1C_049-262-0_D_V1-0/SPOT2-HRV1-XS_19940907-102701-903_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940907-102701-903_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940907-102701-903_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T14:16:17.893    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:16:17.894    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940907-102701-903_L1C_049-262-0_D_V1-0.zip
2024-01-09T14:16:17.894    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:16:17.894    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:16:17.895    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:16:17.895    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:16:17.895    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:16:17.895    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:16:17.895    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:16:17.895    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940907-102701-903_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/06/21/SPOT2-HRV2-XS_19940621-102704-259_L1C_049-261-4_D_V1-0/SPOT2-HRV2-XS_19940621-102704-259_L1C_049-261-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940621-102704-259_L1C_049-261-4_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940621-102704-259_L1C_049-261-4_D_V1-0.zip
run script
2024-01-09T14:16:21.402    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:16:21.403    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940621-102704-259_L1C_049-261-4_D_V1-0.zip
2024-01-09T14:16:21.403    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:16:21.403    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:16:21.403    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:16:21.403    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:16:21.404    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:16:21.404    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:16:21.404    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:16:21.404    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940621-102704-259_L1C_049-261-4_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/06/21/SPOT2-HRV2-XS_19940621-102708-915_L1C_049-262-0_D_V1-0/SPOT2-HRV2-XS_19940621-102708-915_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940621-102708-915_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940621-102708-915_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T14:16:25.074    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:16:25.075    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940621-102708-915_L1C_049-262-0_D_V1-0.zip
2024-01-09T14:16:25.075    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:16:25.075    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:16:25.076    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:16:25.076    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:16:25.076    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:16:25.076    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:16:25.076    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:16:25.076    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940621-102708-915_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/06/21/SPOT2-HRV1-XS_19940621-102624-589_L1C_052-257-0_D_V1-0/SPOT2-HRV1-XS_19940621-102624-589_L1C_052-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940621-102624-589_L1C_052-257-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940621-102624-589_L1C_052-257-0_D_V1-0.zip
run script
2024-01-09T14:16:28.501    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:16:28.502    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940621-102624-589_L1C_052-257-0_D_V1-0.zip
2024-01-09T14:16:28.502    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:16:28.502    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:16:28.502    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:16:28.502    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:16:28.502    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:16:28.502    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:16:28.502    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:16:28.502    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940621-102624-589_L1C_052-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/06/21/SPOT2-HRV1-XS_19940621-102632-837_L1C_052-258-0_D_V1-0/SPOT2-HRV1-XS_19940621-102632-837_L1C_052-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940621-102632-837_L1C_052-258-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940621-102632-837_L1C_052-258-0_D_V1-0.zip
run script
2024-01-09T14:19:14.962    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:19:14.963    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940621-102632-837_L1C_052-258-0_D_V1-0.zip
2024-01-09T14:19:14.963    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:19:14.963    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:19:14.963    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:19:14.964    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:19:14.964    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:19:14.964    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:19:14.964    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:19:14.964    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940621-102632-837_L1C_052-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/06/21/SPOT2-HRV1-XS_19940621-102641-996_L1C_052-259-1_D_V1-0/SPOT2-HRV1-XS_19940621-102641-996_L1C_052-259-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940621-102641-996_L1C_052-259-1_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940621-102641-996_L1C_052-259-1_D_V1-0.zip
run script
2024-01-09T14:21:48.821    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:21:48.822    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940621-102641-996_L1C_052-259-1_D_V1-0.zip
2024-01-09T14:21:48.822    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:21:48.823    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:21:48.823    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:21:48.823    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:21:48.823    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:21:48.823    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:21:48.823    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:21:48.823    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940621-102641-996_L1C_052-259-1_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/06/30/SPOT2-HRV2-XS_19940630-105404-769_L1C_049-261-4_D_V1-0/SPOT2-HRV2-XS_19940630-105404-769_L1C_049-261-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940630-105404-769_L1C_049-261-4_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940630-105404-769_L1C_049-261-4_D_V1-0.zip
run script
2024-01-09T14:24:37.104    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:24:37.106    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940630-105404-769_L1C_049-261-4_D_V1-0.zip
2024-01-09T14:24:37.106    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:24:37.106    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:24:37.106    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:24:37.106    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:24:37.106    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:24:37.106    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:24:37.106    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:24:37.106    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940630-105404-769_L1C_049-261-4_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/06/30/SPOT2-HRV2-XS_19940630-105409-558_L1C_049-262-0_D_V1-0/SPOT2-HRV2-XS_19940630-105409-558_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940630-105409-558_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940630-105409-558_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T14:24:40.772    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:24:40.774    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940630-105409-558_L1C_049-262-0_D_V1-0.zip
2024-01-09T14:24:40.774    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:24:40.774    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:24:40.774    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:24:40.774    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:24:40.774    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:24:40.774    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:24:40.774    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:24:40.774    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940630-105409-558_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/09/02/SPOT2-HRV1-XS_19940902-102306-014_L1C_049-261-4_D_V1-0/SPOT2-HRV1-XS_19940902-102306-014_L1C_049-261-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940902-102306-014_L1C_049-261-4_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940902-102306-014_L1C_049-261-4_D_V1-0.zip
run script
2024-01-09T14:24:44.482    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:24:44.483    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940902-102306-014_L1C_049-261-4_D_V1-0.zip
2024-01-09T14:24:44.483    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:24:44.483    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:24:44.483    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:24:44.483    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:24:44.483    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:24:44.483    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:24:44.484    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:24:44.484    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940902-102306-014_L1C_049-261-4_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/09/02/SPOT2-HRV1-XS_19940902-102310-661_L1C_049-262-0_D_V1-0/SPOT2-HRV1-XS_19940902-102310-661_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940902-102310-661_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940902-102310-661_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T14:24:48.240    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:24:48.242    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940902-102310-661_L1C_049-262-0_D_V1-0.zip
2024-01-09T14:24:48.242    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:24:48.242    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:24:48.242    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:24:48.242    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:24:48.242    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:24:48.242    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:24:48.242    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:24:48.242    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940902-102310-661_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/09/06/SPOT2-HRV2-XS_19940906-104619-339_L1C_049-261-7_D_V1-0/SPOT2-HRV2-XS_19940906-104619-339_L1C_049-261-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940906-104619-339_L1C_049-261-7_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940906-104619-339_L1C_049-261-7_D_V1-0.zip
run script
2024-01-09T14:24:52.010    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:24:52.010    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940906-104619-339_L1C_049-261-7_D_V1-0.zip
2024-01-09T14:24:52.010    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:24:52.010    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:24:52.010    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:24:52.010    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:24:52.010    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:24:52.010    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:24:52.011    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:24:52.011    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940906-104619-339_L1C_049-261-7_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/09/06/SPOT2-HRV2-XS_19940906-104621-369_L1C_049-262-0_D_V1-0/SPOT2-HRV2-XS_19940906-104621-369_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940906-104621-369_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940906-104621-369_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T14:24:55.775    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:24:55.776    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940906-104621-369_L1C_049-262-0_D_V1-0.zip
2024-01-09T14:24:55.776    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:24:55.776    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:24:55.776    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:24:55.776    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:24:55.776    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:24:55.776    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:24:55.776    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:24:55.776    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940906-104621-369_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/10/08/SPOT2-HRV1-XS_19941008-102953-413_L1C_050-256-1_D_V1-0/SPOT2-HRV1-XS_19941008-102953-413_L1C_050-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19941008-102953-413_L1C_050-256-1_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941008-102953-413_L1C_050-256-1_D_V1-0.zip
run script
2024-01-09T14:24:59.413    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:24:59.414    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941008-102953-413_L1C_050-256-1_D_V1-0.zip
2024-01-09T14:24:59.414    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:24:59.414    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:24:59.415    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:24:59.415    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:24:59.415    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:24:59.415    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:24:59.415    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:24:59.415    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941008-102953-413_L1C_050-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/10/08/SPOT2-HRV1-XS_19941008-103000-759_L1C_050-257-0_D_V1-0/SPOT2-HRV1-XS_19941008-103000-759_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19941008-103000-759_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941008-103000-759_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T14:27:41.800    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:27:41.801    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941008-103000-759_L1C_050-257-0_D_V1-0.zip
2024-01-09T14:27:41.801    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:27:41.801    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:27:41.802    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:27:41.802    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:27:41.802    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:27:41.802    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:27:41.802    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:27:41.802    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941008-103000-759_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/10/08/SPOT2-HRV1-XS_19941008-103009-013_L1C_050-258-0_D_V1-0/SPOT2-HRV1-XS_19941008-103009-013_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19941008-103009-013_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941008-103009-013_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T14:30:32.155    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:30:32.158    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941008-103009-013_L1C_050-258-0_D_V1-0.zip
2024-01-09T14:30:32.158    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:30:32.158    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:30:32.158    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:30:32.158    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:30:32.158    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:30:32.158    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:30:32.158    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:30:32.158    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T14:32:09.272    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 452). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941008-103009-013_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1994/10/08/SPOT2-HRV1-XS_19941008-103017-279_L1C_050-259-0_D_V1-0/SPOT2-HRV1-XS_19941008-103017-279_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19941008-103017-279_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941008-103017-279_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T14:32:12.647    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:32:12.648    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941008-103017-279_L1C_050-259-0_D_V1-0.zip
2024-01-09T14:32:12.648    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:32:12.648    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:32:12.649    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:32:12.649    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:32:12.649    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:32:12.649    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:32:12.649    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:32:12.649    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941008-103017-279_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/10/08/SPOT2-HRV1-XS_19941008-103025-551_L1C_050-260-0_D_V1-0/SPOT2-HRV1-XS_19941008-103025-551_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19941008-103025-551_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941008-103025-551_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T14:34:22.780    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:34:22.781    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941008-103025-551_L1C_050-260-0_D_V1-0.zip
2024-01-09T14:34:22.781    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:34:22.782    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:34:22.782    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:34:22.782    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:34:22.782    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:34:22.782    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:34:22.782    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:34:22.782    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941008-103025-551_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/10/08/SPOT2-HRV1-XS_19941008-103033-835_L1C_050-261-0_D_V1-0/SPOT2-HRV1-XS_19941008-103033-835_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19941008-103033-835_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941008-103033-835_L1C_050-261-0_D_V1-0.zip
run script
2024-01-09T14:35:56.781    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:35:56.783    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941008-103033-835_L1C_050-261-0_D_V1-0.zip
2024-01-09T14:35:56.783    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:35:56.783    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:35:56.783    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:35:56.783    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:35:56.783    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:35:56.783    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:35:56.783    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:35:56.783    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941008-103033-835_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/10/08/SPOT2-HRV1-XS_19941008-103042-122_L1C_051-262-0_D_V1-0/SPOT2-HRV1-XS_19941008-103042-122_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19941008-103042-122_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941008-103042-122_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T14:37:24.708    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:37:24.710    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941008-103042-122_L1C_051-262-0_D_V1-0.zip
2024-01-09T14:37:24.710    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:37:24.710    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:37:24.710    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:37:24.710    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:37:24.710    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:37:24.710    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:37:24.710    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:37:24.710    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941008-103042-122_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/07/22/SPOT2-HRV1-XS_19940722-103038-535_L1C_050-259-6_D_V1-0/SPOT2-HRV1-XS_19940722-103038-535_L1C_050-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940722-103038-535_L1C_050-259-6_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940722-103038-535_L1C_050-259-6_D_V1-0.zip
run script
2024-01-09T14:38:29.547    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:38:29.548    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940722-103038-535_L1C_050-259-6_D_V1-0.zip
2024-01-09T14:38:29.548    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:38:29.548    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:38:29.548    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:38:29.548    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:38:29.548    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:38:29.548    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:38:29.548    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:38:29.548    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940722-103038-535_L1C_050-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/07/22/SPOT2-HRV1-XS_19940722-103041-387_L1C_050-260-0_D_V1-0/SPOT2-HRV1-XS_19940722-103041-387_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940722-103041-387_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940722-103041-387_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T14:40:08.585    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:40:08.586    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940722-103041-387_L1C_050-260-0_D_V1-0.zip
2024-01-09T14:40:08.587    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:40:08.587    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:40:08.587    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:40:08.587    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:40:08.587    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:40:08.587    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:40:08.587    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:40:08.587    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940722-103041-387_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/07/22/SPOT2-HRV1-XS_19940722-103049-665_L1C_050-261-0_D_V1-0/SPOT2-HRV1-XS_19940722-103049-665_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940722-103049-665_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940722-103049-665_L1C_050-261-0_D_V1-0.zip
run script
2024-01-09T14:41:31.793    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:41:31.794    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940722-103049-665_L1C_050-261-0_D_V1-0.zip
2024-01-09T14:41:31.794    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:41:31.794    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:41:31.794    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:41:31.794    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:41:31.795    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:41:31.795    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:41:31.795    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:41:31.795    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940722-103049-665_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 0 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/07/22/SPOT2-HRV1-XS_19940722-103057-952_L1C_050-262-0_D_V1-0/SPOT2-HRV1-XS_19940722-103057-952_L1C_050-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940722-103057-952_L1C_050-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940722-103057-952_L1C_050-262-0_D_V1-0.zip
run script
2024-01-09T14:42:50.726    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:42:50.727    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940722-103057-952_L1C_050-262-0_D_V1-0.zip
2024-01-09T14:42:50.727    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:42:50.727    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:42:50.728    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:42:50.728    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:42:50.728    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:42:50.728    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:42:50.728    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:42:50.728    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940722-103057-952_L1C_050-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/07/22/SPOT2-HRV2-XS_19940722-102951-186_L1C_051-254-0_D_V1-0/SPOT2-HRV2-XS_19940722-102951-186_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940722-102951-186_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940722-102951-186_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T14:43:48.187    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:43:48.187    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940722-102951-186_L1C_051-254-0_D_V1-0.zip
2024-01-09T14:43:48.187    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:43:48.187    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:43:48.187    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:43:48.188    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:43:48.188    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:43:48.188    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:43:48.188    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:43:48.188    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940722-102951-186_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/07/22/SPOT2-HRV2-XS_19940722-102959-416_L1C_051-255-0_D_V1-0/SPOT2-HRV2-XS_19940722-102959-416_L1C_051-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940722-102959-416_L1C_051-255-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940722-102959-416_L1C_051-255-0_D_V1-0.zip
run script
2024-01-09T14:43:51.958    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:43:51.958    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940722-102959-416_L1C_051-255-0_D_V1-0.zip
2024-01-09T14:43:51.958    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:43:51.958    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:43:51.958    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:43:51.959    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:43:51.959    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:43:51.959    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:43:51.959    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:43:51.959    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940722-102959-416_L1C_051-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/07/22/SPOT2-HRV2-XS_19940722-103007-655_L1C_051-256-0_D_V1-0/SPOT2-HRV2-XS_19940722-103007-655_L1C_051-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940722-103007-655_L1C_051-256-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940722-103007-655_L1C_051-256-0_D_V1-0.zip
run script
2024-01-09T14:45:24.567    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:45:24.568    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940722-103007-655_L1C_051-256-0_D_V1-0.zip
2024-01-09T14:45:24.568    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:45:24.568    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:45:24.568    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:45:24.568    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:45:24.568    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:45:24.568    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:45:24.568    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:45:24.568    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940722-103007-655_L1C_051-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/07/22/SPOT2-HRV2-XS_19940722-103015-906_L1C_051-257-0_D_V1-0/SPOT2-HRV2-XS_19940722-103015-906_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940722-103015-906_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940722-103015-906_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T14:48:04.154    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:48:04.155    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940722-103015-906_L1C_051-257-0_D_V1-0.zip
2024-01-09T14:48:04.155    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:48:04.155    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:48:04.155    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:48:04.155    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:48:04.155    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:48:04.155    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:48:04.155    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:48:04.155    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940722-103015-906_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 1 0 0]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/07/22/SPOT2-HRV2-XS_19940722-103016-808_L1C_051-257-1_D_V1-0/SPOT2-HRV2-XS_19940722-103016-808_L1C_051-257-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940722-103016-808_L1C_051-257-1_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940722-103016-808_L1C_051-257-1_D_V1-0.zip
run script
2024-01-09T14:51:01.323    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:51:01.324    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940722-103016-808_L1C_051-257-1_D_V1-0.zip
2024-01-09T14:51:01.324    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:51:01.324    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:51:01.324    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:51:01.324    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:51:01.324    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:51:01.324    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:51:01.324    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:51:01.324    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940722-103016-808_L1C_051-257-1_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 2 1 1]
 [1 1 1 ... 2 2 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/05/15/SPOT2-HRV2-XS_19940515-103740-487_L1C_051-254-0_D_V1-0/SPOT2-HRV2-XS_19940515-103740-487_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940515-103740-487_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940515-103740-487_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T14:53:56.541    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:53:56.542    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940515-103740-487_L1C_051-254-0_D_V1-0.zip
2024-01-09T14:53:56.542    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:53:56.542    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:53:56.542    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:53:56.542    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:53:56.542    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:53:56.542    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:53:56.543    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:53:56.543    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940515-103740-487_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/05/15/SPOT2-HRV2-XS_19940515-103805-327_L1C_051-257-0_D_V1-0/SPOT2-HRV2-XS_19940515-103805-327_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940515-103805-327_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940515-103805-327_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T14:53:59.790    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:53:59.791    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940515-103805-327_L1C_051-257-0_D_V1-0.zip
2024-01-09T14:53:59.791    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:53:59.791    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:53:59.791    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:53:59.791    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:53:59.791    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:53:59.791    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:53:59.791    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:53:59.791    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940515-103805-327_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/05/15/SPOT2-HRV2-XS_19940515-103813-626_L1C_051-258-0_D_V1-0/SPOT2-HRV2-XS_19940515-103813-626_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940515-103813-626_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940515-103813-626_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T14:56:54.901    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:56:54.902    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940515-103813-626_L1C_051-258-0_D_V1-0.zip
2024-01-09T14:56:54.902    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:56:54.902    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:56:54.902    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:56:54.902    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:56:54.902    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:56:54.903    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:56:54.903    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:56:54.903    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T14:58:28.862    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 217). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940515-103813-626_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1994/05/15/SPOT2-HRV2-XS_19940515-103821-928_L1C_051-259-0_D_V1-0/SPOT2-HRV2-XS_19940515-103821-928_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940515-103821-928_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940515-103821-928_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T14:58:32.222    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:58:32.222    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940515-103821-928_L1C_051-259-0_D_V1-0.zip
2024-01-09T14:58:32.222    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:58:32.222    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:58:32.222    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:58:32.222    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:58:32.222    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:58:32.222    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:58:32.222    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:58:32.222    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940515-103821-928_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 0 0 ... 2 2 2]
 [1 0 0 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/05/15/SPOT2-HRV2-XS_19940515-103830-242_L1C_051-260-0_D_V1-0/SPOT2-HRV2-XS_19940515-103830-242_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940515-103830-242_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940515-103830-242_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T15:01:21.981    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:01:21.982    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940515-103830-242_L1C_051-260-0_D_V1-0.zip
2024-01-09T15:01:21.982    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:01:21.982    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:01:21.982    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:01:21.982    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:01:21.982    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:01:21.982    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:01:21.982    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:01:21.982    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940515-103830-242_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/05/15/SPOT2-HRV2-XS_19940515-103838-559_L1C_051-261-0_D_V1-0/SPOT2-HRV2-XS_19940515-103838-559_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940515-103838-559_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940515-103838-559_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T15:03:04.153    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:03:04.154    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940515-103838-559_L1C_051-261-0_D_V1-0.zip
2024-01-09T15:03:04.154    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:03:04.154    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:03:04.154    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:03:04.154    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:03:04.154    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:03:04.154    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:03:04.154    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:03:04.154    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940515-103838-559_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/05/15/SPOT2-HRV2-XS_19940515-103846-885_L1C_051-262-0_D_V1-0/SPOT2-HRV2-XS_19940515-103846-885_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940515-103846-885_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940515-103846-885_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T15:04:44.605    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:04:44.606    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940515-103846-885_L1C_051-262-0_D_V1-0.zip
2024-01-09T15:04:44.606    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:04:44.606    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:04:44.606    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:04:44.606    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:04:44.606    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:04:44.606    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:04:44.606    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:04:44.606    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940515-103846-885_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/05/15/SPOT2-HRV2-XS_19940515-103848-690_L1C_051-262-2_D_V1-0/SPOT2-HRV2-XS_19940515-103848-690_L1C_051-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940515-103848-690_L1C_051-262-2_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940515-103848-690_L1C_051-262-2_D_V1-0.zip
run script
2024-01-09T15:05:57.683    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:05:57.685    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940515-103848-690_L1C_051-262-2_D_V1-0.zip
2024-01-09T15:05:57.685    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:05:57.685    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:05:57.685    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:05:57.685    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:05:57.685    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:05:57.685    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:05:57.685    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:05:57.685    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940515-103848-690_L1C_051-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/05/31/SPOT2-HRV1-XS_19940531-103004-416_L1C_051-254-9_D_V1-0/SPOT2-HRV1-XS_19940531-103004-416_L1C_051-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940531-103004-416_L1C_051-254-9_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940531-103004-416_L1C_051-254-9_D_V1-0.zip
run script
2024-01-09T15:08:11.027    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:08:11.028    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940531-103004-416_L1C_051-254-9_D_V1-0.zip
2024-01-09T15:08:11.028    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:08:11.028    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:08:11.028    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:08:11.028    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:08:11.029    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:08:11.029    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:08:11.029    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:08:11.029    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940531-103004-416_L1C_051-254-9_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/05/31/SPOT2-HRV1-XS_19940531-103004-524_L1C_051-255-0_D_V1-0/SPOT2-HRV1-XS_19940531-103004-524_L1C_051-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940531-103004-524_L1C_051-255-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940531-103004-524_L1C_051-255-0_D_V1-0.zip
run script
2024-01-09T15:08:57.785    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:08:57.787    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940531-103004-524_L1C_051-255-0_D_V1-0.zip
2024-01-09T15:08:57.787    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:08:57.787    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:08:57.787    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:08:57.787    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:08:57.787    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:08:57.787    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:08:57.787    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:08:57.787    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940531-103004-524_L1C_051-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/05/31/SPOT2-HRV1-XS_19940531-103021-017_L1C_051-257-0_D_V1-0/SPOT2-HRV1-XS_19940531-103021-017_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940531-103021-017_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940531-103021-017_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T15:09:45.888    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:09:45.889    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940531-103021-017_L1C_051-257-0_D_V1-0.zip
2024-01-09T15:09:45.889    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:09:45.889    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:09:45.889    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:09:45.889    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:09:45.889    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:09:45.889    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:09:45.889    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:09:45.890    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940531-103021-017_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/05/31/SPOT2-HRV1-XS_19940531-103029-277_L1C_051-258-0_D_V1-0/SPOT2-HRV1-XS_19940531-103029-277_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940531-103029-277_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940531-103029-277_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T15:12:41.332    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:12:41.333    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940531-103029-277_L1C_051-258-0_D_V1-0.zip
2024-01-09T15:12:41.333    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:12:41.333    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:12:41.334    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:12:41.334    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:12:41.334    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:12:41.334    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:12:41.334    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:12:41.334    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T15:14:13.919    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 213). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940531-103029-277_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1994/05/31/SPOT2-HRV1-XS_19940531-103037-546_L1C_051-259-0_D_V1-0/SPOT2-HRV1-XS_19940531-103037-546_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940531-103037-546_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940531-103037-546_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T15:14:17.099    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:14:17.100    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940531-103037-546_L1C_051-259-0_D_V1-0.zip
2024-01-09T15:14:17.100    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:14:17.100    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:14:17.100    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:14:17.100    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:14:17.100    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:14:17.100    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:14:17.100    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:14:17.101    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940531-103037-546_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/05/31/SPOT2-HRV1-XS_19940531-103045-824_L1C_051-260-0_D_V1-0/SPOT2-HRV1-XS_19940531-103045-824_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940531-103045-824_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940531-103045-824_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T15:16:55.083    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:16:55.084    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940531-103045-824_L1C_051-260-0_D_V1-0.zip
2024-01-09T15:16:55.084    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:16:55.084    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:16:55.084    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:16:55.084    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:16:55.084    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:16:55.085    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:16:55.085    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:16:55.085    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940531-103045-824_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/05/31/SPOT2-HRV1-XS_19940531-103054-111_L1C_051-261-0_D_V1-0/SPOT2-HRV1-XS_19940531-103054-111_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940531-103054-111_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940531-103054-111_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T15:18:54.497    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:18:54.498    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940531-103054-111_L1C_051-261-0_D_V1-0.zip
2024-01-09T15:18:54.498    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:18:54.498    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:18:54.498    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:18:54.498    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:18:54.498    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:18:54.498    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:18:54.498    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:18:54.498    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T15:20:41.870    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (234 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940531-103054-111_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1994/05/31/SPOT2-HRV1-XS_19940531-103056-818_L1C_051-261-3_D_V1-0/SPOT2-HRV1-XS_19940531-103056-818_L1C_051-261-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940531-103056-818_L1C_051-261-3_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940531-103056-818_L1C_051-261-3_D_V1-0.zip
run script
2024-01-09T15:20:45.116    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:20:45.117    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940531-103056-818_L1C_051-261-3_D_V1-0.zip
2024-01-09T15:20:45.117    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:20:45.117    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:20:45.117    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:20:45.117    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:20:45.117    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:20:45.117    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:20:45.117    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:20:45.117    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940531-103056-818_L1C_051-261-3_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/08/22/SPOT2-HRV2-XS_19940822-103340-257_L1C_051-254-0_D_V1-0/SPOT2-HRV2-XS_19940822-103340-257_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940822-103340-257_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940822-103340-257_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T15:22:33.418    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:22:33.419    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940822-103340-257_L1C_051-254-0_D_V1-0.zip
2024-01-09T15:22:33.419    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:22:33.419    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:22:33.419    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:22:33.419    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:22:33.419    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:22:33.419    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:22:33.419    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:22:33.420    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940822-103340-257_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/08/22/SPOT2-HRV2-XS_19940822-103348-511_L1C_051-255-0_D_V1-0/SPOT2-HRV2-XS_19940822-103348-511_L1C_051-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940822-103348-511_L1C_051-255-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940822-103348-511_L1C_051-255-0_D_V1-0.zip
run script
2024-01-09T15:22:36.751    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:22:36.752    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940822-103348-511_L1C_051-255-0_D_V1-0.zip
2024-01-09T15:22:36.752    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:22:36.752    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:22:36.752    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:22:36.752    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:22:36.752    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:22:36.752    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:22:36.752    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:22:36.753    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940822-103348-511_L1C_051-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/09/23/SPOT2-HRV1-XS_19940923-101804-065_L1C_051-254-0_D_V1-0/SPOT2-HRV1-XS_19940923-101804-065_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940923-101804-065_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940923-101804-065_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T15:23:23.434    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:23:23.436    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940923-101804-065_L1C_051-254-0_D_V1-0.zip
2024-01-09T15:23:23.436    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:23:23.436    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:23:23.436    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:23:23.436    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:23:23.436    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:23:23.436    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:23:23.436    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:23:23.436    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940923-101804-065_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/09/23/SPOT2-HRV1-XS_19940923-101823-172_L1C_051-256-3_D_V1-0/SPOT2-HRV1-XS_19940923-101823-172_L1C_051-256-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940923-101823-172_L1C_051-256-3_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940923-101823-172_L1C_051-256-3_D_V1-0.zip
run script
2024-01-09T15:23:26.456    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:23:26.458    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940923-101823-172_L1C_051-256-3_D_V1-0.zip
2024-01-09T15:23:26.458    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:23:26.458    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:23:26.458    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:23:26.458    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:23:26.458    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:23:26.458    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:23:26.458    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:23:26.458    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940923-101823-172_L1C_051-256-3_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/11/03/SPOT2-HRV1-XS_19941103-102921-289_L1C_051-254-0_D_V1-0/SPOT2-HRV1-XS_19941103-102921-289_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19941103-102921-289_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941103-102921-289_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T15:26:02.249    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:26:02.250    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941103-102921-289_L1C_051-254-0_D_V1-0.zip
2024-01-09T15:26:02.250    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:26:02.250    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:26:02.250    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:26:02.250    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:26:02.250    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:26:02.250    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:26:02.250    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:26:02.250    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941103-102921-289_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/11/03/SPOT2-HRV1-XS_19941103-102923-996_L1C_051-254-3_D_V1-0/SPOT2-HRV1-XS_19941103-102923-996_L1C_051-254-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19941103-102923-996_L1C_051-254-3_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941103-102923-996_L1C_051-254-3_D_V1-0.zip
run script
2024-01-09T15:26:05.380    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:26:05.382    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941103-102923-996_L1C_051-254-3_D_V1-0.zip
2024-01-09T15:26:05.382    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:26:05.382    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:26:05.382    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:26:05.382    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:26:05.382    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:26:05.382    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:26:05.382    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:26:05.382    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941103-102923-996_L1C_051-254-3_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/12/15/SPOT2-HRV1-XS_19941215-102117-044_L1C_051-254-0_D_V1-0/SPOT2-HRV1-XS_19941215-102117-044_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19941215-102117-044_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941215-102117-044_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T15:26:08.586    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:26:08.587    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941215-102117-044_L1C_051-254-0_D_V1-0.zip
2024-01-09T15:26:08.587    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:26:08.587    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:26:08.587    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:26:08.587    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:26:08.587    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:26:08.587    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:26:08.587    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:26:08.587    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941215-102117-044_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/12/15/SPOT2-HRV1-XS_19941215-102121-556_L1C_051-254-5_D_V1-0/SPOT2-HRV1-XS_19941215-102121-556_L1C_051-254-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19941215-102121-556_L1C_051-254-5_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941215-102121-556_L1C_051-254-5_D_V1-0.zip
run script
2024-01-09T15:26:11.931    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:26:11.932    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941215-102121-556_L1C_051-254-5_D_V1-0.zip
2024-01-09T15:26:11.932    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:26:11.937    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:26:11.938    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:26:11.938    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:26:11.938    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:26:11.938    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:26:11.938    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:26:11.938    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19941215-102121-556_L1C_051-254-5_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1994/02/06/SPOT2-HRV2-XS_19940206-102240-212_L1C_051-258-0_D_V1-0/SPOT2-HRV2-XS_19940206-102240-212_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940206-102240-212_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940206-102240-212_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T15:26:15.233    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:26:15.234    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940206-102240-212_L1C_051-258-0_D_V1-0.zip
2024-01-09T15:26:15.234    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:26:15.234    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:26:15.234    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:26:15.234    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:26:15.234    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:26:15.234    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:26:15.234    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:26:15.235    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T15:27:36.688    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 370). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940206-102240-212_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1994/02/06/SPOT2-HRV2-XS_19940206-102248-454_L1C_051-259-0_D_V1-0/SPOT2-HRV2-XS_19940206-102248-454_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940206-102248-454_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940206-102248-454_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T15:27:39.904    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:27:39.905    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940206-102248-454_L1C_051-259-0_D_V1-0.zip
2024-01-09T15:27:39.905    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:27:39.905    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:27:39.905    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:27:39.905    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:27:39.905    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:27:39.905    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:27:39.905    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:27:39.905    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940206-102248-454_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [1 2 2 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/02/06/SPOT2-HRV2-XS_19940206-102254-771_L1C_051-259-7_D_V1-0/SPOT2-HRV2-XS_19940206-102254-771_L1C_051-259-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940206-102254-771_L1C_051-259-7_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940206-102254-771_L1C_051-259-7_D_V1-0.zip
run script
2024-01-09T15:30:34.115    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:30:34.116    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940206-102254-771_L1C_051-259-7_D_V1-0.zip
2024-01-09T15:30:34.117    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:30:34.117    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:30:34.117    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:30:34.117    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:30:34.117    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:30:34.117    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:30:34.117    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:30:34.117    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T15:33:10.012    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 113). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940206-102254-771_L1C_051-259-7_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1994/01/16/SPOT2-HRV1-XS_19940116-102636-723_L1C_051-259-5_D_V1-0/SPOT2-HRV1-XS_19940116-102636-723_L1C_051-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940116-102636-723_L1C_051-259-5_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940116-102636-723_L1C_051-259-5_D_V1-0.zip
run script
2024-01-09T15:33:13.583    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:33:13.584    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940116-102636-723_L1C_051-259-5_D_V1-0.zip
2024-01-09T15:33:13.584    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:33:13.584    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:33:13.584    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:33:13.584    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:33:13.584    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:33:13.584    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:33:13.584    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:33:13.584    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940116-102636-723_L1C_051-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/01/16/SPOT2-HRV1-XS_19940116-102640-474_L1C_051-260-0_D_V1-0/SPOT2-HRV1-XS_19940116-102640-474_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940116-102640-474_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940116-102640-474_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T15:35:57.823    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:35:57.824    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940116-102640-474_L1C_051-260-0_D_V1-0.zip
2024-01-09T15:35:57.824    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:35:57.824    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:35:57.824    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:35:57.824    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:35:57.824    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:35:57.824    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:35:57.824    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:35:57.824    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940116-102640-474_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/01/16/SPOT2-HRV1-XS_19940116-102648-749_L1C_051-261-0_D_V1-0/SPOT2-HRV1-XS_19940116-102648-749_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940116-102648-749_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940116-102648-749_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T15:38:18.173    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:38:18.175    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940116-102648-749_L1C_051-261-0_D_V1-0.zip
2024-01-09T15:38:18.175    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:38:18.175    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:38:18.175    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:38:18.175    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:38:18.175    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:38:18.175    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:38:18.175    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:38:18.175    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940116-102648-749_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/01/16/SPOT2-HRV1-XS_19940116-102657-030_L1C_051-262-0_D_V1-0/SPOT2-HRV1-XS_19940116-102657-030_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940116-102657-030_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940116-102657-030_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T15:40:34.847    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:40:34.848    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940116-102657-030_L1C_051-262-0_D_V1-0.zip
2024-01-09T15:40:34.848    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:40:34.848    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:40:34.848    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:40:34.848    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:40:34.848    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:40:34.848    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:40:34.848    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:40:34.848    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T15:42:15.475    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (404 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940116-102657-030_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1994/01/16/SPOT2-HRV1-XS_19940116-102705-320_L1C_051-263-0_D_V1-0/SPOT2-HRV1-XS_19940116-102705-320_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940116-102705-320_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940116-102705-320_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T15:42:18.586    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:42:18.586    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940116-102705-320_L1C_051-263-0_D_V1-0.zip
2024-01-09T15:42:18.586    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:42:18.586    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:42:18.586    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:42:18.586    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:42:18.586    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:42:18.587    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:42:18.587    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:42:18.587    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940116-102705-320_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/03/19/SPOT2-HRV2-XS_19940319-103436-149_L1C_051-259-5_D_V1-0/SPOT2-HRV2-XS_19940319-103436-149_L1C_051-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940319-103436-149_L1C_051-259-5_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940319-103436-149_L1C_051-259-5_D_V1-0.zip
run script
2024-01-09T15:43:04.362    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:43:04.363    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940319-103436-149_L1C_051-259-5_D_V1-0.zip
2024-01-09T15:43:04.363    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:43:04.363    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:43:04.363    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:43:04.363    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:43:04.363    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:43:04.363    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:43:04.363    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:43:04.363    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940319-103436-149_L1C_051-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/03/19/SPOT2-HRV2-XS_19940319-103439-933_L1C_051-260-0_D_V1-0/SPOT2-HRV2-XS_19940319-103439-933_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940319-103439-933_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940319-103439-933_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T15:45:37.005    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:45:37.007    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940319-103439-933_L1C_051-260-0_D_V1-0.zip
2024-01-09T15:45:37.007    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:45:37.007    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:45:37.007    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:45:37.007    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:45:37.007    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:45:37.007    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:45:37.007    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:45:37.007    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940319-103439-933_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/03/19/SPOT2-HRV2-XS_19940319-103448-235_L1C_051-261-0_D_V1-0/SPOT2-HRV2-XS_19940319-103448-235_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940319-103448-235_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940319-103448-235_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T15:47:45.934    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:47:45.935    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940319-103448-235_L1C_051-261-0_D_V1-0.zip
2024-01-09T15:47:45.935    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:47:45.935    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:47:45.935    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:47:45.935    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:47:45.935    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:47:45.935    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:47:45.935    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:47:45.935    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940319-103448-235_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [2 1 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 2 2 ... 2 2 2]
 [0 2 1 ... 2 2 2]
 [0 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/03/19/SPOT2-HRV2-XS_19940319-103456-546_L1C_051-262-0_D_V1-0/SPOT2-HRV2-XS_19940319-103456-546_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940319-103456-546_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940319-103456-546_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T15:49:49.112    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:49:49.114    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940319-103456-546_L1C_051-262-0_D_V1-0.zip
2024-01-09T15:49:49.114    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:49:49.114    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:49:49.114    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:49:49.114    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:49:49.114    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:49:49.114    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:49:49.114    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:49:49.114    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940319-103456-546_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/03/19/SPOT2-HRV2-XS_19940319-103504-863_L1C_051-263-0_D_V1-0/SPOT2-HRV2-XS_19940319-103504-863_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940319-103504-863_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940319-103504-863_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T15:51:22.983    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:51:22.984    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940319-103504-863_L1C_051-263-0_D_V1-0.zip
2024-01-09T15:51:22.984    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:51:22.984    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:51:22.984    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:51:22.984    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:51:22.985    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:51:22.985    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:51:22.985    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:51:22.985    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940319-103504-863_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/04/29/SPOT2-HRV1-XS_19940429-104606-851_L1C_051-259-2_D_V1-0/SPOT2-HRV1-XS_19940429-104606-851_L1C_051-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940429-104606-851_L1C_051-259-2_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940429-104606-851_L1C_051-259-2_D_V1-0.zip
run script
2024-01-09T15:52:06.162    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:52:06.163    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940429-104606-851_L1C_051-259-2_D_V1-0.zip
2024-01-09T15:52:06.163    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:52:06.163    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:52:06.163    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:52:06.163    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:52:06.163    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:52:06.163    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:52:06.163    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:52:06.163    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940429-104606-851_L1C_051-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/04/29/SPOT2-HRV1-XS_19940429-104613-408_L1C_051-260-0_D_V1-0/SPOT2-HRV1-XS_19940429-104613-408_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940429-104613-408_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940429-104613-408_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T15:54:46.281    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:54:46.282    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940429-104613-408_L1C_051-260-0_D_V1-0.zip
2024-01-09T15:54:46.282    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:54:46.282    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:54:46.282    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:54:46.282    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:54:46.282    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:54:46.282    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:54:46.282    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:54:46.282    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940429-104613-408_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/04/29/SPOT2-HRV1-XS_19940429-104621-776_L1C_051-261-0_D_V1-0/SPOT2-HRV1-XS_19940429-104621-776_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940429-104621-776_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940429-104621-776_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T15:56:51.793    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:56:51.794    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940429-104621-776_L1C_051-261-0_D_V1-0.zip
2024-01-09T15:56:51.794    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:56:51.794    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:56:51.794    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:56:51.794    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:56:51.794    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:56:51.795    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:56:51.795    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:56:51.795    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T15:58:40.611    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (123 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940429-104621-776_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1994/04/29/SPOT2-HRV1-XS_19940429-104630-151_L1C_051-262-0_D_V1-0/SPOT2-HRV1-XS_19940429-104630-151_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940429-104630-151_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940429-104630-151_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T15:58:43.801    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:58:43.802    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940429-104630-151_L1C_051-262-0_D_V1-0.zip
2024-01-09T15:58:43.802    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:58:43.802    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:58:43.802    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:58:43.802    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:58:43.803    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:58:43.803    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:58:43.803    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:58:43.803    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940429-104630-151_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/04/29/SPOT2-HRV1-XS_19940429-104638-531_L1C_051-263-0_D_V1-0/SPOT2-HRV1-XS_19940429-104638-531_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940429-104638-531_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940429-104638-531_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T16:00:12.032    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:00:12.033    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940429-104638-531_L1C_051-263-0_D_V1-0.zip
2024-01-09T16:00:12.033    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:00:12.033    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:00:12.033    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:00:12.034    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:00:12.034    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:00:12.034    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:00:12.034    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:00:12.034    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940429-104638-531_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/04/29/SPOT2-HRV2-XS_19940429-104625-130_L1C_055-262-0_D_V1-0/SPOT2-HRV2-XS_19940429-104625-130_L1C_055-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940429-104625-130_L1C_055-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940429-104625-130_L1C_055-262-0_D_V1-0.zip
run script
2024-01-09T16:00:44.433    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:00:44.434    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940429-104625-130_L1C_055-262-0_D_V1-0.zip
2024-01-09T16:00:44.434    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:00:44.434    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:00:44.434    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:00:44.434    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:00:44.434    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:00:44.435    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:00:44.435    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:00:44.435    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940429-104625-130_L1C_055-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/11/07/SPOT2-HRV2-XS_19941107-105308-316_L1C_051-259-0_D_V1-0/SPOT2-HRV2-XS_19941107-105308-316_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19941107-105308-316_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19941107-105308-316_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T16:02:09.484    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:02:09.485    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19941107-105308-316_L1C_051-259-0_D_V1-0.zip
2024-01-09T16:02:09.485    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:02:09.486    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:02:09.486    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:02:09.486    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:02:09.486    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:02:09.486    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:02:09.486    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:02:09.486    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19941107-105308-316_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/11/07/SPOT2-HRV2-XS_19941107-105316-742_L1C_051-260-0_D_V1-0/SPOT2-HRV2-XS_19941107-105316-742_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19941107-105316-742_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19941107-105316-742_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T16:05:16.158    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:05:16.159    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19941107-105316-742_L1C_051-260-0_D_V1-0.zip
2024-01-09T16:05:16.159    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:05:16.159    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:05:16.159    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:05:16.159    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:05:16.160    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:05:16.160    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:05:16.160    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:05:16.160    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19941107-105316-742_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/11/07/SPOT2-HRV2-XS_19941107-105321-254_L1C_051-260-5_D_V1-0/SPOT2-HRV2-XS_19941107-105321-254_L1C_051-260-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19941107-105321-254_L1C_051-260-5_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19941107-105321-254_L1C_051-260-5_D_V1-0.zip
run script
2024-01-09T16:07:58.055    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:07:58.057    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19941107-105321-254_L1C_051-260-5_D_V1-0.zip
2024-01-09T16:07:58.057    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:07:58.057    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:07:58.057    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:07:58.057    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:07:58.057    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:07:58.057    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:07:58.057    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:07:58.057    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19941107-105321-254_L1C_051-260-5_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/11/07/SPOT2-HRV2-XS_19941107-105251-478_L1C_052-257-0_D_V1-0/SPOT2-HRV2-XS_19941107-105251-478_L1C_052-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19941107-105251-478_L1C_052-257-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19941107-105251-478_L1C_052-257-0_D_V1-0.zip
run script
2024-01-09T16:10:47.299    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:10:47.300    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19941107-105251-478_L1C_052-257-0_D_V1-0.zip
2024-01-09T16:10:47.300    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:10:47.300    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:10:47.300    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:10:47.300    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:10:47.300    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:10:47.301    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:10:47.301    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:10:47.301    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19941107-105251-478_L1C_052-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/11/07/SPOT2-HRV2-XS_19941107-105259-894_L1C_052-258-0_D_V1-0/SPOT2-HRV2-XS_19941107-105259-894_L1C_052-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19941107-105259-894_L1C_052-258-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19941107-105259-894_L1C_052-258-0_D_V1-0.zip
run script
2024-01-09T16:13:55.796    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:13:55.797    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19941107-105259-894_L1C_052-258-0_D_V1-0.zip
2024-01-09T16:13:55.798    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:13:55.798    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:13:55.798    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:13:55.798    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:13:55.798    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:13:55.798    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:13:55.798    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:13:55.798    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19941107-105259-894_L1C_052-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/02/21/SPOT2-HRV1-XS_19940221-103442-439_L1C_051-260-8_D_V1-0/SPOT2-HRV1-XS_19940221-103442-439_L1C_051-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940221-103442-439_L1C_051-260-8_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940221-103442-439_L1C_051-260-8_D_V1-0.zip
run script
2024-01-09T16:16:57.789    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:16:57.790    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940221-103442-439_L1C_051-260-8_D_V1-0.zip
2024-01-09T16:16:57.790    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:16:57.790    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:16:57.790    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:16:57.790    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:16:57.790    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:16:57.790    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:16:57.790    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:16:57.790    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940221-103442-439_L1C_051-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 0 ... 2 2 2]
 [2 2 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/02/21/SPOT2-HRV1-XS_19940221-103443-522_L1C_051-261-0_D_V1-0/SPOT2-HRV1-XS_19940221-103443-522_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940221-103443-522_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940221-103443-522_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T16:19:10.110    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:19:10.111    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940221-103443-522_L1C_051-261-0_D_V1-0.zip
2024-01-09T16:19:10.111    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:19:10.111    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:19:10.111    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:19:10.111    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:19:10.111    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:19:10.111    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:19:10.111    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:19:10.111    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940221-103443-522_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/02/21/SPOT2-HRV1-XS_19940221-103451-836_L1C_051-262-0_D_V1-0/SPOT2-HRV1-XS_19940221-103451-836_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940221-103451-836_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940221-103451-836_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T16:21:19.777    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:21:19.778    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940221-103451-836_L1C_051-262-0_D_V1-0.zip
2024-01-09T16:21:19.778    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:21:19.778    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:21:19.778    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:21:19.778    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:21:19.778    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:21:19.778    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:21:19.778    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:21:19.778    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:22:49.024    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (207 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940221-103451-836_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1994/02/21/SPOT2-HRV1-XS_19940221-103500-156_L1C_051-263-0_D_V1-0/SPOT2-HRV1-XS_19940221-103500-156_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940221-103500-156_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940221-103500-156_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T16:22:52.276    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:22:52.277    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940221-103500-156_L1C_051-263-0_D_V1-0.zip
2024-01-09T16:22:52.277    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:22:52.277    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:22:52.277    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:22:52.277    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:22:52.278    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:22:52.278    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:22:52.278    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:22:52.278    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940221-103500-156_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/07/16/SPOT2-HRV2-XS_19940716-104613-209_L1C_051-260-6_D_V1-0/SPOT2-HRV2-XS_19940716-104613-209_L1C_051-260-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940716-104613-209_L1C_051-260-6_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940716-104613-209_L1C_051-260-6_D_V1-0.zip
run script
2024-01-09T16:23:34.538    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:23:34.539    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940716-104613-209_L1C_051-260-6_D_V1-0.zip
2024-01-09T16:23:34.539    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:23:34.539    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:23:34.539    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:23:34.539    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:23:34.539    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:23:34.539    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:23:34.539    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:23:34.539    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940716-104613-209_L1C_051-260-6_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/07/16/SPOT2-HRV2-XS_19940716-104616-153_L1C_051-261-0_D_V1-0/SPOT2-HRV2-XS_19940716-104616-153_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940716-104616-153_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940716-104616-153_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T16:25:18.245    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:25:18.246    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940716-104616-153_L1C_051-261-0_D_V1-0.zip
2024-01-09T16:25:18.246    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:25:18.246    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:25:18.246    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:25:18.246    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:25:18.247    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:25:18.247    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:25:18.247    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:25:18.247    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940716-104616-153_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/07/16/SPOT2-HRV2-XS_19940716-104624-522_L1C_051-262-0_D_V1-0/SPOT2-HRV2-XS_19940716-104624-522_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940716-104624-522_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940716-104624-522_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T16:26:54.561    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:26:54.562    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940716-104624-522_L1C_051-262-0_D_V1-0.zip
2024-01-09T16:26:54.563    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:26:54.563    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:26:54.563    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:26:54.563    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:26:54.563    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:26:54.563    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:26:54.563    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:26:54.563    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940716-104624-522_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/07/21/SPOT2-HRV2-XS_19940721-105007-112_L1C_051-260-9_D_V1-0/SPOT2-HRV2-XS_19940721-105007-112_L1C_051-260-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940721-105007-112_L1C_051-260-9_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940721-105007-112_L1C_051-260-9_D_V1-0.zip
run script
2024-01-09T16:28:04.217    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:28:04.218    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940721-105007-112_L1C_051-260-9_D_V1-0.zip
2024-01-09T16:28:04.218    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:28:04.218    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:28:04.219    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:28:04.219    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:28:04.219    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:28:04.219    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:28:04.219    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:28:04.219    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940721-105007-112_L1C_051-260-9_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/07/21/SPOT2-HRV2-XS_19940721-105015-778_L1C_051-262-0_D_V1-0/SPOT2-HRV2-XS_19940721-105015-778_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940721-105015-778_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940721-105015-778_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T16:29:55.632    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:29:55.633    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940721-105015-778_L1C_051-262-0_D_V1-0.zip
2024-01-09T16:29:55.634    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:29:55.634    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:29:55.634    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:29:55.634    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:29:55.634    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:29:55.634    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:29:55.634    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:29:55.634    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940721-105015-778_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/07/21/SPOT2-HRV2-XS_19940721-105024-179_L1C_051-263-0_D_V1-0/SPOT2-HRV2-XS_19940721-105024-179_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940721-105024-179_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940721-105024-179_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T16:31:13.917    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:31:13.918    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940721-105024-179_L1C_051-263-0_D_V1-0.zip
2024-01-09T16:31:13.919    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:31:13.919    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:31:13.919    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:31:13.919    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:31:13.919    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:31:13.919    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:31:13.919    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:31:13.919    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940721-105024-179_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/01/31/SPOT2-HRV1-XS_19940131-103830-998_L1C_051-261-0_D_V1-0/SPOT2-HRV1-XS_19940131-103830-998_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940131-103830-998_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940131-103830-998_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T16:31:41.070    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:31:41.071    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940131-103830-998_L1C_051-261-0_D_V1-0.zip
2024-01-09T16:31:41.071    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:31:41.071    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:31:41.071    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:31:41.071    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:31:41.072    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:31:41.072    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:31:41.072    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:31:41.072    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940131-103830-998_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/01/31/SPOT2-HRV1-XS_19940131-103839-330_L1C_051-262-0_D_V1-0/SPOT2-HRV1-XS_19940131-103839-330_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940131-103839-330_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940131-103839-330_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T16:33:42.327    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:33:42.328    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940131-103839-330_L1C_051-262-0_D_V1-0.zip
2024-01-09T16:33:42.328    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:33:42.328    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:33:42.328    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:33:42.328    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:33:42.328    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:33:42.328    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:33:42.328    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:33:42.328    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940131-103839-330_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/01/31/SPOT2-HRV1-XS_19940131-103847-671_L1C_051-263-0_D_V1-0/SPOT2-HRV1-XS_19940131-103847-671_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940131-103847-671_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940131-103847-671_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T16:35:15.033    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:35:15.034    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940131-103847-671_L1C_051-263-0_D_V1-0.zip
2024-01-09T16:35:15.034    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:35:15.035    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:35:15.035    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:35:15.035    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:35:15.035    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:35:15.035    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:35:15.035    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:35:15.035    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940131-103847-671_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/02/01/SPOT2-HRV2-XS_19940201-101845-614_L1C_052-258-0_D_V1-0/SPOT2-HRV2-XS_19940201-101845-614_L1C_052-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940201-101845-614_L1C_052-258-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940201-101845-614_L1C_052-258-0_D_V1-0.zip
run script
2024-01-09T16:35:55.068    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:35:55.069    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940201-101845-614_L1C_052-258-0_D_V1-0.zip
2024-01-09T16:35:55.069    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:35:55.069    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:35:55.069    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:35:55.069    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:35:55.069    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:35:55.069    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:35:55.069    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:35:55.069    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940201-101845-614_L1C_052-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/02/01/SPOT2-HRV2-XS_19940201-101853-850_L1C_052-259-0_D_V1-0/SPOT2-HRV2-XS_19940201-101853-850_L1C_052-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940201-101853-850_L1C_052-259-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940201-101853-850_L1C_052-259-0_D_V1-0.zip
run script
2024-01-09T16:38:20.528    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:38:20.529    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940201-101853-850_L1C_052-259-0_D_V1-0.zip
2024-01-09T16:38:20.529    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:38:20.529    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:38:20.529    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:38:20.529    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:38:20.529    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:38:20.530    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:38:20.530    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:38:20.530    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940201-101853-850_L1C_052-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 1 ... 2 2 2]
 [0 0 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/02/01/SPOT2-HRV2-XS_19940201-101859-264_L1C_052-259-6_D_V1-0/SPOT2-HRV2-XS_19940201-101859-264_L1C_052-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940201-101859-264_L1C_052-259-6_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940201-101859-264_L1C_052-259-6_D_V1-0.zip
run script
2024-01-09T16:41:11.333    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:41:11.334    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940201-101859-264_L1C_052-259-6_D_V1-0.zip
2024-01-09T16:41:11.334    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:41:11.334    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:41:11.334    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:41:11.334    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:41:11.335    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:41:11.335    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:41:11.335    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:41:11.335    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940201-101859-264_L1C_052-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/08/06/SPOT2-HRV1-XS_19940806-104200-509_L1C_052-258-3_D_V1-0/SPOT2-HRV1-XS_19940806-104200-509_L1C_052-258-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940806-104200-509_L1C_052-258-3_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940806-104200-509_L1C_052-258-3_D_V1-0.zip
run script
2024-01-09T16:43:53.814    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:43:53.815    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940806-104200-509_L1C_052-258-3_D_V1-0.zip
2024-01-09T16:43:53.815    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:43:53.815    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:43:53.815    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:43:53.815    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:43:53.815    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:43:53.815    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:43:53.815    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:43:53.815    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940806-104200-509_L1C_052-258-3_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/08/06/SPOT2-HRV1-XS_19940806-104206-140_L1C_052-259-0_D_V1-0/SPOT2-HRV1-XS_19940806-104206-140_L1C_052-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940806-104206-140_L1C_052-259-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940806-104206-140_L1C_052-259-0_D_V1-0.zip
run script
2024-01-09T16:46:23.166    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:46:23.167    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940806-104206-140_L1C_052-259-0_D_V1-0.zip
2024-01-09T16:46:23.167    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:46:23.167    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:46:23.167    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:46:23.167    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:46:23.167    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:46:23.167    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:46:23.167    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:46:23.167    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940806-104206-140_L1C_052-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/08/06/SPOT2-HRV1-XS_19940806-104214-481_L1C_052-260-0_D_V1-0/SPOT2-HRV1-XS_19940806-104214-481_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940806-104214-481_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940806-104214-481_L1C_052-260-0_D_V1-0.zip
run script
2024-01-09T16:49:05.033    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:49:05.035    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940806-104214-481_L1C_052-260-0_D_V1-0.zip
2024-01-09T16:49:05.035    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:49:05.035    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:49:05.035    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:49:05.035    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:49:05.035    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:49:05.035    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:49:05.035    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:49:05.035    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940806-104214-481_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/08/06/SPOT2-HRV1-XS_19940806-104218-090_L1C_052-260-4_D_V1-0/SPOT2-HRV1-XS_19940806-104218-090_L1C_052-260-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940806-104218-090_L1C_052-260-4_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940806-104218-090_L1C_052-260-4_D_V1-0.zip
run script
2024-01-09T16:51:21.010    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:51:21.011    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940806-104218-090_L1C_052-260-4_D_V1-0.zip
2024-01-09T16:51:21.012    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:51:21.012    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:51:21.012    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:51:21.012    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:51:21.012    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:51:21.012    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:51:21.012    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:51:21.012    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940806-104218-090_L1C_052-260-4_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/06/15/SPOT2-HRV2-XS_19940615-104233-765_L1C_052-262-0_D_V1-0/SPOT2-HRV2-XS_19940615-104233-765_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940615-104233-765_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940615-104233-765_L1C_052-262-0_D_V1-0.zip
run script
2024-01-09T16:53:53.044    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:53:53.045    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940615-104233-765_L1C_052-262-0_D_V1-0.zip
2024-01-09T16:53:53.045    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:53:53.045    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:53:53.045    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:53:53.045    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:53:53.045    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:53:53.045    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:53:53.045    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:53:53.045    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940615-104233-765_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/06/15/SPOT2-HRV2-XS_19940615-104242-139_L1C_052-263-0_D_V1-0/SPOT2-HRV2-XS_19940615-104242-139_L1C_052-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940615-104242-139_L1C_052-263-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940615-104242-139_L1C_052-263-0_D_V1-0.zip
run script
2024-01-09T16:56:05.846    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:56:05.848    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940615-104242-139_L1C_052-263-0_D_V1-0.zip
2024-01-09T16:56:05.848    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:56:05.848    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:56:05.848    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:56:05.848    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:56:05.848    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:56:05.848    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:56:05.848    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:56:05.848    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940615-104242-139_L1C_052-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/08/23/SPOT2-HRV1-XS_19940823-101506-112_L1C_053-259-8_D_V1-0/SPOT2-HRV1-XS_19940823-101506-112_L1C_053-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940823-101506-112_L1C_053-259-8_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940823-101506-112_L1C_053-259-8_D_V1-0.zip
run script
2024-01-09T16:57:05.591    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:57:05.592    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940823-101506-112_L1C_053-259-8_D_V1-0.zip
2024-01-09T16:57:05.592    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:57:05.592    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:57:05.592    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:57:05.592    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:57:05.592    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:57:05.592    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:57:05.592    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:57:05.592    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940823-101506-112_L1C_053-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/08/23/SPOT2-HRV1-XS_19940823-101507-131_L1C_053-260-0_D_V1-0/SPOT2-HRV1-XS_19940823-101507-131_L1C_053-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940823-101507-131_L1C_053-260-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940823-101507-131_L1C_053-260-0_D_V1-0.zip
run script
2024-01-09T16:59:09.304    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:59:09.305    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940823-101507-131_L1C_053-260-0_D_V1-0.zip
2024-01-09T16:59:09.305    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:59:09.305    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:59:09.305    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:59:09.305    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:59:09.305    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:59:09.305    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:59:09.305    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:59:09.305    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940823-101507-131_L1C_053-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/08/23/SPOT2-HRV1-XS_19940823-101515-379_L1C_053-261-0_D_V1-0/SPOT2-HRV1-XS_19940823-101515-379_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940823-101515-379_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940823-101515-379_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T17:01:12.420    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:01:12.421    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940823-101515-379_L1C_053-261-0_D_V1-0.zip
2024-01-09T17:01:12.421    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:01:12.421    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:01:12.421    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:01:12.421    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:01:12.421    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:01:12.421    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:01:12.421    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:01:12.422    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940823-101515-379_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/08/23/SPOT2-HRV1-XS_19940823-101523-636_L1C_053-262-0_D_V1-0/SPOT2-HRV1-XS_19940823-101523-636_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940823-101523-636_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940823-101523-636_L1C_053-262-0_D_V1-0.zip
run script
2024-01-09T17:03:46.314    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:03:46.316    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940823-101523-636_L1C_053-262-0_D_V1-0.zip
2024-01-09T17:03:46.316    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:03:46.316    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:03:46.316    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:03:46.316    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:03:46.316    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:03:46.316    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:03:46.316    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:03:46.316    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940823-101523-636_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/03/04/SPOT2-HRV1-XS_19940304-102303-326_L1C_053-260-6_D_V1-0/SPOT2-HRV1-XS_19940304-102303-326_L1C_053-260-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940304-102303-326_L1C_053-260-6_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940304-102303-326_L1C_053-260-6_D_V1-0.zip
run script
2024-01-09T17:06:02.263    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:06:02.264    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940304-102303-326_L1C_053-260-6_D_V1-0.zip
2024-01-09T17:06:02.264    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:06:02.264    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:06:02.264    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:06:02.264    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:06:02.264    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:06:02.264    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:06:02.264    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:06:02.264    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940304-102303-326_L1C_053-260-6_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/08/27/SPOT2-HRV1-XS_19940827-103820-040_L1C_053-260-2_D_V1-0/SPOT2-HRV1-XS_19940827-103820-040_L1C_053-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940827-103820-040_L1C_053-260-2_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940827-103820-040_L1C_053-260-2_D_V1-0.zip
run script
2024-01-09T17:08:05.425    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:08:05.426    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940827-103820-040_L1C_053-260-2_D_V1-0.zip
2024-01-09T17:08:05.426    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:08:05.427    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:08:05.427    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:08:05.427    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:08:05.427    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:08:05.427    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:08:05.427    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:08:05.427    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:08:25.263    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 234). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940827-103820-040_L1C_053-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1994/08/27/SPOT2-HRV1-XS_19940827-103826-579_L1C_053-261-0_D_V1-0/SPOT2-HRV1-XS_19940827-103826-579_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940827-103826-579_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940827-103826-579_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T17:08:28.497    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:08:28.498    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940827-103826-579_L1C_053-261-0_D_V1-0.zip
2024-01-09T17:08:28.498    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:08:28.498    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:08:28.498    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:08:28.498    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:08:28.498    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:08:28.498    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:08:28.498    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:08:28.499    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940827-103826-579_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/08/27/SPOT2-HRV1-XS_19940827-103834-933_L1C_053-262-0_D_V1-0/SPOT2-HRV1-XS_19940827-103834-933_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940827-103834-933_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940827-103834-933_L1C_053-262-0_D_V1-0.zip
run script
2024-01-09T17:10:48.257    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:10:48.258    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940827-103834-933_L1C_053-262-0_D_V1-0.zip
2024-01-09T17:10:48.258    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:10:48.258    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:10:48.258    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:10:48.258    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:10:48.258    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:10:48.258    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:10:48.258    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:10:48.258    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940827-103834-933_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/08/27/SPOT2-HRV2-XS_19940827-103824-877_L1C_054-261-0_D_V1-0/SPOT2-HRV2-XS_19940827-103824-877_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940827-103824-877_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940827-103824-877_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T17:12:52.463    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:12:52.464    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940827-103824-877_L1C_054-261-0_D_V1-0.zip
2024-01-09T17:12:52.464    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:12:52.464    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:12:52.464    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:12:52.465    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:12:52.465    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:12:52.465    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:12:52.465    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:12:52.465    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940827-103824-877_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/08/27/SPOT2-HRV2-XS_19940827-103833-245_L1C_054-262-0_D_V1-0/SPOT2-HRV2-XS_19940827-103833-245_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940827-103833-245_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940827-103833-245_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T17:14:10.771    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:14:10.773    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940827-103833-245_L1C_054-262-0_D_V1-0.zip
2024-01-09T17:14:10.773    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:14:10.773    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:14:10.773    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:14:10.773    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:14:10.773    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:14:10.773    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:14:10.773    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:14:10.773    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940827-103833-245_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/08/16/SPOT2-HRV1-XS_19940816-104959-345_L1C_054-260-8_D_V1-0/SPOT2-HRV1-XS_19940816-104959-345_L1C_054-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940816-104959-345_L1C_054-260-8_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940816-104959-345_L1C_054-260-8_D_V1-0.zip
run script
2024-01-09T17:15:39.067    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:15:39.068    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940816-104959-345_L1C_054-260-8_D_V1-0.zip
2024-01-09T17:15:39.068    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:15:39.068    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:15:39.068    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:15:39.068    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:15:39.068    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:15:39.068    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:15:39.068    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:15:39.068    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940816-104959-345_L1C_054-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 1 1 0]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 2 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/04/08/SPOT2-HRV2-XS_19940408-105011-087_L1C_054-261-0_D_V1-0/SPOT2-HRV2-XS_19940408-105011-087_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940408-105011-087_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940408-105011-087_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T17:17:08.965    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:17:08.966    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940408-105011-087_L1C_054-261-0_D_V1-0.zip
2024-01-09T17:17:08.966    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:17:08.966    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:17:08.966    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:17:08.966    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:17:08.967    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:17:08.967    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:17:08.967    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:17:08.967    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940408-105011-087_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/04/08/SPOT2-HRV2-XS_19940408-105019-542_L1C_054-262-0_D_V1-0/SPOT2-HRV2-XS_19940408-105019-542_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940408-105019-542_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940408-105019-542_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T17:18:34.866    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:18:34.867    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940408-105019-542_L1C_054-262-0_D_V1-0.zip
2024-01-09T17:18:34.867    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:18:34.867    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:18:34.867    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:18:34.867    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:18:34.867    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:18:34.867    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:18:34.867    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:18:34.867    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940408-105019-542_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/05/25/SPOT2-HRV1-XS_19940525-104616-546_L1C_054-261-0_D_V1-0/SPOT2-HRV1-XS_19940525-104616-546_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940525-104616-546_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940525-104616-546_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T17:20:11.643    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:20:11.644    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940525-104616-546_L1C_054-261-0_D_V1-0.zip
2024-01-09T17:20:11.645    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:20:11.645    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:20:11.645    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:20:11.645    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:20:11.645    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:20:11.645    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:20:11.645    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:20:11.645    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940525-104616-546_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/05/25/SPOT2-HRV1-XS_19940525-104624-968_L1C_054-262-0_D_V1-0/SPOT2-HRV1-XS_19940525-104624-968_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940525-104624-968_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940525-104624-968_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T17:21:32.419    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:21:32.420    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940525-104624-968_L1C_054-262-0_D_V1-0.zip
2024-01-09T17:21:32.420    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:21:32.420    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:21:32.420    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:21:32.420    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:21:32.420    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:21:32.420    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:21:32.420    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:21:32.420    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940525-104624-968_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/04/13/SPOT2-HRV2-XS_19940413-105410-233_L1C_054-262-0_D_V1-0/SPOT2-HRV2-XS_19940413-105410-233_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940413-105410-233_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940413-105410-233_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T17:23:04.417    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:23:04.418    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940413-105410-233_L1C_054-262-0_D_V1-0.zip
2024-01-09T17:23:04.418    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:23:04.418    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:23:04.418    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:23:04.418    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:23:04.418    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:23:04.418    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:23:04.418    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:23:04.418    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940413-105410-233_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/04/13/SPOT2-HRV2-XS_19940413-105401-748_L1C_055-261-0_D_V1-0/SPOT2-HRV2-XS_19940413-105401-748_L1C_055-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19940413-105401-748_L1C_055-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940413-105401-748_L1C_055-261-0_D_V1-0.zip
run script
2024-01-09T17:24:47.748    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:24:47.749    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940413-105401-748_L1C_055-261-0_D_V1-0.zip
2024-01-09T17:24:47.749    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:24:47.750    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:24:47.750    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:24:47.750    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:24:47.750    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:24:47.750    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:24:47.750    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:24:47.750    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19940413-105401-748_L1C_055-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/06/05/SPOT2-HRV1-XS_19940605-103441-064_L1C_055-261-0_D_V1-0/SPOT2-HRV1-XS_19940605-103441-064_L1C_055-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940605-103441-064_L1C_055-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940605-103441-064_L1C_055-261-0_D_V1-0.zip
run script
2024-01-09T17:26:15.866    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:26:15.867    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940605-103441-064_L1C_055-261-0_D_V1-0.zip
2024-01-09T17:26:15.867    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:26:15.867    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:26:15.867    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:26:15.867    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:26:15.867    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:26:15.867    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:26:15.868    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:26:15.868    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940605-103441-064_L1C_055-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/06/05/SPOT2-HRV1-XS_19940605-103449-411_L1C_055-262-0_D_V1-0/SPOT2-HRV1-XS_19940605-103449-411_L1C_055-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940605-103449-411_L1C_055-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940605-103449-411_L1C_055-262-0_D_V1-0.zip
run script
2024-01-09T17:27:18.551    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:27:18.552    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940605-103449-411_L1C_055-262-0_D_V1-0.zip
2024-01-09T17:27:18.552    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:27:18.552    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:27:18.552    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:27:18.552    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:27:18.552    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:27:18.552    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:27:18.552    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:27:18.552    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940605-103449-411_L1C_055-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/06/06/SPOT2-HRV1-XS_19940606-101521-297_L1C_055-261-0_D_V1-0/SPOT2-HRV1-XS_19940606-101521-297_L1C_055-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940606-101521-297_L1C_055-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940606-101521-297_L1C_055-261-0_D_V1-0.zip
run script
2024-01-09T17:28:31.163    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:28:31.164    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940606-101521-297_L1C_055-261-0_D_V1-0.zip
2024-01-09T17:28:31.164    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:28:31.164    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:28:31.164    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:28:31.164    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:28:31.164    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:28:31.164    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:28:31.164    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:28:31.165    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940606-101521-297_L1C_055-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/06/06/SPOT2-HRV1-XS_19940606-101529-563_L1C_055-262-0_D_V1-0/SPOT2-HRV1-XS_19940606-101529-563_L1C_055-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940606-101529-563_L1C_055-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940606-101529-563_L1C_055-262-0_D_V1-0.zip
run script
2024-01-09T17:29:34.404    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:29:34.411    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940606-101529-563_L1C_055-262-0_D_V1-0.zip
2024-01-09T17:29:34.411    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:29:34.411    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:29:34.412    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:29:34.412    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:29:34.412    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:29:34.412    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:29:34.412    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:29:34.412    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940606-101529-563_L1C_055-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/07/02/SPOT2-HRV1-XS_19940702-101515-355_L1C_055-261-0_D_V1-0/SPOT2-HRV1-XS_19940702-101515-355_L1C_055-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940702-101515-355_L1C_055-261-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940702-101515-355_L1C_055-261-0_D_V1-0.zip
run script
2024-01-09T17:30:43.656    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:30:43.657    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940702-101515-355_L1C_055-261-0_D_V1-0.zip
2024-01-09T17:30:43.657    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:30:43.657    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:30:43.657    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:30:43.657    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:30:43.657    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:30:43.658    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:30:43.658    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:30:43.658    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940702-101515-355_L1C_055-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1994/07/02/SPOT2-HRV1-XS_19940702-101523-618_L1C_055-262-0_D_V1-0/SPOT2-HRV1-XS_19940702-101523-618_L1C_055-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19940702-101523-618_L1C_055-262-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940702-101523-618_L1C_055-262-0_D_V1-0.zip
run script
2024-01-09T17:31:31.005    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:31:31.006    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940702-101523-618_L1C_055-262-0_D_V1-0.zip
2024-01-09T17:31:31.006    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:31:31.006    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:31:31.006    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:31:31.006    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:31:31.006    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:31:31.006    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:31:31.006    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:31:31.006    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19940702-101523-618_L1C_055-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/04/12/SPOT2-HRV1-XS_19950412-105332-467_L1C_046-263-0_D_V1-0/SPOT2-HRV1-XS_19950412-105332-467_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19950412-105332-467_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19950412-105332-467_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T17:32:26.438    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:32:26.439    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19950412-105332-467_L1C_046-263-0_D_V1-0.zip
2024-01-09T17:32:26.439    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:32:26.439    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:32:26.440    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:32:26.440    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:32:26.440    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:32:26.440    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:32:26.440    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:32:26.440    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19950412-105332-467_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/12/13/SPOT2-HRV1-XS_19951213-104145-074_L1C_047-254-4_D_V1-0/SPOT2-HRV1-XS_19951213-104145-074_L1C_047-254-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19951213-104145-074_L1C_047-254-4_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19951213-104145-074_L1C_047-254-4_D_V1-0.zip
run script
2024-01-09T17:32:50.680    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:32:50.680    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19951213-104145-074_L1C_047-254-4_D_V1-0.zip
2024-01-09T17:32:50.680    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:32:50.681    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:32:50.681    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:32:50.681    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:32:50.681    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:32:50.681    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:32:50.681    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:32:50.681    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19951213-104145-074_L1C_047-254-4_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/12/13/SPOT2-HRV1-XS_19951213-104149-721_L1C_047-255-0_D_V1-0/SPOT2-HRV1-XS_19951213-104149-721_L1C_047-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19951213-104149-721_L1C_047-255-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19951213-104149-721_L1C_047-255-0_D_V1-0.zip
run script
2024-01-09T17:32:53.945    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:32:53.945    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19951213-104149-721_L1C_047-255-0_D_V1-0.zip
2024-01-09T17:32:53.946    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:32:53.946    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:32:53.946    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:32:53.946    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:32:53.946    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:32:53.946    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:32:53.946    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:32:53.946    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19951213-104149-721_L1C_047-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/12/13/SPOT2-HRV1-XS_19951213-104157-990_L1C_048-256-0_D_V1-0/SPOT2-HRV1-XS_19951213-104157-990_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19951213-104157-990_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19951213-104157-990_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T17:33:06.660    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:33:06.661    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19951213-104157-990_L1C_048-256-0_D_V1-0.zip
2024-01-09T17:33:06.661    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:33:06.661    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:33:06.661    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:33:06.661    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:33:06.661    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:33:06.661    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:33:06.661    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:33:06.661    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19951213-104157-990_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/12/13/SPOT2-HRV1-XS_19951213-104206-265_L1C_048-257-0_D_V1-0/SPOT2-HRV1-XS_19951213-104206-265_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19951213-104206-265_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19951213-104206-265_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T17:33:21.393    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:33:21.394    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19951213-104206-265_L1C_048-257-0_D_V1-0.zip
2024-01-09T17:33:21.394    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:33:21.394    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:33:21.394    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:33:21.394    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:33:21.394    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:33:21.394    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:33:21.395    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:33:21.395    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19951213-104206-265_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/12/13/SPOT2-HRV1-XS_19951213-104213-485_L1C_048-257-8_D_V1-0/SPOT2-HRV1-XS_19951213-104213-485_L1C_048-257-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19951213-104213-485_L1C_048-257-8_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19951213-104213-485_L1C_048-257-8_D_V1-0.zip
run script
2024-01-09T17:33:24.476    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:33:24.477    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19951213-104213-485_L1C_048-257-8_D_V1-0.zip
2024-01-09T17:33:24.477    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:33:24.477    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:33:24.477    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:33:24.477    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:33:24.477    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:33:24.477    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:33:24.477    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:33:24.477    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19951213-104213-485_L1C_048-257-8_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/12/12/SPOT2-HRV2-XS_19951212-110140-689_L1C_047-259-0_D_V1-0/SPOT2-HRV2-XS_19951212-110140-689_L1C_047-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19951212-110140-689_L1C_047-259-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19951212-110140-689_L1C_047-259-0_D_V1-0.zip
run script
2024-01-09T17:33:27.610    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:33:27.611    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19951212-110140-689_L1C_047-259-0_D_V1-0.zip
2024-01-09T17:33:27.611    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:33:27.611    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:33:27.611    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:33:27.611    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:33:27.611    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:33:27.611    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:33:27.611    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:33:27.611    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19951212-110140-689_L1C_047-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/12/12/SPOT2-HRV2-XS_19951212-110149-111_L1C_047-260-0_D_V1-0/SPOT2-HRV2-XS_19951212-110149-111_L1C_047-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19951212-110149-111_L1C_047-260-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19951212-110149-111_L1C_047-260-0_D_V1-0.zip
run script
2024-01-09T17:33:30.657    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:33:30.658    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19951212-110149-111_L1C_047-260-0_D_V1-0.zip
2024-01-09T17:33:30.659    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:33:30.659    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:33:30.659    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:33:30.659    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:33:30.659    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:33:30.659    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:33:30.659    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:33:30.659    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19951212-110149-111_L1C_047-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/06/19/SPOT2-HRV2-XS_19950619-104553-414_L1C_047-260-4_D_V1-0/SPOT2-HRV2-XS_19950619-104553-414_L1C_047-260-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19950619-104553-414_L1C_047-260-4_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950619-104553-414_L1C_047-260-4_D_V1-0.zip
run script
2024-01-09T17:33:33.913    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:33:33.914    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950619-104553-414_L1C_047-260-4_D_V1-0.zip
2024-01-09T17:33:33.914    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:33:33.914    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:33:33.914    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:33:33.914    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:33:33.915    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:33:33.915    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:33:33.915    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:33:33.915    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950619-104553-414_L1C_047-260-4_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/05/04/SPOT2-HRV1-XS_19950504-102923-169_L1C_048-254-9_D_V1-0/SPOT2-HRV1-XS_19950504-102923-169_L1C_048-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19950504-102923-169_L1C_048-254-9_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19950504-102923-169_L1C_048-254-9_D_V1-0.zip
run script
2024-01-09T17:33:38.955    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:33:38.955    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19950504-102923-169_L1C_048-254-9_D_V1-0.zip
2024-01-09T17:33:38.955    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:33:38.955    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:33:38.955    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:33:38.956    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:33:38.956    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:33:38.956    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:33:38.956    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:33:38.956    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19950504-102923-169_L1C_048-254-9_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/05/04/SPOT2-HRV1-XS_19950504-102923-253_L1C_048-255-0_D_V1-0/SPOT2-HRV1-XS_19950504-102923-253_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19950504-102923-253_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19950504-102923-253_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T17:33:54.386    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:33:54.387    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19950504-102923-253_L1C_048-255-0_D_V1-0.zip
2024-01-09T17:33:54.387    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:33:54.387    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:33:54.387    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:33:54.387    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:33:54.388    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:33:54.388    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:33:54.388    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:33:54.388    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19950504-102923-253_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/05/04/SPOT2-HRV1-XS_19950504-102926-863_L1C_048-255-4_D_V1-0/SPOT2-HRV1-XS_19950504-102926-863_L1C_048-255-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19950504-102926-863_L1C_048-255-4_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19950504-102926-863_L1C_048-255-4_D_V1-0.zip
run script
2024-01-09T17:34:09.958    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:34:09.959    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19950504-102926-863_L1C_048-255-4_D_V1-0.zip
2024-01-09T17:34:09.959    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:34:09.959    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:34:09.959    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:34:09.959    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:34:09.959    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:34:09.959    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:34:09.959    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:34:09.960    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19950504-102926-863_L1C_048-255-4_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/05/04/SPOT2-HRV2-XS_19950504-102948-150_L1C_049-258-1_D_V1-0/SPOT2-HRV2-XS_19950504-102948-150_L1C_049-258-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19950504-102948-150_L1C_049-258-1_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950504-102948-150_L1C_049-258-1_D_V1-0.zip
run script
2024-01-09T17:34:33.753    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:34:33.755    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950504-102948-150_L1C_049-258-1_D_V1-0.zip
2024-01-09T17:34:33.755    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:34:33.755    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:34:33.755    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:34:33.755    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:34:33.755    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:34:33.755    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:34:33.755    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:34:33.755    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950504-102948-150_L1C_049-258-1_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/05/04/SPOT2-HRV2-XS_19950504-102955-499_L1C_049-259-0_D_V1-0/SPOT2-HRV2-XS_19950504-102955-499_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19950504-102955-499_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950504-102955-499_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T17:35:05.415    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:35:05.416    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950504-102955-499_L1C_049-259-0_D_V1-0.zip
2024-01-09T17:35:05.416    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:35:05.416    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:35:05.416    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:35:05.416    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:35:05.417    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:35:05.417    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:35:05.417    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:35:05.417    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950504-102955-499_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/05/04/SPOT2-HRV2-XS_19950504-103003-759_L1C_049-260-0_D_V1-0/SPOT2-HRV2-XS_19950504-103003-759_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19950504-103003-759_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950504-103003-759_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T17:35:28.995    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:35:28.996    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950504-103003-759_L1C_049-260-0_D_V1-0.zip
2024-01-09T17:35:28.996    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:35:28.996    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:35:28.996    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:35:28.996    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:35:28.996    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:35:28.996    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:35:28.996    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:35:28.996    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:35:31.776    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (219 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950504-103003-759_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1995/05/04/SPOT2-HRV2-XS_19950504-103009-173_L1C_049-260-6_D_V1-0/SPOT2-HRV2-XS_19950504-103009-173_L1C_049-260-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19950504-103009-173_L1C_049-260-6_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950504-103009-173_L1C_049-260-6_D_V1-0.zip
run script
2024-01-09T17:35:35.114    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:35:35.115    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950504-103009-173_L1C_049-260-6_D_V1-0.zip
2024-01-09T17:35:35.115    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:35:35.115    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:35:35.115    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:35:35.115    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:35:35.115    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:35:35.115    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:35:35.115    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:35:35.116    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950504-103009-173_L1C_049-260-6_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/05/04/SPOT2-HRV2-XS_19950504-103020-149_L1C_049-261-9_D_V1-0/SPOT2-HRV2-XS_19950504-103020-149_L1C_049-261-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19950504-103020-149_L1C_049-261-9_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950504-103020-149_L1C_049-261-9_D_V1-0.zip
run script
2024-01-09T17:35:38.630    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:35:38.631    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950504-103020-149_L1C_049-261-9_D_V1-0.zip
2024-01-09T17:35:38.631    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:35:38.632    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:35:38.632    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:35:38.632    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:35:38.632    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:35:38.632    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:35:38.632    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:35:38.632    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950504-103020-149_L1C_049-261-9_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/05/24/SPOT2-HRV2-XS_19950524-104504-451_L1C_048-255-9_D_V1-0/SPOT2-HRV2-XS_19950524-104504-451_L1C_048-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19950524-104504-451_L1C_048-255-9_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950524-104504-451_L1C_048-255-9_D_V1-0.zip
run script
2024-01-09T17:35:42.552    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:35:42.553    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950524-104504-451_L1C_048-255-9_D_V1-0.zip
2024-01-09T17:35:42.553    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:35:42.553    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:35:42.553    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:35:42.553    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:35:42.553    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:35:42.553    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:35:42.553    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:35:42.553    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950524-104504-451_L1C_048-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/05/24/SPOT2-HRV2-XS_19950524-104504-626_L1C_048-256-0_D_V1-0/SPOT2-HRV2-XS_19950524-104504-626_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19950524-104504-626_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950524-104504-626_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T17:36:26.981    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:36:26.982    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950524-104504-626_L1C_048-256-0_D_V1-0.zip
2024-01-09T17:36:26.982    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:36:26.982    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:36:26.982    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:36:26.983    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:36:26.983    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:36:26.983    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:36:26.983    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:36:26.983    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950524-104504-626_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/05/24/SPOT2-HRV2-XS_19950524-104512-931_L1C_048-257-0_D_V1-0/SPOT2-HRV2-XS_19950524-104512-931_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19950524-104512-931_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950524-104512-931_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T17:37:10.748    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:37:10.749    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950524-104512-931_L1C_048-257-0_D_V1-0.zip
2024-01-09T17:37:10.749    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:37:10.749    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:37:10.749    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:37:10.749    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:37:10.750    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:37:10.750    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:37:10.750    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:37:10.750    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950524-104512-931_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/05/24/SPOT2-HRV2-XS_19950524-104521-245_L1C_048-258-0_D_V1-0/SPOT2-HRV2-XS_19950524-104521-245_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19950524-104521-245_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950524-104521-245_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T17:37:41.290    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:37:41.291    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950524-104521-245_L1C_048-258-0_D_V1-0.zip
2024-01-09T17:37:41.291    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:37:41.292    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:37:41.292    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:37:41.292    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:37:41.292    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:37:41.292    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:37:41.292    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:37:41.292    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950524-104521-245_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/05/24/SPOT2-HRV2-XS_19950524-104529-565_L1C_048-259-0_D_V1-0/SPOT2-HRV2-XS_19950524-104529-565_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19950524-104529-565_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950524-104529-565_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T17:37:51.096    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:37:51.097    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950524-104529-565_L1C_048-259-0_D_V1-0.zip
2024-01-09T17:37:51.098    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:37:51.098    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:37:51.098    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:37:51.098    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:37:51.098    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:37:51.098    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:37:51.098    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:37:51.098    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950524-104529-565_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/05/24/SPOT2-HRV2-XS_19950524-104531-370_L1C_048-259-2_D_V1-0/SPOT2-HRV2-XS_19950524-104531-370_L1C_048-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19950524-104531-370_L1C_048-259-2_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950524-104531-370_L1C_048-259-2_D_V1-0.zip
run script
2024-01-09T17:37:54.219    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:37:54.221    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950524-104531-370_L1C_048-259-2_D_V1-0.zip
2024-01-09T17:37:54.221    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:37:54.221    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:37:54.221    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:37:54.221    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:37:54.221    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:37:54.221    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:37:54.221    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:37:54.221    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950524-104531-370_L1C_048-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/07/20/SPOT2-HRV1-XS_19950720-104917-328_L1C_048-255-7_D_V1-0/SPOT2-HRV1-XS_19950720-104917-328_L1C_048-255-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19950720-104917-328_L1C_048-255-7_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19950720-104917-328_L1C_048-255-7_D_V1-0.zip
run script
2024-01-09T17:37:57.252    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:37:57.253    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19950720-104917-328_L1C_048-255-7_D_V1-0.zip
2024-01-09T17:37:57.254    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:37:57.254    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:37:57.254    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:37:57.254    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:37:57.254    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:37:57.254    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:37:57.254    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:37:57.254    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19950720-104917-328_L1C_048-255-7_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/07/20/SPOT2-HRV1-XS_19950720-104919-331_L1C_048-256-0_D_V1-0/SPOT2-HRV1-XS_19950720-104919-331_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19950720-104919-331_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19950720-104919-331_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T17:38:41.801    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:38:41.803    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19950720-104919-331_L1C_048-256-0_D_V1-0.zip
2024-01-09T17:38:41.803    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:38:41.803    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:38:41.803    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:38:41.803    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:38:41.803    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:38:41.803    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:38:41.803    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:38:41.803    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19950720-104919-331_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/07/20/SPOT2-HRV1-XS_19950720-104927-660_L1C_048-257-0_D_V1-0/SPOT2-HRV1-XS_19950720-104927-660_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19950720-104927-660_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19950720-104927-660_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T17:39:28.992    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:39:28.993    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19950720-104927-660_L1C_048-257-0_D_V1-0.zip
2024-01-09T17:39:28.993    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:39:28.993    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:39:28.993    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:39:28.993    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:39:28.993    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:39:28.993    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:39:28.993    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:39:28.993    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19950720-104927-660_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/07/20/SPOT2-HRV1-XS_19950720-104935-998_L1C_048-258-0_D_V1-0/SPOT2-HRV1-XS_19950720-104935-998_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19950720-104935-998_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19950720-104935-998_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T17:40:01.745    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:40:01.746    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19950720-104935-998_L1C_048-258-0_D_V1-0.zip
2024-01-09T17:40:01.747    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:40:01.747    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:40:01.747    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:40:01.747    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:40:01.747    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:40:01.747    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:40:01.747    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:40:01.747    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19950720-104935-998_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/07/20/SPOT2-HRV1-XS_19950720-104943-218_L1C_048-258-8_D_V1-0/SPOT2-HRV1-XS_19950720-104943-218_L1C_048-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19950720-104943-218_L1C_048-258-8_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19950720-104943-218_L1C_048-258-8_D_V1-0.zip
run script
2024-01-09T17:40:13.519    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:40:13.520    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19950720-104943-218_L1C_048-258-8_D_V1-0.zip
2024-01-09T17:40:13.520    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:40:13.520    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:40:13.520    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:40:13.520    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:40:13.520    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:40:13.520    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:40:13.520    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:40:13.521    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV1-XS_19950720-104943-218_L1C_048-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/07/20/SPOT2-HRV2-XS_19950720-104934-179_L1C_049-258-0_D_V1-0/SPOT2-HRV2-XS_19950720-104934-179_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19950720-104934-179_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950720-104934-179_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T17:40:16.966    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:40:16.968    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950720-104934-179_L1C_049-258-0_D_V1-0.zip
2024-01-09T17:40:16.968    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:40:16.968    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:40:16.968    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:40:16.968    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:40:16.968    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:40:16.968    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:40:16.968    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:40:16.968    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:41:31.668    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 362). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950720-104934-179_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1995/07/20/SPOT2-HRV2-XS_19950720-104942-541_L1C_049-259-0_D_V1-0/SPOT2-HRV2-XS_19950720-104942-541_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19950720-104942-541_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950720-104942-541_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T17:41:34.730    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:41:34.731    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950720-104942-541_L1C_049-259-0_D_V1-0.zip
2024-01-09T17:41:34.731    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:41:34.731    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:41:34.731    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:41:34.731    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:41:34.731    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:41:34.731    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:41:34.731    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:41:34.731    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016157/INPUT/SPOT2-HRV2-XS_19950720-104942-541_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016157/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
end
[2024-01-09 17:42:38.000922660+00:00] cnes_level2/barrouz/4016157:  Account (env) = cnes_level2
[2024-01-09 17:42:38.002276281+00:00] cnes_level2/barrouz/4016157:     User (env) = barrouz
[2024-01-09 17:42:38.003683481+00:00] cnes_level2/barrouz/4016157:        GroupId = cesbio(426000053)
[2024-01-09 17:42:38.005009442+00:00] cnes_level2/barrouz/4016157:         UserId = barrouz(9134)
[2024-01-09 17:42:38.006364603+00:00] cnes_level2/barrouz/4016157:        Account = cnes_level2
[2024-01-09 17:42:38.007753824+00:00] cnes_level2/barrouz/4016157:        Account = cnes_level2
[2024-01-09 17:42:38.009013935+00:00] cnes_level2/barrouz/4016157:      Partition = cpu2022
[2024-01-09 17:42:38.010237047+00:00] cnes_level2/barrouz/4016157:            QOS = cpu_2022_1280
[2024-01-09 17:42:38.011439698+00:00] cnes_level2/barrouz/4016157:        JobName = inf_ALP_50_TCD-ONLY_AVG-1200
[2024-01-09 17:42:38.012661440+00:00] cnes_level2/barrouz/4016157:     SubmitTime = 2024-01-09T10:51:20
[2024-01-09 17:42:38.013908612+00:00] cnes_level2/barrouz/4016157:        RunTime = 06:11:24
[2024-01-09 17:42:38.015160673+00:00] cnes_level2/barrouz/4016157:      TimeLimit = 1-16:00:00
[2024-01-09 17:42:38.016435945+00:00] cnes_level2/barrouz/4016157:   EligibleTime = 2024-01-09T10:51:20
[2024-01-09 17:42:38.017668966+00:00] cnes_level2/barrouz/4016157:      StartTime = 2024-01-09T11:31:13
[2024-01-09 17:42:38.018964907+00:00] cnes_level2/barrouz/4016157:        EndTime = 2024-01-09T17:42:37
[2024-01-09 17:42:38.020132670+00:00] cnes_level2/barrouz/4016157:       ExitCode = 0:0
[2024-01-09 17:42:38.021466411+00:00] cnes_level2/barrouz/4016157:       NodeList = trex077
[2024-01-09 17:42:38.022785092+00:00] cnes_level2/barrouz/4016157:      BatchHost = trex077
[2024-01-09 17:42:38.024207132+00:00] cnes_level2/barrouz/4016157:           TRES = 
[2024-01-09 17:42:38.025439714+00:00] cnes_level2/barrouz/4016157:        Command = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
[2024-01-09 17:42:38.026715655+00:00] cnes_level2/barrouz/4016157:        WorkDir = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code
[2024-01-09 17:42:38.027899347+00:00] cnes_level2/barrouz/4016157:         StdErr = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_50_TCD-ONLY_AVG-1200.log
[2024-01-09 17:42:38.029078709+00:00] cnes_level2/barrouz/4016157:         StdOut = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_50_TCD-ONLY_AVG-1200.log

#########################################
#        EVIDEN - CNES                  #
#        Job Accounting                 #
#########################################
Cluster              : trex
JobIDRaw             : 4016157
JobID                : 4016157
JobName              : inf_ALP_50_TCD-ONLY_AVG-1200
Account              : cnes_level2
User                 : barrouz(9134), cesbio(426000053)
Partition            : cpu2022
QOS                  : cpu_2022_1280
Nodelist             : trex077 (1)
State                : COMPLETED  (Exitcode=0:0, DerivedExitCode=0:0, Restarts=0)
Submit date          : 2024-01-09T10:51:20
Start time           : 2024-01-09T11:31:13
End time             : 2024-01-09T17:42:37
Elapsed time         : 06:11:24  (Timelimit=1-16:00:00, Suspended=00:00:00)
TEI                  : 2 days, 1:31:12
Command              : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
StdOut               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_50_TCD-ONLY_AVG-1200.log
StdErr               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_50_TCD-ONLY_AVG-1200.log

STEP(s) : 2
--------- 
   StepID  | JobName      State       Exit   Start               End                 Elapsed   TotalCPU   CPUTime    ConsumedEnergy MaxDiskRead MaxDiskWrite     MaxRSS MaxRSSTask MaxRSSNode NNodes UserCPU    NodeList
   ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 
   batch   | batch        COMPLETED   0:0    2024-01-09T11:31:13 2024-01-09T17:42:37 06:11:24  1-05:25:02 2-01:31:12      0.179375M  189251.77M    78745.83M  89720048K          0    trex077      1 20:26:29   trex077
   extern  | extern       COMPLETED   0:0    2024-01-09T11:31:13 2024-01-09T17:42:37 06:11:24  00:00.001  2-01:31:12      0.179375M       0.00M        0.00M      1680K          0    trex077      1 00:00:00   trex077

