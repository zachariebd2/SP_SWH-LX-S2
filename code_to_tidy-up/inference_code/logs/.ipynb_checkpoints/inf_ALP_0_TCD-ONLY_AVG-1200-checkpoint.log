unload conda/22.11.1  : OK 
load conda/22.11.1  : OK 
envs_dirs : /work/scratch/env/barrouz/conda_env/
pkgs_dirs : /work/scratch/env/barrouz/pkgs_conda
INPUT_PATH /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/0.txt
OUTPUT_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
DEM_PATH /work/CAMPUS/etudes/Neige/DEM
TCD_PATH /work/datalake/static_aux/TreeCoverDensity
MODELS_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
KEEP_REFL 0
MASK 1
start
/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/0.txt
muscate/SPOTWORLDHERITAGE/1991/06/14/SPOT2-HRV1-XS_19910614-103925-334_L1C_046-262-8_D_V1-0/SPOT2-HRV1-XS_19910614-103925-334_L1C_046-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910614-103925-334_L1C_046-262-8_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910614-103925-334_L1C_046-262-8_D_V1-0.zip
run script
2024-01-09T10:51:24.635    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:51:24.636    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910614-103925-334_L1C_046-262-8_D_V1-0.zip
2024-01-09T10:51:24.636    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:51:24.636    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:51:24.636    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:51:24.636    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:51:24.636    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:51:24.636    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:51:24.636    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:51:24.636    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910614-103925-334_L1C_046-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/06/14/SPOT2-HRV1-XS_19910614-103926-402_L1C_046-263-0_D_V1-0/SPOT2-HRV1-XS_19910614-103926-402_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910614-103926-402_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910614-103926-402_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T10:52:00.803    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:52:00.804    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910614-103926-402_L1C_046-263-0_D_V1-0.zip
2024-01-09T10:52:00.804    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:52:00.804    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:52:00.804    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:52:00.804    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:52:00.805    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:52:00.805    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:52:00.805    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:52:00.805    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910614-103926-402_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/07/SPOT2-HRV2-XS_19910407-104655-427_L1C_046-263-0_D_V1-0/SPOT2-HRV2-XS_19910407-104655-427_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910407-104655-427_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910407-104655-427_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T10:52:39.546    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:52:39.547    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910407-104655-427_L1C_046-263-0_D_V1-0.zip
2024-01-09T10:52:39.547    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:52:39.547    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:52:39.547    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:52:39.547    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:52:39.547    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:52:39.547    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:52:39.547    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:52:39.547    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910407-104655-427_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/06/03/SPOT2-HRV2-XS_19910603-105108-652_L1C_046-263-0_D_V1-0/SPOT2-HRV2-XS_19910603-105108-652_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910603-105108-652_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910603-105108-652_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T10:53:21.056    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:53:21.057    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910603-105108-652_L1C_046-263-0_D_V1-0.zip
2024-01-09T10:53:21.057    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:53:21.058    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:53:21.058    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:53:21.058    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:53:21.058    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:53:21.058    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:53:21.058    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:53:21.058    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910603-105108-652_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/06/08/SPOT2-HRV2-XS_19910608-105458-154_L1C_046-263-0_D_V1-0/SPOT2-HRV2-XS_19910608-105458-154_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910608-105458-154_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910608-105458-154_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T10:54:04.867    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:54:04.868    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910608-105458-154_L1C_046-263-0_D_V1-0.zip
2024-01-09T10:54:04.868    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:54:04.868    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:54:04.868    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:54:04.868    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:54:04.868    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:54:04.868    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:54:04.868    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:54:04.868    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910608-105458-154_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/06/09/SPOT2-HRV1-XS_19910609-103538-696_L1C_046-263-0_D_V1-0/SPOT2-HRV1-XS_19910609-103538-696_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910609-103538-696_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910609-103538-696_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T10:54:40.420    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:54:40.421    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910609-103538-696_L1C_046-263-0_D_V1-0.zip
2024-01-09T10:54:40.421    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:54:40.421    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:54:40.421    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:54:40.421    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:54:40.421    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:54:40.421    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:54:40.421    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:54:40.421    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910609-103538-696_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/11/11/SPOT2-HRV2-XS_19911111-105538-343_L1C_046-263-0_D_V1-0/SPOT2-HRV2-XS_19911111-105538-343_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19911111-105538-343_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911111-105538-343_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T10:55:23.934    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:55:23.935    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911111-105538-343_L1C_046-263-0_D_V1-0.zip
2024-01-09T10:55:23.935    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:55:23.935    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:55:23.935    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:55:23.935    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:55:23.935    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:55:23.936    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:55:23.936    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:55:23.936    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911111-105538-343_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/01/SPOT2-HRV1-XS_19910401-110101-901_L1C_047-254-0_D_V1-0/SPOT2-HRV1-XS_19910401-110101-901_L1C_047-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910401-110101-901_L1C_047-254-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910401-110101-901_L1C_047-254-0_D_V1-0.zip
run script
2024-01-09T10:55:47.724    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:55:47.725    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910401-110101-901_L1C_047-254-0_D_V1-0.zip
2024-01-09T10:55:47.725    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:55:47.725    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:55:47.725    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:55:47.726    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:55:47.726    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:55:47.726    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:55:47.726    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:55:47.726    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910401-110101-901_L1C_047-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/04/01/SPOT2-HRV1-XS_19910401-110110-296_L1C_047-255-0_D_V1-0/SPOT2-HRV1-XS_19910401-110110-296_L1C_047-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910401-110110-296_L1C_047-255-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910401-110110-296_L1C_047-255-0_D_V1-0.zip
run script
2024-01-09T10:55:51.500    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:55:51.502    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910401-110110-296_L1C_047-255-0_D_V1-0.zip
2024-01-09T10:55:51.502    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:55:51.502    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:55:51.502    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:55:51.502    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:55:51.502    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:55:51.502    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:55:51.502    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:55:51.502    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910401-110110-296_L1C_047-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/01/SPOT2-HRV1-XS_19910401-110118-698_L1C_047-256-0_D_V1-0/SPOT2-HRV1-XS_19910401-110118-698_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910401-110118-698_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910401-110118-698_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T10:56:05.925    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:56:05.926    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910401-110118-698_L1C_047-256-0_D_V1-0.zip
2024-01-09T10:56:05.926    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:56:05.927    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:56:05.927    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:56:05.927    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:56:05.927    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:56:05.927    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:56:05.927    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:56:05.927    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910401-110118-698_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/01/SPOT2-HRV1-XS_19910401-110122-307_L1C_047-256-4_D_V1-0/SPOT2-HRV1-XS_19910401-110122-307_L1C_047-256-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910401-110122-307_L1C_047-256-4_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910401-110122-307_L1C_047-256-4_D_V1-0.zip
run script
2024-01-09T10:56:18.595    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:56:18.596    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910401-110122-307_L1C_047-256-4_D_V1-0.zip
2024-01-09T10:56:18.596    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:56:18.596    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:56:18.596    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:56:18.596    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:56:18.596    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:56:18.597    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:56:18.597    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:56:18.597    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910401-110122-307_L1C_047-256-4_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/04/01/SPOT2-HRV2-XS_19910401-110138-586_L1C_049-258-6_D_V1-0/SPOT2-HRV2-XS_19910401-110138-586_L1C_049-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910401-110138-586_L1C_049-258-6_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910401-110138-586_L1C_049-258-6_D_V1-0.zip
run script
2024-01-09T10:56:22.062    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:56:22.062    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910401-110138-586_L1C_049-258-6_D_V1-0.zip
2024-01-09T10:56:22.062    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:56:22.062    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:56:22.062    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:56:22.063    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:56:22.063    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:56:22.063    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:56:22.063    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:56:22.063    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910401-110138-586_L1C_049-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 0 ... 2 2 2]
 [2 2 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/01/SPOT2-HRV2-XS_19910401-110141-613_L1C_049-259-0_D_V1-0/SPOT2-HRV2-XS_19910401-110141-613_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910401-110141-613_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910401-110141-613_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T10:57:06.274    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:57:06.276    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910401-110141-613_L1C_049-259-0_D_V1-0.zip
2024-01-09T10:57:06.276    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:57:06.276    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:57:06.276    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:57:06.276    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:57:06.276    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:57:06.276    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:57:06.276    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:57:06.276    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910401-110141-613_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 2 0 ... 2 2 2]
 [0 2 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/01/SPOT2-HRV2-XS_19910401-110150-056_L1C_049-260-0_D_V1-0/SPOT2-HRV2-XS_19910401-110150-056_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910401-110150-056_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910401-110150-056_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T10:57:40.346    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:57:40.347    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910401-110150-056_L1C_049-260-0_D_V1-0.zip
2024-01-09T10:57:40.347    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:57:40.348    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:57:40.348    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:57:40.348    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:57:40.348    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:57:40.348    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:57:40.348    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:57:40.348    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T10:57:44.099    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (930 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910401-110150-056_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1991/04/01/SPOT2-HRV2-XS_19910401-110152-763_L1C_049-260-3_D_V1-0/SPOT2-HRV2-XS_19910401-110152-763_L1C_049-260-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910401-110152-763_L1C_049-260-3_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910401-110152-763_L1C_049-260-3_D_V1-0.zip
run script
2024-01-09T10:57:48.638    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:57:48.640    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910401-110152-763_L1C_049-260-3_D_V1-0.zip
2024-01-09T10:57:48.640    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:57:48.640    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:57:48.640    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:57:48.640    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:57:48.640    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:57:48.640    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:57:48.640    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:57:48.640    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910401-110152-763_L1C_049-260-3_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/04/01/SPOT2-HRV2-XS_19910401-110057-545_L1C_050-254-0_D_V1-0/SPOT2-HRV2-XS_19910401-110057-545_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910401-110057-545_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910401-110057-545_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T10:57:51.674    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:57:51.676    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910401-110057-545_L1C_050-254-0_D_V1-0.zip
2024-01-09T10:57:51.676    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:57:51.676    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:57:51.676    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:57:51.676    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:57:51.676    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:57:51.676    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:57:51.676    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:57:51.676    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910401-110057-545_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/04/01/SPOT2-HRV2-XS_19910401-110105-992_L1C_050-255-0_D_V1-0/SPOT2-HRV2-XS_19910401-110105-992_L1C_050-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910401-110105-992_L1C_050-255-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910401-110105-992_L1C_050-255-0_D_V1-0.zip
run script
2024-01-09T10:57:54.951    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:57:54.951    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910401-110105-992_L1C_050-255-0_D_V1-0.zip
2024-01-09T10:57:54.951    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:57:54.951    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:57:54.951    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:57:54.951    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:57:54.951    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:57:54.951    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:57:54.951    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:57:54.951    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910401-110105-992_L1C_050-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/01/SPOT2-HRV2-XS_19910401-110114-441_L1C_050-256-0_D_V1-0/SPOT2-HRV2-XS_19910401-110114-441_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910401-110114-441_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910401-110114-441_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T10:59:00.880    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:59:00.881    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910401-110114-441_L1C_050-256-0_D_V1-0.zip
2024-01-09T10:59:00.881    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:59:00.881    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:59:00.881    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:59:00.881    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:59:00.881    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:59:00.881    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:59:00.882    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:59:00.882    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910401-110114-441_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/01/SPOT2-HRV2-XS_19910401-110121-660_L1C_050-256-8_D_V1-0/SPOT2-HRV2-XS_19910401-110121-660_L1C_050-256-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910401-110121-660_L1C_050-256-8_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910401-110121-660_L1C_050-256-8_D_V1-0.zip
run script
2024-01-09T11:02:29.444    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:02:29.445    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910401-110121-660_L1C_050-256-8_D_V1-0.zip
2024-01-09T11:02:29.445    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:02:29.445    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:02:29.445    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:02:29.445    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:02:29.445    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:02:29.445    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:02:29.445    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:02:29.445    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910401-110121-660_L1C_050-256-8_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/02/SPOT2-HRV1-XS_19910402-104153-460_L1C_047-255-0_D_V1-0/SPOT2-HRV1-XS_19910402-104153-460_L1C_047-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910402-104153-460_L1C_047-255-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910402-104153-460_L1C_047-255-0_D_V1-0.zip
run script
2024-01-09T11:06:10.697    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:06:10.698    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910402-104153-460_L1C_047-255-0_D_V1-0.zip
2024-01-09T11:06:10.698    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:06:10.698    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:06:10.698    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:06:10.698    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:06:10.698    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:06:10.698    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:06:10.698    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:06:10.699    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910402-104153-460_L1C_047-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/02/SPOT2-HRV1-XS_19910402-104201-726_L1C_047-256-0_D_V1-0/SPOT2-HRV1-XS_19910402-104201-726_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910402-104201-726_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910402-104201-726_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T11:06:23.105    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:06:23.108    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910402-104201-726_L1C_047-256-0_D_V1-0.zip
2024-01-09T11:06:23.109    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:06:23.109    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:06:23.109    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:06:23.109    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:06:23.109    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:06:23.109    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:06:23.109    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:06:23.109    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910402-104201-726_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/02/SPOT2-HRV1-XS_19910402-104209-847_L1C_047-256-9_D_V1-0/SPOT2-HRV1-XS_19910402-104209-847_L1C_047-256-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910402-104209-847_L1C_047-256-9_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910402-104209-847_L1C_047-256-9_D_V1-0.zip
run script
2024-01-09T11:06:37.438    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:06:37.439    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910402-104209-847_L1C_047-256-9_D_V1-0.zip
2024-01-09T11:06:37.439    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:06:37.439    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:06:37.439    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:06:37.439    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:06:37.439    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:06:37.439    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:06:37.440    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:06:37.440    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910402-104209-847_L1C_047-256-9_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/04/02/SPOT2-HRV1-XS_19910402-104210-004_L1C_048-257-0_D_V1-0/SPOT2-HRV1-XS_19910402-104210-004_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910402-104210-004_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910402-104210-004_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T11:06:40.644    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:06:40.645    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910402-104210-004_L1C_048-257-0_D_V1-0.zip
2024-01-09T11:06:40.645    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:06:40.645    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:06:40.645    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:06:40.645    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:06:40.645    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:06:40.645    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:06:40.645    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:06:40.645    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910402-104210-004_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/04/02/SPOT2-HRV2-XS_19910402-104141-079_L1C_051-254-0_D_V1-0/SPOT2-HRV2-XS_19910402-104141-079_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910402-104141-079_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910402-104141-079_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T11:06:44.437    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:06:44.438    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910402-104141-079_L1C_051-254-0_D_V1-0.zip
2024-01-09T11:06:44.438    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:06:44.438    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:06:44.438    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:06:44.438    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:06:44.438    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:06:44.438    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:06:44.438    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:06:44.438    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910402-104141-079_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/04/02/SPOT2-HRV2-XS_19910402-104149-375_L1C_051-255-0_D_V1-0/SPOT2-HRV2-XS_19910402-104149-375_L1C_051-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910402-104149-375_L1C_051-255-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910402-104149-375_L1C_051-255-0_D_V1-0.zip
run script
2024-01-09T11:06:47.760    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:06:47.761    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910402-104149-375_L1C_051-255-0_D_V1-0.zip
2024-01-09T11:06:47.761    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:06:47.761    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:06:47.761    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:06:47.761    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:06:47.761    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:06:47.762    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:06:47.762    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:06:47.762    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910402-104149-375_L1C_051-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 2]
 [0 0 0 ... 0 0 2]
 [0 0 0 ... 0 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/02/SPOT2-HRV2-XS_19910402-104205-801_L1C_051-256-9_D_V1-0/SPOT2-HRV2-XS_19910402-104205-801_L1C_051-256-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910402-104205-801_L1C_051-256-9_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910402-104205-801_L1C_051-256-9_D_V1-0.zip
run script
2024-01-09T11:07:37.276    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:07:37.277    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910402-104205-801_L1C_051-256-9_D_V1-0.zip
2024-01-09T11:07:37.277    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:07:37.277    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:07:37.277    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:07:37.277    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:07:37.277    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:07:37.277    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:07:37.277    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:07:37.277    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910402-104205-801_L1C_051-256-9_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 1 ... 1 1 1]
 [2 2 1 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/02/SPOT2-HRV2-XS_19910402-104205-991_L1C_051-257-0_D_V1-0/SPOT2-HRV2-XS_19910402-104205-991_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910402-104205-991_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910402-104205-991_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T11:10:38.277    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:10:38.278    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910402-104205-991_L1C_051-257-0_D_V1-0.zip
2024-01-09T11:10:38.278    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:10:38.278    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:10:38.278    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:10:38.278    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:10:38.278    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:10:38.278    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:10:38.278    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:10:38.279    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910402-104205-991_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/07/04/SPOT2-HRV2-XS_19910704-105402-721_L1C_047-255-0_D_V1-0/SPOT2-HRV2-XS_19910704-105402-721_L1C_047-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910704-105402-721_L1C_047-255-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910704-105402-721_L1C_047-255-0_D_V1-0.zip
run script
2024-01-09T11:13:38.711    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:13:38.713    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910704-105402-721_L1C_047-255-0_D_V1-0.zip
2024-01-09T11:13:38.713    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:13:38.713    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:13:38.713    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:13:38.713    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:13:38.713    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:13:38.713    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:13:38.713    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:13:38.713    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910704-105402-721_L1C_047-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/07/04/SPOT2-HRV2-XS_19910704-105411-062_L1C_047-256-0_D_V1-0/SPOT2-HRV2-XS_19910704-105411-062_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910704-105411-062_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910704-105411-062_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T11:13:48.826    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:13:48.827    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910704-105411-062_L1C_047-256-0_D_V1-0.zip
2024-01-09T11:13:48.828    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:13:48.828    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:13:48.828    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:13:48.828    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:13:48.828    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:13:48.828    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:13:48.828    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:13:48.828    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:13:50.720    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1850 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910704-105411-062_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1991/07/04/SPOT2-HRV2-XS_19910704-105411-965_L1C_047-256-1_D_V1-0/SPOT2-HRV2-XS_19910704-105411-965_L1C_047-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910704-105411-965_L1C_047-256-1_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910704-105411-965_L1C_047-256-1_D_V1-0.zip
run script
2024-01-09T11:13:53.875    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:13:53.877    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910704-105411-965_L1C_047-256-1_D_V1-0.zip
2024-01-09T11:13:53.877    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:13:53.877    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:13:53.877    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:13:53.877    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:13:53.877    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:13:53.877    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:13:53.877    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:13:53.877    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910704-105411-965_L1C_047-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/07/04/SPOT2-HRV1-XS_19910704-105434-278_L1C_048-259-0_D_V1-0/SPOT2-HRV1-XS_19910704-105434-278_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910704-105434-278_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910704-105434-278_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T11:13:57.209    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:13:57.210    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910704-105434-278_L1C_048-259-0_D_V1-0.zip
2024-01-09T11:13:57.210    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:13:57.210    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:13:57.210    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:13:57.210    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:13:57.210    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:13:57.210    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:13:57.210    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:13:57.210    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910704-105434-278_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/07/04/SPOT2-HRV1-XS_19910704-105442-661_L1C_048-260-0_D_V1-0/SPOT2-HRV1-XS_19910704-105442-661_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910704-105442-661_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910704-105442-661_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T11:14:14.525    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:14:14.526    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910704-105442-661_L1C_048-260-0_D_V1-0.zip
2024-01-09T11:14:14.526    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:14:14.526    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:14:14.526    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:14:14.526    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:14:14.526    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:14:14.526    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:14:14.527    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:14:14.527    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910704-105442-661_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/07/04/SPOT2-HRV1-XS_19910704-105451-051_L1C_048-261-0_D_V1-0/SPOT2-HRV1-XS_19910704-105451-051_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910704-105451-051_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910704-105451-051_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T11:14:17.884    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:14:17.885    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910704-105451-051_L1C_048-261-0_D_V1-0.zip
2024-01-09T11:14:17.886    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:14:17.886    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:14:17.886    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:14:17.887    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:14:17.890    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:14:17.893    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:14:17.895    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:14:17.898    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910704-105451-051_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/07/04/SPOT2-HRV1-XS_19910704-105432-221_L1C_049-258-7_D_V1-0/SPOT2-HRV1-XS_19910704-105432-221_L1C_049-258-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910704-105432-221_L1C_049-258-7_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910704-105432-221_L1C_049-258-7_D_V1-0.zip
run script
2024-01-09T11:14:21.160    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:14:21.162    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910704-105432-221_L1C_049-258-7_D_V1-0.zip
2024-01-09T11:14:21.162    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:14:21.162    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:14:21.162    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:14:21.162    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:14:21.162    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:14:21.162    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:14:21.162    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:14:21.162    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910704-105432-221_L1C_049-258-7_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/02/15/SPOT2-HRV2-XS_19910215-102706-680_L1C_047-256-6_D_V1-0/SPOT2-HRV2-XS_19910215-102706-680_L1C_047-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910215-102706-680_L1C_047-256-6_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910215-102706-680_L1C_047-256-6_D_V1-0.zip
run script
2024-01-09T11:14:44.604    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:14:44.605    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910215-102706-680_L1C_047-256-6_D_V1-0.zip
2024-01-09T11:14:44.605    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:14:44.605    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:14:44.605    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:14:44.605    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:14:44.605    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:14:44.605    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:14:44.606    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:14:44.606    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910215-102706-680_L1C_047-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/02/15/SPOT2-HRV2-XS_19910215-102709-474_L1C_047-257-0_D_V1-0/SPOT2-HRV2-XS_19910215-102709-474_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910215-102709-474_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910215-102709-474_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T11:14:47.976    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:14:47.978    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910215-102709-474_L1C_047-257-0_D_V1-0.zip
2024-01-09T11:14:47.978    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:14:47.978    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:14:47.978    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:14:47.978    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:14:47.978    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:14:47.978    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:14:47.978    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:14:47.978    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910215-102709-474_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/02/15/SPOT2-HRV2-XS_19910215-102717-698_L1C_047-258-0_D_V1-0/SPOT2-HRV2-XS_19910215-102717-698_L1C_047-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910215-102717-698_L1C_047-258-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910215-102717-698_L1C_047-258-0_D_V1-0.zip
run script
2024-01-09T11:14:51.235    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:14:51.236    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910215-102717-698_L1C_047-258-0_D_V1-0.zip
2024-01-09T11:14:51.236    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:14:51.236    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:14:51.236    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:14:51.236    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:14:51.236    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:14:51.236    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:14:51.236    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:14:51.236    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910215-102717-698_L1C_047-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/02/15/SPOT2-HRV1-XS_19910215-102800-159_L1C_047-263-0_D_V1-0/SPOT2-HRV1-XS_19910215-102800-159_L1C_047-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910215-102800-159_L1C_047-263-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910215-102800-159_L1C_047-263-0_D_V1-0.zip
run script
2024-01-09T11:14:54.800    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:14:54.801    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910215-102800-159_L1C_047-263-0_D_V1-0.zip
2024-01-09T11:14:54.801    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:14:54.801    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:14:54.801    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:14:54.801    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:14:54.801    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:14:54.801    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:14:54.801    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:14:54.801    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910215-102800-159_L1C_047-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/02/15/SPOT2-HRV2-XS_19910215-102725-928_L1C_048-259-0_D_V1-0/SPOT2-HRV2-XS_19910215-102725-928_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910215-102725-928_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910215-102725-928_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T11:15:12.157    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:15:12.158    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910215-102725-928_L1C_048-259-0_D_V1-0.zip
2024-01-09T11:15:12.158    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:15:12.158    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:15:12.158    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:15:12.158    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:15:12.158    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:15:12.158    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:15:12.158    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:15:12.158    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910215-102725-928_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/02/15/SPOT2-HRV2-XS_19910215-102734-170_L1C_048-260-0_D_V1-0/SPOT2-HRV2-XS_19910215-102734-170_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910215-102734-170_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910215-102734-170_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T11:15:15.454    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:15:15.455    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910215-102734-170_L1C_048-260-0_D_V1-0.zip
2024-01-09T11:15:15.455    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:15:15.455    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:15:15.456    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:15:15.456    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:15:15.456    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:15:15.456    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:15:15.456    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:15:15.456    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910215-102734-170_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/05/25/SPOT2-HRV1-XS_19910525-102250-280_L1C_048-254-5_D_V1-0/SPOT2-HRV1-XS_19910525-102250-280_L1C_048-254-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910525-102250-280_L1C_048-254-5_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910525-102250-280_L1C_048-254-5_D_V1-0.zip
run script
2024-01-09T11:15:18.807    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:15:18.808    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910525-102250-280_L1C_048-254-5_D_V1-0.zip
2024-01-09T11:15:18.810    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:15:18.810    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:15:18.810    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:15:18.810    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:15:18.810    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:15:18.810    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:15:18.810    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:15:18.810    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:15:20.138    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 1018). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910525-102250-280_L1C_048-254-5_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1991/05/25/SPOT2-HRV1-XS_19910525-102253-953_L1C_048-255-0_D_V1-0/SPOT2-HRV1-XS_19910525-102253-953_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910525-102253-953_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910525-102253-953_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T11:15:23.380    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:15:23.381    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910525-102253-953_L1C_048-255-0_D_V1-0.zip
2024-01-09T11:15:23.381    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:15:23.381    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:15:23.381    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:15:23.381    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:15:23.381    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:15:23.381    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:15:23.381    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:15:23.382    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910525-102253-953_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/05/25/SPOT2-HRV1-XS_19910525-102302-150_L1C_048-256-0_D_V1-0/SPOT2-HRV1-XS_19910525-102302-150_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910525-102302-150_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910525-102302-150_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T11:15:42.828    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:15:42.829    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910525-102302-150_L1C_048-256-0_D_V1-0.zip
2024-01-09T11:15:42.829    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:15:42.829    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:15:42.830    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:15:42.830    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:15:42.830    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:15:42.830    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:15:42.830    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:15:42.830    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910525-102302-150_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/05/25/SPOT2-HRV1-XS_19910525-102310-356_L1C_048-257-0_D_V1-0/SPOT2-HRV1-XS_19910525-102310-356_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910525-102310-356_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910525-102310-356_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T11:16:24.754    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:16:24.755    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910525-102310-356_L1C_048-257-0_D_V1-0.zip
2024-01-09T11:16:24.755    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:16:24.755    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:16:24.755    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:16:24.755    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:16:24.755    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:16:24.755    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:16:24.755    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:16:24.756    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910525-102310-356_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/05/25/SPOT2-HRV1-XS_19910525-102318-571_L1C_048-258-0_D_V1-0/SPOT2-HRV1-XS_19910525-102318-571_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910525-102318-571_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910525-102318-571_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T11:16:56.813    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:16:56.814    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910525-102318-571_L1C_048-258-0_D_V1-0.zip
2024-01-09T11:16:56.815    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:16:56.815    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:16:56.815    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:16:56.815    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:16:56.815    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:16:56.815    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:16:56.815    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:16:56.815    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910525-102318-571_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/05/25/SPOT2-HRV1-XS_19910525-102326-798_L1C_048-259-0_D_V1-0/SPOT2-HRV1-XS_19910525-102326-798_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910525-102326-798_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910525-102326-798_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T11:17:13.241    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:17:13.243    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910525-102326-798_L1C_048-259-0_D_V1-0.zip
2024-01-09T11:17:13.243    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:17:13.243    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:17:13.243    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:17:13.243    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:17:13.243    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:17:13.243    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:17:13.243    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:17:13.243    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:17:15.132    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (946 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910525-102326-798_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1991/05/25/SPOT2-HRV1-XS_19910525-102332-212_L1C_048-259-6_D_V1-0/SPOT2-HRV1-XS_19910525-102332-212_L1C_048-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910525-102332-212_L1C_048-259-6_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910525-102332-212_L1C_048-259-6_D_V1-0.zip
run script
2024-01-09T11:17:18.306    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:17:18.307    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910525-102332-212_L1C_048-259-6_D_V1-0.zip
2024-01-09T11:17:18.307    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:17:18.307    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:17:18.307    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:17:18.307    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:17:18.307    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:17:18.307    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:17:18.308    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:17:18.308    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910525-102332-212_L1C_048-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/07/05/SPOT2-HRV1-XS_19910705-103440-641_L1C_048-254-5_D_V1-0/SPOT2-HRV1-XS_19910705-103440-641_L1C_048-254-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910705-103440-641_L1C_048-254-5_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910705-103440-641_L1C_048-254-5_D_V1-0.zip
run script
2024-01-09T11:17:21.463    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:17:21.464    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910705-103440-641_L1C_048-254-5_D_V1-0.zip
2024-01-09T11:17:21.465    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:17:21.465    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:17:21.465    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:17:21.465    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:17:21.465    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:17:21.465    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:17:21.465    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:17:21.465    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910705-103440-641_L1C_048-254-5_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/07/05/SPOT2-HRV1-XS_19910705-103444-353_L1C_048-255-0_D_V1-0/SPOT2-HRV1-XS_19910705-103444-353_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910705-103444-353_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910705-103444-353_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T11:17:25.436    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:17:25.437    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910705-103444-353_L1C_048-255-0_D_V1-0.zip
2024-01-09T11:17:25.437    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:17:25.437    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:17:25.437    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:17:25.437    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:17:25.438    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:17:25.438    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:17:25.438    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:17:25.438    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910705-103444-353_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/07/05/SPOT2-HRV1-XS_19910705-103447-060_L1C_048-255-3_D_V1-0/SPOT2-HRV1-XS_19910705-103447-060_L1C_048-255-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910705-103447-060_L1C_048-255-3_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910705-103447-060_L1C_048-255-3_D_V1-0.zip
run script
2024-01-09T11:17:41.409    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:17:41.410    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910705-103447-060_L1C_048-255-3_D_V1-0.zip
2024-01-09T11:17:41.411    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:17:41.411    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:17:41.411    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:17:41.411    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:17:41.411    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:17:41.411    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:17:41.411    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:17:41.411    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910705-103447-060_L1C_048-255-3_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/07/05/SPOT2-HRV1-XS_19910705-103503-625_L1C_049-257-4_D_V1-0/SPOT2-HRV1-XS_19910705-103503-625_L1C_049-257-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910705-103503-625_L1C_049-257-4_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910705-103503-625_L1C_049-257-4_D_V1-0.zip
run script
2024-01-09T11:18:04.063    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:18:04.065    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910705-103503-625_L1C_049-257-4_D_V1-0.zip
2024-01-09T11:18:04.065    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:18:04.065    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:18:04.065    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:18:04.065    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:18:04.065    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:18:04.065    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:18:04.065    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:18:04.065    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910705-103503-625_L1C_049-257-4_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/07/05/SPOT2-HRV1-XS_19910705-103508-273_L1C_049-258-0_D_V1-0/SPOT2-HRV1-XS_19910705-103508-273_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910705-103508-273_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910705-103508-273_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T11:18:55.430    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:18:55.431    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910705-103508-273_L1C_049-258-0_D_V1-0.zip
2024-01-09T11:18:55.431    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:18:55.431    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:18:55.431    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:18:55.431    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:18:55.431    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:18:55.431    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:18:55.431    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:18:55.432    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910705-103508-273_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/07/05/SPOT2-HRV1-XS_19910705-103513-687_L1C_049-258-6_D_V1-0/SPOT2-HRV1-XS_19910705-103513-687_L1C_049-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910705-103513-687_L1C_049-258-6_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910705-103513-687_L1C_049-258-6_D_V1-0.zip
run script
2024-01-09T11:19:34.039    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:19:34.040    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910705-103513-687_L1C_049-258-6_D_V1-0.zip
2024-01-09T11:19:34.040    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:19:34.040    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:19:34.040    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:19:34.041    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:19:34.041    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:19:34.041    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:19:34.041    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:19:34.041    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910705-103513-687_L1C_049-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/07/05/SPOT2-HRV2-XS_19910705-103537-459_L1C_049-261-5_D_V1-0/SPOT2-HRV2-XS_19910705-103537-459_L1C_049-261-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910705-103537-459_L1C_049-261-5_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910705-103537-459_L1C_049-261-5_D_V1-0.zip
run script
2024-01-09T11:20:06.134    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:20:06.135    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910705-103537-459_L1C_049-261-5_D_V1-0.zip
2024-01-09T11:20:06.135    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:20:06.135    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:20:06.135    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:20:06.135    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:20:06.135    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:20:06.136    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:20:06.136    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:20:06.136    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910705-103537-459_L1C_049-261-5_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/07/05/SPOT2-HRV2-XS_19910705-103541-241_L1C_049-262-0_D_V1-0/SPOT2-HRV2-XS_19910705-103541-241_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910705-103541-241_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910705-103541-241_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T11:20:09.619    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:20:09.619    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910705-103541-241_L1C_049-262-0_D_V1-0.zip
2024-01-09T11:20:09.619    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:20:09.619    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:20:09.619    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:20:09.619    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:20:09.619    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:20:09.619    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:20:09.619    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:20:09.619    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910705-103541-241_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/07/05/SPOT2-HRV2-XS_19910705-103543-045_L1C_049-262-2_D_V1-0/SPOT2-HRV2-XS_19910705-103543-045_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910705-103543-045_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910705-103543-045_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T11:20:13.264    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:20:13.264    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910705-103543-045_L1C_049-262-2_D_V1-0.zip
2024-01-09T11:20:13.264    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:20:13.264    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:20:13.264    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:20:13.265    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:20:13.265    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:20:13.265    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:20:13.265    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:20:13.265    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910705-103543-045_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/04/03/SPOT2-HRV1-XS_19910403-102232-920_L1C_048-255-0_D_V1-0/SPOT2-HRV1-XS_19910403-102232-920_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910403-102232-920_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910403-102232-920_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T11:20:17.147    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:20:17.147    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910403-102232-920_L1C_048-255-0_D_V1-0.zip
2024-01-09T11:20:17.147    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:20:17.147    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:20:17.147    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:20:17.147    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:20:17.147    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:20:17.147    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:20:17.147    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:20:17.147    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910403-102232-920_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/03/SPOT2-HRV1-XS_19910403-102241-117_L1C_048-256-0_D_V1-0/SPOT2-HRV1-XS_19910403-102241-117_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910403-102241-117_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910403-102241-117_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T11:20:41.542    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:20:41.544    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910403-102241-117_L1C_048-256-0_D_V1-0.zip
2024-01-09T11:20:41.544    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:20:41.544    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:20:41.544    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:20:41.544    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:20:41.544    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:20:41.544    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:20:41.544    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:20:41.544    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910403-102241-117_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/03/SPOT2-HRV1-XS_19910403-102249-323_L1C_048-257-0_D_V1-0/SPOT2-HRV1-XS_19910403-102249-323_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910403-102249-323_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910403-102249-323_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T11:21:39.513    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:21:39.514    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910403-102249-323_L1C_048-257-0_D_V1-0.zip
2024-01-09T11:21:39.514    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:21:39.514    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:21:39.514    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:21:39.514    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:21:39.514    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:21:39.514    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:21:39.514    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:21:39.514    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910403-102249-323_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/03/SPOT2-HRV1-XS_19910403-102257-540_L1C_048-258-0_D_V1-0/SPOT2-HRV1-XS_19910403-102257-540_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910403-102257-540_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910403-102257-540_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T11:22:31.248    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:22:31.249    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910403-102257-540_L1C_048-258-0_D_V1-0.zip
2024-01-09T11:22:31.249    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:22:31.249    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:22:31.249    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:22:31.249    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:22:31.249    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:22:31.249    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:22:31.249    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:22:31.250    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910403-102257-540_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/03/SPOT2-HRV1-XS_19910403-102305-767_L1C_048-259-0_D_V1-0/SPOT2-HRV1-XS_19910403-102305-767_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910403-102305-767_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910403-102305-767_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T11:23:05.548    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:23:05.549    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910403-102305-767_L1C_048-259-0_D_V1-0.zip
2024-01-09T11:23:05.550    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:23:05.550    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:23:05.550    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:23:05.550    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:23:05.550    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:23:05.550    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:23:05.550    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:23:05.550    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910403-102305-767_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/03/SPOT2-HRV1-XS_19910403-102314-003_L1C_049-260-0_D_V1-0/SPOT2-HRV1-XS_19910403-102314-003_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910403-102314-003_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910403-102314-003_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T11:23:30.482    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:23:30.483    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910403-102314-003_L1C_049-260-0_D_V1-0.zip
2024-01-09T11:23:30.484    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:23:30.484    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:23:30.484    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:23:30.484    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:23:30.484    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:23:30.484    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:23:30.484    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:23:30.484    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910403-102314-003_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/03/SPOT2-HRV1-XS_19910403-102322-125_L1C_049-260-9_D_V1-0/SPOT2-HRV1-XS_19910403-102322-125_L1C_049-260-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910403-102322-125_L1C_049-260-9_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910403-102322-125_L1C_049-260-9_D_V1-0.zip
run script
2024-01-09T11:23:40.044    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:23:40.045    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910403-102322-125_L1C_049-260-9_D_V1-0.zip
2024-01-09T11:23:40.045    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:23:40.045    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:23:40.045    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:23:40.046    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:23:40.046    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:23:40.046    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:23:40.046    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:23:40.046    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910403-102322-125_L1C_049-260-9_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/04/03/SPOT2-HRV1-XS_19910403-102322-248_L1C_049-261-0_D_V1-0/SPOT2-HRV1-XS_19910403-102322-248_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910403-102322-248_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910403-102322-248_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T11:23:43.764    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:23:43.765    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910403-102322-248_L1C_049-261-0_D_V1-0.zip
2024-01-09T11:23:43.765    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:23:43.766    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:23:43.766    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:23:43.766    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:23:43.766    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:23:43.766    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:23:43.766    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:23:43.766    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910403-102322-248_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/09/06/SPOT2-HRV1-XS_19910906-102329-841_L1C_048-255-9_D_V1-0/SPOT2-HRV1-XS_19910906-102329-841_L1C_048-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910906-102329-841_L1C_048-255-9_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910906-102329-841_L1C_048-255-9_D_V1-0.zip
run script
2024-01-09T11:23:46.924    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:23:46.924    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910906-102329-841_L1C_048-255-9_D_V1-0.zip
2024-01-09T11:23:46.924    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:23:46.924    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:23:46.924    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:23:46.924    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:23:46.925    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:23:46.925    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:23:46.925    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:23:46.925    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910906-102329-841_L1C_048-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/09/06/SPOT2-HRV1-XS_19910906-102329-913_L1C_048-256-0_D_V1-0/SPOT2-HRV1-XS_19910906-102329-913_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910906-102329-913_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910906-102329-913_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T11:24:49.461    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:24:49.462    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910906-102329-913_L1C_048-256-0_D_V1-0.zip
2024-01-09T11:24:49.462    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:24:49.462    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:24:49.462    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:24:49.463    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:24:49.463    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:24:49.463    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:24:49.463    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:24:49.463    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910906-102329-913_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/09/06/SPOT2-HRV1-XS_19910906-102338-122_L1C_048-257-0_D_V1-0/SPOT2-HRV1-XS_19910906-102338-122_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910906-102338-122_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910906-102338-122_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T11:25:52.480    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:25:52.481    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910906-102338-122_L1C_048-257-0_D_V1-0.zip
2024-01-09T11:25:52.481    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:25:52.481    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:25:52.481    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:25:52.482    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:25:52.482    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:25:52.482    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:25:52.482    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:25:52.482    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910906-102338-122_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/09/06/SPOT2-HRV1-XS_19910906-102346-340_L1C_048-258-0_D_V1-0/SPOT2-HRV1-XS_19910906-102346-340_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910906-102346-340_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910906-102346-340_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T11:26:47.737    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:26:47.738    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910906-102346-340_L1C_048-258-0_D_V1-0.zip
2024-01-09T11:26:47.738    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:26:47.738    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:26:47.738    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:26:47.738    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:26:47.738    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:26:47.738    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:26:47.738    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:26:47.738    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910906-102346-340_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/09/06/SPOT2-HRV1-XS_19910906-102354-570_L1C_049-259-0_D_V1-0/SPOT2-HRV1-XS_19910906-102354-570_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910906-102354-570_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910906-102354-570_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T11:27:27.673    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:27:27.674    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910906-102354-570_L1C_049-259-0_D_V1-0.zip
2024-01-09T11:27:27.674    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:27:27.674    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:27:27.674    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:27:27.674    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:27:27.674    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:27:27.674    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:27:27.674    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:27:27.675    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910906-102354-570_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/09/06/SPOT2-HRV1-XS_19910906-102402-806_L1C_049-260-0_D_V1-0/SPOT2-HRV1-XS_19910906-102402-806_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910906-102402-806_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910906-102402-806_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T11:27:57.817    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:27:57.818    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910906-102402-806_L1C_049-260-0_D_V1-0.zip
2024-01-09T11:27:57.818    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:27:57.818    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:27:57.818    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:27:57.818    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:27:57.818    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:27:57.819    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:27:57.819    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:27:57.819    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910906-102402-806_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/09/06/SPOT2-HRV1-XS_19910906-102411-054_L1C_049-261-0_D_V1-0/SPOT2-HRV1-XS_19910906-102411-054_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910906-102411-054_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910906-102411-054_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T11:28:11.074    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:28:11.075    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910906-102411-054_L1C_049-261-0_D_V1-0.zip
2024-01-09T11:28:11.076    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:28:11.076    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:28:11.076    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:28:11.076    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:28:11.076    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:28:11.076    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:28:11.076    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:28:11.076    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910906-102411-054_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/09/06/SPOT2-HRV1-XS_19910906-102419-310_L1C_049-262-0_D_V1-0/SPOT2-HRV1-XS_19910906-102419-310_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910906-102419-310_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910906-102419-310_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T11:28:14.712    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:28:14.714    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910906-102419-310_L1C_049-262-0_D_V1-0.zip
2024-01-09T11:28:14.714    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:28:14.714    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:28:14.714    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:28:14.714    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:28:14.714    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:28:14.714    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:28:14.714    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:28:14.714    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910906-102419-310_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/09/06/SPOT2-HRV1-XS_19910906-102311-038_L1C_051-254-0_D_V1-0/SPOT2-HRV1-XS_19910906-102311-038_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910906-102311-038_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910906-102311-038_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T11:28:18.014    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:28:18.015    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910906-102311-038_L1C_051-254-0_D_V1-0.zip
2024-01-09T11:28:18.015    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:28:18.015    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:28:18.016    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:28:18.016    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:28:18.016    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:28:18.016    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:28:18.016    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:28:18.016    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910906-102311-038_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/09/06/SPOT2-HRV1-XS_19910906-102312-843_L1C_051-254-2_D_V1-0/SPOT2-HRV1-XS_19910906-102312-843_L1C_051-254-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910906-102312-843_L1C_051-254-2_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910906-102312-843_L1C_051-254-2_D_V1-0.zip
run script
2024-01-09T11:28:21.253    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:28:21.254    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910906-102312-843_L1C_051-254-2_D_V1-0.zip
2024-01-09T11:28:21.255    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:28:21.255    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:28:21.255    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:28:21.255    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:28:21.255    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:28:21.255    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:28:21.255    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:28:21.255    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910906-102312-843_L1C_051-254-2_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/09/09/SPOT2-HRV2-XS_19910909-110622-048_L1C_048-259-0_D_V1-0/SPOT2-HRV2-XS_19910909-110622-048_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910909-110622-048_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910909-110622-048_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T11:28:24.512    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:28:24.513    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910909-110622-048_L1C_048-259-0_D_V1-0.zip
2024-01-09T11:28:24.513    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:28:24.514    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:28:24.514    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:28:24.514    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:28:24.514    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:28:24.514    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:28:24.514    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:28:24.514    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910909-110622-048_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/09/09/SPOT2-HRV2-XS_19910909-110630-524_L1C_048-260-0_D_V1-0/SPOT2-HRV2-XS_19910909-110630-524_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910909-110630-524_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910909-110630-524_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T11:28:56.106    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:28:56.107    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910909-110630-524_L1C_048-260-0_D_V1-0.zip
2024-01-09T11:28:56.107    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:28:56.107    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:28:56.108    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:28:56.108    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:28:56.108    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:28:56.108    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:28:56.108    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:28:56.108    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910909-110630-524_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/09/09/SPOT2-HRV2-XS_19910909-110631-427_L1C_048-260-1_D_V1-0/SPOT2-HRV2-XS_19910909-110631-427_L1C_048-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910909-110631-427_L1C_048-260-1_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910909-110631-427_L1C_048-260-1_D_V1-0.zip
run script
2024-01-09T11:28:59.347    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:28:59.348    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910909-110631-427_L1C_048-260-1_D_V1-0.zip
2024-01-09T11:28:59.348    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:28:59.348    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:28:59.348    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:28:59.348    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:28:59.348    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:28:59.348    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:28:59.348    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:28:59.348    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910909-110631-427_L1C_048-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/09/09/SPOT2-HRV2-XS_19910909-110556-296_L1C_049-255-9_D_V1-0/SPOT2-HRV2-XS_19910909-110556-296_L1C_049-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910909-110556-296_L1C_049-255-9_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910909-110556-296_L1C_049-255-9_D_V1-0.zip
run script
2024-01-09T11:29:02.723    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:29:02.724    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910909-110556-296_L1C_049-255-9_D_V1-0.zip
2024-01-09T11:29:02.725    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:29:02.725    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:29:02.725    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:29:02.725    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:29:02.725    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:29:02.725    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:29:02.725    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:29:02.725    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910909-110556-296_L1C_049-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/09/09/SPOT2-HRV2-XS_19910909-110556-636_L1C_049-256-0_D_V1-0/SPOT2-HRV2-XS_19910909-110556-636_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910909-110556-636_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910909-110556-636_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T11:30:54.489    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:30:54.490    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910909-110556-636_L1C_049-256-0_D_V1-0.zip
2024-01-09T11:30:54.490    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:30:54.490    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:30:54.490    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:30:54.490    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:30:54.490    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:30:54.490    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:30:54.490    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:30:54.490    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910909-110556-636_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/09/09/SPOT2-HRV2-XS_19910909-110605-101_L1C_049-257-0_D_V1-0/SPOT2-HRV2-XS_19910909-110605-101_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910909-110605-101_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910909-110605-101_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T11:32:53.621    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:32:53.622    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910909-110605-101_L1C_049-257-0_D_V1-0.zip
2024-01-09T11:32:53.622    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:32:53.622    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:32:53.622    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:32:53.622    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:32:53.622    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:32:53.622    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:32:53.622    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:32:53.622    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910909-110605-101_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/09/09/SPOT2-HRV2-XS_19910909-110613-574_L1C_049-258-0_D_V1-0/SPOT2-HRV2-XS_19910909-110613-574_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910909-110613-574_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910909-110613-574_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T11:34:21.002    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:34:21.003    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910909-110613-574_L1C_049-258-0_D_V1-0.zip
2024-01-09T11:34:21.003    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:34:21.003    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:34:21.003    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:34:21.003    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:34:21.003    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:34:21.003    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:34:21.003    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:34:21.004    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:35:12.798    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 98). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910909-110613-574_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1991/06/23/SPOT2-HRV2-XS_19910623-110619-576_L1C_048-262-0_D_V1-0/SPOT2-HRV2-XS_19910623-110619-576_L1C_048-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910623-110619-576_L1C_048-262-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910623-110619-576_L1C_048-262-0_D_V1-0.zip
run script
2024-01-09T11:35:15.712    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:35:15.713    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910623-110619-576_L1C_048-262-0_D_V1-0.zip
2024-01-09T11:35:15.713    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:35:15.714    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:35:15.714    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:35:15.714    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:35:15.714    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:35:15.714    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:35:15.714    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:35:15.714    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910623-110619-576_L1C_048-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/06/23/SPOT2-HRV2-XS_19910623-110608-020_L1C_049-260-6_D_V1-0/SPOT2-HRV2-XS_19910623-110608-020_L1C_049-260-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910623-110608-020_L1C_049-260-6_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910623-110608-020_L1C_049-260-6_D_V1-0.zip
run script
2024-01-09T11:35:19.056    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:35:19.059    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910623-110608-020_L1C_049-260-6_D_V1-0.zip
2024-01-09T11:35:19.059    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:35:19.059    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:35:19.060    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:35:19.060    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:35:19.060    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:35:19.060    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:35:19.060    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:35:19.060    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910623-110608-020_L1C_049-260-6_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/06/23/SPOT2-HRV2-XS_19910623-110611-088_L1C_049-261-0_D_V1-0/SPOT2-HRV2-XS_19910623-110611-088_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910623-110611-088_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910623-110611-088_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T11:35:22.546    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:35:22.547    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910623-110611-088_L1C_049-261-0_D_V1-0.zip
2024-01-09T11:35:22.547    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:35:22.547    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:35:22.547    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:35:22.547    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:35:22.547    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:35:22.548    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:35:22.548    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:35:22.548    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910623-110611-088_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/09/25/SPOT2-HRV1-XS_19910925-105808-870_L1C_049-254-0_D_V1-0/SPOT2-HRV1-XS_19910925-105808-870_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910925-105808-870_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910925-105808-870_L1C_049-254-0_D_V1-0.zip
run script
2024-01-09T11:35:25.504    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:35:25.506    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910925-105808-870_L1C_049-254-0_D_V1-0.zip
2024-01-09T11:35:25.506    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:35:25.506    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:35:25.506    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:35:25.506    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:35:25.506    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:35:25.506    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:35:25.506    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:35:25.506    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910925-105808-870_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/09/25/SPOT2-HRV1-XS_19910925-105817-262_L1C_049-255-0_D_V1-0/SPOT2-HRV1-XS_19910925-105817-262_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910925-105817-262_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910925-105817-262_L1C_049-255-0_D_V1-0.zip
run script
2024-01-09T11:35:29.546    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:35:29.548    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910925-105817-262_L1C_049-255-0_D_V1-0.zip
2024-01-09T11:35:29.548    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:35:29.548    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:35:29.548    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:35:29.548    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:35:29.548    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:35:29.548    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:35:29.548    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:35:29.548    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910925-105817-262_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/09/25/SPOT2-HRV1-XS_19910925-105825-658_L1C_049-256-0_D_V1-0/SPOT2-HRV1-XS_19910925-105825-658_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910925-105825-658_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910925-105825-658_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T11:36:22.588    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:36:22.589    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910925-105825-658_L1C_049-256-0_D_V1-0.zip
2024-01-09T11:36:22.589    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:36:22.589    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:36:22.589    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:36:22.589    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:36:22.589    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:36:22.590    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:36:22.590    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:36:22.590    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910925-105825-658_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/09/25/SPOT2-HRV1-XS_19910925-105834-062_L1C_049-257-0_D_V1-0/SPOT2-HRV1-XS_19910925-105834-062_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910925-105834-062_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910925-105834-062_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T11:38:24.284    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:38:24.285    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910925-105834-062_L1C_049-257-0_D_V1-0.zip
2024-01-09T11:38:24.285    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:38:24.285    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:38:24.285    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:38:24.285    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:38:24.285    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:38:24.285    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:38:24.285    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:38:24.285    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910925-105834-062_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/09/25/SPOT2-HRV1-XS_19910925-105842-466_L1C_049-258-0_D_V1-0/SPOT2-HRV1-XS_19910925-105842-466_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910925-105842-466_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910925-105842-466_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T11:39:51.262    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:39:51.263    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910925-105842-466_L1C_049-258-0_D_V1-0.zip
2024-01-09T11:39:51.263    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:39:51.264    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:39:51.264    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:39:51.264    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:39:51.264    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:39:51.264    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:39:51.264    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:39:51.264    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:40:49.726    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 240). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910925-105842-466_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1991/09/25/SPOT2-HRV1-XS_19910925-105850-880_L1C_049-259-0_D_V1-0/SPOT2-HRV1-XS_19910925-105850-880_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910925-105850-880_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910925-105850-880_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T11:40:52.828    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:40:52.829    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910925-105850-880_L1C_049-259-0_D_V1-0.zip
2024-01-09T11:40:52.829    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:40:52.829    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:40:52.829    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:40:52.829    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:40:52.829    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:40:52.829    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:40:52.829    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:40:52.830    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910925-105850-880_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/09/25/SPOT2-HRV1-XS_19910925-105859-296_L1C_049-260-0_D_V1-0/SPOT2-HRV1-XS_19910925-105859-296_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910925-105859-296_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910925-105859-296_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T11:41:35.099    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:41:35.099    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910925-105859-296_L1C_049-260-0_D_V1-0.zip
2024-01-09T11:41:35.099    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:41:35.099    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:41:35.099    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:41:35.099    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:41:35.099    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:41:35.099    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:41:35.099    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:41:35.099    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910925-105859-296_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/09/25/SPOT2-HRV1-XS_19910925-105907-719_L1C_049-261-0_D_V1-0/SPOT2-HRV1-XS_19910925-105907-719_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910925-105907-719_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910925-105907-719_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T11:41:50.465    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:41:50.466    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910925-105907-719_L1C_049-261-0_D_V1-0.zip
2024-01-09T11:41:50.466    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:41:50.466    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:41:50.467    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:41:50.467    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:41:50.467    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:41:50.467    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:41:50.467    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:41:50.467    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910925-105907-719_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/09/25/SPOT2-HRV2-XS_19910925-105815-313_L1C_050-255-0_D_V1-0/SPOT2-HRV2-XS_19910925-105815-313_L1C_050-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910925-105815-313_L1C_050-255-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910925-105815-313_L1C_050-255-0_D_V1-0.zip
run script
2024-01-09T11:41:53.549    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:41:53.549    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910925-105815-313_L1C_050-255-0_D_V1-0.zip
2024-01-09T11:41:53.549    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:41:53.549    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:41:53.549    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:41:53.549    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:41:53.550    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:41:53.550    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:41:53.550    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:41:53.550    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910925-105815-313_L1C_050-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/09/25/SPOT2-HRV2-XS_19910925-105823-730_L1C_050-256-0_D_V1-0/SPOT2-HRV2-XS_19910925-105823-730_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910925-105823-730_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910925-105823-730_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T11:42:59.862    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:42:59.863    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910925-105823-730_L1C_050-256-0_D_V1-0.zip
2024-01-09T11:42:59.863    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:42:59.863    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:42:59.863    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:42:59.863    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:42:59.863    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:42:59.863    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:42:59.863    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:42:59.863    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910925-105823-730_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/09/25/SPOT2-HRV2-XS_19910925-105832-155_L1C_050-257-0_D_V1-0/SPOT2-HRV2-XS_19910925-105832-155_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910925-105832-155_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910925-105832-155_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T11:46:16.996    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:46:16.998    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910925-105832-155_L1C_050-257-0_D_V1-0.zip
2024-01-09T11:46:16.998    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:46:16.998    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:46:16.998    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:46:16.998    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:46:16.998    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:46:16.998    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:46:16.998    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:46:16.998    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910925-105832-155_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/09/25/SPOT2-HRV2-XS_19910925-105840-583_L1C_050-258-0_D_V1-0/SPOT2-HRV2-XS_19910925-105840-583_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910925-105840-583_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910925-105840-583_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T11:49:43.795    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:49:43.797    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910925-105840-583_L1C_050-258-0_D_V1-0.zip
2024-01-09T11:49:43.797    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:49:43.797    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:49:43.797    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:49:43.797    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:49:43.797    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:49:43.797    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:49:43.797    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:49:43.797    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910925-105840-583_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/09/25/SPOT2-HRV2-XS_19910925-105849-015_L1C_050-259-0_D_V1-0/SPOT2-HRV2-XS_19910925-105849-015_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910925-105849-015_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910925-105849-015_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T11:52:28.459    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:52:28.460    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910925-105849-015_L1C_050-259-0_D_V1-0.zip
2024-01-09T11:52:28.460    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:52:28.460    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:52:28.460    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:52:28.460    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:52:28.460    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:52:28.460    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:52:28.460    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:52:28.460    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:54:28.538    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (394 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910925-105849-015_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1991/09/25/SPOT2-HRV2-XS_19910925-105857-452_L1C_050-260-0_D_V1-0/SPOT2-HRV2-XS_19910925-105857-452_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910925-105857-452_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910925-105857-452_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T11:54:32.363    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:54:32.364    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910925-105857-452_L1C_050-260-0_D_V1-0.zip
2024-01-09T11:54:32.364    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:54:32.364    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:54:32.364    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:54:32.365    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:54:32.365    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:54:32.365    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:54:32.365    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:54:32.365    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910925-105857-452_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/09/25/SPOT2-HRV2-XS_19910925-105905-893_L1C_050-261-0_D_V1-0/SPOT2-HRV2-XS_19910925-105905-893_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910925-105905-893_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910925-105905-893_L1C_050-261-0_D_V1-0.zip
run script
2024-01-09T11:55:57.437    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:55:57.438    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910925-105905-893_L1C_050-261-0_D_V1-0.zip
2024-01-09T11:55:57.438    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:55:57.438    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:55:57.438    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:55:57.438    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:55:57.439    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:55:57.439    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:55:57.439    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:55:57.439    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910925-105905-893_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/09/25/SPOT2-HRV2-XS_19910925-105806-900_L1C_051-254-0_D_V1-0/SPOT2-HRV2-XS_19910925-105806-900_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910925-105806-900_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910925-105806-900_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T11:57:05.832    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:57:05.834    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910925-105806-900_L1C_051-254-0_D_V1-0.zip
2024-01-09T11:57:05.834    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:57:05.834    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:57:05.834    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:57:05.834    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:57:05.834    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:57:05.834    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:57:05.834    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:57:05.834    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910925-105806-900_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/03/28/SPOT2-HRV1-XS_19910328-103802-913_L1C_049-255-8_D_V1-0/SPOT2-HRV1-XS_19910328-103802-913_L1C_049-255-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910328-103802-913_L1C_049-255-8_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910328-103802-913_L1C_049-255-8_D_V1-0.zip
run script
2024-01-09T11:57:09.372    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:57:09.373    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910328-103802-913_L1C_049-255-8_D_V1-0.zip
2024-01-09T11:57:09.373    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:57:09.373    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:57:09.373    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:57:09.373    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:57:09.373    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:57:09.373    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:57:09.373    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:57:09.373    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910328-103802-913_L1C_049-255-8_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/03/28/SPOT2-HRV1-XS_19910328-103803-947_L1C_049-256-0_D_V1-0/SPOT2-HRV1-XS_19910328-103803-947_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910328-103803-947_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910328-103803-947_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T11:58:15.955    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:58:15.957    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910328-103803-947_L1C_049-256-0_D_V1-0.zip
2024-01-09T11:58:15.957    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:58:15.957    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:58:15.957    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:58:15.957    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:58:15.957    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:58:15.957    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:58:15.957    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:58:15.957    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910328-103803-947_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/03/28/SPOT2-HRV1-XS_19910328-103812-213_L1C_049-257-0_D_V1-0/SPOT2-HRV1-XS_19910328-103812-213_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910328-103812-213_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910328-103812-213_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T11:59:24.414    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:59:24.415    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910328-103812-213_L1C_049-257-0_D_V1-0.zip
2024-01-09T11:59:24.415    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:59:24.415    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:59:24.415    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:59:24.415    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:59:24.415    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:59:24.416    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:59:24.416    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:59:24.416    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910328-103812-213_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/03/28/SPOT2-HRV1-XS_19910328-103828-772_L1C_049-259-0_D_V1-0/SPOT2-HRV1-XS_19910328-103828-772_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910328-103828-772_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910328-103828-772_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T12:00:24.374    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:00:24.375    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910328-103828-772_L1C_049-259-0_D_V1-0.zip
2024-01-09T12:00:24.375    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:00:24.375    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:00:24.375    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:00:24.376    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:00:24.376    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:00:24.376    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:00:24.376    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:00:24.376    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910328-103828-772_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/03/28/SPOT2-HRV1-XS_19910328-103832-382_L1C_049-259-4_D_V1-0/SPOT2-HRV1-XS_19910328-103832-382_L1C_049-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910328-103832-382_L1C_049-259-4_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910328-103832-382_L1C_049-259-4_D_V1-0.zip
run script
2024-01-09T12:00:52.712    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:00:52.713    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910328-103832-382_L1C_049-259-4_D_V1-0.zip
2024-01-09T12:00:52.713    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:00:52.713    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:00:52.713    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:00:52.713    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:00:52.713    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:00:52.713    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:00:52.714    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:00:52.714    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910328-103832-382_L1C_049-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/03/28/SPOT2-HRV2-XS_19910328-103852-430_L1C_049-261-8_D_V1-0/SPOT2-HRV2-XS_19910328-103852-430_L1C_049-261-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910328-103852-430_L1C_049-261-8_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910328-103852-430_L1C_049-261-8_D_V1-0.zip
run script
2024-01-09T12:01:11.426    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:01:11.427    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910328-103852-430_L1C_049-261-8_D_V1-0.zip
2024-01-09T12:01:11.427    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:01:11.428    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:01:11.428    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:01:11.428    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:01:11.428    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:01:11.428    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:01:11.428    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:01:11.428    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910328-103852-430_L1C_049-261-8_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/03/28/SPOT2-HRV2-XS_19910328-103853-516_L1C_049-262-0_D_V1-0/SPOT2-HRV2-XS_19910328-103853-516_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910328-103853-516_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910328-103853-516_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T12:01:15.707    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:01:15.708    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910328-103853-516_L1C_049-262-0_D_V1-0.zip
2024-01-09T12:01:15.708    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:01:15.708    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:01:15.708    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:01:15.708    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:01:15.708    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:01:15.708    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:01:15.708    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:01:15.708    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910328-103853-516_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/04/12/SPOT2-HRV2-XS_19910412-104942-157_L1C_049-255-9_D_V1-0/SPOT2-HRV2-XS_19910412-104942-157_L1C_049-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910412-104942-157_L1C_049-255-9_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910412-104942-157_L1C_049-255-9_D_V1-0.zip
run script
2024-01-09T12:01:19.762    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:01:19.764    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910412-104942-157_L1C_049-255-9_D_V1-0.zip
2024-01-09T12:01:19.764    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:01:19.764    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:01:19.764    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:01:19.764    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:01:19.764    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:01:19.764    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:01:19.764    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:01:19.764    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910412-104942-157_L1C_049-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/12/SPOT2-HRV2-XS_19910412-104942-370_L1C_049-256-0_D_V1-0/SPOT2-HRV2-XS_19910412-104942-370_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910412-104942-370_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910412-104942-370_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T12:03:42.798    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:03:42.800    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910412-104942-370_L1C_049-256-0_D_V1-0.zip
2024-01-09T12:03:42.800    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:03:42.800    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:03:42.800    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:03:42.800    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:03:42.800    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:03:42.800    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:03:42.800    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:03:42.800    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910412-104942-370_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/12/SPOT2-HRV2-XS_19910412-104950-718_L1C_049-257-0_D_V1-0/SPOT2-HRV2-XS_19910412-104950-718_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910412-104950-718_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910412-104950-718_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T12:06:07.863    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:06:07.864    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910412-104950-718_L1C_049-257-0_D_V1-0.zip
2024-01-09T12:06:07.864    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:06:07.865    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:06:07.865    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:06:07.865    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:06:07.865    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:06:07.865    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:06:07.865    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:06:07.865    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910412-104950-718_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/12/SPOT2-HRV2-XS_19910412-104959-074_L1C_049-258-0_D_V1-0/SPOT2-HRV2-XS_19910412-104959-074_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910412-104959-074_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910412-104959-074_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T12:08:07.246    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:08:07.247    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910412-104959-074_L1C_049-258-0_D_V1-0.zip
2024-01-09T12:08:07.247    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:08:07.247    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:08:07.247    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:08:07.247    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:08:07.247    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:08:07.247    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:08:07.248    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:08:07.248    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:09:21.673    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 674). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910412-104959-074_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1991/04/12/SPOT2-HRV2-XS_19910412-105007-433_L1C_049-259-0_D_V1-0/SPOT2-HRV2-XS_19910412-105007-433_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910412-105007-433_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910412-105007-433_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T12:09:24.568    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:09:24.569    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910412-105007-433_L1C_049-259-0_D_V1-0.zip
2024-01-09T12:09:24.569    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:09:24.569    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:09:24.569    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:09:24.570    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:09:24.570    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:09:24.570    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:09:24.570    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:09:24.570    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910412-105007-433_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/12/SPOT2-HRV2-XS_19910412-105011-043_L1C_049-259-4_D_V1-0/SPOT2-HRV2-XS_19910412-105011-043_L1C_049-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910412-105011-043_L1C_049-259-4_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910412-105011-043_L1C_049-259-4_D_V1-0.zip
run script
2024-01-09T12:10:26.994    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:10:26.995    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910412-105011-043_L1C_049-259-4_D_V1-0.zip
2024-01-09T12:10:26.995    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:10:26.995    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:10:26.995    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:10:26.995    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:10:26.996    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:10:26.996    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:10:26.996    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:10:26.996    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910412-105011-043_L1C_049-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/17/SPOT2-HRV1-XS_19910417-105325-881_L1C_049-255-8_D_V1-0/SPOT2-HRV1-XS_19910417-105325-881_L1C_049-255-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910417-105325-881_L1C_049-255-8_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910417-105325-881_L1C_049-255-8_D_V1-0.zip
run script
2024-01-09T12:11:22.608    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:11:22.609    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910417-105325-881_L1C_049-255-8_D_V1-0.zip
2024-01-09T12:11:22.609    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:11:22.609    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:11:22.609    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:11:22.609    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:11:22.609    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:11:22.609    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:11:22.609    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:11:22.609    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910417-105325-881_L1C_049-255-8_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/17/SPOT2-HRV1-XS_19910417-105327-027_L1C_049-256-0_D_V1-0/SPOT2-HRV1-XS_19910417-105327-027_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910417-105327-027_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910417-105327-027_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T12:13:37.368    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:13:37.369    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910417-105327-027_L1C_049-256-0_D_V1-0.zip
2024-01-09T12:13:37.370    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:13:37.370    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:13:37.370    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:13:37.370    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:13:37.370    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:13:37.370    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:13:37.370    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:13:37.370    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910417-105327-027_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/17/SPOT2-HRV1-XS_19910417-105335-401_L1C_049-257-0_D_V1-0/SPOT2-HRV1-XS_19910417-105335-401_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910417-105335-401_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910417-105335-401_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T12:16:00.245    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:16:00.247    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910417-105335-401_L1C_049-257-0_D_V1-0.zip
2024-01-09T12:16:00.247    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:16:00.247    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:16:00.247    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:16:00.247    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:16:00.247    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:16:00.247    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:16:00.247    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:16:00.247    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910417-105335-401_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/17/SPOT2-HRV1-XS_19910417-105400-560_L1C_049-260-0_D_V1-0/SPOT2-HRV1-XS_19910417-105400-560_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910417-105400-560_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910417-105400-560_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T12:17:53.181    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:17:53.182    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910417-105400-560_L1C_049-260-0_D_V1-0.zip
2024-01-09T12:17:53.182    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:17:53.182    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:17:53.182    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:17:53.182    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:17:53.182    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:17:53.183    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:17:53.183    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:17:53.183    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910417-105400-560_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/17/SPOT2-HRV1-XS_19910417-105408-958_L1C_049-261-0_D_V1-0/SPOT2-HRV1-XS_19910417-105408-958_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910417-105408-958_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910417-105408-958_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T12:18:25.311    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:18:25.312    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910417-105408-958_L1C_049-261-0_D_V1-0.zip
2024-01-09T12:18:25.312    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:18:25.312    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:18:25.312    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:18:25.312    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:18:25.312    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:18:25.313    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:18:25.313    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:18:25.313    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910417-105408-958_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/17/SPOT2-HRV1-XS_19910417-105417-360_L1C_049-262-0_D_V1-0/SPOT2-HRV1-XS_19910417-105417-360_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910417-105417-360_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910417-105417-360_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T12:18:40.581    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:18:40.583    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910417-105417-360_L1C_049-262-0_D_V1-0.zip
2024-01-09T12:18:40.583    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:18:40.583    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:18:40.583    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:18:40.583    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:18:40.583    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:18:40.583    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:18:40.583    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:18:40.583    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910417-105417-360_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/04/17/SPOT2-HRV2-XS_19910417-105400-458_L1C_055-261-0_D_V1-0/SPOT2-HRV2-XS_19910417-105400-458_L1C_055-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910417-105400-458_L1C_055-261-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910417-105400-458_L1C_055-261-0_D_V1-0.zip
run script
2024-01-09T12:18:43.625    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:18:43.625    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910417-105400-458_L1C_055-261-0_D_V1-0.zip
2024-01-09T12:18:43.625    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:18:43.625    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:18:43.625    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:18:43.625    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:18:43.625    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:18:43.625    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:18:43.625    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:18:43.625    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910417-105400-458_L1C_055-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/17/SPOT2-HRV2-XS_19910417-105408-949_L1C_055-262-0_D_V1-0/SPOT2-HRV2-XS_19910417-105408-949_L1C_055-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910417-105408-949_L1C_055-262-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910417-105408-949_L1C_055-262-0_D_V1-0.zip
run script
2024-01-09T12:19:59.299    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:19:59.301    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910417-105408-949_L1C_055-262-0_D_V1-0.zip
2024-01-09T12:19:59.301    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:19:59.301    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:19:59.301    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:19:59.301    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:19:59.301    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:19:59.301    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:19:59.301    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:19:59.301    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910417-105408-949_L1C_055-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/05/03/SPOT2-HRV1-XS_19910503-104622-098_L1C_049-260-1_D_V1-0/SPOT2-HRV1-XS_19910503-104622-098_L1C_049-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910503-104622-098_L1C_049-260-1_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910503-104622-098_L1C_049-260-1_D_V1-0.zip
run script
2024-01-09T12:21:32.916    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:21:32.917    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910503-104622-098_L1C_049-260-1_D_V1-0.zip
2024-01-09T12:21:32.918    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:21:32.918    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:21:32.918    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:21:32.918    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:21:32.918    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:21:32.918    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:21:32.918    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:21:32.918    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910503-104622-098_L1C_049-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/05/03/SPOT2-HRV1-XS_19910503-104629-534_L1C_049-261-0_D_V1-0/SPOT2-HRV1-XS_19910503-104629-534_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910503-104629-534_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910503-104629-534_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T12:21:36.631    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:21:36.632    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910503-104629-534_L1C_049-261-0_D_V1-0.zip
2024-01-09T12:21:36.632    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:21:36.632    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:21:36.632    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:21:36.632    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:21:36.632    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:21:36.632    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:21:36.632    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:21:36.632    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910503-104629-534_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/05/03/SPOT2-HRV1-XS_19910503-104637-881_L1C_049-262-0_D_V1-0/SPOT2-HRV1-XS_19910503-104637-881_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910503-104637-881_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910503-104637-881_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T12:21:39.602    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:21:39.602    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910503-104637-881_L1C_049-262-0_D_V1-0.zip
2024-01-09T12:21:39.603    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:21:39.603    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:21:39.603    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:21:39.603    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:21:39.603    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:21:39.603    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:21:39.603    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:21:39.603    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910503-104637-881_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/06/19/SPOT2-HRV2-XS_19910619-104253-503_L1C_049-260-6_D_V1-0/SPOT2-HRV2-XS_19910619-104253-503_L1C_049-260-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910619-104253-503_L1C_049-260-6_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910619-104253-503_L1C_049-260-6_D_V1-0.zip
run script
2024-01-09T12:21:42.614    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:21:42.615    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910619-104253-503_L1C_049-260-6_D_V1-0.zip
2024-01-09T12:21:42.615    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:21:42.615    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:21:42.615    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:21:42.615    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:21:42.615    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:21:42.615    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:21:42.615    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:21:42.616    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910619-104253-503_L1C_049-260-6_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/06/19/SPOT2-HRV2-XS_19910619-104256-406_L1C_049-261-0_D_V1-0/SPOT2-HRV2-XS_19910619-104256-406_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910619-104256-406_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910619-104256-406_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T12:21:45.654    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:21:45.655    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910619-104256-406_L1C_049-261-0_D_V1-0.zip
2024-01-09T12:21:45.655    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:21:45.655    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:21:45.655    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:21:45.655    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:21:45.655    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:21:45.655    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:21:45.656    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:21:45.656    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910619-104256-406_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/06/19/SPOT2-HRV2-XS_19910619-104304-729_L1C_049-262-0_D_V1-0/SPOT2-HRV2-XS_19910619-104304-729_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910619-104304-729_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910619-104304-729_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T12:21:48.548    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:21:48.549    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910619-104304-729_L1C_049-262-0_D_V1-0.zip
2024-01-09T12:21:48.549    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:21:48.549    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:21:48.549    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:21:48.549    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:21:48.549    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:21:48.549    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:21:48.549    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:21:48.549    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910619-104304-729_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/06/25/SPOT2-HRV2-XS_19910625-102734-797_L1C_049-260-6_D_V1-0/SPOT2-HRV2-XS_19910625-102734-797_L1C_049-260-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910625-102734-797_L1C_049-260-6_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910625-102734-797_L1C_049-260-6_D_V1-0.zip
run script
2024-01-09T12:21:51.891    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:21:51.892    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910625-102734-797_L1C_049-260-6_D_V1-0.zip
2024-01-09T12:21:51.892    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:21:51.892    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:21:51.892    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:21:51.892    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:21:51.892    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:21:51.892    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:21:51.892    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:21:51.892    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:21:53.621    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (148 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910625-102734-797_L1C_049-260-6_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1991/06/25/SPOT2-HRV2-XS_19910625-102737-636_L1C_049-261-0_D_V1-0/SPOT2-HRV2-XS_19910625-102737-636_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910625-102737-636_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910625-102737-636_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T12:21:56.679    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:21:56.681    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910625-102737-636_L1C_049-261-0_D_V1-0.zip
2024-01-09T12:21:56.681    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:21:56.681    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:21:56.681    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:21:56.681    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:21:56.681    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:21:56.681    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:21:56.681    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:21:56.681    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910625-102737-636_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/06/25/SPOT2-HRV2-XS_19910625-102745-899_L1C_049-262-0_D_V1-0/SPOT2-HRV2-XS_19910625-102745-899_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910625-102745-899_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910625-102745-899_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T12:21:59.698    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:21:59.699    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910625-102745-899_L1C_049-262-0_D_V1-0.zip
2024-01-09T12:21:59.699    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:21:59.699    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:21:59.699    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:21:59.699    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:21:59.699    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:21:59.699    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:21:59.700    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:21:59.700    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910625-102745-899_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/06/18/SPOT2-HRV2-XS_19910618-110212-529_L1C_049-261-1_D_V1-0/SPOT2-HRV2-XS_19910618-110212-529_L1C_049-261-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910618-110212-529_L1C_049-261-1_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910618-110212-529_L1C_049-261-1_D_V1-0.zip
run script
2024-01-09T12:22:02.816    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:22:02.817    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910618-110212-529_L1C_049-261-1_D_V1-0.zip
2024-01-09T12:22:02.817    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:22:02.817    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:22:02.817    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:22:02.817    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:22:02.817    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:22:02.817    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:22:02.817    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:22:02.817    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:22:04.662    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (662 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910618-110212-529_L1C_049-261-1_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1991/06/18/SPOT2-HRV2-XS_19910618-110220-085_L1C_049-262-0_D_V1-0/SPOT2-HRV2-XS_19910618-110220-085_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910618-110220-085_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910618-110220-085_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T12:22:07.610    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:22:07.611    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910618-110220-085_L1C_049-262-0_D_V1-0.zip
2024-01-09T12:22:07.611    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:22:07.611    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:22:07.611    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:22:07.611    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:22:07.611    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:22:07.611    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:22:07.612    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:22:07.612    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910618-110220-085_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/04/13/SPOT2-HRV1-XS_19910413-103022-385_L1C_050-255-9_D_V1-0/SPOT2-HRV1-XS_19910413-103022-385_L1C_050-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910413-103022-385_L1C_050-255-9_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910413-103022-385_L1C_050-255-9_D_V1-0.zip
run script
2024-01-09T12:22:10.782    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:22:10.784    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910413-103022-385_L1C_050-255-9_D_V1-0.zip
2024-01-09T12:22:10.784    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:22:10.784    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:22:10.784    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:22:10.784    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:22:10.784    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:22:10.784    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:22:10.784    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:22:10.784    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910413-103022-385_L1C_050-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/13/SPOT2-HRV1-XS_19910413-103022-494_L1C_050-256-0_D_V1-0/SPOT2-HRV1-XS_19910413-103022-494_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910413-103022-494_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910413-103022-494_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T12:24:35.587    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:24:35.589    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910413-103022-494_L1C_050-256-0_D_V1-0.zip
2024-01-09T12:24:35.589    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:24:35.589    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:24:35.589    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:24:35.589    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:24:35.589    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:24:35.589    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:24:35.589    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:24:35.589    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910413-103022-494_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/13/SPOT2-HRV1-XS_19910413-103030-736_L1C_050-257-0_D_V1-0/SPOT2-HRV1-XS_19910413-103030-736_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910413-103030-736_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910413-103030-736_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T12:26:57.392    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:26:57.393    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910413-103030-736_L1C_050-257-0_D_V1-0.zip
2024-01-09T12:26:57.394    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:26:57.394    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:26:57.394    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:26:57.394    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:26:57.394    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:26:57.394    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:26:57.394    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:26:57.394    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910413-103030-736_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/13/SPOT2-HRV1-XS_19910413-103038-987_L1C_050-258-0_D_V1-0/SPOT2-HRV1-XS_19910413-103038-987_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910413-103038-987_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910413-103038-987_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T12:29:21.228    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:29:21.229    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910413-103038-987_L1C_050-258-0_D_V1-0.zip
2024-01-09T12:29:21.229    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:29:21.229    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:29:21.229    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:29:21.229    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:29:21.229    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:29:21.229    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:29:21.229    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:29:21.230    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:30:58.010    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 1794). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910413-103038-987_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1991/04/13/SPOT2-HRV1-XS_19910413-103047-246_L1C_050-259-0_D_V1-0/SPOT2-HRV1-XS_19910413-103047-246_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910413-103047-246_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910413-103047-246_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T12:31:01.001    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:31:01.002    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910413-103047-246_L1C_050-259-0_D_V1-0.zip
2024-01-09T12:31:01.002    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:31:01.002    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:31:01.002    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:31:01.002    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:31:01.002    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:31:01.002    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:31:01.002    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:31:01.003    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910413-103047-246_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/13/SPOT2-HRV1-XS_19910413-103055-512_L1C_050-260-0_D_V1-0/SPOT2-HRV1-XS_19910413-103055-512_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910413-103055-512_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910413-103055-512_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T12:32:39.998    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:32:39.999    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910413-103055-512_L1C_050-260-0_D_V1-0.zip
2024-01-09T12:32:39.999    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:32:39.999    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:32:39.999    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:32:39.999    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:32:39.999    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:32:39.999    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:32:40.000    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:32:40.000    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910413-103055-512_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/13/SPOT2-HRV1-XS_19910413-103103-790_L1C_050-261-0_D_V1-0/SPOT2-HRV1-XS_19910413-103103-790_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910413-103103-790_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910413-103103-790_L1C_050-261-0_D_V1-0.zip
run script
2024-01-09T12:33:52.192    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:33:52.193    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910413-103103-790_L1C_050-261-0_D_V1-0.zip
2024-01-09T12:33:52.193    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:33:52.193    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:33:52.193    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:33:52.193    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:33:52.193    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:33:52.193    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:33:52.194    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:33:52.194    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910413-103103-790_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/13/SPOT2-HRV1-XS_19910413-103112-075_L1C_050-262-0_D_V1-0/SPOT2-HRV1-XS_19910413-103112-075_L1C_050-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910413-103112-075_L1C_050-262-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910413-103112-075_L1C_050-262-0_D_V1-0.zip
run script
2024-01-09T12:34:52.881    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:34:52.882    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910413-103112-075_L1C_050-262-0_D_V1-0.zip
2024-01-09T12:34:52.882    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:34:52.882    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:34:52.882    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:34:52.882    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:34:52.882    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:34:52.882    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:34:52.882    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:34:52.882    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910413-103112-075_L1C_050-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/12/07/SPOT2-HRV2-XS_19911207-105501-028_L1C_050-258-0_D_V1-0/SPOT2-HRV2-XS_19911207-105501-028_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19911207-105501-028_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911207-105501-028_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T12:35:33.770    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:35:33.771    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911207-105501-028_L1C_050-258-0_D_V1-0.zip
2024-01-09T12:35:33.771    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:35:33.771    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:35:33.771    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:35:33.771    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:35:33.771    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:35:33.771    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:35:33.771    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:35:33.771    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:37:27.659    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 946). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911207-105501-028_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1991/12/07/SPOT2-HRV2-XS_19911207-105509-436_L1C_050-259-0_D_V1-0/SPOT2-HRV2-XS_19911207-105509-436_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19911207-105509-436_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911207-105509-436_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T12:37:31.280    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:37:31.281    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911207-105509-436_L1C_050-259-0_D_V1-0.zip
2024-01-09T12:37:31.282    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:37:31.282    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:37:31.282    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:37:31.284    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:37:31.288    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:37:31.290    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:37:31.293    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:37:31.296    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911207-105509-436_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/12/07/SPOT2-HRV2-XS_19911207-105517-846_L1C_050-260-0_D_V1-0/SPOT2-HRV2-XS_19911207-105517-846_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19911207-105517-846_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911207-105517-846_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T12:40:06.913    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:40:06.915    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911207-105517-846_L1C_050-260-0_D_V1-0.zip
2024-01-09T12:40:06.915    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:40:06.915    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:40:06.915    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:40:06.915    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:40:06.915    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:40:06.915    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:40:06.915    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:40:06.915    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911207-105517-846_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/12/07/SPOT2-HRV2-XS_19911207-105526-265_L1C_050-261-0_D_V1-0/SPOT2-HRV2-XS_19911207-105526-265_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19911207-105526-265_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911207-105526-265_L1C_050-261-0_D_V1-0.zip
run script
2024-01-09T12:41:47.000    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:41:47.002    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911207-105526-265_L1C_050-261-0_D_V1-0.zip
2024-01-09T12:41:47.002    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:41:47.002    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:41:47.002    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:41:47.002    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:41:47.002    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:41:47.002    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:41:47.002    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:41:47.002    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911207-105526-265_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/12/07/SPOT2-HRV2-XS_19911207-105534-685_L1C_050-262-0_D_V1-0/SPOT2-HRV2-XS_19911207-105534-685_L1C_050-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19911207-105534-685_L1C_050-262-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911207-105534-685_L1C_050-262-0_D_V1-0.zip
run script
2024-01-09T12:43:10.915    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:43:10.916    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911207-105534-685_L1C_050-262-0_D_V1-0.zip
2024-01-09T12:43:10.916    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:43:10.916    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:43:10.916    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:43:10.916    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:43:10.916    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:43:10.916    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:43:10.916    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:43:10.916    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911207-105534-685_L1C_050-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/12/07/SPOT2-HRV2-XS_19911207-105539-197_L1C_050-262-5_D_V1-0/SPOT2-HRV2-XS_19911207-105539-197_L1C_050-262-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19911207-105539-197_L1C_050-262-5_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911207-105539-197_L1C_050-262-5_D_V1-0.zip
run script
2024-01-09T12:44:10.810    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:44:10.812    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911207-105539-197_L1C_050-262-5_D_V1-0.zip
2024-01-09T12:44:10.812    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:44:10.812    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:44:10.812    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:44:10.812    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:44:10.812    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:44:10.812    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:44:10.812    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:44:10.812    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911207-105539-197_L1C_050-262-5_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/12/07/SPOT2-HRV2-XS_19911207-105450-548_L1C_051-256-7_D_V1-0/SPOT2-HRV2-XS_19911207-105450-548_L1C_051-256-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19911207-105450-548_L1C_051-256-7_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911207-105450-548_L1C_051-256-7_D_V1-0.zip
run script
2024-01-09T12:44:47.574    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:44:47.575    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911207-105450-548_L1C_051-256-7_D_V1-0.zip
2024-01-09T12:44:47.575    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:44:47.575    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:44:47.575    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:44:47.575    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:44:47.575    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:44:47.575    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:44:47.575    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:44:47.575    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911207-105450-548_L1C_051-256-7_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 2 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 [0 0 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/12/07/SPOT2-HRV2-XS_19911207-105452-627_L1C_051-257-0_D_V1-0/SPOT2-HRV2-XS_19911207-105452-627_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19911207-105452-627_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911207-105452-627_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T12:48:13.217    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:48:13.218    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911207-105452-627_L1C_051-257-0_D_V1-0.zip
2024-01-09T12:48:13.218    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:48:13.218    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:48:13.218    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:48:13.219    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:48:13.219    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:48:13.219    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:48:13.219    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:48:13.219    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911207-105452-627_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/11/21/SPOT2-HRV2-XS_19911121-110244-815_L1C_050-259-0_D_V1-0/SPOT2-HRV2-XS_19911121-110244-815_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19911121-110244-815_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911121-110244-815_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T12:51:33.700    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:51:33.701    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911121-110244-815_L1C_050-259-0_D_V1-0.zip
2024-01-09T12:51:33.701    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:51:33.701    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:51:33.701    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:51:33.701    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:51:33.701    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:51:33.701    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:51:33.701    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:51:33.702    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911121-110244-815_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/11/21/SPOT2-HRV2-XS_19911121-110253-288_L1C_050-260-0_D_V1-0/SPOT2-HRV2-XS_19911121-110253-288_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19911121-110253-288_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911121-110253-288_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T12:54:01.365    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:54:01.366    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911121-110253-288_L1C_050-260-0_D_V1-0.zip
2024-01-09T12:54:01.366    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:54:01.366    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:54:01.366    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:54:01.366    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:54:01.366    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:54:01.366    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:54:01.366    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:54:01.366    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911121-110253-288_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/11/21/SPOT2-HRV2-XS_19911121-110301-765_L1C_050-261-0_D_V1-0/SPOT2-HRV2-XS_19911121-110301-765_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19911121-110301-765_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911121-110301-765_L1C_050-261-0_D_V1-0.zip
run script
2024-01-09T12:55:35.214    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:55:35.215    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911121-110301-765_L1C_050-261-0_D_V1-0.zip
2024-01-09T12:55:35.215    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:55:35.215    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:55:35.215    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:55:35.215    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:55:35.215    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:55:35.215    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:55:35.216    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:55:35.216    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911121-110301-765_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/11/21/SPOT2-HRV2-XS_19911121-110310-244_L1C_050-262-0_D_V1-0/SPOT2-HRV2-XS_19911121-110310-244_L1C_050-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19911121-110310-244_L1C_050-262-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911121-110310-244_L1C_050-262-0_D_V1-0.zip
run script
2024-01-09T12:56:55.993    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:56:55.994    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911121-110310-244_L1C_050-262-0_D_V1-0.zip
2024-01-09T12:56:55.994    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:56:55.994    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:56:55.994    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:56:55.994    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:56:55.994    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:56:55.994    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:56:55.994    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:56:55.995    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911121-110310-244_L1C_050-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/12/02/SPOT2-HRV2-XS_19911202-105140-137_L1C_050-262-0_D_V1-0/SPOT2-HRV2-XS_19911202-105140-137_L1C_050-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19911202-105140-137_L1C_050-262-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911202-105140-137_L1C_050-262-0_D_V1-0.zip
run script
2024-01-09T12:57:46.401    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:57:46.402    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911202-105140-137_L1C_050-262-0_D_V1-0.zip
2024-01-09T12:57:46.402    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:57:46.403    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:57:46.403    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:57:46.403    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:57:46.403    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:57:46.403    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:57:46.403    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:57:46.403    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911202-105140-137_L1C_050-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/12/02/SPOT2-HRV2-XS_19911202-105051-648_L1C_051-256-2_D_V1-0/SPOT2-HRV2-XS_19911202-105051-648_L1C_051-256-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19911202-105051-648_L1C_051-256-2_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911202-105051-648_L1C_051-256-2_D_V1-0.zip
run script
2024-01-09T12:58:57.031    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:58:57.033    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911202-105051-648_L1C_051-256-2_D_V1-0.zip
2024-01-09T12:58:57.033    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:58:57.033    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:58:57.033    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:58:57.033    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:58:57.033    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:58:57.033    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:58:57.033    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:58:57.033    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911202-105051-648_L1C_051-256-2_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/12/02/SPOT2-HRV2-XS_19911202-105058-211_L1C_051-257-0_D_V1-0/SPOT2-HRV2-XS_19911202-105058-211_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19911202-105058-211_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911202-105058-211_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T13:01:56.168    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:01:56.169    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911202-105058-211_L1C_051-257-0_D_V1-0.zip
2024-01-09T13:01:56.169    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:01:56.169    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:01:56.169    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:01:56.169    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:01:56.169    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:01:56.169    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:01:56.169    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:01:56.169    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911202-105058-211_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/12/02/SPOT2-HRV2-XS_19911202-105106-585_L1C_051-258-0_D_V1-0/SPOT2-HRV2-XS_19911202-105106-585_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19911202-105106-585_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911202-105106-585_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T13:05:16.429    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:05:16.430    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911202-105106-585_L1C_051-258-0_D_V1-0.zip
2024-01-09T13:05:16.430    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:05:16.430    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:05:16.431    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:05:16.431    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:05:16.431    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:05:16.431    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:05:16.431    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:05:16.431    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T13:07:06.344    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 456). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911202-105106-585_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1991/12/02/SPOT2-HRV2-XS_19911202-105114-966_L1C_051-259-0_D_V1-0/SPOT2-HRV2-XS_19911202-105114-966_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19911202-105114-966_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911202-105114-966_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T13:07:11.817    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:07:11.819    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911202-105114-966_L1C_051-259-0_D_V1-0.zip
2024-01-09T13:07:11.819    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:07:11.819    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:07:11.819    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:07:11.819    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:07:11.819    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:07:11.819    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:07:11.819    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:07:11.819    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911202-105114-966_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/12/02/SPOT2-HRV2-XS_19911202-105123-352_L1C_051-260-0_D_V1-0/SPOT2-HRV2-XS_19911202-105123-352_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19911202-105123-352_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911202-105123-352_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T13:09:49.851    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:09:49.852    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911202-105123-352_L1C_051-260-0_D_V1-0.zip
2024-01-09T13:09:49.852    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:09:49.852    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:09:49.852    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:09:49.852    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:09:49.852    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:09:49.852    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:09:49.852    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:09:49.852    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911202-105123-352_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/12/02/SPOT2-HRV2-XS_19911202-105131-741_L1C_051-261-0_D_V1-0/SPOT2-HRV2-XS_19911202-105131-741_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19911202-105131-741_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911202-105131-741_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T13:11:48.363    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:11:48.365    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911202-105131-741_L1C_051-261-0_D_V1-0.zip
2024-01-09T13:11:48.365    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:11:48.365    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:11:48.365    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:11:48.365    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:11:48.365    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:11:48.365    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:11:48.365    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:11:48.366    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911202-105131-741_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/05/09/SPOT2-HRV1-XS_19910509-103012-415_L1C_051-254-0_D_V1-0/SPOT2-HRV1-XS_19910509-103012-415_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910509-103012-415_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910509-103012-415_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T13:13:26.582    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:13:26.583    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910509-103012-415_L1C_051-254-0_D_V1-0.zip
2024-01-09T13:13:26.583    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:13:26.583    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:13:26.583    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:13:26.583    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:13:26.584    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:13:26.584    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:13:26.584    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:13:26.584    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910509-103012-415_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/05/09/SPOT2-HRV1-XS_19910509-103020-648_L1C_051-255-0_D_V1-0/SPOT2-HRV1-XS_19910509-103020-648_L1C_051-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910509-103020-648_L1C_051-255-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910509-103020-648_L1C_051-255-0_D_V1-0.zip
run script
2024-01-09T13:13:30.154    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:13:30.154    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910509-103020-648_L1C_051-255-0_D_V1-0.zip
2024-01-09T13:13:30.154    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:13:30.154    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:13:30.154    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:13:30.154    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:13:30.154    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:13:30.154    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:13:30.154    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:13:30.154    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910509-103020-648_L1C_051-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/05/09/SPOT2-HRV1-XS_19910509-103030-697_L1C_051-256-2_D_V1-0/SPOT2-HRV1-XS_19910509-103030-697_L1C_051-256-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910509-103030-697_L1C_051-256-2_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910509-103030-697_L1C_051-256-2_D_V1-0.zip
run script
2024-01-09T13:14:15.973    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:14:15.974    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910509-103030-697_L1C_051-256-2_D_V1-0.zip
2024-01-09T13:14:15.974    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:14:15.974    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:14:15.974    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:14:15.975    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:14:15.975    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:14:15.975    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:14:15.975    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:14:15.975    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910509-103030-697_L1C_051-256-2_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/09/20/SPOT2-HRV1-XS_19910920-105413-549_L1C_051-254-0_D_V1-0/SPOT2-HRV1-XS_19910920-105413-549_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910920-105413-549_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910920-105413-549_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T13:16:58.853    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:16:58.854    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910920-105413-549_L1C_051-254-0_D_V1-0.zip
2024-01-09T13:16:58.854    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:16:58.854    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:16:58.854    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:16:58.854    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:16:58.854    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:16:58.854    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:16:58.854    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:16:58.854    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910920-105413-549_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1991/02/04/SPOT2-HRV1-XS_19910204-103820-091_L1C_051-255-0_D_V1-0/SPOT2-HRV1-XS_19910204-103820-091_L1C_051-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910204-103820-091_L1C_051-255-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910204-103820-091_L1C_051-255-0_D_V1-0.zip
run script
2024-01-09T13:18:14.847    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:18:14.848    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910204-103820-091_L1C_051-255-0_D_V1-0.zip
2024-01-09T13:18:14.848    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:18:14.848    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:18:14.848    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:18:14.848    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:18:14.848    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:18:14.848    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:18:14.848    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:18:14.848    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910204-103820-091_L1C_051-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 0 0 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/02/04/SPOT2-HRV1-XS_19910204-103836-662_L1C_051-257-0_D_V1-0/SPOT2-HRV1-XS_19910204-103836-662_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910204-103836-662_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910204-103836-662_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T13:19:02.832    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:19:02.833    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910204-103836-662_L1C_051-257-0_D_V1-0.zip
2024-01-09T13:19:02.833    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:19:02.833    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:19:02.833    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:19:02.833    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:19:02.833    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:19:02.833    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:19:02.834    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:19:02.834    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910204-103836-662_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/12/03/SPOT2-HRV2-XS_19911203-103137-781_L1C_051-256-6_D_V1-0/SPOT2-HRV2-XS_19911203-103137-781_L1C_051-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19911203-103137-781_L1C_051-256-6_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911203-103137-781_L1C_051-256-6_D_V1-0.zip
run script
2024-01-09T13:21:59.990    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:21:59.991    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911203-103137-781_L1C_051-256-6_D_V1-0.zip
2024-01-09T13:21:59.991    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:21:59.991    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:21:59.991    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:21:59.991    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:21:59.991    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:21:59.991    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:21:59.991    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:21:59.991    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911203-103137-781_L1C_051-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 1 1 ... 2 2 2]
 [2 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/12/03/SPOT2-HRV2-XS_19911203-103140-615_L1C_051-257-0_D_V1-0/SPOT2-HRV2-XS_19911203-103140-615_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19911203-103140-615_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911203-103140-615_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T13:24:56.711    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:24:56.712    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911203-103140-615_L1C_051-257-0_D_V1-0.zip
2024-01-09T13:24:56.712    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:24:56.712    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:24:56.712    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:24:56.712    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:24:56.712    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:24:56.712    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:24:56.712    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:24:56.712    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911203-103140-615_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 1 1 ... 2 2 2]
 [2 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/12/03/SPOT2-HRV2-XS_19911203-103148-875_L1C_051-258-0_D_V1-0/SPOT2-HRV2-XS_19911203-103148-875_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19911203-103148-875_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911203-103148-875_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T13:27:50.925    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:27:50.926    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911203-103148-875_L1C_051-258-0_D_V1-0.zip
2024-01-09T13:27:50.926    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:27:50.926    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:27:50.927    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:27:50.927    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:27:50.927    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:27:50.927    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:27:50.927    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:27:50.927    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T13:29:27.151    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 224). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911203-103148-875_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1991/12/03/SPOT2-HRV2-XS_19911203-103157-144_L1C_051-259-0_D_V1-0/SPOT2-HRV2-XS_19911203-103157-144_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19911203-103157-144_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911203-103157-144_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T13:29:33.218    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:29:33.219    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911203-103157-144_L1C_051-259-0_D_V1-0.zip
2024-01-09T13:29:33.219    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:29:33.219    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:29:33.219    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:29:33.219    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:29:33.219    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:29:33.219    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:29:33.219    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:29:33.219    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911203-103157-144_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [0 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/12/03/SPOT2-HRV2-XS_19911203-103205-419_L1C_051-260-0_D_V1-0/SPOT2-HRV2-XS_19911203-103205-419_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19911203-103205-419_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911203-103205-419_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T13:31:59.825    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:31:59.826    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911203-103205-419_L1C_051-260-0_D_V1-0.zip
2024-01-09T13:31:59.826    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:31:59.826    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:31:59.826    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:31:59.826    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:31:59.826    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:31:59.826    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:31:59.826    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:31:59.826    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911203-103205-419_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/08/SPOT2-HRV1-XS_19910408-102639-937_L1C_051-257-0_D_V1-0/SPOT2-HRV1-XS_19910408-102639-937_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910408-102639-937_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910408-102639-937_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T13:33:52.451    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:33:52.452    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910408-102639-937_L1C_051-257-0_D_V1-0.zip
2024-01-09T13:33:52.452    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:33:52.452    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:33:52.452    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:33:52.453    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:33:52.453    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:33:52.453    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:33:52.453    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:33:52.453    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910408-102639-937_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/08/SPOT2-HRV1-XS_19910408-102648-182_L1C_051-258-0_D_V1-0/SPOT2-HRV1-XS_19910408-102648-182_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910408-102648-182_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910408-102648-182_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T13:36:44.761    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:36:44.762    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910408-102648-182_L1C_051-258-0_D_V1-0.zip
2024-01-09T13:36:44.762    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:36:44.763    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:36:44.763    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:36:44.763    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:36:44.763    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:36:44.763    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:36:44.763    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:36:44.763    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T13:38:09.847    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 197). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910408-102648-182_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1991/04/08/SPOT2-HRV1-XS_19910408-102656-436_L1C_051-259-0_D_V1-0/SPOT2-HRV1-XS_19910408-102656-436_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910408-102656-436_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910408-102656-436_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T13:38:13.588    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:38:13.589    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910408-102656-436_L1C_051-259-0_D_V1-0.zip
2024-01-09T13:38:13.589    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:38:13.589    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:38:13.589    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:38:13.589    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:38:13.589    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:38:13.589    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:38:13.590    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:38:13.590    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910408-102656-436_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/08/SPOT2-HRV1-XS_19910408-102704-699_L1C_051-260-0_D_V1-0/SPOT2-HRV1-XS_19910408-102704-699_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910408-102704-699_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910408-102704-699_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T13:41:04.248    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:41:04.250    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910408-102704-699_L1C_051-260-0_D_V1-0.zip
2024-01-09T13:41:04.250    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:41:04.250    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:41:04.250    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:41:04.250    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:41:04.250    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:41:04.250    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:41:04.250    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:41:04.250    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910408-102704-699_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/08/SPOT2-HRV1-XS_19910408-102712-971_L1C_051-261-0_D_V1-0/SPOT2-HRV1-XS_19910408-102712-971_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910408-102712-971_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910408-102712-971_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T13:43:21.778    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:43:21.779    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910408-102712-971_L1C_051-261-0_D_V1-0.zip
2024-01-09T13:43:21.779    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:43:21.779    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:43:21.779    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:43:21.779    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:43:21.779    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:43:21.779    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:43:21.779    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:43:21.779    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910408-102712-971_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/08/SPOT2-HRV1-XS_19910408-102721-249_L1C_051-262-0_D_V1-0/SPOT2-HRV1-XS_19910408-102721-249_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910408-102721-249_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910408-102721-249_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T13:45:36.053    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:45:36.055    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910408-102721-249_L1C_051-262-0_D_V1-0.zip
2024-01-09T13:45:36.055    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:45:36.055    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:45:36.055    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:45:36.055    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:45:36.055    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:45:36.055    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:45:36.055    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:45:36.055    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910408-102721-249_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/08/SPOT2-HRV1-XS_19910408-102729-536_L1C_051-263-0_D_V1-0/SPOT2-HRV1-XS_19910408-102729-536_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910408-102729-536_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910408-102729-536_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T13:47:21.033    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:47:21.034    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910408-102729-536_L1C_051-263-0_D_V1-0.zip
2024-01-09T13:47:21.034    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:47:21.034    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:47:21.034    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:47:21.034    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:47:21.034    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:47:21.034    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:47:21.034    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:47:21.035    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910408-102729-536_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/07/26/SPOT2-HRV2-XS_19910726-103124-641_L1C_052-259-1_D_V1-0/SPOT2-HRV2-XS_19910726-103124-641_L1C_052-259-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910726-103124-641_L1C_052-259-1_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910726-103124-641_L1C_052-259-1_D_V1-0.zip
run script
2024-01-09T13:48:03.685    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:48:03.686    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910726-103124-641_L1C_052-259-1_D_V1-0.zip
2024-01-09T13:48:03.686    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:48:03.686    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:48:03.686    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:48:03.686    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:48:03.686    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:48:03.686    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:48:03.686    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:48:03.686    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910726-103124-641_L1C_052-259-1_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/07/26/SPOT2-HRV2-XS_19910726-103132-029_L1C_052-260-0_D_V1-0/SPOT2-HRV2-XS_19910726-103132-029_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910726-103132-029_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910726-103132-029_L1C_052-260-0_D_V1-0.zip
run script
2024-01-09T13:50:43.141    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:50:43.142    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910726-103132-029_L1C_052-260-0_D_V1-0.zip
2024-01-09T13:50:43.142    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:50:43.142    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:50:43.142    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:50:43.142    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:50:43.142    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:50:43.142    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:50:43.142    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:50:43.142    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910726-103132-029_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/07/26/SPOT2-HRV2-XS_19910726-103140-322_L1C_052-261-0_D_V1-0/SPOT2-HRV2-XS_19910726-103140-322_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910726-103140-322_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910726-103140-322_L1C_052-261-0_D_V1-0.zip
run script
2024-01-09T13:53:06.209    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:53:06.210    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910726-103140-322_L1C_052-261-0_D_V1-0.zip
2024-01-09T13:53:06.210    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:53:06.210    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:53:06.210    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:53:06.210    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:53:06.210    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:53:06.210    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:53:06.210    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:53:06.210    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910726-103140-322_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/07/26/SPOT2-HRV2-XS_19910726-103148-624_L1C_052-262-0_D_V1-0/SPOT2-HRV2-XS_19910726-103148-624_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910726-103148-624_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910726-103148-624_L1C_052-262-0_D_V1-0.zip
run script
2024-01-09T13:55:36.594    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:55:36.595    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910726-103148-624_L1C_052-262-0_D_V1-0.zip
2024-01-09T13:55:36.595    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:55:36.595    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:55:36.595    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:55:36.595    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:55:36.595    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:55:36.596    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:55:36.596    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:55:36.596    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910726-103148-624_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/07/31/SPOT2-HRV2-XS_19910731-103543-467_L1C_052-262-5_D_V1-0/SPOT2-HRV2-XS_19910731-103543-467_L1C_052-262-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910731-103543-467_L1C_052-262-5_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910731-103543-467_L1C_052-262-5_D_V1-0.zip
run script
2024-01-09T13:57:46.864    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:57:46.865    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910731-103543-467_L1C_052-262-5_D_V1-0.zip
2024-01-09T13:57:46.865    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:57:46.865    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:57:46.865    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:57:46.865    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:57:46.865    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:57:46.865    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:57:46.866    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:57:46.866    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910731-103543-467_L1C_052-262-5_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/08/06/SPOT2-HRV1-XS_19910806-102021-847_L1C_052-262-7_D_V1-0/SPOT2-HRV1-XS_19910806-102021-847_L1C_052-262-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910806-102021-847_L1C_052-262-7_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910806-102021-847_L1C_052-262-7_D_V1-0.zip
run script
2024-01-09T13:59:20.495    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:59:20.496    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910806-102021-847_L1C_052-262-7_D_V1-0.zip
2024-01-09T13:59:20.496    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:59:20.496    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:59:20.497    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:59:20.497    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:59:20.497    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:59:20.497    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:59:20.497    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:59:20.497    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910806-102021-847_L1C_052-262-7_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/10/02/SPOT2-HRV2-XS_19911002-102359-428_L1C_053-259-0_D_V1-0/SPOT2-HRV2-XS_19911002-102359-428_L1C_053-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19911002-102359-428_L1C_053-259-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911002-102359-428_L1C_053-259-0_D_V1-0.zip
run script
2024-01-09T14:00:50.358    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:00:50.359    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911002-102359-428_L1C_053-259-0_D_V1-0.zip
2024-01-09T14:00:50.359    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:00:50.359    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:00:50.360    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:00:50.360    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:00:50.360    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:00:50.360    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:00:50.360    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:00:50.360    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911002-102359-428_L1C_053-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/10/02/SPOT2-HRV2-XS_19911002-102407-691_L1C_053-260-0_D_V1-0/SPOT2-HRV2-XS_19911002-102407-691_L1C_053-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19911002-102407-691_L1C_053-260-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911002-102407-691_L1C_053-260-0_D_V1-0.zip
run script
2024-01-09T14:02:54.686    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:02:54.687    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911002-102407-691_L1C_053-260-0_D_V1-0.zip
2024-01-09T14:02:54.687    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:02:54.687    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:02:54.687    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:02:54.687    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:02:54.687    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:02:54.687    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:02:54.688    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:02:54.688    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911002-102407-691_L1C_053-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/10/02/SPOT2-HRV2-XS_19911002-102415-960_L1C_053-261-0_D_V1-0/SPOT2-HRV2-XS_19911002-102415-960_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19911002-102415-960_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911002-102415-960_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T14:04:57.889    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:04:57.890    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911002-102415-960_L1C_053-261-0_D_V1-0.zip
2024-01-09T14:04:57.890    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:04:57.890    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:04:57.890    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:04:57.890    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:04:57.890    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:04:57.890    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:04:57.890    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:04:57.891    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911002-102415-960_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/10/02/SPOT2-HRV2-XS_19911002-102419-569_L1C_053-261-4_D_V1-0/SPOT2-HRV2-XS_19911002-102419-569_L1C_053-261-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19911002-102419-569_L1C_053-261-4_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911002-102419-569_L1C_053-261-4_D_V1-0.zip
run script
2024-01-09T14:07:31.371    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:07:31.372    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911002-102419-569_L1C_053-261-4_D_V1-0.zip
2024-01-09T14:07:31.373    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:07:31.373    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:07:31.373    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:07:31.373    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:07:31.373    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:07:31.373    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:07:31.373    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:07:31.373    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19911002-102419-569_L1C_053-261-4_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/01/24/SPOT2-HRV2-XS_19910124-105050-731_L1C_054-262-0_D_V1-0/SPOT2-HRV2-XS_19910124-105050-731_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910124-105050-731_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910124-105050-731_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T14:10:01.618    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:10:01.620    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910124-105050-731_L1C_054-262-0_D_V1-0.zip
2024-01-09T14:10:01.620    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:10:01.620    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:10:01.620    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:10:01.620    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:10:01.620    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:10:01.620    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:10:01.620    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:10:01.620    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910124-105050-731_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/01/24/SPOT2-HRV2-XS_19910124-105042-276_L1C_055-261-0_D_V1-0/SPOT2-HRV2-XS_19910124-105042-276_L1C_055-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910124-105042-276_L1C_055-261-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910124-105042-276_L1C_055-261-0_D_V1-0.zip
run script
2024-01-09T14:11:42.157    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:11:42.159    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910124-105042-276_L1C_055-261-0_D_V1-0.zip
2024-01-09T14:11:42.159    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:11:42.159    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:11:42.159    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:11:42.159    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:11:42.159    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:11:42.159    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:11:42.159    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:11:42.159    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910124-105042-276_L1C_055-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/01/25/SPOT2-HRV2-XS_19910125-103124-932_L1C_055-261-0_D_V1-0/SPOT2-HRV2-XS_19910125-103124-932_L1C_055-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910125-103124-932_L1C_055-261-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910125-103124-932_L1C_055-261-0_D_V1-0.zip
run script
2024-01-09T14:13:07.215    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:13:07.216    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910125-103124-932_L1C_055-261-0_D_V1-0.zip
2024-01-09T14:13:07.216    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:13:07.216    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:13:07.216    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:13:07.216    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:13:07.217    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:13:07.217    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:13:07.217    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:13:07.217    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910125-103124-932_L1C_055-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/01/25/SPOT2-HRV2-XS_19910125-103133-258_L1C_055-262-0_D_V1-0/SPOT2-HRV2-XS_19910125-103133-258_L1C_055-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19910125-103133-258_L1C_055-262-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910125-103133-258_L1C_055-262-0_D_V1-0.zip
run script
2024-01-09T14:13:54.089    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:13:54.090    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910125-103133-258_L1C_055-262-0_D_V1-0.zip
2024-01-09T14:13:54.090    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:13:54.090    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:13:54.090    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:13:54.090    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:13:54.091    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:13:54.091    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:13:54.091    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:13:54.091    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV2-XS_19910125-103133-258_L1C_055-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/02/05/SPOT2-HRV1-XS_19910205-101944-762_L1C_055-261-0_D_V1-0/SPOT2-HRV1-XS_19910205-101944-762_L1C_055-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910205-101944-762_L1C_055-261-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910205-101944-762_L1C_055-261-0_D_V1-0.zip
run script
2024-01-09T14:14:55.555    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:14:55.556    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910205-101944-762_L1C_055-261-0_D_V1-0.zip
2024-01-09T14:14:55.556    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:14:55.556    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:14:55.556    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:14:55.556    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:14:55.557    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:14:55.557    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:14:55.557    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:14:55.557    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910205-101944-762_L1C_055-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/02/05/SPOT2-HRV1-XS_19910205-101953-040_L1C_055-262-0_D_V1-0/SPOT2-HRV1-XS_19910205-101953-040_L1C_055-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910205-101953-040_L1C_055-262-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910205-101953-040_L1C_055-262-0_D_V1-0.zip
run script
2024-01-09T14:15:50.260    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:15:50.261    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910205-101953-040_L1C_055-262-0_D_V1-0.zip
2024-01-09T14:15:50.261    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:15:50.262    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:15:50.262    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:15:50.262    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:15:50.262    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:15:50.262    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:15:50.262    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:15:50.262    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910205-101953-040_L1C_055-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/29/SPOT2-HRV1-XS_19910429-102303-254_L1C_055-261-0_D_V1-0/SPOT2-HRV1-XS_19910429-102303-254_L1C_055-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910429-102303-254_L1C_055-261-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910429-102303-254_L1C_055-261-0_D_V1-0.zip
run script
2024-01-09T14:16:53.381    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:16:53.382    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910429-102303-254_L1C_055-261-0_D_V1-0.zip
2024-01-09T14:16:53.382    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:16:53.382    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:16:53.382    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:16:53.382    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:16:53.382    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:16:53.382    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:16:53.382    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:16:53.382    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910429-102303-254_L1C_055-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 1 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1991/04/29/SPOT2-HRV1-XS_19910429-102311-547_L1C_055-262-0_D_V1-0/SPOT2-HRV1-XS_19910429-102311-547_L1C_055-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19910429-102311-547_L1C_055-262-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910429-102311-547_L1C_055-262-0_D_V1-0.zip
run script
2024-01-09T14:17:56.933    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:17:56.934    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910429-102311-547_L1C_055-262-0_D_V1-0.zip
2024-01-09T14:17:56.934    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:17:56.934    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:17:56.934    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:17:56.934    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:17:56.935    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:17:56.935    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:17:56.935    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:17:56.935    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT2-HRV1-XS_19910429-102311-547_L1C_055-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/06/13/SPOT5-HRG1-XS_20140613-100126-153_L1C_046-263-9_D_V1-0/SPOT5-HRG1-XS_20140613-100126-153_L1C_046-263-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140613-100126-153_L1C_046-263-9_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140613-100126-153_L1C_046-263-9_D_V1-0.zip
run script
2024-01-09T14:19:10.077    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:19:10.078    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140613-100126-153_L1C_046-263-9_D_V1-0.zip
2024-01-09T14:19:10.078    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:19:10.078    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:19:10.078    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:19:10.078    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:19:10.078    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:19:10.078    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:19:10.078    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:19:10.078    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140613-100126-153_L1C_046-263-9_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/06/13/SPOT5-HRG2-XS_20140613-100125-004_L1C_046-263-9_D_V1-0/SPOT5-HRG2-XS_20140613-100125-004_L1C_046-263-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140613-100125-004_L1C_046-263-9_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140613-100125-004_L1C_046-263-9_D_V1-0.zip
run script
2024-01-09T14:20:41.045    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:20:41.047    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140613-100125-004_L1C_046-263-9_D_V1-0.zip
2024-01-09T14:20:41.047    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:20:41.047    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:20:41.047    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:20:41.047    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:20:41.047    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:20:41.047    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:20:41.047    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:20:41.047    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140613-100125-004_L1C_046-263-9_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/06/13/SPOT5-HRG2-XS_20140613-100047-332_L1C_049-259-9_D_V1-0/SPOT5-HRG2-XS_20140613-100047-332_L1C_049-259-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140613-100047-332_L1C_049-259-9_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140613-100047-332_L1C_049-259-9_D_V1-0.zip
run script
2024-01-09T14:21:23.857    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:21:23.858    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140613-100047-332_L1C_049-259-9_D_V1-0.zip
2024-01-09T14:21:23.858    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:21:23.858    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:21:23.858    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:21:23.858    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:21:23.858    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:21:23.858    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:21:23.858    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:21:23.858    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140613-100047-332_L1C_049-259-9_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/06/13/SPOT5-HRG2-XS_20140613-100047-524_L1C_049-260-0_D_V1-0/SPOT5-HRG2-XS_20140613-100047-524_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140613-100047-524_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140613-100047-524_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T14:22:11.058    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:22:11.059    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140613-100047-524_L1C_049-260-0_D_V1-0.zip
2024-01-09T14:22:11.059    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:22:11.059    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:22:11.059    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:22:11.059    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:22:11.059    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:22:11.059    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:22:11.059    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:22:11.059    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140613-100047-524_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/06/13/SPOT5-HRG2-XS_20140613-100055-874_L1C_049-261-0_D_V1-0/SPOT5-HRG2-XS_20140613-100055-874_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140613-100055-874_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140613-100055-874_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T14:22:55.802    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:22:55.804    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140613-100055-874_L1C_049-261-0_D_V1-0.zip
2024-01-09T14:22:55.804    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:22:55.804    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:22:55.804    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:22:55.804    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:22:55.804    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:22:55.804    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:22:55.804    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:22:55.804    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140613-100055-874_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/06/13/SPOT5-HRG2-XS_20140613-100056-765_L1C_049-261-1_D_V1-0/SPOT5-HRG2-XS_20140613-100056-765_L1C_049-261-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140613-100056-765_L1C_049-261-1_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140613-100056-765_L1C_049-261-1_D_V1-0.zip
run script
2024-01-09T14:23:22.905    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:23:22.906    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140613-100056-765_L1C_049-261-1_D_V1-0.zip
2024-01-09T14:23:22.906    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:23:22.906    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:23:22.906    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:23:22.906    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:23:22.906    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:23:22.906    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:23:22.906    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:23:22.906    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140613-100056-765_L1C_049-261-1_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/06/28/SPOT5-HRG2-XS_20140628-101147-015_L1C_046-263-1_D_V1-0/SPOT5-HRG2-XS_20140628-101147-015_L1C_046-263-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140628-101147-015_L1C_046-263-1_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140628-101147-015_L1C_046-263-1_D_V1-0.zip
run script
2024-01-09T14:23:48.275    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:23:48.276    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140628-101147-015_L1C_046-263-1_D_V1-0.zip
2024-01-09T14:23:48.276    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:23:48.276    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:23:48.276    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:23:48.276    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:23:48.276    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:23:48.276    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:23:48.276    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:23:48.276    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140628-101147-015_L1C_046-263-1_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/06/28/SPOT5-HRG1-XS_20140628-101118-524_L1C_048-260-0_D_V1-0/SPOT5-HRG1-XS_20140628-101118-524_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140628-101118-524_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140628-101118-524_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T14:24:20.083    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:24:20.085    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140628-101118-524_L1C_048-260-0_D_V1-0.zip
2024-01-09T14:24:20.085    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:24:20.085    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:24:20.085    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:24:20.085    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:24:20.085    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:24:20.085    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:24:20.085    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:24:20.085    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140628-101118-524_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2014/06/28/SPOT5-HRG1-XS_20140628-101126-922_L1C_048-261-0_D_V1-0/SPOT5-HRG1-XS_20140628-101126-922_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140628-101126-922_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140628-101126-922_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T14:24:25.271    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:24:25.273    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140628-101126-922_L1C_048-261-0_D_V1-0.zip
2024-01-09T14:24:25.273    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:24:25.273    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:24:25.273    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:24:25.273    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:24:25.273    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:24:25.273    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:24:25.273    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:24:25.273    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140628-101126-922_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2014/09/09/SPOT5-HRG1-XS_20140909-100233-402_L1C_046-263-1_D_V1-0/SPOT5-HRG1-XS_20140909-100233-402_L1C_046-263-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140909-100233-402_L1C_046-263-1_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140909-100233-402_L1C_046-263-1_D_V1-0.zip
run script
2024-01-09T14:24:29.277    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:24:29.277    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140909-100233-402_L1C_046-263-1_D_V1-0.zip
2024-01-09T14:24:29.277    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:24:29.278    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:24:29.278    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:24:29.278    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:24:29.278    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:24:29.278    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:24:29.278    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:24:29.278    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140909-100233-402_L1C_046-263-1_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/09/09/SPOT5-HRG2-XS_20140909-100112-514_L1C_050-254-0_D_V1-0/SPOT5-HRG2-XS_20140909-100112-514_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140909-100112-514_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140909-100112-514_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T14:24:52.936    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:24:52.937    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140909-100112-514_L1C_050-254-0_D_V1-0.zip
2024-01-09T14:24:52.937    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:24:52.937    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:24:52.937    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:24:52.938    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:24:52.938    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:24:52.938    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:24:52.938    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:24:52.938    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140909-100112-514_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2014/11/06/SPOT5-HRG2-XS_20141106-094252-943_L1C_046-263-6_D_V1-0/SPOT5-HRG2-XS_20141106-094252-943_L1C_046-263-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20141106-094252-943_L1C_046-263-6_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20141106-094252-943_L1C_046-263-6_D_V1-0.zip
run script
2024-01-09T14:24:58.580    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:24:58.581    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20141106-094252-943_L1C_046-263-6_D_V1-0.zip
2024-01-09T14:24:58.581    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:24:58.581    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:24:58.581    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:24:58.581    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:24:58.581    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:24:58.581    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:24:58.582    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:24:58.582    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20141106-094252-943_L1C_046-263-6_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/11/11/SPOT5-HRG2-XS_20141111-094623-256_L1C_046-263-6_D_V1-0/SPOT5-HRG2-XS_20141111-094623-256_L1C_046-263-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20141111-094623-256_L1C_046-263-6_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20141111-094623-256_L1C_046-263-6_D_V1-0.zip
run script
2024-01-09T14:26:26.245    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:26:26.246    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20141111-094623-256_L1C_046-263-6_D_V1-0.zip
2024-01-09T14:26:26.246    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:26:26.246    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:26:26.246    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:26:26.246    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:26:26.246    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:26:26.246    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:26:26.246    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:26:26.246    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20141111-094623-256_L1C_046-263-6_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/02/02/SPOT5-HRG1-XS_20140202-102806-542_L1C_047-255-9_D_V1-0/SPOT5-HRG1-XS_20140202-102806-542_L1C_047-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140202-102806-542_L1C_047-255-9_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140202-102806-542_L1C_047-255-9_D_V1-0.zip
run script
2024-01-09T14:27:52.365    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:27:52.366    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140202-102806-542_L1C_047-255-9_D_V1-0.zip
2024-01-09T14:27:52.366    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:27:52.366    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:27:52.366    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:27:52.366    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:27:52.366    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:27:52.366    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:27:52.367    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:27:52.367    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140202-102806-542_L1C_047-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2014/02/02/SPOT5-HRG1-XS_20140202-102806-806_L1C_047-256-0_D_V1-0/SPOT5-HRG1-XS_20140202-102806-806_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140202-102806-806_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140202-102806-806_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T14:27:58.564    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:27:58.565    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140202-102806-806_L1C_047-256-0_D_V1-0.zip
2024-01-09T14:27:58.565    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:27:58.565    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:27:58.566    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:27:58.566    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:27:58.566    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:27:58.566    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:27:58.566    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:27:58.566    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140202-102806-806_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2014/02/02/SPOT5-HRG1-XS_20140202-102807-697_L1C_047-256-1_D_V1-0/SPOT5-HRG1-XS_20140202-102807-697_L1C_047-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140202-102807-697_L1C_047-256-1_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140202-102807-697_L1C_047-256-1_D_V1-0.zip
run script
2024-01-09T14:28:04.447    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:28:04.448    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140202-102807-697_L1C_047-256-1_D_V1-0.zip
2024-01-09T14:28:04.448    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:28:04.449    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:28:04.449    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:28:04.449    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:28:04.449    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:28:04.449    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:28:04.449    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:28:04.449    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140202-102807-697_L1C_047-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2014/02/04/SPOT5-HRG2-XS_20140204-094926-085_L1C_047-255-9_D_V1-0/SPOT5-HRG2-XS_20140204-094926-085_L1C_047-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140204-094926-085_L1C_047-255-9_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140204-094926-085_L1C_047-255-9_D_V1-0.zip
run script
2024-01-09T14:28:09.907    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:28:09.908    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140204-094926-085_L1C_047-255-9_D_V1-0.zip
2024-01-09T14:28:09.908    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:28:09.908    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:28:09.908    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:28:09.908    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:28:09.908    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:28:09.908    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:28:09.908    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:28:09.908    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140204-094926-085_L1C_047-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2014/02/04/SPOT5-HRG2-XS_20140204-094927-986_L1C_047-256-2_D_V1-0/SPOT5-HRG2-XS_20140204-094927-986_L1C_047-256-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140204-094927-986_L1C_047-256-2_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140204-094927-986_L1C_047-256-2_D_V1-0.zip
run script
2024-01-09T14:28:15.257    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:28:15.258    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140204-094927-986_L1C_047-256-2_D_V1-0.zip
2024-01-09T14:28:15.258    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:28:15.258    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:28:15.258    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:28:15.258    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:28:15.258    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:28:15.258    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:28:15.258    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:28:15.258    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140204-094927-986_L1C_047-256-2_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2014/02/04/SPOT5-HRG1-XS_20140204-094942-865_L1C_048-258-2_D_V1-0/SPOT5-HRG1-XS_20140204-094942-865_L1C_048-258-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140204-094942-865_L1C_048-258-2_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140204-094942-865_L1C_048-258-2_D_V1-0.zip
run script
2024-01-09T14:28:19.807    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:28:19.807    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140204-094942-865_L1C_048-258-2_D_V1-0.zip
2024-01-09T14:28:19.807    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:28:19.807    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:28:19.807    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:28:19.807    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:28:19.807    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:28:19.807    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:28:19.807    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:28:19.807    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140204-094942-865_L1C_048-258-2_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/02/19/SPOT5-HRG2-XS_20140219-100003-527_L1C_047-255-9_D_V1-0/SPOT5-HRG2-XS_20140219-100003-527_L1C_047-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140219-100003-527_L1C_047-255-9_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140219-100003-527_L1C_047-255-9_D_V1-0.zip
run script
2024-01-09T14:28:57.605    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:28:57.606    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140219-100003-527_L1C_047-255-9_D_V1-0.zip
2024-01-09T14:28:57.606    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:28:57.606    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:28:57.606    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:28:57.606    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:28:57.607    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:28:57.607    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:28:57.607    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:28:57.607    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140219-100003-527_L1C_047-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2014/02/19/SPOT5-HRG2-XS_20140219-100003-624_L1C_047-256-0_D_V1-0/SPOT5-HRG2-XS_20140219-100003-624_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140219-100003-624_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140219-100003-624_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T14:29:03.546    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:29:03.547    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140219-100003-624_L1C_047-256-0_D_V1-0.zip
2024-01-09T14:29:03.547    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:29:03.547    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:29:03.548    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:29:03.548    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:29:03.548    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:29:03.548    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:29:03.549    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:29:03.549    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140219-100003-624_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2014/02/19/SPOT5-HRG2-XS_20140219-100005-428_L1C_047-256-2_D_V1-0/SPOT5-HRG2-XS_20140219-100005-428_L1C_047-256-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140219-100005-428_L1C_047-256-2_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140219-100005-428_L1C_047-256-2_D_V1-0.zip
run script
2024-01-09T14:29:09.444    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:29:09.444    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140219-100005-428_L1C_047-256-2_D_V1-0.zip
2024-01-09T14:29:09.444    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:29:09.444    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:29:09.444    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:29:09.445    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:29:09.445    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:29:09.445    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:29:09.445    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:29:09.445    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140219-100005-428_L1C_047-256-2_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2014/04/16/SPOT5-HRG1-XS_20140416-101939-924_L1C_047-255-9_D_V1-0/SPOT5-HRG1-XS_20140416-101939-924_L1C_047-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140416-101939-924_L1C_047-255-9_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140416-101939-924_L1C_047-255-9_D_V1-0.zip
run script
2024-01-09T14:29:15.377    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:29:15.378    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140416-101939-924_L1C_047-255-9_D_V1-0.zip
2024-01-09T14:29:15.378    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:29:15.379    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:29:15.379    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:29:15.379    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:29:15.379    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:29:15.379    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:29:15.379    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:29:15.380    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140416-101939-924_L1C_047-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2014/04/16/SPOT5-HRG1-XS_20140416-101940-165_L1C_047-256-0_D_V1-0/SPOT5-HRG1-XS_20140416-101940-165_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140416-101940-165_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140416-101940-165_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T14:29:21.316    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:29:21.317    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140416-101940-165_L1C_047-256-0_D_V1-0.zip
2024-01-09T14:29:21.317    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:29:21.317    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:29:21.317    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:29:21.317    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:29:21.317    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:29:21.317    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:29:21.317    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:29:21.317    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140416-101940-165_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2014/04/16/SPOT5-HRG1-XS_20140416-101941-055_L1C_047-256-1_D_V1-0/SPOT5-HRG1-XS_20140416-101941-055_L1C_047-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140416-101941-055_L1C_047-256-1_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140416-101941-055_L1C_047-256-1_D_V1-0.zip
run script
2024-01-09T14:29:29.180    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:29:29.181    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140416-101941-055_L1C_047-256-1_D_V1-0.zip
2024-01-09T14:29:29.181    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:29:29.181    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:29:29.181    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:29:29.181    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:29:29.181    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:29:29.181    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:29:29.181    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:29:29.182    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140416-101941-055_L1C_047-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2014/04/06/SPOT5-HRG1-XS_20140406-101311-026_L1C_047-260-1_D_V1-0/SPOT5-HRG1-XS_20140406-101311-026_L1C_047-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140406-101311-026_L1C_047-260-1_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140406-101311-026_L1C_047-260-1_D_V1-0.zip
run script
2024-01-09T14:29:35.469    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:29:35.470    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140406-101311-026_L1C_047-260-1_D_V1-0.zip
2024-01-09T14:29:35.470    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:29:35.470    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:29:35.470    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:29:35.470    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:29:35.470    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:29:35.470    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:29:35.470    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:29:35.470    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140406-101311-026_L1C_047-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2014/04/06/SPOT5-HRG2-XS_20140406-101302-573_L1C_048-259-3_D_V1-0/SPOT5-HRG2-XS_20140406-101302-573_L1C_048-259-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140406-101302-573_L1C_048-259-3_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140406-101302-573_L1C_048-259-3_D_V1-0.zip
run script
2024-01-09T14:29:41.081    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:29:41.082    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140406-101302-573_L1C_048-259-3_D_V1-0.zip
2024-01-09T14:29:41.082    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:29:41.082    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:29:41.082    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:29:41.082    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:29:41.082    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:29:41.082    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:29:41.082    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:29:41.082    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T14:29:47.423    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (342 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140406-101302-573_L1C_048-259-3_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2014/04/06/SPOT5-HRG2-XS_20140406-101305-292_L1C_048-259-6_D_V1-0/SPOT5-HRG2-XS_20140406-101305-292_L1C_048-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140406-101305-292_L1C_048-259-6_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140406-101305-292_L1C_048-259-6_D_V1-0.zip
run script
2024-01-09T14:29:53.127    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:29:53.127    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140406-101305-292_L1C_048-259-6_D_V1-0.zip
2024-01-09T14:29:53.127    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:29:53.128    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:29:53.128    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:29:53.128    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:29:53.128    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:29:53.128    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:29:53.128    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:29:53.128    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140406-101305-292_L1C_048-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2014/07/19/SPOT5-HRG2-XS_20140719-100501-761_L1C_048-254-0_D_V1-0/SPOT5-HRG2-XS_20140719-100501-761_L1C_048-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140719-100501-761_L1C_048-254-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140719-100501-761_L1C_048-254-0_D_V1-0.zip
run script
2024-01-09T14:29:57.936    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:29:57.937    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140719-100501-761_L1C_048-254-0_D_V1-0.zip
2024-01-09T14:29:57.937    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:29:57.937    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:29:57.937    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:29:57.937    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:29:57.937    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:29:57.937    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:29:57.938    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:29:57.938    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140719-100501-761_L1C_048-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2014/07/19/SPOT5-HRG2-XS_20140719-100510-087_L1C_048-255-0_D_V1-0/SPOT5-HRG2-XS_20140719-100510-087_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140719-100510-087_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140719-100510-087_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T14:30:02.123    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:30:02.124    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140719-100510-087_L1C_048-255-0_D_V1-0.zip
2024-01-09T14:30:02.124    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:30:02.124    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:30:02.124    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:30:02.124    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:30:02.125    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:30:02.125    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:30:02.125    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:30:02.125    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140719-100510-087_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/07/19/SPOT5-HRG2-XS_20140719-100518-413_L1C_048-256-0_D_V1-0/SPOT5-HRG2-XS_20140719-100518-413_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140719-100518-413_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140719-100518-413_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T14:30:30.464    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:30:30.465    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140719-100518-413_L1C_048-256-0_D_V1-0.zip
2024-01-09T14:30:30.465    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:30:30.465    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:30:30.465    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:30:30.465    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:30:30.465    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:30:30.465    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:30:30.465    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:30:30.466    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140719-100518-413_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/07/19/SPOT5-HRG2-XS_20140719-100534-898_L1C_048-257-9_D_V1-0/SPOT5-HRG2-XS_20140719-100534-898_L1C_048-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140719-100534-898_L1C_048-257-9_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140719-100534-898_L1C_048-257-9_D_V1-0.zip
run script
2024-01-09T14:31:26.865    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:31:26.866    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140719-100534-898_L1C_048-257-9_D_V1-0.zip
2024-01-09T14:31:26.866    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:31:26.866    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:31:26.866    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:31:26.866    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:31:26.866    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:31:26.866    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:31:26.867    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:31:26.867    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T14:31:33.082    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (480 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140719-100534-898_L1C_048-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2014/07/19/SPOT5-HRG2-XS_20140719-100544-355_L1C_048-259-1_D_V1-0/SPOT5-HRG2-XS_20140719-100544-355_L1C_048-259-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140719-100544-355_L1C_048-259-1_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140719-100544-355_L1C_048-259-1_D_V1-0.zip
run script
2024-01-09T14:31:37.273    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:31:37.274    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140719-100544-355_L1C_048-259-1_D_V1-0.zip
2024-01-09T14:31:37.274    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:31:37.274    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:31:37.274    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:31:37.274    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:31:37.274    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:31:37.274    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:31:37.274    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:31:37.274    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140719-100544-355_L1C_048-259-1_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2014/07/24/SPOT5-HRG1-XS_20140724-100832-453_L1C_048-254-0_D_V1-0/SPOT5-HRG1-XS_20140724-100832-453_L1C_048-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140724-100832-453_L1C_048-254-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140724-100832-453_L1C_048-254-0_D_V1-0.zip
run script
2024-01-09T14:31:42.757    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:31:42.757    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140724-100832-453_L1C_048-254-0_D_V1-0.zip
2024-01-09T14:31:42.757    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:31:42.757    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:31:42.757    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:31:42.757    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:31:42.757    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:31:42.757    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:31:42.758    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:31:42.758    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140724-100832-453_L1C_048-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2014/07/24/SPOT5-HRG1-XS_20140724-100840-803_L1C_048-255-0_D_V1-0/SPOT5-HRG1-XS_20140724-100840-803_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140724-100840-803_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140724-100840-803_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T14:31:48.690    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:31:48.690    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140724-100840-803_L1C_048-255-0_D_V1-0.zip
2024-01-09T14:31:48.690    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:31:48.690    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:31:48.690    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:31:48.690    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:31:48.691    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:31:48.691    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:31:48.691    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:31:48.691    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140724-100840-803_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/07/24/SPOT5-HRG1-XS_20140724-100841-694_L1C_048-255-1_D_V1-0/SPOT5-HRG1-XS_20140724-100841-694_L1C_048-255-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140724-100841-694_L1C_048-255-1_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140724-100841-694_L1C_048-255-1_D_V1-0.zip
run script
2024-01-09T14:32:19.221    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:32:19.222    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140724-100841-694_L1C_048-255-1_D_V1-0.zip
2024-01-09T14:32:19.222    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:32:19.222    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:32:19.222    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:32:19.222    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:32:19.222    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:32:19.222    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:32:19.222    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:32:19.222    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140724-100841-694_L1C_048-255-1_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/08/09/SPOT5-HRG2-XS_20140809-100000-301_L1C_048-255-9_D_V1-0/SPOT5-HRG2-XS_20140809-100000-301_L1C_048-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140809-100000-301_L1C_048-255-9_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140809-100000-301_L1C_048-255-9_D_V1-0.zip
run script
2024-01-09T14:32:53.571    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:32:53.572    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140809-100000-301_L1C_048-255-9_D_V1-0.zip
2024-01-09T14:32:53.572    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:32:53.573    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:32:53.573    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:32:53.573    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:32:53.573    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:32:53.573    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:32:53.573    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:32:53.573    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140809-100000-301_L1C_048-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/08/09/SPOT5-HRG2-XS_20140809-100000-469_L1C_048-256-0_D_V1-0/SPOT5-HRG2-XS_20140809-100000-469_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140809-100000-469_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140809-100000-469_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T14:33:47.338    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:33:47.339    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140809-100000-469_L1C_048-256-0_D_V1-0.zip
2024-01-09T14:33:47.339    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:33:47.339    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:33:47.339    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:33:47.340    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:33:47.340    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:33:47.340    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:33:47.340    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:33:47.340    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140809-100000-469_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/08/09/SPOT5-HRG1-XS_20140809-100026-849_L1C_052-259-9_D_V1-0/SPOT5-HRG1-XS_20140809-100026-849_L1C_052-259-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140809-100026-849_L1C_052-259-9_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140809-100026-849_L1C_052-259-9_D_V1-0.zip
run script
2024-01-09T14:34:42.341    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:34:42.343    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140809-100026-849_L1C_052-259-9_D_V1-0.zip
2024-01-09T14:34:42.343    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:34:42.343    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:34:42.343    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:34:42.343    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:34:42.343    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:34:42.343    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:34:42.343    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:34:42.343    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T14:36:18.019    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 159). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140809-100026-849_L1C_052-259-9_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2014/08/09/SPOT5-HRG1-XS_20140809-100027-114_L1C_052-260-0_D_V1-0/SPOT5-HRG1-XS_20140809-100027-114_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140809-100027-114_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140809-100027-114_L1C_052-260-0_D_V1-0.zip
run script
2024-01-09T14:36:24.073    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:36:24.074    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140809-100027-114_L1C_052-260-0_D_V1-0.zip
2024-01-09T14:36:24.074    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:36:24.074    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:36:24.074    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:36:24.074    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:36:24.074    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:36:24.074    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:36:24.075    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:36:24.075    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140809-100027-114_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/08/09/SPOT5-HRG1-XS_20140809-100028-005_L1C_052-260-1_D_V1-0/SPOT5-HRG1-XS_20140809-100028-005_L1C_052-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140809-100028-005_L1C_052-260-1_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140809-100028-005_L1C_052-260-1_D_V1-0.zip
run script
2024-01-09T14:39:46.125    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:39:46.126    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140809-100028-005_L1C_052-260-1_D_V1-0.zip
2024-01-09T14:39:46.126    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:39:46.126    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:39:46.126    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:39:46.126    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:39:46.126    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:39:46.126    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:39:46.126    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:39:46.127    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140809-100028-005_L1C_052-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/09/04/SPOT5-HRG2-XS_20140904-095804-355_L1C_048-255-9_D_V1-0/SPOT5-HRG2-XS_20140904-095804-355_L1C_048-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140904-095804-355_L1C_048-255-9_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140904-095804-355_L1C_048-255-9_D_V1-0.zip
run script
2024-01-09T14:43:06.827    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:43:06.828    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140904-095804-355_L1C_048-255-9_D_V1-0.zip
2024-01-09T14:43:06.828    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:43:06.828    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:43:06.828    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:43:06.828    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:43:06.828    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:43:06.828    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:43:06.829    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:43:06.829    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140904-095804-355_L1C_048-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/09/04/SPOT5-HRG2-XS_20140904-095804-523_L1C_048-256-0_D_V1-0/SPOT5-HRG2-XS_20140904-095804-523_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140904-095804-523_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140904-095804-523_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T14:45:00.906    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:45:00.908    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140904-095804-523_L1C_048-256-0_D_V1-0.zip
2024-01-09T14:45:00.908    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:45:00.908    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:45:00.908    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:45:00.908    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:45:00.908    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:45:00.908    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:45:00.908    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:45:00.908    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140904-095804-523_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/09/04/SPOT5-HRG2-XS_20140904-095812-849_L1C_048-257-0_D_V1-0/SPOT5-HRG2-XS_20140904-095812-849_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140904-095812-849_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140904-095812-849_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T14:45:44.992    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:45:44.993    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140904-095812-849_L1C_048-257-0_D_V1-0.zip
2024-01-09T14:45:44.993    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:45:44.993    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:45:44.993    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:45:44.993    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:45:44.993    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:45:44.994    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:45:44.994    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:45:44.994    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140904-095812-849_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/09/04/SPOT5-HRG2-XS_20140904-095821-176_L1C_048-258-0_D_V1-0/SPOT5-HRG2-XS_20140904-095821-176_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140904-095821-176_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140904-095821-176_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T14:46:12.508    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:46:12.509    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140904-095821-176_L1C_048-258-0_D_V1-0.zip
2024-01-09T14:46:12.509    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:46:12.510    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:46:12.510    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:46:12.510    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:46:12.510    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:46:12.510    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:46:12.510    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:46:12.510    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140904-095821-176_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2014/09/04/SPOT5-HRG2-XS_20140904-095829-502_L1C_048-259-0_D_V1-0/SPOT5-HRG2-XS_20140904-095829-502_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140904-095829-502_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140904-095829-502_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T14:46:18.368    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:46:18.370    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140904-095829-502_L1C_048-259-0_D_V1-0.zip
2024-01-09T14:46:18.370    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:46:18.370    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:46:18.370    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:46:18.370    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:46:18.370    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:46:18.370    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:46:18.370    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:46:18.370    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140904-095829-502_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2014/09/04/SPOT5-HRG2-XS_20140904-095830-392_L1C_048-259-1_D_V1-0/SPOT5-HRG2-XS_20140904-095830-392_L1C_048-259-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140904-095830-392_L1C_048-259-1_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140904-095830-392_L1C_048-259-1_D_V1-0.zip
run script
2024-01-09T14:46:24.103    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:46:24.104    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140904-095830-392_L1C_048-259-1_D_V1-0.zip
2024-01-09T14:46:24.104    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:46:24.104    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:46:24.104    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:46:24.104    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:46:24.104    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:46:24.105    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:46:24.105    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:46:24.105    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140904-095830-392_L1C_048-259-1_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2014/06/29/SPOT5-HRG1-XS_20140629-095125-724_L1C_048-256-0_D_V1-0/SPOT5-HRG1-XS_20140629-095125-724_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140629-095125-724_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140629-095125-724_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T14:46:28.968    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:46:28.969    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140629-095125-724_L1C_048-256-0_D_V1-0.zip
2024-01-09T14:46:28.969    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:46:28.969    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:46:28.969    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:46:28.969    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:46:28.969    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:46:28.969    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:46:28.970    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:46:28.970    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140629-095125-724_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/06/29/SPOT5-HRG1-XS_20140629-095133-978_L1C_048-257-0_D_V1-0/SPOT5-HRG1-XS_20140629-095133-978_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140629-095133-978_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140629-095133-978_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T14:47:07.571    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:47:07.572    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140629-095133-978_L1C_048-257-0_D_V1-0.zip
2024-01-09T14:47:07.573    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:47:07.573    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:47:07.573    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:47:07.573    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:47:07.573    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:47:07.573    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:47:07.573    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:47:07.573    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140629-095133-978_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/06/29/SPOT5-HRG1-XS_20140629-095142-256_L1C_048-258-0_D_V1-0/SPOT5-HRG1-XS_20140629-095142-256_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140629-095142-256_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140629-095142-256_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T14:47:31.368    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:47:31.369    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140629-095142-256_L1C_048-258-0_D_V1-0.zip
2024-01-09T14:47:31.370    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:47:31.370    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:47:31.370    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:47:31.370    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:47:31.370    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:47:31.370    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:47:31.370    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:47:31.370    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140629-095142-256_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2014/06/29/SPOT5-HRG1-XS_20140629-095144-061_L1C_048-258-2_D_V1-0/SPOT5-HRG1-XS_20140629-095144-061_L1C_048-258-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140629-095144-061_L1C_048-258-2_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140629-095144-061_L1C_048-258-2_D_V1-0.zip
run script
2024-01-09T14:47:35.653    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:47:35.653    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140629-095144-061_L1C_048-258-2_D_V1-0.zip
2024-01-09T14:47:35.653    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:47:35.653    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:47:35.653    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:47:35.653    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:47:35.653    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:47:35.654    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:47:35.654    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:47:35.654    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140629-095144-061_L1C_048-258-2_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2014/06/29/SPOT5-HRG2-XS_20140629-095205-371_L1C_049-261-0_D_V1-0/SPOT5-HRG2-XS_20140629-095205-371_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140629-095205-371_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140629-095205-371_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T14:47:39.022    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:47:39.023    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140629-095205-371_L1C_049-261-0_D_V1-0.zip
2024-01-09T14:47:39.023    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:47:39.023    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:47:39.023    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:47:39.023    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:47:39.023    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:47:39.023    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:47:39.023    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:47:39.023    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140629-095205-371_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/06/29/SPOT5-HRG2-XS_20140629-095213-697_L1C_049-262-0_D_V1-0/SPOT5-HRG2-XS_20140629-095213-697_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140629-095213-697_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140629-095213-697_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T14:48:01.925    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:48:01.926    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140629-095213-697_L1C_049-262-0_D_V1-0.zip
2024-01-09T14:48:01.926    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:48:01.926    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:48:01.926    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:48:01.926    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:48:01.926    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:48:01.927    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:48:01.927    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:48:01.927    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140629-095213-697_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2014/02/03/SPOT5-HRG1-XS_20140203-100902-224_L1C_048-257-9_D_V1-0/SPOT5-HRG1-XS_20140203-100902-224_L1C_048-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140203-100902-224_L1C_048-257-9_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140203-100902-224_L1C_048-257-9_D_V1-0.zip
run script
2024-01-09T14:48:08.188    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:48:08.189    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140203-100902-224_L1C_048-257-9_D_V1-0.zip
2024-01-09T14:48:08.189    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:48:08.189    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:48:08.189    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:48:08.189    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:48:08.189    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:48:08.189    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:48:08.189    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:48:08.189    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T14:48:39.087    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 104). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140203-100902-224_L1C_048-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2014/02/03/SPOT5-HRG1-XS_20140203-100902-393_L1C_048-258-0_D_V1-0/SPOT5-HRG1-XS_20140203-100902-393_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140203-100902-393_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140203-100902-393_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T14:48:45.375    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:48:45.376    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140203-100902-393_L1C_048-258-0_D_V1-0.zip
2024-01-09T14:48:45.376    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:48:45.376    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:48:45.376    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:48:45.376    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:48:45.376    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:48:45.376    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:48:45.377    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:48:45.377    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T14:49:17.622    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (0 x 860). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140203-100902-393_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2014/02/03/SPOT5-HRG1-XS_20140203-100903-283_L1C_048-258-1_D_V1-0/SPOT5-HRG1-XS_20140203-100903-283_L1C_048-258-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140203-100903-283_L1C_048-258-1_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140203-100903-283_L1C_048-258-1_D_V1-0.zip
run script
2024-01-09T14:49:23.245    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:49:23.247    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140203-100903-283_L1C_048-258-1_D_V1-0.zip
2024-01-09T14:49:23.247    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:49:23.247    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:49:23.247    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:49:23.247    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:49:23.247    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:49:23.247    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:49:23.247    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:49:23.247    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140203-100903-283_L1C_048-258-1_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/02/23/SPOT5-HRG2-XS_20140223-102309-798_L1C_048-258-0_D_V1-0/SPOT5-HRG2-XS_20140223-102309-798_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140223-102309-798_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140223-102309-798_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T14:49:56.720    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:49:56.721    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140223-102309-798_L1C_048-258-0_D_V1-0.zip
2024-01-09T14:49:56.721    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:49:56.721    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:49:56.721    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:49:56.721    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:49:56.721    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:49:56.721    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:49:56.721    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:49:56.721    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T14:50:43.499    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 134). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140223-102309-798_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2014/02/23/SPOT5-HRG2-XS_20140223-102310-712_L1C_048-258-1_D_V1-0/SPOT5-HRG2-XS_20140223-102310-712_L1C_048-258-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140223-102310-712_L1C_048-258-1_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140223-102310-712_L1C_048-258-1_D_V1-0.zip
run script
2024-01-09T14:50:49.860    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:50:49.862    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140223-102310-712_L1C_048-258-1_D_V1-0.zip
2024-01-09T14:50:49.862    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:50:49.862    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:50:49.862    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:50:49.862    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:50:49.862    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:50:49.862    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:50:49.862    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:50:49.862    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140223-102310-712_L1C_048-258-1_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/02/23/SPOT5-HRG2-XS_20140223-102309-533_L1C_049-257-9_D_V1-0/SPOT5-HRG2-XS_20140223-102309-533_L1C_049-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140223-102309-533_L1C_049-257-9_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140223-102309-533_L1C_049-257-9_D_V1-0.zip
run script
2024-01-09T14:51:38.235    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:51:38.236    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140223-102309-533_L1C_049-257-9_D_V1-0.zip
2024-01-09T14:51:38.236    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:51:38.237    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:51:38.237    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:51:38.237    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:51:38.237    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:51:38.237    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:51:38.237    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:51:38.237    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140223-102309-533_L1C_049-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/02/23/SPOT5-HRG1-XS_20140223-102306-834_L1C_050-257-9_D_V1-0/SPOT5-HRG1-XS_20140223-102306-834_L1C_050-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140223-102306-834_L1C_050-257-9_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140223-102306-834_L1C_050-257-9_D_V1-0.zip
run script
2024-01-09T14:52:34.895    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:52:34.895    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140223-102306-834_L1C_050-257-9_D_V1-0.zip
2024-01-09T14:52:34.895    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:52:34.895    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:52:34.895    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:52:34.895    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:52:34.895    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:52:34.896    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:52:34.896    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:52:34.896    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140223-102306-834_L1C_050-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/02/23/SPOT5-HRG1-XS_20140223-102307-123_L1C_050-258-0_D_V1-0/SPOT5-HRG1-XS_20140223-102307-123_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140223-102307-123_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140223-102307-123_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T14:56:15.686    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:56:15.687    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140223-102307-123_L1C_050-258-0_D_V1-0.zip
2024-01-09T14:56:15.687    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:56:15.688    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:56:15.688    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:56:15.688    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:56:15.688    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:56:15.688    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:56:15.688    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:56:15.688    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T15:00:38.508    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 49). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140223-102307-123_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2014/02/23/SPOT5-HRG1-XS_20140223-102308-037_L1C_050-258-1_D_V1-0/SPOT5-HRG1-XS_20140223-102308-037_L1C_050-258-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140223-102308-037_L1C_050-258-1_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140223-102308-037_L1C_050-258-1_D_V1-0.zip
run script
2024-01-09T15:00:44.820    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:00:44.821    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140223-102308-037_L1C_050-258-1_D_V1-0.zip
2024-01-09T15:00:44.821    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:00:44.821    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:00:44.821    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:00:44.821    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:00:44.821    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:00:44.821    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:00:44.821    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:00:44.821    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T15:03:21.322    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 2026). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140223-102308-037_L1C_050-258-1_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2014/04/12/SPOT5-HRG1-XS_20140412-095716-185_L1C_048-259-4_D_V1-0/SPOT5-HRG1-XS_20140412-095716-185_L1C_048-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140412-095716-185_L1C_048-259-4_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140412-095716-185_L1C_048-259-4_D_V1-0.zip
run script
2024-01-09T15:03:27.173    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:03:27.174    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140412-095716-185_L1C_048-259-4_D_V1-0.zip
2024-01-09T15:03:27.174    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:03:27.174    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:03:27.174    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:03:27.174    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:03:27.174    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:03:27.174    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:03:27.174    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:03:27.174    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140412-095716-185_L1C_048-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2014/04/12/SPOT5-HRG1-XS_20140412-095717-990_L1C_048-259-6_D_V1-0/SPOT5-HRG1-XS_20140412-095717-990_L1C_048-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140412-095717-990_L1C_048-259-6_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140412-095717-990_L1C_048-259-6_D_V1-0.zip
run script
2024-01-09T15:03:33.112    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:03:33.113    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140412-095717-990_L1C_048-259-6_D_V1-0.zip
2024-01-09T15:03:33.113    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:03:33.113    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:03:33.113    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:03:33.113    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:03:33.113    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:03:33.113    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:03:33.113    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:03:33.113    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140412-095717-990_L1C_048-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2014/09/15/SPOT5-HRG1-XS_20140915-094614-162_L1C_048-260-0_D_V1-0/SPOT5-HRG1-XS_20140915-094614-162_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140915-094614-162_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140915-094614-162_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T15:03:37.404    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:03:37.405    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140915-094614-162_L1C_048-260-0_D_V1-0.zip
2024-01-09T15:03:37.405    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:03:37.406    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:03:37.406    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:03:37.406    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:03:37.406    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:03:37.406    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:03:37.406    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:03:37.406    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140915-094614-162_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2014/09/15/SPOT5-HRG1-XS_20140915-094622-464_L1C_048-261-0_D_V1-0/SPOT5-HRG1-XS_20140915-094622-464_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140915-094622-464_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140915-094622-464_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T15:03:40.803    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:03:40.804    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140915-094622-464_L1C_048-261-0_D_V1-0.zip
2024-01-09T15:03:40.804    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:03:40.804    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:03:40.805    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:03:40.805    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:03:40.805    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:03:40.805    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:03:40.805    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:03:40.805    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140915-094622-464_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2014/09/15/SPOT5-HRG1-XS_20140915-094547-517_L1C_049-256-9_D_V1-0/SPOT5-HRG1-XS_20140915-094547-517_L1C_049-256-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140915-094547-517_L1C_049-256-9_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140915-094547-517_L1C_049-256-9_D_V1-0.zip
run script
2024-01-09T15:03:46.219    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:03:46.220    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140915-094547-517_L1C_049-256-9_D_V1-0.zip
2024-01-09T15:03:46.220    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:03:46.220    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:03:46.221    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:03:46.221    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:03:46.221    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:03:46.221    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:03:46.221    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:03:46.221    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140915-094547-517_L1C_049-256-9_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/09/15/SPOT5-HRG1-XS_20140915-094547-638_L1C_049-257-0_D_V1-0/SPOT5-HRG1-XS_20140915-094547-638_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140915-094547-638_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140915-094547-638_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T15:05:20.170    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:05:20.171    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140915-094547-638_L1C_049-257-0_D_V1-0.zip
2024-01-09T15:05:20.171    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:05:20.172    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:05:20.172    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:05:20.172    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:05:20.172    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:05:20.172    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:05:20.172    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:05:20.172    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140915-094547-638_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/09/15/SPOT5-HRG1-XS_20140915-094549-443_L1C_049-257-2_D_V1-0/SPOT5-HRG1-XS_20140915-094549-443_L1C_049-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140915-094549-443_L1C_049-257-2_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140915-094549-443_L1C_049-257-2_D_V1-0.zip
run script
2024-01-09T15:06:51.746    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:06:51.747    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140915-094549-443_L1C_049-257-2_D_V1-0.zip
2024-01-09T15:06:51.748    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:06:51.748    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:06:51.748    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:06:51.748    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:06:51.748    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:06:51.748    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:06:51.748    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:06:51.748    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140915-094549-443_L1C_049-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/05/18/SPOT5-HRG2-XS_20140518-100144-663_L1C_049-255-2_D_V1-0/SPOT5-HRG2-XS_20140518-100144-663_L1C_049-255-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140518-100144-663_L1C_049-255-2_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140518-100144-663_L1C_049-255-2_D_V1-0.zip
run script
2024-01-09T15:08:22.603    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:08:22.604    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140518-100144-663_L1C_049-255-2_D_V1-0.zip
2024-01-09T15:08:22.604    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:08:22.604    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:08:22.605    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:08:22.605    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:08:22.605    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:08:22.605    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:08:22.605    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:08:22.605    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140518-100144-663_L1C_049-255-2_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/05/18/SPOT5-HRG2-XS_20140518-100147-358_L1C_049-255-5_D_V1-0/SPOT5-HRG2-XS_20140518-100147-358_L1C_049-255-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140518-100147-358_L1C_049-255-5_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140518-100147-358_L1C_049-255-5_D_V1-0.zip
run script
2024-01-09T15:09:38.867    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:09:38.868    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140518-100147-358_L1C_049-255-5_D_V1-0.zip
2024-01-09T15:09:38.868    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:09:38.868    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:09:38.868    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:09:38.868    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:09:38.868    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:09:38.868    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:09:38.868    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:09:38.869    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140518-100147-358_L1C_049-255-5_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/05/18/SPOT5-HRG1-XS_20140518-100158-829_L1C_049-257-0_D_V1-0/SPOT5-HRG1-XS_20140518-100158-829_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140518-100158-829_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140518-100158-829_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T15:11:22.196    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:11:22.197    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140518-100158-829_L1C_049-257-0_D_V1-0.zip
2024-01-09T15:11:22.197    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:11:22.197    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:11:22.197    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:11:22.197    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:11:22.197    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:11:22.197    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:11:22.197    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:11:22.197    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140518-100158-829_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/05/18/SPOT5-HRG1-XS_20140518-100201-524_L1C_049-257-3_D_V1-0/SPOT5-HRG1-XS_20140518-100201-524_L1C_049-257-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140518-100201-524_L1C_049-257-3_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140518-100201-524_L1C_049-257-3_D_V1-0.zip
run script
2024-01-09T15:13:43.425    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:13:43.426    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140518-100201-524_L1C_049-257-3_D_V1-0.zip
2024-01-09T15:13:43.426    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:13:43.426    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:13:43.426    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:13:43.426    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:13:43.426    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:13:43.426    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:13:43.426    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:13:43.426    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140518-100201-524_L1C_049-257-3_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/05/23/SPOT5-HRG1-XS_20140523-100516-662_L1C_049-255-2_D_V1-0/SPOT5-HRG1-XS_20140523-100516-662_L1C_049-255-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140523-100516-662_L1C_049-255-2_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140523-100516-662_L1C_049-255-2_D_V1-0.zip
run script
2024-01-09T15:15:43.824    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:15:43.825    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140523-100516-662_L1C_049-255-2_D_V1-0.zip
2024-01-09T15:15:43.825    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:15:43.825    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:15:43.825    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:15:43.825    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:15:43.825    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:15:43.825    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:15:43.825    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:15:43.825    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140523-100516-662_L1C_049-255-2_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/05/23/SPOT5-HRG1-XS_20140523-100519-381_L1C_049-255-5_D_V1-0/SPOT5-HRG1-XS_20140523-100519-381_L1C_049-255-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140523-100519-381_L1C_049-255-5_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140523-100519-381_L1C_049-255-5_D_V1-0.zip
run script
2024-01-09T15:17:01.268    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:17:01.269    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140523-100519-381_L1C_049-255-5_D_V1-0.zip
2024-01-09T15:17:01.269    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:17:01.269    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:17:01.269    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:17:01.269    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:17:01.269    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:17:01.269    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:17:01.270    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:17:01.270    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140523-100519-381_L1C_049-255-5_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/05/23/SPOT5-HRG2-XS_20140523-100557-676_L1C_052-260-7_D_V1-0/SPOT5-HRG2-XS_20140523-100557-676_L1C_052-260-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140523-100557-676_L1C_052-260-7_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140523-100557-676_L1C_052-260-7_D_V1-0.zip
run script
2024-01-09T15:18:44.746    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:18:44.747    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140523-100557-676_L1C_052-260-7_D_V1-0.zip
2024-01-09T15:18:44.747    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:18:44.747    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:18:44.747    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:18:44.747    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:18:44.747    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:18:44.747    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:18:44.747    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:18:44.747    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140523-100557-676_L1C_052-260-7_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 2 2 ... 2 2 2]
 [2 2 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/05/23/SPOT5-HRG2-XS_20140523-100559-745_L1C_052-261-0_D_V1-0/SPOT5-HRG2-XS_20140523-100559-745_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140523-100559-745_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140523-100559-745_L1C_052-261-0_D_V1-0.zip
run script
2024-01-09T15:22:21.760    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:22:21.761    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140523-100559-745_L1C_052-261-0_D_V1-0.zip
2024-01-09T15:22:21.761    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:22:21.762    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:22:21.762    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:22:21.762    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:22:21.762    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:22:21.762    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:22:21.762    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:22:21.762    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140523-100559-745_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/05/28/SPOT5-HRG2-XS_20140528-100850-897_L1C_049-255-5_D_V1-0/SPOT5-HRG2-XS_20140528-100850-897_L1C_049-255-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140528-100850-897_L1C_049-255-5_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140528-100850-897_L1C_049-255-5_D_V1-0.zip
run script
2024-01-09T15:26:00.519    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:26:00.520    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140528-100850-897_L1C_049-255-5_D_V1-0.zip
2024-01-09T15:26:00.520    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:26:00.520    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:26:00.520    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:26:00.520    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:26:00.520    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:26:00.520    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:26:00.520    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:26:00.521    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140528-100850-897_L1C_049-255-5_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/05/28/SPOT5-HRG2-XS_20140528-100928-921_L1C_052-260-7_D_V1-0/SPOT5-HRG2-XS_20140528-100928-921_L1C_052-260-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140528-100928-921_L1C_052-260-7_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140528-100928-921_L1C_052-260-7_D_V1-0.zip
run script
2024-01-09T15:27:46.861    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:27:46.862    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140528-100928-921_L1C_052-260-7_D_V1-0.zip
2024-01-09T15:27:46.862    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:27:46.862    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:27:46.862    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:27:46.862    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:27:46.862    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:27:46.862    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:27:46.862    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:27:46.862    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140528-100928-921_L1C_052-260-7_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 2 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/05/28/SPOT5-HRG2-XS_20140528-100931-014_L1C_052-261-0_D_V1-0/SPOT5-HRG2-XS_20140528-100931-014_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140528-100931-014_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140528-100931-014_L1C_052-261-0_D_V1-0.zip
run script
2024-01-09T15:31:36.209    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:31:36.210    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140528-100931-014_L1C_052-261-0_D_V1-0.zip
2024-01-09T15:31:36.210    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:31:36.210    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:31:36.210    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:31:36.210    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:31:36.210    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:31:36.210    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:31:36.211    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:31:36.211    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140528-100931-014_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/05/29/SPOT5-HRG1-XS_20140529-094928-482_L1C_049-255-2_D_V1-0/SPOT5-HRG1-XS_20140529-094928-482_L1C_049-255-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140529-094928-482_L1C_049-255-2_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140529-094928-482_L1C_049-255-2_D_V1-0.zip
run script
2024-01-09T15:35:31.889    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:35:31.890    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140529-094928-482_L1C_049-255-2_D_V1-0.zip
2024-01-09T15:35:31.891    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:35:31.891    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:35:31.891    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:35:31.891    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:35:31.891    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:35:31.891    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:35:31.891    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:35:31.891    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140529-094928-482_L1C_049-255-2_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/05/29/SPOT5-HRG1-XS_20140529-094931-201_L1C_049-255-5_D_V1-0/SPOT5-HRG1-XS_20140529-094931-201_L1C_049-255-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140529-094931-201_L1C_049-255-5_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140529-094931-201_L1C_049-255-5_D_V1-0.zip
run script
2024-01-09T15:36:43.747    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:36:43.749    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140529-094931-201_L1C_049-255-5_D_V1-0.zip
2024-01-09T15:36:43.749    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:36:43.749    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:36:43.749    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:36:43.749    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:36:43.749    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:36:43.749    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:36:43.749    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:36:43.749    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140529-094931-201_L1C_049-255-5_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/06/02/SPOT5-HRG1-XS_20140602-101219-619_L1C_049-255-2_D_V1-0/SPOT5-HRG1-XS_20140602-101219-619_L1C_049-255-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140602-101219-619_L1C_049-255-2_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140602-101219-619_L1C_049-255-2_D_V1-0.zip
run script
2024-01-09T15:38:22.144    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:38:22.145    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140602-101219-619_L1C_049-255-2_D_V1-0.zip
2024-01-09T15:38:22.145    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:38:22.145    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:38:22.145    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:38:22.145    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:38:22.145    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:38:22.145    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:38:22.145    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:38:22.145    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140602-101219-619_L1C_049-255-2_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/06/02/SPOT5-HRG1-XS_20140602-101222-314_L1C_049-255-5_D_V1-0/SPOT5-HRG1-XS_20140602-101222-314_L1C_049-255-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140602-101222-314_L1C_049-255-5_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140602-101222-314_L1C_049-255-5_D_V1-0.zip
run script
2024-01-09T15:39:48.153    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:39:48.154    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140602-101222-314_L1C_049-255-5_D_V1-0.zip
2024-01-09T15:39:48.154    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:39:48.154    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:39:48.154    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:39:48.154    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:39:48.154    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:39:48.154    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:39:48.154    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:39:48.154    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140602-101222-314_L1C_049-255-5_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/06/02/SPOT5-HRG2-XS_20140602-101206-036_L1C_051-254-0_D_V1-0/SPOT5-HRG2-XS_20140602-101206-036_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140602-101206-036_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140602-101206-036_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T15:41:36.865    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:41:36.866    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140602-101206-036_L1C_051-254-0_D_V1-0.zip
2024-01-09T15:41:36.866    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:41:36.866    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:41:36.867    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:41:36.867    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:41:36.867    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:41:36.867    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:41:36.867    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:41:36.867    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140602-101206-036_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2014/06/02/SPOT5-HRG2-XS_20140602-101206-926_L1C_051-254-1_D_V1-0/SPOT5-HRG2-XS_20140602-101206-926_L1C_051-254-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140602-101206-926_L1C_051-254-1_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140602-101206-926_L1C_051-254-1_D_V1-0.zip
run script
2024-01-09T15:41:42.225    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:41:42.226    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140602-101206-926_L1C_051-254-1_D_V1-0.zip
2024-01-09T15:41:42.226    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:41:42.226    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:41:42.226    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:41:42.226    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:41:42.226    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:41:42.226    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:41:42.226    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:41:42.227    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140602-101206-926_L1C_051-254-1_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2014/06/02/SPOT5-HRG1-XS_20140602-101300-123_L1C_052-260-7_D_V1-0/SPOT5-HRG1-XS_20140602-101300-123_L1C_052-260-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140602-101300-123_L1C_052-260-7_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140602-101300-123_L1C_052-260-7_D_V1-0.zip
run script
2024-01-09T15:41:48.093    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:41:48.103    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140602-101300-123_L1C_052-260-7_D_V1-0.zip
2024-01-09T15:41:48.103    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:41:48.103    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:41:48.103    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:41:48.103    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:41:48.103    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:41:48.103    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:41:48.103    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:41:48.103    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140602-101300-123_L1C_052-260-7_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/06/02/SPOT5-HRG1-XS_20140602-101302-240_L1C_052-261-0_D_V1-0/SPOT5-HRG1-XS_20140602-101302-240_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20140602-101302-240_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140602-101302-240_L1C_052-261-0_D_V1-0.zip
run script
2024-01-09T15:45:59.420    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:45:59.421    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140602-101302-240_L1C_052-261-0_D_V1-0.zip
2024-01-09T15:45:59.421    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:45:59.421    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:45:59.421    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:45:59.421    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:45:59.421    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:45:59.421    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:45:59.421    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:45:59.422    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20140602-101302-240_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/09/14/SPOT5-HRG2-XS_20140914-100457-526_L1C_049-255-9_D_V1-0/SPOT5-HRG2-XS_20140914-100457-526_L1C_049-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140914-100457-526_L1C_049-255-9_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140914-100457-526_L1C_049-255-9_D_V1-0.zip
run script
2024-01-09T15:50:18.134    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:50:18.135    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140914-100457-526_L1C_049-255-9_D_V1-0.zip
2024-01-09T15:50:18.135    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:50:18.135    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:50:18.135    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:50:18.135    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:50:18.135    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:50:18.135    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:50:18.135    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:50:18.135    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140914-100457-526_L1C_049-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/09/14/SPOT5-HRG2-XS_20140914-100457-767_L1C_049-256-0_D_V1-0/SPOT5-HRG2-XS_20140914-100457-767_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140914-100457-767_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140914-100457-767_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T15:53:30.020    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:53:30.021    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140914-100457-767_L1C_049-256-0_D_V1-0.zip
2024-01-09T15:53:30.021    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:53:30.021    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:53:30.021    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:53:30.022    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:53:30.022    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:53:30.022    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:53:30.022    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:53:30.022    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140914-100457-767_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/09/14/SPOT5-HRG2-XS_20140914-100506-141_L1C_049-257-0_D_V1-0/SPOT5-HRG2-XS_20140914-100506-141_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140914-100506-141_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140914-100506-141_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T15:56:43.363    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:56:43.364    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140914-100506-141_L1C_049-257-0_D_V1-0.zip
2024-01-09T15:56:43.364    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:56:43.364    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:56:43.364    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:56:43.364    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:56:43.364    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:56:43.364    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:56:43.364    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:56:43.364    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140914-100506-141_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/09/14/SPOT5-HRG2-XS_20140914-100514-540_L1C_049-258-0_D_V1-0/SPOT5-HRG2-XS_20140914-100514-540_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140914-100514-540_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140914-100514-540_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T15:59:19.326    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:59:19.327    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140914-100514-540_L1C_049-258-0_D_V1-0.zip
2024-01-09T15:59:19.327    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:59:19.328    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:59:19.328    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:59:19.328    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:59:19.328    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:59:19.328    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:59:19.328    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:59:19.328    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:00:57.057    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 614). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140914-100514-540_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2014/09/14/SPOT5-HRG2-XS_20140914-100522-938_L1C_049-259-0_D_V1-0/SPOT5-HRG2-XS_20140914-100522-938_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140914-100522-938_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140914-100522-938_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T16:01:03.279    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:01:03.281    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140914-100522-938_L1C_049-259-0_D_V1-0.zip
2024-01-09T16:01:03.281    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:01:03.281    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:01:03.281    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:01:03.281    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:01:03.281    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:01:03.281    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:01:03.281    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:01:03.281    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140914-100522-938_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/09/14/SPOT5-HRG2-XS_20140914-100523-828_L1C_049-259-1_D_V1-0/SPOT5-HRG2-XS_20140914-100523-828_L1C_049-259-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20140914-100523-828_L1C_049-259-1_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140914-100523-828_L1C_049-259-1_D_V1-0.zip
run script
2024-01-09T16:02:23.285    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:02:23.286    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140914-100523-828_L1C_049-259-1_D_V1-0.zip
2024-01-09T16:02:23.286    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:02:23.286    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:02:23.286    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:02:23.286    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:02:23.286    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:02:23.286    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:02:23.287    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:02:23.287    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20140914-100523-828_L1C_049-259-1_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/10/06/SPOT5-HRG2-XS_20141006-094018-861_L1C_049-255-9_D_V1-0/SPOT5-HRG2-XS_20141006-094018-861_L1C_049-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20141006-094018-861_L1C_049-255-9_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20141006-094018-861_L1C_049-255-9_D_V1-0.zip
run script
2024-01-09T16:03:40.562    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:03:40.563    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20141006-094018-861_L1C_049-255-9_D_V1-0.zip
2024-01-09T16:03:40.563    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:03:40.563    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:03:40.563    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:03:40.563    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:03:40.563    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:03:40.563    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:03:40.564    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:03:40.564    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20141006-094018-861_L1C_049-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/10/06/SPOT5-HRG2-XS_20141006-094018-957_L1C_049-256-0_D_V1-0/SPOT5-HRG2-XS_20141006-094018-957_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20141006-094018-957_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20141006-094018-957_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T16:05:30.501    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:05:30.502    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20141006-094018-957_L1C_049-256-0_D_V1-0.zip
2024-01-09T16:05:30.503    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:05:30.503    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:05:30.503    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:05:30.503    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:05:30.503    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:05:30.503    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:05:30.503    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:05:30.503    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:07:16.512    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (834 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20141006-094018-957_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2014/10/06/SPOT5-HRG2-XS_20141006-094027-211_L1C_049-257-0_D_V1-0/SPOT5-HRG2-XS_20141006-094027-211_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20141006-094027-211_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20141006-094027-211_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T16:07:22.055    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:07:22.057    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20141006-094027-211_L1C_049-257-0_D_V1-0.zip
2024-01-09T16:07:22.057    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:07:22.057    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:07:22.057    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:07:22.057    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:07:22.057    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:07:22.057    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:07:22.057    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:07:22.057    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20141006-094027-211_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/10/06/SPOT5-HRG2-XS_20141006-094029-016_L1C_049-257-2_D_V1-0/SPOT5-HRG2-XS_20141006-094029-016_L1C_049-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20141006-094029-016_L1C_049-257-2_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20141006-094029-016_L1C_049-257-2_D_V1-0.zip
run script
2024-01-09T16:08:57.467    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:08:57.468    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20141006-094029-016_L1C_049-257-2_D_V1-0.zip
2024-01-09T16:08:57.468    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:08:57.469    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:08:57.469    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:08:57.469    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:08:57.469    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:08:57.469    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:08:57.469    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:08:57.469    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG2-XS_20141006-094029-016_L1C_049-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/10/06/SPOT5-HRG1-XS_20141006-094008-633_L1C_050-255-0_D_V1-0/SPOT5-HRG1-XS_20141006-094008-633_L1C_050-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20141006-094008-633_L1C_050-255-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20141006-094008-633_L1C_050-255-0_D_V1-0.zip
run script
2024-01-09T16:10:31.269    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:10:31.270    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20141006-094008-633_L1C_050-255-0_D_V1-0.zip
2024-01-09T16:10:31.270    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:10:31.271    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:10:31.271    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:10:31.271    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:10:31.271    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:10:31.271    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:10:31.271    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:10:31.271    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20141006-094008-633_L1C_050-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 2 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/10/06/SPOT5-HRG1-XS_20141006-094016-887_L1C_050-256-0_D_V1-0/SPOT5-HRG1-XS_20141006-094016-887_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20141006-094016-887_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20141006-094016-887_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T16:11:36.610    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:11:36.611    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20141006-094016-887_L1C_050-256-0_D_V1-0.zip
2024-01-09T16:11:36.611    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:11:36.611    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:11:36.611    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:11:36.612    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:11:36.612    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:11:36.612    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:11:36.612    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:11:36.612    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20141006-094016-887_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/10/06/SPOT5-HRG1-XS_20141006-094025-165_L1C_050-257-0_D_V1-0/SPOT5-HRG1-XS_20141006-094025-165_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20141006-094025-165_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20141006-094025-165_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T16:14:54.179    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:14:54.180    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20141006-094025-165_L1C_050-257-0_D_V1-0.zip
2024-01-09T16:14:54.181    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:14:54.181    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:14:54.181    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:14:54.181    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:14:54.181    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:14:54.181    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:14:54.181    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:14:54.181    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20141006-094025-165_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/10/06/SPOT5-HRG1-XS_20141006-094026-970_L1C_050-257-2_D_V1-0/SPOT5-HRG1-XS_20141006-094026-970_L1C_050-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20141006-094026-970_L1C_050-257-2_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20141006-094026-970_L1C_050-257-2_D_V1-0.zip
run script
2024-01-09T16:18:25.958    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:18:25.959    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20141006-094026-970_L1C_050-257-2_D_V1-0.zip
2024-01-09T16:18:25.959    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:18:25.959    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:18:25.959    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:18:25.959    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:18:25.959    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:18:25.959    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:18:25.959    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:18:25.959    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20141006-094026-970_L1C_050-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/10/06/SPOT5-HRG1-XS_20141006-094047-659_L1C_052-259-9_D_V1-0/SPOT5-HRG1-XS_20141006-094047-659_L1C_052-259-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20141006-094047-659_L1C_052-259-9_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20141006-094047-659_L1C_052-259-9_D_V1-0.zip
run script
2024-01-09T16:21:54.170    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:21:54.172    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20141006-094047-659_L1C_052-259-9_D_V1-0.zip
2024-01-09T16:21:54.172    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:21:54.172    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:21:54.172    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:21:54.172    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:21:54.172    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:21:54.172    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:21:54.172    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:21:54.172    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20141006-094047-659_L1C_052-259-9_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/10/06/SPOT5-HRG1-XS_20141006-094047-828_L1C_052-260-0_D_V1-0/SPOT5-HRG1-XS_20141006-094047-828_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20141006-094047-828_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20141006-094047-828_L1C_052-260-0_D_V1-0.zip
run script
2024-01-09T16:24:54.766    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:24:54.767    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20141006-094047-828_L1C_052-260-0_D_V1-0.zip
2024-01-09T16:24:54.767    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:24:54.767    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:24:54.767    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:24:54.767    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:24:54.767    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:24:54.767    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:24:54.767    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:24:54.767    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20141006-094047-828_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2014/10/06/SPOT5-HRG1-XS_20141006-094048-718_L1C_052-260-1_D_V1-0/SPOT5-HRG1-XS_20141006-094048-718_L1C_052-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20141006-094048-718_L1C_052-260-1_D_V1-0.zip
/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20141006-094048-718_L1C_052-260-1_D_V1-0.zip
run script
2024-01-09T16:27:54.430    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:27:54.431    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20141006-094048-718_L1C_052-260-1_D_V1-0.zip
2024-01-09T16:27:54.431    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:27:54.431    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:27:54.431    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:27:54.431    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:27:54.431    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:27:54.431    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:27:54.431    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:27:54.432    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016101/INPUT/SPOT5-HRG1-XS_20141006-094048-718_L1C_052-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4016101/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
end
[2024-01-09 16:30:49.256030547+00:00] cnes_level2/barrouz/4016101:  Account (env) = cnes_level2
[2024-01-09 16:30:49.257316802+00:00] cnes_level2/barrouz/4016101:     User (env) = barrouz
[2024-01-09 16:30:49.258492058+00:00] cnes_level2/barrouz/4016101:        GroupId = cesbio(426000053)
[2024-01-09 16:30:49.259689985+00:00] cnes_level2/barrouz/4016101:         UserId = barrouz(9134)
[2024-01-09 16:30:49.261058989+00:00] cnes_level2/barrouz/4016101:        Account = cnes_level2
[2024-01-09 16:30:49.262358604+00:00] cnes_level2/barrouz/4016101:        Account = cnes_level2
[2024-01-09 16:30:49.263877787+00:00] cnes_level2/barrouz/4016101:      Partition = cpu2022
[2024-01-09 16:30:49.265071983+00:00] cnes_level2/barrouz/4016101:            QOS = cpu_2022_1280
[2024-01-09 16:30:49.266272279+00:00] cnes_level2/barrouz/4016101:        JobName = inf_ALP_0_TCD-ONLY_AVG-1200
[2024-01-09 16:30:49.267507825+00:00] cnes_level2/barrouz/4016101:     SubmitTime = 2024-01-09T10:51:14
[2024-01-09 16:30:49.268759581+00:00] cnes_level2/barrouz/4016101:        RunTime = 05:39:33
[2024-01-09 16:30:49.269935647+00:00] cnes_level2/barrouz/4016101:      TimeLimit = 1-16:00:00
[2024-01-09 16:30:49.271137703+00:00] cnes_level2/barrouz/4016101:   EligibleTime = 2024-01-09T10:51:14
[2024-01-09 16:30:49.272298250+00:00] cnes_level2/barrouz/4016101:      StartTime = 2024-01-09T10:51:16
[2024-01-09 16:30:49.273518736+00:00] cnes_level2/barrouz/4016101:        EndTime = 2024-01-09T16:30:49
[2024-01-09 16:30:49.274695073+00:00] cnes_level2/barrouz/4016101:       ExitCode = 0:0
[2024-01-09 16:30:49.275959608+00:00] cnes_level2/barrouz/4016101:       NodeList = trex074
[2024-01-09 16:30:49.277156485+00:00] cnes_level2/barrouz/4016101:      BatchHost = trex074
[2024-01-09 16:30:49.278433500+00:00] cnes_level2/barrouz/4016101:           TRES = 
[2024-01-09 16:30:49.279736325+00:00] cnes_level2/barrouz/4016101:        Command = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
[2024-01-09 16:30:49.280944191+00:00] cnes_level2/barrouz/4016101:        WorkDir = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code
[2024-01-09 16:30:49.282177577+00:00] cnes_level2/barrouz/4016101:         StdErr = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_0_TCD-ONLY_AVG-1200.log
[2024-01-09 16:30:49.283342784+00:00] cnes_level2/barrouz/4016101:         StdOut = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_0_TCD-ONLY_AVG-1200.log

#########################################
#        EVIDEN - CNES                  #
#        Job Accounting                 #
#########################################
Cluster              : trex
JobIDRaw             : 4016101
JobID                : 4016101
JobName              : inf_ALP_0_TCD-ONLY_AVG-1200
Account              : cnes_level2
User                 : barrouz(9134), cesbio(426000053)
Partition            : cpu2022
QOS                  : cpu_2022_1280
Nodelist             : trex074 (1)
State                : COMPLETED  (Exitcode=0:0, DerivedExitCode=0:0, Restarts=0)
Submit date          : 2024-01-09T10:51:14
Start time           : 2024-01-09T10:51:16
End time             : 2024-01-09T16:30:49
Elapsed time         : 05:39:33  (Timelimit=1-16:00:00, Suspended=00:00:00)
TEI                  : 1 day, 21:16:24
Command              : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
StdOut               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_0_TCD-ONLY_AVG-1200.log
StdErr               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_0_TCD-ONLY_AVG-1200.log

STEP(s) : 2
--------- 
   StepID  | JobName      State       Exit   Start               End                 Elapsed   TotalCPU   CPUTime    ConsumedEnergy MaxDiskRead MaxDiskWrite     MaxRSS MaxRSSTask MaxRSSNode NNodes UserCPU    NodeList
   ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 
   batch   | batch        COMPLETED   0:0    2024-01-09T10:51:16 2024-01-09T16:30:49 05:39:33  1-02:08:48 1-21:16:24        0.3125M  186962.07M    75393.77M  98552156K          0    trex074      1 19:12:36   trex074
   extern  | extern       COMPLETED   0:0    2024-01-09T10:51:16 2024-01-09T16:30:49 05:39:33  00:00:00   1-21:16:24        0.3125M       0.00M        0.00M      1708K          0    trex074      1 00:00:00   trex074

