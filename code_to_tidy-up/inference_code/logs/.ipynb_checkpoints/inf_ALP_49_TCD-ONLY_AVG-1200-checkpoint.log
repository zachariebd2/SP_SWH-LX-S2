unload conda/22.11.1  : OK 
load conda/22.11.1  : OK 
envs_dirs : /work/scratch/env/barrouz/conda_env/
pkgs_dirs : /work/scratch/env/barrouz/pkgs_conda
INPUT_PATH /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/49.txt
OUTPUT_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
DEM_PATH /work/CAMPUS/etudes/Neige/DEM
TCD_PATH /work/datalake/static_aux/TreeCoverDensity
MODELS_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
KEEP_REFL 0
MASK 1
start
/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/49.txt
muscate/SPOTWORLDHERITAGE/2009/01/21/SPOT4-HRVIR2-XS_20090121-103118-368_L1C_047-257-1_D_V1-0/SPOT4-HRVIR2-XS_20090121-103118-368_L1C_047-257-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090121-103118-368_L1C_047-257-1_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090121-103118-368_L1C_047-257-1_D_V1-0.zip
run script
2024-01-09T11:31:16.811    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:31:16.812    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090121-103118-368_L1C_047-257-1_D_V1-0.zip
2024-01-09T11:31:16.812    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:31:16.812    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:31:16.812    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:31:16.812    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:31:16.812    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:31:16.812    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:31:16.812    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:31:16.812    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090121-103118-368_L1C_047-257-1_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/05/16/SPOT4-HRVIR2-XS_20090516-101847-441_L1C_047-255-5_D_V1-0/SPOT4-HRVIR2-XS_20090516-101847-441_L1C_047-255-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090516-101847-441_L1C_047-255-5_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090516-101847-441_L1C_047-255-5_D_V1-0.zip
run script
2024-01-09T11:31:20.845    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:31:20.846    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090516-101847-441_L1C_047-255-5_D_V1-0.zip
2024-01-09T11:31:20.846    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:31:20.846    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:31:20.846    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:31:20.846    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:31:20.846    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:31:20.846    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:31:20.846    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:31:20.847    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090516-101847-441_L1C_047-255-5_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/05/16/SPOT4-HRVIR2-XS_20090516-101851-132_L1C_047-256-0_D_V1-0/SPOT4-HRVIR2-XS_20090516-101851-132_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090516-101851-132_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090516-101851-132_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T11:31:33.129    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:31:33.130    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090516-101851-132_L1C_047-256-0_D_V1-0.zip
2024-01-09T11:31:33.130    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:31:33.130    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:31:33.130    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:31:33.131    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:31:33.131    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:31:33.131    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:31:33.131    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:31:33.131    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:31:37.082    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (220 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090516-101851-132_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2009/05/16/SPOT4-HRVIR2-XS_20090516-101855-644_L1C_047-256-5_D_V1-0/SPOT4-HRVIR2-XS_20090516-101855-644_L1C_047-256-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090516-101855-644_L1C_047-256-5_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090516-101855-644_L1C_047-256-5_D_V1-0.zip
run script
2024-01-09T11:31:41.134    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:31:41.135    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090516-101855-644_L1C_047-256-5_D_V1-0.zip
2024-01-09T11:31:41.135    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:31:41.135    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:31:41.135    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:31:41.135    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:31:41.135    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:31:41.135    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:31:41.135    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:31:41.136    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090516-101855-644_L1C_047-256-5_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/05/16/SPOT4-HRVIR1-XS_20090516-101939-172_L1C_049-262-0_D_V1-0/SPOT4-HRVIR1-XS_20090516-101939-172_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090516-101939-172_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090516-101939-172_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T11:31:45.963    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:31:45.964    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090516-101939-172_L1C_049-262-0_D_V1-0.zip
2024-01-09T11:31:45.964    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:31:45.965    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:31:45.965    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:31:45.965    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:31:45.965    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:31:45.965    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:31:45.965    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:31:45.965    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090516-101939-172_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/05/16/SPOT4-HRVIR1-XS_20090516-101940-976_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20090516-101940-976_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090516-101940-976_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090516-101940-976_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T11:31:49.681    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:31:49.682    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090516-101940-976_L1C_049-262-2_D_V1-0.zip
2024-01-09T11:31:49.682    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:31:49.682    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:31:49.682    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:31:49.682    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:31:49.682    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:31:49.683    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:31:49.683    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:31:49.683    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090516-101940-976_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/05/16/SPOT4-HRVIR2-XS_20090516-101830-972_L1C_051-254-0_D_V1-0/SPOT4-HRVIR2-XS_20090516-101830-972_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090516-101830-972_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090516-101830-972_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T11:31:53.166    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:31:53.167    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090516-101830-972_L1C_051-254-0_D_V1-0.zip
2024-01-09T11:31:53.167    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:31:53.167    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:31:53.167    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:31:53.167    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:31:53.167    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:31:53.167    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:31:53.167    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:31:53.167    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090516-101830-972_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/06/14/SPOT4-HRVIR1-XS_20090614-110059-574_L1C_047-255-9_D_V1-0/SPOT4-HRVIR1-XS_20090614-110059-574_L1C_047-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090614-110059-574_L1C_047-255-9_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090614-110059-574_L1C_047-255-9_D_V1-0.zip
run script
2024-01-09T11:31:56.648    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:31:56.648    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090614-110059-574_L1C_047-255-9_D_V1-0.zip
2024-01-09T11:31:56.648    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:31:56.648    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:31:56.648    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:31:56.648    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:31:56.649    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:31:56.649    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:31:56.649    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:31:56.649    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090614-110059-574_L1C_047-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/14/SPOT4-HRVIR1-XS_20090614-110108-396_L1C_047-257-0_D_V1-0/SPOT4-HRVIR1-XS_20090614-110108-396_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090614-110108-396_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090614-110108-396_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T11:32:09.654    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:32:09.655    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090614-110108-396_L1C_047-257-0_D_V1-0.zip
2024-01-09T11:32:09.655    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:32:09.655    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:32:09.655    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:32:09.655    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:32:09.655    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:32:09.655    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:32:09.655    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:32:09.655    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090614-110108-396_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/08/28/SPOT4-HRVIR1-XS_20090828-101736-451_L1C_047-255-0_D_V1-0/SPOT4-HRVIR1-XS_20090828-101736-451_L1C_047-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090828-101736-451_L1C_047-255-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090828-101736-451_L1C_047-255-0_D_V1-0.zip
run script
2024-01-09T11:32:12.716    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:32:12.716    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090828-101736-451_L1C_047-255-0_D_V1-0.zip
2024-01-09T11:32:12.716    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:32:12.716    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:32:12.716    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:32:12.716    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:32:12.716    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:32:12.716    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:32:12.716    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:32:12.716    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090828-101736-451_L1C_047-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/28/SPOT4-HRVIR1-XS_20090828-101747-361_L1C_047-256-3_D_V1-0/SPOT4-HRVIR1-XS_20090828-101747-361_L1C_047-256-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090828-101747-361_L1C_047-256-3_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090828-101747-361_L1C_047-256-3_D_V1-0.zip
run script
2024-01-09T11:32:19.541    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:32:19.543    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090828-101747-361_L1C_047-256-3_D_V1-0.zip
2024-01-09T11:32:19.543    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:32:19.543    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:32:19.543    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:32:19.543    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:32:19.543    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:32:19.543    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:32:19.543    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:32:19.544    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090828-101747-361_L1C_047-256-3_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/08/28/SPOT4-HRVIR2-XS_20090828-101831-587_L1C_049-261-8_D_V1-0/SPOT4-HRVIR2-XS_20090828-101831-587_L1C_049-261-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090828-101831-587_L1C_049-261-8_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090828-101831-587_L1C_049-261-8_D_V1-0.zip
run script
2024-01-09T11:32:23.725    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:32:23.726    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090828-101831-587_L1C_049-261-8_D_V1-0.zip
2024-01-09T11:32:23.726    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:32:23.727    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:32:23.727    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:32:23.727    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:32:23.727    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:32:23.727    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:32:23.727    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:32:23.727    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090828-101831-587_L1C_049-261-8_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/08/28/SPOT4-HRVIR2-XS_20090828-101832-633_L1C_049-262-0_D_V1-0/SPOT4-HRVIR2-XS_20090828-101832-633_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090828-101832-633_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090828-101832-633_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T11:32:33.543    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:32:33.544    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090828-101832-633_L1C_049-262-0_D_V1-0.zip
2024-01-09T11:32:33.544    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:32:33.544    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:32:33.544    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:32:33.545    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:32:33.545    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:32:33.545    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:32:33.545    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:32:33.545    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090828-101832-633_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/08/28/SPOT4-HRVIR1-XS_20090828-101802-081_L1C_050-258-4_D_V1-0/SPOT4-HRVIR1-XS_20090828-101802-081_L1C_050-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090828-101802-081_L1C_050-258-4_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090828-101802-081_L1C_050-258-4_D_V1-0.zip
run script
2024-01-09T11:32:43.530    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:32:43.531    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090828-101802-081_L1C_050-258-4_D_V1-0.zip
2024-01-09T11:32:43.532    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:32:43.532    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:32:43.532    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:32:43.532    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:32:43.532    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:32:43.532    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:32:43.532    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:32:43.532    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:34:54.782    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 36). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090828-101802-081_L1C_050-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/08/28/SPOT4-HRVIR1-XS_20090828-101806-720_L1C_050-259-0_D_V1-0/SPOT4-HRVIR1-XS_20090828-101806-720_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090828-101806-720_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090828-101806-720_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T11:34:58.506    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:34:58.507    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090828-101806-720_L1C_050-259-0_D_V1-0.zip
2024-01-09T11:34:58.507    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:34:58.507    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:34:58.508    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:34:58.508    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:34:58.508    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:34:58.508    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:34:58.508    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:34:58.508    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:37:07.041    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (200 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090828-101806-720_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/09/11/SPOT4-HRVIR1-XS_20090911-104822-263_L1C_047-255-0_D_V1-0/SPOT4-HRVIR1-XS_20090911-104822-263_L1C_047-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090911-104822-263_L1C_047-255-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090911-104822-263_L1C_047-255-0_D_V1-0.zip
run script
2024-01-09T11:37:12.559    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:37:12.560    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090911-104822-263_L1C_047-255-0_D_V1-0.zip
2024-01-09T11:37:12.560    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:37:12.560    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:37:12.561    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:37:12.561    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:37:12.561    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:37:12.561    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:37:12.561    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:37:12.561    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090911-104822-263_L1C_047-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/09/11/SPOT4-HRVIR1-XS_20090911-104830-629_L1C_047-256-0_D_V1-0/SPOT4-HRVIR1-XS_20090911-104830-629_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090911-104830-629_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090911-104830-629_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T11:37:21.064    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:37:21.065    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090911-104830-629_L1C_047-256-0_D_V1-0.zip
2024-01-09T11:37:21.065    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:37:21.065    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:37:21.065    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:37:21.065    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:37:21.065    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:37:21.066    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:37:21.066    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:37:21.066    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090911-104830-629_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/09/11/SPOT4-HRVIR2-XS_20090911-104830-481_L1C_051-256-7_D_V1-0/SPOT4-HRVIR2-XS_20090911-104830-481_L1C_051-256-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090911-104830-481_L1C_051-256-7_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090911-104830-481_L1C_051-256-7_D_V1-0.zip
run script
2024-01-09T11:37:24.945    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:37:24.946    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090911-104830-481_L1C_051-256-7_D_V1-0.zip
2024-01-09T11:37:24.947    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:37:24.947    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:37:24.947    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:37:24.947    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:37:24.947    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:37:24.947    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:37:24.947    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:37:24.947    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090911-104830-481_L1C_051-256-7_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/09/11/SPOT4-HRVIR2-XS_20090911-104914-882_L1C_051-262-1_D_V1-0/SPOT4-HRVIR2-XS_20090911-104914-882_L1C_051-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090911-104914-882_L1C_051-262-1_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090911-104914-882_L1C_051-262-1_D_V1-0.zip
run script
2024-01-09T11:41:40.638    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:41:40.639    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090911-104914-882_L1C_051-262-1_D_V1-0.zip
2024-01-09T11:41:40.640    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:41:40.640    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:41:40.640    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:41:40.640    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:41:40.640    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:41:40.640    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:41:40.640    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:41:40.640    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090911-104914-882_L1C_051-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/09/11/SPOT4-HRVIR2-XS_20090911-104913-630_L1C_052-261-9_D_V1-0/SPOT4-HRVIR2-XS_20090911-104913-630_L1C_052-261-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090911-104913-630_L1C_052-261-9_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090911-104913-630_L1C_052-261-9_D_V1-0.zip
run script
2024-01-09T11:44:32.021    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:44:32.022    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090911-104913-630_L1C_052-261-9_D_V1-0.zip
2024-01-09T11:44:32.022    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:44:32.022    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:44:32.023    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:44:32.023    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:44:32.023    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:44:32.023    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:44:32.023    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:44:32.023    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090911-104913-630_L1C_052-261-9_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/09/21/SPOT4-HRVIR2-XS_20090921-105605-086_L1C_047-255-8_D_V1-0/SPOT4-HRVIR2-XS_20090921-105605-086_L1C_047-255-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090921-105605-086_L1C_047-255-8_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090921-105605-086_L1C_047-255-8_D_V1-0.zip
run script
2024-01-09T11:47:33.938    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:47:33.939    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090921-105605-086_L1C_047-255-8_D_V1-0.zip
2024-01-09T11:47:33.940    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:47:33.940    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:47:33.940    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:47:33.940    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:47:33.940    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:47:33.940    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:47:33.940    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:47:33.940    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:47:38.262    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (224 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090921-105605-086_L1C_047-255-8_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2009/09/21/SPOT4-HRVIR2-XS_20090921-105606-298_L1C_047-256-0_D_V1-0/SPOT4-HRVIR2-XS_20090921-105606-298_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090921-105606-298_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090921-105606-298_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T11:47:43.420    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:47:43.421    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090921-105606-298_L1C_047-256-0_D_V1-0.zip
2024-01-09T11:47:43.421    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:47:43.421    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:47:43.421    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:47:43.421    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:47:43.421    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:47:43.422    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:47:43.422    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:47:43.422    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:47:46.356    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (3948 x 0). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090921-105606-298_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2009/09/26/SPOT4-HRVIR2-XS_20090926-105945-553_L1C_047-255-0_D_V1-0/SPOT4-HRVIR2-XS_20090926-105945-553_L1C_047-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090926-105945-553_L1C_047-255-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090926-105945-553_L1C_047-255-0_D_V1-0.zip
run script
2024-01-09T11:47:51.405    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:47:51.405    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090926-105945-553_L1C_047-255-0_D_V1-0.zip
2024-01-09T11:47:51.405    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:47:51.405    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:47:51.405    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:47:51.405    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:47:51.405    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:47:51.405    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:47:51.406    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:47:51.406    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090926-105945-553_L1C_047-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/09/26/SPOT4-HRVIR2-XS_20090926-105954-021_L1C_047-256-0_D_V1-0/SPOT4-HRVIR2-XS_20090926-105954-021_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090926-105954-021_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090926-105954-021_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T11:48:06.923    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:48:06.925    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090926-105954-021_L1C_047-256-0_D_V1-0.zip
2024-01-09T11:48:06.925    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:48:06.925    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:48:06.925    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:48:06.925    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:48:06.925    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:48:06.925    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:48:06.925    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:48:06.925    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090926-105954-021_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/03/24/SPOT4-HRVIR1-XS_20090324-103844-078_L1C_047-256-8_D_V1-0/SPOT4-HRVIR1-XS_20090324-103844-078_L1C_047-256-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090324-103844-078_L1C_047-256-8_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090324-103844-078_L1C_047-256-8_D_V1-0.zip
run script
2024-01-09T11:48:12.071    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:48:12.072    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090324-103844-078_L1C_047-256-8_D_V1-0.zip
2024-01-09T11:48:12.072    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:48:12.072    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:48:12.072    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:48:12.072    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:48:12.072    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:48:12.072    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:48:12.072    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:48:12.072    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090324-103844-078_L1C_047-256-8_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/03/24/SPOT4-HRVIR1-XS_20090324-103845-151_L1C_047-257-0_D_V1-0/SPOT4-HRVIR1-XS_20090324-103845-151_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090324-103845-151_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090324-103845-151_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T11:48:16.882    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:48:16.884    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090324-103845-151_L1C_047-257-0_D_V1-0.zip
2024-01-09T11:48:16.884    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:48:16.884    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:48:16.884    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:48:16.884    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:48:16.884    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:48:16.884    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:48:16.884    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:48:16.884    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090324-103845-151_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/03/24/SPOT4-HRVIR1-XS_20090324-103852-371_L1C_047-257-8_D_V1-0/SPOT4-HRVIR1-XS_20090324-103852-371_L1C_047-257-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090324-103852-371_L1C_047-257-8_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090324-103852-371_L1C_047-257-8_D_V1-0.zip
run script
2024-01-09T11:48:21.663    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:48:21.664    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090324-103852-371_L1C_047-257-8_D_V1-0.zip
2024-01-09T11:48:21.664    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:48:21.664    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:48:21.664    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:48:21.665    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:48:21.665    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:48:21.665    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:48:21.665    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:48:21.665    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090324-103852-371_L1C_047-257-8_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/03/24/SPOT4-HRVIR2-XS_20090324-103844-682_L1C_048-257-1_D_V1-0/SPOT4-HRVIR2-XS_20090324-103844-682_L1C_048-257-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090324-103844-682_L1C_048-257-1_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090324-103844-682_L1C_048-257-1_D_V1-0.zip
run script
2024-01-09T11:48:26.527    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:48:26.528    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090324-103844-682_L1C_048-257-1_D_V1-0.zip
2024-01-09T11:48:26.528    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:48:26.528    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:48:26.529    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:48:26.529    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:48:26.529    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:48:26.529    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:48:26.529    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:48:26.529    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090324-103844-682_L1C_048-257-1_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/03/24/SPOT4-HRVIR2-XS_20090324-103852-097_L1C_048-258-0_D_V1-0/SPOT4-HRVIR2-XS_20090324-103852-097_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090324-103852-097_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090324-103852-097_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T11:49:24.443    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:49:24.444    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090324-103852-097_L1C_048-258-0_D_V1-0.zip
2024-01-09T11:49:24.444    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:49:24.444    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:49:24.444    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:49:24.444    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:49:24.444    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:49:24.444    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:49:24.444    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:49:24.445    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090324-103852-097_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/03/24/SPOT4-HRVIR2-XS_20090324-103818-879_L1C_049-254-0_D_V1-0/SPOT4-HRVIR2-XS_20090324-103818-879_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090324-103818-879_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090324-103818-879_L1C_049-254-0_D_V1-0.zip
run script
2024-01-09T11:50:04.358    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:50:04.359    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090324-103818-879_L1C_049-254-0_D_V1-0.zip
2024-01-09T11:50:04.359    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:50:04.360    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:50:04.360    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:50:04.360    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:50:04.360    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:50:04.360    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:50:04.360    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:50:04.360    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090324-103818-879_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/03/24/SPOT4-HRVIR2-XS_20090324-103821-586_L1C_049-254-3_D_V1-0/SPOT4-HRVIR2-XS_20090324-103821-586_L1C_049-254-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090324-103821-586_L1C_049-254-3_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090324-103821-586_L1C_049-254-3_D_V1-0.zip
run script
2024-01-09T11:50:09.159    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:50:09.160    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090324-103821-586_L1C_049-254-3_D_V1-0.zip
2024-01-09T11:50:09.160    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:50:09.160    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:50:09.160    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:50:09.161    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:50:09.161    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:50:09.161    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:50:09.161    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:50:09.161    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090324-103821-586_L1C_049-254-3_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/03/30/SPOT4-HRVIR2-XS_20090330-102314-713_L1C_047-256-9_D_V1-0/SPOT4-HRVIR2-XS_20090330-102314-713_L1C_047-256-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090330-102314-713_L1C_047-256-9_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090330-102314-713_L1C_047-256-9_D_V1-0.zip
run script
2024-01-09T11:50:14.294    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:50:14.296    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090330-102314-713_L1C_047-256-9_D_V1-0.zip
2024-01-09T11:50:14.296    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:50:14.296    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:50:14.296    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:50:14.296    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:50:14.296    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:50:14.296    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:50:14.296    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:50:14.296    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:50:17.115    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (184 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090330-102314-713_L1C_047-256-9_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2009/03/30/SPOT4-HRVIR2-XS_20090330-102314-815_L1C_048-257-0_D_V1-0/SPOT4-HRVIR2-XS_20090330-102314-815_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090330-102314-815_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090330-102314-815_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T11:50:21.763    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:50:21.764    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090330-102314-815_L1C_048-257-0_D_V1-0.zip
2024-01-09T11:50:21.764    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:50:21.765    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:50:21.765    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:50:21.765    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:50:21.765    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:50:21.765    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:50:21.765    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:50:21.765    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:50:24.458    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (188 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090330-102314-815_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2009/07/10/SPOT4-HRVIR2-XS_20090710-110041-707_L1C_047-256-2_D_V1-0/SPOT4-HRVIR2-XS_20090710-110041-707_L1C_047-256-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090710-110041-707_L1C_047-256-2_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090710-110041-707_L1C_047-256-2_D_V1-0.zip
run script
2024-01-09T11:50:29.400    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:50:29.401    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090710-110041-707_L1C_047-256-2_D_V1-0.zip
2024-01-09T11:50:29.401    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:50:29.401    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:50:29.401    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:50:29.401    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:50:29.402    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:50:29.402    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:50:29.402    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:50:29.402    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090710-110041-707_L1C_047-256-2_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/07/10/SPOT4-HRVIR2-XS_20090710-110044-414_L1C_047-256-5_D_V1-0/SPOT4-HRVIR2-XS_20090710-110044-414_L1C_047-256-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090710-110044-414_L1C_047-256-5_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090710-110044-414_L1C_047-256-5_D_V1-0.zip
run script
2024-01-09T11:50:33.696    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:50:33.697    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090710-110044-414_L1C_047-256-5_D_V1-0.zip
2024-01-09T11:50:33.697    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:50:33.697    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:50:33.697    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:50:33.697    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:50:33.697    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:50:33.698    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:50:33.698    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:50:33.698    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090710-110044-414_L1C_047-256-5_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/09/12/SPOT4-HRVIR2-XS_20090912-102911-766_L1C_047-256-0_D_V1-0/SPOT4-HRVIR2-XS_20090912-102911-766_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090912-102911-766_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090912-102911-766_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T11:50:38.019    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:50:38.021    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090912-102911-766_L1C_047-256-0_D_V1-0.zip
2024-01-09T11:50:38.021    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:50:38.021    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:50:38.021    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:50:38.021    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:50:38.021    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:50:38.021    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:50:38.021    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:50:38.021    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090912-102911-766_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/09/12/SPOT4-HRVIR2-XS_20090912-102917-180_L1C_047-256-6_D_V1-0/SPOT4-HRVIR2-XS_20090912-102917-180_L1C_047-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090912-102917-180_L1C_047-256-6_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090912-102917-180_L1C_047-256-6_D_V1-0.zip
run script
2024-01-09T11:50:43.005    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:50:43.006    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090912-102917-180_L1C_047-256-6_D_V1-0.zip
2024-01-09T11:50:43.006    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:50:43.006    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:50:43.006    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:50:43.006    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:50:43.006    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:50:43.006    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:50:43.006    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:50:43.006    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090912-102917-180_L1C_047-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/09/12/SPOT4-HRVIR1-XS_20090912-102916-868_L1C_050-257-0_D_V1-0/SPOT4-HRVIR1-XS_20090912-102916-868_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090912-102916-868_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090912-102916-868_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T11:50:48.141    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:50:48.142    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090912-102916-868_L1C_050-257-0_D_V1-0.zip
2024-01-09T11:50:48.142    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:50:48.142    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:50:48.142    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:50:48.142    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:50:48.143    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:50:48.143    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:50:48.143    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:50:48.143    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090912-102916-868_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/09/12/SPOT4-HRVIR1-XS_20090912-102954-713_L1C_051-261-7_D_V1-0/SPOT4-HRVIR1-XS_20090912-102954-713_L1C_051-261-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090912-102954-713_L1C_051-261-7_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090912-102954-713_L1C_051-261-7_D_V1-0.zip
run script
2024-01-09T11:53:38.127    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:53:38.128    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090912-102954-713_L1C_051-261-7_D_V1-0.zip
2024-01-09T11:53:38.129    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:53:38.129    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:53:38.129    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:53:38.129    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:53:38.129    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:53:38.129    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:53:38.129    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:53:38.129    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:55:30.398    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (206 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090912-102954-713_L1C_051-261-7_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/09/12/SPOT4-HRVIR1-XS_20090912-102956-732_L1C_051-262-0_D_V1-0/SPOT4-HRVIR1-XS_20090912-102956-732_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090912-102956-732_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090912-102956-732_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T11:55:36.207    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:55:36.208    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090912-102956-732_L1C_051-262-0_D_V1-0.zip
2024-01-09T11:55:36.208    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:55:36.208    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:55:36.208    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:55:36.209    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:55:36.209    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:55:36.209    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:55:36.209    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:55:36.209    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090912-102956-732_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/09/22/SPOT4-HRVIR1-XS_20090922-103648-787_L1C_047-256-0_D_V1-0/SPOT4-HRVIR1-XS_20090922-103648-787_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090922-103648-787_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090922-103648-787_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T11:57:24.634    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:57:24.635    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090922-103648-787_L1C_047-256-0_D_V1-0.zip
2024-01-09T11:57:24.635    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:57:24.636    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:57:24.636    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:57:24.636    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:57:24.636    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:57:24.636    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:57:24.636    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:57:24.636    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090922-103648-787_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/09/27/SPOT4-HRVIR1-XS_20090927-104037-002_L1C_047-256-0_D_V1-0/SPOT4-HRVIR1-XS_20090927-104037-002_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090927-104037-002_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090927-104037-002_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T11:57:30.151    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:57:30.152    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090927-104037-002_L1C_047-256-0_D_V1-0.zip
2024-01-09T11:57:30.152    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:57:30.152    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:57:30.152    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:57:30.152    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:57:30.153    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:57:30.153    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:57:30.153    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:57:30.153    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090927-104037-002_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/09/27/SPOT4-HRVIR2-XS_20090927-104037-309_L1C_051-256-7_D_V1-0/SPOT4-HRVIR2-XS_20090927-104037-309_L1C_051-256-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090927-104037-309_L1C_051-256-7_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090927-104037-309_L1C_051-256-7_D_V1-0.zip
run script
2024-01-09T11:57:35.094    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:57:35.095    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090927-104037-309_L1C_051-256-7_D_V1-0.zip
2024-01-09T11:57:35.095    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:57:35.096    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:57:35.096    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:57:35.096    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:57:35.096    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:57:35.096    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:57:35.096    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:57:35.096    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090927-104037-309_L1C_051-256-7_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/11/08/SPOT4-HRVIR1-XS_20091108-103217-064_L1C_047-256-8_D_V1-0/SPOT4-HRVIR1-XS_20091108-103217-064_L1C_047-256-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20091108-103217-064_L1C_047-256-8_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091108-103217-064_L1C_047-256-8_D_V1-0.zip
run script
2024-01-09T12:01:06.336    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:01:06.337    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091108-103217-064_L1C_047-256-8_D_V1-0.zip
2024-01-09T12:01:06.338    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:01:06.338    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:01:06.338    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:01:06.338    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:01:06.338    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:01:06.338    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:01:06.338    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:01:06.338    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091108-103217-064_L1C_047-256-8_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/11/08/SPOT4-HRVIR2-XS_20091108-103210-243_L1C_047-256-0_D_V1-0/SPOT4-HRVIR2-XS_20091108-103210-243_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20091108-103210-243_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091108-103210-243_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T12:01:10.938    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:01:10.939    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091108-103210-243_L1C_047-256-0_D_V1-0.zip
2024-01-09T12:01:10.939    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:01:10.939    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:01:10.939    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:01:10.939    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:01:10.939    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:01:10.939    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:01:10.939    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:01:10.939    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091108-103210-243_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/11/08/SPOT4-HRVIR1-XS_20091108-103218-117_L1C_047-257-0_D_V1-0/SPOT4-HRVIR1-XS_20091108-103218-117_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20091108-103218-117_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091108-103218-117_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T12:01:16.553    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:01:16.555    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091108-103218-117_L1C_047-257-0_D_V1-0.zip
2024-01-09T12:01:16.555    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:01:16.555    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:01:16.555    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:01:16.555    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:01:16.555    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:01:16.555    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:01:16.555    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:01:16.555    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091108-103218-117_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/11/08/SPOT4-HRVIR1-XS_20091108-103219-019_L1C_047-257-1_D_V1-0/SPOT4-HRVIR1-XS_20091108-103219-019_L1C_047-257-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20091108-103219-019_L1C_047-257-1_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091108-103219-019_L1C_047-257-1_D_V1-0.zip
run script
2024-01-09T12:01:26.968    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:01:26.969    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091108-103219-019_L1C_047-257-1_D_V1-0.zip
2024-01-09T12:01:26.969    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:01:26.969    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:01:26.969    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:01:26.969    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:01:26.969    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:01:26.969    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:01:26.969    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:01:26.969    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091108-103219-019_L1C_047-257-1_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/11/08/SPOT4-HRVIR1-XS_20091108-103300-048_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20091108-103300-048_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20091108-103300-048_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091108-103300-048_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:01:31.982    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:01:31.983    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091108-103300-048_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:01:31.983    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:01:31.983    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:01:31.983    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:01:31.983    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:01:31.983    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:01:31.983    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:01:31.983    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:01:31.983    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091108-103300-048_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/11/08/SPOT4-HRVIR1-XS_20091108-103235-780_L1C_050-259-5_D_V1-0/SPOT4-HRVIR1-XS_20091108-103235-780_L1C_050-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20091108-103235-780_L1C_050-259-5_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091108-103235-780_L1C_050-259-5_D_V1-0.zip
run script
2024-01-09T12:01:36.232    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:01:36.233    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091108-103235-780_L1C_050-259-5_D_V1-0.zip
2024-01-09T12:01:36.234    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:01:36.234    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:01:36.234    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:01:36.234    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:01:36.234    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:01:36.234    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:01:36.234    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:01:36.234    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091108-103235-780_L1C_050-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/11/08/SPOT4-HRVIR1-XS_20091108-103239-390_L1C_050-259-9_D_V1-0/SPOT4-HRVIR1-XS_20091108-103239-390_L1C_050-259-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20091108-103239-390_L1C_050-259-9_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091108-103239-390_L1C_050-259-9_D_V1-0.zip
run script
2024-01-09T12:03:35.462    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:03:35.463    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091108-103239-390_L1C_050-259-9_D_V1-0.zip
2024-01-09T12:03:35.464    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:03:35.464    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:03:35.464    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:03:35.464    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:03:35.464    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:03:35.464    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:03:35.464    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:03:35.464    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091108-103239-390_L1C_050-259-9_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/03/09/SPOT4-HRVIR2-XS_20090309-102715-648_L1C_047-257-1_D_V1-0/SPOT4-HRVIR2-XS_20090309-102715-648_L1C_047-257-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090309-102715-648_L1C_047-257-1_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090309-102715-648_L1C_047-257-1_D_V1-0.zip
run script
2024-01-09T12:05:13.158    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:05:13.159    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090309-102715-648_L1C_047-257-1_D_V1-0.zip
2024-01-09T12:05:13.159    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:05:13.159    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:05:13.159    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:05:13.160    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:05:13.160    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:05:13.160    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:05:13.160    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:05:13.160    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090309-102715-648_L1C_047-257-1_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/03/09/SPOT4-HRVIR2-XS_20090309-102756-325_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20090309-102756-325_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090309-102756-325_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090309-102756-325_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:05:17.799    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:05:17.800    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090309-102756-325_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:05:17.800    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:05:17.800    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:05:17.800    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:05:17.800    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:05:17.800    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:05:17.800    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:05:17.801    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:05:17.801    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090309-102756-325_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/03/14/SPOT4-HRVIR2-XS_20090314-103105-098_L1C_047-257-0_D_V1-0/SPOT4-HRVIR2-XS_20090314-103105-098_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090314-103105-098_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090314-103105-098_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T12:05:22.225    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:05:22.226    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090314-103105-098_L1C_047-257-0_D_V1-0.zip
2024-01-09T12:05:22.226    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:05:22.226    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:05:22.226    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:05:22.226    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:05:22.226    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:05:22.227    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:05:22.227    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:05:22.227    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090314-103105-098_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/03/14/SPOT4-HRVIR2-XS_20090314-103113-361_L1C_047-258-0_D_V1-0/SPOT4-HRVIR2-XS_20090314-103113-361_L1C_047-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090314-103113-361_L1C_047-258-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090314-103113-361_L1C_047-258-0_D_V1-0.zip
run script
2024-01-09T12:05:26.964    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:05:26.966    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090314-103113-361_L1C_047-258-0_D_V1-0.zip
2024-01-09T12:05:26.966    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:05:26.966    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:05:26.966    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:05:26.966    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:05:26.966    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:05:26.966    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:05:26.966    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:05:26.966    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090314-103113-361_L1C_047-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/03/14/SPOT4-HRVIR1-XS_20090314-103047-373_L1C_048-255-0_D_V1-0/SPOT4-HRVIR1-XS_20090314-103047-373_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090314-103047-373_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090314-103047-373_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T12:05:31.346    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:05:31.347    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090314-103047-373_L1C_048-255-0_D_V1-0.zip
2024-01-09T12:05:31.348    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:05:31.348    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:05:31.348    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:05:31.348    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:05:31.348    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:05:31.348    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:05:31.348    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:05:31.348    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090314-103047-373_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/03/14/SPOT4-HRVIR1-XS_20090314-103055-630_L1C_048-256-0_D_V1-0/SPOT4-HRVIR1-XS_20090314-103055-630_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090314-103055-630_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090314-103055-630_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T12:06:05.809    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:06:05.811    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090314-103055-630_L1C_048-256-0_D_V1-0.zip
2024-01-09T12:06:05.811    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:06:05.811    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:06:05.811    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:06:05.811    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:06:05.811    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:06:05.811    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:06:05.811    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:06:05.811    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090314-103055-630_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/03/14/SPOT4-HRVIR2-XS_20090314-103146-722_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20090314-103146-722_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090314-103146-722_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090314-103146-722_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:07:16.814    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:07:16.815    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090314-103146-722_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:07:16.816    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:07:16.816    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:07:16.816    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:07:16.816    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:07:16.816    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:07:16.816    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:07:16.816    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:07:16.816    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090314-103146-722_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/08/05/SPOT4-HRVIR1-XS_20090805-110035-711_L1C_047-257-2_D_V1-0/SPOT4-HRVIR1-XS_20090805-110035-711_L1C_047-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090805-110035-711_L1C_047-257-2_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090805-110035-711_L1C_047-257-2_D_V1-0.zip
run script
2024-01-09T12:07:21.939    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:07:21.941    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090805-110035-711_L1C_047-257-2_D_V1-0.zip
2024-01-09T12:07:21.941    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:07:21.941    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:07:21.941    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:07:21.941    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:07:21.941    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:07:21.941    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:07:21.941    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:07:21.941    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090805-110035-711_L1C_047-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/07/31/SPOT4-HRVIR2-XS_20090731-105709-106_L1C_047-259-8_D_V1-0/SPOT4-HRVIR2-XS_20090731-105709-106_L1C_047-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090731-105709-106_L1C_047-259-8_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090731-105709-106_L1C_047-259-8_D_V1-0.zip
run script
2024-01-09T12:07:26.831    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:07:26.833    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090731-105709-106_L1C_047-259-8_D_V1-0.zip
2024-01-09T12:07:26.834    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:07:26.834    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:07:26.834    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:07:26.834    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:07:26.834    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:07:26.834    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:07:26.834    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:07:26.834    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090731-105709-106_L1C_047-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/07/31/SPOT4-HRVIR2-XS_20090731-105710-339_L1C_047-260-0_D_V1-0/SPOT4-HRVIR2-XS_20090731-105710-339_L1C_047-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090731-105710-339_L1C_047-260-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090731-105710-339_L1C_047-260-0_D_V1-0.zip
run script
2024-01-09T12:07:31.726    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:07:31.727    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090731-105710-339_L1C_047-260-0_D_V1-0.zip
2024-01-09T12:07:31.727    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:07:31.727    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:07:31.728    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:07:31.728    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:07:31.728    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:07:31.728    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:07:31.728    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:07:31.728    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090731-105710-339_L1C_047-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/02/21/SPOT4-HRVIR1-XS_20090221-103437-257_L1C_048-254-0_D_V1-0/SPOT4-HRVIR1-XS_20090221-103437-257_L1C_048-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090221-103437-257_L1C_048-254-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090221-103437-257_L1C_048-254-0_D_V1-0.zip
run script
2024-01-09T12:07:35.949    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:07:35.950    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090221-103437-257_L1C_048-254-0_D_V1-0.zip
2024-01-09T12:07:35.950    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:07:35.950    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:07:35.950    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:07:35.950    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:07:35.950    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:07:35.950    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:07:35.950    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:07:35.950    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090221-103437-257_L1C_048-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/02/21/SPOT4-HRVIR1-XS_20090221-103445-526_L1C_048-255-0_D_V1-0/SPOT4-HRVIR1-XS_20090221-103445-526_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090221-103445-526_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090221-103445-526_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T12:07:40.720    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:07:40.721    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090221-103445-526_L1C_048-255-0_D_V1-0.zip
2024-01-09T12:07:40.721    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:07:40.721    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:07:40.722    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:07:40.722    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:07:40.722    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:07:40.722    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:07:40.722    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:07:40.722    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:08:07.578    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (202 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090221-103445-526_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/02/21/SPOT4-HRVIR1-XS_20090221-103453-804_L1C_048-256-0_D_V1-0/SPOT4-HRVIR1-XS_20090221-103453-804_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090221-103453-804_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090221-103453-804_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T12:08:11.481    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:08:11.483    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090221-103453-804_L1C_048-256-0_D_V1-0.zip
2024-01-09T12:08:11.483    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:08:11.483    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:08:11.483    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:08:11.483    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:08:11.483    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:08:11.483    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:08:11.483    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:08:11.483    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090221-103453-804_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/02/21/SPOT4-HRVIR1-XS_20090221-103502-091_L1C_048-257-0_D_V1-0/SPOT4-HRVIR1-XS_20090221-103502-091_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090221-103502-091_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090221-103502-091_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T12:09:17.049    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:09:17.051    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090221-103502-091_L1C_048-257-0_D_V1-0.zip
2024-01-09T12:09:17.051    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:09:17.051    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:09:17.051    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:09:17.051    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:09:17.051    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:09:17.051    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:09:17.051    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:09:17.051    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090221-103502-091_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [1 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 0 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/02/21/SPOT4-HRVIR1-XS_20090221-103510-384_L1C_048-258-0_D_V1-0/SPOT4-HRVIR1-XS_20090221-103510-384_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090221-103510-384_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090221-103510-384_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T12:10:11.489    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:10:11.490    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090221-103510-384_L1C_048-258-0_D_V1-0.zip
2024-01-09T12:10:11.490    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:10:11.491    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:10:11.491    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:10:11.491    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:10:11.491    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:10:11.491    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:10:11.491    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:10:11.491    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090221-103510-384_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/05/30/SPOT4-HRVIR1-XS_20090530-104927-334_L1C_048-254-9_D_V1-0/SPOT4-HRVIR1-XS_20090530-104927-334_L1C_048-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090530-104927-334_L1C_048-254-9_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090530-104927-334_L1C_048-254-9_D_V1-0.zip
run script
2024-01-09T12:10:43.913    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:10:43.914    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090530-104927-334_L1C_048-254-9_D_V1-0.zip
2024-01-09T12:10:43.914    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:10:43.914    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:10:43.914    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:10:43.914    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:10:43.914    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:10:43.914    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:10:43.915    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:10:43.915    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090530-104927-334_L1C_048-254-9_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/05/30/SPOT4-HRVIR1-XS_20090530-104927-584_L1C_048-255-0_D_V1-0/SPOT4-HRVIR1-XS_20090530-104927-584_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090530-104927-584_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090530-104927-584_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T12:11:06.498    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:11:06.499    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090530-104927-584_L1C_048-255-0_D_V1-0.zip
2024-01-09T12:11:06.499    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:11:06.499    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:11:06.499    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:11:06.499    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:11:06.499    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:11:06.500    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:11:06.500    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:11:06.500    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090530-104927-584_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/05/30/SPOT4-HRVIR1-XS_20090530-104929-388_L1C_048-255-2_D_V1-0/SPOT4-HRVIR1-XS_20090530-104929-388_L1C_048-255-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090530-104929-388_L1C_048-255-2_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090530-104929-388_L1C_048-255-2_D_V1-0.zip
run script
2024-01-09T12:11:29.340    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:11:29.342    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090530-104929-388_L1C_048-255-2_D_V1-0.zip
2024-01-09T12:11:29.342    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:11:29.342    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:11:29.342    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:11:29.342    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:11:29.342    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:11:29.342    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:11:29.342    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:11:29.342    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090530-104929-388_L1C_048-255-2_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/07/01/SPOT4-HRVIR1-XS_20090701-103334-742_L1C_048-254-5_D_V1-0/SPOT4-HRVIR1-XS_20090701-103334-742_L1C_048-254-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090701-103334-742_L1C_048-254-5_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090701-103334-742_L1C_048-254-5_D_V1-0.zip
run script
2024-01-09T12:12:00.699    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:12:00.700    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090701-103334-742_L1C_048-254-5_D_V1-0.zip
2024-01-09T12:12:00.700    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:12:00.700    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:12:00.700    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:12:00.701    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:12:00.701    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:12:00.701    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:12:00.701    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:12:00.701    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090701-103334-742_L1C_048-254-5_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/07/01/SPOT4-HRVIR1-XS_20090701-103338-490_L1C_048-255-0_D_V1-0/SPOT4-HRVIR1-XS_20090701-103338-490_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090701-103338-490_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090701-103338-490_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T12:12:04.120    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:12:04.121    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090701-103338-490_L1C_048-255-0_D_V1-0.zip
2024-01-09T12:12:04.121    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:12:04.121    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:12:04.121    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:12:04.121    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:12:04.121    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:12:04.121    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:12:04.121    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:12:04.121    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090701-103338-490_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/07/01/SPOT4-HRVIR1-XS_20090701-103346-759_L1C_048-256-0_D_V1-0/SPOT4-HRVIR1-XS_20090701-103346-759_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090701-103346-759_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090701-103346-759_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T12:12:21.045    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:12:21.046    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090701-103346-759_L1C_048-256-0_D_V1-0.zip
2024-01-09T12:12:21.046    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:12:21.046    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:12:21.047    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:12:21.047    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:12:21.047    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:12:21.047    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:12:21.047    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:12:21.047    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090701-103346-759_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/07/01/SPOT4-HRVIR1-XS_20090701-103347-662_L1C_048-256-1_D_V1-0/SPOT4-HRVIR1-XS_20090701-103347-662_L1C_048-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090701-103347-662_L1C_048-256-1_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090701-103347-662_L1C_048-256-1_D_V1-0.zip
run script
2024-01-09T12:12:48.907    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:12:48.908    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090701-103347-662_L1C_048-256-1_D_V1-0.zip
2024-01-09T12:12:48.908    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:12:48.908    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:12:48.908    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:12:48.908    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:12:48.908    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:12:48.908    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:12:48.908    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:12:48.909    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090701-103347-662_L1C_048-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/02/11/SPOT4-HRVIR1-XS_20090211-102712-268_L1C_048-255-9_D_V1-0/SPOT4-HRVIR1-XS_20090211-102712-268_L1C_048-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090211-102712-268_L1C_048-255-9_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090211-102712-268_L1C_048-255-9_D_V1-0.zip
run script
2024-01-09T12:13:15.793    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:13:15.794    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090211-102712-268_L1C_048-255-9_D_V1-0.zip
2024-01-09T12:13:15.795    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:13:15.795    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:13:15.795    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:13:15.795    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:13:15.795    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:13:15.795    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:13:15.795    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:13:15.795    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090211-102712-268_L1C_048-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/02/11/SPOT4-HRVIR1-XS_20090211-102712-385_L1C_049-256-0_D_V1-0/SPOT4-HRVIR1-XS_20090211-102712-385_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090211-102712-385_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090211-102712-385_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T12:14:26.371    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:14:26.373    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090211-102712-385_L1C_049-256-0_D_V1-0.zip
2024-01-09T12:14:26.373    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:14:26.373    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:14:26.373    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:14:26.373    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:14:26.373    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:14:26.373    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:14:26.373    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:14:26.373    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090211-102712-385_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/02/26/SPOT4-HRVIR1-XS_20090226-103844-059_L1C_048-255-9_D_V1-0/SPOT4-HRVIR1-XS_20090226-103844-059_L1C_048-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090226-103844-059_L1C_048-255-9_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090226-103844-059_L1C_048-255-9_D_V1-0.zip
run script
2024-01-09T12:15:37.253    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:15:37.254    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090226-103844-059_L1C_048-255-9_D_V1-0.zip
2024-01-09T12:15:37.254    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:15:37.254    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:15:37.254    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:15:37.254    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:15:37.254    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:15:37.254    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:15:37.254    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:15:37.255    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090226-103844-059_L1C_048-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/02/26/SPOT4-HRVIR1-XS_20090226-103852-545_L1C_048-257-0_D_V1-0/SPOT4-HRVIR1-XS_20090226-103852-545_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090226-103852-545_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090226-103852-545_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T12:16:44.830    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:16:44.831    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090226-103852-545_L1C_048-257-0_D_V1-0.zip
2024-01-09T12:16:44.831    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:16:44.831    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:16:44.831    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:16:44.831    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:16:44.831    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:16:44.831    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:16:44.832    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:16:44.832    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090226-103852-545_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 1 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [1 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/02/26/SPOT4-HRVIR1-XS_20090226-103900-859_L1C_048-258-0_D_V1-0/SPOT4-HRVIR1-XS_20090226-103900-859_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090226-103900-859_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090226-103900-859_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T12:17:35.214    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:17:35.215    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090226-103900-859_L1C_048-258-0_D_V1-0.zip
2024-01-09T12:17:35.215    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:17:35.216    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:17:35.216    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:17:35.216    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:17:35.216    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:17:35.216    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:17:35.216    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:17:35.216    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090226-103900-859_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/03/19/SPOT4-HRVIR1-XS_20090319-103442-872_L1C_048-255-6_D_V1-0/SPOT4-HRVIR1-XS_20090319-103442-872_L1C_048-255-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090319-103442-872_L1C_048-255-6_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090319-103442-872_L1C_048-255-6_D_V1-0.zip
run script
2024-01-09T12:18:03.224    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:18:03.225    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090319-103442-872_L1C_048-255-6_D_V1-0.zip
2024-01-09T12:18:03.226    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:18:03.226    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:18:03.226    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:18:03.226    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:18:03.226    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:18:03.226    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:18:03.226    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:18:03.226    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090319-103442-872_L1C_048-255-6_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 1]
 [0 0 0 ... 0 0 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/03/19/SPOT4-HRVIR1-XS_20090319-103445-735_L1C_048-256-0_D_V1-0/SPOT4-HRVIR1-XS_20090319-103445-735_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090319-103445-735_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090319-103445-735_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T12:18:58.093    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:18:58.094    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090319-103445-735_L1C_048-256-0_D_V1-0.zip
2024-01-09T12:18:58.094    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:18:58.094    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:18:58.094    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:18:58.094    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:18:58.094    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:18:58.094    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:18:58.094    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:18:58.094    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090319-103445-735_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/03/19/SPOT4-HRVIR1-XS_20090319-103454-019_L1C_048-257-0_D_V1-0/SPOT4-HRVIR1-XS_20090319-103454-019_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090319-103454-019_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090319-103454-019_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T12:20:05.346    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:20:05.347    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090319-103454-019_L1C_048-257-0_D_V1-0.zip
2024-01-09T12:20:05.347    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:20:05.348    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:20:05.348    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:20:05.348    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:20:05.348    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:20:05.348    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:20:05.348    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:20:05.348    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090319-103454-019_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [1 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/03/19/SPOT4-HRVIR1-XS_20090319-103503-215_L1C_048-258-1_D_V1-0/SPOT4-HRVIR1-XS_20090319-103503-215_L1C_048-258-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090319-103503-215_L1C_048-258-1_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090319-103503-215_L1C_048-258-1_D_V1-0.zip
run script
2024-01-09T12:20:57.976    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:20:57.977    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090319-103503-215_L1C_048-258-1_D_V1-0.zip
2024-01-09T12:20:57.978    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:20:57.978    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:20:57.978    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:20:57.978    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:20:57.978    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:20:57.978    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:20:57.978    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:20:57.978    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090319-103503-215_L1C_048-258-1_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/03/20/SPOT4-HRVIR2-XS_20090320-101517-742_L1C_048-255-1_D_V1-0/SPOT4-HRVIR2-XS_20090320-101517-742_L1C_048-255-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090320-101517-742_L1C_048-255-1_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090320-101517-742_L1C_048-255-1_D_V1-0.zip
run script
2024-01-09T12:21:24.660    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:21:24.661    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090320-101517-742_L1C_048-255-1_D_V1-0.zip
2024-01-09T12:21:24.661    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:21:24.661    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:21:24.661    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:21:24.661    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:21:24.661    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:21:24.661    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:21:24.661    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:21:24.661    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:21:54.319    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (602 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090320-101517-742_L1C_048-255-1_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/03/20/SPOT4-HRVIR2-XS_20090320-101525-037_L1C_048-256-0_D_V1-0/SPOT4-HRVIR2-XS_20090320-101525-037_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090320-101525-037_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090320-101525-037_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T12:21:57.956    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:21:57.958    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090320-101525-037_L1C_048-256-0_D_V1-0.zip
2024-01-09T12:21:57.958    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:21:57.958    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:21:57.958    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:21:57.958    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:21:57.958    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:21:57.958    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:21:57.958    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:21:57.958    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090320-101525-037_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/03/20/SPOT4-HRVIR2-XS_20090320-101533-243_L1C_048-257-0_D_V1-0/SPOT4-HRVIR2-XS_20090320-101533-243_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090320-101533-243_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090320-101533-243_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T12:23:10.411    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:23:10.411    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090320-101533-243_L1C_048-257-0_D_V1-0.zip
2024-01-09T12:23:10.411    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:23:10.411    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:23:10.411    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:23:10.411    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:23:10.411    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:23:10.411    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:23:10.411    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:23:10.411    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090320-101533-243_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/03/20/SPOT4-HRVIR2-XS_20090320-101541-460_L1C_049-258-0_D_V1-0/SPOT4-HRVIR2-XS_20090320-101541-460_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090320-101541-460_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090320-101541-460_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T12:24:15.271    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:24:15.272    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090320-101541-460_L1C_049-258-0_D_V1-0.zip
2024-01-09T12:24:15.273    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:24:15.273    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:24:15.273    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:24:15.273    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:24:15.273    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:24:15.273    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:24:15.273    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:24:15.273    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090320-101541-460_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/03/20/SPOT4-HRVIR2-XS_20090320-101545-070_L1C_049-258-4_D_V1-0/SPOT4-HRVIR2-XS_20090320-101545-070_L1C_049-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090320-101545-070_L1C_049-258-4_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090320-101545-070_L1C_049-258-4_D_V1-0.zip
run script
2024-01-09T12:24:57.748    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:24:57.749    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090320-101545-070_L1C_049-258-4_D_V1-0.zip
2024-01-09T12:24:57.749    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:24:57.749    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:24:57.749    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:24:57.749    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:24:57.749    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:24:57.749    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:24:57.749    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:24:57.749    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090320-101545-070_L1C_049-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/07/02/SPOT4-HRVIR2-XS_20090702-101417-476_L1C_048-255-1_D_V1-0/SPOT4-HRVIR2-XS_20090702-101417-476_L1C_048-255-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090702-101417-476_L1C_048-255-1_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090702-101417-476_L1C_048-255-1_D_V1-0.zip
run script
2024-01-09T12:25:42.119    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:25:42.120    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090702-101417-476_L1C_048-255-1_D_V1-0.zip
2024-01-09T12:25:42.120    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:25:42.120    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:25:42.120    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:25:42.121    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:25:42.121    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:25:42.121    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:25:42.121    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:25:42.121    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:26:12.116    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (148 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090702-101417-476_L1C_048-255-1_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/07/02/SPOT4-HRVIR2-XS_20090702-101419-281_L1C_048-255-3_D_V1-0/SPOT4-HRVIR2-XS_20090702-101419-281_L1C_048-255-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090702-101419-281_L1C_048-255-3_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090702-101419-281_L1C_048-255-3_D_V1-0.zip
run script
2024-01-09T12:26:15.670    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:26:15.671    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090702-101419-281_L1C_048-255-3_D_V1-0.zip
2024-01-09T12:26:15.671    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:26:15.671    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:26:15.671    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:26:15.671    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:26:15.671    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:26:15.671    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:26:15.671    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:26:15.671    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090702-101419-281_L1C_048-255-3_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/09/06/SPOT4-HRVIR2-XS_20090906-104432-219_L1C_048-255-0_D_V1-0/SPOT4-HRVIR2-XS_20090906-104432-219_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090906-104432-219_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090906-104432-219_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T12:26:57.729    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:26:57.730    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090906-104432-219_L1C_048-255-0_D_V1-0.zip
2024-01-09T12:26:57.730    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:26:57.731    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:26:57.731    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:26:57.731    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:26:57.731    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:26:57.731    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:26:57.731    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:26:57.731    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090906-104432-219_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/09/06/SPOT4-HRVIR2-XS_20090906-104440-575_L1C_048-256-0_D_V1-0/SPOT4-HRVIR2-XS_20090906-104440-575_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090906-104440-575_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090906-104440-575_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T12:27:32.475    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:27:32.476    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090906-104440-575_L1C_048-256-0_D_V1-0.zip
2024-01-09T12:27:32.476    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:27:32.476    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:27:32.476    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:27:32.476    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:27:32.477    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:27:32.477    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:27:32.477    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:27:32.477    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090906-104440-575_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/09/06/SPOT4-HRVIR2-XS_20090906-104431-088_L1C_049-254-8_D_V1-0/SPOT4-HRVIR2-XS_20090906-104431-088_L1C_049-254-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090906-104431-088_L1C_049-254-8_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090906-104431-088_L1C_049-254-8_D_V1-0.zip
run script
2024-01-09T12:28:45.374    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:28:45.375    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090906-104431-088_L1C_049-254-8_D_V1-0.zip
2024-01-09T12:28:45.376    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:28:45.376    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:28:45.376    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:28:45.376    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:28:45.376    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:28:45.376    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:28:45.376    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:28:45.376    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090906-104431-088_L1C_049-254-8_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/09/06/SPOT4-HRVIR1-XS_20090906-104524-304_L1C_049-261-3_D_V1-0/SPOT4-HRVIR1-XS_20090906-104524-304_L1C_049-261-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090906-104524-304_L1C_049-261-3_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090906-104524-304_L1C_049-261-3_D_V1-0.zip
run script
2024-01-09T12:29:10.196    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:29:10.197    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090906-104524-304_L1C_049-261-3_D_V1-0.zip
2024-01-09T12:29:10.197    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:29:10.197    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:29:10.198    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:29:10.198    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:29:10.198    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:29:10.198    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:29:10.198    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:29:10.198    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090906-104524-304_L1C_049-261-3_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/09/06/SPOT4-HRVIR1-XS_20090906-104529-996_L1C_049-262-0_D_V1-0/SPOT4-HRVIR1-XS_20090906-104529-996_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090906-104529-996_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090906-104529-996_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T12:29:13.562    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:29:13.564    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090906-104529-996_L1C_049-262-0_D_V1-0.zip
2024-01-09T12:29:13.564    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:29:13.564    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:29:13.564    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:29:13.564    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:29:13.564    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:29:13.564    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:29:13.564    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:29:13.564    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090906-104529-996_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/09/06/SPOT4-HRVIR2-XS_20090906-104454-841_L1C_050-257-9_D_V1-0/SPOT4-HRVIR2-XS_20090906-104454-841_L1C_050-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090906-104454-841_L1C_050-257-9_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090906-104454-841_L1C_050-257-9_D_V1-0.zip
run script
2024-01-09T12:29:17.271    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:29:17.272    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090906-104454-841_L1C_050-257-9_D_V1-0.zip
2024-01-09T12:29:17.272    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:29:17.272    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:29:17.272    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:29:17.272    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:29:17.272    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:29:17.272    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:29:17.272    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:29:17.272    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:31:34.894    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 64). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090906-104454-841_L1C_050-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/09/06/SPOT4-HRVIR2-XS_20090906-104455-112_L1C_050-258-0_D_V1-0/SPOT4-HRVIR2-XS_20090906-104455-112_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090906-104455-112_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090906-104455-112_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T12:31:39.343    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:31:39.345    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090906-104455-112_L1C_050-258-0_D_V1-0.zip
2024-01-09T12:31:39.345    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:31:39.345    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:31:39.345    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:31:39.345    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:31:39.345    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:31:39.345    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:31:39.345    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:31:39.345    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:33:35.985    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 230). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090906-104455-112_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/09/06/SPOT4-HRVIR2-XS_20090906-104503-507_L1C_050-259-0_D_V1-0/SPOT4-HRVIR2-XS_20090906-104503-507_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090906-104503-507_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090906-104503-507_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T12:33:39.718    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:33:39.719    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090906-104503-507_L1C_050-259-0_D_V1-0.zip
2024-01-09T12:33:39.720    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:33:39.720    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:33:39.720    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:33:39.720    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:33:39.720    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:33:39.720    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:33:39.720    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:33:39.720    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090906-104503-507_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/09/06/SPOT4-HRVIR1-XS_20090906-104420-182_L1C_051-254-0_D_V1-0/SPOT4-HRVIR1-XS_20090906-104420-182_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090906-104420-182_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090906-104420-182_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T12:35:23.240    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:35:23.241    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090906-104420-182_L1C_051-254-0_D_V1-0.zip
2024-01-09T12:35:23.241    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:35:23.241    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:35:23.241    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:35:23.241    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:35:23.241    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:35:23.241    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:35:23.241    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:35:23.242    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090906-104420-182_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/01/16/SPOT4-HRVIR2-XS_20090116-102733-126_L1C_048-257-9_D_V1-0/SPOT4-HRVIR2-XS_20090116-102733-126_L1C_048-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090116-102733-126_L1C_048-257-9_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090116-102733-126_L1C_048-257-9_D_V1-0.zip
run script
2024-01-09T12:35:26.674    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:35:26.675    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090116-102733-126_L1C_048-257-9_D_V1-0.zip
2024-01-09T12:35:26.675    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:35:26.675    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:35:26.676    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:35:26.676    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:35:26.676    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:35:26.676    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:35:26.676    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:35:26.676    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090116-102733-126_L1C_048-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/01/16/SPOT4-HRVIR2-XS_20090116-102733-262_L1C_049-258-0_D_V1-0/SPOT4-HRVIR2-XS_20090116-102733-262_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090116-102733-262_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090116-102733-262_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T12:36:00.373    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:36:00.374    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090116-102733-262_L1C_049-258-0_D_V1-0.zip
2024-01-09T12:36:00.375    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:36:00.375    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:36:00.375    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:36:00.375    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:36:00.375    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:36:00.375    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:36:00.375    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:36:00.375    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090116-102733-262_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/01/16/SPOT4-HRVIR2-XS_20090116-102715-113_L1C_050-256-0_D_V1-0/SPOT4-HRVIR2-XS_20090116-102715-113_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090116-102715-113_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090116-102715-113_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T12:36:33.542    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:36:33.544    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090116-102715-113_L1C_050-256-0_D_V1-0.zip
2024-01-09T12:36:33.544    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:36:33.544    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:36:33.544    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:36:33.544    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:36:33.544    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:36:33.544    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:36:33.545    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:36:33.545    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090116-102715-113_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/02/25/SPOT4-HRVIR1-XS_20090225-105809-152_L1C_048-257-0_D_V1-0/SPOT4-HRVIR1-XS_20090225-105809-152_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090225-105809-152_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090225-105809-152_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T12:39:10.767    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:39:10.769    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090225-105809-152_L1C_048-257-0_D_V1-0.zip
2024-01-09T12:39:10.769    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:39:10.769    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:39:10.769    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:39:10.769    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:39:10.769    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:39:10.769    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:39:10.769    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:39:10.769    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090225-105809-152_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [0 1 1 ... 2 2 2]
 [0 0 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/02/25/SPOT4-HRVIR1-XS_20090225-105817-617_L1C_048-258-0_D_V1-0/SPOT4-HRVIR1-XS_20090225-105817-617_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090225-105817-617_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090225-105817-617_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T12:40:22.835    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:40:22.836    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090225-105817-617_L1C_048-258-0_D_V1-0.zip
2024-01-09T12:40:22.836    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:40:22.837    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:40:22.837    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:40:22.837    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:40:22.837    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:40:22.837    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:40:22.837    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:40:22.837    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:41:04.005    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 68). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090225-105817-617_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/02/25/SPOT4-HRVIR1-XS_20090225-105800-691_L1C_049-256-0_D_V1-0/SPOT4-HRVIR1-XS_20090225-105800-691_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090225-105800-691_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090225-105800-691_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T12:41:08.176    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:41:08.177    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090225-105800-691_L1C_049-256-0_D_V1-0.zip
2024-01-09T12:41:08.177    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:41:08.177    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:41:08.178    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:41:08.178    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:41:08.178    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:41:08.178    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:41:08.178    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:41:08.178    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090225-105800-691_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/23/SPOT4-HRVIR2-XS_20090823-101406-813_L1C_048-257-5_D_V1-0/SPOT4-HRVIR2-XS_20090823-101406-813_L1C_048-257-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090823-101406-813_L1C_048-257-5_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090823-101406-813_L1C_048-257-5_D_V1-0.zip
run script
2024-01-09T12:42:38.610    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:42:38.612    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090823-101406-813_L1C_048-257-5_D_V1-0.zip
2024-01-09T12:42:38.612    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:42:38.612    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:42:38.612    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:42:38.612    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:42:38.612    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:42:38.612    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:42:38.612    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:42:38.612    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090823-101406-813_L1C_048-257-5_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/23/SPOT4-HRVIR2-XS_20090823-101410-519_L1C_049-258-0_D_V1-0/SPOT4-HRVIR2-XS_20090823-101410-519_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090823-101410-519_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090823-101410-519_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T12:43:32.956    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:43:32.957    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090823-101410-519_L1C_049-258-0_D_V1-0.zip
2024-01-09T12:43:32.958    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:43:32.958    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:43:32.958    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:43:32.958    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:43:32.958    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:43:32.958    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:43:32.958    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:43:32.958    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090823-101410-519_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/23/SPOT4-HRVIR2-XS_20090823-101342-424_L1C_050-254-7_D_V1-0/SPOT4-HRVIR2-XS_20090823-101342-424_L1C_050-254-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090823-101342-424_L1C_050-254-7_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090823-101342-424_L1C_050-254-7_D_V1-0.zip
run script
2024-01-09T12:44:15.509    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:44:15.510    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090823-101342-424_L1C_050-254-7_D_V1-0.zip
2024-01-09T12:44:15.510    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:44:15.510    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:44:15.510    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:44:15.510    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:44:15.510    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:44:15.510    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:44:15.510    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:44:15.510    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090823-101342-424_L1C_050-254-7_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/23/SPOT4-HRVIR2-XS_20090823-101344-304_L1C_050-255-0_D_V1-0/SPOT4-HRVIR2-XS_20090823-101344-304_L1C_050-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090823-101344-304_L1C_050-255-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090823-101344-304_L1C_050-255-0_D_V1-0.zip
run script
2024-01-09T12:44:40.923    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:44:40.924    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090823-101344-304_L1C_050-255-0_D_V1-0.zip
2024-01-09T12:44:40.924    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:44:40.924    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:44:40.924    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:44:40.924    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:44:40.924    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:44:40.924    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:44:40.924    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:44:40.924    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090823-101344-304_L1C_050-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/23/SPOT4-HRVIR2-XS_20090823-101352-510_L1C_050-256-0_D_V1-0/SPOT4-HRVIR2-XS_20090823-101352-510_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090823-101352-510_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090823-101352-510_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T12:45:39.517    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:45:39.518    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090823-101352-510_L1C_050-256-0_D_V1-0.zip
2024-01-09T12:45:39.518    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:45:39.518    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:45:39.518    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:45:39.518    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:45:39.518    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:45:39.518    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:45:39.518    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:45:39.519    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090823-101352-510_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/23/SPOT4-HRVIR1-XS_20090823-101439-768_L1C_050-261-6_D_V1-0/SPOT4-HRVIR1-XS_20090823-101439-768_L1C_050-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090823-101439-768_L1C_050-261-6_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090823-101439-768_L1C_050-261-6_D_V1-0.zip
run script
2024-01-09T12:48:52.672    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:48:52.673    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090823-101439-768_L1C_050-261-6_D_V1-0.zip
2024-01-09T12:48:52.674    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:48:52.674    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:48:52.674    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:48:52.674    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:48:52.674    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:48:52.674    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:48:52.674    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:48:52.674    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:49:43.871    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 174). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090823-101439-768_L1C_050-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/08/23/SPOT4-HRVIR1-XS_20090823-101442-614_L1C_050-262-0_D_V1-0/SPOT4-HRVIR1-XS_20090823-101442-614_L1C_050-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090823-101442-614_L1C_050-262-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090823-101442-614_L1C_050-262-0_D_V1-0.zip
run script
2024-01-09T12:49:48.935    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:49:48.937    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090823-101442-614_L1C_050-262-0_D_V1-0.zip
2024-01-09T12:49:48.937    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:49:48.937    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:49:48.937    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:49:48.937    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:49:48.937    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:49:48.937    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:49:48.937    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:49:48.937    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090823-101442-614_L1C_050-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/23/SPOT4-HRVIR2-XS_20090823-101425-565_L1C_051-260-1_D_V1-0/SPOT4-HRVIR2-XS_20090823-101425-565_L1C_051-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090823-101425-565_L1C_051-260-1_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090823-101425-565_L1C_051-260-1_D_V1-0.zip
run script
2024-01-09T12:50:33.631    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:50:33.631    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090823-101425-565_L1C_051-260-1_D_V1-0.zip
2024-01-09T12:50:33.631    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:50:33.631    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:50:33.631    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:50:33.631    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:50:33.631    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:50:33.631    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:50:33.631    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:50:33.631    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090823-101425-565_L1C_051-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/23/SPOT4-HRVIR2-XS_20090823-101432-923_L1C_051-261-0_D_V1-0/SPOT4-HRVIR2-XS_20090823-101432-923_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090823-101432-923_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090823-101432-923_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T12:53:11.402    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:53:11.404    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090823-101432-923_L1C_051-261-0_D_V1-0.zip
2024-01-09T12:53:11.404    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:53:11.404    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:53:11.404    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:53:11.404    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:53:11.404    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:53:11.404    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:53:11.404    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:53:11.404    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090823-101432-923_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/23/SPOT4-HRVIR2-XS_20090823-101441-189_L1C_051-262-0_D_V1-0/SPOT4-HRVIR2-XS_20090823-101441-189_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090823-101441-189_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090823-101441-189_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T12:55:51.422    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:55:51.424    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090823-101441-189_L1C_051-262-0_D_V1-0.zip
2024-01-09T12:55:51.424    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:55:51.424    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:55:51.424    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:55:51.424    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:55:51.424    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:55:51.424    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:55:51.424    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:55:51.424    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:57:49.677    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (203 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090823-101441-189_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/08/23/SPOT4-HRVIR2-XS_20090823-101449-467_L1C_051-263-0_D_V1-0/SPOT4-HRVIR2-XS_20090823-101449-467_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090823-101449-467_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090823-101449-467_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T12:57:54.588    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:57:54.588    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090823-101449-467_L1C_051-263-0_D_V1-0.zip
2024-01-09T12:57:54.588    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:57:54.588    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:57:54.588    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:57:54.588    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:57:54.588    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:57:54.588    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:57:54.589    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:57:54.589    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090823-101449-467_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 0 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/10/23/SPOT4-HRVIR1-XS_20091023-104017-982_L1C_048-257-7_D_V1-0/SPOT4-HRVIR1-XS_20091023-104017-982_L1C_048-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20091023-104017-982_L1C_048-257-7_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091023-104017-982_L1C_048-257-7_D_V1-0.zip
run script
2024-01-09T12:58:46.959    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:58:46.961    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091023-104017-982_L1C_048-257-7_D_V1-0.zip
2024-01-09T12:58:46.961    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:58:46.961    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:58:46.961    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:58:46.961    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:58:46.961    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:58:46.961    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:58:46.961    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:58:46.961    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091023-104017-982_L1C_048-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/10/23/SPOT4-HRVIR1-XS_20091023-104019-992_L1C_048-258-0_D_V1-0/SPOT4-HRVIR1-XS_20091023-104019-992_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20091023-104019-992_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091023-104019-992_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T12:58:51.692    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:58:51.694    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091023-104019-992_L1C_048-258-0_D_V1-0.zip
2024-01-09T12:58:51.694    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:58:51.694    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:58:51.694    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:58:51.694    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:58:51.694    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:58:51.694    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:58:51.694    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:58:51.694    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091023-104019-992_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/10/23/SPOT4-HRVIR1-XS_20091023-104020-894_L1C_048-258-1_D_V1-0/SPOT4-HRVIR1-XS_20091023-104020-894_L1C_048-258-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20091023-104020-894_L1C_048-258-1_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091023-104020-894_L1C_048-258-1_D_V1-0.zip
run script
2024-01-09T12:58:56.226    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:58:56.228    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091023-104020-894_L1C_048-258-1_D_V1-0.zip
2024-01-09T12:58:56.228    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:58:56.228    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:58:56.228    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:58:56.228    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:58:56.228    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:58:56.228    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:58:56.228    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:58:56.228    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091023-104020-894_L1C_048-258-1_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/10/23/SPOT4-HRVIR2-XS_20091023-104032-355_L1C_048-259-5_D_V1-0/SPOT4-HRVIR2-XS_20091023-104032-355_L1C_048-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20091023-104032-355_L1C_048-259-5_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091023-104032-355_L1C_048-259-5_D_V1-0.zip
run script
2024-01-09T12:59:00.535    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:59:00.536    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091023-104032-355_L1C_048-259-5_D_V1-0.zip
2024-01-09T12:59:00.536    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:59:00.537    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:59:00.537    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:59:00.537    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:59:00.537    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:59:00.537    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:59:00.537    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:59:00.537    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091023-104032-355_L1C_048-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/10/23/SPOT4-HRVIR2-XS_20091023-104034-160_L1C_048-259-7_D_V1-0/SPOT4-HRVIR2-XS_20091023-104034-160_L1C_048-259-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20091023-104034-160_L1C_048-259-7_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091023-104034-160_L1C_048-259-7_D_V1-0.zip
run script
2024-01-09T12:59:05.723    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:59:05.724    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091023-104034-160_L1C_048-259-7_D_V1-0.zip
2024-01-09T12:59:05.724    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:59:05.724    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:59:05.724    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:59:05.724    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:59:05.725    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:59:05.725    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:59:05.725    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:59:05.725    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091023-104034-160_L1C_048-259-7_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/10/29/SPOT4-HRVIR1-XS_20091029-102447-098_L1C_048-257-7_D_V1-0/SPOT4-HRVIR1-XS_20091029-102447-098_L1C_048-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20091029-102447-098_L1C_048-257-7_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091029-102447-098_L1C_048-257-7_D_V1-0.zip
run script
2024-01-09T12:59:10.108    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:59:10.108    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091029-102447-098_L1C_048-257-7_D_V1-0.zip
2024-01-09T12:59:10.108    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:59:10.108    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:59:10.108    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:59:10.108    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:59:10.108    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:59:10.108    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:59:10.108    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:59:10.108    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091029-102447-098_L1C_048-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/10/29/SPOT4-HRVIR1-XS_20091029-102449-029_L1C_048-258-0_D_V1-0/SPOT4-HRVIR1-XS_20091029-102449-029_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20091029-102449-029_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091029-102449-029_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T12:59:14.647    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:59:14.648    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091029-102449-029_L1C_048-258-0_D_V1-0.zip
2024-01-09T12:59:14.648    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:59:14.648    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:59:14.649    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:59:14.649    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:59:14.649    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:59:14.649    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:59:14.649    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:59:14.649    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091029-102449-029_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/10/29/SPOT4-HRVIR1-XS_20091029-102449-932_L1C_048-258-1_D_V1-0/SPOT4-HRVIR1-XS_20091029-102449-932_L1C_048-258-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20091029-102449-932_L1C_048-258-1_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091029-102449-932_L1C_048-258-1_D_V1-0.zip
run script
2024-01-09T12:59:19.426    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:59:19.426    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091029-102449-932_L1C_048-258-1_D_V1-0.zip
2024-01-09T12:59:19.426    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:59:19.426    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:59:19.426    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:59:19.426    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:59:19.426    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:59:19.426    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:59:19.426    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:59:19.426    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091029-102449-932_L1C_048-258-1_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/10/29/SPOT4-HRVIR2-XS_20091029-102514-438_L1C_049-261-2_D_V1-0/SPOT4-HRVIR2-XS_20091029-102514-438_L1C_049-261-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20091029-102514-438_L1C_049-261-2_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091029-102514-438_L1C_049-261-2_D_V1-0.zip
run script
2024-01-09T12:59:23.907    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:59:23.909    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091029-102514-438_L1C_049-261-2_D_V1-0.zip
2024-01-09T12:59:23.909    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:59:23.909    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:59:23.909    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:59:23.909    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:59:23.909    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:59:23.909    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:59:23.909    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:59:23.909    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091029-102514-438_L1C_049-261-2_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/10/29/SPOT4-HRVIR2-XS_20091029-102520-926_L1C_049-262-0_D_V1-0/SPOT4-HRVIR2-XS_20091029-102520-926_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20091029-102520-926_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091029-102520-926_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T12:59:28.612    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:59:28.613    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091029-102520-926_L1C_049-262-0_D_V1-0.zip
2024-01-09T12:59:28.613    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:59:28.613    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:59:28.613    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:59:28.613    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:59:28.613    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:59:28.613    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:59:28.613    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:59:28.613    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091029-102520-926_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/10/29/SPOT4-HRVIR2-XS_20091029-102521-829_L1C_049-262-1_D_V1-0/SPOT4-HRVIR2-XS_20091029-102521-829_L1C_049-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20091029-102521-829_L1C_049-262-1_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091029-102521-829_L1C_049-262-1_D_V1-0.zip
run script
2024-01-09T12:59:37.070    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:59:37.071    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091029-102521-829_L1C_049-262-1_D_V1-0.zip
2024-01-09T12:59:37.071    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:59:37.071    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:59:37.071    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:59:37.071    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:59:37.071    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:59:37.071    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:59:37.072    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:59:37.072    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091029-102521-829_L1C_049-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/10/29/SPOT4-HRVIR2-XS_20091029-102447-104_L1C_050-258-1_D_V1-0/SPOT4-HRVIR2-XS_20091029-102447-104_L1C_050-258-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20091029-102447-104_L1C_050-258-1_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091029-102447-104_L1C_050-258-1_D_V1-0.zip
run script
2024-01-09T12:59:41.469    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:59:41.470    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091029-102447-104_L1C_050-258-1_D_V1-0.zip
2024-01-09T12:59:41.470    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:59:41.470    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:59:41.470    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:59:41.470    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:59:41.470    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:59:41.470    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:59:41.470    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:59:41.471    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091029-102447-104_L1C_050-258-1_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/10/29/SPOT4-HRVIR2-XS_20091029-102448-007_L1C_050-258-2_D_V1-0/SPOT4-HRVIR2-XS_20091029-102448-007_L1C_050-258-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20091029-102448-007_L1C_050-258-2_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091029-102448-007_L1C_050-258-2_D_V1-0.zip
run script
2024-01-09T13:01:56.594    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:01:56.595    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091029-102448-007_L1C_050-258-2_D_V1-0.zip
2024-01-09T13:01:56.595    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:01:56.596    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:01:56.596    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:01:56.596    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:01:56.596    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:01:56.596    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:01:56.596    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:01:56.596    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091029-102448-007_L1C_050-258-2_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/10/29/SPOT4-HRVIR2-XS_20091029-102458-089_L1C_050-259-4_D_V1-0/SPOT4-HRVIR2-XS_20091029-102458-089_L1C_050-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20091029-102458-089_L1C_050-259-4_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091029-102458-089_L1C_050-259-4_D_V1-0.zip
run script
2024-01-09T13:04:09.404    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:04:09.405    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091029-102458-089_L1C_050-259-4_D_V1-0.zip
2024-01-09T13:04:09.405    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:04:09.405    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:04:09.405    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:04:09.405    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:04:09.405    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:04:09.405    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:04:09.406    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:04:09.406    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091029-102458-089_L1C_050-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 1]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/10/29/SPOT4-HRVIR2-XS_20091029-102459-894_L1C_050-259-6_D_V1-0/SPOT4-HRVIR2-XS_20091029-102459-894_L1C_050-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20091029-102459-894_L1C_050-259-6_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091029-102459-894_L1C_050-259-6_D_V1-0.zip
run script
2024-01-09T13:06:05.528    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:06:05.529    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091029-102459-894_L1C_050-259-6_D_V1-0.zip
2024-01-09T13:06:05.530    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:06:05.530    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:06:05.530    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:06:05.530    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:06:05.530    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:06:05.530    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:06:05.530    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:06:05.530    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091029-102459-894_L1C_050-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/01/31/SPOT4-HRVIR1-XS_20090131-103906-746_L1C_048-258-0_D_V1-0/SPOT4-HRVIR1-XS_20090131-103906-746_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090131-103906-746_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090131-103906-746_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T13:07:54.266    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:07:54.267    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090131-103906-746_L1C_048-258-0_D_V1-0.zip
2024-01-09T13:07:54.267    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:07:54.267    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:07:54.267    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:07:54.267    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:07:54.267    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:07:54.267    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:07:54.267    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:07:54.267    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090131-103906-746_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/03/23/SPOT4-HRVIR2-XS_20090323-105808-864_L1C_048-258-0_D_V1-0/SPOT4-HRVIR2-XS_20090323-105808-864_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090323-105808-864_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090323-105808-864_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T13:08:25.806    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:08:25.808    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090323-105808-864_L1C_048-258-0_D_V1-0.zip
2024-01-09T13:08:25.808    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:08:25.808    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:08:25.808    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:08:25.808    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:08:25.808    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:08:25.808    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:08:25.808    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:08:25.808    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T13:09:15.823    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 81). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090323-105808-864_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/03/23/SPOT4-HRVIR2-XS_20090323-105808-519_L1C_049-257-9_D_V1-0/SPOT4-HRVIR2-XS_20090323-105808-519_L1C_049-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090323-105808-519_L1C_049-257-9_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090323-105808-519_L1C_049-257-9_D_V1-0.zip
run script
2024-01-09T13:09:20.680    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:09:20.682    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090323-105808-519_L1C_049-257-9_D_V1-0.zip
2024-01-09T13:09:20.682    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:09:20.682    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:09:20.682    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:09:20.682    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:09:20.682    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:09:20.682    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:09:20.682    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:09:20.682    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090323-105808-519_L1C_049-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/25/SPOT4-HRVIR2-XS_20090625-104933-111_L1C_048-258-0_D_V1-0/SPOT4-HRVIR2-XS_20090625-104933-111_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090625-104933-111_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090625-104933-111_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T13:10:18.535    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:10:18.536    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090625-104933-111_L1C_048-258-0_D_V1-0.zip
2024-01-09T13:10:18.536    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:10:18.536    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:10:18.536    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:10:18.536    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:10:18.536    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:10:18.536    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:10:18.536    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:10:18.536    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T13:10:59.439    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 278). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090625-104933-111_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/06/25/SPOT4-HRVIR2-XS_20090625-104941-516_L1C_048-259-0_D_V1-0/SPOT4-HRVIR2-XS_20090625-104941-516_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090625-104941-516_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090625-104941-516_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T13:11:04.292    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:11:04.294    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090625-104941-516_L1C_048-259-0_D_V1-0.zip
2024-01-09T13:11:04.294    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:11:04.294    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:11:04.294    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:11:04.294    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:11:04.294    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:11:04.294    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:11:04.294    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:11:04.294    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090625-104941-516_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/25/SPOT4-HRVIR2-XS_20090625-104946-028_L1C_048-259-5_D_V1-0/SPOT4-HRVIR2-XS_20090625-104946-028_L1C_048-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090625-104946-028_L1C_048-259-5_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090625-104946-028_L1C_048-259-5_D_V1-0.zip
run script
2024-01-09T13:11:24.730    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:11:24.731    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090625-104946-028_L1C_048-259-5_D_V1-0.zip
2024-01-09T13:11:24.731    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:11:24.731    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:11:24.731    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:11:24.732    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:11:24.732    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:11:24.732    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:11:24.732    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:11:24.732    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090625-104946-028_L1C_048-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/06/25/SPOT4-HRVIR2-XS_20090625-104916-050_L1C_049-255-9_D_V1-0/SPOT4-HRVIR2-XS_20090625-104916-050_L1C_049-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090625-104916-050_L1C_049-255-9_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090625-104916-050_L1C_049-255-9_D_V1-0.zip
run script
2024-01-09T13:11:29.483    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:11:29.484    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090625-104916-050_L1C_049-255-9_D_V1-0.zip
2024-01-09T13:11:29.485    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:11:29.485    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:11:29.485    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:11:29.485    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:11:29.485    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:11:29.485    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:11:29.485    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:11:29.485    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090625-104916-050_L1C_049-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/25/SPOT4-HRVIR2-XS_20090625-104916-318_L1C_049-256-0_D_V1-0/SPOT4-HRVIR2-XS_20090625-104916-318_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090625-104916-318_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090625-104916-318_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T13:12:57.248    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:12:57.250    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090625-104916-318_L1C_049-256-0_D_V1-0.zip
2024-01-09T13:12:57.250    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:12:57.250    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:12:57.250    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:12:57.250    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:12:57.250    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:12:57.250    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:12:57.250    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:12:57.250    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090625-104916-318_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/25/SPOT4-HRVIR2-XS_20090625-104924-713_L1C_049-257-0_D_V1-0/SPOT4-HRVIR2-XS_20090625-104924-713_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090625-104924-713_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090625-104924-713_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T13:14:28.920    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:14:28.921    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090625-104924-713_L1C_049-257-0_D_V1-0.zip
2024-01-09T13:14:28.921    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:14:28.921    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:14:28.922    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:14:28.922    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:14:28.922    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:14:28.922    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:14:28.922    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:14:28.922    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090625-104924-713_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 0 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/11/SPOT4-HRVIR2-XS_20090811-104520-595_L1C_048-258-9_D_V1-0/SPOT4-HRVIR2-XS_20090811-104520-595_L1C_048-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090811-104520-595_L1C_048-258-9_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090811-104520-595_L1C_048-258-9_D_V1-0.zip
run script
2024-01-09T13:15:36.916    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:15:36.917    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090811-104520-595_L1C_048-258-9_D_V1-0.zip
2024-01-09T13:15:36.918    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:15:36.918    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:15:36.918    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:15:36.918    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:15:36.918    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:15:36.918    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:15:36.918    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:15:36.918    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T13:15:39.901    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (422 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090811-104520-595_L1C_048-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2009/08/11/SPOT4-HRVIR2-XS_20090811-104520-848_L1C_048-259-0_D_V1-0/SPOT4-HRVIR2-XS_20090811-104520-848_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090811-104520-848_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090811-104520-848_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T13:15:44.425    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:15:44.426    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090811-104520-848_L1C_048-259-0_D_V1-0.zip
2024-01-09T13:15:44.426    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:15:44.426    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:15:44.426    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:15:44.427    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:15:44.427    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:15:44.427    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:15:44.427    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:15:44.427    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T13:15:47.239    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (226 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090811-104520-848_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2009/08/11/SPOT4-HRVIR2-XS_20090811-104522-653_L1C_048-259-2_D_V1-0/SPOT4-HRVIR2-XS_20090811-104522-653_L1C_048-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090811-104522-653_L1C_048-259-2_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090811-104522-653_L1C_048-259-2_D_V1-0.zip
run script
2024-01-09T13:15:51.279    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:15:51.281    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090811-104522-653_L1C_048-259-2_D_V1-0.zip
2024-01-09T13:15:51.281    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:15:51.281    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:15:51.281    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:15:51.281    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:15:51.281    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:15:51.281    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:15:51.281    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:15:51.281    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090811-104522-653_L1C_048-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/08/11/SPOT4-HRVIR2-XS_20090811-104453-509_L1C_050-256-0_D_V1-0/SPOT4-HRVIR2-XS_20090811-104453-509_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090811-104453-509_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090811-104453-509_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T13:15:54.770    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:15:54.771    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090811-104453-509_L1C_050-256-0_D_V1-0.zip
2024-01-09T13:15:54.771    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:15:54.771    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:15:54.771    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:15:54.771    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:15:54.771    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:15:54.772    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:15:54.772    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:15:54.772    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090811-104453-509_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/11/SPOT4-HRVIR2-XS_20090811-104501-892_L1C_050-257-0_D_V1-0/SPOT4-HRVIR2-XS_20090811-104501-892_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090811-104501-892_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090811-104501-892_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T13:19:23.723    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:19:23.724    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090811-104501-892_L1C_050-257-0_D_V1-0.zip
2024-01-09T13:19:23.724    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:19:23.724    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:19:23.724    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:19:23.724    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:19:23.724    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:19:23.725    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:19:23.725    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:19:23.725    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090811-104501-892_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 0 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/11/SPOT4-HRVIR2-XS_20090811-104505-502_L1C_050-257-4_D_V1-0/SPOT4-HRVIR2-XS_20090811-104505-502_L1C_050-257-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090811-104505-502_L1C_050-257-4_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090811-104505-502_L1C_050-257-4_D_V1-0.zip
run script
2024-01-09T13:22:36.019    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:22:36.021    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090811-104505-502_L1C_050-257-4_D_V1-0.zip
2024-01-09T13:22:36.021    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:22:36.021    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:22:36.021    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:22:36.021    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:22:36.021    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:22:36.021    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:22:36.021    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:22:36.021    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090811-104505-502_L1C_050-257-4_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/11/SPOT4-HRVIR1-XS_20090811-104505-982_L1C_053-258-0_D_V1-0/SPOT4-HRVIR1-XS_20090811-104505-982_L1C_053-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090811-104505-982_L1C_053-258-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090811-104505-982_L1C_053-258-0_D_V1-0.zip
run script
2024-01-09T13:25:33.037    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:25:33.038    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090811-104505-982_L1C_053-258-0_D_V1-0.zip
2024-01-09T13:25:33.038    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:25:33.038    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:25:33.038    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:25:33.038    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:25:33.038    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:25:33.038    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:25:33.038    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:25:33.038    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090811-104505-982_L1C_053-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/11/SPOT4-HRVIR1-XS_20090811-104520-299_L1C_053-259-7_D_V1-0/SPOT4-HRVIR1-XS_20090811-104520-299_L1C_053-259-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090811-104520-299_L1C_053-259-7_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090811-104520-299_L1C_053-259-7_D_V1-0.zip
run script
2024-01-09T13:27:45.122    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:27:45.123    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090811-104520-299_L1C_053-259-7_D_V1-0.zip
2024-01-09T13:27:45.123    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:27:45.123    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:27:45.123    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:27:45.123    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:27:45.123    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:27:45.123    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:27:45.123    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:27:45.123    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090811-104520-299_L1C_053-259-7_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/11/SPOT4-HRVIR1-XS_20090811-104522-435_L1C_053-260-0_D_V1-0/SPOT4-HRVIR1-XS_20090811-104522-435_L1C_053-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090811-104522-435_L1C_053-260-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090811-104522-435_L1C_053-260-0_D_V1-0.zip
run script
2024-01-09T13:31:35.530    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:31:35.531    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090811-104522-435_L1C_053-260-0_D_V1-0.zip
2024-01-09T13:31:35.531    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:31:35.531    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:31:35.531    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:31:35.531    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:31:35.532    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:31:35.532    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:31:35.532    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:31:35.532    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T13:32:18.448    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 72). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090811-104522-435_L1C_053-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/04/13/SPOT4-HRVIR2-XS_20090413-105431-065_L1C_048-260-6_D_V1-0/SPOT4-HRVIR2-XS_20090413-105431-065_L1C_048-260-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090413-105431-065_L1C_048-260-6_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090413-105431-065_L1C_048-260-6_D_V1-0.zip
run script
2024-01-09T13:32:22.453    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:32:22.455    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090413-105431-065_L1C_048-260-6_D_V1-0.zip
2024-01-09T13:32:22.455    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:32:22.455    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:32:22.455    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:32:22.455    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:32:22.455    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:32:22.455    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:32:22.455    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:32:22.455    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090413-105431-065_L1C_048-260-6_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/04/13/SPOT4-HRVIR2-XS_20090413-105434-097_L1C_048-261-0_D_V1-0/SPOT4-HRVIR2-XS_20090413-105434-097_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090413-105434-097_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090413-105434-097_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T13:32:26.279    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:32:26.280    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090413-105434-097_L1C_048-261-0_D_V1-0.zip
2024-01-09T13:32:26.280    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:32:26.280    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:32:26.280    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:32:26.280    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:32:26.280    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:32:26.280    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:32:26.280    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:32:26.280    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090413-105434-097_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/07/07/SPOT4-HRVIR1-XS_20090707-101858-504_L1C_048-261-4_D_V1-0/SPOT4-HRVIR1-XS_20090707-101858-504_L1C_048-261-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090707-101858-504_L1C_048-261-4_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090707-101858-504_L1C_048-261-4_D_V1-0.zip
run script
2024-01-09T13:32:30.507    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:32:30.508    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090707-101858-504_L1C_048-261-4_D_V1-0.zip
2024-01-09T13:32:30.508    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:32:30.508    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:32:30.508    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:32:30.508    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:32:30.508    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:32:30.508    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:32:30.508    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:32:30.508    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090707-101858-504_L1C_048-261-4_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/07/07/SPOT4-HRVIR1-XS_20090707-101819-842_L1C_050-257-0_D_V1-0/SPOT4-HRVIR1-XS_20090707-101819-842_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090707-101819-842_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090707-101819-842_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T13:32:33.906    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:32:33.907    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090707-101819-842_L1C_050-257-0_D_V1-0.zip
2024-01-09T13:32:33.907    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:32:33.907    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:32:33.907    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:32:33.907    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:32:33.907    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:32:33.907    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:32:33.908    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:32:33.908    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090707-101819-842_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/07/07/SPOT4-HRVIR1-XS_20090707-101821-647_L1C_050-257-2_D_V1-0/SPOT4-HRVIR1-XS_20090707-101821-647_L1C_050-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090707-101821-647_L1C_050-257-2_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090707-101821-647_L1C_050-257-2_D_V1-0.zip
run script
2024-01-09T13:35:30.426    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:35:30.428    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090707-101821-647_L1C_050-257-2_D_V1-0.zip
2024-01-09T13:35:30.428    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:35:30.428    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:35:30.428    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:35:30.428    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:35:30.428    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:35:30.428    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:35:30.428    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:35:30.428    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090707-101821-647_L1C_050-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/07/26/SPOT4-HRVIR1-XS_20090726-105336-304_L1C_048-262-0_D_V1-0/SPOT4-HRVIR1-XS_20090726-105336-304_L1C_048-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090726-105336-304_L1C_048-262-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090726-105336-304_L1C_048-262-0_D_V1-0.zip
run script
2024-01-09T13:38:22.398    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:38:22.399    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090726-105336-304_L1C_048-262-0_D_V1-0.zip
2024-01-09T13:38:22.399    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:38:22.399    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:38:22.399    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:38:22.400    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:38:22.400    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:38:22.400    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:38:22.400    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:38:22.400    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090726-105336-304_L1C_048-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/07/26/SPOT4-HRVIR1-XS_20090726-105335-973_L1C_049-261-9_D_V1-0/SPOT4-HRVIR1-XS_20090726-105335-973_L1C_049-261-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090726-105335-973_L1C_049-261-9_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090726-105335-973_L1C_049-261-9_D_V1-0.zip
run script
2024-01-09T13:38:26.019    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:38:26.020    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090726-105335-973_L1C_049-261-9_D_V1-0.zip
2024-01-09T13:38:26.020    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:38:26.020    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:38:26.020    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:38:26.020    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:38:26.020    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:38:26.020    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:38:26.020    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:38:26.020    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090726-105335-973_L1C_049-261-9_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/07/26/SPOT4-HRVIR2-XS_20090726-105335-631_L1C_049-262-0_D_V1-0/SPOT4-HRVIR2-XS_20090726-105335-631_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090726-105335-631_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090726-105335-631_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T13:38:29.714    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:38:29.715    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090726-105335-631_L1C_049-262-0_D_V1-0.zip
2024-01-09T13:38:29.715    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:38:29.715    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:38:29.715    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:38:29.716    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:38:29.716    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:38:29.716    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:38:29.716    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:38:29.716    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090726-105335-631_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/08/22/SPOT4-HRVIR2-XS_20090822-103303-712_L1C_049-254-6_D_V1-0/SPOT4-HRVIR2-XS_20090822-103303-712_L1C_049-254-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090822-103303-712_L1C_049-254-6_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090822-103303-712_L1C_049-254-6_D_V1-0.zip
run script
2024-01-09T13:38:33.207    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:38:33.208    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090822-103303-712_L1C_049-254-6_D_V1-0.zip
2024-01-09T13:38:33.208    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:38:33.208    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:38:33.208    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:38:33.208    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:38:33.208    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:38:33.208    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:38:33.208    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:38:33.208    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T13:38:38.568    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 34). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090822-103303-712_L1C_049-254-6_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/08/22/SPOT4-HRVIR2-XS_20090822-103306-567_L1C_049-255-0_D_V1-0/SPOT4-HRVIR2-XS_20090822-103306-567_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090822-103306-567_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090822-103306-567_L1C_049-255-0_D_V1-0.zip
run script
2024-01-09T13:38:42.121    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:38:42.122    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090822-103306-567_L1C_049-255-0_D_V1-0.zip
2024-01-09T13:38:42.123    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:38:42.123    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:38:42.123    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:38:42.123    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:38:42.123    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:38:42.123    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:38:42.123    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:38:42.123    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090822-103306-567_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/22/SPOT4-HRVIR2-XS_20090822-103314-845_L1C_049-256-0_D_V1-0/SPOT4-HRVIR2-XS_20090822-103314-845_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090822-103314-845_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090822-103314-845_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T13:39:14.925    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:39:14.926    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090822-103314-845_L1C_049-256-0_D_V1-0.zip
2024-01-09T13:39:14.926    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:39:14.926    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:39:14.926    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:39:14.926    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:39:14.926    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:39:14.927    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:39:14.927    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:39:14.927    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090822-103314-845_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/22/SPOT4-HRVIR2-XS_20090822-103323-132_L1C_049-257-0_D_V1-0/SPOT4-HRVIR2-XS_20090822-103323-132_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090822-103323-132_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090822-103323-132_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T13:40:27.147    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:40:27.148    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090822-103323-132_L1C_049-257-0_D_V1-0.zip
2024-01-09T13:40:27.148    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:40:27.148    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:40:27.148    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:40:27.148    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:40:27.148    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:40:27.148    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:40:27.148    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:40:27.148    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090822-103323-132_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 0 2 ... 2 2 2]
 [2 0 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/22/SPOT4-HRVIR2-XS_20090822-103331-428_L1C_049-258-0_D_V1-0/SPOT4-HRVIR2-XS_20090822-103331-428_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090822-103331-428_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090822-103331-428_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T13:41:24.316    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:41:24.317    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090822-103331-428_L1C_049-258-0_D_V1-0.zip
2024-01-09T13:41:24.317    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:41:24.317    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:41:24.317    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:41:24.318    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:41:24.318    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:41:24.318    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:41:24.318    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:41:24.318    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090822-103331-428_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/22/SPOT4-HRVIR2-XS_20090822-103349-951_L1C_051-260-6_D_V1-0/SPOT4-HRVIR2-XS_20090822-103349-951_L1C_051-260-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090822-103349-951_L1C_051-260-6_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090822-103349-951_L1C_051-260-6_D_V1-0.zip
run script
2024-01-09T13:42:01.070    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:42:01.071    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090822-103349-951_L1C_051-260-6_D_V1-0.zip
2024-01-09T13:42:01.071    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:42:01.071    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:42:01.071    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:42:01.072    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:42:01.072    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:42:01.072    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:42:01.072    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:42:01.072    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090822-103349-951_L1C_051-260-6_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/22/SPOT4-HRVIR2-XS_20090822-103352-884_L1C_051-261-0_D_V1-0/SPOT4-HRVIR2-XS_20090822-103352-884_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090822-103352-884_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090822-103352-884_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T13:44:29.274    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:44:29.274    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090822-103352-884_L1C_051-261-0_D_V1-0.zip
2024-01-09T13:44:29.274    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:44:29.274    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:44:29.274    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:44:29.274    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:44:29.274    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:44:29.274    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:44:29.274    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:44:29.275    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090822-103352-884_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/10/14/SPOT4-HRVIR1-XS_20091014-101248-774_L1C_049-254-0_D_V1-0/SPOT4-HRVIR1-XS_20091014-101248-774_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20091014-101248-774_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091014-101248-774_L1C_049-254-0_D_V1-0.zip
run script
2024-01-09T13:46:53.445    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:46:53.447    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091014-101248-774_L1C_049-254-0_D_V1-0.zip
2024-01-09T13:46:53.447    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:46:53.447    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:46:53.447    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:46:53.447    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:46:53.447    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:46:53.447    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:46:53.447    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:46:53.447    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091014-101248-774_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/10/14/SPOT4-HRVIR2-XS_20091014-101308-949_L1C_052-256-7_D_V1-0/SPOT4-HRVIR2-XS_20091014-101308-949_L1C_052-256-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20091014-101308-949_L1C_052-256-7_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091014-101308-949_L1C_052-256-7_D_V1-0.zip
run script
2024-01-09T13:46:57.227    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:46:57.227    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091014-101308-949_L1C_052-256-7_D_V1-0.zip
2024-01-09T13:46:57.227    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:46:57.227    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:46:57.227    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:46:57.227    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:46:57.227    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:46:57.227    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:46:57.228    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:46:57.228    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091014-101308-949_L1C_052-256-7_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/10/19/SPOT4-HRVIR2-XS_20091019-101636-598_L1C_049-254-0_D_V1-0/SPOT4-HRVIR2-XS_20091019-101636-598_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20091019-101636-598_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091019-101636-598_L1C_049-254-0_D_V1-0.zip
run script
2024-01-09T13:50:00.324    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:50:00.325    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091019-101636-598_L1C_049-254-0_D_V1-0.zip
2024-01-09T13:50:00.325    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:50:00.325    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:50:00.325    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:50:00.325    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:50:00.325    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:50:00.325    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:50:00.325    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:50:00.326    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091019-101636-598_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/10/19/SPOT4-HRVIR2-XS_20091019-101644-798_L1C_049-255-0_D_V1-0/SPOT4-HRVIR2-XS_20091019-101644-798_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20091019-101644-798_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091019-101644-798_L1C_049-255-0_D_V1-0.zip
run script
2024-01-09T13:50:04.087    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:50:04.088    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091019-101644-798_L1C_049-255-0_D_V1-0.zip
2024-01-09T13:50:04.088    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:50:04.088    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:50:04.088    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:50:04.088    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:50:04.088    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:50:04.088    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:50:04.089    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:50:04.089    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091019-101644-798_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 2 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/10/19/SPOT4-HRVIR2-XS_20091019-101650-212_L1C_049-255-6_D_V1-0/SPOT4-HRVIR2-XS_20091019-101650-212_L1C_049-255-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20091019-101650-212_L1C_049-255-6_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091019-101650-212_L1C_049-255-6_D_V1-0.zip
run script
2024-01-09T13:50:40.976    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:50:40.977    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091019-101650-212_L1C_049-255-6_D_V1-0.zip
2024-01-09T13:50:40.977    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:50:40.977    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:50:40.977    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:50:40.977    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:50:40.977    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:50:40.978    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:50:40.978    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:50:40.978    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091019-101650-212_L1C_049-255-6_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 2 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/05/04/SPOT4-HRVIR2-XS_20090504-105004-097_L1C_049-257-7_D_V1-0/SPOT4-HRVIR2-XS_20090504-105004-097_L1C_049-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090504-105004-097_L1C_049-257-7_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090504-105004-097_L1C_049-257-7_D_V1-0.zip
run script
2024-01-09T13:51:55.077    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:51:55.078    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090504-105004-097_L1C_049-257-7_D_V1-0.zip
2024-01-09T13:51:55.079    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:51:55.079    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:51:55.079    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:51:55.079    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:51:55.079    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:51:55.079    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:51:55.079    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:51:55.079    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090504-105004-097_L1C_049-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/05/04/SPOT4-HRVIR2-XS_20090504-105006-192_L1C_049-258-0_D_V1-0/SPOT4-HRVIR2-XS_20090504-105006-192_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090504-105006-192_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090504-105006-192_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T13:54:43.393    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:54:43.395    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090504-105006-192_L1C_049-258-0_D_V1-0.zip
2024-01-09T13:54:43.395    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:54:43.395    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:54:43.395    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:54:43.395    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:54:43.395    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:54:43.395    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:54:43.395    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:54:43.395    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T13:56:36.467    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 160). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090504-105006-192_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/05/04/SPOT4-HRVIR2-XS_20090504-105014-611_L1C_049-259-0_D_V1-0/SPOT4-HRVIR2-XS_20090504-105014-611_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090504-105014-611_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090504-105014-611_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T13:56:39.747    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:56:39.749    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090504-105014-611_L1C_049-259-0_D_V1-0.zip
2024-01-09T13:56:39.749    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:56:39.749    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:56:39.749    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:56:39.749    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:56:39.749    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:56:39.749    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:56:39.749    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:56:39.749    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090504-105014-611_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/05/04/SPOT4-HRVIR2-XS_20090504-105023-035_L1C_049-260-0_D_V1-0/SPOT4-HRVIR2-XS_20090504-105023-035_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090504-105023-035_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090504-105023-035_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T13:57:46.344    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:57:46.345    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090504-105023-035_L1C_049-260-0_D_V1-0.zip
2024-01-09T13:57:46.345    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:57:46.345    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:57:46.345    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:57:46.345    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:57:46.345    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:57:46.345    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:57:46.345    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:57:46.345    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090504-105023-035_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/05/04/SPOT4-HRVIR2-XS_20090504-105029-350_L1C_049-260-7_D_V1-0/SPOT4-HRVIR2-XS_20090504-105029-350_L1C_049-260-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090504-105029-350_L1C_049-260-7_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090504-105029-350_L1C_049-260-7_D_V1-0.zip
run script
2024-01-09T13:58:30.760    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:58:30.761    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090504-105029-350_L1C_049-260-7_D_V1-0.zip
2024-01-09T13:58:30.761    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:58:30.761    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:58:30.761    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:58:30.761    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:58:30.762    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:58:30.762    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:58:30.762    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:58:30.762    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090504-105029-350_L1C_049-260-7_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/05/04/SPOT4-HRVIR2-XS_20090504-105040-797_L1C_049-262-1_D_V1-0/SPOT4-HRVIR2-XS_20090504-105040-797_L1C_049-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090504-105040-797_L1C_049-262-1_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090504-105040-797_L1C_049-262-1_D_V1-0.zip
run script
2024-01-09T13:58:51.278    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:58:51.279    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090504-105040-797_L1C_049-262-1_D_V1-0.zip
2024-01-09T13:58:51.279    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:58:51.280    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:58:51.280    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:58:51.280    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:58:51.280    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:58:51.280    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:58:51.280    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:58:51.280    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090504-105040-797_L1C_049-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/07/12/SPOT4-HRVIR2-XS_20090712-102216-484_L1C_049-257-9_D_V1-0/SPOT4-HRVIR2-XS_20090712-102216-484_L1C_049-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090712-102216-484_L1C_049-257-9_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090712-102216-484_L1C_049-257-9_D_V1-0.zip
run script
2024-01-09T13:58:55.032    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:58:55.033    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090712-102216-484_L1C_049-257-9_D_V1-0.zip
2024-01-09T13:58:55.033    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:58:55.034    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:58:55.034    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:58:55.034    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:58:55.034    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:58:55.034    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:58:55.034    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:58:55.034    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T14:00:21.279    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 372). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090712-102216-484_L1C_049-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/07/12/SPOT4-HRVIR2-XS_20090712-102216-610_L1C_050-258-0_D_V1-0/SPOT4-HRVIR2-XS_20090712-102216-610_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090712-102216-610_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090712-102216-610_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T14:00:24.697    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:00:24.698    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090712-102216-610_L1C_050-258-0_D_V1-0.zip
2024-01-09T14:00:24.698    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:00:24.698    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:00:24.699    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:00:24.699    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:00:24.699    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:00:24.699    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:00:24.699    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:00:24.699    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T14:01:46.974    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (0 x 3004). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090712-102216-610_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/07/12/SPOT4-HRVIR2-XS_20090712-102220-220_L1C_050-258-4_D_V1-0/SPOT4-HRVIR2-XS_20090712-102220-220_L1C_050-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090712-102220-220_L1C_050-258-4_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090712-102220-220_L1C_050-258-4_D_V1-0.zip
run script
2024-01-09T14:01:50.458    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:01:50.459    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090712-102220-220_L1C_050-258-4_D_V1-0.zip
2024-01-09T14:01:50.459    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:01:50.459    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:01:50.459    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:01:50.459    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:01:50.460    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:01:50.460    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:01:50.460    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:01:50.460    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090712-102220-220_L1C_050-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/04/24/SPOT4-HRVIR1-XS_20090424-104228-569_L1C_049-258-0_D_V1-0/SPOT4-HRVIR1-XS_20090424-104228-569_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090424-104228-569_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090424-104228-569_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T14:03:21.741    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:03:21.743    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090424-104228-569_L1C_049-258-0_D_V1-0.zip
2024-01-09T14:03:21.743    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:03:21.743    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:03:21.743    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:03:21.743    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:03:21.743    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:03:21.743    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:03:21.743    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:03:21.743    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T14:04:50.299    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 362). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090424-104228-569_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/04/24/SPOT4-HRVIR1-XS_20090424-104232-179_L1C_049-258-4_D_V1-0/SPOT4-HRVIR1-XS_20090424-104232-179_L1C_049-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090424-104232-179_L1C_049-258-4_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090424-104232-179_L1C_049-258-4_D_V1-0.zip
run script
2024-01-09T14:04:53.875    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:04:53.877    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090424-104232-179_L1C_049-258-4_D_V1-0.zip
2024-01-09T14:04:53.877    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:04:53.877    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:04:53.877    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:04:53.877    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:04:53.877    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:04:53.877    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:04:53.877    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:04:53.877    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090424-104232-179_L1C_049-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/04/24/SPOT4-HRVIR1-XS_20090424-104225-627_L1C_050-257-6_D_V1-0/SPOT4-HRVIR1-XS_20090424-104225-627_L1C_050-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090424-104225-627_L1C_050-257-6_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090424-104225-627_L1C_050-257-6_D_V1-0.zip
run script
2024-01-09T14:06:21.781    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:06:21.782    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090424-104225-627_L1C_050-257-6_D_V1-0.zip
2024-01-09T14:06:21.782    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:06:21.783    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:06:21.783    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:06:21.783    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:06:21.783    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:06:21.783    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:06:21.783    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:06:21.783    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090424-104225-627_L1C_050-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 2 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/05/09/SPOT4-HRVIR1-XS_20090509-105354-335_L1C_049-258-0_D_V1-0/SPOT4-HRVIR1-XS_20090509-105354-335_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090509-105354-335_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090509-105354-335_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T14:08:08.321    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:08:08.322    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090509-105354-335_L1C_049-258-0_D_V1-0.zip
2024-01-09T14:08:08.322    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:08:08.322    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:08:08.322    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:08:08.322    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:08:08.322    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:08:08.322    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:08:08.323    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:08:08.323    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T14:09:45.748    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 362). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090509-105354-335_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/05/09/SPOT4-HRVIR1-XS_20090509-105357-944_L1C_049-258-4_D_V1-0/SPOT4-HRVIR1-XS_20090509-105357-944_L1C_049-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090509-105357-944_L1C_049-258-4_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090509-105357-944_L1C_049-258-4_D_V1-0.zip
run script
2024-01-09T14:09:49.641    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:09:49.642    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090509-105357-944_L1C_049-258-4_D_V1-0.zip
2024-01-09T14:09:49.643    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:09:49.643    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:09:49.643    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:09:49.643    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:09:49.643    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:09:49.643    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:09:49.643    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:09:49.643    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090509-105357-944_L1C_049-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/15/SPOT4-HRVIR1-XS_20090615-104158-333_L1C_049-258-2_D_V1-0/SPOT4-HRVIR1-XS_20090615-104158-333_L1C_049-258-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090615-104158-333_L1C_049-258-2_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090615-104158-333_L1C_049-258-2_D_V1-0.zip
run script
2024-01-09T14:11:29.566    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:11:29.566    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090615-104158-333_L1C_049-258-2_D_V1-0.zip
2024-01-09T14:11:29.566    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:11:29.566    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:11:29.566    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:11:29.566    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:11:29.566    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:11:29.566    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:11:29.566    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:11:29.566    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090615-104158-333_L1C_049-258-2_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/15/SPOT4-HRVIR1-XS_20090615-104200-137_L1C_049-258-4_D_V1-0/SPOT4-HRVIR1-XS_20090615-104200-137_L1C_049-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090615-104200-137_L1C_049-258-4_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090615-104200-137_L1C_049-258-4_D_V1-0.zip
run script
2024-01-09T14:12:55.572    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:12:55.573    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090615-104200-137_L1C_049-258-4_D_V1-0.zip
2024-01-09T14:12:55.573    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:12:55.573    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:12:55.574    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:12:55.574    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:12:55.574    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:12:55.574    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:12:55.574    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:12:55.574    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090615-104200-137_L1C_049-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/15/SPOT4-HRVIR2-XS_20090615-104235-669_L1C_052-263-1_D_V1-0/SPOT4-HRVIR2-XS_20090615-104235-669_L1C_052-263-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090615-104235-669_L1C_052-263-1_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090615-104235-669_L1C_052-263-1_D_V1-0.zip
run script
2024-01-09T14:14:24.439    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:14:24.441    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090615-104235-669_L1C_052-263-1_D_V1-0.zip
2024-01-09T14:14:24.441    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:14:24.441    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:14:24.441    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:14:24.441    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:14:24.441    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:14:24.441    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:14:24.441    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:14:24.441    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090615-104235-669_L1C_052-263-1_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/15/SPOT4-HRVIR1-XS_20090615-104216-311_L1C_053-260-9_D_V1-0/SPOT4-HRVIR1-XS_20090615-104216-311_L1C_053-260-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090615-104216-311_L1C_053-260-9_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090615-104216-311_L1C_053-260-9_D_V1-0.zip
run script
2024-01-09T14:15:17.719    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:15:17.720    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090615-104216-311_L1C_053-260-9_D_V1-0.zip
2024-01-09T14:15:17.720    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:15:17.720    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:15:17.720    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:15:17.720    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:15:17.720    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:15:17.720    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:15:17.720    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:15:17.720    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090615-104216-311_L1C_053-260-9_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 0 2]
 [2 2 2 ... 0 0 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/15/SPOT4-HRVIR1-XS_20090615-104216-615_L1C_053-261-0_D_V1-0/SPOT4-HRVIR1-XS_20090615-104216-615_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090615-104216-615_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090615-104216-615_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T14:18:28.284    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:18:28.285    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090615-104216-615_L1C_053-261-0_D_V1-0.zip
2024-01-09T14:18:28.286    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:18:28.286    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:18:28.286    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:18:28.286    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:18:28.286    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:18:28.286    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:18:28.286    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:18:28.286    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090615-104216-615_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/15/SPOT4-HRVIR1-XS_20090615-104225-044_L1C_053-262-0_D_V1-0/SPOT4-HRVIR1-XS_20090615-104225-044_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090615-104225-044_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090615-104225-044_L1C_053-262-0_D_V1-0.zip
run script
2024-01-09T14:21:35.446    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:21:35.447    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090615-104225-044_L1C_053-262-0_D_V1-0.zip
2024-01-09T14:21:35.447    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:21:35.447    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:21:35.447    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:21:35.448    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:21:35.448    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:21:35.448    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:21:35.448    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:21:35.448    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090615-104225-044_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/07/21/SPOT4-HRVIR1-XS_20090721-104914-727_L1C_049-258-2_D_V1-0/SPOT4-HRVIR1-XS_20090721-104914-727_L1C_049-258-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090721-104914-727_L1C_049-258-2_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090721-104914-727_L1C_049-258-2_D_V1-0.zip
run script
2024-01-09T14:24:20.048    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:24:20.049    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090721-104914-727_L1C_049-258-2_D_V1-0.zip
2024-01-09T14:24:20.049    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:24:20.049    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:24:20.050    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:24:20.050    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:24:20.050    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:24:20.050    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:24:20.050    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:24:20.050    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090721-104914-727_L1C_049-258-2_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/07/21/SPOT4-HRVIR1-XS_20090721-104916-526_L1C_049-258-4_D_V1-0/SPOT4-HRVIR1-XS_20090721-104916-526_L1C_049-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090721-104916-526_L1C_049-258-4_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090721-104916-526_L1C_049-258-4_D_V1-0.zip
run script
2024-01-09T14:25:49.275    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:25:49.276    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090721-104916-526_L1C_049-258-4_D_V1-0.zip
2024-01-09T14:25:49.276    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:25:49.276    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:25:49.276    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:25:49.276    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:25:49.276    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:25:49.277    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:25:49.277    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:25:49.277    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090721-104916-526_L1C_049-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/01/11/SPOT4-HRVIR2-XS_20090111-102349-982_L1C_049-259-0_D_V1-0/SPOT4-HRVIR2-XS_20090111-102349-982_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090111-102349-982_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090111-102349-982_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T14:27:21.726    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:27:21.727    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090111-102349-982_L1C_049-259-0_D_V1-0.zip
2024-01-09T14:27:21.727    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:27:21.727    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:27:21.727    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:27:21.728    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:27:21.728    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:27:21.728    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:27:21.728    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:27:21.728    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090111-102349-982_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/01/11/SPOT4-HRVIR2-XS_20090111-102354-494_L1C_049-259-5_D_V1-0/SPOT4-HRVIR2-XS_20090111-102354-494_L1C_049-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090111-102354-494_L1C_049-259-5_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090111-102354-494_L1C_049-259-5_D_V1-0.zip
run script
2024-01-09T14:27:46.234    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:27:46.235    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090111-102354-494_L1C_049-259-5_D_V1-0.zip
2024-01-09T14:27:46.236    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:27:46.236    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:27:46.236    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:27:46.236    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:27:46.236    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:27:46.236    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:27:46.236    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:27:46.236    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090111-102354-494_L1C_049-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/01/11/SPOT4-HRVIR1-XS_20090111-102356-833_L1C_050-260-0_D_V1-0/SPOT4-HRVIR1-XS_20090111-102356-833_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090111-102356-833_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090111-102356-833_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T14:28:01.400    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:28:01.401    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090111-102356-833_L1C_050-260-0_D_V1-0.zip
2024-01-09T14:28:01.401    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:28:01.401    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:28:01.401    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:28:01.401    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:28:01.401    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:28:01.401    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:28:01.402    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:28:01.402    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090111-102356-833_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/01/11/SPOT4-HRVIR1-XS_20090111-102358-638_L1C_050-260-2_D_V1-0/SPOT4-HRVIR1-XS_20090111-102358-638_L1C_050-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090111-102358-638_L1C_050-260-2_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090111-102358-638_L1C_050-260-2_D_V1-0.zip
run script
2024-01-09T14:29:25.926    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:29:25.927    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090111-102358-638_L1C_050-260-2_D_V1-0.zip
2024-01-09T14:29:25.927    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:29:25.927    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:29:25.927    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:29:25.927    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:29:25.927    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:29:25.928    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:29:25.928    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:29:25.928    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T14:29:28.196    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 318). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090111-102358-638_L1C_050-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2009/06/04/SPOT4-HRVIR1-XS_20090604-105355-104_L1C_049-259-9_D_V1-0/SPOT4-HRVIR1-XS_20090604-105355-104_L1C_049-259-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090604-105355-104_L1C_049-259-9_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090604-105355-104_L1C_049-259-9_D_V1-0.zip
run script
2024-01-09T14:29:32.532    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:29:32.533    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090604-105355-104_L1C_049-259-9_D_V1-0.zip
2024-01-09T14:29:32.533    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:29:32.533    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:29:32.533    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:29:32.533    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:29:32.533    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:29:32.533    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:29:32.533    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:29:32.533    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090604-105355-104_L1C_049-259-9_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/04/SPOT4-HRVIR1-XS_20090604-105355-435_L1C_049-260-0_D_V1-0/SPOT4-HRVIR1-XS_20090604-105355-435_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090604-105355-435_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090604-105355-435_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T14:30:04.181    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:30:04.182    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090604-105355-435_L1C_049-260-0_D_V1-0.zip
2024-01-09T14:30:04.182    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:30:04.182    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:30:04.182    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:30:04.182    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:30:04.182    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:30:04.183    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:30:04.183    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:30:04.183    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090604-105355-435_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/04/SPOT4-HRVIR1-XS_20090604-105403-894_L1C_049-261-0_D_V1-0/SPOT4-HRVIR1-XS_20090604-105403-894_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090604-105403-894_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090604-105403-894_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T14:30:38.057    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:30:38.058    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090604-105403-894_L1C_049-261-0_D_V1-0.zip
2024-01-09T14:30:38.058    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:30:38.058    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:30:38.058    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:30:38.058    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:30:38.058    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:30:38.058    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:30:38.058    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:30:38.058    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T14:30:40.961    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (294 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090604-105403-894_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2009/06/04/SPOT4-HRVIR1-XS_20090604-105412-352_L1C_049-262-0_D_V1-0/SPOT4-HRVIR1-XS_20090604-105412-352_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090604-105412-352_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090604-105412-352_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T14:30:45.079    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:30:45.080    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090604-105412-352_L1C_049-262-0_D_V1-0.zip
2024-01-09T14:30:45.080    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:30:45.081    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:30:45.081    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:30:45.081    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:30:45.081    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:30:45.081    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:30:45.081    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:30:45.081    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090604-105412-352_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/06/04/SPOT4-HRVIR1-XS_20090604-105326-526_L1C_050-256-7_D_V1-0/SPOT4-HRVIR1-XS_20090604-105326-526_L1C_050-256-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090604-105326-526_L1C_050-256-7_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090604-105326-526_L1C_050-256-7_D_V1-0.zip
run script
2024-01-09T14:30:49.079    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:30:49.079    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090604-105326-526_L1C_050-256-7_D_V1-0.zip
2024-01-09T14:30:49.079    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:30:49.079    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:30:49.079    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:30:49.079    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:30:49.080    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:30:49.080    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:30:49.080    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:30:49.080    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090604-105326-526_L1C_050-256-7_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/04/SPOT4-HRVIR1-XS_20090604-105328-664_L1C_050-257-0_D_V1-0/SPOT4-HRVIR1-XS_20090604-105328-664_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090604-105328-664_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090604-105328-664_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T14:34:59.351    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:34:59.352    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090604-105328-664_L1C_050-257-0_D_V1-0.zip
2024-01-09T14:34:59.352    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:34:59.352    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:34:59.352    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:34:59.352    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:34:59.352    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:34:59.352    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:34:59.352    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:34:59.352    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090604-105328-664_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/04/SPOT4-HRVIR1-XS_20090604-105337-126_L1C_050-258-0_D_V1-0/SPOT4-HRVIR1-XS_20090604-105337-126_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090604-105337-126_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090604-105337-126_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T14:38:46.439    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:38:46.440    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090604-105337-126_L1C_050-258-0_D_V1-0.zip
2024-01-09T14:38:46.440    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:38:46.441    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:38:46.441    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:38:46.441    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:38:46.441    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:38:46.441    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:38:46.441    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:38:46.441    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T14:41:46.652    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 234). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090604-105337-126_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/06/04/SPOT4-HRVIR1-XS_20090604-105341-638_L1C_050-258-5_D_V1-0/SPOT4-HRVIR1-XS_20090604-105341-638_L1C_050-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090604-105341-638_L1C_050-258-5_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090604-105341-638_L1C_050-258-5_D_V1-0.zip
run script
2024-01-09T14:41:50.634    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:41:50.635    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090604-105341-638_L1C_050-258-5_D_V1-0.zip
2024-01-09T14:41:50.635    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:41:50.635    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:41:50.635    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:41:50.635    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:41:50.635    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:41:50.635    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:41:50.635    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:41:50.635    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090604-105341-638_L1C_050-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/04/14/SPOT4-HRVIR1-XS_20090414-103522-902_L1C_049-261-8_D_V1-0/SPOT4-HRVIR1-XS_20090414-103522-902_L1C_049-261-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090414-103522-902_L1C_049-261-8_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090414-103522-902_L1C_049-261-8_D_V1-0.zip
run script
2024-01-09T14:45:13.067    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:45:13.068    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090414-103522-902_L1C_049-261-8_D_V1-0.zip
2024-01-09T14:45:13.068    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:45:13.068    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:45:13.068    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:45:13.068    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:45:13.069    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:45:13.069    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:45:13.069    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:45:13.069    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090414-103522-902_L1C_049-261-8_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/04/14/SPOT4-HRVIR1-XS_20090414-103524-012_L1C_049-262-0_D_V1-0/SPOT4-HRVIR1-XS_20090414-103524-012_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090414-103524-012_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090414-103524-012_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T14:45:16.722    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:45:16.722    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090414-103524-012_L1C_049-262-0_D_V1-0.zip
2024-01-09T14:45:16.722    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:45:16.722    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:45:16.722    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:45:16.722    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:45:16.722    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:45:16.722    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:45:16.722    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:45:16.722    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090414-103524-012_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/04/14/SPOT4-HRVIR1-XS_20090414-103525-816_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20090414-103525-816_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090414-103525-816_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090414-103525-816_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T14:45:20.099    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:45:20.100    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090414-103525-816_L1C_049-262-2_D_V1-0.zip
2024-01-09T14:45:20.100    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:45:20.100    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:45:20.100    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:45:20.100    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:45:20.100    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:45:20.100    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:45:20.100    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:45:20.100    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090414-103525-816_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/04/14/SPOT4-HRVIR1-XS_20090414-103447-260_L1C_050-257-6_D_V1-0/SPOT4-HRVIR1-XS_20090414-103447-260_L1C_050-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090414-103447-260_L1C_050-257-6_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090414-103447-260_L1C_050-257-6_D_V1-0.zip
run script
2024-01-09T14:45:23.482    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:45:23.482    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090414-103447-260_L1C_050-257-6_D_V1-0.zip
2024-01-09T14:45:23.482    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:45:23.482    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:45:23.482    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:45:23.482    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:45:23.482    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:45:23.482    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:45:23.483    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:45:23.483    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T14:47:12.509    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (364 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090414-103447-260_L1C_050-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 2]
 [2 2 2 ... 0 0 2]
 [2 2 2 ... 0 0 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/04/14/SPOT4-HRVIR1-XS_20090414-103450-150_L1C_050-258-0_D_V1-0/SPOT4-HRVIR1-XS_20090414-103450-150_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090414-103450-150_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090414-103450-150_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T14:47:16.226    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:47:16.228    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090414-103450-150_L1C_050-258-0_D_V1-0.zip
2024-01-09T14:47:16.228    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:47:16.228    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:47:16.228    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:47:16.228    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:47:16.228    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:47:16.228    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:47:16.228    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:47:16.228    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T14:48:54.393    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 1562). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090414-103450-150_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/04/14/SPOT4-HRVIR1-XS_20090414-103458-464_L1C_050-259-0_D_V1-0/SPOT4-HRVIR1-XS_20090414-103458-464_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090414-103458-464_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090414-103458-464_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T14:48:57.971    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:48:57.972    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090414-103458-464_L1C_050-259-0_D_V1-0.zip
2024-01-09T14:48:57.972    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:48:57.972    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:48:57.972    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:48:57.972    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:48:57.973    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:48:57.973    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:48:57.973    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:48:57.973    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090414-103458-464_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/04/14/SPOT4-HRVIR1-XS_20090414-103502-976_L1C_050-259-5_D_V1-0/SPOT4-HRVIR1-XS_20090414-103502-976_L1C_050-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090414-103502-976_L1C_050-259-5_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090414-103502-976_L1C_050-259-5_D_V1-0.zip
run script
2024-01-09T14:50:18.606    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:50:18.607    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090414-103502-976_L1C_050-259-5_D_V1-0.zip
2024-01-09T14:50:18.608    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:50:18.608    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:50:18.608    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:50:18.608    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:50:18.608    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:50:18.608    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:50:18.608    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:50:18.608    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090414-103502-976_L1C_050-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/05/05/SPOT4-HRVIR2-XS_20090505-103120-708_L1C_049-261-8_D_V1-0/SPOT4-HRVIR2-XS_20090505-103120-708_L1C_049-261-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090505-103120-708_L1C_049-261-8_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090505-103120-708_L1C_049-261-8_D_V1-0.zip
run script
2024-01-09T14:51:29.793    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:51:29.794    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090505-103120-708_L1C_049-261-8_D_V1-0.zip
2024-01-09T14:51:29.794    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:51:29.795    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:51:29.795    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:51:29.795    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:51:29.795    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:51:29.795    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:51:29.795    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:51:29.795    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090505-103120-708_L1C_049-261-8_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/05/05/SPOT4-HRVIR2-XS_20090505-103121-800_L1C_049-262-0_D_V1-0/SPOT4-HRVIR2-XS_20090505-103121-800_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090505-103121-800_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090505-103121-800_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T14:51:33.373    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:51:33.373    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090505-103121-800_L1C_049-262-0_D_V1-0.zip
2024-01-09T14:51:33.373    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:51:33.373    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:51:33.373    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:51:33.373    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:51:33.373    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:51:33.373    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:51:33.374    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:51:33.374    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090505-103121-800_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/05/05/SPOT4-HRVIR2-XS_20090505-103123-604_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20090505-103123-604_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090505-103123-604_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090505-103123-604_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T14:51:37.114    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:51:37.115    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090505-103123-604_L1C_049-262-2_D_V1-0.zip
2024-01-09T14:51:37.115    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:51:37.115    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:51:37.115    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:51:37.115    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:51:37.115    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:51:37.115    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:51:37.115    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:51:37.116    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090505-103123-604_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/05/05/SPOT4-HRVIR2-XS_20090505-103051-386_L1C_050-258-4_D_V1-0/SPOT4-HRVIR2-XS_20090505-103051-386_L1C_050-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090505-103051-386_L1C_050-258-4_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090505-103051-386_L1C_050-258-4_D_V1-0.zip
run script
2024-01-09T14:51:40.336    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:51:40.337    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090505-103051-386_L1C_050-258-4_D_V1-0.zip
2024-01-09T14:51:40.337    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:51:40.337    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:51:40.337    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:51:40.337    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:51:40.337    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:51:40.337    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:51:40.337    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:51:40.337    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090505-103051-386_L1C_050-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/21/SPOT4-HRVIR2-XS_20090621-102658-867_L1C_049-261-9_D_V1-0/SPOT4-HRVIR2-XS_20090621-102658-867_L1C_049-261-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090621-102658-867_L1C_049-261-9_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090621-102658-867_L1C_049-261-9_D_V1-0.zip
run script
2024-01-09T14:53:05.712    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:53:05.714    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090621-102658-867_L1C_049-261-9_D_V1-0.zip
2024-01-09T14:53:05.714    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:53:05.714    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:53:05.714    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:53:05.714    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:53:05.714    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:53:05.714    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:53:05.714    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:53:05.714    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090621-102658-867_L1C_049-261-9_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/06/21/SPOT4-HRVIR2-XS_20090621-102659-038_L1C_049-262-0_D_V1-0/SPOT4-HRVIR2-XS_20090621-102659-038_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090621-102659-038_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090621-102659-038_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T14:53:09.278    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:53:09.278    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090621-102659-038_L1C_049-262-0_D_V1-0.zip
2024-01-09T14:53:09.278    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:53:09.278    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:53:09.278    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:53:09.278    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:53:09.279    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:53:09.279    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:53:09.279    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:53:09.279    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090621-102659-038_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/06/21/SPOT4-HRVIR2-XS_20090621-102701-745_L1C_049-262-3_D_V1-0/SPOT4-HRVIR2-XS_20090621-102701-745_L1C_049-262-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090621-102701-745_L1C_049-262-3_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090621-102701-745_L1C_049-262-3_D_V1-0.zip
run script
2024-01-09T14:53:12.486    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:53:12.489    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090621-102701-745_L1C_049-262-3_D_V1-0.zip
2024-01-09T14:53:12.489    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:53:12.489    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:53:12.490    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:53:12.490    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:53:12.490    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:53:12.490    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:53:12.490    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:53:12.490    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090621-102701-745_L1C_049-262-3_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/07/17/SPOT4-HRVIR1-XS_20090717-102637-699_L1C_049-261-7_D_V1-0/SPOT4-HRVIR1-XS_20090717-102637-699_L1C_049-261-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090717-102637-699_L1C_049-261-7_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090717-102637-699_L1C_049-261-7_D_V1-0.zip
run script
2024-01-09T14:53:16.046    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:53:16.047    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090717-102637-699_L1C_049-261-7_D_V1-0.zip
2024-01-09T14:53:16.047    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:53:16.047    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:53:16.048    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:53:16.048    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:53:16.048    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:53:16.048    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:53:16.048    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:53:16.048    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090717-102637-699_L1C_049-261-7_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/07/17/SPOT4-HRVIR1-XS_20090717-102639-669_L1C_049-262-0_D_V1-0/SPOT4-HRVIR1-XS_20090717-102639-669_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090717-102639-669_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090717-102639-669_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T14:53:19.548    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:53:19.550    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090717-102639-669_L1C_049-262-0_D_V1-0.zip
2024-01-09T14:53:19.550    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:53:19.550    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:53:19.550    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:53:19.550    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:53:19.550    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:53:19.550    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:53:19.550    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:53:19.550    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090717-102639-669_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/07/22/SPOT4-HRVIR2-XS_20090722-103027-664_L1C_049-261-8_D_V1-0/SPOT4-HRVIR2-XS_20090722-103027-664_L1C_049-261-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090722-103027-664_L1C_049-261-8_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090722-103027-664_L1C_049-261-8_D_V1-0.zip
run script
2024-01-09T14:53:23.470    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:53:23.471    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090722-103027-664_L1C_049-261-8_D_V1-0.zip
2024-01-09T14:53:23.472    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:53:23.472    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:53:23.472    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:53:23.472    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:53:23.472    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:53:23.472    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:53:23.472    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:53:23.472    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090722-103027-664_L1C_049-261-8_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/07/22/SPOT4-HRVIR2-XS_20090722-103028-752_L1C_049-262-0_D_V1-0/SPOT4-HRVIR2-XS_20090722-103028-752_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090722-103028-752_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090722-103028-752_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T14:53:26.916    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:53:26.917    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090722-103028-752_L1C_049-262-0_D_V1-0.zip
2024-01-09T14:53:26.917    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:53:26.917    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:53:26.917    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:53:26.917    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:53:26.917    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:53:26.917    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:53:26.917    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:53:26.918    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090722-103028-752_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/07/22/SPOT4-HRVIR2-XS_20090722-103030-561_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20090722-103030-561_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090722-103030-561_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090722-103030-561_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T14:53:30.365    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:53:30.366    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090722-103030-561_L1C_049-262-2_D_V1-0.zip
2024-01-09T14:53:30.366    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:53:30.366    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:53:30.367    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:53:30.367    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:53:30.367    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:53:30.367    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:53:30.367    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:53:30.367    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090722-103030-561_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/08/12/SPOT4-HRVIR2-XS_20090812-102623-997_L1C_049-261-7_D_V1-0/SPOT4-HRVIR2-XS_20090812-102623-997_L1C_049-261-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090812-102623-997_L1C_049-261-7_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090812-102623-997_L1C_049-261-7_D_V1-0.zip
run script
2024-01-09T14:53:34.246    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:53:34.247    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090812-102623-997_L1C_049-261-7_D_V1-0.zip
2024-01-09T14:53:34.247    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:53:34.247    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:53:34.247    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:53:34.247    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:53:34.247    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:53:34.248    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:53:34.248    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:53:34.248    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090812-102623-997_L1C_049-261-7_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/08/12/SPOT4-HRVIR2-XS_20090812-102625-973_L1C_049-262-0_D_V1-0/SPOT4-HRVIR2-XS_20090812-102625-973_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090812-102625-973_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090812-102625-973_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T14:53:37.790    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:53:37.790    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090812-102625-973_L1C_049-262-0_D_V1-0.zip
2024-01-09T14:53:37.790    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:53:37.790    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:53:37.790    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:53:37.790    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:53:37.791    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:53:37.791    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:53:37.791    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:53:37.791    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090812-102625-973_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/08/12/SPOT4-HRVIR2-XS_20090812-102627-778_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20090812-102627-778_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090812-102627-778_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090812-102627-778_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T14:53:41.399    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:53:41.400    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090812-102627-778_L1C_049-262-2_D_V1-0.zip
2024-01-09T14:53:41.400    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:53:41.400    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:53:41.400    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:53:41.400    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:53:41.400    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:53:41.401    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:53:41.401    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:53:41.401    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090812-102627-778_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/08/12/SPOT4-HRVIR1-XS_20090812-102556-630_L1C_053-259-0_D_V1-0/SPOT4-HRVIR1-XS_20090812-102556-630_L1C_053-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090812-102556-630_L1C_053-259-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090812-102556-630_L1C_053-259-0_D_V1-0.zip
run script
2024-01-09T14:53:44.913    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:53:44.914    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090812-102556-630_L1C_053-259-0_D_V1-0.zip
2024-01-09T14:53:44.914    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:53:44.914    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:53:44.914    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:53:44.914    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:53:44.914    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:53:44.914    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:53:44.914    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:53:44.914    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T14:53:47.419    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (354 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090812-102556-630_L1C_053-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2009/08/12/SPOT4-HRVIR1-XS_20090812-102604-944_L1C_053-260-0_D_V1-0/SPOT4-HRVIR1-XS_20090812-102604-944_L1C_053-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090812-102604-944_L1C_053-260-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090812-102604-944_L1C_053-260-0_D_V1-0.zip
run script
2024-01-09T14:53:50.975    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:53:50.976    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090812-102604-944_L1C_053-260-0_D_V1-0.zip
2024-01-09T14:53:50.976    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:53:50.976    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:53:50.976    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:53:50.976    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:53:50.976    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:53:50.976    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:53:50.977    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:53:50.977    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090812-102604-944_L1C_053-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/12/SPOT4-HRVIR1-XS_20090812-102613-264_L1C_053-261-0_D_V1-0/SPOT4-HRVIR1-XS_20090812-102613-264_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090812-102613-264_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090812-102613-264_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T14:55:56.284    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:55:56.285    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090812-102613-264_L1C_053-261-0_D_V1-0.zip
2024-01-09T14:55:56.285    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:55:56.285    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:55:56.285    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:55:56.285    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:55:56.285    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:55:56.285    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:55:56.285    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:55:56.285    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090812-102613-264_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/27/SPOT4-HRVIR2-XS_20090827-103752-505_L1C_049-261-9_D_V1-0/SPOT4-HRVIR2-XS_20090827-103752-505_L1C_049-261-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090827-103752-505_L1C_049-261-9_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090827-103752-505_L1C_049-261-9_D_V1-0.zip
run script
2024-01-09T14:58:39.203    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:58:39.204    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090827-103752-505_L1C_049-261-9_D_V1-0.zip
2024-01-09T14:58:39.204    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:58:39.204    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:58:39.204    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:58:39.204    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:58:39.204    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:58:39.204    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:58:39.204    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:58:39.204    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090827-103752-505_L1C_049-261-9_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/08/27/SPOT4-HRVIR2-XS_20090827-103752-737_L1C_049-262-0_D_V1-0/SPOT4-HRVIR2-XS_20090827-103752-737_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090827-103752-737_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090827-103752-737_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T14:58:43.141    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:58:43.142    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090827-103752-737_L1C_049-262-0_D_V1-0.zip
2024-01-09T14:58:43.142    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:58:43.142    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:58:43.142    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:58:43.142    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:58:43.142    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:58:43.142    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:58:43.142    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:58:43.142    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090827-103752-737_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/08/27/SPOT4-HRVIR2-XS_20090827-103722-768_L1C_053-259-0_D_V1-0/SPOT4-HRVIR2-XS_20090827-103722-768_L1C_053-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090827-103722-768_L1C_053-259-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090827-103722-768_L1C_053-259-0_D_V1-0.zip
run script
2024-01-09T14:58:46.872    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:58:46.873    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090827-103722-768_L1C_053-259-0_D_V1-0.zip
2024-01-09T14:58:46.874    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:58:46.874    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:58:46.874    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:58:46.874    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:58:46.874    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:58:46.874    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:58:46.874    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:58:46.874    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090827-103722-768_L1C_053-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/27/SPOT4-HRVIR2-XS_20090827-103723-671_L1C_053-259-1_D_V1-0/SPOT4-HRVIR2-XS_20090827-103723-671_L1C_053-259-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090827-103723-671_L1C_053-259-1_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090827-103723-671_L1C_053-259-1_D_V1-0.zip
run script
2024-01-09T15:02:13.626    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:02:13.627    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090827-103723-671_L1C_053-259-1_D_V1-0.zip
2024-01-09T15:02:13.627    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:02:13.627    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:02:13.627    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:02:13.627    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:02:13.628    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:02:13.628    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:02:13.628    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:02:13.628    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090827-103723-671_L1C_053-259-1_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/09/01/SPOT4-HRVIR2-XS_20090901-104137-544_L1C_049-261-5_D_V1-0/SPOT4-HRVIR2-XS_20090901-104137-544_L1C_049-261-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090901-104137-544_L1C_049-261-5_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090901-104137-544_L1C_049-261-5_D_V1-0.zip
run script
2024-01-09T15:04:49.147    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:04:49.149    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090901-104137-544_L1C_049-261-5_D_V1-0.zip
2024-01-09T15:04:49.149    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:04:49.149    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:04:49.149    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:04:49.149    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:04:49.149    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:04:49.149    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:04:49.149    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:04:49.149    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090901-104137-544_L1C_049-261-5_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/09/01/SPOT4-HRVIR2-XS_20090901-104141-407_L1C_049-262-0_D_V1-0/SPOT4-HRVIR2-XS_20090901-104141-407_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090901-104141-407_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090901-104141-407_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T15:04:52.632    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:04:52.632    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090901-104141-407_L1C_049-262-0_D_V1-0.zip
2024-01-09T15:04:52.632    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:04:52.632    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:04:52.632    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:04:52.632    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:04:52.632    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:04:52.632    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:04:52.632    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:04:52.632    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090901-104141-407_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/09/07/SPOT4-HRVIR1-XS_20090907-102610-983_L1C_049-261-9_D_V1-0/SPOT4-HRVIR1-XS_20090907-102610-983_L1C_049-261-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090907-102610-983_L1C_049-261-9_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090907-102610-983_L1C_049-261-9_D_V1-0.zip
run script
2024-01-09T15:04:56.577    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:04:56.578    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090907-102610-983_L1C_049-261-9_D_V1-0.zip
2024-01-09T15:04:56.578    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:04:56.578    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:04:56.578    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:04:56.578    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:04:56.578    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:04:56.579    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:04:56.579    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:04:56.579    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090907-102610-983_L1C_049-261-9_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/09/07/SPOT4-HRVIR1-XS_20090907-102611-152_L1C_049-262-0_D_V1-0/SPOT4-HRVIR1-XS_20090907-102611-152_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090907-102611-152_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090907-102611-152_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T15:05:00.587    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:05:00.588    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090907-102611-152_L1C_049-262-0_D_V1-0.zip
2024-01-09T15:05:00.588    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:05:00.588    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:05:00.588    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:05:00.588    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:05:00.588    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:05:00.588    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:05:00.588    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:05:00.588    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090907-102611-152_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/09/07/SPOT4-HRVIR2-XS_20090907-102610-736_L1C_049-262-0_D_V1-0/SPOT4-HRVIR2-XS_20090907-102610-736_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090907-102610-736_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090907-102610-736_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T15:05:04.317    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:05:04.318    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090907-102610-736_L1C_049-262-0_D_V1-0.zip
2024-01-09T15:05:04.318    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:05:04.318    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:05:04.318    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:05:04.318    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:05:04.318    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:05:04.318    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:05:04.318    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:05:04.318    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090907-102610-736_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/09/07/SPOT4-HRVIR2-XS_20090907-102518-974_L1C_050-255-8_D_V1-0/SPOT4-HRVIR2-XS_20090907-102518-974_L1C_050-255-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090907-102518-974_L1C_050-255-8_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090907-102518-974_L1C_050-255-8_D_V1-0.zip
run script
2024-01-09T15:05:09.081    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:05:09.082    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090907-102518-974_L1C_050-255-8_D_V1-0.zip
2024-01-09T15:05:09.082    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:05:09.082    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:05:09.082    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:05:09.082    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:05:09.083    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:05:09.083    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:05:09.083    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:05:09.083    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090907-102518-974_L1C_050-255-8_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/09/07/SPOT4-HRVIR2-XS_20090907-102520-006_L1C_050-256-0_D_V1-0/SPOT4-HRVIR2-XS_20090907-102520-006_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090907-102520-006_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090907-102520-006_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T15:07:29.054    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:07:29.054    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090907-102520-006_L1C_050-256-0_D_V1-0.zip
2024-01-09T15:07:29.054    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:07:29.054    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:07:29.054    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:07:29.054    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:07:29.054    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:07:29.054    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:07:29.054    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:07:29.054    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090907-102520-006_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/09/07/SPOT4-HRVIR2-XS_20090907-102528-266_L1C_050-257-0_D_V1-0/SPOT4-HRVIR2-XS_20090907-102528-266_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090907-102528-266_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090907-102528-266_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T15:10:05.541    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:10:05.542    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090907-102528-266_L1C_050-257-0_D_V1-0.zip
2024-01-09T15:10:05.542    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:10:05.543    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:10:05.543    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:10:05.543    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:10:05.543    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:10:05.543    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:10:05.543    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:10:05.543    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090907-102528-266_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/09/07/SPOT4-HRVIR2-XS_20090907-102544-658_L1C_050-258-9_D_V1-0/SPOT4-HRVIR2-XS_20090907-102544-658_L1C_050-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090907-102544-658_L1C_050-258-9_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090907-102544-658_L1C_050-258-9_D_V1-0.zip
run script
2024-01-09T15:12:34.032    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:12:34.033    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090907-102544-658_L1C_050-258-9_D_V1-0.zip
2024-01-09T15:12:34.033    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:12:34.033    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:12:34.033    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:12:34.033    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:12:34.033    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:12:34.033    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:12:34.033    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:12:34.033    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090907-102544-658_L1C_050-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 0 ... 2 2 2]
 [2 2 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/09/07/SPOT4-HRVIR2-XS_20090907-102544-812_L1C_050-259-0_D_V1-0/SPOT4-HRVIR2-XS_20090907-102544-812_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090907-102544-812_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090907-102544-812_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T15:14:12.346    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:14:12.347    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090907-102544-812_L1C_050-259-0_D_V1-0.zip
2024-01-09T15:14:12.347    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:14:12.347    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:14:12.347    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:14:12.347    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:14:12.348    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:14:12.348    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:14:12.348    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:14:12.348    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090907-102544-812_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/09/07/SPOT4-HRVIR2-XS_20090907-102545-714_L1C_050-259-1_D_V1-0/SPOT4-HRVIR2-XS_20090907-102545-714_L1C_050-259-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090907-102545-714_L1C_050-259-1_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090907-102545-714_L1C_050-259-1_D_V1-0.zip
run script
2024-01-09T15:15:55.136    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:15:55.137    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090907-102545-714_L1C_050-259-1_D_V1-0.zip
2024-01-09T15:15:55.137    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:15:55.137    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:15:55.137    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:15:55.137    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:15:55.137    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:15:55.137    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:15:55.137    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:15:55.137    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090907-102545-714_L1C_050-259-1_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/09/07/SPOT4-HRVIR2-XS_20090907-102502-100_L1C_051-254-0_D_V1-0/SPOT4-HRVIR2-XS_20090907-102502-100_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090907-102502-100_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090907-102502-100_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T15:17:31.025    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:17:31.026    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090907-102502-100_L1C_051-254-0_D_V1-0.zip
2024-01-09T15:17:31.026    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:17:31.026    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:17:31.026    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:17:31.026    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:17:31.026    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:17:31.026    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:17:31.026    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:17:31.026    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090907-102502-100_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/09/23/SPOT4-HRVIR2-XS_20090923-101813-146_L1C_049-261-6_D_V1-0/SPOT4-HRVIR2-XS_20090923-101813-146_L1C_049-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090923-101813-146_L1C_049-261-6_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090923-101813-146_L1C_049-261-6_D_V1-0.zip
run script
2024-01-09T15:17:34.790    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:17:34.791    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090923-101813-146_L1C_049-261-6_D_V1-0.zip
2024-01-09T15:17:34.791    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:17:34.791    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:17:34.791    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:17:34.791    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:17:34.791    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:17:34.791    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:17:34.791    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:17:34.791    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090923-101813-146_L1C_049-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/09/23/SPOT4-HRVIR2-XS_20090923-101815-997_L1C_049-262-0_D_V1-0/SPOT4-HRVIR2-XS_20090923-101815-997_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090923-101815-997_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090923-101815-997_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T15:17:38.383    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:17:38.384    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090923-101815-997_L1C_049-262-0_D_V1-0.zip
2024-01-09T15:17:38.384    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:17:38.384    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:17:38.384    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:17:38.384    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:17:38.384    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:17:38.384    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:17:38.384    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:17:38.384    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090923-101815-997_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/09/23/SPOT4-HRVIR2-XS_20090923-101817-802_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20090923-101817-802_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090923-101817-802_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090923-101817-802_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T15:17:42.041    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:17:42.044    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090923-101817-802_L1C_049-262-2_D_V1-0.zip
2024-01-09T15:17:42.044    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:17:42.044    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:17:42.044    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:17:42.044    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:17:42.044    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:17:42.044    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:17:42.044    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:17:42.044    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090923-101817-802_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/09/23/SPOT4-HRVIR1-XS_20090923-101813-438_L1C_051-261-9_D_V1-0/SPOT4-HRVIR1-XS_20090923-101813-438_L1C_051-261-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090923-101813-438_L1C_051-261-9_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090923-101813-438_L1C_051-261-9_D_V1-0.zip
run script
2024-01-09T15:17:45.595    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:17:45.597    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090923-101813-438_L1C_051-261-9_D_V1-0.zip
2024-01-09T15:17:45.597    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:17:45.597    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:17:45.597    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:17:45.597    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:17:45.597    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:17:45.597    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:17:45.597    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:17:45.597    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090923-101813-438_L1C_051-261-9_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/09/23/SPOT4-HRVIR1-XS_20090923-101813-597_L1C_051-262-0_D_V1-0/SPOT4-HRVIR1-XS_20090923-101813-597_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090923-101813-597_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090923-101813-597_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T15:19:39.666    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:19:39.667    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090923-101813-597_L1C_051-262-0_D_V1-0.zip
2024-01-09T15:19:39.667    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:19:39.667    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:19:39.668    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:19:39.668    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:19:39.668    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:19:39.668    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:19:39.668    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:19:39.668    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090923-101813-597_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/09/23/SPOT4-HRVIR1-XS_20090923-101817-207_L1C_051-262-4_D_V1-0/SPOT4-HRVIR1-XS_20090923-101817-207_L1C_051-262-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090923-101817-207_L1C_051-262-4_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090923-101817-207_L1C_051-262-4_D_V1-0.zip
run script
2024-01-09T15:21:34.513    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:21:34.514    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090923-101817-207_L1C_051-262-4_D_V1-0.zip
2024-01-09T15:21:34.514    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:21:34.514    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:21:34.515    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:21:34.515    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:21:34.515    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:21:34.515    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:21:34.515    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:21:34.515    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090923-101817-207_L1C_051-262-4_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/10/12/SPOT4-HRVIR2-XS_20091012-105235-521_L1C_049-261-9_D_V1-0/SPOT4-HRVIR2-XS_20091012-105235-521_L1C_049-261-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20091012-105235-521_L1C_049-261-9_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091012-105235-521_L1C_049-261-9_D_V1-0.zip
run script
2024-01-09T15:23:04.067    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:23:04.068    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091012-105235-521_L1C_049-261-9_D_V1-0.zip
2024-01-09T15:23:04.069    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:23:04.069    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:23:04.069    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:23:04.069    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:23:04.069    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:23:04.069    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:23:04.069    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:23:04.069    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091012-105235-521_L1C_049-261-9_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/10/12/SPOT4-HRVIR2-XS_20091012-105235-858_L1C_049-262-0_D_V1-0/SPOT4-HRVIR2-XS_20091012-105235-858_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20091012-105235-858_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091012-105235-858_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T15:23:07.561    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:23:07.562    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091012-105235-858_L1C_049-262-0_D_V1-0.zip
2024-01-09T15:23:07.562    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:23:07.562    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:23:07.562    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:23:07.562    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:23:07.562    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:23:07.562    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:23:07.562    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:23:07.562    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091012-105235-858_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/10/12/SPOT4-HRVIR2-XS_20091012-105236-760_L1C_049-262-1_D_V1-0/SPOT4-HRVIR2-XS_20091012-105236-760_L1C_049-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20091012-105236-760_L1C_049-262-1_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091012-105236-760_L1C_049-262-1_D_V1-0.zip
run script
2024-01-09T15:23:11.100    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:23:11.101    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091012-105236-760_L1C_049-262-1_D_V1-0.zip
2024-01-09T15:23:11.101    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:23:11.101    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:23:11.101    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:23:11.102    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:23:11.102    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:23:11.102    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:23:11.102    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:23:11.102    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091012-105236-760_L1C_049-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/03/13/SPOT4-HRVIR1-XS_20090313-105104-456_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20090313-105104-456_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090313-105104-456_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090313-105104-456_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T15:23:14.675    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:23:14.676    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090313-105104-456_L1C_049-262-2_D_V1-0.zip
2024-01-09T15:23:14.676    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:23:14.676    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:23:14.676    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:23:14.676    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:23:14.676    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:23:14.676    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:23:14.676    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:23:14.676    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090313-105104-456_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/05/25/SPOT4-HRVIR1-XS_20090525-104636-188_L1C_049-262-0_D_V1-0/SPOT4-HRVIR1-XS_20090525-104636-188_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090525-104636-188_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090525-104636-188_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T15:23:18.027    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:23:18.028    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090525-104636-188_L1C_049-262-0_D_V1-0.zip
2024-01-09T15:23:18.028    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:23:18.028    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:23:18.028    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:23:18.028    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:23:18.028    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:23:18.028    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:23:18.028    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:23:18.028    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090525-104636-188_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/05/25/SPOT4-HRVIR1-XS_20090525-104637-993_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20090525-104637-993_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090525-104637-993_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090525-104637-993_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T15:23:21.732    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:23:21.733    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090525-104637-993_L1C_049-262-2_D_V1-0.zip
2024-01-09T15:23:21.733    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:23:21.733    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:23:21.733    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:23:21.733    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:23:21.734    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:23:21.734    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:23:21.734    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:23:21.734    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090525-104637-993_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/05/25/SPOT4-HRVIR1-XS_20090525-104617-356_L1C_054-260-6_D_V1-0/SPOT4-HRVIR1-XS_20090525-104617-356_L1C_054-260-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090525-104617-356_L1C_054-260-6_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090525-104617-356_L1C_054-260-6_D_V1-0.zip
run script
2024-01-09T15:23:25.323    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:23:25.325    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090525-104617-356_L1C_054-260-6_D_V1-0.zip
2024-01-09T15:23:25.325    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:23:25.325    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:23:25.325    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:23:25.325    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:23:25.325    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:23:25.325    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:23:25.325    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:23:25.325    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090525-104617-356_L1C_054-260-6_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 1 1 ... 1 1 1]
 [1 1 1 ... 0 0 1]
 [1 1 2 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/05/25/SPOT4-HRVIR1-XS_20090525-104621-321_L1C_054-261-1_D_V1-0/SPOT4-HRVIR1-XS_20090525-104621-321_L1C_054-261-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090525-104621-321_L1C_054-261-1_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090525-104621-321_L1C_054-261-1_D_V1-0.zip
run script
2024-01-09T15:25:26.914    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:25:26.915    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090525-104621-321_L1C_054-261-1_D_V1-0.zip
2024-01-09T15:25:26.915    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:25:26.915    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:25:26.915    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:25:26.915    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:25:26.915    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:25:26.915    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:25:26.915    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:25:26.915    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090525-104621-321_L1C_054-261-1_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 1]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 1 0 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/05/26/SPOT4-HRVIR2-XS_20090526-102717-272_L1C_049-262-0_D_V1-0/SPOT4-HRVIR2-XS_20090526-102717-272_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090526-102717-272_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090526-102717-272_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T15:27:40.796    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:27:40.797    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090526-102717-272_L1C_049-262-0_D_V1-0.zip
2024-01-09T15:27:40.798    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:27:40.798    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:27:40.798    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:27:40.798    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:27:40.798    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:27:40.798    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:27:40.798    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:27:40.798    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090526-102717-272_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/05/26/SPOT4-HRVIR2-XS_20090526-102719-077_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20090526-102719-077_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090526-102719-077_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090526-102719-077_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T15:27:44.131    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:27:44.133    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090526-102719-077_L1C_049-262-2_D_V1-0.zip
2024-01-09T15:27:44.133    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:27:44.133    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:27:44.133    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:27:44.133    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:27:44.133    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:27:44.133    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:27:44.133    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:27:44.133    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090526-102719-077_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/06/20/SPOT4-HRVIR1-XS_20090620-104619-875_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20090620-104619-875_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090620-104619-875_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090620-104619-875_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T15:27:47.511    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:27:47.513    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090620-104619-875_L1C_049-262-2_D_V1-0.zip
2024-01-09T15:27:47.513    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:27:47.513    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:27:47.513    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:27:47.513    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:27:47.513    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:27:47.513    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:27:47.513    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:27:47.513    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090620-104619-875_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/08/21/SPOT4-HRVIR2-XS_20090821-105323-133_L1C_049-262-1_D_V1-0/SPOT4-HRVIR2-XS_20090821-105323-133_L1C_049-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090821-105323-133_L1C_049-262-1_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090821-105323-133_L1C_049-262-1_D_V1-0.zip
run script
2024-01-09T15:27:50.954    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:27:50.956    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090821-105323-133_L1C_049-262-1_D_V1-0.zip
2024-01-09T15:27:50.956    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:27:50.956    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:27:50.956    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:27:50.956    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:27:50.956    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:27:50.956    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:27:50.956    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:27:50.956    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090821-105323-133_L1C_049-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/08/21/SPOT4-HRVIR2-XS_20090821-105255-019_L1C_050-259-0_D_V1-0/SPOT4-HRVIR2-XS_20090821-105255-019_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090821-105255-019_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090821-105255-019_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T15:27:54.380    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:27:54.382    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090821-105255-019_L1C_050-259-0_D_V1-0.zip
2024-01-09T15:27:54.382    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:27:54.382    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:27:54.382    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:27:54.382    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:27:54.382    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:27:54.382    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:27:54.382    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:27:54.383    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090821-105255-019_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/10/02/SPOT4-HRVIR1-XS_20091002-104511-191_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20091002-104511-191_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20091002-104511-191_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091002-104511-191_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T15:30:16.783    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:30:16.783    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091002-104511-191_L1C_049-262-2_D_V1-0.zip
2024-01-09T15:30:16.783    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:30:16.783    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:30:16.784    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:30:16.784    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:30:16.784    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:30:16.784    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:30:16.784    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:30:16.784    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091002-104511-191_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/10/03/SPOT4-HRVIR1-XS_20091003-102551-705_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20091003-102551-705_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20091003-102551-705_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091003-102551-705_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T15:30:20.081    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:30:20.081    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091003-102551-705_L1C_049-262-2_D_V1-0.zip
2024-01-09T15:30:20.081    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:30:20.081    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:30:20.081    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:30:20.081    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:30:20.081    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:30:20.082    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:30:20.082    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:30:20.082    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20091003-102551-705_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/10/03/SPOT4-HRVIR2-XS_20091003-102551-290_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20091003-102551-290_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20091003-102551-290_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091003-102551-290_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T15:30:23.386    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:30:23.390    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091003-102551-290_L1C_049-262-2_D_V1-0.zip
2024-01-09T15:30:23.391    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:30:23.400    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:30:23.400    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:30:23.400    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:30:23.400    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:30:23.400    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:30:23.400    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:30:23.401    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20091003-102551-290_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/07/11/SPOT4-HRVIR1-XS_20090711-104103-342_L1C_050-254-1_D_V1-0/SPOT4-HRVIR1-XS_20090711-104103-342_L1C_050-254-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090711-104103-342_L1C_050-254-1_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090711-104103-342_L1C_050-254-1_D_V1-0.zip
run script
2024-01-09T15:30:26.825    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:30:26.829    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090711-104103-342_L1C_050-254-1_D_V1-0.zip
2024-01-09T15:30:26.829    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:30:26.829    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:30:26.829    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:30:26.829    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:30:26.829    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:30:26.829    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:30:26.830    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:30:26.830    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090711-104103-342_L1C_050-254-1_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/01/25/SPOT4-HRVIR1-XS_20090125-105413-766_L1C_050-255-9_D_V1-0/SPOT4-HRVIR1-XS_20090125-105413-766_L1C_050-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090125-105413-766_L1C_050-255-9_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090125-105413-766_L1C_050-255-9_D_V1-0.zip
run script
2024-01-09T15:30:30.137    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:30:30.138    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090125-105413-766_L1C_050-255-9_D_V1-0.zip
2024-01-09T15:30:30.138    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:30:30.138    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:30:30.139    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:30:30.139    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:30:30.139    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:30:30.139    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:30:30.139    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:30:30.139    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090125-105413-766_L1C_050-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/01/25/SPOT4-HRVIR1-XS_20090125-105355-136_L1C_051-254-0_D_V1-0/SPOT4-HRVIR1-XS_20090125-105355-136_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090125-105355-136_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090125-105355-136_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T15:34:12.592    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:34:12.593    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090125-105355-136_L1C_051-254-0_D_V1-0.zip
2024-01-09T15:34:12.593    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:34:12.594    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:34:12.594    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:34:12.594    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:34:12.594    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:34:12.594    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:34:12.594    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:34:12.594    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090125-105355-136_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/07/23/SPOT4-HRVIR1-XS_20090723-101014-030_L1C_050-255-6_D_V1-0/SPOT4-HRVIR1-XS_20090723-101014-030_L1C_050-255-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090723-101014-030_L1C_050-255-6_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090723-101014-030_L1C_050-255-6_D_V1-0.zip
run script
2024-01-09T15:34:15.747    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:34:15.748    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090723-101014-030_L1C_050-255-6_D_V1-0.zip
2024-01-09T15:34:15.748    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:34:15.748    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:34:15.748    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:34:15.749    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:34:15.749    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:34:15.749    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:34:15.749    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:34:15.749    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090723-101014-030_L1C_050-255-6_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/07/23/SPOT4-HRVIR1-XS_20090723-101016-805_L1C_050-256-0_D_V1-0/SPOT4-HRVIR1-XS_20090723-101016-805_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090723-101016-805_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090723-101016-805_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T15:36:40.947    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:36:40.948    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090723-101016-805_L1C_050-256-0_D_V1-0.zip
2024-01-09T15:36:40.948    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:36:40.948    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:36:40.948    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:36:40.948    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:36:40.948    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:36:40.948    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:36:40.948    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:36:40.948    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090723-101016-805_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/07/23/SPOT4-HRVIR1-XS_20090723-101025-015_L1C_050-257-0_D_V1-0/SPOT4-HRVIR1-XS_20090723-101025-015_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090723-101025-015_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090723-101025-015_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T15:39:54.477    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:39:54.479    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090723-101025-015_L1C_050-257-0_D_V1-0.zip
2024-01-09T15:39:54.479    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:39:54.479    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:39:54.479    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:39:54.479    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:39:54.479    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:39:54.479    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:39:54.479    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:39:54.479    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090723-101025-015_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/06/SPOT4-HRVIR2-XS_20090606-101442-629_L1C_050-256-0_D_V1-0/SPOT4-HRVIR2-XS_20090606-101442-629_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090606-101442-629_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090606-101442-629_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T15:43:08.213    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:43:08.214    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090606-101442-629_L1C_050-256-0_D_V1-0.zip
2024-01-09T15:43:08.214    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:43:08.214    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:43:08.214    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:43:08.214    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:43:08.214    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:43:08.215    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:43:08.215    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:43:08.215    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090606-101442-629_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/06/SPOT4-HRVIR2-XS_20090606-101448-043_L1C_050-256-6_D_V1-0/SPOT4-HRVIR2-XS_20090606-101448-043_L1C_050-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090606-101448-043_L1C_050-256-6_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090606-101448-043_L1C_050-256-6_D_V1-0.zip
run script
2024-01-09T15:46:17.126    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:46:17.127    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090606-101448-043_L1C_050-256-6_D_V1-0.zip
2024-01-09T15:46:17.127    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:46:17.127    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:46:17.127    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:46:17.127    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:46:17.127    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:46:17.127    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:46:17.128    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:46:17.128    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090606-101448-043_L1C_050-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/06/SPOT4-HRVIR2-XS_20090606-101502-302_L1C_050-258-3_D_V1-0/SPOT4-HRVIR2-XS_20090606-101502-302_L1C_050-258-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090606-101502-302_L1C_050-258-3_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090606-101502-302_L1C_050-258-3_D_V1-0.zip
run script
2024-01-09T15:49:27.261    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:49:27.263    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090606-101502-302_L1C_050-258-3_D_V1-0.zip
2024-01-09T15:49:27.263    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:49:27.263    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:49:27.263    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:49:27.263    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:49:27.263    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:49:27.263    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:49:27.263    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:49:27.263    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T15:49:28.905    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 1666). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090606-101502-302_L1C_050-258-3_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2009/09/17/SPOT4-HRVIR1-XS_20090917-103304-030_L1C_050-256-8_D_V1-0/SPOT4-HRVIR1-XS_20090917-103304-030_L1C_050-256-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090917-103304-030_L1C_050-256-8_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090917-103304-030_L1C_050-256-8_D_V1-0.zip
run script
2024-01-09T15:49:32.264    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:49:32.265    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090917-103304-030_L1C_050-256-8_D_V1-0.zip
2024-01-09T15:49:32.265    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:49:32.265    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:49:32.265    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:49:32.265    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:49:32.265    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:49:32.266    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:49:32.266    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:49:32.266    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090917-103304-030_L1C_050-256-8_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/09/17/SPOT4-HRVIR1-XS_20090917-103305-116_L1C_050-257-0_D_V1-0/SPOT4-HRVIR1-XS_20090917-103305-116_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090917-103305-116_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090917-103305-116_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T15:52:06.940    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:52:06.942    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090917-103305-116_L1C_050-257-0_D_V1-0.zip
2024-01-09T15:52:06.942    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:52:06.942    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:52:06.942    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:52:06.942    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:52:06.942    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:52:06.942    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:52:06.942    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:52:06.942    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090917-103305-116_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/09/28/SPOT4-HRVIR1-XS_20090928-102118-380_L1C_050-256-5_D_V1-0/SPOT4-HRVIR1-XS_20090928-102118-380_L1C_050-256-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090928-102118-380_L1C_050-256-5_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090928-102118-380_L1C_050-256-5_D_V1-0.zip
run script
2024-01-09T15:54:48.913    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:54:48.914    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090928-102118-380_L1C_050-256-5_D_V1-0.zip
2024-01-09T15:54:48.914    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:54:48.914    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:54:48.914    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:54:48.914    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:54:48.914    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:54:48.914    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:54:48.914    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:54:48.915    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T15:56:37.045    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 198). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090928-102118-380_L1C_050-256-5_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/09/28/SPOT4-HRVIR1-XS_20090928-102122-113_L1C_050-257-0_D_V1-0/SPOT4-HRVIR1-XS_20090928-102122-113_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090928-102122-113_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090928-102122-113_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T15:56:40.407    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:56:40.408    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090928-102122-113_L1C_050-257-0_D_V1-0.zip
2024-01-09T15:56:40.408    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:56:40.408    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:56:40.409    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:56:40.409    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:56:40.409    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:56:40.409    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:56:40.409    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:56:40.409    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090928-102122-113_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/09/28/SPOT4-HRVIR1-XS_20090928-102203-555_L1C_050-261-9_D_V1-0/SPOT4-HRVIR1-XS_20090928-102203-555_L1C_050-261-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090928-102203-555_L1C_050-261-9_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090928-102203-555_L1C_050-261-9_D_V1-0.zip
run script
2024-01-09T15:59:23.434    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:59:23.435    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090928-102203-555_L1C_050-261-9_D_V1-0.zip
2024-01-09T15:59:23.435    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:59:23.435    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:59:23.435    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:59:23.435    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:59:23.435    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:59:23.435    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:59:23.435    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:59:23.435    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090928-102203-555_L1C_050-261-9_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/09/28/SPOT4-HRVIR1-XS_20090928-102203-717_L1C_050-262-0_D_V1-0/SPOT4-HRVIR1-XS_20090928-102203-717_L1C_050-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090928-102203-717_L1C_050-262-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090928-102203-717_L1C_050-262-0_D_V1-0.zip
run script
2024-01-09T16:00:03.108    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:00:03.109    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090928-102203-717_L1C_050-262-0_D_V1-0.zip
2024-01-09T16:00:03.110    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:00:03.110    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:00:03.110    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:00:03.110    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:00:03.110    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:00:03.110    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:00:03.110    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:00:03.110    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090928-102203-717_L1C_050-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/09/28/SPOT4-HRVIR1-XS_20090928-102208-229_L1C_050-262-5_D_V1-0/SPOT4-HRVIR1-XS_20090928-102208-229_L1C_050-262-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090928-102208-229_L1C_050-262-5_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090928-102208-229_L1C_050-262-5_D_V1-0.zip
run script
2024-01-09T16:00:45.267    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:00:45.268    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090928-102208-229_L1C_050-262-5_D_V1-0.zip
2024-01-09T16:00:45.268    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:00:45.268    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:00:45.268    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:00:45.268    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:00:45.268    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:00:45.268    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:00:45.269    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:00:45.269    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090928-102208-229_L1C_050-262-5_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/04/25/SPOT4-HRVIR2-XS_20090425-102308-966_L1C_050-257-9_D_V1-0/SPOT4-HRVIR2-XS_20090425-102308-966_L1C_050-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090425-102308-966_L1C_050-257-9_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090425-102308-966_L1C_050-257-9_D_V1-0.zip
run script
2024-01-09T16:01:13.903    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:01:13.904    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090425-102308-966_L1C_050-257-9_D_V1-0.zip
2024-01-09T16:01:13.904    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:01:13.904    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:01:13.904    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:01:13.904    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:01:13.904    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:01:13.904    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:01:13.904    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:01:13.904    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:02:44.625    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 418). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090425-102308-966_L1C_050-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/04/25/SPOT4-HRVIR2-XS_20090425-102312-705_L1C_050-258-4_D_V1-0/SPOT4-HRVIR2-XS_20090425-102312-705_L1C_050-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090425-102312-705_L1C_050-258-4_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090425-102312-705_L1C_050-258-4_D_V1-0.zip
run script
2024-01-09T16:02:48.023    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:02:48.024    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090425-102312-705_L1C_050-258-4_D_V1-0.zip
2024-01-09T16:02:48.024    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:02:48.024    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:02:48.024    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:02:48.024    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:02:48.024    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:02:48.024    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:02:48.024    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:02:48.024    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090425-102312-705_L1C_050-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/04/09/SPOT4-HRVIR2-XS_20090409-103102-484_L1C_050-258-2_D_V1-0/SPOT4-HRVIR2-XS_20090409-103102-484_L1C_050-258-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090409-103102-484_L1C_050-258-2_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090409-103102-484_L1C_050-258-2_D_V1-0.zip
run script
2024-01-09T16:04:24.271    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:04:24.272    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090409-103102-484_L1C_050-258-2_D_V1-0.zip
2024-01-09T16:04:24.272    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:04:24.272    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:04:24.272    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:04:24.272    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:04:24.272    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:04:24.272    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:04:24.272    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:04:24.273    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090409-103102-484_L1C_050-258-2_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/04/09/SPOT4-HRVIR2-XS_20090409-103104-289_L1C_050-258-4_D_V1-0/SPOT4-HRVIR2-XS_20090409-103104-289_L1C_050-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090409-103104-289_L1C_050-258-4_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090409-103104-289_L1C_050-258-4_D_V1-0.zip
run script
2024-01-09T16:05:49.935    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:05:49.936    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090409-103104-289_L1C_050-258-4_D_V1-0.zip
2024-01-09T16:05:49.936    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:05:49.936    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:05:49.936    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:05:49.936    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:05:49.936    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:05:49.937    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:05:49.937    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:05:49.937    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090409-103104-289_L1C_050-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/04/20/SPOT4-HRVIR2-XS_20090420-101920-161_L1C_050-258-1_D_V1-0/SPOT4-HRVIR2-XS_20090420-101920-161_L1C_050-258-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090420-101920-161_L1C_050-258-1_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090420-101920-161_L1C_050-258-1_D_V1-0.zip
run script
2024-01-09T16:07:17.359    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:07:17.360    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090420-101920-161_L1C_050-258-1_D_V1-0.zip
2024-01-09T16:07:17.360    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:07:17.360    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:07:17.360    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:07:17.360    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:07:17.360    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:07:17.360    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:07:17.360    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:07:17.360    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090420-101920-161_L1C_050-258-1_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/04/20/SPOT4-HRVIR2-XS_20090420-101922-868_L1C_050-258-4_D_V1-0/SPOT4-HRVIR2-XS_20090420-101922-868_L1C_050-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090420-101922-868_L1C_050-258-4_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090420-101922-868_L1C_050-258-4_D_V1-0.zip
run script
2024-01-09T16:09:14.462    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:09:14.464    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090420-101922-868_L1C_050-258-4_D_V1-0.zip
2024-01-09T16:09:14.464    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:09:14.464    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:09:14.464    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:09:14.464    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:09:14.464    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:09:14.464    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:09:14.464    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:09:14.464    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:10:58.651    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 8). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090420-101922-868_L1C_050-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/04/20/SPOT4-HRVIR1-XS_20090420-101844-903_L1C_051-254-0_D_V1-0/SPOT4-HRVIR1-XS_20090420-101844-903_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090420-101844-903_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090420-101844-903_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T16:11:01.892    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:11:01.893    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090420-101844-903_L1C_051-254-0_D_V1-0.zip
2024-01-09T16:11:01.894    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:11:01.894    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:11:01.894    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:11:01.894    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:11:01.894    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:11:01.894    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:11:01.894    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:11:01.894    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090420-101844-903_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/04/30/SPOT4-HRVIR1-XS_20090430-102702-015_L1C_050-258-4_D_V1-0/SPOT4-HRVIR1-XS_20090430-102702-015_L1C_050-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090430-102702-015_L1C_050-258-4_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090430-102702-015_L1C_050-258-4_D_V1-0.zip
run script
2024-01-09T16:11:06.478    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:11:06.479    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090430-102702-015_L1C_050-258-4_D_V1-0.zip
2024-01-09T16:11:06.479    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:11:06.479    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:11:06.479    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:11:06.479    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:11:06.479    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:11:06.479    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:11:06.479    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:11:06.479    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090430-102702-015_L1C_050-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/04/30/SPOT4-HRVIR1-XS_20090430-102623-976_L1C_051-254-0_D_V1-0/SPOT4-HRVIR1-XS_20090430-102623-976_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090430-102623-976_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090430-102623-976_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T16:12:48.764    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:12:48.765    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090430-102623-976_L1C_051-254-0_D_V1-0.zip
2024-01-09T16:12:48.766    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:12:48.766    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:12:48.766    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:12:48.766    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:12:48.766    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:12:48.766    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:12:48.766    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:12:48.766    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090430-102623-976_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2009/04/30/SPOT4-HRVIR2-XS_20090430-102715-823_L1C_054-260-7_D_V1-0/SPOT4-HRVIR2-XS_20090430-102715-823_L1C_054-260-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090430-102715-823_L1C_054-260-7_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090430-102715-823_L1C_054-260-7_D_V1-0.zip
run script
2024-01-09T16:12:52.230    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:12:52.232    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090430-102715-823_L1C_054-260-7_D_V1-0.zip
2024-01-09T16:12:52.232    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:12:52.232    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:12:52.232    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:12:52.232    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:12:52.232    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:12:52.232    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:12:52.232    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:12:52.232    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090430-102715-823_L1C_054-260-7_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/05/11/SPOT4-HRVIR2-XS_20090511-101518-801_L1C_050-258-3_D_V1-0/SPOT4-HRVIR2-XS_20090511-101518-801_L1C_050-258-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090511-101518-801_L1C_050-258-3_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090511-101518-801_L1C_050-258-3_D_V1-0.zip
run script
2024-01-09T16:14:06.905    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:14:06.906    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090511-101518-801_L1C_050-258-3_D_V1-0.zip
2024-01-09T16:14:06.906    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:14:06.906    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:14:06.906    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:14:06.906    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:14:06.906    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:14:06.906    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:14:06.906    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:14:06.906    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:14:08.383    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 1658). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090511-101518-801_L1C_050-258-3_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2009/05/11/SPOT4-HRVIR1-XS_20090511-101535-019_L1C_055-260-8_D_V1-0/SPOT4-HRVIR1-XS_20090511-101535-019_L1C_055-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090511-101535-019_L1C_055-260-8_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090511-101535-019_L1C_055-260-8_D_V1-0.zip
run script
2024-01-09T16:14:11.695    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:14:11.696    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090511-101535-019_L1C_055-260-8_D_V1-0.zip
2024-01-09T16:14:11.696    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:14:11.696    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:14:11.696    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:14:11.696    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:14:11.697    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:14:11.697    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:14:11.697    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:14:11.697    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090511-101535-019_L1C_055-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/11/SPOT4-HRVIR1-XS_20090611-101850-111_L1C_050-258-2_D_V1-0/SPOT4-HRVIR1-XS_20090611-101850-111_L1C_050-258-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090611-101850-111_L1C_050-258-2_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090611-101850-111_L1C_050-258-2_D_V1-0.zip
run script
2024-01-09T16:15:13.128    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:15:13.130    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090611-101850-111_L1C_050-258-2_D_V1-0.zip
2024-01-09T16:15:13.130    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:15:13.130    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:15:13.130    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:15:13.130    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:15:13.130    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:15:13.130    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:15:13.130    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:15:13.130    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:16:50.216    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (203 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090611-101850-111_L1C_050-258-2_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/06/11/SPOT4-HRVIR1-XS_20090611-101851-916_L1C_050-258-4_D_V1-0/SPOT4-HRVIR1-XS_20090611-101851-916_L1C_050-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090611-101851-916_L1C_050-258-4_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090611-101851-916_L1C_050-258-4_D_V1-0.zip
run script
2024-01-09T16:16:53.743    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:16:53.744    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090611-101851-916_L1C_050-258-4_D_V1-0.zip
2024-01-09T16:16:53.744    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:16:53.744    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:16:53.744    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:16:53.744    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:16:53.744    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:16:53.745    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:16:53.745    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:16:53.745    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090611-101851-916_L1C_050-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/11/SPOT4-HRVIR1-XS_20090611-101904-674_L1C_050-259-9_D_V1-0/SPOT4-HRVIR1-XS_20090611-101904-674_L1C_050-259-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090611-101904-674_L1C_050-259-9_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090611-101904-674_L1C_050-259-9_D_V1-0.zip
run script
2024-01-09T16:18:34.110    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:18:34.111    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090611-101904-674_L1C_050-259-9_D_V1-0.zip
2024-01-09T16:18:34.111    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:18:34.111    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:18:34.111    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:18:34.111    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:18:34.111    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:18:34.111    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:18:34.111    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:18:34.111    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090611-101904-674_L1C_050-259-9_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/11/SPOT4-HRVIR1-XS_20090611-101904-806_L1C_050-260-0_D_V1-0/SPOT4-HRVIR1-XS_20090611-101904-806_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090611-101904-806_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090611-101904-806_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T16:19:51.308    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:19:51.309    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090611-101904-806_L1C_050-260-0_D_V1-0.zip
2024-01-09T16:19:51.309    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:19:51.310    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:19:51.310    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:19:51.310    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:19:51.310    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:19:51.310    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:19:51.310    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:19:51.310    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090611-101904-806_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/11/SPOT4-HRVIR1-XS_20090611-101913-069_L1C_050-261-0_D_V1-0/SPOT4-HRVIR1-XS_20090611-101913-069_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20090611-101913-069_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090611-101913-069_L1C_050-261-0_D_V1-0.zip
run script
2024-01-09T16:21:07.185    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:21:07.187    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090611-101913-069_L1C_050-261-0_D_V1-0.zip
2024-01-09T16:21:07.187    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:21:07.187    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:21:07.187    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:21:07.187    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:21:07.187    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:21:07.187    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:21:07.187    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:21:07.187    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR1-XS_20090611-101913-069_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/08/16/SPOT4-HRVIR2-XS_20090816-104906-541_L1C_050-258-9_D_V1-0/SPOT4-HRVIR2-XS_20090816-104906-541_L1C_050-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090816-104906-541_L1C_050-258-9_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090816-104906-541_L1C_050-258-9_D_V1-0.zip
run script
2024-01-09T16:22:10.607    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:22:10.608    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090816-104906-541_L1C_050-258-9_D_V1-0.zip
2024-01-09T16:22:10.608    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:22:10.609    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:22:10.609    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:22:10.609    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:22:10.609    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:22:10.609    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:22:10.609    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:22:10.609    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:24:15.830    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (99 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090816-104906-541_L1C_050-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/08/16/SPOT4-HRVIR2-XS_20090816-104906-851_L1C_050-259-0_D_V1-0/SPOT4-HRVIR2-XS_20090816-104906-851_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090816-104906-851_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090816-104906-851_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T16:24:19.411    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:24:19.412    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090816-104906-851_L1C_050-259-0_D_V1-0.zip
2024-01-09T16:24:19.412    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:24:19.412    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:24:19.412    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:24:19.412    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:24:19.412    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:24:19.412    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:24:19.412    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:24:19.412    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:26:17.440    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (430 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090816-104906-851_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/08/16/SPOT4-HRVIR2-XS_20090816-104915-286_L1C_050-260-0_D_V1-0/SPOT4-HRVIR2-XS_20090816-104915-286_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20090816-104915-286_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090816-104915-286_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T16:26:20.978    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:26:20.979    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090816-104915-286_L1C_050-260-0_D_V1-0.zip
2024-01-09T16:26:20.980    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:26:20.980    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:26:20.980    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:26:20.980    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:26:20.980    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:26:20.980    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:26:20.980    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:26:20.980    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016156/INPUT/SPOT4-HRVIR2-XS_20090816-104915-286_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016156/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
end
[2024-01-09 16:27:43.910535911+00:00] cnes_level2/barrouz/4016156:  Account (env) = cnes_level2
[2024-01-09 16:27:43.911740317+00:00] cnes_level2/barrouz/4016156:     User (env) = barrouz
[2024-01-09 16:27:43.912809605+00:00] cnes_level2/barrouz/4016156:        GroupId = cesbio(426000053)
[2024-01-09 16:27:43.913858744+00:00] cnes_level2/barrouz/4016156:         UserId = barrouz(9134)
[2024-01-09 16:27:43.914911632+00:00] cnes_level2/barrouz/4016156:        Account = cnes_level2
[2024-01-09 16:27:43.916040159+00:00] cnes_level2/barrouz/4016156:        Account = cnes_level2
[2024-01-09 16:27:43.917179717+00:00] cnes_level2/barrouz/4016156:      Partition = cpu2022
[2024-01-09 16:27:43.918401433+00:00] cnes_level2/barrouz/4016156:            QOS = cpu_2022_1280
[2024-01-09 16:27:43.919619000+00:00] cnes_level2/barrouz/4016156:        JobName = inf_ALP_49_TCD-ONLY_AVG-1200
[2024-01-09 16:27:43.920847056+00:00] cnes_level2/barrouz/4016156:     SubmitTime = 2024-01-09T10:51:20
[2024-01-09 16:27:43.922087502+00:00] cnes_level2/barrouz/4016156:        RunTime = 04:56:33
[2024-01-09 16:27:43.923340458+00:00] cnes_level2/barrouz/4016156:      TimeLimit = 1-16:00:00
[2024-01-09 16:27:43.924534615+00:00] cnes_level2/barrouz/4016156:   EligibleTime = 2024-01-09T10:51:20
[2024-01-09 16:27:43.925900490+00:00] cnes_level2/barrouz/4016156:      StartTime = 2024-01-09T11:31:10
[2024-01-09 16:27:43.928375332+00:00] cnes_level2/barrouz/4016156:        EndTime = 2024-01-09T16:27:43
[2024-01-09 16:27:43.930996533+00:00] cnes_level2/barrouz/4016156:       ExitCode = 0:0
[2024-01-09 16:27:43.933651564+00:00] cnes_level2/barrouz/4016156:       NodeList = trex019
[2024-01-09 16:27:43.935671361+00:00] cnes_level2/barrouz/4016156:      BatchHost = trex019
[2024-01-09 16:27:43.937382272+00:00] cnes_level2/barrouz/4016156:           TRES = 
[2024-01-09 16:27:43.939023364+00:00] cnes_level2/barrouz/4016156:        Command = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
[2024-01-09 16:27:43.940604987+00:00] cnes_level2/barrouz/4016156:        WorkDir = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code
[2024-01-09 16:27:43.942121720+00:00] cnes_level2/barrouz/4016156:         StdErr = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_49_TCD-ONLY_AVG-1200.log
[2024-01-09 16:27:43.943969209+00:00] cnes_level2/barrouz/4016156:         StdOut = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_49_TCD-ONLY_AVG-1200.log

#########################################
#        EVIDEN - CNES                  #
#        Job Accounting                 #
#########################################
Cluster              : trex
JobIDRaw             : 4016156
JobID                : 4016156
JobName              : inf_ALP_49_TCD-ONLY_AVG-1200
Account              : cnes_level2
User                 : barrouz(9134), cesbio(426000053)
Partition            : cpu2022
QOS                  : cpu_2022_1280
Nodelist             : trex019 (1)
State                : COMPLETED  (Exitcode=0:0, DerivedExitCode=0:0, Restarts=0)
Submit date          : 2024-01-09T10:51:20
Start time           : 2024-01-09T11:31:10
End time             : 2024-01-09T16:27:43
Elapsed time         : 04:56:33  (Timelimit=1-16:00:00, Suspended=00:00:00)
TEI                  : 1 day, 15:32:24
Command              : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
StdOut               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_49_TCD-ONLY_AVG-1200.log
StdErr               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_49_TCD-ONLY_AVG-1200.log

STEP(s) : 2
--------- 
   StepID  | JobName      State       Exit   Start               End                 Elapsed   TotalCPU   CPUTime    ConsumedEnergy MaxDiskRead MaxDiskWrite     MaxRSS MaxRSSTask MaxRSSNode NNodes UserCPU    NodeList
   ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 
   batch   | batch        COMPLETED   0:0    2024-01-09T11:31:10 2024-01-09T16:27:43 04:56:33  21:32:29   1-15:32:24        0.1375M  149234.60M    64525.94M  98743164K          0    trex019      1 13:47:41   trex019
   extern  | extern       COMPLETED   0:0    2024-01-09T11:31:10 2024-01-09T16:27:43 04:56:33  00:00.001  1-15:32:24        0.1375M       0.00M        0.00M      1680K          0    trex019      1 00:00:00   trex019

