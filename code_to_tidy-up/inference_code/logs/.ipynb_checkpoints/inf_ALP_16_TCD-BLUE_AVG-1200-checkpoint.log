unload conda/22.11.1  : OK 
load conda/22.11.1  : OK 
envs_dirs : /work/scratch/env/barrouz/conda_env/
pkgs_dirs : /work/scratch/env/barrouz/pkgs_conda
INPUT_PATH /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/16.txt
OUTPUT_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
DEM_PATH /work/CAMPUS/etudes/Neige/DEM
TCD_PATH /work/datalake/static_aux/TreeCoverDensity
MODELS_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
KEEP_REFL 0
MASK 1
start
/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/16.txt
muscate/SPOTWORLDHERITAGE/1999/11/04/SPOT1-HRV1-XS_19991104-102715-549_L1C_049-260-6_D_V1-0/SPOT1-HRV1-XS_19991104-102715-549_L1C_049-260-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19991104-102715-549_L1C_049-260-6_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991104-102715-549_L1C_049-260-6_D_V1-0.zip
run script
2024-01-10T19:51:20.935    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T19:51:20.936    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991104-102715-549_L1C_049-260-6_D_V1-0.zip
2024-01-10T19:51:20.936    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T19:51:20.936    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T19:51:20.937    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T19:51:20.937    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T19:51:20.937    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T19:51:20.937    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T19:51:20.937    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T19:51:20.937    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991104-102715-549_L1C_049-260-6_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/11/04/SPOT1-HRV1-XS_19991104-102718-395_L1C_049-261-0_D_V1-0/SPOT1-HRV1-XS_19991104-102718-395_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19991104-102718-395_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991104-102718-395_L1C_049-261-0_D_V1-0.zip
run script
2024-01-10T19:51:50.558    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T19:51:50.559    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991104-102718-395_L1C_049-261-0_D_V1-0.zip
2024-01-10T19:51:50.559    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T19:51:50.559    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T19:51:50.559    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T19:51:50.559    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T19:51:50.559    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T19:51:50.559    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T19:51:50.559    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T19:51:50.560    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991104-102718-395_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/11/08/SPOT1-HRV1-XS_19991108-105023-774_L1C_049-260-5_D_V1-0/SPOT1-HRV1-XS_19991108-105023-774_L1C_049-260-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19991108-105023-774_L1C_049-260-5_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991108-105023-774_L1C_049-260-5_D_V1-0.zip
run script
2024-01-10T19:52:14.245    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T19:52:14.246    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991108-105023-774_L1C_049-260-5_D_V1-0.zip
2024-01-10T19:52:14.246    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T19:52:14.246    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T19:52:14.246    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T19:52:14.246    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T19:52:14.246    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T19:52:14.247    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T19:52:14.247    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T19:52:14.247    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991108-105023-774_L1C_049-260-5_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/11/08/SPOT1-HRV1-XS_19991108-105027-636_L1C_049-261-0_D_V1-0/SPOT1-HRV1-XS_19991108-105027-636_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19991108-105027-636_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991108-105027-636_L1C_049-261-0_D_V1-0.zip
run script
2024-01-10T19:52:42.168    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T19:52:42.169    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991108-105027-636_L1C_049-261-0_D_V1-0.zip
2024-01-10T19:52:42.169    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T19:52:42.169    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T19:52:42.169    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T19:52:42.169    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T19:52:42.170    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T19:52:42.170    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T19:52:42.170    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T19:52:42.170    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991108-105027-636_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/11/08/SPOT1-HRV1-XS_19991108-105036-014_L1C_049-262-0_D_V1-0/SPOT1-HRV1-XS_19991108-105036-014_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19991108-105036-014_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991108-105036-014_L1C_049-262-0_D_V1-0.zip
run script
2024-01-10T19:52:59.603    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T19:52:59.604    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991108-105036-014_L1C_049-262-0_D_V1-0.zip
2024-01-10T19:52:59.604    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T19:52:59.604    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T19:52:59.604    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T19:52:59.604    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T19:52:59.604    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T19:52:59.604    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T19:52:59.604    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T19:52:59.604    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991108-105036-014_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1999/11/08/SPOT1-HRV2-XS_19991108-105024-234_L1C_051-260-8_D_V1-0/SPOT1-HRV2-XS_19991108-105024-234_L1C_051-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19991108-105024-234_L1C_051-260-8_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19991108-105024-234_L1C_051-260-8_D_V1-0.zip
run script
2024-01-10T19:53:02.668    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T19:53:02.668    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19991108-105024-234_L1C_051-260-8_D_V1-0.zip
2024-01-10T19:53:02.668    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T19:53:02.668    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T19:53:02.668    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T19:53:02.669    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T19:53:02.669    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T19:53:02.669    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T19:53:02.669    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T19:53:02.669    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19991108-105024-234_L1C_051-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/11/08/SPOT1-HRV2-XS_19991108-105025-410_L1C_051-261-0_D_V1-0/SPOT1-HRV2-XS_19991108-105025-410_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19991108-105025-410_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19991108-105025-410_L1C_051-261-0_D_V1-0.zip
run script
2024-01-10T19:55:29.713    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T19:55:29.714    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19991108-105025-410_L1C_051-261-0_D_V1-0.zip
2024-01-10T19:55:29.714    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T19:55:29.714    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T19:55:29.714    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T19:55:29.714    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T19:55:29.714    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T19:55:29.714    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T19:55:29.715    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T19:55:29.715    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19991108-105025-410_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/11/08/SPOT1-HRV2-XS_19991108-105033-809_L1C_051-262-0_D_V1-0/SPOT1-HRV2-XS_19991108-105033-809_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19991108-105033-809_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19991108-105033-809_L1C_051-262-0_D_V1-0.zip
run script
2024-01-10T19:57:39.017    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T19:57:39.018    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19991108-105033-809_L1C_051-262-0_D_V1-0.zip
2024-01-10T19:57:39.018    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T19:57:39.018    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T19:57:39.018    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T19:57:39.018    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T19:57:39.018    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T19:57:39.019    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T19:57:39.019    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T19:57:39.019    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19991108-105033-809_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/11/08/SPOT1-HRV2-XS_19991108-105042-216_L1C_051-263-0_D_V1-0/SPOT1-HRV2-XS_19991108-105042-216_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19991108-105042-216_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19991108-105042-216_L1C_051-263-0_D_V1-0.zip
run script
2024-01-10T19:59:04.531    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T19:59:04.532    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19991108-105042-216_L1C_051-263-0_D_V1-0.zip
2024-01-10T19:59:04.532    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T19:59:04.533    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T19:59:04.533    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T19:59:04.533    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T19:59:04.533    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T19:59:04.533    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T19:59:04.533    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T19:59:04.533    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19991108-105042-216_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/20/SPOT1-HRV1-XS_19990620-110309-206_L1C_049-261-5_D_V1-0/SPOT1-HRV1-XS_19990620-110309-206_L1C_049-261-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990620-110309-206_L1C_049-261-5_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990620-110309-206_L1C_049-261-5_D_V1-0.zip
run script
2024-01-10T19:59:33.286    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T19:59:33.287    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990620-110309-206_L1C_049-261-5_D_V1-0.zip
2024-01-10T19:59:33.287    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T19:59:33.287    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T19:59:33.288    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T19:59:33.288    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T19:59:33.288    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T19:59:33.288    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T19:59:33.288    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T19:59:33.288    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990620-110309-206_L1C_049-261-5_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1999/06/20/SPOT1-HRV1-XS_19990620-110313-155_L1C_049-262-0_D_V1-0/SPOT1-HRV1-XS_19990620-110313-155_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990620-110313-155_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990620-110313-155_L1C_049-262-0_D_V1-0.zip
run script
2024-01-10T19:59:37.033    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T19:59:37.034    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990620-110313-155_L1C_049-262-0_D_V1-0.zip
2024-01-10T19:59:37.034    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T19:59:37.034    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T19:59:37.034    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T19:59:37.034    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T19:59:37.035    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T19:59:37.035    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T19:59:37.035    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T19:59:37.035    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990620-110313-155_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1999/06/22/SPOT1-HRV1-XS_19990622-102432-542_L1C_049-261-5_D_V1-0/SPOT1-HRV1-XS_19990622-102432-542_L1C_049-261-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990622-102432-542_L1C_049-261-5_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990622-102432-542_L1C_049-261-5_D_V1-0.zip
run script
2024-01-10T19:59:40.416    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T19:59:40.425    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990622-102432-542_L1C_049-261-5_D_V1-0.zip
2024-01-10T19:59:40.425    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T19:59:40.425    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T19:59:40.425    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T19:59:40.425    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T19:59:40.425    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T19:59:40.425    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T19:59:40.426    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T19:59:40.426    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990622-102432-542_L1C_049-261-5_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1999/06/22/SPOT1-HRV1-XS_19990622-102436-287_L1C_049-262-0_D_V1-0/SPOT1-HRV1-XS_19990622-102436-287_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990622-102436-287_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990622-102436-287_L1C_049-262-0_D_V1-0.zip
run script
2024-01-10T19:59:43.820    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T19:59:43.821    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990622-102436-287_L1C_049-262-0_D_V1-0.zip
2024-01-10T19:59:43.821    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T19:59:43.821    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T19:59:43.821    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T19:59:43.821    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T19:59:43.821    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T19:59:43.821    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T19:59:43.821    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T19:59:43.821    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990622-102436-287_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1999/06/22/SPOT1-HRV1-XS_19990622-102438-091_L1C_049-262-2_D_V1-0/SPOT1-HRV1-XS_19990622-102438-091_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990622-102438-091_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990622-102438-091_L1C_049-262-2_D_V1-0.zip
run script
2024-01-10T19:59:47.014    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T19:59:47.014    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990622-102438-091_L1C_049-262-2_D_V1-0.zip
2024-01-10T19:59:47.014    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T19:59:47.014    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T19:59:47.014    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T19:59:47.014    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T19:59:47.014    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T19:59:47.014    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T19:59:47.015    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T19:59:47.015    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990622-102438-091_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1999/08/11/SPOT1-HRV1-XS_19990811-110244-640_L1C_049-261-7_D_V1-0/SPOT1-HRV1-XS_19990811-110244-640_L1C_049-261-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990811-110244-640_L1C_049-261-7_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990811-110244-640_L1C_049-261-7_D_V1-0.zip
run script
2024-01-10T19:59:50.122    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T19:59:50.123    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990811-110244-640_L1C_049-261-7_D_V1-0.zip
2024-01-10T19:59:50.123    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T19:59:50.123    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T19:59:50.123    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T19:59:50.123    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T19:59:50.123    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T19:59:50.123    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T19:59:50.123    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T19:59:50.123    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990811-110244-640_L1C_049-261-7_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1999/08/11/SPOT1-HRV1-XS_19990811-110246-781_L1C_049-262-0_D_V1-0/SPOT1-HRV1-XS_19990811-110246-781_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990811-110246-781_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990811-110246-781_L1C_049-262-0_D_V1-0.zip
run script
2024-01-10T19:59:53.209    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T19:59:53.209    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990811-110246-781_L1C_049-262-0_D_V1-0.zip
2024-01-10T19:59:53.209    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T19:59:53.209    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T19:59:53.209    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T19:59:53.209    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T19:59:53.209    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T19:59:53.209    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T19:59:53.209    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T19:59:53.209    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990811-110246-781_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1999/08/11/SPOT1-HRV1-XS_19990811-110248-586_L1C_049-262-2_D_V1-0/SPOT1-HRV1-XS_19990811-110248-586_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990811-110248-586_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990811-110248-586_L1C_049-262-2_D_V1-0.zip
run script
2024-01-10T19:59:56.269    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T19:59:56.271    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990811-110248-586_L1C_049-262-2_D_V1-0.zip
2024-01-10T19:59:56.271    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T19:59:56.271    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T19:59:56.271    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T19:59:56.271    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T19:59:56.271    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T19:59:56.271    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T19:59:56.271    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T19:59:56.271    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990811-110248-586_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1999/10/18/SPOT1-HRV1-XS_19991018-105347-563_L1C_050-255-0_D_V1-0/SPOT1-HRV1-XS_19991018-105347-563_L1C_050-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19991018-105347-563_L1C_050-255-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991018-105347-563_L1C_050-255-0_D_V1-0.zip
run script
2024-01-10T19:59:59.273    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T19:59:59.273    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991018-105347-563_L1C_050-255-0_D_V1-0.zip
2024-01-10T19:59:59.273    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T19:59:59.273    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T19:59:59.273    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T19:59:59.273    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T19:59:59.273    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T19:59:59.273    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T19:59:59.273    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T19:59:59.274    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991018-105347-563_L1C_050-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/18/SPOT1-HRV1-XS_19991018-105339-180_L1C_051-254-0_D_V1-0/SPOT1-HRV1-XS_19991018-105339-180_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19991018-105339-180_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991018-105339-180_L1C_051-254-0_D_V1-0.zip
run script
2024-01-10T20:01:08.214    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T20:01:08.215    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991018-105339-180_L1C_051-254-0_D_V1-0.zip
2024-01-10T20:01:08.215    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:01:08.215    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:01:08.216    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T20:01:08.216    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:01:08.216    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:01:08.216    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:01:08.216    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:01:08.216    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991018-105339-180_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1999/07/11/SPOT1-HRV1-XS_19990711-105833-748_L1C_050-256-8_D_V1-0/SPOT1-HRV1-XS_19990711-105833-748_L1C_050-256-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990711-105833-748_L1C_050-256-8_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990711-105833-748_L1C_050-256-8_D_V1-0.zip
run script
2024-01-10T20:01:11.351    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T20:01:11.352    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990711-105833-748_L1C_050-256-8_D_V1-0.zip
2024-01-10T20:01:11.352    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:01:11.352    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:01:11.352    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T20:01:11.352    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:01:11.352    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:01:11.352    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:01:11.352    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:01:11.352    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990711-105833-748_L1C_050-256-8_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/11/SPOT1-HRV1-XS_19990711-105834-945_L1C_050-257-0_D_V1-0/SPOT1-HRV1-XS_19990711-105834-945_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990711-105834-945_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990711-105834-945_L1C_050-257-0_D_V1-0.zip
run script
2024-01-10T20:04:11.108    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T20:04:11.109    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990711-105834-945_L1C_050-257-0_D_V1-0.zip
2024-01-10T20:04:11.109    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:04:11.109    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:04:11.109    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T20:04:11.109    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:04:11.109    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:04:11.110    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:04:11.110    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:04:11.110    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990711-105834-945_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [1 1 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/11/SPOT1-HRV1-XS_19990711-105843-367_L1C_050-258-0_D_V1-0/SPOT1-HRV1-XS_19990711-105843-367_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990711-105843-367_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990711-105843-367_L1C_050-258-0_D_V1-0.zip
run script
2024-01-10T20:07:01.375    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T20:07:01.376    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990711-105843-367_L1C_050-258-0_D_V1-0.zip
2024-01-10T20:07:01.377    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:07:01.377    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:07:01.377    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T20:07:01.377    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:07:01.377    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:07:01.377    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:07:01.377    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:07:01.377    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T20:08:40.028    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 204). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990711-105843-367_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1999/07/11/SPOT1-HRV1-XS_19990711-105851-489_L1C_050-258-9_D_V1-0/SPOT1-HRV1-XS_19990711-105851-489_L1C_050-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990711-105851-489_L1C_050-258-9_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990711-105851-489_L1C_050-258-9_D_V1-0.zip
run script
2024-01-10T20:08:42.930    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T20:08:42.932    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990711-105851-489_L1C_050-258-9_D_V1-0.zip
2024-01-10T20:08:42.932    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:08:42.932    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:08:42.932    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T20:08:42.932    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:08:42.932    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:08:42.932    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:08:42.932    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:08:42.932    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990711-105851-489_L1C_050-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/07/SPOT1-HRV1-XS_19990707-103530-489_L1C_050-257-4_D_V1-0/SPOT1-HRV1-XS_19990707-103530-489_L1C_050-257-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990707-103530-489_L1C_050-257-4_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990707-103530-489_L1C_050-257-4_D_V1-0.zip
run script
2024-01-10T20:10:07.991    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T20:10:07.992    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990707-103530-489_L1C_050-257-4_D_V1-0.zip
2024-01-10T20:10:07.992    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:10:07.992    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:10:07.992    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T20:10:07.992    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:10:07.992    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:10:07.992    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:10:07.992    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:10:07.993    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990707-103530-489_L1C_050-257-4_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/07/SPOT1-HRV1-XS_19990707-103535-157_L1C_050-258-0_D_V1-0/SPOT1-HRV1-XS_19990707-103535-157_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990707-103535-157_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990707-103535-157_L1C_050-258-0_D_V1-0.zip
run script
2024-01-10T20:12:51.191    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T20:12:51.192    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990707-103535-157_L1C_050-258-0_D_V1-0.zip
2024-01-10T20:12:51.192    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:12:51.192    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:12:51.192    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T20:12:51.192    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:12:51.192    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:12:51.193    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:12:51.193    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:12:51.193    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T20:14:26.655    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 442). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990707-103535-157_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1999/07/07/SPOT1-HRV1-XS_19990707-103543-441_L1C_050-259-0_D_V1-0/SPOT1-HRV1-XS_19990707-103543-441_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990707-103543-441_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990707-103543-441_L1C_050-259-0_D_V1-0.zip
run script
2024-01-10T20:14:29.694    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T20:14:29.695    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990707-103543-441_L1C_050-259-0_D_V1-0.zip
2024-01-10T20:14:29.695    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:14:29.695    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:14:29.695    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T20:14:29.695    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:14:29.695    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:14:29.695    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:14:29.695    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:14:29.696    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990707-103543-441_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/07/SPOT1-HRV1-XS_19990707-103551-734_L1C_051-260-0_D_V1-0/SPOT1-HRV1-XS_19990707-103551-734_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990707-103551-734_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990707-103551-734_L1C_051-260-0_D_V1-0.zip
run script
2024-01-10T20:16:41.006    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T20:16:41.007    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990707-103551-734_L1C_051-260-0_D_V1-0.zip
2024-01-10T20:16:41.007    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:16:41.008    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:16:41.008    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T20:16:41.008    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:16:41.008    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:16:41.008    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:16:41.008    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:16:41.008    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990707-103551-734_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/07/SPOT1-HRV2-XS_19990707-103551-530_L1C_054-260-4_D_V1-0/SPOT1-HRV2-XS_19990707-103551-530_L1C_054-260-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19990707-103551-530_L1C_054-260-4_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990707-103551-530_L1C_054-260-4_D_V1-0.zip
run script
2024-01-10T20:18:17.953    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T20:18:17.955    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990707-103551-530_L1C_054-260-4_D_V1-0.zip
2024-01-10T20:18:17.955    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:18:17.955    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:18:17.955    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T20:18:17.955    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:18:17.955    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:18:17.955    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:18:17.955    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:18:17.955    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990707-103551-530_L1C_054-260-4_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/27/SPOT1-HRV1-XS_19990727-105044-332_L1C_050-257-5_D_V1-0/SPOT1-HRV1-XS_19990727-105044-332_L1C_050-257-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990727-105044-332_L1C_050-257-5_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990727-105044-332_L1C_050-257-5_D_V1-0.zip
run script
2024-01-10T20:20:04.526    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T20:20:04.527    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990727-105044-332_L1C_050-257-5_D_V1-0.zip
2024-01-10T20:20:04.527    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:20:04.527    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:20:04.527    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T20:20:04.527    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:20:04.527    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:20:04.527    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:20:04.527    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:20:04.527    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990727-105044-332_L1C_050-257-5_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/27/SPOT1-HRV1-XS_19990727-105048-185_L1C_050-258-0_D_V1-0/SPOT1-HRV1-XS_19990727-105048-185_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990727-105048-185_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990727-105048-185_L1C_050-258-0_D_V1-0.zip
run script
2024-01-10T20:22:48.045    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T20:22:48.047    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990727-105048-185_L1C_050-258-0_D_V1-0.zip
2024-01-10T20:22:48.047    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:22:48.047    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:22:48.047    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T20:22:48.047    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:22:48.047    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:22:48.047    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:22:48.047    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:22:48.047    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T20:24:35.672    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 231). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990727-105048-185_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1999/07/27/SPOT1-HRV1-XS_19990727-105056-559_L1C_050-259-0_D_V1-0/SPOT1-HRV1-XS_19990727-105056-559_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990727-105056-559_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990727-105056-559_L1C_050-259-0_D_V1-0.zip
run script
2024-01-10T20:24:38.686    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T20:24:38.687    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990727-105056-559_L1C_050-259-0_D_V1-0.zip
2024-01-10T20:24:38.687    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:24:38.687    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:24:38.687    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T20:24:38.687    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:24:38.687    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:24:38.687    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:24:38.687    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:24:38.687    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990727-105056-559_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/27/SPOT1-HRV1-XS_19990727-105104-937_L1C_050-260-0_D_V1-0/SPOT1-HRV1-XS_19990727-105104-937_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990727-105104-937_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990727-105104-937_L1C_050-260-0_D_V1-0.zip
run script
2024-01-10T20:26:41.817    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T20:26:41.818    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990727-105104-937_L1C_050-260-0_D_V1-0.zip
2024-01-10T20:26:41.818    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:26:41.818    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:26:41.818    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T20:26:41.818    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:26:41.818    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:26:41.818    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:26:41.818    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:26:41.818    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990727-105104-937_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/27/SPOT1-HRV1-XS_19990727-105113-320_L1C_050-261-0_D_V1-0/SPOT1-HRV1-XS_19990727-105113-320_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990727-105113-320_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990727-105113-320_L1C_050-261-0_D_V1-0.zip
run script
2024-01-10T20:28:03.517    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T20:28:03.518    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990727-105113-320_L1C_050-261-0_D_V1-0.zip
2024-01-10T20:28:03.518    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:28:03.518    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:28:03.518    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T20:28:03.518    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:28:03.519    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:28:03.519    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:28:03.519    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:28:03.519    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990727-105113-320_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/27/SPOT1-HRV1-XS_19990727-105119-637_L1C_050-261-7_D_V1-0/SPOT1-HRV1-XS_19990727-105119-637_L1C_050-261-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990727-105119-637_L1C_050-261-7_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990727-105119-637_L1C_050-261-7_D_V1-0.zip
run script
2024-01-10T20:29:18.006    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T20:29:18.007    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990727-105119-637_L1C_050-261-7_D_V1-0.zip
2024-01-10T20:29:18.007    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:29:18.007    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:29:18.008    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T20:29:18.008    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:29:18.008    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:29:18.008    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:29:18.008    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:29:18.008    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990727-105119-637_L1C_050-261-7_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/03/SPOT1-HRV1-XS_19990903-101936-650_L1C_050-257-5_D_V1-0/SPOT1-HRV1-XS_19990903-101936-650_L1C_050-257-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990903-101936-650_L1C_050-257-5_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990903-101936-650_L1C_050-257-5_D_V1-0.zip
run script
2024-01-10T20:30:09.249    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T20:30:09.250    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990903-101936-650_L1C_050-257-5_D_V1-0.zip
2024-01-10T20:30:09.250    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:30:09.250    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:30:09.250    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T20:30:09.250    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:30:09.250    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:30:09.250    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:30:09.250    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:30:09.250    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990903-101936-650_L1C_050-257-5_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/03/SPOT1-HRV1-XS_19990903-101940-350_L1C_050-258-0_D_V1-0/SPOT1-HRV1-XS_19990903-101940-350_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990903-101940-350_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990903-101940-350_L1C_050-258-0_D_V1-0.zip
run script
2024-01-10T20:32:58.411    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T20:32:58.413    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990903-101940-350_L1C_050-258-0_D_V1-0.zip
2024-01-10T20:32:58.413    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:32:58.413    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:32:58.413    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T20:32:58.413    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:32:58.413    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:32:58.413    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:32:58.413    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:32:58.413    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T20:34:59.361    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 540). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990903-101940-350_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1999/09/03/SPOT1-HRV1-XS_19990903-101948-577_L1C_050-259-0_D_V1-0/SPOT1-HRV1-XS_19990903-101948-577_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990903-101948-577_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990903-101948-577_L1C_050-259-0_D_V1-0.zip
run script
2024-01-10T20:35:02.053    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T20:35:02.053    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990903-101948-577_L1C_050-259-0_D_V1-0.zip
2024-01-10T20:35:02.053    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:35:02.053    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:35:02.053    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T20:35:02.053    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:35:02.053    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:35:02.053    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:35:02.053    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:35:02.053    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990903-101948-577_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/12/SPOT1-HRV1-XS_19990912-104634-299_L1C_050-257-5_D_V1-0/SPOT1-HRV1-XS_19990912-104634-299_L1C_050-257-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990912-104634-299_L1C_050-257-5_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990912-104634-299_L1C_050-257-5_D_V1-0.zip
run script
2024-01-10T20:37:20.174    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T20:37:20.175    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990912-104634-299_L1C_050-257-5_D_V1-0.zip
2024-01-10T20:37:20.175    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:37:20.175    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:37:20.175    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T20:37:20.175    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:37:20.176    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:37:20.176    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:37:20.176    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:37:20.176    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990912-104634-299_L1C_050-257-5_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/12/SPOT1-HRV1-XS_19990912-104638-122_L1C_050-258-0_D_V1-0/SPOT1-HRV1-XS_19990912-104638-122_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990912-104638-122_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990912-104638-122_L1C_050-258-0_D_V1-0.zip
run script
2024-01-10T20:39:45.276    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T20:39:45.277    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990912-104638-122_L1C_050-258-0_D_V1-0.zip
2024-01-10T20:39:45.278    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:39:45.278    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:39:45.278    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T20:39:45.278    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:39:45.278    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:39:45.278    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:39:45.278    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:39:45.278    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T20:41:24.140    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 446). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990912-104638-122_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1999/09/12/SPOT1-HRV1-XS_19990912-104646-463_L1C_050-259-0_D_V1-0/SPOT1-HRV1-XS_19990912-104646-463_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990912-104646-463_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990912-104646-463_L1C_050-259-0_D_V1-0.zip
run script
2024-01-10T20:41:27.324    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T20:41:27.324    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990912-104646-463_L1C_050-259-0_D_V1-0.zip
2024-01-10T20:41:27.324    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:41:27.325    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:41:27.325    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T20:41:27.325    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:41:27.325    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:41:27.325    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:41:27.325    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:41:27.325    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990912-104646-463_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/17/SPOT1-HRV1-XS_19990917-105022-245_L1C_050-257-6_D_V1-0/SPOT1-HRV1-XS_19990917-105022-245_L1C_050-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990917-105022-245_L1C_050-257-6_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990917-105022-245_L1C_050-257-6_D_V1-0.zip
run script
2024-01-10T20:43:08.560    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T20:43:08.562    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990917-105022-245_L1C_050-257-6_D_V1-0.zip
2024-01-10T20:43:08.562    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:43:08.562    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:43:08.562    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T20:43:08.562    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:43:08.562    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:43:08.562    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:43:08.562    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:43:08.562    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990917-105022-245_L1C_050-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/17/SPOT1-HRV1-XS_19990917-105025-196_L1C_050-258-0_D_V1-0/SPOT1-HRV1-XS_19990917-105025-196_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990917-105025-196_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990917-105025-196_L1C_050-258-0_D_V1-0.zip
run script
2024-01-10T20:45:51.332    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T20:45:51.333    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990917-105025-196_L1C_050-258-0_D_V1-0.zip
2024-01-10T20:45:51.333    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:45:51.333    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:45:51.333    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T20:45:51.333    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:45:51.333    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:45:51.333    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:45:51.333    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:45:51.333    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T20:47:38.367    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 228). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990917-105025-196_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1999/09/17/SPOT1-HRV1-XS_19990917-105033-567_L1C_050-259-0_D_V1-0/SPOT1-HRV1-XS_19990917-105033-567_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990917-105033-567_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990917-105033-567_L1C_050-259-0_D_V1-0.zip
run script
2024-01-10T20:47:41.345    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T20:47:41.346    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990917-105033-567_L1C_050-259-0_D_V1-0.zip
2024-01-10T20:47:41.346    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:47:41.346    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:47:41.346    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T20:47:41.346    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:47:41.346    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:47:41.346    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:47:41.346    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:47:41.346    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990917-105033-567_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/17/SPOT1-HRV1-XS_19990917-105041-945_L1C_050-260-0_D_V1-0/SPOT1-HRV1-XS_19990917-105041-945_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990917-105041-945_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990917-105041-945_L1C_050-260-0_D_V1-0.zip
run script
2024-01-10T20:49:52.590    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T20:49:52.591    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990917-105041-945_L1C_050-260-0_D_V1-0.zip
2024-01-10T20:49:52.591    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:49:52.591    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:49:52.591    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T20:49:52.591    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:49:52.591    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:49:52.591    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:49:52.591    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:49:52.591    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990917-105041-945_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/17/SPOT1-HRV1-XS_19990917-105050-328_L1C_050-261-0_D_V1-0/SPOT1-HRV1-XS_19990917-105050-328_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990917-105050-328_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990917-105050-328_L1C_050-261-0_D_V1-0.zip
run script
2024-01-10T20:51:19.721    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T20:51:19.723    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990917-105050-328_L1C_050-261-0_D_V1-0.zip
2024-01-10T20:51:19.723    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:51:19.723    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:51:19.723    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T20:51:19.723    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:51:19.723    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:51:19.723    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:51:19.723    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:51:19.723    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990917-105050-328_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 1 1 2]
 [0 0 0 ... 1 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/17/SPOT1-HRV1-XS_19990917-105055-742_L1C_050-261-6_D_V1-0/SPOT1-HRV1-XS_19990917-105055-742_L1C_050-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990917-105055-742_L1C_050-261-6_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990917-105055-742_L1C_050-261-6_D_V1-0.zip
run script
2024-01-10T20:52:34.783    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T20:52:34.785    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990917-105055-742_L1C_050-261-6_D_V1-0.zip
2024-01-10T20:52:34.785    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:52:34.785    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:52:34.785    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T20:52:34.785    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:52:34.785    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:52:34.785    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:52:34.785    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:52:34.785    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990917-105055-742_L1C_050-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/22/SPOT1-HRV1-XS_19990922-105413-265_L1C_050-257-6_D_V1-0/SPOT1-HRV1-XS_19990922-105413-265_L1C_050-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990922-105413-265_L1C_050-257-6_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990922-105413-265_L1C_050-257-6_D_V1-0.zip
run script
2024-01-10T20:53:33.453    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T20:53:33.454    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990922-105413-265_L1C_050-257-6_D_V1-0.zip
2024-01-10T20:53:33.454    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:53:33.454    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:53:33.454    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T20:53:33.454    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:53:33.454    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:53:33.454    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:53:33.454    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:53:33.454    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990922-105413-265_L1C_050-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/22/SPOT1-HRV1-XS_19990922-105416-246_L1C_050-258-0_D_V1-0/SPOT1-HRV1-XS_19990922-105416-246_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990922-105416-246_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990922-105416-246_L1C_050-258-0_D_V1-0.zip
run script
2024-01-10T20:56:33.165    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T20:56:33.166    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990922-105416-246_L1C_050-258-0_D_V1-0.zip
2024-01-10T20:56:33.166    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:56:33.167    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:56:33.167    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T20:56:33.167    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:56:33.167    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:56:33.167    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:56:33.167    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:56:33.167    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T20:58:25.574    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 474). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990922-105416-246_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1999/09/22/SPOT1-HRV1-XS_19990922-105424-648_L1C_050-259-0_D_V1-0/SPOT1-HRV1-XS_19990922-105424-648_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990922-105424-648_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990922-105424-648_L1C_050-259-0_D_V1-0.zip
run script
2024-01-10T20:58:28.513    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T20:58:28.514    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990922-105424-648_L1C_050-259-0_D_V1-0.zip
2024-01-10T20:58:28.514    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:58:28.514    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:58:28.514    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T20:58:28.514    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:58:28.514    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:58:28.514    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:58:28.514    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:58:28.514    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990922-105424-648_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/22/SPOT1-HRV1-XS_19990922-105450-787_L1C_050-262-1_D_V1-0/SPOT1-HRV1-XS_19990922-105450-787_L1C_050-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990922-105450-787_L1C_050-262-1_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990922-105450-787_L1C_050-262-1_D_V1-0.zip
run script
2024-01-10T21:00:52.289    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:00:52.290    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990922-105450-787_L1C_050-262-1_D_V1-0.zip
2024-01-10T21:00:52.290    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:00:52.290    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:00:52.290    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:00:52.290    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:00:52.290    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:00:52.291    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:00:52.291    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:00:52.291    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990922-105450-787_L1C_050-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/22/SPOT1-HRV1-XS_19990922-105456-201_L1C_050-262-7_D_V1-0/SPOT1-HRV1-XS_19990922-105456-201_L1C_050-262-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990922-105456-201_L1C_050-262-7_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990922-105456-201_L1C_050-262-7_D_V1-0.zip
run script
2024-01-10T21:01:41.217    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:01:41.218    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990922-105456-201_L1C_050-262-7_D_V1-0.zip
2024-01-10T21:01:41.219    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:01:41.219    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:01:41.219    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:01:41.219    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:01:41.219    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:01:41.219    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:01:41.219    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:01:41.219    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990922-105456-201_L1C_050-262-7_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/08/SPOT1-HRV1-XS_19991008-104631-633_L1C_050-257-6_D_V1-0/SPOT1-HRV1-XS_19991008-104631-633_L1C_050-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19991008-104631-633_L1C_050-257-6_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991008-104631-633_L1C_050-257-6_D_V1-0.zip
run script
2024-01-10T21:02:05.016    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:02:05.017    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991008-104631-633_L1C_050-257-6_D_V1-0.zip
2024-01-10T21:02:05.017    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:02:05.017    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:02:05.017    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:02:05.017    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:02:05.017    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:02:05.017    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:02:05.017    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:02:05.017    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991008-104631-633_L1C_050-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/08/SPOT1-HRV1-XS_19991008-104634-557_L1C_050-258-0_D_V1-0/SPOT1-HRV1-XS_19991008-104634-557_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19991008-104634-557_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991008-104634-557_L1C_050-258-0_D_V1-0.zip
run script
2024-01-10T21:04:36.092    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:04:36.093    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991008-104634-557_L1C_050-258-0_D_V1-0.zip
2024-01-10T21:04:36.093    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:04:36.093    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:04:36.094    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:04:36.094    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:04:36.094    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:04:36.094    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:04:36.094    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:04:36.094    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T21:06:17.036    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 223). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991008-104634-557_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1999/10/08/SPOT1-HRV1-XS_19991008-104642-904_L1C_050-259-0_D_V1-0/SPOT1-HRV1-XS_19991008-104642-904_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19991008-104642-904_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991008-104642-904_L1C_050-259-0_D_V1-0.zip
run script
2024-01-10T21:06:19.949    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:06:19.950    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991008-104642-904_L1C_050-259-0_D_V1-0.zip
2024-01-10T21:06:19.950    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:06:19.950    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:06:19.950    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:06:19.950    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:06:19.950    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:06:19.950    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:06:19.951    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:06:19.951    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991008-104642-904_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/08/SPOT1-HRV1-XS_19991008-104651-257_L1C_050-260-0_D_V1-0/SPOT1-HRV1-XS_19991008-104651-257_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19991008-104651-257_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991008-104651-257_L1C_050-260-0_D_V1-0.zip
run script
2024-01-10T21:08:20.545    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:08:20.546    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991008-104651-257_L1C_050-260-0_D_V1-0.zip
2024-01-10T21:08:20.546    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:08:20.547    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:08:20.547    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:08:20.547    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:08:20.547    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:08:20.547    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:08:20.547    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:08:20.547    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991008-104651-257_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/08/SPOT1-HRV1-XS_19991008-104659-617_L1C_050-261-0_D_V1-0/SPOT1-HRV1-XS_19991008-104659-617_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19991008-104659-617_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991008-104659-617_L1C_050-261-0_D_V1-0.zip
run script
2024-01-10T21:09:44.429    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:09:44.430    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991008-104659-617_L1C_050-261-0_D_V1-0.zip
2024-01-10T21:09:44.430    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:09:44.430    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:09:44.430    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:09:44.430    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:09:44.430    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:09:44.430    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:09:44.430    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:09:44.430    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991008-104659-617_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/08/SPOT1-HRV1-XS_19991008-104704-129_L1C_050-261-5_D_V1-0/SPOT1-HRV1-XS_19991008-104704-129_L1C_050-261-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19991008-104704-129_L1C_050-261-5_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991008-104704-129_L1C_050-261-5_D_V1-0.zip
run script
2024-01-10T21:10:56.588    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:10:56.589    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991008-104704-129_L1C_050-261-5_D_V1-0.zip
2024-01-10T21:10:56.589    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:10:56.589    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:10:56.589    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:10:56.589    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:10:56.589    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:10:56.589    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:10:56.589    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:10:56.589    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991008-104704-129_L1C_050-261-5_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/08/SPOT1-HRV2-XS_19991008-104600-693_L1C_051-254-0_D_V1-0/SPOT1-HRV2-XS_19991008-104600-693_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19991008-104600-693_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19991008-104600-693_L1C_051-254-0_D_V1-0.zip
run script
2024-01-10T21:11:59.426    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:11:59.427    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19991008-104600-693_L1C_051-254-0_D_V1-0.zip
2024-01-10T21:11:59.427    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:11:59.428    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:11:59.428    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:11:59.428    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:11:59.428    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:11:59.428    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:11:59.428    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:11:59.428    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19991008-104600-693_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1999/10/08/SPOT1-HRV2-XS_19991008-104609-016_L1C_051-255-0_D_V1-0/SPOT1-HRV2-XS_19991008-104609-016_L1C_051-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19991008-104609-016_L1C_051-255-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19991008-104609-016_L1C_051-255-0_D_V1-0.zip
run script
2024-01-10T21:12:02.333    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:12:02.334    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19991008-104609-016_L1C_051-255-0_D_V1-0.zip
2024-01-10T21:12:02.334    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:12:02.334    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:12:02.334    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:12:02.334    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:12:02.334    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:12:02.335    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:12:02.335    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:12:02.335    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19991008-104609-016_L1C_051-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/06/SPOT1-HRV1-XS_19990906-110207-394_L1C_050-258-0_D_V1-0/SPOT1-HRV1-XS_19990906-110207-394_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990906-110207-394_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990906-110207-394_L1C_050-258-0_D_V1-0.zip
run script
2024-01-10T21:12:53.438    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:12:53.439    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990906-110207-394_L1C_050-258-0_D_V1-0.zip
2024-01-10T21:12:53.439    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:12:53.439    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:12:53.439    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:12:53.439    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:12:53.439    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:12:53.439    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:12:53.439    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:12:53.439    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T21:15:36.273    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 490). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990906-110207-394_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1999/09/06/SPOT1-HRV1-XS_19990906-110215-856_L1C_050-259-0_D_V1-0/SPOT1-HRV1-XS_19990906-110215-856_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990906-110215-856_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990906-110215-856_L1C_050-259-0_D_V1-0.zip
run script
2024-01-10T21:15:39.221    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:15:39.221    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990906-110215-856_L1C_050-259-0_D_V1-0.zip
2024-01-10T21:15:39.221    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:15:39.222    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:15:39.222    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:15:39.222    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:15:39.222    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:15:39.222    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:15:39.222    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:15:39.222    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990906-110215-856_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/06/SPOT1-HRV1-XS_19990906-110224-323_L1C_050-260-0_D_V1-0/SPOT1-HRV1-XS_19990906-110224-323_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990906-110224-323_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990906-110224-323_L1C_050-260-0_D_V1-0.zip
run script
2024-01-10T21:17:32.312    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:17:32.313    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990906-110224-323_L1C_050-260-0_D_V1-0.zip
2024-01-10T21:17:32.313    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:17:32.313    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:17:32.313    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:17:32.313    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:17:32.313    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:17:32.314    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:17:32.314    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:17:32.314    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990906-110224-323_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/06/SPOT1-HRV1-XS_19990906-110240-807_L1C_050-262-0_D_V1-0/SPOT1-HRV1-XS_19990906-110240-807_L1C_050-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990906-110240-807_L1C_050-262-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990906-110240-807_L1C_050-262-0_D_V1-0.zip
run script
2024-01-10T21:18:51.781    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:18:51.782    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990906-110240-807_L1C_050-262-0_D_V1-0.zip
2024-01-10T21:18:51.783    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:18:51.783    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:18:51.783    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:18:51.783    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:18:51.783    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:18:51.783    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:18:51.783    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:18:51.783    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990906-110240-807_L1C_050-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/06/SPOT1-HRV1-XS_19990906-110245-319_L1C_050-262-5_D_V1-0/SPOT1-HRV1-XS_19990906-110245-319_L1C_050-262-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990906-110245-319_L1C_050-262-5_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990906-110245-319_L1C_050-262-5_D_V1-0.zip
run script
2024-01-10T21:19:42.698    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:19:42.699    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990906-110245-319_L1C_050-262-5_D_V1-0.zip
2024-01-10T21:19:42.699    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:19:42.699    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:19:42.699    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:19:42.699    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:19:42.699    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:19:42.700    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:19:42.700    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:19:42.700    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990906-110245-319_L1C_050-262-5_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/08/06/SPOT1-HRV1-XS_19990806-105839-887_L1C_050-260-4_D_V1-0/SPOT1-HRV1-XS_19990806-105839-887_L1C_050-260-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990806-105839-887_L1C_050-260-4_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990806-105839-887_L1C_050-260-4_D_V1-0.zip
run script
2024-01-10T21:20:11.537    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:20:11.538    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990806-105839-887_L1C_050-260-4_D_V1-0.zip
2024-01-10T21:20:11.538    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:20:11.538    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:20:11.538    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:20:11.538    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:20:11.538    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:20:11.538    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:20:11.538    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:20:11.538    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990806-105839-887_L1C_050-260-4_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 1 ... 2 2 2]
 [0 0 1 ... 2 2 2]
 [0 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/08/06/SPOT1-HRV1-XS_19990806-105810-962_L1C_051-257-0_D_V1-0/SPOT1-HRV1-XS_19990806-105810-962_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990806-105810-962_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990806-105810-962_L1C_051-257-0_D_V1-0.zip
run script
2024-01-10T21:21:59.920    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:21:59.921    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990806-105810-962_L1C_051-257-0_D_V1-0.zip
2024-01-10T21:21:59.921    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:21:59.921    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:21:59.922    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:21:59.922    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:21:59.922    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:21:59.922    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:21:59.922    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:21:59.922    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990806-105810-962_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 0 0 0]
 [1 1 1 ... 1 1 0]
 [1 1 1 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/26/SPOT1-HRV2-XS_19990626-104737-613_L1C_050-261-0_D_V1-0/SPOT1-HRV2-XS_19990626-104737-613_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19990626-104737-613_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990626-104737-613_L1C_050-261-0_D_V1-0.zip
run script
2024-01-10T21:25:31.176    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:25:31.177    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990626-104737-613_L1C_050-261-0_D_V1-0.zip
2024-01-10T21:25:31.177    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:25:31.177    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:25:31.177    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:25:31.177    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:25:31.177    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:25:31.177    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:25:31.177    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:25:31.177    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990626-104737-613_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/26/SPOT1-HRV2-XS_19990626-104745-985_L1C_050-262-0_D_V1-0/SPOT1-HRV2-XS_19990626-104745-985_L1C_050-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19990626-104745-985_L1C_050-262-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990626-104745-985_L1C_050-262-0_D_V1-0.zip
run script
2024-01-10T21:26:59.715    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:26:59.716    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990626-104745-985_L1C_050-262-0_D_V1-0.zip
2024-01-10T21:26:59.716    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:26:59.716    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:26:59.716    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:26:59.716    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:26:59.716    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:26:59.716    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:26:59.716    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:26:59.716    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990626-104745-985_L1C_050-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/26/SPOT1-HRV2-XS_19990626-104750-497_L1C_050-262-5_D_V1-0/SPOT1-HRV2-XS_19990626-104750-497_L1C_050-262-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19990626-104750-497_L1C_050-262-5_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990626-104750-497_L1C_050-262-5_D_V1-0.zip
run script
2024-01-10T21:28:03.920    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:28:03.921    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990626-104750-497_L1C_050-262-5_D_V1-0.zip
2024-01-10T21:28:03.921    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:28:03.922    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:28:03.922    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:28:03.922    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:28:03.922    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:28:03.922    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:28:03.931    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:28:03.931    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990626-104750-497_L1C_050-262-5_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/08/17/SPOT1-HRV1-XS_19990817-104721-574_L1C_050-262-1_D_V1-0/SPOT1-HRV1-XS_19990817-104721-574_L1C_050-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990817-104721-574_L1C_050-262-1_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990817-104721-574_L1C_050-262-1_D_V1-0.zip
run script
2024-01-10T21:28:45.174    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:28:45.175    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990817-104721-574_L1C_050-262-1_D_V1-0.zip
2024-01-10T21:28:45.175    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:28:45.175    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:28:45.176    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:28:45.176    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:28:45.176    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:28:45.176    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:28:45.176    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:28:45.176    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990817-104721-574_L1C_050-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/08/17/SPOT1-HRV1-XS_19990817-104726-086_L1C_050-262-6_D_V1-0/SPOT1-HRV1-XS_19990817-104726-086_L1C_050-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990817-104726-086_L1C_050-262-6_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990817-104726-086_L1C_050-262-6_D_V1-0.zip
run script
2024-01-10T21:29:21.581    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:29:21.582    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990817-104726-086_L1C_050-262-6_D_V1-0.zip
2024-01-10T21:29:21.582    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:29:21.582    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:29:21.582    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:29:21.582    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:29:21.582    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:29:21.582    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:29:21.582    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:29:21.583    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990817-104726-086_L1C_050-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/03/15/SPOT1-HRV2-XS_19990315-102725-424_L1C_051-254-0_D_V1-0/SPOT1-HRV2-XS_19990315-102725-424_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19990315-102725-424_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990315-102725-424_L1C_051-254-0_D_V1-0.zip
run script
2024-01-10T21:29:39.871    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:29:39.873    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990315-102725-424_L1C_051-254-0_D_V1-0.zip
2024-01-10T21:29:39.873    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:29:39.873    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:29:39.873    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:29:39.873    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:29:39.873    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:29:39.873    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:29:39.873    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:29:39.873    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990315-102725-424_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1999/09/01/SPOT1-HRV1-XS_19990901-105743-746_L1C_051-254-0_D_V1-0/SPOT1-HRV1-XS_19990901-105743-746_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990901-105743-746_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990901-105743-746_L1C_051-254-0_D_V1-0.zip
run script
2024-01-10T21:29:42.919    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:29:42.920    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990901-105743-746_L1C_051-254-0_D_V1-0.zip
2024-01-10T21:29:42.920    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:29:42.920    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:29:42.920    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:29:42.920    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:29:42.920    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:29:42.920    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:29:42.920    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:29:42.920    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990901-105743-746_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1999/12/16/SPOT1-HRV1-XS_19991216-101819-519_L1C_051-254-0_D_V1-0/SPOT1-HRV1-XS_19991216-101819-519_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19991216-101819-519_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991216-101819-519_L1C_051-254-0_D_V1-0.zip
run script
2024-01-10T21:29:45.912    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:29:45.912    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991216-101819-519_L1C_051-254-0_D_V1-0.zip
2024-01-10T21:29:45.912    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:29:45.912    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:29:45.912    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:29:45.912    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:29:45.913    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:29:45.913    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:29:45.913    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:29:45.913    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991216-101819-519_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1999/12/16/SPOT1-HRV1-XS_19991216-101842-224_L1C_051-256-7_D_V1-0/SPOT1-HRV1-XS_19991216-101842-224_L1C_051-256-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19991216-101842-224_L1C_051-256-7_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991216-101842-224_L1C_051-256-7_D_V1-0.zip
run script
2024-01-10T21:29:48.955    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:29:48.955    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991216-101842-224_L1C_051-256-7_D_V1-0.zip
2024-01-10T21:29:48.956    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:29:48.956    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:29:48.956    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:29:48.956    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:29:48.956    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:29:48.956    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:29:48.956    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:29:48.956    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991216-101842-224_L1C_051-256-7_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/17/SPOT1-HRV1-XS_19990617-102004-314_L1C_051-257-5_D_V1-0/SPOT1-HRV1-XS_19990617-102004-314_L1C_051-257-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990617-102004-314_L1C_051-257-5_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990617-102004-314_L1C_051-257-5_D_V1-0.zip
run script
2024-01-10T21:32:58.097    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:32:58.098    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990617-102004-314_L1C_051-257-5_D_V1-0.zip
2024-01-10T21:32:58.098    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:32:58.098    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:32:58.098    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:32:58.098    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:32:58.098    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:32:58.098    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:32:58.098    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:32:58.098    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990617-102004-314_L1C_051-257-5_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 2 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/17/SPOT1-HRV1-XS_19990617-102008-023_L1C_051-258-0_D_V1-0/SPOT1-HRV1-XS_19990617-102008-023_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990617-102008-023_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990617-102008-023_L1C_051-258-0_D_V1-0.zip
run script
2024-01-10T21:36:09.676    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:36:09.677    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990617-102008-023_L1C_051-258-0_D_V1-0.zip
2024-01-10T21:36:09.677    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:36:09.677    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:36:09.677    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:36:09.677    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:36:09.677    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:36:09.677    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:36:09.677    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:36:09.677    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T21:38:01.695    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 261). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990617-102008-023_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1999/06/17/SPOT1-HRV1-XS_19990617-102016-253_L1C_051-259-0_D_V1-0/SPOT1-HRV1-XS_19990617-102016-253_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990617-102016-253_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990617-102016-253_L1C_051-259-0_D_V1-0.zip
run script
2024-01-10T21:38:05.080    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:38:05.081    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990617-102016-253_L1C_051-259-0_D_V1-0.zip
2024-01-10T21:38:05.081    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:38:05.081    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:38:05.081    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:38:05.081    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:38:05.081    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:38:05.082    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:38:05.082    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:38:05.082    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990617-102016-253_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/17/SPOT1-HRV1-XS_19990617-102025-394_L1C_051-260-1_D_V1-0/SPOT1-HRV1-XS_19990617-102025-394_L1C_051-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990617-102025-394_L1C_051-260-1_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990617-102025-394_L1C_051-260-1_D_V1-0.zip
run script
2024-01-10T21:40:55.798    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:40:55.800    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990617-102025-394_L1C_051-260-1_D_V1-0.zip
2024-01-10T21:40:55.800    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:40:55.800    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:40:55.800    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:40:55.800    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:40:55.800    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:40:55.800    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:40:55.800    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:40:55.800    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990617-102025-394_L1C_051-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/11/20/SPOT1-HRV1-XS_19991120-101853-743_L1C_051-257-0_D_V1-0/SPOT1-HRV1-XS_19991120-101853-743_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19991120-101853-743_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991120-101853-743_L1C_051-257-0_D_V1-0.zip
run script
2024-01-10T21:43:08.460    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:43:08.460    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991120-101853-743_L1C_051-257-0_D_V1-0.zip
2024-01-10T21:43:08.461    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:43:08.461    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:43:08.461    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:43:08.461    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:43:08.461    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:43:08.461    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:43:08.461    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:43:08.461    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991120-101853-743_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/06/SPOT1-HRV1-XS_19990706-105505-802_L1C_051-259-5_D_V1-0/SPOT1-HRV1-XS_19990706-105505-802_L1C_051-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990706-105505-802_L1C_051-259-5_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990706-105505-802_L1C_051-259-5_D_V1-0.zip
run script
2024-01-10T21:46:17.189    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:46:17.190    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990706-105505-802_L1C_051-259-5_D_V1-0.zip
2024-01-10T21:46:17.190    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:46:17.190    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:46:17.190    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:46:17.190    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:46:17.190    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:46:17.190    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:46:17.190    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:46:17.191    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990706-105505-802_L1C_051-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 1 1 ... 2 2 2]
 [2 2 1 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/06/SPOT1-HRV1-XS_19990706-105509-710_L1C_051-260-0_D_V1-0/SPOT1-HRV1-XS_19990706-105509-710_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990706-105509-710_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990706-105509-710_L1C_051-260-0_D_V1-0.zip
run script
2024-01-10T21:48:50.427    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:48:50.429    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990706-105509-710_L1C_051-260-0_D_V1-0.zip
2024-01-10T21:48:50.429    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:48:50.429    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:48:50.429    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:48:50.429    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:48:50.429    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:48:50.429    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:48:50.429    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:48:50.429    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990706-105509-710_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/06/SPOT1-HRV1-XS_19990706-105518-132_L1C_051-261-0_D_V1-0/SPOT1-HRV1-XS_19990706-105518-132_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990706-105518-132_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990706-105518-132_L1C_051-261-0_D_V1-0.zip
run script
2024-01-10T21:50:57.040    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:50:57.041    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990706-105518-132_L1C_051-261-0_D_V1-0.zip
2024-01-10T21:50:57.041    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:50:57.041    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:50:57.041    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:50:57.041    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:50:57.041    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:50:57.041    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:50:57.041    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:50:57.041    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990706-105518-132_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/06/SPOT1-HRV1-XS_19990706-105526-557_L1C_051-262-0_D_V1-0/SPOT1-HRV1-XS_19990706-105526-557_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990706-105526-557_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990706-105526-557_L1C_051-262-0_D_V1-0.zip
run script
2024-01-10T21:52:43.298    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:52:43.299    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990706-105526-557_L1C_051-262-0_D_V1-0.zip
2024-01-10T21:52:43.299    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:52:43.299    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:52:43.299    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:52:43.299    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:52:43.299    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:52:43.300    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:52:43.300    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:52:43.300    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990706-105526-557_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/06/SPOT1-HRV2-XS_19990706-105507-002_L1C_052-260-0_D_V1-0/SPOT1-HRV2-XS_19990706-105507-002_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19990706-105507-002_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990706-105507-002_L1C_052-260-0_D_V1-0.zip
run script
2024-01-10T21:53:58.722    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:53:58.723    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990706-105507-002_L1C_052-260-0_D_V1-0.zip
2024-01-10T21:53:58.723    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:53:58.723    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:53:58.723    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:53:58.723    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:53:58.723    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:53:58.723    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:53:58.723    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:53:58.723    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990706-105507-002_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/06/SPOT1-HRV2-XS_19990706-105515-452_L1C_052-261-0_D_V1-0/SPOT1-HRV2-XS_19990706-105515-452_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19990706-105515-452_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990706-105515-452_L1C_052-261-0_D_V1-0.zip
run script
2024-01-10T21:56:50.237    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:56:50.239    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990706-105515-452_L1C_052-261-0_D_V1-0.zip
2024-01-10T21:56:50.239    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:56:50.239    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:56:50.239    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:56:50.239    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:56:50.239    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:56:50.239    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:56:50.239    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:56:50.239    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990706-105515-452_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/06/SPOT1-HRV2-XS_19990706-105523-907_L1C_052-262-0_D_V1-0/SPOT1-HRV2-XS_19990706-105523-907_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19990706-105523-907_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990706-105523-907_L1C_052-262-0_D_V1-0.zip
run script
2024-01-10T21:59:51.523    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T21:59:51.524    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990706-105523-907_L1C_052-262-0_D_V1-0.zip
2024-01-10T21:59:51.524    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:59:51.524    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:59:51.524    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T21:59:51.524    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:59:51.524    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:59:51.524    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:59:51.525    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:59:51.525    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990706-105523-907_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/06/SPOT1-HRV2-XS_19990706-105526-615_L1C_052-262-3_D_V1-0/SPOT1-HRV2-XS_19990706-105526-615_L1C_052-262-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19990706-105526-615_L1C_052-262-3_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990706-105526-615_L1C_052-262-3_D_V1-0.zip
run script
2024-01-10T22:02:36.511    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T22:02:36.512    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990706-105526-615_L1C_052-262-3_D_V1-0.zip
2024-01-10T22:02:36.512    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:02:36.512    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:02:36.512    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T22:02:36.512    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:02:36.512    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:02:36.512    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:02:36.512    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:02:36.513    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990706-105526-615_L1C_052-262-3_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/06/SPOT1-HRV2-XS_19990706-105505-772_L1C_053-259-8_D_V1-0/SPOT1-HRV2-XS_19990706-105505-772_L1C_053-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19990706-105505-772_L1C_053-259-8_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990706-105505-772_L1C_053-259-8_D_V1-0.zip
run script
2024-01-10T22:05:05.999    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T22:05:06.001    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990706-105505-772_L1C_053-259-8_D_V1-0.zip
2024-01-10T22:05:06.001    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:05:06.001    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:05:06.001    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T22:05:06.001    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:05:06.001    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:05:06.001    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:05:06.001    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:05:06.001    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990706-105505-772_L1C_053-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/16/SPOT1-HRV2-XS_19990716-110254-157_L1C_051-260-9_D_V1-0/SPOT1-HRV2-XS_19990716-110254-157_L1C_051-260-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19990716-110254-157_L1C_051-260-9_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990716-110254-157_L1C_051-260-9_D_V1-0.zip
run script
2024-01-10T22:08:02.911    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T22:08:02.912    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990716-110254-157_L1C_051-260-9_D_V1-0.zip
2024-01-10T22:08:02.912    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:08:02.912    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:08:02.912    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T22:08:02.912    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:08:02.912    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:08:02.912    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:08:02.912    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:08:02.913    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T22:10:16.003    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (126 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990716-110254-157_L1C_051-260-9_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1999/07/16/SPOT1-HRV2-XS_19990716-110303-022_L1C_051-262-0_D_V1-0/SPOT1-HRV2-XS_19990716-110303-022_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19990716-110303-022_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990716-110303-022_L1C_051-262-0_D_V1-0.zip
run script
2024-01-10T22:10:19.048    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T22:10:19.049    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990716-110303-022_L1C_051-262-0_D_V1-0.zip
2024-01-10T22:10:19.049    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:10:19.050    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:10:19.050    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T22:10:19.050    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:10:19.050    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:10:19.050    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:10:19.050    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:10:19.050    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990716-110303-022_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/16/SPOT1-HRV2-XS_19990716-110306-631_L1C_051-262-4_D_V1-0/SPOT1-HRV2-XS_19990716-110306-631_L1C_051-262-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19990716-110306-631_L1C_051-262-4_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990716-110306-631_L1C_051-262-4_D_V1-0.zip
run script
2024-01-10T22:11:52.250    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T22:11:52.251    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990716-110306-631_L1C_051-262-4_D_V1-0.zip
2024-01-10T22:11:52.251    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:11:52.251    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:11:52.251    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T22:11:52.251    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:11:52.251    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:11:52.251    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:11:52.251    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:11:52.251    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990716-110306-631_L1C_051-262-4_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/12/SPOT1-HRV1-XS_19990712-103957-538_L1C_051-262-1_D_V1-0/SPOT1-HRV1-XS_19990712-103957-538_L1C_051-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990712-103957-538_L1C_051-262-1_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990712-103957-538_L1C_051-262-1_D_V1-0.zip
run script
2024-01-10T22:13:00.538    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T22:13:00.539    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990712-103957-538_L1C_051-262-1_D_V1-0.zip
2024-01-10T22:13:00.539    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:13:00.539    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:13:00.539    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T22:13:00.539    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:13:00.539    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:13:00.539    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:13:00.539    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:13:00.539    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990712-103957-538_L1C_051-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/12/SPOT1-HRV1-XS_19990712-104004-976_L1C_051-263-0_D_V1-0/SPOT1-HRV1-XS_19990712-104004-976_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990712-104004-976_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990712-104004-976_L1C_051-263-0_D_V1-0.zip
run script
2024-01-10T22:14:34.515    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T22:14:34.517    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990712-104004-976_L1C_051-263-0_D_V1-0.zip
2024-01-10T22:14:34.517    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:14:34.517    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:14:34.517    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T22:14:34.517    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:14:34.517    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:14:34.517    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:14:34.517    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:14:34.517    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990712-104004-976_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/02/27/SPOT1-HRV1-XS_19990227-103536-140_L1C_052-257-5_D_V1-0/SPOT1-HRV1-XS_19990227-103536-140_L1C_052-257-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990227-103536-140_L1C_052-257-5_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990227-103536-140_L1C_052-257-5_D_V1-0.zip
run script
2024-01-10T22:15:16.885    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T22:15:16.887    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990227-103536-140_L1C_052-257-5_D_V1-0.zip
2024-01-10T22:15:16.887    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:15:16.887    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:15:16.887    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T22:15:16.887    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:15:16.887    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:15:16.887    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:15:16.887    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:15:16.887    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990227-103536-140_L1C_052-257-5_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/02/27/SPOT1-HRV1-XS_19990227-103539-915_L1C_052-258-0_D_V1-0/SPOT1-HRV1-XS_19990227-103539-915_L1C_052-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990227-103539-915_L1C_052-258-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990227-103539-915_L1C_052-258-0_D_V1-0.zip
run script
2024-01-10T22:17:52.194    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T22:17:52.195    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990227-103539-915_L1C_052-258-0_D_V1-0.zip
2024-01-10T22:17:52.195    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:17:52.195    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:17:52.195    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T22:17:52.195    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:17:52.195    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:17:52.195    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:17:52.195    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:17:52.195    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990227-103539-915_L1C_052-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/02/27/SPOT1-HRV1-XS_19990227-103548-214_L1C_052-259-0_D_V1-0/SPOT1-HRV1-XS_19990227-103548-214_L1C_052-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990227-103548-214_L1C_052-259-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990227-103548-214_L1C_052-259-0_D_V1-0.zip
run script
2024-01-10T22:20:20.022    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T22:20:20.024    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990227-103548-214_L1C_052-259-0_D_V1-0.zip
2024-01-10T22:20:20.024    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:20:20.024    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:20:20.024    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T22:20:20.024    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:20:20.024    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:20:20.024    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:20:20.024    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:20:20.024    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990227-103548-214_L1C_052-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 1 1 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 1 1 0]
 [1 1 1 ... 1 0 0]
 [1 1 1 ... 0 0 0]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/03/30/SPOT1-HRV1-XS_19990330-103924-934_L1C_052-257-6_D_V1-0/SPOT1-HRV1-XS_19990330-103924-934_L1C_052-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990330-103924-934_L1C_052-257-6_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990330-103924-934_L1C_052-257-6_D_V1-0.zip
run script
2024-01-10T22:22:58.450    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T22:22:58.451    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990330-103924-934_L1C_052-257-6_D_V1-0.zip
2024-01-10T22:22:58.451    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:22:58.451    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:22:58.451    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T22:22:58.451    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:22:58.451    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:22:58.451    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:22:58.451    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:22:58.451    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990330-103924-934_L1C_052-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/03/30/SPOT1-HRV1-XS_19990330-103927-827_L1C_052-258-0_D_V1-0/SPOT1-HRV1-XS_19990330-103927-827_L1C_052-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990330-103927-827_L1C_052-258-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990330-103927-827_L1C_052-258-0_D_V1-0.zip
run script
2024-01-10T22:25:44.128    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T22:25:44.129    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990330-103927-827_L1C_052-258-0_D_V1-0.zip
2024-01-10T22:25:44.129    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:25:44.129    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:25:44.129    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T22:25:44.129    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:25:44.129    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:25:44.129    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:25:44.129    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:25:44.130    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990330-103927-827_L1C_052-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/03/30/SPOT1-HRV1-XS_19990330-103936-141_L1C_052-259-0_D_V1-0/SPOT1-HRV1-XS_19990330-103936-141_L1C_052-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990330-103936-141_L1C_052-259-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990330-103936-141_L1C_052-259-0_D_V1-0.zip
run script
2024-01-10T22:28:17.695    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T22:28:17.697    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990330-103936-141_L1C_052-259-0_D_V1-0.zip
2024-01-10T22:28:17.697    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:28:17.697    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:28:17.697    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T22:28:17.697    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:28:17.697    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:28:17.697    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:28:17.697    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:28:17.697    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990330-103936-141_L1C_052-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/03/30/SPOT1-HRV1-XS_19990330-103944-462_L1C_052-260-0_D_V1-0/SPOT1-HRV1-XS_19990330-103944-462_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990330-103944-462_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990330-103944-462_L1C_052-260-0_D_V1-0.zip
run script
2024-01-10T22:30:59.714    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T22:30:59.715    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990330-103944-462_L1C_052-260-0_D_V1-0.zip
2024-01-10T22:30:59.715    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:30:59.715    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:30:59.715    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T22:30:59.715    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:30:59.715    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:30:59.715    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:30:59.716    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:30:59.716    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990330-103944-462_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/08/SPOT1-HRV1-XS_19990708-101609-750_L1C_052-257-6_D_V1-0/SPOT1-HRV1-XS_19990708-101609-750_L1C_052-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990708-101609-750_L1C_052-257-6_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990708-101609-750_L1C_052-257-6_D_V1-0.zip
run script
2024-01-10T22:33:22.897    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T22:33:22.899    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990708-101609-750_L1C_052-257-6_D_V1-0.zip
2024-01-10T22:33:22.899    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:33:22.899    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:33:22.899    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T22:33:22.899    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:33:22.899    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:33:22.899    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:33:22.899    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:33:22.900    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990708-101609-750_L1C_052-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/08/SPOT1-HRV1-XS_19990708-101612-553_L1C_052-258-0_D_V1-0/SPOT1-HRV1-XS_19990708-101612-553_L1C_052-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990708-101612-553_L1C_052-258-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990708-101612-553_L1C_052-258-0_D_V1-0.zip
run script
2024-01-10T22:36:25.074    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T22:36:25.075    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990708-101612-553_L1C_052-258-0_D_V1-0.zip
2024-01-10T22:36:25.076    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:36:25.076    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:36:25.076    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T22:36:25.076    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:36:25.076    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:36:25.076    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:36:25.076    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:36:25.076    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990708-101612-553_L1C_052-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/08/SPOT1-HRV1-XS_19990708-101620-780_L1C_052-259-0_D_V1-0/SPOT1-HRV1-XS_19990708-101620-780_L1C_052-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990708-101620-780_L1C_052-259-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990708-101620-780_L1C_052-259-0_D_V1-0.zip
run script
2024-01-10T22:39:05.977    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T22:39:05.978    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990708-101620-780_L1C_052-259-0_D_V1-0.zip
2024-01-10T22:39:05.978    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:39:05.979    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:39:05.979    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T22:39:05.979    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:39:05.979    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:39:05.979    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:39:05.979    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:39:05.979    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990708-101620-780_L1C_052-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/08/SPOT1-HRV1-XS_19990708-101629-016_L1C_052-260-0_D_V1-0/SPOT1-HRV1-XS_19990708-101629-016_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990708-101629-016_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990708-101629-016_L1C_052-260-0_D_V1-0.zip
run script
2024-01-10T22:42:02.465    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T22:42:02.466    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990708-101629-016_L1C_052-260-0_D_V1-0.zip
2024-01-10T22:42:02.467    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:42:02.467    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:42:02.467    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T22:42:02.467    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:42:02.467    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:42:02.467    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:42:02.467    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:42:02.467    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990708-101629-016_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/08/SPOT1-HRV1-XS_19990708-101630-821_L1C_052-260-2_D_V1-0/SPOT1-HRV1-XS_19990708-101630-821_L1C_052-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990708-101630-821_L1C_052-260-2_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990708-101630-821_L1C_052-260-2_D_V1-0.zip
run script
2024-01-10T22:44:41.121    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T22:44:41.122    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990708-101630-821_L1C_052-260-2_D_V1-0.zip
2024-01-10T22:44:41.122    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:44:41.122    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:44:41.122    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T22:44:41.122    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:44:41.122    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:44:41.122    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:44:41.122    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:44:41.122    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T22:45:55.496    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 830). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990708-101630-821_L1C_052-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1999/07/23/SPOT1-HRV1-XS_19990723-102736-649_L1C_052-257-6_D_V1-0/SPOT1-HRV1-XS_19990723-102736-649_L1C_052-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990723-102736-649_L1C_052-257-6_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990723-102736-649_L1C_052-257-6_D_V1-0.zip
run script
2024-01-10T22:45:58.600    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T22:45:58.600    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990723-102736-649_L1C_052-257-6_D_V1-0.zip
2024-01-10T22:45:58.600    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:45:58.600    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:45:58.600    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T22:45:58.600    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:45:58.600    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:45:58.601    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:45:58.601    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:45:58.601    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990723-102736-649_L1C_052-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/23/SPOT1-HRV1-XS_19990723-102739-486_L1C_052-258-0_D_V1-0/SPOT1-HRV1-XS_19990723-102739-486_L1C_052-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990723-102739-486_L1C_052-258-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990723-102739-486_L1C_052-258-0_D_V1-0.zip
run script
2024-01-10T22:48:38.807    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T22:48:38.808    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990723-102739-486_L1C_052-258-0_D_V1-0.zip
2024-01-10T22:48:38.808    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:48:38.808    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:48:38.808    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T22:48:38.808    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:48:38.808    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:48:38.808    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:48:38.808    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:48:38.808    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990723-102739-486_L1C_052-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/23/SPOT1-HRV1-XS_19990723-102747-746_L1C_052-259-0_D_V1-0/SPOT1-HRV1-XS_19990723-102747-746_L1C_052-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990723-102747-746_L1C_052-259-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990723-102747-746_L1C_052-259-0_D_V1-0.zip
run script
2024-01-10T22:51:04.424    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T22:51:04.425    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990723-102747-746_L1C_052-259-0_D_V1-0.zip
2024-01-10T22:51:04.425    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:51:04.425    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:51:04.425    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T22:51:04.425    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:51:04.425    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:51:04.425    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:51:04.425    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:51:04.425    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990723-102747-746_L1C_052-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/23/SPOT1-HRV1-XS_19990723-102756-917_L1C_052-260-1_D_V1-0/SPOT1-HRV1-XS_19990723-102756-917_L1C_052-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990723-102756-917_L1C_052-260-1_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990723-102756-917_L1C_052-260-1_D_V1-0.zip
run script
2024-01-10T22:53:38.742    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T22:53:38.743    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990723-102756-917_L1C_052-260-1_D_V1-0.zip
2024-01-10T22:53:38.744    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:53:38.744    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:53:38.744    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T22:53:38.744    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:53:38.744    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:53:38.744    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:53:38.744    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:53:38.744    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990723-102756-917_L1C_052-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/08/13/SPOT1-HRV1-XS_19990813-102331-573_L1C_052-257-7_D_V1-0/SPOT1-HRV1-XS_19990813-102331-573_L1C_052-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990813-102331-573_L1C_052-257-7_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990813-102331-573_L1C_052-257-7_D_V1-0.zip
run script
2024-01-10T22:55:51.112    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T22:55:51.114    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990813-102331-573_L1C_052-257-7_D_V1-0.zip
2024-01-10T22:55:51.114    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:55:51.114    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:55:51.114    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T22:55:51.114    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:55:51.114    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:55:51.114    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:55:51.114    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:55:51.114    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990813-102331-573_L1C_052-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 0]
 [2 2 2 ... 1 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/08/13/SPOT1-HRV1-XS_19990813-102333-495_L1C_052-258-0_D_V1-0/SPOT1-HRV1-XS_19990813-102333-495_L1C_052-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990813-102333-495_L1C_052-258-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990813-102333-495_L1C_052-258-0_D_V1-0.zip
run script
2024-01-10T22:58:12.341    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T22:58:12.342    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990813-102333-495_L1C_052-258-0_D_V1-0.zip
2024-01-10T22:58:12.342    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:58:12.342    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:58:12.342    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T22:58:12.342    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:58:12.342    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:58:12.342    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:58:12.343    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:58:12.343    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990813-102333-495_L1C_052-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/08/13/SPOT1-HRV1-XS_19990813-102341-740_L1C_052-259-0_D_V1-0/SPOT1-HRV1-XS_19990813-102341-740_L1C_052-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990813-102341-740_L1C_052-259-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990813-102341-740_L1C_052-259-0_D_V1-0.zip
run script
2024-01-10T23:00:25.087    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:00:25.088    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990813-102341-740_L1C_052-259-0_D_V1-0.zip
2024-01-10T23:00:25.088    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:00:25.088    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:00:25.088    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:00:25.088    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:00:25.088    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:00:25.088    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:00:25.089    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:00:25.089    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990813-102341-740_L1C_052-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 1 ... 0 0 0]
 [0 1 0 ... 0 0 0]
 [0 1 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/08/13/SPOT1-HRV1-XS_19990813-102349-994_L1C_052-260-0_D_V1-0/SPOT1-HRV1-XS_19990813-102349-994_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990813-102349-994_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990813-102349-994_L1C_052-260-0_D_V1-0.zip
run script
2024-01-10T23:03:05.601    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:03:05.602    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990813-102349-994_L1C_052-260-0_D_V1-0.zip
2024-01-10T23:03:05.602    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:03:05.602    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:03:05.602    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:03:05.602    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:03:05.602    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:03:05.602    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:03:05.602    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:03:05.602    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990813-102349-994_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/08/13/SPOT1-HRV1-XS_19990813-102358-260_L1C_052-261-0_D_V1-0/SPOT1-HRV1-XS_19990813-102358-260_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990813-102358-260_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990813-102358-260_L1C_052-261-0_D_V1-0.zip
run script
2024-01-10T23:05:27.281    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:05:27.282    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990813-102358-260_L1C_052-261-0_D_V1-0.zip
2024-01-10T23:05:27.282    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:05:27.282    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:05:27.282    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:05:27.282    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:05:27.283    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:05:27.283    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:05:27.283    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:05:27.283    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990813-102358-260_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/08/13/SPOT1-HRV1-XS_19990813-102406-532_L1C_052-262-0_D_V1-0/SPOT1-HRV1-XS_19990813-102406-532_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990813-102406-532_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990813-102406-532_L1C_052-262-0_D_V1-0.zip
run script
2024-01-10T23:08:05.383    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:08:05.384    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990813-102406-532_L1C_052-262-0_D_V1-0.zip
2024-01-10T23:08:05.384    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:08:05.384    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:08:05.384    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:08:05.384    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:08:05.385    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:08:05.385    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:08:05.385    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:08:05.385    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990813-102406-532_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/08/13/SPOT1-HRV1-XS_19990813-102408-337_L1C_052-262-2_D_V1-0/SPOT1-HRV1-XS_19990813-102408-337_L1C_052-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990813-102408-337_L1C_052-262-2_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990813-102408-337_L1C_052-262-2_D_V1-0.zip
run script
2024-01-10T23:10:15.672    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:10:15.673    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990813-102408-337_L1C_052-262-2_D_V1-0.zip
2024-01-10T23:10:15.673    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:10:15.673    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:10:15.673    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:10:15.673    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:10:15.674    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:10:15.674    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:10:15.674    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:10:15.674    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990813-102408-337_L1C_052-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/08/13/SPOT1-HRV2-XS_19990813-102356-525_L1C_054-261-0_D_V1-0/SPOT1-HRV2-XS_19990813-102356-525_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19990813-102356-525_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990813-102356-525_L1C_054-261-0_D_V1-0.zip
run script
2024-01-10T23:12:24.874    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:12:24.875    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990813-102356-525_L1C_054-261-0_D_V1-0.zip
2024-01-10T23:12:24.875    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:12:24.875    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:12:24.875    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:12:24.875    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:12:24.875    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:12:24.876    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:12:24.876    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:12:24.876    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990813-102356-525_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/08/13/SPOT1-HRV2-XS_19990813-102404-809_L1C_054-262-0_D_V1-0/SPOT1-HRV2-XS_19990813-102404-809_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19990813-102404-809_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990813-102404-809_L1C_054-262-0_D_V1-0.zip
run script
2024-01-10T23:14:02.129    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:14:02.131    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990813-102404-809_L1C_054-262-0_D_V1-0.zip
2024-01-10T23:14:02.131    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:14:02.131    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:14:02.131    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:14:02.131    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:14:02.131    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:14:02.131    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:14:02.131    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:14:02.131    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990813-102404-809_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/08/13/SPOT1-HRV2-XS_19990813-102408-418_L1C_054-262-4_D_V1-0/SPOT1-HRV2-XS_19990813-102408-418_L1C_054-262-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19990813-102408-418_L1C_054-262-4_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990813-102408-418_L1C_054-262-4_D_V1-0.zip
run script
2024-01-10T23:15:31.737    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:15:31.739    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990813-102408-418_L1C_054-262-4_D_V1-0.zip
2024-01-10T23:15:31.739    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:15:31.739    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:15:31.739    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:15:31.739    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:15:31.739    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:15:31.739    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:15:31.739    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:15:31.739    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T23:15:34.490    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (402 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990813-102408-418_L1C_054-262-4_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1999/03/25/SPOT1-HRV1-XS_19990325-103538-345_L1C_052-258-0_D_V1-0/SPOT1-HRV1-XS_19990325-103538-345_L1C_052-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19990325-103538-345_L1C_052-258-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990325-103538-345_L1C_052-258-0_D_V1-0.zip
run script
2024-01-10T23:15:37.226    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:15:37.226    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990325-103538-345_L1C_052-258-0_D_V1-0.zip
2024-01-10T23:15:37.226    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:15:37.226    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:15:37.226    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:15:37.226    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:15:37.227    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:15:37.227    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:15:37.227    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:15:37.227    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990325-103538-345_L1C_052-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/04/25/SPOT1-HRV2-XS_19990425-103924-819_L1C_052-258-0_D_V1-0/SPOT1-HRV2-XS_19990425-103924-819_L1C_052-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19990425-103924-819_L1C_052-258-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990425-103924-819_L1C_052-258-0_D_V1-0.zip
run script
2024-01-10T23:17:57.439    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:17:57.440    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990425-103924-819_L1C_052-258-0_D_V1-0.zip
2024-01-10T23:17:57.440    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:17:57.440    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:17:57.440    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:17:57.440    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:17:57.440    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:17:57.440    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:17:57.440    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:17:57.440    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990425-103924-819_L1C_052-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/04/25/SPOT1-HRV2-XS_19990425-103941-460_L1C_052-260-0_D_V1-0/SPOT1-HRV2-XS_19990425-103941-460_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19990425-103941-460_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990425-103941-460_L1C_052-260-0_D_V1-0.zip
run script
2024-01-10T23:20:02.884    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:20:02.885    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990425-103941-460_L1C_052-260-0_D_V1-0.zip
2024-01-10T23:20:02.885    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:20:02.885    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:20:02.885    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:20:02.885    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:20:02.886    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:20:02.886    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:20:02.886    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:20:02.886    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990425-103941-460_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/04/25/SPOT1-HRV2-XS_19990425-103945-069_L1C_052-260-4_D_V1-0/SPOT1-HRV2-XS_19990425-103945-069_L1C_052-260-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19990425-103945-069_L1C_052-260-4_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990425-103945-069_L1C_052-260-4_D_V1-0.zip
run script
2024-01-10T23:22:19.000    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:22:19.001    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990425-103945-069_L1C_052-260-4_D_V1-0.zip
2024-01-10T23:22:19.002    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:22:19.002    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:22:19.002    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:22:19.002    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:22:19.002    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:22:19.002    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:22:19.002    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:22:19.002    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990425-103945-069_L1C_052-260-4_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 1 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 1 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/11/18/SPOT1-HRV1-XS_19991118-105756-044_L1C_052-260-0_D_V1-0/SPOT1-HRV1-XS_19991118-105756-044_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19991118-105756-044_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991118-105756-044_L1C_052-260-0_D_V1-0.zip
run script
2024-01-10T23:24:48.089    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:24:48.090    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991118-105756-044_L1C_052-260-0_D_V1-0.zip
2024-01-10T23:24:48.090    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:24:48.091    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:24:48.091    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:24:48.091    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:24:48.091    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:24:48.091    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:24:48.091    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:24:48.091    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991118-105756-044_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 2 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/11/18/SPOT1-HRV1-XS_19991118-105758-751_L1C_052-260-3_D_V1-0/SPOT1-HRV1-XS_19991118-105758-751_L1C_052-260-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19991118-105758-751_L1C_052-260-3_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991118-105758-751_L1C_052-260-3_D_V1-0.zip
run script
2024-01-10T23:27:37.731    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:27:37.732    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991118-105758-751_L1C_052-260-3_D_V1-0.zip
2024-01-10T23:27:37.732    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:27:37.732    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:27:37.732    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:27:37.732    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:27:37.732    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:27:37.732    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:27:37.732    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:27:37.732    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19991118-105758-751_L1C_052-260-3_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/02/21/SPOT1-HRV1-XS_19990221-105122-449_L1C_054-260-5_D_V1-0/SPOT1-HRV1-XS_19990221-105122-449_L1C_054-260-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990221-105122-449_L1C_054-260-5_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990221-105122-449_L1C_054-260-5_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/1999/05/27/SPOT1-HRV1-XS_19990527-102410-739_L1C_054-261-0_D_V1-0/SPOT1-HRV1-XS_19990527-102410-739_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990527-102410-739_L1C_054-261-0_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990527-102410-739_L1C_054-261-0_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/1999/05/27/SPOT1-HRV1-XS_19990527-102417-958_L1C_054-261-8_D_V1-0/SPOT1-HRV1-XS_19990527-102417-958_L1C_054-261-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990527-102417-958_L1C_054-261-8_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4122155/INPUT/SPOT1-HRV1-XS_19990527-102417-958_L1C_054-261-8_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/1999/05/21/SPOT1-HRV2-XS_19990521-103952-354_L1C_054-262-3_D_V1-0/SPOT1-HRV2-XS_19990521-103952-354_L1C_054-262-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990521-103952-354_L1C_054-262-3_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990521-103952-354_L1C_054-262-3_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/1999/05/21/SPOT1-HRV2-XS_19990521-103954-158_L1C_054-262-5_D_V1-0/SPOT1-HRV2-XS_19990521-103954-158_L1C_054-262-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990521-103954-158_L1C_054-262-5_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4122155/INPUT/SPOT1-HRV2-XS_19990521-103954-158_L1C_054-262-5_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/2007/11/29/SPOT5-HRG2-XS_20071129-110156-109_L1C_047-255-9_D_V1-0/SPOT5-HRG2-XS_20071129-110156-109_L1C_047-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071129-110156-109_L1C_047-255-9_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071129-110156-109_L1C_047-255-9_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/2007/11/29/SPOT5-HRG2-XS_20071129-110157-312_L1C_047-256-1_D_V1-0/SPOT5-HRG2-XS_20071129-110157-312_L1C_047-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20071129-110157-312_L1C_047-256-1_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071129-110157-312_L1C_047-256-1_D_V1-0.zip
run script
2024-01-10T23:31:02.808    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:31:02.810    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071129-110157-312_L1C_047-256-1_D_V1-0.zip
2024-01-10T23:31:02.810    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:31:02.810    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:31:02.810    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:31:02.810    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:31:02.810    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:31:02.810    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:31:02.810    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:31:02.810    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071129-110157-312_L1C_047-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/01/21/SPOT5-HRG1-XS_20070121-110550-079_L1C_047-256-8_D_V1-0/SPOT5-HRG1-XS_20070121-110550-079_L1C_047-256-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070121-110550-079_L1C_047-256-8_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070121-110550-079_L1C_047-256-8_D_V1-0.zip
run script
2024-01-10T23:31:08.262    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:31:08.263    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070121-110550-079_L1C_047-256-8_D_V1-0.zip
2024-01-10T23:31:08.263    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:31:08.263    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:31:08.263    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:31:08.263    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:31:08.263    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:31:08.263    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:31:08.263    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:31:08.263    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T23:31:13.545    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (330 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070121-110550-079_L1C_047-256-8_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2007/01/21/SPOT5-HRG1-XS_20070121-110551-307_L1C_047-257-0_D_V1-0/SPOT5-HRG1-XS_20070121-110551-307_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070121-110551-307_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070121-110551-307_L1C_047-257-0_D_V1-0.zip
run script
2024-01-10T23:31:18.797    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:31:18.798    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070121-110551-307_L1C_047-257-0_D_V1-0.zip
2024-01-10T23:31:18.798    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:31:18.798    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:31:18.798    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:31:18.798    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:31:18.798    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:31:18.798    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:31:18.798    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:31:18.798    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T23:31:24.139    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (228 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070121-110551-307_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2007/01/21/SPOT5-HRG1-XS_20070121-110553-111_L1C_047-257-2_D_V1-0/SPOT5-HRG1-XS_20070121-110553-111_L1C_047-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070121-110553-111_L1C_047-257-2_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070121-110553-111_L1C_047-257-2_D_V1-0.zip
run script
2024-01-10T23:31:30.179    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:31:30.179    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070121-110553-111_L1C_047-257-2_D_V1-0.zip
2024-01-10T23:31:30.180    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:31:30.180    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:31:30.180    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:31:30.180    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:31:30.180    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:31:30.180    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:31:30.180    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:31:30.180    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070121-110553-111_L1C_047-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/10/03/SPOT5-HRG2-XS_20071003-105821-905_L1C_047-256-8_D_V1-0/SPOT5-HRG2-XS_20071003-105821-905_L1C_047-256-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20071003-105821-905_L1C_047-256-8_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071003-105821-905_L1C_047-256-8_D_V1-0.zip
run script
2024-01-10T23:31:38.530    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:31:38.530    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071003-105821-905_L1C_047-256-8_D_V1-0.zip
2024-01-10T23:31:38.530    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:31:38.530    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:31:38.530    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:31:38.530    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:31:38.530    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:31:38.530    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:31:38.530    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:31:38.530    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071003-105821-905_L1C_047-256-8_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/10/03/SPOT5-HRG2-XS_20071003-105823-084_L1C_047-257-0_D_V1-0/SPOT5-HRG2-XS_20071003-105823-084_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20071003-105823-084_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071003-105823-084_L1C_047-257-0_D_V1-0.zip
run script
2024-01-10T23:31:43.677    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:31:43.678    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071003-105823-084_L1C_047-257-0_D_V1-0.zip
2024-01-10T23:31:43.678    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:31:43.678    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:31:43.678    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:31:43.678    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:31:43.678    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:31:43.678    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:31:43.678    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:31:43.678    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071003-105823-084_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/10/03/SPOT5-HRG2-XS_20071003-105754-457_L1C_049-254-0_D_V1-0/SPOT5-HRG2-XS_20071003-105754-457_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20071003-105754-457_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071003-105754-457_L1C_049-254-0_D_V1-0.zip
run script
2024-01-10T23:31:47.861    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:31:47.864    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071003-105754-457_L1C_049-254-0_D_V1-0.zip
2024-01-10T23:31:47.864    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:31:47.864    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:31:47.864    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:31:47.865    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:31:47.865    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:31:47.865    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:31:47.865    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:31:47.865    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071003-105754-457_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/11/15/SPOT5-HRG2-XS_20071115-103119-250_L1C_047-256-8_D_V1-0/SPOT5-HRG2-XS_20071115-103119-250_L1C_047-256-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20071115-103119-250_L1C_047-256-8_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071115-103119-250_L1C_047-256-8_D_V1-0.zip
run script
2024-01-10T23:31:52.822    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:31:52.823    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071115-103119-250_L1C_047-256-8_D_V1-0.zip
2024-01-10T23:31:52.823    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:31:52.823    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:31:52.823    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:31:52.823    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:31:52.824    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:31:52.824    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:31:52.824    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:31:52.824    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071115-103119-250_L1C_047-256-8_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/11/15/SPOT5-HRG2-XS_20071115-103120-285_L1C_047-257-0_D_V1-0/SPOT5-HRG2-XS_20071115-103120-285_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20071115-103120-285_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071115-103120-285_L1C_047-257-0_D_V1-0.zip
run script
2024-01-10T23:31:58.810    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:31:58.811    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071115-103120-285_L1C_047-257-0_D_V1-0.zip
2024-01-10T23:31:58.811    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:31:58.811    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:31:58.811    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:31:58.811    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:31:58.811    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:31:58.811    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:31:58.811    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:31:58.811    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071115-103120-285_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/11/15/SPOT5-HRG2-XS_20071115-103122-090_L1C_047-257-2_D_V1-0/SPOT5-HRG2-XS_20071115-103122-090_L1C_047-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20071115-103122-090_L1C_047-257-2_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071115-103122-090_L1C_047-257-2_D_V1-0.zip
run script
2024-01-10T23:32:04.133    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:32:04.134    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071115-103122-090_L1C_047-257-2_D_V1-0.zip
2024-01-10T23:32:04.134    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:32:04.134    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:32:04.134    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:32:04.134    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:32:04.134    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:32:04.134    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:32:04.134    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:32:04.134    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071115-103122-090_L1C_047-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/11/15/SPOT5-HRG2-XS_20071115-103152-301_L1C_048-261-0_D_V1-0/SPOT5-HRG2-XS_20071115-103152-301_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20071115-103152-301_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071115-103152-301_L1C_048-261-0_D_V1-0.zip
run script
2024-01-10T23:32:09.784    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:32:09.785    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071115-103152-301_L1C_048-261-0_D_V1-0.zip
2024-01-10T23:32:09.786    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:32:09.786    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:32:09.786    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:32:09.786    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:32:09.786    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:32:09.786    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:32:09.786    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:32:09.786    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071115-103152-301_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/12/16/SPOT5-HRG2-XS_20071216-103454-321_L1C_047-256-0_D_V1-0/SPOT5-HRG2-XS_20071216-103454-321_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20071216-103454-321_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071216-103454-321_L1C_047-256-0_D_V1-0.zip
run script
2024-01-10T23:32:14.770    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:32:14.770    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071216-103454-321_L1C_047-256-0_D_V1-0.zip
2024-01-10T23:32:14.770    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:32:14.770    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:32:14.771    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:32:14.771    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:32:14.771    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:32:14.771    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:32:14.771    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:32:14.771    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071216-103454-321_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/12/16/SPOT5-HRG2-XS_20071216-103456-125_L1C_047-256-2_D_V1-0/SPOT5-HRG2-XS_20071216-103456-125_L1C_047-256-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20071216-103456-125_L1C_047-256-2_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071216-103456-125_L1C_047-256-2_D_V1-0.zip
run script
2024-01-10T23:32:19.941    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:32:19.942    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071216-103456-125_L1C_047-256-2_D_V1-0.zip
2024-01-10T23:32:19.942    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:32:19.942    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:32:19.942    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:32:19.942    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:32:19.942    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:32:19.942    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:32:19.942    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:32:19.942    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071216-103456-125_L1C_047-256-2_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/04/01/SPOT5-HRG1-XS_20070401-101833-685_L1C_048-254-0_D_V1-0/SPOT5-HRG1-XS_20070401-101833-685_L1C_048-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070401-101833-685_L1C_048-254-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070401-101833-685_L1C_048-254-0_D_V1-0.zip
run script
2024-01-10T23:32:25.562    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:32:25.563    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070401-101833-685_L1C_048-254-0_D_V1-0.zip
2024-01-10T23:32:25.564    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:32:25.564    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:32:25.564    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:32:25.564    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:32:25.564    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:32:25.564    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:32:25.564    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:32:25.564    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070401-101833-685_L1C_048-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/04/01/SPOT5-HRG1-XS_20070401-101835-490_L1C_048-254-2_D_V1-0/SPOT5-HRG1-XS_20070401-101835-490_L1C_048-254-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070401-101835-490_L1C_048-254-2_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070401-101835-490_L1C_048-254-2_D_V1-0.zip
run script
2024-01-10T23:32:31.106    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:32:31.106    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070401-101835-490_L1C_048-254-2_D_V1-0.zip
2024-01-10T23:32:31.106    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:32:31.106    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:32:31.106    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:32:31.107    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:32:31.107    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:32:31.107    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:32:31.107    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:32:31.107    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070401-101835-490_L1C_048-254-2_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/04/01/SPOT5-HRG2-XS_20070401-101842-033_L1C_048-254-9_D_V1-0/SPOT5-HRG2-XS_20070401-101842-033_L1C_048-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070401-101842-033_L1C_048-254-9_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070401-101842-033_L1C_048-254-9_D_V1-0.zip
run script
2024-01-10T23:32:36.776    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:32:36.778    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070401-101842-033_L1C_048-254-9_D_V1-0.zip
2024-01-10T23:32:36.778    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:32:36.778    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:32:36.778    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:32:36.778    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:32:36.778    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:32:36.778    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:32:36.778    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:32:36.778    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070401-101842-033_L1C_048-254-9_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/04/01/SPOT5-HRG2-XS_20070401-101842-105_L1C_048-255-0_D_V1-0/SPOT5-HRG2-XS_20070401-101842-105_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070401-101842-105_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070401-101842-105_L1C_048-255-0_D_V1-0.zip
run script
2024-01-10T23:33:18.241    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:33:18.242    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070401-101842-105_L1C_048-255-0_D_V1-0.zip
2024-01-10T23:33:18.243    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:33:18.243    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:33:18.243    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:33:18.243    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:33:18.243    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:33:18.243    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:33:18.243    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:33:18.243    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070401-101842-105_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/04/01/SPOT5-HRG2-XS_20070401-101850-335_L1C_048-256-0_D_V1-0/SPOT5-HRG2-XS_20070401-101850-335_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070401-101850-335_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070401-101850-335_L1C_048-256-0_D_V1-0.zip
run script
2024-01-10T23:33:59.487    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:33:59.489    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070401-101850-335_L1C_048-256-0_D_V1-0.zip
2024-01-10T23:33:59.489    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:33:59.489    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:33:59.489    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:33:59.489    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:33:59.489    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:33:59.489    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:33:59.489    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:33:59.489    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070401-101850-335_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/04/01/SPOT5-HRG2-XS_20070401-101852-140_L1C_048-256-2_D_V1-0/SPOT5-HRG2-XS_20070401-101852-140_L1C_048-256-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070401-101852-140_L1C_048-256-2_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070401-101852-140_L1C_048-256-2_D_V1-0.zip
run script
2024-01-10T23:35:28.769    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:35:28.770    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070401-101852-140_L1C_048-256-2_D_V1-0.zip
2024-01-10T23:35:28.770    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:35:28.771    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:35:28.771    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:35:28.771    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:35:28.771    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:35:28.771    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:35:28.771    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:35:28.771    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070401-101852-140_L1C_048-256-2_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/04/01/SPOT5-HRG1-XS_20070401-101856-194_L1C_050-256-9_D_V1-0/SPOT5-HRG1-XS_20070401-101856-194_L1C_050-256-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070401-101856-194_L1C_050-256-9_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070401-101856-194_L1C_050-256-9_D_V1-0.zip
run script
2024-01-10T23:36:55.609    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:36:55.610    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070401-101856-194_L1C_050-256-9_D_V1-0.zip
2024-01-10T23:36:55.610    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:36:55.610    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:36:55.610    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:36:55.610    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:36:55.610    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:36:55.618    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:36:55.618    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:36:55.619    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070401-101856-194_L1C_050-256-9_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/04/01/SPOT5-HRG1-XS_20070401-101856-314_L1C_050-257-0_D_V1-0/SPOT5-HRG1-XS_20070401-101856-314_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070401-101856-314_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070401-101856-314_L1C_050-257-0_D_V1-0.zip
run script
2024-01-10T23:40:44.655    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:40:44.657    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070401-101856-314_L1C_050-257-0_D_V1-0.zip
2024-01-10T23:40:44.657    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:40:44.657    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:40:44.657    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:40:44.657    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:40:44.657    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:40:44.657    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:40:44.657    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:40:44.657    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070401-101856-314_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/04/01/SPOT5-HRG1-XS_20070401-101858-119_L1C_050-257-2_D_V1-0/SPOT5-HRG1-XS_20070401-101858-119_L1C_050-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070401-101858-119_L1C_050-257-2_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070401-101858-119_L1C_050-257-2_D_V1-0.zip
run script
2024-01-10T23:44:29.268    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:44:29.269    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070401-101858-119_L1C_050-257-2_D_V1-0.zip
2024-01-10T23:44:29.269    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:44:29.269    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:44:29.269    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:44:29.269    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:44:29.269    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:44:29.270    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:44:29.270    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:44:29.270    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070401-101858-119_L1C_050-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/04/06/SPOT5-HRG1-XS_20070406-102229-925_L1C_048-254-9_D_V1-0/SPOT5-HRG1-XS_20070406-102229-925_L1C_048-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070406-102229-925_L1C_048-254-9_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070406-102229-925_L1C_048-254-9_D_V1-0.zip
run script
2024-01-10T23:48:18.947    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:48:18.949    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070406-102229-925_L1C_048-254-9_D_V1-0.zip
2024-01-10T23:48:18.949    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:48:18.949    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:48:18.949    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:48:18.949    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:48:18.949    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:48:18.949    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:48:18.949    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:48:18.949    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070406-102229-925_L1C_048-254-9_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/04/06/SPOT5-HRG1-XS_20070406-102229-997_L1C_048-255-0_D_V1-0/SPOT5-HRG1-XS_20070406-102229-997_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070406-102229-997_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070406-102229-997_L1C_048-255-0_D_V1-0.zip
run script
2024-01-10T23:48:50.243    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:48:50.244    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070406-102229-997_L1C_048-255-0_D_V1-0.zip
2024-01-10T23:48:50.244    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:48:50.245    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:48:50.245    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:48:50.245    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:48:50.245    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:48:50.245    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:48:50.245    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:48:50.245    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070406-102229-997_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/04/06/SPOT5-HRG1-XS_20070406-102231-802_L1C_048-255-2_D_V1-0/SPOT5-HRG1-XS_20070406-102231-802_L1C_048-255-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070406-102231-802_L1C_048-255-2_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070406-102231-802_L1C_048-255-2_D_V1-0.zip
run script
2024-01-10T23:49:22.621    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:49:22.622    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070406-102231-802_L1C_048-255-2_D_V1-0.zip
2024-01-10T23:49:22.622    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:49:22.622    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:49:22.622    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:49:22.622    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:49:22.622    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:49:22.623    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:49:22.623    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:49:22.623    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070406-102231-802_L1C_048-255-2_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/04/06/SPOT5-HRG1-XS_20070406-102246-370_L1C_048-256-9_D_V1-0/SPOT5-HRG1-XS_20070406-102246-370_L1C_048-256-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070406-102246-370_L1C_048-256-9_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070406-102246-370_L1C_048-256-9_D_V1-0.zip
run script
2024-01-10T23:50:03.282    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:50:03.283    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070406-102246-370_L1C_048-256-9_D_V1-0.zip
2024-01-10T23:50:03.283    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:50:03.283    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:50:03.283    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:50:03.283    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:50:03.283    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:50:03.283    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:50:03.283    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:50:03.283    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070406-102246-370_L1C_048-256-9_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/04/06/SPOT5-HRG1-XS_20070406-102246-466_L1C_048-257-0_D_V1-0/SPOT5-HRG1-XS_20070406-102246-466_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070406-102246-466_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070406-102246-466_L1C_048-257-0_D_V1-0.zip
run script
2024-01-10T23:51:04.053    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:51:04.054    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070406-102246-466_L1C_048-257-0_D_V1-0.zip
2024-01-10T23:51:04.054    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:51:04.054    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:51:04.054    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:51:04.054    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:51:04.054    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:51:04.054    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:51:04.055    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:51:04.055    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070406-102246-466_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/04/06/SPOT5-HRG1-XS_20070406-102254-720_L1C_048-258-0_D_V1-0/SPOT5-HRG1-XS_20070406-102254-720_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070406-102254-720_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070406-102254-720_L1C_048-258-0_D_V1-0.zip
run script
2024-01-10T23:52:04.929    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:52:04.930    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070406-102254-720_L1C_048-258-0_D_V1-0.zip
2024-01-10T23:52:04.930    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:52:04.930    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:52:04.930    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:52:04.930    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:52:04.930    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:52:04.930    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:52:04.930    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:52:04.930    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T23:52:40.000    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 490). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070406-102254-720_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2007/04/06/SPOT5-HRG1-XS_20070406-102302-974_L1C_048-259-0_D_V1-0/SPOT5-HRG1-XS_20070406-102302-974_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070406-102302-974_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070406-102302-974_L1C_048-259-0_D_V1-0.zip
run script
2024-01-10T23:52:46.705    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:52:46.706    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070406-102302-974_L1C_048-259-0_D_V1-0.zip
2024-01-10T23:52:46.706    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:52:46.706    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:52:46.706    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:52:46.707    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:52:46.707    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:52:46.707    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:52:46.707    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:52:46.707    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070406-102302-974_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/04/06/SPOT5-HRG1-XS_20070406-102311-252_L1C_049-260-0_D_V1-0/SPOT5-HRG1-XS_20070406-102311-252_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070406-102311-252_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070406-102311-252_L1C_049-260-0_D_V1-0.zip
run script
2024-01-10T23:53:15.662    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:53:15.663    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070406-102311-252_L1C_049-260-0_D_V1-0.zip
2024-01-10T23:53:15.663    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:53:15.663    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:53:15.664    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:53:15.664    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:53:15.664    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:53:15.664    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:53:15.664    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:53:15.664    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T23:53:22.321    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (938 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070406-102311-252_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2007/04/06/SPOT5-HRG1-XS_20070406-102313-057_L1C_049-260-2_D_V1-0/SPOT5-HRG1-XS_20070406-102313-057_L1C_049-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070406-102313-057_L1C_049-260-2_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070406-102313-057_L1C_049-260-2_D_V1-0.zip
run script
2024-01-10T23:53:27.999    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:53:28.001    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070406-102313-057_L1C_049-260-2_D_V1-0.zip
2024-01-10T23:53:28.001    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:53:28.001    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:53:28.001    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:53:28.001    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:53:28.001    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:53:28.001    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:53:28.001    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:53:28.001    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070406-102313-057_L1C_049-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/04/06/SPOT5-HRG2-XS_20070406-102243-672_L1C_050-256-9_D_V1-0/SPOT5-HRG2-XS_20070406-102243-672_L1C_050-256-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070406-102243-672_L1C_050-256-9_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070406-102243-672_L1C_050-256-9_D_V1-0.zip
run script
2024-01-10T23:53:32.871    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:53:32.871    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070406-102243-672_L1C_050-256-9_D_V1-0.zip
2024-01-10T23:53:32.871    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:53:32.871    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:53:32.871    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:53:32.871    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:53:32.871    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:53:32.871    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:53:32.872    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:53:32.872    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070406-102243-672_L1C_050-256-9_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/04/06/SPOT5-HRG2-XS_20070406-102243-792_L1C_050-257-0_D_V1-0/SPOT5-HRG2-XS_20070406-102243-792_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070406-102243-792_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070406-102243-792_L1C_050-257-0_D_V1-0.zip
run script
2024-01-10T23:57:17.355    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T23:57:17.357    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070406-102243-792_L1C_050-257-0_D_V1-0.zip
2024-01-10T23:57:17.357    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:57:17.357    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:57:17.357    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T23:57:17.357    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:57:17.357    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:57:17.357    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:57:17.357    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:57:17.357    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070406-102243-792_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/04/06/SPOT5-HRG2-XS_20070406-102245-597_L1C_050-257-2_D_V1-0/SPOT5-HRG2-XS_20070406-102245-597_L1C_050-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070406-102245-597_L1C_050-257-2_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070406-102245-597_L1C_050-257-2_D_V1-0.zip
run script
2024-01-11T00:01:08.248    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:01:08.249    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070406-102245-597_L1C_050-257-2_D_V1-0.zip
2024-01-11T00:01:08.250    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:01:08.250    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:01:08.250    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:01:08.250    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:01:08.250    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:01:08.250    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:01:08.250    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:01:08.250    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070406-102245-597_L1C_050-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/05/01/SPOT5-HRG2-XS_20070501-104115-765_L1C_048-254-0_D_V1-0/SPOT5-HRG2-XS_20070501-104115-765_L1C_048-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070501-104115-765_L1C_048-254-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070501-104115-765_L1C_048-254-0_D_V1-0.zip
run script
2024-01-11T00:04:59.733    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:04:59.734    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070501-104115-765_L1C_048-254-0_D_V1-0.zip
2024-01-11T00:04:59.734    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:04:59.734    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:04:59.734    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:04:59.734    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:04:59.734    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:04:59.734    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:04:59.734    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:04:59.734    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070501-104115-765_L1C_048-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/05/01/SPOT5-HRG2-XS_20070501-104116-679_L1C_048-254-1_D_V1-0/SPOT5-HRG2-XS_20070501-104116-679_L1C_048-254-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070501-104116-679_L1C_048-254-1_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070501-104116-679_L1C_048-254-1_D_V1-0.zip
run script
2024-01-11T00:05:04.667    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:05:04.668    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070501-104116-679_L1C_048-254-1_D_V1-0.zip
2024-01-11T00:05:04.668    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:05:04.668    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:05:04.668    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:05:04.668    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:05:04.668    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:05:04.669    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:05:04.669    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:05:04.669    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070501-104116-679_L1C_048-254-1_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/07/13/SPOT5-HRG2-XS_20070713-103623-972_L1C_048-254-9_D_V1-0/SPOT5-HRG2-XS_20070713-103623-972_L1C_048-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070713-103623-972_L1C_048-254-9_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070713-103623-972_L1C_048-254-9_D_V1-0.zip
run script
2024-01-11T00:05:09.909    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:05:09.910    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070713-103623-972_L1C_048-254-9_D_V1-0.zip
2024-01-11T00:05:09.910    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:05:09.910    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:05:09.910    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:05:09.910    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:05:09.910    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:05:09.910    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:05:09.910    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:05:09.910    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070713-103623-972_L1C_048-254-9_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/07/13/SPOT5-HRG2-XS_20070713-103624-116_L1C_048-255-0_D_V1-0/SPOT5-HRG2-XS_20070713-103624-116_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070713-103624-116_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070713-103624-116_L1C_048-255-0_D_V1-0.zip
run script
2024-01-11T00:05:46.569    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:05:46.570    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070713-103624-116_L1C_048-255-0_D_V1-0.zip
2024-01-11T00:05:46.570    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:05:46.570    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:05:46.571    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:05:46.571    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:05:46.571    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:05:46.571    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:05:46.571    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:05:46.571    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070713-103624-116_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/07/13/SPOT5-HRG2-XS_20070713-103625-921_L1C_048-255-2_D_V1-0/SPOT5-HRG2-XS_20070713-103625-921_L1C_048-255-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070713-103625-921_L1C_048-255-2_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070713-103625-921_L1C_048-255-2_D_V1-0.zip
run script
2024-01-11T00:06:25.436    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:06:25.437    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070713-103625-921_L1C_048-255-2_D_V1-0.zip
2024-01-11T00:06:25.437    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:06:25.437    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:06:25.437    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:06:25.437    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:06:25.437    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:06:25.437    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:06:25.437    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:06:25.437    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-11T00:07:11.126    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (402 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070713-103625-921_L1C_048-255-2_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2007/07/13/SPOT5-HRG2-XS_20070713-103645-185_L1C_048-257-5_D_V1-0/SPOT5-HRG2-XS_20070713-103645-185_L1C_048-257-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070713-103645-185_L1C_048-257-5_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070713-103645-185_L1C_048-257-5_D_V1-0.zip
run script
2024-01-11T00:07:16.213    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:07:16.214    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070713-103645-185_L1C_048-257-5_D_V1-0.zip
2024-01-11T00:07:16.214    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:07:16.214    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:07:16.214    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:07:16.214    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:07:16.214    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:07:16.214    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:07:16.214    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:07:16.214    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070713-103645-185_L1C_048-257-5_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/07/13/SPOT5-HRG2-XS_20070713-103647-905_L1C_048-257-8_D_V1-0/SPOT5-HRG2-XS_20070713-103647-905_L1C_048-257-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070713-103647-905_L1C_048-257-8_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070713-103647-905_L1C_048-257-8_D_V1-0.zip
run script
2024-01-11T00:08:11.237    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:08:11.238    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070713-103647-905_L1C_048-257-8_D_V1-0.zip
2024-01-11T00:08:11.238    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:08:11.238    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:08:11.238    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:08:11.238    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:08:11.238    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:08:11.239    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:08:11.239    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:08:11.239    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070713-103647-905_L1C_048-257-8_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/07/13/SPOT5-HRG1-XS_20070713-103629-474_L1C_050-256-0_D_V1-0/SPOT5-HRG1-XS_20070713-103629-474_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070713-103629-474_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070713-103629-474_L1C_050-256-0_D_V1-0.zip
run script
2024-01-11T00:08:58.311    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:08:58.312    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070713-103629-474_L1C_050-256-0_D_V1-0.zip
2024-01-11T00:08:58.312    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:08:58.312    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:08:58.313    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:08:58.313    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:08:58.313    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:08:58.313    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:08:58.313    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:08:58.313    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070713-103629-474_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/07/13/SPOT5-HRG1-XS_20070713-103637-776_L1C_050-257-0_D_V1-0/SPOT5-HRG1-XS_20070713-103637-776_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070713-103637-776_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070713-103637-776_L1C_050-257-0_D_V1-0.zip
run script
2024-01-11T00:12:29.275    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:12:29.276    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070713-103637-776_L1C_050-257-0_D_V1-0.zip
2024-01-11T00:12:29.277    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:12:29.277    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:12:29.277    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:12:29.277    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:12:29.277    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:12:29.277    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:12:29.277    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:12:29.277    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070713-103637-776_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/07/13/SPOT5-HRG1-XS_20070713-103640-472_L1C_050-257-3_D_V1-0/SPOT5-HRG1-XS_20070713-103640-472_L1C_050-257-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070713-103640-472_L1C_050-257-3_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070713-103640-472_L1C_050-257-3_D_V1-0.zip
run script
2024-01-11T00:16:09.660    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:16:09.662    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070713-103640-472_L1C_050-257-3_D_V1-0.zip
2024-01-11T00:16:09.662    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:16:09.662    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:16:09.662    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:16:09.662    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:16:09.662    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:16:09.662    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:16:09.662    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:16:09.662    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070713-103640-472_L1C_050-257-3_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/07/13/SPOT5-HRG1-XS_20070713-103712-331_L1C_050-261-0_D_V1-0/SPOT5-HRG1-XS_20070713-103712-331_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070713-103712-331_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070713-103712-331_L1C_050-261-0_D_V1-0.zip
run script
2024-01-11T00:19:40.623    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:19:40.625    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070713-103712-331_L1C_050-261-0_D_V1-0.zip
2024-01-11T00:19:40.625    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:19:40.625    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:19:40.625    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:19:40.625    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:19:40.625    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:19:40.625    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:19:40.625    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:19:40.625    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070713-103712-331_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/07/13/SPOT5-HRG1-XS_20070713-103715-027_L1C_050-261-3_D_V1-0/SPOT5-HRG1-XS_20070713-103715-027_L1C_050-261-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070713-103715-027_L1C_050-261-3_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070713-103715-027_L1C_050-261-3_D_V1-0.zip
run script
2024-01-11T00:20:31.263    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:20:31.264    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070713-103715-027_L1C_050-261-3_D_V1-0.zip
2024-01-11T00:20:31.265    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:20:31.265    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:20:31.265    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:20:31.265    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:20:31.265    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:20:31.265    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:20:31.265    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:20:31.265    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070713-103715-027_L1C_050-261-3_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/09/13/SPOT5-HRG2-XS_20070913-104256-002_L1C_048-254-0_D_V1-0/SPOT5-HRG2-XS_20070913-104256-002_L1C_048-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070913-104256-002_L1C_048-254-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070913-104256-002_L1C_048-254-0_D_V1-0.zip
run script
2024-01-11T00:21:15.866    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:21:15.868    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070913-104256-002_L1C_048-254-0_D_V1-0.zip
2024-01-11T00:21:15.868    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:21:15.868    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:21:15.868    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:21:15.868    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:21:15.868    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:21:15.868    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:21:15.868    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:21:15.868    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070913-104256-002_L1C_048-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/09/13/SPOT5-HRG2-XS_20070913-104304-304_L1C_048-255-0_D_V1-0/SPOT5-HRG2-XS_20070913-104304-304_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070913-104304-304_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070913-104304-304_L1C_048-255-0_D_V1-0.zip
run script
2024-01-11T00:21:20.821    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:21:20.822    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070913-104304-304_L1C_048-255-0_D_V1-0.zip
2024-01-11T00:21:20.823    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:21:20.823    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:21:20.823    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:21:20.823    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:21:20.823    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:21:20.823    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:21:20.823    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:21:20.823    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-11T00:21:52.286    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (63 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070913-104304-304_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2007/09/13/SPOT5-HRG2-XS_20070913-104305-194_L1C_048-255-1_D_V1-0/SPOT5-HRG2-XS_20070913-104305-194_L1C_048-255-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070913-104305-194_L1C_048-255-1_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070913-104305-194_L1C_048-255-1_D_V1-0.zip
run script
2024-01-11T00:21:57.305    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:21:57.306    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070913-104305-194_L1C_048-255-1_D_V1-0.zip
2024-01-11T00:21:57.306    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:21:57.307    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:21:57.307    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:21:57.307    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:21:57.307    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:21:57.307    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:21:57.307    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:21:57.307    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070913-104305-194_L1C_048-255-1_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/09/13/SPOT5-HRG1-XS_20070913-104252-223_L1C_051-254-0_D_V1-0/SPOT5-HRG1-XS_20070913-104252-223_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070913-104252-223_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070913-104252-223_L1C_051-254-0_D_V1-0.zip
run script
2024-01-11T00:22:36.425    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:22:36.425    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070913-104252-223_L1C_051-254-0_D_V1-0.zip
2024-01-11T00:22:36.426    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:22:36.426    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:22:36.426    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:22:36.426    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:22:36.426    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:22:36.426    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:22:36.426    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:22:36.426    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070913-104252-223_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/09/13/SPOT5-HRG1-XS_20070913-104253-138_L1C_051-254-1_D_V1-0/SPOT5-HRG1-XS_20070913-104253-138_L1C_051-254-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070913-104253-138_L1C_051-254-1_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070913-104253-138_L1C_051-254-1_D_V1-0.zip
run script
2024-01-11T00:22:41.633    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:22:41.633    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070913-104253-138_L1C_051-254-1_D_V1-0.zip
2024-01-11T00:22:41.633    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:22:41.633    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:22:41.633    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:22:41.635    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:22:41.635    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:22:41.635    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:22:41.635    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:22:41.635    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070913-104253-138_L1C_051-254-1_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/09/13/SPOT5-HRG1-XS_20070913-104331-051_L1C_051-258-6_D_V1-0/SPOT5-HRG1-XS_20070913-104331-051_L1C_051-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070913-104331-051_L1C_051-258-6_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070913-104331-051_L1C_051-258-6_D_V1-0.zip
run script
2024-01-11T00:22:47.156    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:22:47.156    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070913-104331-051_L1C_051-258-6_D_V1-0.zip
2024-01-11T00:22:47.156    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:22:47.156    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:22:47.157    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:22:47.157    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:22:47.157    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:22:47.157    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:22:47.157    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:22:47.157    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070913-104331-051_L1C_051-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/09/13/SPOT5-HRG1-XS_20070913-104333-986_L1C_051-259-0_D_V1-0/SPOT5-HRG1-XS_20070913-104333-986_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070913-104333-986_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070913-104333-986_L1C_051-259-0_D_V1-0.zip
run script
2024-01-11T00:26:03.438    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:26:03.439    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070913-104333-986_L1C_051-259-0_D_V1-0.zip
2024-01-11T00:26:03.439    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:26:03.439    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:26:03.439    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:26:03.440    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:26:03.440    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:26:03.440    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:26:03.440    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:26:03.440    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070913-104333-986_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/01/12/SPOT5-HRG1-XS_20070112-103857-356_L1C_048-256-9_D_V1-0/SPOT5-HRG1-XS_20070112-103857-356_L1C_048-256-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070112-103857-356_L1C_048-256-9_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070112-103857-356_L1C_048-256-9_D_V1-0.zip
run script
2024-01-11T00:29:05.994    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:29:05.995    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070112-103857-356_L1C_048-256-9_D_V1-0.zip
2024-01-11T00:29:05.996    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:29:05.996    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:29:05.996    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:29:05.996    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:29:05.996    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:29:05.996    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:29:05.996    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:29:05.996    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070112-103857-356_L1C_048-256-9_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/01/12/SPOT5-HRG1-XS_20070112-103857-500_L1C_048-257-0_D_V1-0/SPOT5-HRG1-XS_20070112-103857-500_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070112-103857-500_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070112-103857-500_L1C_048-257-0_D_V1-0.zip
run script
2024-01-11T00:29:10.497    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:29:10.497    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070112-103857-500_L1C_048-257-0_D_V1-0.zip
2024-01-11T00:29:10.497    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:29:10.497    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:29:10.497    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:29:10.497    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:29:10.497    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:29:10.497    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:29:10.497    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:29:10.498    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070112-103857-500_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/01/12/SPOT5-HRG1-XS_20070112-103859-305_L1C_048-257-2_D_V1-0/SPOT5-HRG1-XS_20070112-103859-305_L1C_048-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070112-103859-305_L1C_048-257-2_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070112-103859-305_L1C_048-257-2_D_V1-0.zip
run script
2024-01-11T00:29:14.826    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:29:14.827    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070112-103859-305_L1C_048-257-2_D_V1-0.zip
2024-01-11T00:29:14.828    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:29:14.828    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:29:14.828    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:29:14.828    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:29:14.828    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:29:14.828    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:29:14.828    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:29:14.828    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070112-103859-305_L1C_048-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/05/21/SPOT5-HRG2-XS_20070521-105635-194_L1C_048-256-0_D_V1-0/SPOT5-HRG2-XS_20070521-105635-194_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070521-105635-194_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070521-105635-194_L1C_048-256-0_D_V1-0.zip
run script
2024-01-11T00:29:19.719    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:29:19.721    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070521-105635-194_L1C_048-256-0_D_V1-0.zip
2024-01-11T00:29:19.721    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:29:19.721    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:29:19.721    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:29:19.721    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:29:19.721    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:29:19.721    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:29:19.721    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:29:19.721    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070521-105635-194_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/05/21/SPOT5-HRG2-XS_20070521-105636-084_L1C_048-256-1_D_V1-0/SPOT5-HRG2-XS_20070521-105636-084_L1C_048-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070521-105636-084_L1C_048-256-1_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070521-105636-084_L1C_048-256-1_D_V1-0.zip
run script
2024-01-11T00:30:49.674    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:30:49.676    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070521-105636-084_L1C_048-256-1_D_V1-0.zip
2024-01-11T00:30:49.676    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:30:49.676    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:30:49.676    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:30:49.676    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:30:49.676    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:30:49.676    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:30:49.676    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:30:49.676    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070521-105636-084_L1C_048-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/05/21/SPOT5-HRG2-XS_20070521-105647-222_L1C_048-257-4_D_V1-0/SPOT5-HRG2-XS_20070521-105647-222_L1C_048-257-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070521-105647-222_L1C_048-257-4_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070521-105647-222_L1C_048-257-4_D_V1-0.zip
run script
2024-01-11T00:32:18.025    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:32:18.026    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070521-105647-222_L1C_048-257-4_D_V1-0.zip
2024-01-11T00:32:18.027    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:32:18.027    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:32:18.027    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:32:18.027    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:32:18.027    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:32:18.027    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:32:18.027    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:32:18.027    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070521-105647-222_L1C_048-257-4_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/05/21/SPOT5-HRG2-XS_20070521-105651-987_L1C_048-258-0_D_V1-0/SPOT5-HRG2-XS_20070521-105651-987_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070521-105651-987_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070521-105651-987_L1C_048-258-0_D_V1-0.zip
run script
2024-01-11T00:33:18.523    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:33:18.526    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070521-105651-987_L1C_048-258-0_D_V1-0.zip
2024-01-11T00:33:18.526    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:33:18.526    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:33:18.526    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:33:18.527    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:33:18.527    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:33:18.527    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:33:18.527    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:33:18.527    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-11T00:33:55.919    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 104). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070521-105651-987_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2007/05/21/SPOT5-HRG2-XS_20070521-105626-795_L1C_049-255-0_D_V1-0/SPOT5-HRG2-XS_20070521-105626-795_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070521-105626-795_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070521-105626-795_L1C_049-255-0_D_V1-0.zip
run script
2024-01-11T00:34:00.754    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:34:00.754    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070521-105626-795_L1C_049-255-0_D_V1-0.zip
2024-01-11T00:34:00.754    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:34:00.754    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:34:00.754    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:34:00.754    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:34:00.754    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:34:00.754    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:34:00.754    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:34:00.754    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070521-105626-795_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/03/25/SPOT5-HRG2-XS_20070325-105347-533_L1C_048-257-0_D_V1-0/SPOT5-HRG2-XS_20070325-105347-533_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070325-105347-533_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070325-105347-533_L1C_048-257-0_D_V1-0.zip
run script
2024-01-11T00:34:50.519    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:34:50.520    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070325-105347-533_L1C_048-257-0_D_V1-0.zip
2024-01-11T00:34:50.520    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:34:50.520    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:34:50.520    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:34:50.520    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:34:50.520    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:34:50.520    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:34:50.521    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:34:50.521    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070325-105347-533_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/03/25/SPOT5-HRG2-XS_20070325-105349-338_L1C_048-257-2_D_V1-0/SPOT5-HRG2-XS_20070325-105349-338_L1C_048-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070325-105349-338_L1C_048-257-2_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070325-105349-338_L1C_048-257-2_D_V1-0.zip
run script
2024-01-11T00:34:54.906    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:34:54.906    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070325-105349-338_L1C_048-257-2_D_V1-0.zip
2024-01-11T00:34:54.906    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:34:54.907    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:34:54.907    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:34:54.907    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:34:54.907    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:34:54.907    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:34:54.907    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:34:54.907    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070325-105349-338_L1C_048-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/05/23/SPOT5-HRG2-XS_20070523-101813-948_L1C_048-257-5_D_V1-0/SPOT5-HRG2-XS_20070523-101813-948_L1C_048-257-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070523-101813-948_L1C_048-257-5_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070523-101813-948_L1C_048-257-5_D_V1-0.zip
run script
2024-01-11T00:35:00.583    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:35:00.584    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070523-101813-948_L1C_048-257-5_D_V1-0.zip
2024-01-11T00:35:00.584    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:35:00.584    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:35:00.584    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:35:00.584    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:35:00.584    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:35:00.584    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:35:00.584    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:35:00.584    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070523-101813-948_L1C_048-257-5_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/05/23/SPOT5-HRG2-XS_20070523-101817-678_L1C_048-258-0_D_V1-0/SPOT5-HRG2-XS_20070523-101817-678_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070523-101817-678_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070523-101817-678_L1C_048-258-0_D_V1-0.zip
run script
2024-01-11T00:35:47.869    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:35:47.870    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070523-101817-678_L1C_048-258-0_D_V1-0.zip
2024-01-11T00:35:47.870    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:35:47.870    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:35:47.871    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:35:47.871    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:35:47.871    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:35:47.871    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:35:47.871    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:35:47.871    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-11T00:36:19.463    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 402). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070523-101817-678_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2007/05/23/SPOT5-HRG2-XS_20070523-101825-908_L1C_048-259-0_D_V1-0/SPOT5-HRG2-XS_20070523-101825-908_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070523-101825-908_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070523-101825-908_L1C_048-259-0_D_V1-0.zip
run script
2024-01-11T00:36:25.404    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:36:25.405    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070523-101825-908_L1C_048-259-0_D_V1-0.zip
2024-01-11T00:36:25.405    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:36:25.405    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:36:25.405    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:36:25.405    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:36:25.405    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:36:25.405    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:36:25.405    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:36:25.405    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070523-101825-908_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/05/23/SPOT5-HRG1-XS_20070523-101751-990_L1C_049-254-9_D_V1-0/SPOT5-HRG1-XS_20070523-101751-990_L1C_049-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070523-101751-990_L1C_049-254-9_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070523-101751-990_L1C_049-254-9_D_V1-0.zip
run script
2024-01-11T00:36:52.332    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:36:52.334    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070523-101751-990_L1C_049-254-9_D_V1-0.zip
2024-01-11T00:36:52.334    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:36:52.334    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:36:52.334    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:36:52.334    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:36:52.334    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:36:52.334    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:36:52.334    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:36:52.334    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070523-101751-990_L1C_049-254-9_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/05/23/SPOT5-HRG1-XS_20070523-101752-086_L1C_049-255-0_D_V1-0/SPOT5-HRG1-XS_20070523-101752-086_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070523-101752-086_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070523-101752-086_L1C_049-255-0_D_V1-0.zip
run script
2024-01-11T00:37:43.110    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:37:43.111    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070523-101752-086_L1C_049-255-0_D_V1-0.zip
2024-01-11T00:37:43.111    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:37:43.111    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:37:43.111    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:37:43.111    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:37:43.111    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:37:43.111    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:37:43.111    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:37:43.111    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070523-101752-086_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/05/23/SPOT5-HRG1-XS_20070523-101754-781_L1C_049-255-3_D_V1-0/SPOT5-HRG1-XS_20070523-101754-781_L1C_049-255-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070523-101754-781_L1C_049-255-3_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070523-101754-781_L1C_049-255-3_D_V1-0.zip
run script
2024-01-11T00:38:31.077    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:38:31.078    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070523-101754-781_L1C_049-255-3_D_V1-0.zip
2024-01-11T00:38:31.078    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:38:31.078    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:38:31.078    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:38:31.078    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:38:31.078    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:38:31.078    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:38:31.079    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:38:31.079    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070523-101754-781_L1C_049-255-3_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/07/07/SPOT5-HRG1-XS_20070707-105209-341_L1C_048-257-0_D_V1-0/SPOT5-HRG1-XS_20070707-105209-341_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070707-105209-341_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070707-105209-341_L1C_048-257-0_D_V1-0.zip
run script
2024-01-11T00:39:47.280    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:39:47.281    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070707-105209-341_L1C_048-257-0_D_V1-0.zip
2024-01-11T00:39:47.281    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:39:47.281    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:39:47.282    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:39:47.282    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:39:47.282    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:39:47.282    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:39:47.282    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:39:47.282    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070707-105209-341_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/07/07/SPOT5-HRG1-XS_20070707-105217-715_L1C_048-258-0_D_V1-0/SPOT5-HRG1-XS_20070707-105217-715_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070707-105217-715_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070707-105217-715_L1C_048-258-0_D_V1-0.zip
run script
2024-01-11T00:41:27.741    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:41:27.742    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070707-105217-715_L1C_048-258-0_D_V1-0.zip
2024-01-11T00:41:27.742    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:41:27.742    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:41:27.742    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:41:27.742    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:41:27.743    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:41:27.743    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:41:27.743    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:41:27.743    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-11T00:42:07.956    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 60). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070707-105217-715_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2007/07/07/SPOT5-HRG1-XS_20070707-105218-629_L1C_048-258-1_D_V1-0/SPOT5-HRG1-XS_20070707-105218-629_L1C_048-258-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070707-105218-629_L1C_048-258-1_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070707-105218-629_L1C_048-258-1_D_V1-0.zip
run script
2024-01-11T00:42:12.924    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:42:12.925    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070707-105218-629_L1C_048-258-1_D_V1-0.zip
2024-01-11T00:42:12.926    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:42:12.926    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:42:12.926    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:42:12.926    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:42:12.926    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:42:12.926    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:42:12.926    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:42:12.926    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070707-105218-629_L1C_048-258-1_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/07/07/SPOT5-HRG1-XS_20070707-105152-351_L1C_049-254-9_D_V1-0/SPOT5-HRG1-XS_20070707-105152-351_L1C_049-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070707-105152-351_L1C_049-254-9_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070707-105152-351_L1C_049-254-9_D_V1-0.zip
run script
2024-01-11T00:42:51.830    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:42:51.831    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070707-105152-351_L1C_049-254-9_D_V1-0.zip
2024-01-11T00:42:51.832    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:42:51.832    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:42:51.832    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:42:51.832    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:42:51.832    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:42:51.832    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:42:51.832    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:42:51.832    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070707-105152-351_L1C_049-254-9_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/07/07/SPOT5-HRG1-XS_20070707-105152-592_L1C_049-255-0_D_V1-0/SPOT5-HRG1-XS_20070707-105152-592_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070707-105152-592_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070707-105152-592_L1C_049-255-0_D_V1-0.zip
run script
2024-01-11T00:43:39.247    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:43:39.248    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070707-105152-592_L1C_049-255-0_D_V1-0.zip
2024-01-11T00:43:39.248    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:43:39.248    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:43:39.248    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:43:39.248    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:43:39.248    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:43:39.248    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:43:39.248    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:43:39.249    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070707-105152-592_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/07/07/SPOT5-HRG1-XS_20070707-105155-311_L1C_049-255-3_D_V1-0/SPOT5-HRG1-XS_20070707-105155-311_L1C_049-255-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070707-105155-311_L1C_049-255-3_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070707-105155-311_L1C_049-255-3_D_V1-0.zip
run script
2024-01-11T00:44:27.419    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:44:27.420    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070707-105155-311_L1C_049-255-3_D_V1-0.zip
2024-01-11T00:44:27.420    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:44:27.420    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:44:27.420    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:44:27.420    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:44:27.420    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:44:27.420    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:44:27.420    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:44:27.420    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070707-105155-311_L1C_049-255-3_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/07/07/SPOT5-HRG1-XS_20070707-105209-100_L1C_049-256-9_D_V1-0/SPOT5-HRG1-XS_20070707-105209-100_L1C_049-256-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070707-105209-100_L1C_049-256-9_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070707-105209-100_L1C_049-256-9_D_V1-0.zip
run script
2024-01-11T00:45:35.698    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:45:35.699    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070707-105209-100_L1C_049-256-9_D_V1-0.zip
2024-01-11T00:45:35.699    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:45:35.700    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:45:35.700    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:45:35.700    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:45:35.700    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:45:35.700    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:45:35.700    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:45:35.700    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070707-105209-100_L1C_049-256-9_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/07/07/SPOT5-HRG2-XS_20070707-105205-841_L1C_050-257-0_D_V1-0/SPOT5-HRG2-XS_20070707-105205-841_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070707-105205-841_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070707-105205-841_L1C_050-257-0_D_V1-0.zip
run script
2024-01-11T00:47:17.200    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:47:17.201    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070707-105205-841_L1C_050-257-0_D_V1-0.zip
2024-01-11T00:47:17.202    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:47:17.202    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:47:17.202    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:47:17.202    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:47:17.202    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:47:17.202    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:47:17.202    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:47:17.202    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070707-105205-841_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/07/07/SPOT5-HRG2-XS_20070707-105207-646_L1C_050-257-2_D_V1-0/SPOT5-HRG2-XS_20070707-105207-646_L1C_050-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070707-105207-646_L1C_050-257-2_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070707-105207-646_L1C_050-257-2_D_V1-0.zip
run script
2024-01-11T00:52:11.899    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:52:11.901    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070707-105207-646_L1C_050-257-2_D_V1-0.zip
2024-01-11T00:52:11.901    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:52:11.901    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:52:11.901    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:52:11.901    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:52:11.901    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:52:11.901    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:52:11.901    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:52:11.901    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070707-105207-646_L1C_050-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/07/07/SPOT5-HRG2-XS_20070707-105140-644_L1C_051-254-0_D_V1-0/SPOT5-HRG2-XS_20070707-105140-644_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070707-105140-644_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070707-105140-644_L1C_051-254-0_D_V1-0.zip
run script
2024-01-11T00:56:28.310    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:56:28.311    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070707-105140-644_L1C_051-254-0_D_V1-0.zip
2024-01-11T00:56:28.311    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:56:28.312    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:56:28.312    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:56:28.312    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:56:28.312    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:56:28.312    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:56:28.312    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:56:28.312    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070707-105140-644_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/07/07/SPOT5-HRG2-XS_20070707-105142-449_L1C_051-254-2_D_V1-0/SPOT5-HRG2-XS_20070707-105142-449_L1C_051-254-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070707-105142-449_L1C_051-254-2_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070707-105142-449_L1C_051-254-2_D_V1-0.zip
run script
2024-01-11T00:56:33.630    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:56:33.631    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070707-105142-449_L1C_051-254-2_D_V1-0.zip
2024-01-11T00:56:33.631    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:56:33.631    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:56:33.631    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:56:33.631    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:56:33.631    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:56:33.631    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:56:33.631    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:56:33.631    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070707-105142-449_L1C_051-254-2_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/07/07/SPOT5-HRG2-XS_20070707-105204-686_L1C_051-256-8_D_V1-0/SPOT5-HRG2-XS_20070707-105204-686_L1C_051-256-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070707-105204-686_L1C_051-256-8_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070707-105204-686_L1C_051-256-8_D_V1-0.zip
run script
2024-01-11T00:56:39.185    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T00:56:39.185    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070707-105204-686_L1C_051-256-8_D_V1-0.zip
2024-01-11T00:56:39.185    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:56:39.185    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:56:39.185    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T00:56:39.186    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:56:39.186    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:56:39.186    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:56:39.186    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:56:39.186    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070707-105204-686_L1C_051-256-8_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/07/07/SPOT5-HRG1-XS_20070707-105246-101_L1C_053-262-3_D_V1-0/SPOT5-HRG1-XS_20070707-105246-101_L1C_053-262-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070707-105246-101_L1C_053-262-3_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070707-105246-101_L1C_053-262-3_D_V1-0.zip
run script
2024-01-11T01:00:54.868    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:00:54.869    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070707-105246-101_L1C_053-262-3_D_V1-0.zip
2024-01-11T01:00:54.869    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:00:54.869    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:00:54.869    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:00:54.869    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:00:54.869    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:00:54.869    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:00:54.870    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:00:54.870    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070707-105246-101_L1C_053-262-3_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/07/07/SPOT5-HRG1-XS_20070707-105248-797_L1C_053-262-6_D_V1-0/SPOT5-HRG1-XS_20070707-105248-797_L1C_053-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070707-105248-797_L1C_053-262-6_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070707-105248-797_L1C_053-262-6_D_V1-0.zip
run script
2024-01-11T01:04:16.680    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:04:16.681    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070707-105248-797_L1C_053-262-6_D_V1-0.zip
2024-01-11T01:04:16.681    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:04:16.681    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:04:16.681    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:04:16.681    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:04:16.681    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:04:16.681    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:04:16.681    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:04:16.682    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070707-105248-797_L1C_053-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/08/19/SPOT5-HRG2-XS_20070819-102440-278_L1C_048-257-9_D_V1-0/SPOT5-HRG2-XS_20070819-102440-278_L1C_048-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070819-102440-278_L1C_048-257-9_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070819-102440-278_L1C_048-257-9_D_V1-0.zip
run script
2024-01-11T01:06:46.265    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:06:46.267    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070819-102440-278_L1C_048-257-9_D_V1-0.zip
2024-01-11T01:06:46.267    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:06:46.267    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:06:46.267    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:06:46.267    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:06:46.267    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:06:46.267    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:06:46.267    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:06:46.267    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-11T01:06:52.575    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1882 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070819-102440-278_L1C_048-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2007/08/19/SPOT5-HRG2-XS_20070819-102440-399_L1C_048-258-0_D_V1-0/SPOT5-HRG2-XS_20070819-102440-399_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070819-102440-399_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070819-102440-399_L1C_048-258-0_D_V1-0.zip
run script
2024-01-11T01:06:57.667    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:06:57.668    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070819-102440-399_L1C_048-258-0_D_V1-0.zip
2024-01-11T01:06:57.668    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:06:57.668    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:06:57.668    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:06:57.668    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:06:57.668    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:06:57.668    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:06:57.668    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:06:57.668    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-11T01:07:03.755    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1882 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070819-102440-399_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2007/08/19/SPOT5-HRG2-XS_20070819-102443-094_L1C_048-258-3_D_V1-0/SPOT5-HRG2-XS_20070819-102443-094_L1C_048-258-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070819-102443-094_L1C_048-258-3_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070819-102443-094_L1C_048-258-3_D_V1-0.zip
run script
2024-01-11T01:07:09.067    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:07:09.067    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070819-102443-094_L1C_048-258-3_D_V1-0.zip
2024-01-11T01:07:09.067    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:07:09.067    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:07:09.067    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:07:09.067    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:07:09.067    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:07:09.067    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:07:09.067    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:07:09.068    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070819-102443-094_L1C_048-258-3_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/09/04/SPOT5-HRG2-XS_20070904-101639-575_L1C_048-257-9_D_V1-0/SPOT5-HRG2-XS_20070904-101639-575_L1C_048-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070904-101639-575_L1C_048-257-9_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070904-101639-575_L1C_048-257-9_D_V1-0.zip
run script
2024-01-11T01:07:14.911    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:07:14.912    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070904-101639-575_L1C_048-257-9_D_V1-0.zip
2024-01-11T01:07:14.913    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:07:14.913    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:07:14.913    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:07:14.913    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:07:14.913    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:07:14.913    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:07:14.913    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:07:14.913    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-11T01:07:37.594    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 60). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070904-101639-575_L1C_048-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2007/09/04/SPOT5-HRG2-XS_20070904-101639-695_L1C_048-258-0_D_V1-0/SPOT5-HRG2-XS_20070904-101639-695_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070904-101639-695_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070904-101639-695_L1C_048-258-0_D_V1-0.zip
run script
2024-01-11T01:07:43.285    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:07:43.285    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070904-101639-695_L1C_048-258-0_D_V1-0.zip
2024-01-11T01:07:43.285    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:07:43.285    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:07:43.285    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:07:43.286    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:07:43.286    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:07:43.286    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:07:43.286    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:07:43.286    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-11T01:08:05.509    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (0 x 508). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070904-101639-695_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2007/09/04/SPOT5-HRG2-XS_20070904-101641-500_L1C_048-258-2_D_V1-0/SPOT5-HRG2-XS_20070904-101641-500_L1C_048-258-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070904-101641-500_L1C_048-258-2_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070904-101641-500_L1C_048-258-2_D_V1-0.zip
run script
2024-01-11T01:08:10.472    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:08:10.473    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070904-101641-500_L1C_048-258-2_D_V1-0.zip
2024-01-11T01:08:10.473    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:08:10.473    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:08:10.473    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:08:10.473    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:08:10.473    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:08:10.473    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:08:10.473    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:08:10.473    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070904-101641-500_L1C_048-258-2_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/01/13/SPOT5-HRG2-XS_20070113-101954-997_L1C_048-258-9_D_V1-0/SPOT5-HRG2-XS_20070113-101954-997_L1C_048-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070113-101954-997_L1C_048-258-9_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070113-101954-997_L1C_048-258-9_D_V1-0.zip
run script
2024-01-11T01:08:33.130    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:08:33.130    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070113-101954-997_L1C_048-258-9_D_V1-0.zip
2024-01-11T01:08:33.130    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:08:33.130    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:08:33.130    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:08:33.131    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:08:33.131    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:08:33.131    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:08:33.131    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:08:33.131    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070113-101954-997_L1C_048-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/01/13/SPOT5-HRG2-XS_20070113-101955-093_L1C_048-259-0_D_V1-0/SPOT5-HRG2-XS_20070113-101955-093_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070113-101955-093_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070113-101955-093_L1C_048-259-0_D_V1-0.zip
run script
2024-01-11T01:09:03.579    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:09:03.580    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070113-101955-093_L1C_048-259-0_D_V1-0.zip
2024-01-11T01:09:03.580    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:09:03.580    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:09:03.580    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:09:03.580    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:09:03.580    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:09:03.580    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:09:03.580    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:09:03.580    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070113-101955-093_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/01/13/SPOT5-HRG2-XS_20070113-102003-371_L1C_048-260-0_D_V1-0/SPOT5-HRG2-XS_20070113-102003-371_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070113-102003-371_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070113-102003-371_L1C_048-260-0_D_V1-0.zip
run script
2024-01-11T01:09:33.336    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:09:33.337    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070113-102003-371_L1C_048-260-0_D_V1-0.zip
2024-01-11T01:09:33.337    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:09:33.337    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:09:33.338    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:09:33.338    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:09:33.338    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:09:33.338    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:09:33.338    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:09:33.338    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-11T01:09:40.801    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (3804 x 0). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070113-102003-371_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2007/01/13/SPOT5-HRG2-XS_20070113-102005-176_L1C_048-260-2_D_V1-0/SPOT5-HRG2-XS_20070113-102005-176_L1C_048-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070113-102005-176_L1C_048-260-2_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070113-102005-176_L1C_048-260-2_D_V1-0.zip
run script
2024-01-11T01:09:47.229    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:09:47.230    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070113-102005-176_L1C_048-260-2_D_V1-0.zip
2024-01-11T01:09:47.230    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:09:47.231    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:09:47.231    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:09:47.231    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:09:47.231    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:09:47.231    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:09:47.231    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:09:47.231    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070113-102005-176_L1C_048-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/07/12/SPOT5-HRG2-XS_20070712-105610-243_L1C_048-258-6_D_V1-0/SPOT5-HRG2-XS_20070712-105610-243_L1C_048-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070712-105610-243_L1C_048-258-6_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070712-105610-243_L1C_048-258-6_D_V1-0.zip
run script
2024-01-11T01:09:52.839    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:09:52.839    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070712-105610-243_L1C_048-258-6_D_V1-0.zip
2024-01-11T01:09:52.839    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:09:52.839    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:09:52.839    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:09:52.840    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:09:52.840    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:09:52.840    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:09:52.840    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:09:52.840    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070712-105610-243_L1C_048-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/07/12/SPOT5-HRG2-XS_20070712-105612-047_L1C_048-258-8_D_V1-0/SPOT5-HRG2-XS_20070712-105612-047_L1C_048-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070712-105612-047_L1C_048-258-8_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070712-105612-047_L1C_048-258-8_D_V1-0.zip
run script
2024-01-11T01:10:14.749    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:10:14.750    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070712-105612-047_L1C_048-258-8_D_V1-0.zip
2024-01-11T01:10:14.750    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:10:14.750    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:10:14.750    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:10:14.750    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:10:14.750    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:10:14.750    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:10:14.750    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:10:14.750    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-11T01:10:19.753    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (102 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070712-105612-047_L1C_048-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2007/07/12/SPOT5-HRG1-XS_20070712-105600-545_L1C_049-257-5_D_V1-0/SPOT5-HRG1-XS_20070712-105600-545_L1C_049-257-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070712-105600-545_L1C_049-257-5_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070712-105600-545_L1C_049-257-5_D_V1-0.zip
run script
2024-01-11T01:10:24.917    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:10:24.918    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070712-105600-545_L1C_049-257-5_D_V1-0.zip
2024-01-11T01:10:24.918    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:10:24.918    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:10:24.918    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:10:24.918    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:10:24.918    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:10:24.918    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:10:24.918    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:10:24.918    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070712-105600-545_L1C_049-257-5_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/07/12/SPOT5-HRG1-XS_20070712-105602-349_L1C_049-257-7_D_V1-0/SPOT5-HRG1-XS_20070712-105602-349_L1C_049-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070712-105602-349_L1C_049-257-7_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070712-105602-349_L1C_049-257-7_D_V1-0.zip
run script
2024-01-11T01:11:35.088    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:11:35.089    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070712-105602-349_L1C_049-257-7_D_V1-0.zip
2024-01-11T01:11:35.089    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:11:35.090    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:11:35.090    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:11:35.090    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:11:35.090    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:11:35.090    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:11:35.090    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:11:35.090    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070712-105602-349_L1C_049-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/07/12/SPOT5-HRG1-XS_20070712-105527-062_L1C_051-254-0_D_V1-0/SPOT5-HRG1-XS_20070712-105527-062_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070712-105527-062_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070712-105527-062_L1C_051-254-0_D_V1-0.zip
run script
2024-01-11T01:12:37.143    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:12:37.145    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070712-105527-062_L1C_051-254-0_D_V1-0.zip
2024-01-11T01:12:37.145    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:12:37.145    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:12:37.145    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:12:37.145    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:12:37.145    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:12:37.145    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:12:37.145    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:12:37.145    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070712-105527-062_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/07/12/SPOT5-HRG1-XS_20070712-105528-867_L1C_051-254-2_D_V1-0/SPOT5-HRG1-XS_20070712-105528-867_L1C_051-254-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070712-105528-867_L1C_051-254-2_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070712-105528-867_L1C_051-254-2_D_V1-0.zip
run script
2024-01-11T01:12:41.475    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:12:41.475    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070712-105528-867_L1C_051-254-2_D_V1-0.zip
2024-01-11T01:12:41.475    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:12:41.475    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:12:41.476    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:12:41.476    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:12:41.476    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:12:41.476    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:12:41.476    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:12:41.476    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070712-105528-867_L1C_051-254-2_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/01/28/SPOT5-HRG2-XS_20070128-103133-521_L1C_048-259-9_D_V1-0/SPOT5-HRG2-XS_20070128-103133-521_L1C_048-259-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070128-103133-521_L1C_048-259-9_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070128-103133-521_L1C_048-259-9_D_V1-0.zip
run script
2024-01-11T01:12:47.094    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:12:47.095    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070128-103133-521_L1C_048-259-9_D_V1-0.zip
2024-01-11T01:12:47.095    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:12:47.095    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:12:47.095    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:12:47.095    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:12:47.095    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:12:47.095    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:12:47.095    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:12:47.096    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070128-103133-521_L1C_048-259-9_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/01/28/SPOT5-HRG2-XS_20070128-103133-666_L1C_048-260-0_D_V1-0/SPOT5-HRG2-XS_20070128-103133-666_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070128-103133-666_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070128-103133-666_L1C_048-260-0_D_V1-0.zip
run script
2024-01-11T01:12:52.629    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:12:52.629    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070128-103133-666_L1C_048-260-0_D_V1-0.zip
2024-01-11T01:12:52.629    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:12:52.629    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:12:52.629    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:12:52.629    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:12:52.629    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:12:52.629    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:12:52.629    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:12:52.629    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070128-103133-666_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/01/28/SPOT5-HRG2-XS_20070128-103135-471_L1C_048-260-2_D_V1-0/SPOT5-HRG2-XS_20070128-103135-471_L1C_048-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070128-103135-471_L1C_048-260-2_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070128-103135-471_L1C_048-260-2_D_V1-0.zip
run script
2024-01-11T01:12:57.793    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:12:57.794    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070128-103135-471_L1C_048-260-2_D_V1-0.zip
2024-01-11T01:12:57.794    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:12:57.794    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:12:57.794    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:12:57.794    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:12:57.794    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:12:57.794    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:12:57.794    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:12:57.794    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070128-103135-471_L1C_048-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/01/28/SPOT5-HRG1-XS_20070128-103126-630_L1C_052-259-7_D_V1-0/SPOT5-HRG1-XS_20070128-103126-630_L1C_052-259-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070128-103126-630_L1C_052-259-7_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070128-103126-630_L1C_052-259-7_D_V1-0.zip
run script
2024-01-11T01:13:03.203    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:13:03.205    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070128-103126-630_L1C_052-259-7_D_V1-0.zip
2024-01-11T01:13:03.205    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:13:03.205    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:13:03.205    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:13:03.205    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:13:03.205    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:13:03.205    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:13:03.205    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:13:03.206    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-11T01:16:04.565    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 356). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070128-103126-630_L1C_052-259-7_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2007/01/28/SPOT5-HRG1-XS_20070128-103128-603_L1C_052-260-0_D_V1-0/SPOT5-HRG1-XS_20070128-103128-603_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070128-103128-603_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070128-103128-603_L1C_052-260-0_D_V1-0.zip
run script
2024-01-11T01:16:10.077    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:16:10.078    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070128-103128-603_L1C_052-260-0_D_V1-0.zip
2024-01-11T01:16:10.078    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:16:10.078    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:16:10.078    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:16:10.078    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:16:10.079    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:16:10.079    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:16:10.079    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:16:10.079    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070128-103128-603_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/01/28/SPOT5-HRG1-XS_20070128-103131-322_L1C_052-260-3_D_V1-0/SPOT5-HRG1-XS_20070128-103131-322_L1C_052-260-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070128-103131-322_L1C_052-260-3_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070128-103131-322_L1C_052-260-3_D_V1-0.zip
run script
2024-01-11T01:19:11.173    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:19:11.175    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070128-103131-322_L1C_052-260-3_D_V1-0.zip
2024-01-11T01:19:11.175    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:19:11.175    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:19:11.175    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:19:11.175    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:19:11.175    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:19:11.175    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:19:11.175    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:19:11.175    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070128-103131-322_L1C_052-260-3_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/07/29/SPOT5-HRG2-XS_20070729-102909-011_L1C_048-259-9_D_V1-0/SPOT5-HRG2-XS_20070729-102909-011_L1C_048-259-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070729-102909-011_L1C_048-259-9_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070729-102909-011_L1C_048-259-9_D_V1-0.zip
run script
2024-01-11T01:22:23.722    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:22:23.723    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070729-102909-011_L1C_048-259-9_D_V1-0.zip
2024-01-11T01:22:23.723    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:22:23.723    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:22:23.723    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:22:23.723    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:22:23.723    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:22:23.723    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:22:23.723    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:22:23.723    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070729-102909-011_L1C_048-259-9_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/07/29/SPOT5-HRG2-XS_20070729-102909-156_L1C_048-260-0_D_V1-0/SPOT5-HRG2-XS_20070729-102909-156_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070729-102909-156_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070729-102909-156_L1C_048-260-0_D_V1-0.zip
run script
2024-01-11T01:22:29.435    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:22:29.436    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070729-102909-156_L1C_048-260-0_D_V1-0.zip
2024-01-11T01:22:29.436    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:22:29.436    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:22:29.436    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:22:29.436    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:22:29.436    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:22:29.436    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:22:29.436    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:22:29.436    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070729-102909-156_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/07/29/SPOT5-HRG2-XS_20070729-102910-961_L1C_048-260-2_D_V1-0/SPOT5-HRG2-XS_20070729-102910-961_L1C_048-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070729-102910-961_L1C_048-260-2_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070729-102910-961_L1C_048-260-2_D_V1-0.zip
run script
2024-01-11T01:22:34.975    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:22:34.975    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070729-102910-961_L1C_048-260-2_D_V1-0.zip
2024-01-11T01:22:34.975    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:22:34.975    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:22:34.975    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:22:34.975    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:22:34.975    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:22:34.975    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:22:34.975    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:22:34.975    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070729-102910-961_L1C_048-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/04/05/SPOT5-HRG1-XS_20070405-104147-363_L1C_049-254-9_D_V1-0/SPOT5-HRG1-XS_20070405-104147-363_L1C_049-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070405-104147-363_L1C_049-254-9_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070405-104147-363_L1C_049-254-9_D_V1-0.zip
run script
2024-01-11T01:22:39.925    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:22:39.925    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070405-104147-363_L1C_049-254-9_D_V1-0.zip
2024-01-11T01:22:39.925    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:22:39.925    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:22:39.925    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:22:39.925    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:22:39.925    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:22:39.925    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:22:39.925    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:22:39.925    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070405-104147-363_L1C_049-254-9_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/04/05/SPOT5-HRG1-XS_20070405-104147-508_L1C_049-255-0_D_V1-0/SPOT5-HRG1-XS_20070405-104147-508_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070405-104147-508_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070405-104147-508_L1C_049-255-0_D_V1-0.zip
run script
2024-01-11T01:23:19.145    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:23:19.146    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070405-104147-508_L1C_049-255-0_D_V1-0.zip
2024-01-11T01:23:19.146    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:23:19.146    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:23:19.147    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:23:19.147    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:23:19.147    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:23:19.147    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:23:19.147    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:23:19.147    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070405-104147-508_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/04/05/SPOT5-HRG1-XS_20070405-104150-227_L1C_049-255-3_D_V1-0/SPOT5-HRG1-XS_20070405-104150-227_L1C_049-255-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070405-104150-227_L1C_049-255-3_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070405-104150-227_L1C_049-255-3_D_V1-0.zip
run script
2024-01-11T01:23:59.443    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:23:59.444    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070405-104150-227_L1C_049-255-3_D_V1-0.zip
2024-01-11T01:23:59.444    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:23:59.444    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:23:59.444    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:23:59.444    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:23:59.444    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:23:59.444    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:23:59.444    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:23:59.444    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-11T01:24:48.594    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (236 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070405-104150-227_L1C_049-255-3_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2007/09/07/SPOT5-HRG1-XS_20070907-105824-470_L1C_049-254-0_D_V1-0/SPOT5-HRG1-XS_20070907-105824-470_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070907-105824-470_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070907-105824-470_L1C_049-254-0_D_V1-0.zip
run script
2024-01-11T01:24:53.347    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:24:53.347    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070907-105824-470_L1C_049-254-0_D_V1-0.zip
2024-01-11T01:24:53.347    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:24:53.347    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:24:53.347    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:24:53.347    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:24:53.347    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:24:53.348    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:24:53.348    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:24:53.348    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070907-105824-470_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/09/07/SPOT5-HRG1-XS_20070907-105826-275_L1C_049-254-2_D_V1-0/SPOT5-HRG1-XS_20070907-105826-275_L1C_049-254-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070907-105826-275_L1C_049-254-2_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070907-105826-275_L1C_049-254-2_D_V1-0.zip
run script
2024-01-11T01:24:58.123    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:24:58.123    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070907-105826-275_L1C_049-254-2_D_V1-0.zip
2024-01-11T01:24:58.123    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:24:58.123    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:24:58.123    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:24:58.123    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:24:58.123    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:24:58.123    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:24:58.123    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:24:58.123    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070907-105826-275_L1C_049-254-2_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/09/09/SPOT5-HRG1-XS_20070909-101950-949_L1C_049-254-0_D_V1-0/SPOT5-HRG1-XS_20070909-101950-949_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070909-101950-949_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070909-101950-949_L1C_049-254-0_D_V1-0.zip
run script
2024-01-11T01:25:02.394    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:25:02.395    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070909-101950-949_L1C_049-254-0_D_V1-0.zip
2024-01-11T01:25:02.395    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:25:02.395    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:25:02.395    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:25:02.395    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:25:02.395    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:25:02.395    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:25:02.395    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:25:02.395    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070909-101950-949_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/09/09/SPOT5-HRG1-XS_20070909-101953-644_L1C_049-254-3_D_V1-0/SPOT5-HRG1-XS_20070909-101953-644_L1C_049-254-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070909-101953-644_L1C_049-254-3_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070909-101953-644_L1C_049-254-3_D_V1-0.zip
run script
2024-01-11T01:25:07.216    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:25:07.216    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070909-101953-644_L1C_049-254-3_D_V1-0.zip
2024-01-11T01:25:07.216    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:25:07.216    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:25:07.216    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:25:07.216    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:25:07.216    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:25:07.216    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:25:07.216    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:25:07.217    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070909-101953-644_L1C_049-254-3_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/09/09/SPOT5-HRG1-XS_20070909-102006-403_L1C_049-255-8_D_V1-0/SPOT5-HRG1-XS_20070909-102006-403_L1C_049-255-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070909-102006-403_L1C_049-255-8_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070909-102006-403_L1C_049-255-8_D_V1-0.zip
run script
2024-01-11T01:25:12.647    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:25:12.647    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070909-102006-403_L1C_049-255-8_D_V1-0.zip
2024-01-11T01:25:12.647    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:25:12.648    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:25:12.648    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:25:12.648    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:25:12.648    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:25:12.648    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:25:12.648    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:25:12.648    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070909-102006-403_L1C_049-255-8_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/09/09/SPOT5-HRG1-XS_20070909-102007-413_L1C_050-256-0_D_V1-0/SPOT5-HRG1-XS_20070909-102007-413_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070909-102007-413_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070909-102007-413_L1C_050-256-0_D_V1-0.zip
run script
2024-01-11T01:27:58.165    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:27:58.166    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070909-102007-413_L1C_050-256-0_D_V1-0.zip
2024-01-11T01:27:58.166    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:27:58.166    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:27:58.166    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:27:58.166    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:27:58.167    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:27:58.167    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:27:58.167    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:27:58.167    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070909-102007-413_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/09/09/SPOT5-HRG1-XS_20070909-102011-913_L1C_050-256-5_D_V1-0/SPOT5-HRG1-XS_20070909-102011-913_L1C_050-256-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070909-102011-913_L1C_050-256-5_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070909-102011-913_L1C_050-256-5_D_V1-0.zip
run script
2024-01-11T01:30:50.130    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:30:50.132    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070909-102011-913_L1C_050-256-5_D_V1-0.zip
2024-01-11T01:30:50.132    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:30:50.132    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:30:50.132    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:30:50.132    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:30:50.132    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:30:50.132    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:30:50.132    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:30:50.132    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070909-102011-913_L1C_050-256-5_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 0 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]
 [2 0 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/09/09/SPOT5-HRG2-XS_20070909-102028-227_L1C_051-258-6_D_V1-0/SPOT5-HRG2-XS_20070909-102028-227_L1C_051-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070909-102028-227_L1C_051-258-6_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070909-102028-227_L1C_051-258-6_D_V1-0.zip
run script
2024-01-11T01:33:42.310    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:33:42.311    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070909-102028-227_L1C_051-258-6_D_V1-0.zip
2024-01-11T01:33:42.312    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:33:42.312    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:33:42.312    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:33:42.312    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:33:42.312    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:33:42.312    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:33:42.312    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:33:42.312    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070909-102028-227_L1C_051-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/09/09/SPOT5-HRG2-XS_20070909-102031-981_L1C_051-259-1_D_V1-0/SPOT5-HRG2-XS_20070909-102031-981_L1C_051-259-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070909-102031-981_L1C_051-259-1_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070909-102031-981_L1C_051-259-1_D_V1-0.zip
run script
2024-01-11T01:36:57.703    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:36:57.704    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070909-102031-981_L1C_051-259-1_D_V1-0.zip
2024-01-11T01:36:57.704    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:36:57.704    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:36:57.704    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:36:57.705    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:36:57.705    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:36:57.705    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:36:57.705    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:36:57.705    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070909-102031-981_L1C_051-259-1_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/09/14/SPOT5-HRG1-XS_20070914-102337-039_L1C_049-254-0_D_V1-0/SPOT5-HRG1-XS_20070914-102337-039_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070914-102337-039_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070914-102337-039_L1C_049-254-0_D_V1-0.zip
run script
2024-01-11T01:39:57.316    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:39:57.317    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070914-102337-039_L1C_049-254-0_D_V1-0.zip
2024-01-11T01:39:57.317    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:39:57.317    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:39:57.318    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:39:57.318    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:39:57.318    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:39:57.318    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:39:57.318    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:39:57.318    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070914-102337-039_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/09/14/SPOT5-HRG1-XS_20070914-102337-953_L1C_049-254-1_D_V1-0/SPOT5-HRG1-XS_20070914-102337-953_L1C_049-254-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070914-102337-953_L1C_049-254-1_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070914-102337-953_L1C_049-254-1_D_V1-0.zip
run script
2024-01-11T01:40:02.566    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:40:02.566    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070914-102337-953_L1C_049-254-1_D_V1-0.zip
2024-01-11T01:40:02.566    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:40:02.566    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:40:02.566    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:40:02.566    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:40:02.567    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:40:02.567    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:40:02.567    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:40:02.567    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070914-102337-953_L1C_049-254-1_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/09/14/SPOT5-HRG2-XS_20070914-102353-110_L1C_051-256-1_D_V1-0/SPOT5-HRG2-XS_20070914-102353-110_L1C_051-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070914-102353-110_L1C_051-256-1_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070914-102353-110_L1C_051-256-1_D_V1-0.zip
run script
2024-01-11T01:40:07.876    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:40:07.876    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070914-102353-110_L1C_051-256-1_D_V1-0.zip
2024-01-11T01:40:07.876    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:40:07.876    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:40:07.877    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:40:07.877    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:40:07.877    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:40:07.877    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:40:07.877    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:40:07.877    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070914-102353-110_L1C_051-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/09/14/SPOT5-HRG2-XS_20070914-102358-524_L1C_051-256-7_D_V1-0/SPOT5-HRG2-XS_20070914-102358-524_L1C_051-256-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070914-102358-524_L1C_051-256-7_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070914-102358-524_L1C_051-256-7_D_V1-0.zip
run script
2024-01-11T01:43:24.459    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:43:24.460    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070914-102358-524_L1C_051-256-7_D_V1-0.zip
2024-01-11T01:43:24.460    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:43:24.460    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:43:24.460    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:43:24.460    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:43:24.460    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:43:24.460    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:43:24.460    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:43:24.460    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070914-102358-524_L1C_051-256-7_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/09/14/SPOT5-HRG2-XS_20070914-102414-131_L1C_051-258-6_D_V1-0/SPOT5-HRG2-XS_20070914-102414-131_L1C_051-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070914-102414-131_L1C_051-258-6_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070914-102414-131_L1C_051-258-6_D_V1-0.zip
run script
2024-01-11T01:47:06.015    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:47:06.016    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070914-102414-131_L1C_051-258-6_D_V1-0.zip
2024-01-11T01:47:06.016    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:47:06.016    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:47:06.016    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:47:06.016    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:47:06.016    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:47:06.016    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:47:06.016    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:47:06.016    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070914-102414-131_L1C_051-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/09/14/SPOT5-HRG2-XS_20070914-102416-994_L1C_051-259-0_D_V1-0/SPOT5-HRG2-XS_20070914-102416-994_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070914-102416-994_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070914-102416-994_L1C_051-259-0_D_V1-0.zip
run script
2024-01-11T01:50:12.407    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:50:12.409    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070914-102416-994_L1C_051-259-0_D_V1-0.zip
2024-01-11T01:50:12.409    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:50:12.409    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:50:12.409    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:50:12.409    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:50:12.409    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:50:12.409    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:50:12.409    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:50:12.409    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070914-102416-994_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/09/18/SPOT5-HRG1-XS_20070918-104640-788_L1C_049-254-1_D_V1-0/SPOT5-HRG1-XS_20070918-104640-788_L1C_049-254-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070918-104640-788_L1C_049-254-1_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070918-104640-788_L1C_049-254-1_D_V1-0.zip
run script
2024-01-11T01:53:13.711    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:53:13.712    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070918-104640-788_L1C_049-254-1_D_V1-0.zip
2024-01-11T01:53:13.712    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:53:13.712    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:53:13.712    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:53:13.712    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:53:13.712    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:53:13.712    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:53:13.712    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:53:13.712    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070918-104640-788_L1C_049-254-1_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/09/23/SPOT5-HRG2-XS_20070923-105025-142_L1C_049-254-0_D_V1-0/SPOT5-HRG2-XS_20070923-105025-142_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070923-105025-142_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070923-105025-142_L1C_049-254-0_D_V1-0.zip
run script
2024-01-11T01:53:19.028    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:53:19.028    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070923-105025-142_L1C_049-254-0_D_V1-0.zip
2024-01-11T01:53:19.029    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:53:19.029    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:53:19.029    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:53:19.029    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:53:19.029    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:53:19.029    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:53:19.029    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:53:19.029    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070923-105025-142_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/09/23/SPOT5-HRG2-XS_20070923-105026-947_L1C_049-254-2_D_V1-0/SPOT5-HRG2-XS_20070923-105026-947_L1C_049-254-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070923-105026-947_L1C_049-254-2_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070923-105026-947_L1C_049-254-2_D_V1-0.zip
run script
2024-01-11T01:53:24.567    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:53:24.567    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070923-105026-947_L1C_049-254-2_D_V1-0.zip
2024-01-11T01:53:24.567    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:53:24.567    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:53:24.567    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:53:24.567    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:53:24.567    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:53:24.568    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:53:24.568    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:53:24.568    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070923-105026-947_L1C_049-254-2_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/09/29/SPOT5-HRG2-XS_20070929-103454-051_L1C_049-254-0_D_V1-0/SPOT5-HRG2-XS_20070929-103454-051_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070929-103454-051_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070929-103454-051_L1C_049-254-0_D_V1-0.zip
run script
2024-01-11T01:53:29.612    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:53:29.612    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070929-103454-051_L1C_049-254-0_D_V1-0.zip
2024-01-11T01:53:29.612    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:53:29.612    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:53:29.612    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:53:29.612    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:53:29.612    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:53:29.612    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:53:29.612    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:53:29.612    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070929-103454-051_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/09/29/SPOT5-HRG2-XS_20070929-103454-942_L1C_049-254-1_D_V1-0/SPOT5-HRG2-XS_20070929-103454-942_L1C_049-254-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070929-103454-942_L1C_049-254-1_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070929-103454-942_L1C_049-254-1_D_V1-0.zip
run script
2024-01-11T01:53:34.794    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:53:34.795    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070929-103454-942_L1C_049-254-1_D_V1-0.zip
2024-01-11T01:53:34.795    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:53:34.795    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:53:34.795    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:53:34.795    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:53:34.795    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:53:34.795    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:53:34.795    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:53:34.795    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070929-103454-942_L1C_049-254-1_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/09/29/SPOT5-HRG2-XS_20070929-103530-611_L1C_051-258-6_D_V1-0/SPOT5-HRG2-XS_20070929-103530-611_L1C_051-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070929-103530-611_L1C_051-258-6_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070929-103530-611_L1C_051-258-6_D_V1-0.zip
run script
2024-01-11T01:53:39.762    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:53:39.762    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070929-103530-611_L1C_051-258-6_D_V1-0.zip
2024-01-11T01:53:39.763    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:53:39.763    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:53:39.763    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:53:39.763    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:53:39.763    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:53:39.763    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:53:39.763    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:53:39.763    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070929-103530-611_L1C_051-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/09/29/SPOT5-HRG2-XS_20070929-103534-413_L1C_051-259-1_D_V1-0/SPOT5-HRG2-XS_20070929-103534-413_L1C_051-259-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070929-103534-413_L1C_051-259-1_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070929-103534-413_L1C_051-259-1_D_V1-0.zip
run script
2024-01-11T01:56:40.816    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:56:40.817    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070929-103534-413_L1C_051-259-1_D_V1-0.zip
2024-01-11T01:56:40.817    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:56:40.817    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:56:40.817    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:56:40.817    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:56:40.817    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:56:40.818    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:56:40.818    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:56:40.818    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070929-103534-413_L1C_051-259-1_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/10/05/SPOT5-HRG2-XS_20071005-101924-244_L1C_049-254-1_D_V1-0/SPOT5-HRG2-XS_20071005-101924-244_L1C_049-254-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20071005-101924-244_L1C_049-254-1_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071005-101924-244_L1C_049-254-1_D_V1-0.zip
run script
2024-01-11T01:59:28.767    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:59:28.768    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071005-101924-244_L1C_049-254-1_D_V1-0.zip
2024-01-11T01:59:28.768    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:59:28.768    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:59:28.769    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:59:28.769    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:59:28.769    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:59:28.769    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:59:28.769    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:59:28.769    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071005-101924-244_L1C_049-254-1_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/10/09/SPOT5-HRG2-XS_20071009-104231-264_L1C_049-254-0_D_V1-0/SPOT5-HRG2-XS_20071009-104231-264_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20071009-104231-264_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071009-104231-264_L1C_049-254-0_D_V1-0.zip
run script
2024-01-11T01:59:34.048    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:59:34.048    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071009-104231-264_L1C_049-254-0_D_V1-0.zip
2024-01-11T01:59:34.048    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:59:34.048    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:59:34.048    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:59:34.048    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:59:34.048    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:59:34.049    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:59:34.049    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:59:34.049    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071009-104231-264_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/10/09/SPOT5-HRG2-XS_20071009-104233-959_L1C_049-254-3_D_V1-0/SPOT5-HRG2-XS_20071009-104233-959_L1C_049-254-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20071009-104233-959_L1C_049-254-3_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071009-104233-959_L1C_049-254-3_D_V1-0.zip
run script
2024-01-11T01:59:39.322    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:59:39.322    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071009-104233-959_L1C_049-254-3_D_V1-0.zip
2024-01-11T01:59:39.322    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:59:39.322    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:59:39.322    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:59:39.322    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:59:39.322    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:59:39.323    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:59:39.323    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:59:39.323    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071009-104233-959_L1C_049-254-3_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/10/10/SPOT5-HRG2-XS_20071010-102315-785_L1C_049-254-1_D_V1-0/SPOT5-HRG2-XS_20071010-102315-785_L1C_049-254-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20071010-102315-785_L1C_049-254-1_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071010-102315-785_L1C_049-254-1_D_V1-0.zip
run script
2024-01-11T01:59:44.151    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:59:44.151    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071010-102315-785_L1C_049-254-1_D_V1-0.zip
2024-01-11T01:59:44.151    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:59:44.151    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:59:44.151    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:59:44.151    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:59:44.152    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:59:44.152    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:59:44.152    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:59:44.152    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071010-102315-785_L1C_049-254-1_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/10/14/SPOT5-HRG2-XS_20071014-104621-887_L1C_049-254-0_D_V1-0/SPOT5-HRG2-XS_20071014-104621-887_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20071014-104621-887_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071014-104621-887_L1C_049-254-0_D_V1-0.zip
run script
2024-01-11T01:59:49.622    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:59:49.622    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071014-104621-887_L1C_049-254-0_D_V1-0.zip
2024-01-11T01:59:49.623    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:59:49.623    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:59:49.623    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:59:49.623    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:59:49.623    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:59:49.623    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:59:49.623    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:59:49.623    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071014-104621-887_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/10/14/SPOT5-HRG2-XS_20071014-104622-778_L1C_049-254-1_D_V1-0/SPOT5-HRG2-XS_20071014-104622-778_L1C_049-254-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20071014-104622-778_L1C_049-254-1_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071014-104622-778_L1C_049-254-1_D_V1-0.zip
run script
2024-01-11T01:59:54.908    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:59:54.908    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071014-104622-778_L1C_049-254-1_D_V1-0.zip
2024-01-11T01:59:54.908    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:59:54.908    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:59:54.908    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:59:54.909    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:59:54.909    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:59:54.909    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:59:54.909    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:59:54.909    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071014-104622-778_L1C_049-254-1_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/10/26/SPOT5-HRG2-XS_20071026-101529-858_L1C_050-254-0_D_V1-0/SPOT5-HRG2-XS_20071026-101529-858_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20071026-101529-858_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071026-101529-858_L1C_050-254-0_D_V1-0.zip
run script
2024-01-11T01:59:59.928    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T01:59:59.929    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071026-101529-858_L1C_050-254-0_D_V1-0.zip
2024-01-11T01:59:59.929    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:59:59.929    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:59:59.929    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T01:59:59.929    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:59:59.929    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:59:59.929    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:59:59.929    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:59:59.930    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071026-101529-858_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/10/26/SPOT5-HRG2-XS_20071026-101534-357_L1C_050-254-5_D_V1-0/SPOT5-HRG2-XS_20071026-101534-357_L1C_050-254-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20071026-101534-357_L1C_050-254-5_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071026-101534-357_L1C_050-254-5_D_V1-0.zip
run script
2024-01-11T02:00:04.157    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T02:00:04.157    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071026-101534-357_L1C_050-254-5_D_V1-0.zip
2024-01-11T02:00:04.157    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:00:04.157    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:00:04.157    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T02:00:04.157    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:00:04.157    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:00:04.157    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:00:04.157    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:00:04.157    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-11T02:00:07.112    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (0 x 4028). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071026-101534-357_L1C_050-254-5_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2007/10/26/SPOT5-HRG2-XS_20071026-101633-719_L1C_052-262-0_D_V1-0/SPOT5-HRG2-XS_20071026-101633-719_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20071026-101633-719_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071026-101633-719_L1C_052-262-0_D_V1-0.zip
run script
2024-01-11T02:00:10.955    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T02:00:10.955    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071026-101633-719_L1C_052-262-0_D_V1-0.zip
2024-01-11T02:00:10.955    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:00:10.955    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:00:10.956    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T02:00:10.956    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:00:10.956    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:00:10.956    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:00:10.956    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:00:10.956    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071026-101633-719_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/10/26/SPOT5-HRG2-XS_20071026-101636-414_L1C_052-262-3_D_V1-0/SPOT5-HRG2-XS_20071026-101636-414_L1C_052-262-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20071026-101636-414_L1C_052-262-3_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071026-101636-414_L1C_052-262-3_D_V1-0.zip
run script
2024-01-11T02:03:01.364    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T02:03:01.365    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071026-101636-414_L1C_052-262-3_D_V1-0.zip
2024-01-11T02:03:01.365    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:03:01.365    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:03:01.365    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T02:03:01.365    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:03:01.365    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:03:01.365    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:03:01.365    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:03:01.365    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071026-101636-414_L1C_052-262-3_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/12/05/SPOT5-HRG2-XS_20071205-104612-670_L1C_050-254-2_D_V1-0/SPOT5-HRG2-XS_20071205-104612-670_L1C_050-254-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20071205-104612-670_L1C_050-254-2_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071205-104612-670_L1C_050-254-2_D_V1-0.zip
run script
2024-01-11T02:05:36.747    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T02:05:36.748    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071205-104612-670_L1C_050-254-2_D_V1-0.zip
2024-01-11T02:05:36.748    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:05:36.748    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:05:36.748    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T02:05:36.748    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:05:36.748    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:05:36.748    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:05:36.748    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:05:36.748    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071205-104612-670_L1C_050-254-2_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/12/05/SPOT5-HRG2-XS_20071205-104615-365_L1C_050-254-5_D_V1-0/SPOT5-HRG2-XS_20071205-104615-365_L1C_050-254-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20071205-104615-365_L1C_050-254-5_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071205-104615-365_L1C_050-254-5_D_V1-0.zip
run script
2024-01-11T02:05:42.115    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T02:05:42.116    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071205-104615-365_L1C_050-254-5_D_V1-0.zip
2024-01-11T02:05:42.116    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:05:42.116    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:05:42.116    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T02:05:42.116    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:05:42.116    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:05:42.116    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:05:42.116    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:05:42.117    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-11T02:05:45.108    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (0 x 3820). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071205-104615-365_L1C_050-254-5_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2007/05/18/SPOT5-HRG2-XS_20070518-101419-255_L1C_050-256-8_D_V1-0/SPOT5-HRG2-XS_20070518-101419-255_L1C_050-256-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070518-101419-255_L1C_050-256-8_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070518-101419-255_L1C_050-256-8_D_V1-0.zip
run script
2024-01-11T02:05:50.574    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T02:05:50.575    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070518-101419-255_L1C_050-256-8_D_V1-0.zip
2024-01-11T02:05:50.575    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:05:50.575    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:05:50.575    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T02:05:50.575    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:05:50.575    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:05:50.575    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:05:50.575    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:05:50.575    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070518-101419-255_L1C_050-256-8_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/05/18/SPOT5-HRG2-XS_20070518-101420-266_L1C_050-257-0_D_V1-0/SPOT5-HRG2-XS_20070518-101420-266_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070518-101420-266_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070518-101420-266_L1C_050-257-0_D_V1-0.zip
run script
2024-01-11T02:10:14.208    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T02:10:14.209    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070518-101420-266_L1C_050-257-0_D_V1-0.zip
2024-01-11T02:10:14.209    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:10:14.209    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:10:14.209    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T02:10:14.209    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:10:14.209    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:10:14.210    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:10:14.210    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:10:14.210    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070518-101420-266_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/05/18/SPOT5-HRG2-XS_20070518-101422-071_L1C_050-257-2_D_V1-0/SPOT5-HRG2-XS_20070518-101422-071_L1C_050-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070518-101422-071_L1C_050-257-2_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070518-101422-071_L1C_050-257-2_D_V1-0.zip
run script
2024-01-11T02:14:34.954    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T02:14:34.955    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070518-101422-071_L1C_050-257-2_D_V1-0.zip
2024-01-11T02:14:34.955    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:14:34.955    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:14:34.955    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T02:14:34.956    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:14:34.956    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:14:34.956    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:14:34.956    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:14:34.956    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070518-101422-071_L1C_050-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/07/19/SPOT5-HRG2-XS_20070719-102124-858_L1C_050-258-9_D_V1-0/SPOT5-HRG2-XS_20070719-102124-858_L1C_050-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070719-102124-858_L1C_050-258-9_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070719-102124-858_L1C_050-258-9_D_V1-0.zip
run script
2024-01-11T02:18:57.902    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T02:18:57.903    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070719-102124-858_L1C_050-258-9_D_V1-0.zip
2024-01-11T02:18:57.903    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:18:57.903    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:18:57.903    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T02:18:57.903    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:18:57.903    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:18:57.903    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:18:57.904    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:18:57.904    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070719-102124-858_L1C_050-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 2 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [2 0 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/07/19/SPOT5-HRG2-XS_20070719-102124-978_L1C_050-259-0_D_V1-0/SPOT5-HRG2-XS_20070719-102124-978_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070719-102124-978_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070719-102124-978_L1C_050-259-0_D_V1-0.zip
run script
2024-01-11T02:20:59.966    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T02:20:59.968    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070719-102124-978_L1C_050-259-0_D_V1-0.zip
2024-01-11T02:20:59.968    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:20:59.968    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:20:59.968    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T02:20:59.968    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:20:59.968    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:20:59.968    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:20:59.968    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:20:59.968    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070719-102124-978_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/07/19/SPOT5-HRG2-XS_20070719-102126-783_L1C_050-259-2_D_V1-0/SPOT5-HRG2-XS_20070719-102126-783_L1C_050-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070719-102126-783_L1C_050-259-2_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070719-102126-783_L1C_050-259-2_D_V1-0.zip
run script
2024-01-11T02:23:02.051    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T02:23:02.053    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070719-102126-783_L1C_050-259-2_D_V1-0.zip
2024-01-11T02:23:02.053    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:23:02.053    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:23:02.053    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T02:23:02.053    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:23:02.053    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:23:02.053    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:23:02.053    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:23:02.053    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070719-102126-783_L1C_050-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/07/19/SPOT5-HRG1-XS_20070719-102121-220_L1C_051-258-6_D_V1-0/SPOT5-HRG1-XS_20070719-102121-220_L1C_051-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070719-102121-220_L1C_051-258-6_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070719-102121-220_L1C_051-258-6_D_V1-0.zip
run script
2024-01-11T02:25:02.638    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T02:25:02.639    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070719-102121-220_L1C_051-258-6_D_V1-0.zip
2024-01-11T02:25:02.639    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:25:02.640    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:25:02.640    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T02:25:02.640    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:25:02.640    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:25:02.640    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:25:02.640    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:25:02.640    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070719-102121-220_L1C_051-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/07/19/SPOT5-HRG1-XS_20070719-102124-060_L1C_051-259-0_D_V1-0/SPOT5-HRG1-XS_20070719-102124-060_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070719-102124-060_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070719-102124-060_L1C_051-259-0_D_V1-0.zip
run script
2024-01-11T02:28:20.038    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T02:28:20.039    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070719-102124-060_L1C_051-259-0_D_V1-0.zip
2024-01-11T02:28:20.039    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:28:20.039    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:28:20.039    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T02:28:20.040    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:28:20.040    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:28:20.040    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:28:20.040    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:28:20.040    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070719-102124-060_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/07/19/SPOT5-HRG1-XS_20070719-102126-755_L1C_051-259-3_D_V1-0/SPOT5-HRG1-XS_20070719-102126-755_L1C_051-259-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070719-102126-755_L1C_051-259-3_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070719-102126-755_L1C_051-259-3_D_V1-0.zip
run script
2024-01-11T02:31:32.684    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T02:31:32.684    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070719-102126-755_L1C_051-259-3_D_V1-0.zip
2024-01-11T02:31:32.684    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:31:32.685    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:31:32.685    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T02:31:32.685    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:31:32.685    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:31:32.685    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:31:32.685    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:31:32.685    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070719-102126-755_L1C_051-259-3_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 2 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/12/31/SPOT5-HRG2-XS_20071231-104640-882_L1C_050-258-9_D_V1-0/SPOT5-HRG2-XS_20071231-104640-882_L1C_050-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20071231-104640-882_L1C_050-258-9_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071231-104640-882_L1C_050-258-9_D_V1-0.zip
run script
2024-01-11T02:34:32.349    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T02:34:32.351    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071231-104640-882_L1C_050-258-9_D_V1-0.zip
2024-01-11T02:34:32.351    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:34:32.351    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:34:32.351    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T02:34:32.351    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:34:32.351    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:34:32.351    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:34:32.351    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:34:32.351    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071231-104640-882_L1C_050-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/12/31/SPOT5-HRG2-XS_20071231-104649-521_L1C_050-260-0_D_V1-0/SPOT5-HRG2-XS_20071231-104649-521_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20071231-104649-521_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071231-104649-521_L1C_050-260-0_D_V1-0.zip
run script
2024-01-11T02:36:51.096    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T02:36:51.097    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071231-104649-521_L1C_050-260-0_D_V1-0.zip
2024-01-11T02:36:51.097    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:36:51.097    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:36:51.097    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T02:36:51.097    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:36:51.097    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:36:51.097    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:36:51.097    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:36:51.097    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071231-104649-521_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/12/31/SPOT5-HRG2-XS_20071231-104657-919_L1C_050-261-0_D_V1-0/SPOT5-HRG2-XS_20071231-104657-919_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20071231-104657-919_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071231-104657-919_L1C_050-261-0_D_V1-0.zip
run script
2024-01-11T02:38:27.562    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T02:38:27.563    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071231-104657-919_L1C_050-261-0_D_V1-0.zip
2024-01-11T02:38:27.564    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:38:27.564    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:38:27.564    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T02:38:27.564    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:38:27.564    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:38:27.564    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:38:27.564    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:38:27.564    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071231-104657-919_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/12/31/SPOT5-HRG2-XS_20071231-104707-208_L1C_050-262-1_D_V1-0/SPOT5-HRG2-XS_20071231-104707-208_L1C_050-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20071231-104707-208_L1C_050-262-1_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071231-104707-208_L1C_050-262-1_D_V1-0.zip
run script
2024-01-11T02:39:51.285    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T02:39:51.286    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071231-104707-208_L1C_050-262-1_D_V1-0.zip
2024-01-11T02:39:51.286    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:39:51.286    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:39:51.286    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T02:39:51.287    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:39:51.287    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:39:51.287    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:39:51.287    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:39:51.287    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20071231-104707-208_L1C_050-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/12/31/SPOT5-HRG1-XS_20071231-104655-265_L1C_051-261-0_D_V1-0/SPOT5-HRG1-XS_20071231-104655-265_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20071231-104655-265_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20071231-104655-265_L1C_051-261-0_D_V1-0.zip
run script
2024-01-11T02:40:36.855    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T02:40:36.856    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20071231-104655-265_L1C_051-261-0_D_V1-0.zip
2024-01-11T02:40:36.856    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:40:36.857    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:40:36.857    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T02:40:36.857    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:40:36.857    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:40:36.857    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:40:36.857    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:40:36.857    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20071231-104655-265_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 1 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/12/31/SPOT5-HRG1-XS_20071231-104704-578_L1C_051-262-1_D_V1-0/SPOT5-HRG1-XS_20071231-104704-578_L1C_051-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20071231-104704-578_L1C_051-262-1_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20071231-104704-578_L1C_051-262-1_D_V1-0.zip
run script
2024-01-11T02:44:09.468    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T02:44:09.469    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20071231-104704-578_L1C_051-262-1_D_V1-0.zip
2024-01-11T02:44:09.469    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:44:09.469    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:44:09.469    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T02:44:09.469    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:44:09.469    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:44:09.469    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:44:09.470    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:44:09.470    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-11T02:46:39.970    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (452 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20071231-104704-578_L1C_051-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2007/12/31/SPOT5-HRG1-XS_20071231-104654-976_L1C_052-260-9_D_V1-0/SPOT5-HRG1-XS_20071231-104654-976_L1C_052-260-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20071231-104654-976_L1C_052-260-9_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20071231-104654-976_L1C_052-260-9_D_V1-0.zip
run script
2024-01-11T02:46:45.495    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T02:46:45.496    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20071231-104654-976_L1C_052-260-9_D_V1-0.zip
2024-01-11T02:46:45.496    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:46:45.496    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:46:45.496    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T02:46:45.496    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:46:45.496    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:46:45.496    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:46:45.496    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:46:45.496    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20071231-104654-976_L1C_052-260-9_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/03/11/SPOT5-HRG1-XS_20070311-102338-308_L1C_050-260-9_D_V1-0/SPOT5-HRG1-XS_20070311-102338-308_L1C_050-260-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070311-102338-308_L1C_050-260-9_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070311-102338-308_L1C_050-260-9_D_V1-0.zip
run script
2024-01-11T02:50:20.488    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T02:50:20.489    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070311-102338-308_L1C_050-260-9_D_V1-0.zip
2024-01-11T02:50:20.490    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:50:20.490    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:50:20.490    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T02:50:20.490    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:50:20.490    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:50:20.490    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:50:20.490    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:50:20.490    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070311-102338-308_L1C_050-260-9_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/03/11/SPOT5-HRG1-XS_20070311-102346-755_L1C_050-262-0_D_V1-0/SPOT5-HRG1-XS_20070311-102346-755_L1C_050-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070311-102346-755_L1C_050-262-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070311-102346-755_L1C_050-262-0_D_V1-0.zip
run script
2024-01-11T02:51:32.692    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T02:51:32.693    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070311-102346-755_L1C_050-262-0_D_V1-0.zip
2024-01-11T02:51:32.693    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:51:32.694    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:51:32.694    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T02:51:32.694    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:51:32.694    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:51:32.694    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:51:32.694    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:51:32.694    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070311-102346-755_L1C_050-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/03/11/SPOT5-HRG2-XS_20070311-102340-504_L1C_054-261-9_D_V1-0/SPOT5-HRG2-XS_20070311-102340-504_L1C_054-261-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070311-102340-504_L1C_054-261-9_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070311-102340-504_L1C_054-261-9_D_V1-0.zip
run script
2024-01-11T02:52:18.906    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T02:52:18.908    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070311-102340-504_L1C_054-261-9_D_V1-0.zip
2024-01-11T02:52:18.908    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:52:18.908    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:52:18.908    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T02:52:18.908    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:52:18.908    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:52:18.908    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:52:18.908    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:52:18.908    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070311-102340-504_L1C_054-261-9_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/04/15/SPOT5-HRG1-XS_20070415-105008-479_L1C_050-260-9_D_V1-0/SPOT5-HRG1-XS_20070415-105008-479_L1C_050-260-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070415-105008-479_L1C_050-260-9_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070415-105008-479_L1C_050-260-9_D_V1-0.zip
run script
2024-01-11T02:54:01.057    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T02:54:01.058    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070415-105008-479_L1C_050-260-9_D_V1-0.zip
2024-01-11T02:54:01.058    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:54:01.058    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:54:01.058    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T02:54:01.059    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:54:01.059    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:54:01.059    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:54:01.059    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:54:01.059    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070415-105008-479_L1C_050-260-9_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/04/15/SPOT5-HRG1-XS_20070415-105011-439_L1C_050-261-3_D_V1-0/SPOT5-HRG1-XS_20070415-105011-439_L1C_050-261-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20070415-105011-439_L1C_050-261-3_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070415-105011-439_L1C_050-261-3_D_V1-0.zip
run script
2024-01-11T02:54:59.324    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T02:54:59.325    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070415-105011-439_L1C_050-261-3_D_V1-0.zip
2024-01-11T02:54:59.325    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:54:59.325    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:54:59.325    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T02:54:59.325    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:54:59.325    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:54:59.325    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:54:59.325    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:54:59.325    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG1-XS_20070415-105011-439_L1C_050-261-3_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2007/04/15/SPOT5-HRG2-XS_20070415-104908-595_L1C_051-254-0_D_V1-0/SPOT5-HRG2-XS_20070415-104908-595_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070415-104908-595_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070415-104908-595_L1C_051-254-0_D_V1-0.zip
run script
2024-01-11T02:55:49.370    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T02:55:49.371    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070415-104908-595_L1C_051-254-0_D_V1-0.zip
2024-01-11T02:55:49.371    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:55:49.371    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:55:49.371    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T02:55:49.371    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:55:49.371    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:55:49.372    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:55:49.372    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:55:49.372    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070415-104908-595_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2007/04/15/SPOT5-HRG2-XS_20070415-104911-290_L1C_051-254-3_D_V1-0/SPOT5-HRG2-XS_20070415-104911-290_L1C_051-254-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20070415-104911-290_L1C_051-254-3_D_V1-0.zip
/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070415-104911-290_L1C_051-254-3_D_V1-0.zip
run script
2024-01-11T02:55:54.261    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-11T02:55:54.261    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070415-104911-290_L1C_051-254-3_D_V1-0.zip
2024-01-11T02:55:54.261    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:55:54.261    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:55:54.261    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-11T02:55:54.261    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:55:54.261    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:55:54.261    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:55:54.262    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:55:54.262    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122155/INPUT/SPOT5-HRG2-XS_20070415-104911-290_L1C_051-254-3_D_V1-0.zip', job_dir='/tmp/slurm-4122155/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
end
[2024-01-11 02:55:54.608170250+00:00] cnes_level2/barrouz/4122155:  Account (env) = cnes_level2
[2024-01-11 02:55:54.608994616+00:00] cnes_level2/barrouz/4122155:     User (env) = barrouz
[2024-01-11 02:55:54.609766393+00:00] cnes_level2/barrouz/4122155:        GroupId = cesbio(426000053)
[2024-01-11 02:55:54.610509620+00:00] cnes_level2/barrouz/4122155:         UserId = barrouz(9134)
[2024-01-11 02:55:54.611240107+00:00] cnes_level2/barrouz/4122155:        Account = cnes_level2
[2024-01-11 02:55:54.611973774+00:00] cnes_level2/barrouz/4122155:        Account = cnes_level2
[2024-01-11 02:55:54.612759711+00:00] cnes_level2/barrouz/4122155:      Partition = cpu2022
[2024-01-11 02:55:54.613543278+00:00] cnes_level2/barrouz/4122155:            QOS = cpu_2022_1280
[2024-01-11 02:55:54.614308704+00:00] cnes_level2/barrouz/4122155:        JobName = inf_ALP_16_TCD-BLUE_AVG-1200
[2024-01-11 02:55:54.615057361+00:00] cnes_level2/barrouz/4122155:     SubmitTime = 2024-01-10T19:50:38
[2024-01-11 02:55:54.615768708+00:00] cnes_level2/barrouz/4122155:        RunTime = 07:04:56
[2024-01-11 02:55:54.616515485+00:00] cnes_level2/barrouz/4122155:      TimeLimit = 1-16:00:00
[2024-01-11 02:55:54.617274942+00:00] cnes_level2/barrouz/4122155:   EligibleTime = 2024-01-10T19:50:38
[2024-01-11 02:55:54.617985979+00:00] cnes_level2/barrouz/4122155:      StartTime = 2024-01-10T19:50:58
[2024-01-11 02:55:54.618748756+00:00] cnes_level2/barrouz/4122155:        EndTime = 2024-01-11T02:55:54
[2024-01-11 02:55:54.619522273+00:00] cnes_level2/barrouz/4122155:       ExitCode = 0:0
[2024-01-11 02:55:54.620246960+00:00] cnes_level2/barrouz/4122155:       NodeList = trex034
[2024-01-11 02:55:54.620978567+00:00] cnes_level2/barrouz/4122155:      BatchHost = trex034
[2024-01-11 02:55:54.621730034+00:00] cnes_level2/barrouz/4122155:           TRES = 
[2024-01-11 02:55:54.622493610+00:00] cnes_level2/barrouz/4122155:        Command = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
[2024-01-11 02:55:54.623244517+00:00] cnes_level2/barrouz/4122155:        WorkDir = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code
[2024-01-11 02:55:54.623998714+00:00] cnes_level2/barrouz/4122155:         StdErr = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_16_TCD-BLUE_AVG-1200.log
[2024-01-11 02:55:54.624724221+00:00] cnes_level2/barrouz/4122155:         StdOut = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_16_TCD-BLUE_AVG-1200.log

#########################################
#        EVIDEN - CNES                  #
#        Job Accounting                 #
#########################################
Cluster              : trex
JobIDRaw             : 4122155
JobID                : 4122155
JobName              : inf_ALP_16_TCD-BLUE_AVG-1200
Account              : cnes_level2
User                 : barrouz(9134), cesbio(426000053)
Partition            : cpu2022
QOS                  : cpu_2022_1280
Nodelist             : trex034 (1)
State                : COMPLETED  (Exitcode=0:0, DerivedExitCode=0:0, Restarts=0)
Submit date          : 2024-01-10T19:50:38
Start time           : 2024-01-10T19:50:58
End time             : 2024-01-11T02:55:54
Elapsed time         : 07:04:56  (Timelimit=1-16:00:00, Suspended=00:00:00)
TEI                  : 2 days, 8:39:28
Command              : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
StdOut               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_16_TCD-BLUE_AVG-1200.log
StdErr               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_16_TCD-BLUE_AVG-1200.log

STEP(s) : 2
--------- 
   StepID  | JobName      State       Exit   Start               End                 Elapsed   TotalCPU   CPUTime    ConsumedEnergy MaxDiskRead MaxDiskWrite     MaxRSS MaxRSSTask MaxRSSNode NNodes UserCPU    NodeList
   ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 
   batch   | batch        COMPLETED   0:0    2024-01-10T19:50:58 2024-01-11T02:55:54 07:04:56  1-07:41:44 2-08:39:28      0.204375M  240940.84M    98172.74M  96444816K          0    trex034      1 21:58:52   trex034
   extern  | extern       COMPLETED   0:0    2024-01-10T19:50:58 2024-01-11T02:55:54 07:04:56  00:00:00   2-08:39:28      0.204375M       0.00M        0.00M      1680K          0    trex034      1 00:00:00   trex034

