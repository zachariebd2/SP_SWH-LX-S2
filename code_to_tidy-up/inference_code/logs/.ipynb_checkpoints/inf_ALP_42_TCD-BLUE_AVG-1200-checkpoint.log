unload conda/22.11.1  : OK 
load conda/22.11.1  : OK 
envs_dirs : /work/scratch/env/barrouz/conda_env/
pkgs_dirs : /work/scratch/env/barrouz/pkgs_conda
INPUT_PATH /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/42.txt
OUTPUT_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
DEM_PATH /work/CAMPUS/etudes/Neige/DEM
TCD_PATH /work/datalake/static_aux/TreeCoverDensity
MODELS_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
KEEP_REFL 0
MASK 1
start
/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/42.txt
muscate/SPOTWORLDHERITAGE/2003/08/13/SPOT5-HRG1-XS_20030813-104317-270_L1C_051-254-0_D_V1-0/SPOT5-HRG1-XS_20030813-104317-270_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030813-104317-270_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030813-104317-270_L1C_051-254-0_D_V1-0.zip
run script
2024-01-15T07:01:08.034    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T07:01:08.034    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030813-104317-270_L1C_051-254-0_D_V1-0.zip
2024-01-15T07:01:08.034    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T07:01:08.034    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T07:01:08.035    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T07:01:08.035    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T07:01:08.035    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T07:01:08.035    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T07:01:08.035    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T07:01:08.035    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030813-104317-270_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2003/08/13/SPOT5-HRG1-XS_20030813-104429-005_L1C_051-262-7_D_V1-0/SPOT5-HRG1-XS_20030813-104429-005_L1C_051-262-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030813-104429-005_L1C_051-262-7_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030813-104429-005_L1C_051-262-7_D_V1-0.zip
run script
2024-01-15T07:01:12.275    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T07:01:12.276    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030813-104429-005_L1C_051-262-7_D_V1-0.zip
2024-01-15T07:01:12.276    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T07:01:12.276    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T07:01:12.276    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T07:01:12.276    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T07:01:12.276    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T07:01:12.276    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T07:01:12.276    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T07:01:12.277    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030813-104429-005_L1C_051-262-7_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/08/13/SPOT5-HRG1-XS_20030813-104431-050_L1C_051-263-0_D_V1-0/SPOT5-HRG1-XS_20030813-104431-050_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030813-104431-050_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030813-104431-050_L1C_051-263-0_D_V1-0.zip
run script
2024-01-15T07:02:38.256    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T07:02:38.257    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030813-104431-050_L1C_051-263-0_D_V1-0.zip
2024-01-15T07:02:38.257    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T07:02:38.257    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T07:02:38.257    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T07:02:38.257    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T07:02:38.257    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T07:02:38.258    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T07:02:38.258    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T07:02:38.258    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030813-104431-050_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/08/19/SPOT5-HRG2-XS_20030819-102750-698_L1C_051-254-0_D_V1-0/SPOT5-HRG2-XS_20030819-102750-698_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030819-102750-698_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030819-102750-698_L1C_051-254-0_D_V1-0.zip
run script
2024-01-15T07:03:41.375    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T07:03:41.376    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030819-102750-698_L1C_051-254-0_D_V1-0.zip
2024-01-15T07:03:41.376    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T07:03:41.376    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T07:03:41.376    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T07:03:41.376    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T07:03:41.377    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T07:03:41.377    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T07:03:41.377    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T07:03:41.377    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030819-102750-698_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2003/08/19/SPOT5-HRG2-XS_20030819-102816-124_L1C_052-257-2_D_V1-0/SPOT5-HRG2-XS_20030819-102816-124_L1C_052-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030819-102816-124_L1C_052-257-2_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030819-102816-124_L1C_052-257-2_D_V1-0.zip
run script
2024-01-15T07:03:46.734    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T07:03:46.735    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030819-102816-124_L1C_052-257-2_D_V1-0.zip
2024-01-15T07:03:46.735    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T07:03:46.735    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T07:03:46.736    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T07:03:46.736    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T07:03:46.736    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T07:03:46.736    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T07:03:46.736    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T07:03:46.736    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030819-102816-124_L1C_052-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/08/19/SPOT5-HRG2-XS_20030819-102836-297_L1C_052-259-6_D_V1-0/SPOT5-HRG2-XS_20030819-102836-297_L1C_052-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030819-102836-297_L1C_052-259-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030819-102836-297_L1C_052-259-6_D_V1-0.zip
run script
2024-01-15T07:07:00.889    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T07:07:00.890    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030819-102836-297_L1C_052-259-6_D_V1-0.zip
2024-01-15T07:07:00.890    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T07:07:00.890    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T07:07:00.891    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T07:07:00.891    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T07:07:00.891    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T07:07:00.891    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T07:07:00.891    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T07:07:00.891    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030819-102836-297_L1C_052-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/08/19/SPOT5-HRG2-XS_20030819-102839-160_L1C_052-260-0_D_V1-0/SPOT5-HRG2-XS_20030819-102839-160_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030819-102839-160_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030819-102839-160_L1C_052-260-0_D_V1-0.zip
run script
2024-01-15T07:10:48.057    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T07:10:48.058    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030819-102839-160_L1C_052-260-0_D_V1-0.zip
2024-01-15T07:10:48.059    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T07:10:48.059    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T07:10:48.059    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T07:10:48.059    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T07:10:48.059    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T07:10:48.059    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T07:10:48.059    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T07:10:48.059    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030819-102839-160_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/08/19/SPOT5-HRG2-XS_20030819-102840-965_L1C_052-260-2_D_V1-0/SPOT5-HRG2-XS_20030819-102840-965_L1C_052-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030819-102840-965_L1C_052-260-2_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030819-102840-965_L1C_052-260-2_D_V1-0.zip
run script
2024-01-15T07:14:11.287    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T07:14:11.288    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030819-102840-965_L1C_052-260-2_D_V1-0.zip
2024-01-15T07:14:11.288    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T07:14:11.288    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T07:14:11.288    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T07:14:11.288    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T07:14:11.288    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T07:14:11.288    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T07:14:11.288    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T07:14:11.288    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-15T07:14:14.066    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 1210). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030819-102840-965_L1C_052-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2003/01/18/SPOT5-HRG2-XS_20030118-102449-622_L1C_051-256-6_D_V1-0/SPOT5-HRG2-XS_20030118-102449-622_L1C_051-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030118-102449-622_L1C_051-256-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030118-102449-622_L1C_051-256-6_D_V1-0.zip
run script
2024-01-15T07:14:19.055    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T07:14:19.057    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030118-102449-622_L1C_051-256-6_D_V1-0.zip
2024-01-15T07:14:19.057    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T07:14:19.057    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T07:14:19.057    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T07:14:19.057    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T07:14:19.057    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T07:14:19.057    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T07:14:19.057    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T07:14:19.057    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030118-102449-622_L1C_051-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/01/18/SPOT5-HRG2-XS_20030118-102452-438_L1C_051-257-0_D_V1-0/SPOT5-HRG2-XS_20030118-102452-438_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030118-102452-438_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030118-102452-438_L1C_051-257-0_D_V1-0.zip
run script
2024-01-15T07:18:44.875    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T07:18:44.876    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030118-102452-438_L1C_051-257-0_D_V1-0.zip
2024-01-15T07:18:44.876    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T07:18:44.876    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T07:18:44.876    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T07:18:44.876    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T07:18:44.876    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T07:18:44.877    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T07:18:44.877    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T07:18:44.877    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030118-102452-438_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/01/18/SPOT5-HRG2-XS_20030118-102500-692_L1C_051-258-0_D_V1-0/SPOT5-HRG2-XS_20030118-102500-692_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030118-102500-692_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030118-102500-692_L1C_051-258-0_D_V1-0.zip
run script
2024-01-15T07:23:08.204    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T07:23:08.205    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030118-102500-692_L1C_051-258-0_D_V1-0.zip
2024-01-15T07:23:08.205    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T07:23:08.205    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T07:23:08.206    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T07:23:08.206    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T07:23:08.206    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T07:23:08.206    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T07:23:08.206    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T07:23:08.206    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030118-102500-692_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/01/18/SPOT5-HRG2-XS_20030118-102508-945_L1C_051-259-0_D_V1-0/SPOT5-HRG2-XS_20030118-102508-945_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030118-102508-945_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030118-102508-945_L1C_051-259-0_D_V1-0.zip
run script
2024-01-15T07:27:04.260    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T07:27:04.261    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030118-102508-945_L1C_051-259-0_D_V1-0.zip
2024-01-15T07:27:04.261    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T07:27:04.261    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T07:27:04.262    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T07:27:04.262    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T07:27:04.262    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T07:27:04.262    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T07:27:04.262    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T07:27:04.262    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030118-102508-945_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/01/18/SPOT5-HRG2-XS_20030118-102518-114_L1C_051-260-1_D_V1-0/SPOT5-HRG2-XS_20030118-102518-114_L1C_051-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030118-102518-114_L1C_051-260-1_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030118-102518-114_L1C_051-260-1_D_V1-0.zip
run script
2024-01-15T07:31:05.606    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T07:31:05.608    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030118-102518-114_L1C_051-260-1_D_V1-0.zip
2024-01-15T07:31:05.608    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T07:31:05.608    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T07:31:05.608    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T07:31:05.608    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T07:31:05.608    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T07:31:05.608    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T07:31:05.608    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T07:31:05.608    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030118-102518-114_L1C_051-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/02/11/SPOT5-HRG1-XS_20030211-110326-731_L1C_051-256-6_D_V1-0/SPOT5-HRG1-XS_20030211-110326-731_L1C_051-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030211-110326-731_L1C_051-256-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030211-110326-731_L1C_051-256-6_D_V1-0.zip
run script
2024-01-15T07:34:13.395    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T07:34:13.396    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030211-110326-731_L1C_051-256-6_D_V1-0.zip
2024-01-15T07:34:13.397    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T07:34:13.397    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T07:34:13.397    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T07:34:13.397    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T07:34:13.397    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T07:34:13.397    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T07:34:13.397    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T07:34:13.397    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030211-110326-731_L1C_051-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/02/11/SPOT5-HRG1-XS_20030211-110329-763_L1C_051-257-0_D_V1-0/SPOT5-HRG1-XS_20030211-110329-763_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030211-110329-763_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030211-110329-763_L1C_051-257-0_D_V1-0.zip
run script
2024-01-15T07:39:35.080    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T07:39:35.080    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030211-110329-763_L1C_051-257-0_D_V1-0.zip
2024-01-15T07:39:35.080    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T07:39:35.080    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T07:39:35.080    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T07:39:35.080    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T07:39:35.080    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T07:39:35.080    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T07:39:35.080    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T07:39:35.080    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030211-110329-763_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 0 0 ... 2 2 2]
 [1 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/02/11/SPOT5-HRG1-XS_20030211-110338-210_L1C_051-258-0_D_V1-0/SPOT5-HRG1-XS_20030211-110338-210_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030211-110338-210_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030211-110338-210_L1C_051-258-0_D_V1-0.zip
run script
2024-01-15T07:44:56.607    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T07:44:56.609    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030211-110338-210_L1C_051-258-0_D_V1-0.zip
2024-01-15T07:44:56.609    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T07:44:56.609    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T07:44:56.609    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T07:44:56.609    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T07:44:56.609    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T07:44:56.609    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T07:44:56.609    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T07:44:56.609    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-15T07:49:59.275    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 178). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030211-110338-210_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2003/02/11/SPOT5-HRG1-XS_20030211-110346-680_L1C_051-259-0_D_V1-0/SPOT5-HRG1-XS_20030211-110346-680_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030211-110346-680_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030211-110346-680_L1C_051-259-0_D_V1-0.zip
run script
2024-01-15T07:50:05.281    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T07:50:05.282    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030211-110346-680_L1C_051-259-0_D_V1-0.zip
2024-01-15T07:50:05.282    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T07:50:05.282    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T07:50:05.282    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T07:50:05.283    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T07:50:05.283    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T07:50:05.283    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T07:50:05.283    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T07:50:05.283    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030211-110346-680_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/03/25/SPOT5-HRG2-XS_20030325-105538-893_L1C_051-256-6_D_V1-0/SPOT5-HRG2-XS_20030325-105538-893_L1C_051-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030325-105538-893_L1C_051-256-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030325-105538-893_L1C_051-256-6_D_V1-0.zip
run script
2024-01-15T07:55:11.477    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T07:55:11.479    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030325-105538-893_L1C_051-256-6_D_V1-0.zip
2024-01-15T07:55:11.479    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T07:55:11.479    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T07:55:11.479    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T07:55:11.479    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T07:55:11.479    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T07:55:11.479    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T07:55:11.479    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T07:55:11.479    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030325-105538-893_L1C_051-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/03/25/SPOT5-HRG2-XS_20030325-105541-853_L1C_051-257-0_D_V1-0/SPOT5-HRG2-XS_20030325-105541-853_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030325-105541-853_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030325-105541-853_L1C_051-257-0_D_V1-0.zip
run script
2024-01-15T07:59:56.637    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T07:59:56.638    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030325-105541-853_L1C_051-257-0_D_V1-0.zip
2024-01-15T07:59:56.638    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T07:59:56.638    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T07:59:56.638    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T07:59:56.638    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T07:59:56.638    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T07:59:56.638    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T07:59:56.638    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T07:59:56.638    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030325-105541-853_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/03/25/SPOT5-HRG2-XS_20030325-105550-227_L1C_051-258-0_D_V1-0/SPOT5-HRG2-XS_20030325-105550-227_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030325-105550-227_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030325-105550-227_L1C_051-258-0_D_V1-0.zip
run script
2024-01-15T08:04:36.586    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T08:04:36.587    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030325-105550-227_L1C_051-258-0_D_V1-0.zip
2024-01-15T08:04:36.587    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T08:04:36.587    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T08:04:36.587    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T08:04:36.588    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T08:04:36.588    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T08:04:36.588    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T08:04:36.588    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T08:04:36.588    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-15T08:08:52.438    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (0 x 2572). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030325-105550-227_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2003/04/04/SPOT5-HRG2-XS_20030404-110323-218_L1C_051-256-6_D_V1-0/SPOT5-HRG2-XS_20030404-110323-218_L1C_051-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030404-110323-218_L1C_051-256-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030404-110323-218_L1C_051-256-6_D_V1-0.zip
run script
2024-01-15T08:08:58.532    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T08:08:58.533    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030404-110323-218_L1C_051-256-6_D_V1-0.zip
2024-01-15T08:08:58.533    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T08:08:58.533    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T08:08:58.533    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T08:08:58.533    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T08:08:58.533    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T08:08:58.533    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T08:08:58.533    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T08:08:58.533    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030404-110323-218_L1C_051-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/04/04/SPOT5-HRG2-XS_20030404-110326-226_L1C_051-257-0_D_V1-0/SPOT5-HRG2-XS_20030404-110326-226_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030404-110326-226_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030404-110326-226_L1C_051-257-0_D_V1-0.zip
run script
2024-01-15T08:14:25.642    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T08:14:25.643    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030404-110326-226_L1C_051-257-0_D_V1-0.zip
2024-01-15T08:14:25.643    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T08:14:25.643    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T08:14:25.643    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T08:14:25.643    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T08:14:25.643    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T08:14:25.643    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T08:14:25.643    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T08:14:25.643    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030404-110326-226_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/04/04/SPOT5-HRG2-XS_20030404-110334-672_L1C_051-258-0_D_V1-0/SPOT5-HRG2-XS_20030404-110334-672_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030404-110334-672_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030404-110334-672_L1C_051-258-0_D_V1-0.zip
run script
2024-01-15T08:19:51.553    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T08:19:51.554    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030404-110334-672_L1C_051-258-0_D_V1-0.zip
2024-01-15T08:19:51.554    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T08:19:51.554    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T08:19:51.554    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T08:19:51.554    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T08:19:51.554    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T08:19:51.554    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T08:19:51.554    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T08:19:51.554    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-15T08:24:56.916    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 177). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030404-110334-672_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2003/04/04/SPOT5-HRG2-XS_20030404-110343-143_L1C_051-259-0_D_V1-0/SPOT5-HRG2-XS_20030404-110343-143_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030404-110343-143_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030404-110343-143_L1C_051-259-0_D_V1-0.zip
run script
2024-01-15T08:25:02.409    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T08:25:02.410    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030404-110343-143_L1C_051-259-0_D_V1-0.zip
2024-01-15T08:25:02.410    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T08:25:02.410    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T08:25:02.410    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T08:25:02.410    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T08:25:02.410    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T08:25:02.410    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T08:25:02.410    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T08:25:02.410    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030404-110343-143_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/02/17/SPOT5-HRG2-XS_20030217-104806-641_L1C_051-257-0_D_V1-0/SPOT5-HRG2-XS_20030217-104806-641_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030217-104806-641_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030217-104806-641_L1C_051-257-0_D_V1-0.zip
run script
2024-01-15T08:30:16.108    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T08:30:16.110    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030217-104806-641_L1C_051-257-0_D_V1-0.zip
2024-01-15T08:30:16.110    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T08:30:16.110    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T08:30:16.110    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T08:30:16.110    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T08:30:16.110    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T08:30:16.110    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T08:30:16.110    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T08:30:16.110    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030217-104806-641_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/02/17/SPOT5-HRG2-XS_20030217-104814-967_L1C_051-258-0_D_V1-0/SPOT5-HRG2-XS_20030217-104814-967_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030217-104814-967_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030217-104814-967_L1C_051-258-0_D_V1-0.zip
run script
2024-01-15T08:34:34.942    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T08:34:34.943    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030217-104814-967_L1C_051-258-0_D_V1-0.zip
2024-01-15T08:34:34.943    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T08:34:34.943    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T08:34:34.943    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T08:34:34.943    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T08:34:34.943    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T08:34:34.943    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T08:34:34.944    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T08:34:34.944    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030217-104814-967_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/02/17/SPOT5-HRG2-XS_20030217-104823-317_L1C_051-259-0_D_V1-0/SPOT5-HRG2-XS_20030217-104823-317_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030217-104823-317_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030217-104823-317_L1C_051-259-0_D_V1-0.zip
run script
2024-01-15T08:38:23.386    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T08:38:23.387    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030217-104823-317_L1C_051-259-0_D_V1-0.zip
2024-01-15T08:38:23.388    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T08:38:23.388    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T08:38:23.388    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T08:38:23.388    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T08:38:23.388    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T08:38:23.388    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T08:38:23.388    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T08:38:23.388    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030217-104823-317_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/02/17/SPOT5-HRG2-XS_20030217-104831-691_L1C_051-260-0_D_V1-0/SPOT5-HRG2-XS_20030217-104831-691_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030217-104831-691_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030217-104831-691_L1C_051-260-0_D_V1-0.zip
run script
2024-01-15T08:42:13.436    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T08:42:13.437    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030217-104831-691_L1C_051-260-0_D_V1-0.zip
2024-01-15T08:42:13.437    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T08:42:13.437    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T08:42:13.437    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T08:42:13.437    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T08:42:13.437    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T08:42:13.437    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T08:42:13.437    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T08:42:13.437    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030217-104831-691_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/02/23/SPOT5-HRG2-XS_20030223-103246-299_L1C_051-257-6_D_V1-0/SPOT5-HRG2-XS_20030223-103246-299_L1C_051-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030223-103246-299_L1C_051-257-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030223-103246-299_L1C_051-257-6_D_V1-0.zip
run script
2024-01-15T08:45:07.924    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T08:45:07.925    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030223-103246-299_L1C_051-257-6_D_V1-0.zip
2024-01-15T08:45:07.925    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T08:45:07.925    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T08:45:07.925    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T08:45:07.925    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T08:45:07.925    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T08:45:07.926    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T08:45:07.926    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T08:45:07.926    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030223-103246-299_L1C_051-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [0 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/02/23/SPOT5-HRG2-XS_20030223-103249-139_L1C_051-258-0_D_V1-0/SPOT5-HRG2-XS_20030223-103249-139_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030223-103249-139_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030223-103249-139_L1C_051-258-0_D_V1-0.zip
run script
2024-01-15T08:49:55.827    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T08:49:55.828    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030223-103249-139_L1C_051-258-0_D_V1-0.zip
2024-01-15T08:49:55.828    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T08:49:55.828    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T08:49:55.828    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T08:49:55.828    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T08:49:55.829    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T08:49:55.829    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T08:49:55.829    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T08:49:55.829    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030223-103249-139_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/02/23/SPOT5-HRG2-XS_20030223-103257-417_L1C_051-259-0_D_V1-0/SPOT5-HRG2-XS_20030223-103257-417_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030223-103257-417_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030223-103257-417_L1C_051-259-0_D_V1-0.zip
run script
2024-01-15T08:53:46.908    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T08:53:46.910    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030223-103257-417_L1C_051-259-0_D_V1-0.zip
2024-01-15T08:53:46.910    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T08:53:46.910    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T08:53:46.910    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T08:53:46.910    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T08:53:46.910    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T08:53:46.910    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T08:53:46.910    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T08:53:46.911    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030223-103257-417_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/02/23/SPOT5-HRG2-XS_20030223-103305-719_L1C_051-260-0_D_V1-0/SPOT5-HRG2-XS_20030223-103305-719_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030223-103305-719_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030223-103305-719_L1C_051-260-0_D_V1-0.zip
run script
2024-01-15T08:57:42.588    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T08:57:42.589    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030223-103305-719_L1C_051-260-0_D_V1-0.zip
2024-01-15T08:57:42.589    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T08:57:42.589    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T08:57:42.589    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T08:57:42.589    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T08:57:42.589    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T08:57:42.589    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T08:57:42.590    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T08:57:42.590    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030223-103305-719_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/02/23/SPOT5-HRG1-XS_20030223-103308-376_L1C_055-261-0_D_V1-0/SPOT5-HRG1-XS_20030223-103308-376_L1C_055-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030223-103308-376_L1C_055-261-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030223-103308-376_L1C_055-261-0_D_V1-0.zip
run script
2024-01-15T09:00:41.012    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T09:00:41.013    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030223-103308-376_L1C_055-261-0_D_V1-0.zip
2024-01-15T09:00:41.013    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T09:00:41.013    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T09:00:41.013    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T09:00:41.013    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T09:00:41.013    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T09:00:41.013    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T09:00:41.013    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T09:00:41.014    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030223-103308-376_L1C_055-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/02/23/SPOT5-HRG1-XS_20030223-103313-791_L1C_055-261-6_D_V1-0/SPOT5-HRG1-XS_20030223-103313-791_L1C_055-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030223-103313-791_L1C_055-261-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030223-103313-791_L1C_055-261-6_D_V1-0.zip
run script
2024-01-15T09:01:46.655    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T09:01:46.656    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030223-103313-791_L1C_055-261-6_D_V1-0.zip
2024-01-15T09:01:46.656    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T09:01:46.656    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T09:01:46.656    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T09:01:46.656    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T09:01:46.656    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T09:01:46.656    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T09:01:46.656    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T09:01:46.656    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-15T09:03:00.194    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 240). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030223-103313-791_L1C_055-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2003/04/16/SPOT5-HRG1-XS_20030416-103244-974_L1C_051-257-6_D_V1-0/SPOT5-HRG1-XS_20030416-103244-974_L1C_051-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030416-103244-974_L1C_051-257-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030416-103244-974_L1C_051-257-6_D_V1-0.zip
run script
2024-01-15T09:03:06.781    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T09:03:06.782    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030416-103244-974_L1C_051-257-6_D_V1-0.zip
2024-01-15T09:03:06.782    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T09:03:06.782    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T09:03:06.782    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T09:03:06.783    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T09:03:06.783    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T09:03:06.783    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T09:03:06.783    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T09:03:06.783    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030416-103244-974_L1C_051-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/04/16/SPOT5-HRG1-XS_20030416-103247-813_L1C_051-258-0_D_V1-0/SPOT5-HRG1-XS_20030416-103247-813_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030416-103247-813_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030416-103247-813_L1C_051-258-0_D_V1-0.zip
run script
2024-01-15T09:07:25.739    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T09:07:25.743    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030416-103247-813_L1C_051-258-0_D_V1-0.zip
2024-01-15T09:07:25.744    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T09:07:25.744    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T09:07:25.744    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T09:07:25.744    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T09:07:25.744    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T09:07:25.744    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T09:07:25.744    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T09:07:25.744    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030416-103247-813_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 1 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 [0 0 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/04/16/SPOT5-HRG1-XS_20030416-103256-091_L1C_051-259-0_D_V1-0/SPOT5-HRG1-XS_20030416-103256-091_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030416-103256-091_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030416-103256-091_L1C_051-259-0_D_V1-0.zip
run script
2024-01-15T09:11:19.388    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T09:11:19.390    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030416-103256-091_L1C_051-259-0_D_V1-0.zip
2024-01-15T09:11:19.390    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T09:11:19.390    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T09:11:19.390    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T09:11:19.390    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T09:11:19.390    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T09:11:19.390    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T09:11:19.390    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T09:11:19.390    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030416-103256-091_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/04/16/SPOT5-HRG2-XS_20030416-103307-254_L1C_055-261-0_D_V1-0/SPOT5-HRG2-XS_20030416-103307-254_L1C_055-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030416-103307-254_L1C_055-261-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030416-103307-254_L1C_055-261-0_D_V1-0.zip
run script
2024-01-15T09:15:20.312    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T09:15:20.314    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030416-103307-254_L1C_055-261-0_D_V1-0.zip
2024-01-15T09:15:20.314    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T09:15:20.314    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T09:15:20.314    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T09:15:20.314    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T09:15:20.314    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T09:15:20.314    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T09:15:20.314    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T09:15:20.314    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030416-103307-254_L1C_055-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/04/16/SPOT5-HRG2-XS_20030416-103314-473_L1C_055-261-8_D_V1-0/SPOT5-HRG2-XS_20030416-103314-473_L1C_055-261-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030416-103314-473_L1C_055-261-8_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030416-103314-473_L1C_055-261-8_D_V1-0.zip
run script
2024-01-15T09:16:31.587    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T09:16:31.588    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030416-103314-473_L1C_055-261-8_D_V1-0.zip
2024-01-15T09:16:31.589    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T09:16:31.589    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T09:16:31.589    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T09:16:31.589    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T09:16:31.589    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T09:16:31.589    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T09:16:31.589    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T09:16:31.589    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030416-103314-473_L1C_055-261-8_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/04/27/SPOT5-HRG2-XS_20030427-102108-920_L1C_051-257-6_D_V1-0/SPOT5-HRG2-XS_20030427-102108-920_L1C_051-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030427-102108-920_L1C_051-257-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030427-102108-920_L1C_051-257-6_D_V1-0.zip
run script
2024-01-15T09:18:01.616    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T09:18:01.617    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030427-102108-920_L1C_051-257-6_D_V1-0.zip
2024-01-15T09:18:01.618    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T09:18:01.618    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T09:18:01.618    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T09:18:01.618    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T09:18:01.618    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T09:18:01.618    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T09:18:01.618    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T09:18:01.618    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030427-102108-920_L1C_051-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 2 2 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/04/27/SPOT5-HRG2-XS_20030427-102111-760_L1C_051-258-0_D_V1-0/SPOT5-HRG2-XS_20030427-102111-760_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030427-102111-760_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030427-102111-760_L1C_051-258-0_D_V1-0.zip
run script
2024-01-15T09:22:45.722    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T09:22:45.723    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030427-102111-760_L1C_051-258-0_D_V1-0.zip
2024-01-15T09:22:45.723    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T09:22:45.723    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T09:22:45.723    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T09:22:45.723    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T09:22:45.724    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T09:22:45.724    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T09:22:45.724    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T09:22:45.724    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030427-102111-760_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/04/27/SPOT5-HRG2-XS_20030427-102120-014_L1C_051-259-0_D_V1-0/SPOT5-HRG2-XS_20030427-102120-014_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030427-102120-014_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030427-102120-014_L1C_051-259-0_D_V1-0.zip
run script
2024-01-15T09:27:04.990    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T09:27:04.990    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030427-102120-014_L1C_051-259-0_D_V1-0.zip
2024-01-15T09:27:04.990    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T09:27:04.990    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T09:27:04.990    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T09:27:04.991    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T09:27:04.991    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T09:27:04.991    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T09:27:04.991    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T09:27:04.991    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030427-102120-014_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/04/27/SPOT5-HRG2-XS_20030427-102129-158_L1C_051-260-1_D_V1-0/SPOT5-HRG2-XS_20030427-102129-158_L1C_051-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030427-102129-158_L1C_051-260-1_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030427-102129-158_L1C_051-260-1_D_V1-0.zip
run script
2024-01-15T09:31:40.034    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T09:31:40.036    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030427-102129-158_L1C_051-260-1_D_V1-0.zip
2024-01-15T09:31:40.036    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T09:31:40.036    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T09:31:40.036    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T09:31:40.036    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T09:31:40.036    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T09:31:40.036    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T09:31:40.036    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T09:31:40.036    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030427-102129-158_L1C_051-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/03/05/SPOT5-HRG1-XS_20030305-104033-114_L1C_051-258-5_D_V1-0/SPOT5-HRG1-XS_20030305-104033-114_L1C_051-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030305-104033-114_L1C_051-258-5_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030305-104033-114_L1C_051-258-5_D_V1-0.zip
run script
2024-01-15T09:35:15.976    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T09:35:15.977    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030305-104033-114_L1C_051-258-5_D_V1-0.zip
2024-01-15T09:35:15.977    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T09:35:15.977    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T09:35:15.977    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T09:35:15.977    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T09:35:15.977    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T09:35:15.977    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T09:35:15.977    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T09:35:15.977    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030305-104033-114_L1C_051-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/03/05/SPOT5-HRG1-XS_20030305-104036-892_L1C_051-259-0_D_V1-0/SPOT5-HRG1-XS_20030305-104036-892_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030305-104036-892_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030305-104036-892_L1C_051-259-0_D_V1-0.zip
run script
2024-01-15T09:39:15.080    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T09:39:15.082    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030305-104036-892_L1C_051-259-0_D_V1-0.zip
2024-01-15T09:39:15.082    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T09:39:15.082    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T09:39:15.082    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T09:39:15.082    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T09:39:15.082    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T09:39:15.082    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T09:39:15.082    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T09:39:15.082    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030305-104036-892_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/03/05/SPOT5-HRG1-XS_20030305-104045-218_L1C_051-260-0_D_V1-0/SPOT5-HRG1-XS_20030305-104045-218_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030305-104045-218_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030305-104045-218_L1C_051-260-0_D_V1-0.zip
run script
2024-01-15T09:43:02.736    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T09:43:02.738    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030305-104045-218_L1C_051-260-0_D_V1-0.zip
2024-01-15T09:43:02.738    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T09:43:02.738    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T09:43:02.738    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T09:43:02.738    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T09:43:02.738    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T09:43:02.738    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T09:43:02.738    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T09:43:02.738    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030305-104045-218_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/03/05/SPOT5-HRG1-XS_20030305-104051-523_L1C_051-260-7_D_V1-0/SPOT5-HRG1-XS_20030305-104051-523_L1C_051-260-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030305-104051-523_L1C_051-260-7_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030305-104051-523_L1C_051-260-7_D_V1-0.zip
run script
2024-01-15T09:45:53.891    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T09:45:53.892    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030305-104051-523_L1C_051-260-7_D_V1-0.zip
2024-01-15T09:45:53.892    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T09:45:53.892    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T09:45:53.892    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T09:45:53.893    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T09:45:53.893    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T09:45:53.893    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T09:45:53.893    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T09:45:53.893    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030305-104051-523_L1C_051-260-7_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/03/20/SPOT5-HRG2-XS_20030320-105202-383_L1C_051-258-6_D_V1-0/SPOT5-HRG2-XS_20030320-105202-383_L1C_051-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030320-105202-383_L1C_051-258-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030320-105202-383_L1C_051-258-6_D_V1-0.zip
run script
2024-01-15T09:48:44.813    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T09:48:44.814    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030320-105202-383_L1C_051-258-6_D_V1-0.zip
2024-01-15T09:48:44.814    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T09:48:44.815    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T09:48:44.815    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T09:48:44.815    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T09:48:44.815    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T09:48:44.815    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T09:48:44.815    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T09:48:44.815    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030320-105202-383_L1C_051-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/03/20/SPOT5-HRG2-XS_20030320-105205-342_L1C_051-259-0_D_V1-0/SPOT5-HRG2-XS_20030320-105205-342_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030320-105205-342_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030320-105205-342_L1C_051-259-0_D_V1-0.zip
run script
2024-01-15T09:53:11.447    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T09:53:11.449    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030320-105205-342_L1C_051-259-0_D_V1-0.zip
2024-01-15T09:53:11.449    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T09:53:11.449    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T09:53:11.449    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T09:53:11.449    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T09:53:11.449    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T09:53:11.449    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T09:53:11.449    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T09:53:11.449    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030320-105205-342_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/03/20/SPOT5-HRG2-XS_20030320-105213-717_L1C_051-260-0_D_V1-0/SPOT5-HRG2-XS_20030320-105213-717_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030320-105213-717_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030320-105213-717_L1C_051-260-0_D_V1-0.zip
run script
2024-01-15T09:57:25.717    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T09:57:25.718    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030320-105213-717_L1C_051-260-0_D_V1-0.zip
2024-01-15T09:57:25.718    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T09:57:25.718    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T09:57:25.718    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T09:57:25.718    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T09:57:25.718    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T09:57:25.718    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T09:57:25.718    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T09:57:25.719    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030320-105213-717_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/07/19/SPOT5-HRG1-XS_20030719-102438-369_L1C_051-258-6_D_V1-0/SPOT5-HRG1-XS_20030719-102438-369_L1C_051-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030719-102438-369_L1C_051-258-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030719-102438-369_L1C_051-258-6_D_V1-0.zip
run script
2024-01-15T10:00:37.341    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T10:00:37.343    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030719-102438-369_L1C_051-258-6_D_V1-0.zip
2024-01-15T10:00:37.343    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T10:00:37.343    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T10:00:37.343    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T10:00:37.343    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T10:00:37.343    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T10:00:37.343    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T10:00:37.343    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T10:00:37.343    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030719-102438-369_L1C_051-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/07/19/SPOT5-HRG1-XS_20030719-102441-208_L1C_051-259-0_D_V1-0/SPOT5-HRG1-XS_20030719-102441-208_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030719-102441-208_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030719-102441-208_L1C_051-259-0_D_V1-0.zip
run script
2024-01-15T10:04:59.709    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T10:04:59.710    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030719-102441-208_L1C_051-259-0_D_V1-0.zip
2024-01-15T10:04:59.710    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T10:04:59.710    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T10:04:59.710    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T10:04:59.710    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T10:04:59.710    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T10:04:59.710    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T10:04:59.711    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T10:04:59.711    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030719-102441-208_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/07/19/SPOT5-HRG1-XS_20030719-102450-377_L1C_051-260-1_D_V1-0/SPOT5-HRG1-XS_20030719-102450-377_L1C_051-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030719-102450-377_L1C_051-260-1_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030719-102450-377_L1C_051-260-1_D_V1-0.zip
run script
2024-01-15T10:09:15.515    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T10:09:15.516    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030719-102450-377_L1C_051-260-1_D_V1-0.zip
2024-01-15T10:09:15.516    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T10:09:15.516    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T10:09:15.517    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T10:09:15.517    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T10:09:15.517    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T10:09:15.517    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T10:09:15.517    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T10:09:15.517    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030719-102450-377_L1C_051-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/07/19/SPOT5-HRG1-XS_20030719-102501-369_L1C_051-261-4_D_V1-0/SPOT5-HRG1-XS_20030719-102501-369_L1C_051-261-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030719-102501-369_L1C_051-261-4_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030719-102501-369_L1C_051-261-4_D_V1-0.zip
run script
2024-01-15T10:12:32.111    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T10:12:32.113    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030719-102501-369_L1C_051-261-4_D_V1-0.zip
2024-01-15T10:12:32.113    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T10:12:32.113    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T10:12:32.113    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T10:12:32.113    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T10:12:32.113    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T10:12:32.113    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T10:12:32.113    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T10:12:32.113    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030719-102501-369_L1C_051-261-4_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/07/19/SPOT5-HRG1-XS_20030719-102506-037_L1C_051-262-0_D_V1-0/SPOT5-HRG1-XS_20030719-102506-037_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030719-102506-037_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030719-102506-037_L1C_051-262-0_D_V1-0.zip
run script
2024-01-15T10:15:41.706    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T10:15:41.707    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030719-102506-037_L1C_051-262-0_D_V1-0.zip
2024-01-15T10:15:41.707    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T10:15:41.708    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T10:15:41.708    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T10:15:41.708    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T10:15:41.708    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T10:15:41.708    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T10:15:41.708    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T10:15:41.708    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030719-102506-037_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/07/19/SPOT5-HRG1-XS_20030719-102514-315_L1C_051-263-0_D_V1-0/SPOT5-HRG1-XS_20030719-102514-315_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030719-102514-315_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030719-102514-315_L1C_051-263-0_D_V1-0.zip
run script
2024-01-15T10:18:18.477    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T10:18:18.478    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030719-102514-315_L1C_051-263-0_D_V1-0.zip
2024-01-15T10:18:18.478    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T10:18:18.479    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T10:18:18.479    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T10:18:18.479    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T10:18:18.479    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T10:18:18.479    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T10:18:18.479    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T10:18:18.479    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030719-102514-315_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/07/19/SPOT5-HRG2-XS_20030719-102500-118_L1C_053-261-5_D_V1-0/SPOT5-HRG2-XS_20030719-102500-118_L1C_053-261-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030719-102500-118_L1C_053-261-5_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030719-102500-118_L1C_053-261-5_D_V1-0.zip
run script
2024-01-15T10:19:19.530    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T10:19:19.531    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030719-102500-118_L1C_053-261-5_D_V1-0.zip
2024-01-15T10:19:19.531    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T10:19:19.532    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T10:19:19.532    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T10:19:19.532    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T10:19:19.532    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T10:19:19.532    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T10:19:19.532    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T10:19:19.532    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030719-102500-118_L1C_053-261-5_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/07/19/SPOT5-HRG2-XS_20030719-102503-896_L1C_053-262-0_D_V1-0/SPOT5-HRG2-XS_20030719-102503-896_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030719-102503-896_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030719-102503-896_L1C_053-262-0_D_V1-0.zip
run script
2024-01-15T10:23:00.353    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T10:23:00.354    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030719-102503-896_L1C_053-262-0_D_V1-0.zip
2024-01-15T10:23:00.354    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T10:23:00.354    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T10:23:00.355    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T10:23:00.355    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T10:23:00.355    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T10:23:00.355    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T10:23:00.355    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T10:23:00.355    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030719-102503-896_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/07/19/SPOT5-HRG2-XS_20030719-102512-198_L1C_053-263-0_D_V1-0/SPOT5-HRG2-XS_20030719-102512-198_L1C_053-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030719-102512-198_L1C_053-263-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030719-102512-198_L1C_053-263-0_D_V1-0.zip
run script
2024-01-15T10:26:18.790    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T10:26:18.792    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030719-102512-198_L1C_053-263-0_D_V1-0.zip
2024-01-15T10:26:18.792    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T10:26:18.792    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T10:26:18.792    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T10:26:18.792    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T10:26:18.792    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T10:26:18.792    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T10:26:18.792    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T10:26:18.792    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030719-102512-198_L1C_053-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/08/23/SPOT5-HRG1-XS_20030823-105135-539_L1C_051-258-6_D_V1-0/SPOT5-HRG1-XS_20030823-105135-539_L1C_051-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030823-105135-539_L1C_051-258-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030823-105135-539_L1C_051-258-6_D_V1-0.zip
run script
2024-01-15T10:27:49.916    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T10:27:49.918    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030823-105135-539_L1C_051-258-6_D_V1-0.zip
2024-01-15T10:27:49.918    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T10:27:49.918    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T10:27:49.918    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T10:27:49.918    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T10:27:49.918    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T10:27:49.918    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T10:27:49.918    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T10:27:49.919    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030823-105135-539_L1C_051-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/08/23/SPOT5-HRG1-XS_20030823-105138-475_L1C_051-259-0_D_V1-0/SPOT5-HRG1-XS_20030823-105138-475_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030823-105138-475_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030823-105138-475_L1C_051-259-0_D_V1-0.zip
run script
2024-01-15T10:32:11.891    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T10:32:11.892    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030823-105138-475_L1C_051-259-0_D_V1-0.zip
2024-01-15T10:32:11.892    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T10:32:11.892    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T10:32:11.892    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T10:32:11.893    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T10:32:11.893    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T10:32:11.893    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T10:32:11.893    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T10:32:11.893    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030823-105138-475_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/08/23/SPOT5-HRG2-XS_20030823-105148-666_L1C_055-261-0_D_V1-0/SPOT5-HRG2-XS_20030823-105148-666_L1C_055-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030823-105148-666_L1C_055-261-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030823-105148-666_L1C_055-261-0_D_V1-0.zip
run script
2024-01-15T10:36:25.151    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T10:36:25.152    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030823-105148-666_L1C_055-261-0_D_V1-0.zip
2024-01-15T10:36:25.152    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T10:36:25.153    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T10:36:25.153    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T10:36:25.153    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T10:36:25.153    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T10:36:25.153    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T10:36:25.153    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T10:36:25.153    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030823-105148-666_L1C_055-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/12/01/SPOT5-HRG2-XS_20031201-102727-127_L1C_051-258-6_D_V1-0/SPOT5-HRG2-XS_20031201-102727-127_L1C_051-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20031201-102727-127_L1C_051-258-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20031201-102727-127_L1C_051-258-6_D_V1-0.zip
run script
2024-01-15T10:38:17.172    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T10:38:17.173    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20031201-102727-127_L1C_051-258-6_D_V1-0.zip
2024-01-15T10:38:17.173    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T10:38:17.173    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T10:38:17.173    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T10:38:17.173    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T10:38:17.173    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T10:38:17.173    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T10:38:17.173    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T10:38:17.174    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20031201-102727-127_L1C_051-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/12/01/SPOT5-HRG2-XS_20031201-102729-967_L1C_051-259-0_D_V1-0/SPOT5-HRG2-XS_20031201-102729-967_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20031201-102729-967_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20031201-102729-967_L1C_051-259-0_D_V1-0.zip
run script
2024-01-15T10:42:27.196    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T10:42:27.198    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20031201-102729-967_L1C_051-259-0_D_V1-0.zip
2024-01-15T10:42:27.198    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T10:42:27.198    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T10:42:27.198    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T10:42:27.198    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T10:42:27.198    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T10:42:27.198    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T10:42:27.198    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T10:42:27.198    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20031201-102729-967_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/05/23/SPOT5-HRG2-XS_20030523-102112-792_L1C_051-259-6_D_V1-0/SPOT5-HRG2-XS_20030523-102112-792_L1C_051-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030523-102112-792_L1C_051-259-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030523-102112-792_L1C_051-259-6_D_V1-0.zip
run script
2024-01-15T10:46:29.673    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T10:46:29.674    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030523-102112-792_L1C_051-259-6_D_V1-0.zip
2024-01-15T10:46:29.674    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T10:46:29.674    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T10:46:29.674    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T10:46:29.674    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T10:46:29.675    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T10:46:29.675    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T10:46:29.675    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T10:46:29.675    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030523-102112-792_L1C_051-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/05/23/SPOT5-HRG2-XS_20030523-102116-522_L1C_051-260-1_D_V1-0/SPOT5-HRG2-XS_20030523-102116-522_L1C_051-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030523-102116-522_L1C_051-260-1_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030523-102116-522_L1C_051-260-1_D_V1-0.zip
run script
2024-01-15T10:50:38.013    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T10:50:38.014    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030523-102116-522_L1C_051-260-1_D_V1-0.zip
2024-01-15T10:50:38.014    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T10:50:38.014    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T10:50:38.014    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T10:50:38.014    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T10:50:38.015    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T10:50:38.015    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T10:50:38.015    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T10:50:38.015    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030523-102116-522_L1C_051-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/08/24/SPOT5-HRG2-XS_20030824-103244-234_L1C_051-261-6_D_V1-0/SPOT5-HRG2-XS_20030824-103244-234_L1C_051-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030824-103244-234_L1C_051-261-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030824-103244-234_L1C_051-261-6_D_V1-0.zip
run script
2024-01-15T10:54:07.178    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T10:54:07.179    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030824-103244-234_L1C_051-261-6_D_V1-0.zip
2024-01-15T10:54:07.179    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T10:54:07.179    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T10:54:07.179    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T10:54:07.180    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T10:54:07.180    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T10:54:07.180    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T10:54:07.180    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T10:54:07.180    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-15T10:56:45.852    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 16). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030824-103244-234_L1C_051-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2003/08/24/SPOT5-HRG2-XS_20030824-103247-121_L1C_051-262-0_D_V1-0/SPOT5-HRG2-XS_20030824-103247-121_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030824-103247-121_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030824-103247-121_L1C_051-262-0_D_V1-0.zip
run script
2024-01-15T10:56:50.888    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T10:56:50.889    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030824-103247-121_L1C_051-262-0_D_V1-0.zip
2024-01-15T10:56:50.889    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T10:56:50.889    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T10:56:50.889    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T10:56:50.889    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T10:56:50.889    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T10:56:50.890    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T10:56:50.890    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T10:56:50.890    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-15T10:59:09.225    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1746 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030824-103247-121_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2003/08/24/SPOT5-HRG2-XS_20030824-103255-424_L1C_051-263-0_D_V1-0/SPOT5-HRG2-XS_20030824-103255-424_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030824-103255-424_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030824-103255-424_L1C_051-263-0_D_V1-0.zip
run script
2024-01-15T10:59:13.838    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T10:59:13.839    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030824-103255-424_L1C_051-263-0_D_V1-0.zip
2024-01-15T10:59:13.839    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T10:59:13.839    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T10:59:13.839    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T10:59:13.839    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T10:59:13.839    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T10:59:13.840    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T10:59:13.840    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T10:59:13.840    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030824-103255-424_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/08/24/SPOT5-HRG1-XS_20030824-103242-159_L1C_053-261-6_D_V1-0/SPOT5-HRG1-XS_20030824-103242-159_L1C_053-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030824-103242-159_L1C_053-261-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030824-103242-159_L1C_053-261-6_D_V1-0.zip
run script
2024-01-15T11:00:16.968    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T11:00:16.969    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030824-103242-159_L1C_053-261-6_D_V1-0.zip
2024-01-15T11:00:16.970    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T11:00:16.970    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T11:00:16.970    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T11:00:16.970    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T11:00:16.970    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T11:00:16.970    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T11:00:16.970    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T11:00:16.970    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-15T11:03:34.323    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 188). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030824-103242-159_L1C_053-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2003/08/24/SPOT5-HRG1-XS_20030824-103245-046_L1C_053-262-0_D_V1-0/SPOT5-HRG1-XS_20030824-103245-046_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030824-103245-046_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030824-103245-046_L1C_053-262-0_D_V1-0.zip
run script
2024-01-15T11:03:39.237    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T11:03:39.238    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030824-103245-046_L1C_053-262-0_D_V1-0.zip
2024-01-15T11:03:39.238    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T11:03:39.238    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T11:03:39.238    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T11:03:39.238    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T11:03:39.238    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T11:03:39.238    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T11:03:39.239    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T11:03:39.239    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030824-103245-046_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/08/24/SPOT5-HRG1-XS_20030824-103253-372_L1C_053-263-0_D_V1-0/SPOT5-HRG1-XS_20030824-103253-372_L1C_053-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030824-103253-372_L1C_053-263-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030824-103253-372_L1C_053-263-0_D_V1-0.zip
run script
2024-01-15T11:06:41.751    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T11:06:41.752    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030824-103253-372_L1C_053-263-0_D_V1-0.zip
2024-01-15T11:06:41.752    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T11:06:41.752    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T11:06:41.752    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T11:06:41.752    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T11:06:41.752    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T11:06:41.752    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T11:06:41.752    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T11:06:41.752    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030824-103253-372_L1C_053-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/08/28/SPOT5-HRG2-XS_20030828-105549-081_L1C_051-261-6_D_V1-0/SPOT5-HRG2-XS_20030828-105549-081_L1C_051-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030828-105549-081_L1C_051-261-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030828-105549-081_L1C_051-261-6_D_V1-0.zip
run script
2024-01-15T11:08:09.656    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T11:08:09.658    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030828-105549-081_L1C_051-261-6_D_V1-0.zip
2024-01-15T11:08:09.658    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T11:08:09.658    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T11:08:09.658    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T11:08:09.658    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T11:08:09.658    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T11:08:09.658    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T11:08:09.658    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T11:08:09.658    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030828-105549-081_L1C_051-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/08/28/SPOT5-HRG2-XS_20030828-105552-065_L1C_051-262-0_D_V1-0/SPOT5-HRG2-XS_20030828-105552-065_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030828-105552-065_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030828-105552-065_L1C_051-262-0_D_V1-0.zip
run script
2024-01-15T11:11:49.980    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T11:11:49.982    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030828-105552-065_L1C_051-262-0_D_V1-0.zip
2024-01-15T11:11:49.982    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T11:11:49.982    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T11:11:49.982    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T11:11:49.982    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T11:11:49.982    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T11:11:49.982    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T11:11:49.982    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T11:11:49.982    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030828-105552-065_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/08/28/SPOT5-HRG2-XS_20030828-105601-402_L1C_051-263-1_D_V1-0/SPOT5-HRG2-XS_20030828-105601-402_L1C_051-263-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030828-105601-402_L1C_051-263-1_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030828-105601-402_L1C_051-263-1_D_V1-0.zip
run script
2024-01-15T11:14:54.889    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T11:14:54.890    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030828-105601-402_L1C_051-263-1_D_V1-0.zip
2024-01-15T11:14:54.890    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T11:14:54.890    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T11:14:54.891    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T11:14:54.891    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T11:14:54.891    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T11:14:54.891    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T11:14:54.891    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T11:14:54.891    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030828-105601-402_L1C_051-263-1_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/08/28/SPOT5-HRG1-XS_20030828-105540-651_L1C_053-260-9_D_V1-0/SPOT5-HRG1-XS_20030828-105540-651_L1C_053-260-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030828-105540-651_L1C_053-260-9_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030828-105540-651_L1C_053-260-9_D_V1-0.zip
run script
2024-01-15T11:15:54.351    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T11:15:54.352    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030828-105540-651_L1C_053-260-9_D_V1-0.zip
2024-01-15T11:15:54.352    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T11:15:54.352    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T11:15:54.352    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T11:15:54.352    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T11:15:54.352    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T11:15:54.352    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T11:15:54.352    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T11:15:54.352    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030828-105540-651_L1C_053-260-9_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/08/28/SPOT5-HRG1-XS_20030828-105549-387_L1C_053-262-0_D_V1-0/SPOT5-HRG1-XS_20030828-105549-387_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030828-105549-387_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030828-105549-387_L1C_053-262-0_D_V1-0.zip
run script
2024-01-15T11:20:34.623    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T11:20:34.625    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030828-105549-387_L1C_053-262-0_D_V1-0.zip
2024-01-15T11:20:34.625    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T11:20:34.625    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T11:20:34.625    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T11:20:34.625    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T11:20:34.625    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T11:20:34.625    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T11:20:34.625    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T11:20:34.625    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030828-105549-387_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/08/28/SPOT5-HRG1-XS_20030828-105557-833_L1C_053-263-0_D_V1-0/SPOT5-HRG1-XS_20030828-105557-833_L1C_053-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030828-105557-833_L1C_053-263-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030828-105557-833_L1C_053-263-0_D_V1-0.zip
run script
2024-01-15T11:24:28.431    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T11:24:28.432    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030828-105557-833_L1C_053-263-0_D_V1-0.zip
2024-01-15T11:24:28.432    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T11:24:28.432    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T11:24:28.433    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T11:24:28.433    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T11:24:28.433    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T11:24:28.433    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T11:24:28.433    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T11:24:28.433    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030828-105557-833_L1C_053-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/08/29/SPOT5-HRG2-XS_20030829-103634-031_L1C_051-261-6_D_V1-0/SPOT5-HRG2-XS_20030829-103634-031_L1C_051-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030829-103634-031_L1C_051-261-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030829-103634-031_L1C_051-261-6_D_V1-0.zip
run script
2024-01-15T11:26:16.716    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T11:26:16.718    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030829-103634-031_L1C_051-261-6_D_V1-0.zip
2024-01-15T11:26:16.718    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T11:26:16.718    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T11:26:16.718    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T11:26:16.718    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T11:26:16.718    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T11:26:16.718    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T11:26:16.718    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T11:26:16.718    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-15T11:28:47.521    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 26). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030829-103634-031_L1C_051-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2003/08/29/SPOT5-HRG2-XS_20030829-103636-943_L1C_051-262-0_D_V1-0/SPOT5-HRG2-XS_20030829-103636-943_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030829-103636-943_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030829-103636-943_L1C_051-262-0_D_V1-0.zip
run script
2024-01-15T11:28:52.341    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T11:28:52.342    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030829-103636-943_L1C_051-262-0_D_V1-0.zip
2024-01-15T11:28:52.342    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T11:28:52.342    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T11:28:52.342    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T11:28:52.343    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T11:28:52.343    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T11:28:52.343    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T11:28:52.343    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T11:28:52.343    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-15T11:31:01.819    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (3516 x 0). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030829-103636-943_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2003/08/29/SPOT5-HRG2-XS_20030829-103646-159_L1C_051-263-1_D_V1-0/SPOT5-HRG2-XS_20030829-103646-159_L1C_051-263-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030829-103646-159_L1C_051-263-1_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030829-103646-159_L1C_051-263-1_D_V1-0.zip
run script
2024-01-15T11:31:06.714    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T11:31:06.715    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030829-103646-159_L1C_051-263-1_D_V1-0.zip
2024-01-15T11:31:06.715    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T11:31:06.716    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T11:31:06.716    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T11:31:06.716    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T11:31:06.716    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T11:31:06.716    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T11:31:06.716    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T11:31:06.716    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030829-103646-159_L1C_051-263-1_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/07/14/SPOT5-HRG1-XS_20030714-102121-355_L1C_051-262-8_D_V1-0/SPOT5-HRG1-XS_20030714-102121-355_L1C_051-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030714-102121-355_L1C_051-262-8_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030714-102121-355_L1C_051-262-8_D_V1-0.zip
run script
2024-01-15T11:31:59.865    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T11:31:59.867    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030714-102121-355_L1C_051-262-8_D_V1-0.zip
2024-01-15T11:31:59.867    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T11:31:59.867    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T11:31:59.867    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T11:31:59.867    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T11:31:59.867    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T11:31:59.867    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T11:31:59.867    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T11:31:59.867    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030714-102121-355_L1C_051-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/07/14/SPOT5-HRG1-XS_20030714-102122-413_L1C_051-263-0_D_V1-0/SPOT5-HRG1-XS_20030714-102122-413_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030714-102122-413_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030714-102122-413_L1C_051-263-0_D_V1-0.zip
run script
2024-01-15T11:33:27.171    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T11:33:27.172    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030714-102122-413_L1C_051-263-0_D_V1-0.zip
2024-01-15T11:33:27.172    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T11:33:27.172    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T11:33:27.173    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T11:33:27.173    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T11:33:27.173    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T11:33:27.173    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T11:33:27.173    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T11:33:27.173    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030714-102122-413_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/09/09/SPOT5-HRG2-XS_20030909-102505-563_L1C_051-262-8_D_V1-0/SPOT5-HRG2-XS_20030909-102505-563_L1C_051-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030909-102505-563_L1C_051-262-8_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030909-102505-563_L1C_051-262-8_D_V1-0.zip
run script
2024-01-15T11:34:43.112    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T11:34:43.113    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030909-102505-563_L1C_051-262-8_D_V1-0.zip
2024-01-15T11:34:43.113    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T11:34:43.113    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T11:34:43.113    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T11:34:43.113    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T11:34:43.113    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T11:34:43.113    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T11:34:43.113    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T11:34:43.113    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030909-102505-563_L1C_051-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/09/09/SPOT5-HRG2-XS_20030909-102506-622_L1C_051-263-0_D_V1-0/SPOT5-HRG2-XS_20030909-102506-622_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030909-102506-622_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030909-102506-622_L1C_051-263-0_D_V1-0.zip
run script
2024-01-15T11:36:07.894    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T11:36:07.895    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030909-102506-622_L1C_051-263-0_D_V1-0.zip
2024-01-15T11:36:07.895    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T11:36:07.895    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T11:36:07.895    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T11:36:07.895    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T11:36:07.895    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T11:36:07.895    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T11:36:07.895    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T11:36:07.895    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030909-102506-622_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/09/09/SPOT5-HRG1-XS_20030909-102452-542_L1C_054-261-6_D_V1-0/SPOT5-HRG1-XS_20030909-102452-542_L1C_054-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030909-102452-542_L1C_054-261-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030909-102452-542_L1C_054-261-6_D_V1-0.zip
run script
2024-01-15T11:37:16.398    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T11:37:16.399    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030909-102452-542_L1C_054-261-6_D_V1-0.zip
2024-01-15T11:37:16.399    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T11:37:16.399    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T11:37:16.399    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T11:37:16.399    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T11:37:16.399    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T11:37:16.400    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T11:37:16.400    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T11:37:16.400    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-15T11:39:54.757    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 486). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030909-102452-542_L1C_054-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2003/09/09/SPOT5-HRG1-XS_20030909-102455-406_L1C_054-262-0_D_V1-0/SPOT5-HRG1-XS_20030909-102455-406_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030909-102455-406_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030909-102455-406_L1C_054-262-0_D_V1-0.zip
run script
2024-01-15T11:39:59.038    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T11:39:59.039    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030909-102455-406_L1C_054-262-0_D_V1-0.zip
2024-01-15T11:39:59.039    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T11:39:59.039    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T11:39:59.039    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T11:39:59.039    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T11:39:59.039    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T11:39:59.039    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T11:39:59.040    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T11:39:59.040    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030909-102455-406_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/09/09/SPOT5-HRG1-XS_20030909-102457-211_L1C_054-262-2_D_V1-0/SPOT5-HRG1-XS_20030909-102457-211_L1C_054-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030909-102457-211_L1C_054-262-2_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030909-102457-211_L1C_054-262-2_D_V1-0.zip
run script
2024-01-15T11:42:41.853    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T11:42:41.853    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030909-102457-211_L1C_054-262-2_D_V1-0.zip
2024-01-15T11:42:41.853    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T11:42:41.853    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T11:42:41.853    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T11:42:41.853    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T11:42:41.853    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T11:42:41.853    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T11:42:41.853    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T11:42:41.853    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030909-102457-211_L1C_054-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/09/13/SPOT5-HRG2-XS_20030913-104724-048_L1C_052-257-2_D_V1-0/SPOT5-HRG2-XS_20030913-104724-048_L1C_052-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030913-104724-048_L1C_052-257-2_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030913-104724-048_L1C_052-257-2_D_V1-0.zip
run script
2024-01-15T11:45:21.650    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T11:45:21.652    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030913-104724-048_L1C_052-257-2_D_V1-0.zip
2024-01-15T11:45:21.652    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T11:45:21.652    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T11:45:21.652    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T11:45:21.652    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T11:45:21.652    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T11:45:21.652    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T11:45:21.652    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T11:45:21.652    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030913-104724-048_L1C_052-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/09/13/SPOT5-HRG2-XS_20030913-104728-548_L1C_052-257-7_D_V1-0/SPOT5-HRG2-XS_20030913-104728-548_L1C_052-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030913-104728-548_L1C_052-257-7_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030913-104728-548_L1C_052-257-7_D_V1-0.zip
run script
2024-01-15T11:49:35.695    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T11:49:35.696    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030913-104728-548_L1C_052-257-7_D_V1-0.zip
2024-01-15T11:49:35.696    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T11:49:35.696    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T11:49:35.696    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T11:49:35.696    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T11:49:35.696    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T11:49:35.696    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T11:49:35.696    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T11:49:35.696    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030913-104728-548_L1C_052-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/09/13/SPOT5-HRG2-XS_20030913-104751-987_L1C_053-260-8_D_V1-0/SPOT5-HRG2-XS_20030913-104751-987_L1C_053-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030913-104751-987_L1C_053-260-8_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030913-104751-987_L1C_053-260-8_D_V1-0.zip
run script
2024-01-15T11:53:48.426    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T11:53:48.427    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030913-104751-987_L1C_053-260-8_D_V1-0.zip
2024-01-15T11:53:48.427    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T11:53:48.427    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T11:53:48.427    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T11:53:48.427    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T11:53:48.427    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T11:53:48.427    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T11:53:48.428    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T11:53:48.428    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030913-104751-987_L1C_053-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/09/13/SPOT5-HRG2-XS_20030913-104753-142_L1C_053-261-0_D_V1-0/SPOT5-HRG2-XS_20030913-104753-142_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030913-104753-142_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030913-104753-142_L1C_053-261-0_D_V1-0.zip
run script
2024-01-15T11:57:40.703    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T11:57:40.704    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030913-104753-142_L1C_053-261-0_D_V1-0.zip
2024-01-15T11:57:40.704    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T11:57:40.704    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T11:57:40.704    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T11:57:40.704    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T11:57:40.704    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T11:57:40.704    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T11:57:40.704    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T11:57:40.704    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030913-104753-142_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/09/13/SPOT5-HRG2-XS_20030913-104801-516_L1C_053-262-0_D_V1-0/SPOT5-HRG2-XS_20030913-104801-516_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030913-104801-516_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030913-104801-516_L1C_053-262-0_D_V1-0.zip
run script
2024-01-15T12:01:32.001    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T12:01:32.002    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030913-104801-516_L1C_053-262-0_D_V1-0.zip
2024-01-15T12:01:32.002    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T12:01:32.002    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T12:01:32.002    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T12:01:32.002    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T12:01:32.002    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T12:01:32.003    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T12:01:32.003    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T12:01:32.003    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030913-104801-516_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/04/15/SPOT5-HRG2-XS_20030415-105214-266_L1C_052-259-5_D_V1-0/SPOT5-HRG2-XS_20030415-105214-266_L1C_052-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030415-105214-266_L1C_052-259-5_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030415-105214-266_L1C_052-259-5_D_V1-0.zip
run script
2024-01-15T12:04:49.625    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T12:04:49.627    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030415-105214-266_L1C_052-259-5_D_V1-0.zip
2024-01-15T12:04:49.627    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T12:04:49.627    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T12:04:49.627    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T12:04:49.627    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T12:04:49.627    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T12:04:49.627    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T12:04:49.627    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T12:04:49.627    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030415-105214-266_L1C_052-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/04/15/SPOT5-HRG2-XS_20030415-105218-140_L1C_052-260-0_D_V1-0/SPOT5-HRG2-XS_20030415-105218-140_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030415-105218-140_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030415-105218-140_L1C_052-260-0_D_V1-0.zip
run script
2024-01-15T12:09:01.894    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T12:09:01.895    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030415-105218-140_L1C_052-260-0_D_V1-0.zip
2024-01-15T12:09:01.895    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T12:09:01.895    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T12:09:01.895    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T12:09:01.895    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T12:09:01.895    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T12:09:01.895    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T12:09:01.895    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T12:09:01.895    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-15T12:10:46.935    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (0 x 2460). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030415-105218-140_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2003/09/25/SPOT5-HRG1-XS_20030925-101645-649_L1C_052-259-6_D_V1-0/SPOT5-HRG1-XS_20030925-101645-649_L1C_052-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030925-101645-649_L1C_052-259-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030925-101645-649_L1C_052-259-6_D_V1-0.zip
run script
2024-01-15T12:10:52.631    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T12:10:52.632    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030925-101645-649_L1C_052-259-6_D_V1-0.zip
2024-01-15T12:10:52.632    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T12:10:52.632    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T12:10:52.632    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T12:10:52.632    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T12:10:52.632    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T12:10:52.632    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T12:10:52.632    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T12:10:52.632    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030925-101645-649_L1C_052-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 2 2]
 [2 2 2 ... 0 2 2]
 [2 2 2 ... 0 0 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/09/25/SPOT5-HRG1-XS_20030925-101649-379_L1C_052-260-1_D_V1-0/SPOT5-HRG1-XS_20030925-101649-379_L1C_052-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030925-101649-379_L1C_052-260-1_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030925-101649-379_L1C_052-260-1_D_V1-0.zip
run script
2024-01-15T12:15:12.762    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T12:15:12.763    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030925-101649-379_L1C_052-260-1_D_V1-0.zip
2024-01-15T12:15:12.763    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T12:15:12.763    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T12:15:12.763    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T12:15:12.763    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T12:15:12.763    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T12:15:12.763    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T12:15:12.763    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T12:15:12.763    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030925-101649-379_L1C_052-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/09/25/SPOT5-HRG2-XS_20030925-101701-746_L1C_053-261-6_D_V1-0/SPOT5-HRG2-XS_20030925-101701-746_L1C_053-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030925-101701-746_L1C_053-261-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030925-101701-746_L1C_053-261-6_D_V1-0.zip
run script
2024-01-15T12:19:05.367    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T12:19:05.369    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030925-101701-746_L1C_053-261-6_D_V1-0.zip
2024-01-15T12:19:05.369    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T12:19:05.369    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T12:19:05.369    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T12:19:05.369    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T12:19:05.369    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T12:19:05.369    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T12:19:05.369    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T12:19:05.369    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-15T12:22:49.291    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 212). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030925-101701-746_L1C_053-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2003/09/25/SPOT5-HRG2-XS_20030925-101704-609_L1C_053-262-0_D_V1-0/SPOT5-HRG2-XS_20030925-101704-609_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030925-101704-609_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030925-101704-609_L1C_053-262-0_D_V1-0.zip
run script
2024-01-15T12:22:54.753    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T12:22:54.753    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030925-101704-609_L1C_053-262-0_D_V1-0.zip
2024-01-15T12:22:54.753    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T12:22:54.753    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T12:22:54.753    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T12:22:54.753    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T12:22:54.753    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T12:22:54.753    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T12:22:54.754    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T12:22:54.754    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030925-101704-609_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/09/25/SPOT5-HRG2-XS_20030925-101712-887_L1C_053-263-0_D_V1-0/SPOT5-HRG2-XS_20030925-101712-887_L1C_053-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030925-101712-887_L1C_053-263-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030925-101712-887_L1C_053-263-0_D_V1-0.zip
run script
2024-01-15T12:26:29.014    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T12:26:29.016    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030925-101712-887_L1C_053-263-0_D_V1-0.zip
2024-01-15T12:26:29.016    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T12:26:29.016    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T12:26:29.016    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T12:26:29.016    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T12:26:29.016    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T12:26:29.016    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T12:26:29.016    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T12:26:29.016    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030925-101712-887_L1C_053-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/09/30/SPOT5-HRG1-XS_20030930-102034-007_L1C_052-259-6_D_V1-0/SPOT5-HRG1-XS_20030930-102034-007_L1C_052-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030930-102034-007_L1C_052-259-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030930-102034-007_L1C_052-259-6_D_V1-0.zip
run script
2024-01-15T12:28:06.993    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T12:28:06.994    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030930-102034-007_L1C_052-259-6_D_V1-0.zip
2024-01-15T12:28:06.995    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T12:28:06.995    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T12:28:06.995    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T12:28:06.995    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T12:28:06.995    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T12:28:06.995    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T12:28:06.995    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T12:28:06.995    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030930-102034-007_L1C_052-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/09/30/SPOT5-HRG1-XS_20030930-102037-761_L1C_052-260-1_D_V1-0/SPOT5-HRG1-XS_20030930-102037-761_L1C_052-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030930-102037-761_L1C_052-260-1_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030930-102037-761_L1C_052-260-1_D_V1-0.zip
run script
2024-01-15T12:32:11.047    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T12:32:11.049    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030930-102037-761_L1C_052-260-1_D_V1-0.zip
2024-01-15T12:32:11.049    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T12:32:11.049    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T12:32:11.049    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T12:32:11.049    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T12:32:11.049    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T12:32:11.049    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T12:32:11.049    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T12:32:11.049    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030930-102037-761_L1C_052-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/09/30/SPOT5-HRG2-XS_20030930-102050-073_L1C_053-261-6_D_V1-0/SPOT5-HRG2-XS_20030930-102050-073_L1C_053-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030930-102050-073_L1C_053-261-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030930-102050-073_L1C_053-261-6_D_V1-0.zip
run script
2024-01-15T12:35:45.275    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T12:35:45.276    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030930-102050-073_L1C_053-261-6_D_V1-0.zip
2024-01-15T12:35:45.277    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T12:35:45.277    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T12:35:45.277    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T12:35:45.277    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T12:35:45.277    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T12:35:45.277    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T12:35:45.277    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T12:35:45.277    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-15T12:39:17.664    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 199). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030930-102050-073_L1C_053-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2003/09/30/SPOT5-HRG2-XS_20030930-102052-936_L1C_053-262-0_D_V1-0/SPOT5-HRG2-XS_20030930-102052-936_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030930-102052-936_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030930-102052-936_L1C_053-262-0_D_V1-0.zip
run script
2024-01-15T12:39:23.073    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T12:39:23.075    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030930-102052-936_L1C_053-262-0_D_V1-0.zip
2024-01-15T12:39:23.075    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T12:39:23.075    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T12:39:23.075    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T12:39:23.075    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T12:39:23.075    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T12:39:23.075    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T12:39:23.075    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T12:39:23.075    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030930-102052-936_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/10/15/SPOT5-HRG1-XS_20031015-103156-017_L1C_052-259-6_D_V1-0/SPOT5-HRG1-XS_20031015-103156-017_L1C_052-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20031015-103156-017_L1C_052-259-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20031015-103156-017_L1C_052-259-6_D_V1-0.zip
run script
2024-01-15T12:42:43.618    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T12:42:43.620    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20031015-103156-017_L1C_052-259-6_D_V1-0.zip
2024-01-15T12:42:43.620    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T12:42:43.620    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T12:42:43.620    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T12:42:43.620    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T12:42:43.620    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T12:42:43.620    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T12:42:43.620    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T12:42:43.620    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20031015-103156-017_L1C_052-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/10/15/SPOT5-HRG1-XS_20031015-103159-795_L1C_052-260-1_D_V1-0/SPOT5-HRG1-XS_20031015-103159-795_L1C_052-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20031015-103159-795_L1C_052-260-1_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20031015-103159-795_L1C_052-260-1_D_V1-0.zip
run script
2024-01-15T12:46:25.153    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T12:46:25.155    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20031015-103159-795_L1C_052-260-1_D_V1-0.zip
2024-01-15T12:46:25.155    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T12:46:25.155    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T12:46:25.155    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T12:46:25.155    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T12:46:25.155    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T12:46:25.155    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T12:46:25.155    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T12:46:25.155    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20031015-103159-795_L1C_052-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/05/22/SPOT5-HRG1-XS_20030522-104032-962_L1C_052-260-1_D_V1-0/SPOT5-HRG1-XS_20030522-104032-962_L1C_052-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030522-104032-962_L1C_052-260-1_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030522-104032-962_L1C_052-260-1_D_V1-0.zip
run script
2024-01-15T12:49:47.140    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T12:49:47.141    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030522-104032-962_L1C_052-260-1_D_V1-0.zip
2024-01-15T12:49:47.141    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T12:49:47.141    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T12:49:47.141    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T12:49:47.141    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T12:49:47.141    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T12:49:47.142    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T12:49:47.142    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T12:49:47.142    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030522-104032-962_L1C_052-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/05/22/SPOT5-HRG1-XS_20030522-104040-374_L1C_052-261-0_D_V1-0/SPOT5-HRG1-XS_20030522-104040-374_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030522-104040-374_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030522-104040-374_L1C_052-261-0_D_V1-0.zip
run script
2024-01-15T12:53:17.602    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T12:53:17.603    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030522-104040-374_L1C_052-261-0_D_V1-0.zip
2024-01-15T12:53:17.603    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T12:53:17.603    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T12:53:17.603    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T12:53:17.603    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T12:53:17.603    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T12:53:17.603    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T12:53:17.603    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T12:53:17.603    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030522-104040-374_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/09/03/SPOT5-HRG1-XS_20030903-104014-673_L1C_053-260-8_D_V1-0/SPOT5-HRG1-XS_20030903-104014-673_L1C_053-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030903-104014-673_L1C_053-260-8_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030903-104014-673_L1C_053-260-8_D_V1-0.zip
run script
2024-01-15T12:56:58.228    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T12:56:58.230    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030903-104014-673_L1C_053-260-8_D_V1-0.zip
2024-01-15T12:56:58.230    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T12:56:58.230    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T12:56:58.230    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T12:56:58.230    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T12:56:58.230    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T12:56:58.230    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T12:56:58.230    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T12:56:58.230    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030903-104014-673_L1C_053-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/09/03/SPOT5-HRG1-XS_20030903-104015-780_L1C_053-261-0_D_V1-0/SPOT5-HRG1-XS_20030903-104015-780_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030903-104015-780_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030903-104015-780_L1C_053-261-0_D_V1-0.zip
run script
2024-01-15T13:00:31.276    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T13:00:31.278    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030903-104015-780_L1C_053-261-0_D_V1-0.zip
2024-01-15T13:00:31.278    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T13:00:31.278    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T13:00:31.278    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T13:00:31.278    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T13:00:31.279    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T13:00:31.279    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T13:00:31.279    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T13:00:31.279    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030903-104015-780_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/09/03/SPOT5-HRG1-XS_20030903-104024-130_L1C_053-262-0_D_V1-0/SPOT5-HRG1-XS_20030903-104024-130_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030903-104024-130_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030903-104024-130_L1C_053-262-0_D_V1-0.zip
run script
2024-01-15T13:04:15.702    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T13:04:15.703    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030903-104024-130_L1C_053-262-0_D_V1-0.zip
2024-01-15T13:04:15.703    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T13:04:15.703    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T13:04:15.704    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T13:04:15.704    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T13:04:15.704    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T13:04:15.704    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T13:04:15.704    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T13:04:15.704    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030903-104024-130_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/09/03/SPOT5-HRG1-XS_20030903-104032-481_L1C_053-263-0_D_V1-0/SPOT5-HRG1-XS_20030903-104032-481_L1C_053-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030903-104032-481_L1C_053-263-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030903-104032-481_L1C_053-263-0_D_V1-0.zip
run script
2024-01-15T13:07:21.335    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T13:07:21.335    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030903-104032-481_L1C_053-263-0_D_V1-0.zip
2024-01-15T13:07:21.335    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T13:07:21.335    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T13:07:21.335    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T13:07:21.335    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T13:07:21.335    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T13:07:21.335    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T13:07:21.335    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T13:07:21.335    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030903-104032-481_L1C_053-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/08/30/SPOT5-HRG1-XS_20030830-101708-840_L1C_053-261-0_D_V1-0/SPOT5-HRG1-XS_20030830-101708-840_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030830-101708-840_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030830-101708-840_L1C_053-261-0_D_V1-0.zip
run script
2024-01-15T13:08:50.507    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T13:08:50.508    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030830-101708-840_L1C_053-261-0_D_V1-0.zip
2024-01-15T13:08:50.508    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T13:08:50.508    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T13:08:50.508    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T13:08:50.508    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T13:08:50.508    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T13:08:50.508    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T13:08:50.508    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T13:08:50.509    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030830-101708-840_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/08/30/SPOT5-HRG1-XS_20030830-101717-118_L1C_053-262-0_D_V1-0/SPOT5-HRG1-XS_20030830-101717-118_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030830-101717-118_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030830-101717-118_L1C_053-262-0_D_V1-0.zip
run script
2024-01-15T13:13:02.060    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T13:13:02.061    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030830-101717-118_L1C_053-262-0_D_V1-0.zip
2024-01-15T13:13:02.061    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T13:13:02.061    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T13:13:02.061    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T13:13:02.061    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T13:13:02.061    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T13:13:02.061    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T13:13:02.061    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T13:13:02.061    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030830-101717-118_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/08/30/SPOT5-HRG1-XS_20030830-101725-396_L1C_053-263-0_D_V1-0/SPOT5-HRG1-XS_20030830-101725-396_L1C_053-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030830-101725-396_L1C_053-263-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030830-101725-396_L1C_053-263-0_D_V1-0.zip
run script
2024-01-15T13:16:34.392    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T13:16:34.393    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030830-101725-396_L1C_053-263-0_D_V1-0.zip
2024-01-15T13:16:34.393    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T13:16:34.393    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T13:16:34.393    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T13:16:34.393    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T13:16:34.393    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T13:16:34.393    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T13:16:34.393    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T13:16:34.394    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030830-101725-396_L1C_053-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/09/04/SPOT5-HRG1-XS_20030904-102104-185_L1C_053-261-6_D_V1-0/SPOT5-HRG1-XS_20030904-102104-185_L1C_053-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030904-102104-185_L1C_053-261-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030904-102104-185_L1C_053-261-6_D_V1-0.zip
run script
2024-01-15T13:18:11.334    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T13:18:11.335    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030904-102104-185_L1C_053-261-6_D_V1-0.zip
2024-01-15T13:18:11.335    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T13:18:11.335    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T13:18:11.335    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T13:18:11.335    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T13:18:11.335    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T13:18:11.335    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T13:18:11.335    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T13:18:11.335    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-15T13:21:41.991    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 200). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030904-102104-185_L1C_053-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2003/09/04/SPOT5-HRG1-XS_20030904-102107-024_L1C_053-262-0_D_V1-0/SPOT5-HRG1-XS_20030904-102107-024_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030904-102107-024_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030904-102107-024_L1C_053-262-0_D_V1-0.zip
run script
2024-01-15T13:21:50.779    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T13:21:50.780    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030904-102107-024_L1C_053-262-0_D_V1-0.zip
2024-01-15T13:21:50.781    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T13:21:50.781    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T13:21:50.781    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T13:21:50.781    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T13:21:50.781    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T13:21:50.781    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T13:21:50.781    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T13:21:50.781    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030904-102107-024_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/09/04/SPOT5-HRG1-XS_20030904-102115-326_L1C_053-263-0_D_V1-0/SPOT5-HRG1-XS_20030904-102115-326_L1C_053-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030904-102115-326_L1C_053-263-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030904-102115-326_L1C_053-263-0_D_V1-0.zip
run script
2024-01-15T13:25:19.007    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T13:25:19.009    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030904-102115-326_L1C_053-263-0_D_V1-0.zip
2024-01-15T13:25:19.009    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T13:25:19.009    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T13:25:19.009    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T13:25:19.009    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T13:25:19.009    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T13:25:19.009    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T13:25:19.010    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T13:25:19.010    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030904-102115-326_L1C_053-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/09/29/SPOT5-HRG2-XS_20030929-104007-412_L1C_053-261-6_D_V1-0/SPOT5-HRG2-XS_20030929-104007-412_L1C_053-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030929-104007-412_L1C_053-261-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030929-104007-412_L1C_053-261-6_D_V1-0.zip
run script
2024-01-15T13:26:49.262    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T13:26:49.263    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030929-104007-412_L1C_053-261-6_D_V1-0.zip
2024-01-15T13:26:49.263    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T13:26:49.263    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T13:26:49.263    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T13:26:49.263    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T13:26:49.263    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T13:26:49.264    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T13:26:49.264    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T13:26:49.264    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-15T13:30:11.383    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 188). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030929-104007-412_L1C_053-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2003/09/29/SPOT5-HRG2-XS_20030929-104010-324_L1C_053-262-0_D_V1-0/SPOT5-HRG2-XS_20030929-104010-324_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030929-104010-324_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030929-104010-324_L1C_053-262-0_D_V1-0.zip
run script
2024-01-15T13:30:16.478    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T13:30:16.478    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030929-104010-324_L1C_053-262-0_D_V1-0.zip
2024-01-15T13:30:16.478    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T13:30:16.478    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T13:30:16.479    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T13:30:16.479    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T13:30:16.479    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T13:30:16.479    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T13:30:16.479    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T13:30:16.479    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030929-104010-324_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/09/29/SPOT5-HRG2-XS_20030929-104018-674_L1C_053-263-0_D_V1-0/SPOT5-HRG2-XS_20030929-104018-674_L1C_053-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030929-104018-674_L1C_053-263-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030929-104018-674_L1C_053-263-0_D_V1-0.zip
run script
2024-01-15T13:33:22.636    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T13:33:22.636    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030929-104018-674_L1C_053-263-0_D_V1-0.zip
2024-01-15T13:33:22.636    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T13:33:22.636    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T13:33:22.636    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T13:33:22.636    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T13:33:22.636    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T13:33:22.636    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T13:33:22.636    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T13:33:22.637    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030929-104018-674_L1C_053-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/04/22/SPOT5-HRG1-XS_20030422-101757-487_L1C_053-262-6_D_V1-0/SPOT5-HRG1-XS_20030422-101757-487_L1C_053-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030422-101757-487_L1C_053-262-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030422-101757-487_L1C_053-262-6_D_V1-0.zip
run script
2024-01-15T13:34:49.038    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T13:34:49.039    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030422-101757-487_L1C_053-262-6_D_V1-0.zip
2024-01-15T13:34:49.039    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T13:34:49.039    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T13:34:49.039    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T13:34:49.039    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T13:34:49.040    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T13:34:49.040    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T13:34:49.040    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T13:34:49.040    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030422-101757-487_L1C_053-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/04/22/SPOT5-HRG1-XS_20030422-101800-351_L1C_053-263-0_D_V1-0/SPOT5-HRG1-XS_20030422-101800-351_L1C_053-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030422-101800-351_L1C_053-263-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030422-101800-351_L1C_053-263-0_D_V1-0.zip
run script
2024-01-15T13:37:06.751    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T13:37:06.752    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030422-101800-351_L1C_053-263-0_D_V1-0.zip
2024-01-15T13:37:06.752    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T13:37:06.752    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T13:37:06.752    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T13:37:06.752    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T13:37:06.752    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T13:37:06.752    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T13:37:06.752    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T13:37:06.752    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030422-101800-351_L1C_053-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/09/08/SPOT5-HRG2-XS_20030908-104408-873_L1C_054-261-6_D_V1-0/SPOT5-HRG2-XS_20030908-104408-873_L1C_054-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030908-104408-873_L1C_054-261-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030908-104408-873_L1C_054-261-6_D_V1-0.zip
run script
2024-01-15T13:38:38.480    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T13:38:38.480    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030908-104408-873_L1C_054-261-6_D_V1-0.zip
2024-01-15T13:38:38.480    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T13:38:38.480    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T13:38:38.480    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T13:38:38.481    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T13:38:38.481    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T13:38:38.481    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T13:38:38.481    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T13:38:38.481    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-15T13:41:18.764    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 238). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030908-104408-873_L1C_054-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2003/09/08/SPOT5-HRG2-XS_20030908-104411-833_L1C_054-262-0_D_V1-0/SPOT5-HRG2-XS_20030908-104411-833_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030908-104411-833_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030908-104411-833_L1C_054-262-0_D_V1-0.zip
run script
2024-01-15T13:41:23.575    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T13:41:23.577    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030908-104411-833_L1C_054-262-0_D_V1-0.zip
2024-01-15T13:41:23.577    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T13:41:23.577    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T13:41:23.577    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T13:41:23.577    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T13:41:23.577    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T13:41:23.577    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T13:41:23.577    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T13:41:23.577    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030908-104411-833_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/09/14/SPOT5-HRG2-XS_20030914-102836-611_L1C_054-261-1_D_V1-0/SPOT5-HRG2-XS_20030914-102836-611_L1C_054-261-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030914-102836-611_L1C_054-261-1_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030914-102836-611_L1C_054-261-1_D_V1-0.zip
run script
2024-01-15T13:44:07.723    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T13:44:07.725    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030914-102836-611_L1C_054-261-1_D_V1-0.zip
2024-01-15T13:44:07.725    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T13:44:07.725    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T13:44:07.725    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T13:44:07.725    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T13:44:07.725    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T13:44:07.725    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T13:44:07.725    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T13:44:07.726    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030914-102836-611_L1C_054-261-1_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/09/14/SPOT5-HRG2-XS_20030914-102842-915_L1C_054-261-8_D_V1-0/SPOT5-HRG2-XS_20030914-102842-915_L1C_054-261-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030914-102842-915_L1C_054-261-8_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030914-102842-915_L1C_054-261-8_D_V1-0.zip
run script
2024-01-15T13:46:28.293    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T13:46:28.294    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030914-102842-915_L1C_054-261-8_D_V1-0.zip
2024-01-15T13:46:28.294    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T13:46:28.294    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T13:46:28.295    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T13:46:28.295    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T13:46:28.295    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T13:46:28.295    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T13:46:28.295    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T13:46:28.295    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030914-102842-915_L1C_054-261-8_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/10/10/SPOT5-HRG2-XS_20031010-102818-088_L1C_054-261-0_D_V1-0/SPOT5-HRG2-XS_20031010-102818-088_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20031010-102818-088_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20031010-102818-088_L1C_054-261-0_D_V1-0.zip
run script
2024-01-15T13:48:34.261    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T13:48:34.262    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20031010-102818-088_L1C_054-261-0_D_V1-0.zip
2024-01-15T13:48:34.262    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T13:48:34.262    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T13:48:34.262    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T13:48:34.262    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T13:48:34.262    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T13:48:34.262    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T13:48:34.262    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T13:48:34.262    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20031010-102818-088_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/10/10/SPOT5-HRG2-XS_20031010-102826-415_L1C_054-262-0_D_V1-0/SPOT5-HRG2-XS_20031010-102826-415_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20031010-102826-415_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20031010-102826-415_L1C_054-262-0_D_V1-0.zip
run script
2024-01-15T13:50:42.308    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T13:50:42.309    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20031010-102826-415_L1C_054-262-0_D_V1-0.zip
2024-01-15T13:50:42.310    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T13:50:42.310    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T13:50:42.310    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T13:50:42.310    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T13:50:42.310    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T13:50:42.310    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T13:50:42.310    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T13:50:42.310    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20031010-102826-415_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/03/21/SPOT5-HRG2-XS_20030321-103301-287_L1C_055-261-0_D_V1-0/SPOT5-HRG2-XS_20030321-103301-287_L1C_055-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030321-103301-287_L1C_055-261-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030321-103301-287_L1C_055-261-0_D_V1-0.zip
run script
2024-01-15T13:52:43.168    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T13:52:43.169    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030321-103301-287_L1C_055-261-0_D_V1-0.zip
2024-01-15T13:52:43.169    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T13:52:43.169    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T13:52:43.169    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T13:52:43.169    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T13:52:43.169    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T13:52:43.169    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T13:52:43.169    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T13:52:43.169    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030321-103301-287_L1C_055-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/03/21/SPOT5-HRG2-XS_20030321-103309-397_L1C_055-261-9_D_V1-0/SPOT5-HRG2-XS_20030321-103309-397_L1C_055-261-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030321-103309-397_L1C_055-261-9_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030321-103309-397_L1C_055-261-9_D_V1-0.zip
run script
2024-01-15T13:53:47.298    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T13:53:47.299    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030321-103309-397_L1C_055-261-9_D_V1-0.zip
2024-01-15T13:53:47.299    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T13:53:47.299    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T13:53:47.299    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T13:53:47.299    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T13:53:47.299    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T13:53:47.299    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T13:53:47.299    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T13:53:47.299    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20030321-103309-397_L1C_055-261-9_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/05/18/SPOT5-HRG1-XS_20030518-101730-727_L1C_055-261-0_D_V1-0/SPOT5-HRG1-XS_20030518-101730-727_L1C_055-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030518-101730-727_L1C_055-261-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030518-101730-727_L1C_055-261-0_D_V1-0.zip
run script
2024-01-15T13:55:08.531    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T13:55:08.532    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030518-101730-727_L1C_055-261-0_D_V1-0.zip
2024-01-15T13:55:08.532    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T13:55:08.532    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T13:55:08.532    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T13:55:08.532    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T13:55:08.532    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T13:55:08.532    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T13:55:08.532    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T13:55:08.532    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG1-XS_20030518-101730-727_L1C_055-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/10/09/SPOT5-HRG2-XS_20031009-104732-413_L1C_055-261-0_D_V1-0/SPOT5-HRG2-XS_20031009-104732-413_L1C_055-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20031009-104732-413_L1C_055-261-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20031009-104732-413_L1C_055-261-0_D_V1-0.zip
run script
2024-01-15T13:56:21.870    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T13:56:21.870    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20031009-104732-413_L1C_055-261-0_D_V1-0.zip
2024-01-15T13:56:21.870    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T13:56:21.871    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T13:56:21.871    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T13:56:21.871    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T13:56:21.871    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T13:56:21.871    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T13:56:21.871    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T13:56:21.871    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20031009-104732-413_L1C_055-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/10/09/SPOT5-HRG2-XS_20031009-104737-828_L1C_055-261-6_D_V1-0/SPOT5-HRG2-XS_20031009-104737-828_L1C_055-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20031009-104737-828_L1C_055-261-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20031009-104737-828_L1C_055-261-6_D_V1-0.zip
run script
2024-01-15T13:57:35.995    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T13:57:35.996    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20031009-104737-828_L1C_055-261-6_D_V1-0.zip
2024-01-15T13:57:35.996    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T13:57:35.996    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T13:57:35.996    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T13:57:35.996    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T13:57:35.996    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T13:57:35.996    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T13:57:35.996    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T13:57:35.996    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-15T13:58:59.337    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 258). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20031009-104737-828_L1C_055-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2003/10/21/SPOT5-HRG2-XS_20031021-101631-714_L1C_055-261-0_D_V1-0/SPOT5-HRG2-XS_20031021-101631-714_L1C_055-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20031021-101631-714_L1C_055-261-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20031021-101631-714_L1C_055-261-0_D_V1-0.zip
run script
2024-01-15T13:59:04.026    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T13:59:04.028    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20031021-101631-714_L1C_055-261-0_D_V1-0.zip
2024-01-15T13:59:04.028    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T13:59:04.028    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T13:59:04.028    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T13:59:04.028    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T13:59:04.028    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T13:59:04.028    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T13:59:04.028    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T13:59:04.028    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT5-HRG2-XS_20031021-101631-714_L1C_055-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/10/15/SPOT2-HRV2-XS_20081015-103654-448_L1C_046-262-9_D_V1-0/SPOT2-HRV2-XS_20081015-103654-448_L1C_046-262-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081015-103654-448_L1C_046-262-9_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081015-103654-448_L1C_046-262-9_D_V1-0.zip
run script
2024-01-15T14:00:05.643    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:00:05.644    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081015-103654-448_L1C_046-262-9_D_V1-0.zip
2024-01-15T14:00:05.644    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:00:05.644    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:00:05.644    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:00:05.644    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:00:05.645    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:00:05.645    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:00:05.645    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:00:05.645    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081015-103654-448_L1C_046-262-9_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/10/15/SPOT2-HRV2-XS_20081015-103654-671_L1C_046-263-0_D_V1-0/SPOT2-HRV2-XS_20081015-103654-671_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081015-103654-671_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081015-103654-671_L1C_046-263-0_D_V1-0.zip
run script
2024-01-15T14:00:34.741    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:00:34.742    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081015-103654-671_L1C_046-263-0_D_V1-0.zip
2024-01-15T14:00:34.742    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:00:34.742    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:00:34.742    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:00:34.742    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:00:34.742    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:00:34.742    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:00:34.742    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:00:34.742    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081015-103654-671_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/10/15/SPOT2-HRV2-XS_20081015-103700-085_L1C_046-263-6_D_V1-0/SPOT2-HRV2-XS_20081015-103700-085_L1C_046-263-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081015-103700-085_L1C_046-263-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081015-103700-085_L1C_046-263-6_D_V1-0.zip
run script
2024-01-15T14:01:01.878    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:01:01.880    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081015-103700-085_L1C_046-263-6_D_V1-0.zip
2024-01-15T14:01:01.880    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:01:01.880    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:01:01.880    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:01:01.880    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:01:01.880    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:01:01.880    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:01:01.880    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:01:01.880    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081015-103700-085_L1C_046-263-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/10/15/SPOT2-HRV2-XS_20081015-103607-234_L1C_050-258-0_D_V1-0/SPOT2-HRV2-XS_20081015-103607-234_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081015-103607-234_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081015-103607-234_L1C_050-258-0_D_V1-0.zip
run script
2024-01-15T14:01:52.091    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:01:52.092    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081015-103607-234_L1C_050-258-0_D_V1-0.zip
2024-01-15T14:01:52.092    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:01:52.092    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:01:52.092    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:01:52.092    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:01:52.092    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:01:52.092    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:01:52.092    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:01:52.092    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-15T14:03:46.442    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 452). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081015-103607-234_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2008/10/15/SPOT2-HRV2-XS_20081015-103550-504_L1C_051-256-0_D_V1-0/SPOT2-HRV2-XS_20081015-103550-504_L1C_051-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081015-103550-504_L1C_051-256-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081015-103550-504_L1C_051-256-0_D_V1-0.zip
run script
2024-01-15T14:03:50.016    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:03:50.017    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081015-103550-504_L1C_051-256-0_D_V1-0.zip
2024-01-15T14:03:50.017    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:03:50.017    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:03:50.017    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:03:50.017    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:03:50.017    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:03:50.017    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:03:50.017    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:03:50.017    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081015-103550-504_L1C_051-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/10/15/SPOT2-HRV2-XS_20081015-103558-866_L1C_051-257-0_D_V1-0/SPOT2-HRV2-XS_20081015-103558-866_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081015-103558-866_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081015-103558-866_L1C_051-257-0_D_V1-0.zip
run script
2024-01-15T14:06:53.072    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:06:53.073    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081015-103558-866_L1C_051-257-0_D_V1-0.zip
2024-01-15T14:06:53.073    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:06:53.073    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:06:53.073    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:06:53.074    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:06:53.074    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:06:53.074    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:06:53.074    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:06:53.074    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081015-103558-866_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 2 ... 2 2 2]
 [0 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/11/26/SPOT2-HRV2-XS_20081126-102813-053_L1C_046-262-8_D_V1-0/SPOT2-HRV2-XS_20081126-102813-053_L1C_046-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081126-102813-053_L1C_046-262-8_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081126-102813-053_L1C_046-262-8_D_V1-0.zip
run script
2024-01-15T14:10:22.500    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:10:22.501    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081126-102813-053_L1C_046-262-8_D_V1-0.zip
2024-01-15T14:10:22.501    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:10:22.501    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:10:22.501    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:10:22.501    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:10:22.501    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:10:22.501    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:10:22.501    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:10:22.501    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081126-102813-053_L1C_046-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/11/26/SPOT2-HRV2-XS_20081126-102814-142_L1C_046-263-0_D_V1-0/SPOT2-HRV2-XS_20081126-102814-142_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081126-102814-142_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081126-102814-142_L1C_046-263-0_D_V1-0.zip
run script
2024-01-15T14:10:44.955    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:10:44.957    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081126-102814-142_L1C_046-263-0_D_V1-0.zip
2024-01-15T14:10:44.957    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:10:44.957    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:10:44.957    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:10:44.957    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:10:44.957    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:10:44.957    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:10:44.957    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:10:44.957    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081126-102814-142_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/08/25/SPOT2-HRV1-XS_20080825-101925-478_L1C_046-263-0_D_V1-0/SPOT2-HRV1-XS_20080825-101925-478_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080825-101925-478_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080825-101925-478_L1C_046-263-0_D_V1-0.zip
run script
2024-01-15T14:11:13.204    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:11:13.204    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080825-101925-478_L1C_046-263-0_D_V1-0.zip
2024-01-15T14:11:13.204    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:11:13.204    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:11:13.204    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:11:13.204    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:11:13.204    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:11:13.204    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:11:13.204    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:11:13.205    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080825-101925-478_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/09/18/SPOT2-HRV2-XS_20080918-105718-081_L1C_046-263-7_D_V1-0/SPOT2-HRV2-XS_20080918-105718-081_L1C_046-263-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080918-105718-081_L1C_046-263-7_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080918-105718-081_L1C_046-263-7_D_V1-0.zip
run script
2024-01-15T14:11:56.868    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:11:56.870    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080918-105718-081_L1C_046-263-7_D_V1-0.zip
2024-01-15T14:11:56.870    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:11:56.870    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:11:56.870    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:11:56.870    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:11:56.870    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:11:56.870    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:11:56.870    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:11:56.870    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080918-105718-081_L1C_046-263-7_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/09/18/SPOT2-HRV2-XS_20080918-105618-941_L1C_047-257-0_D_V1-0/SPOT2-HRV2-XS_20080918-105618-941_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080918-105618-941_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080918-105618-941_L1C_047-257-0_D_V1-0.zip
run script
2024-01-15T14:13:39.134    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:13:39.136    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080918-105618-941_L1C_047-257-0_D_V1-0.zip
2024-01-15T14:13:39.136    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:13:39.136    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:13:39.136    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:13:39.136    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:13:39.136    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:13:39.136    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:13:39.136    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:13:39.136    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-15T14:13:41.611    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (104 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080918-105618-941_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2008/09/18/SPOT2-HRV2-XS_20080918-105627-424_L1C_047-258-0_D_V1-0/SPOT2-HRV2-XS_20080918-105627-424_L1C_047-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080918-105627-424_L1C_047-258-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080918-105627-424_L1C_047-258-0_D_V1-0.zip
run script
2024-01-15T14:13:45.022    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:13:45.023    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080918-105627-424_L1C_047-258-0_D_V1-0.zip
2024-01-15T14:13:45.023    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:13:45.023    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:13:45.023    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:13:45.023    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:13:45.023    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:13:45.023    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:13:45.023    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:13:45.023    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080918-105627-424_L1C_047-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/09/18/SPOT2-HRV2-XS_20080918-105635-912_L1C_047-259-0_D_V1-0/SPOT2-HRV2-XS_20080918-105635-912_L1C_047-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080918-105635-912_L1C_047-259-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080918-105635-912_L1C_047-259-0_D_V1-0.zip
run script
2024-01-15T14:13:48.391    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:13:48.391    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080918-105635-912_L1C_047-259-0_D_V1-0.zip
2024-01-15T14:13:48.391    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:13:48.391    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:13:48.391    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:13:48.392    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:13:48.392    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:13:48.392    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:13:48.392    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:13:48.392    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080918-105635-912_L1C_047-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/09/29/SPOT2-HRV2-XS_20080929-104521-382_L1C_046-263-8_D_V1-0/SPOT2-HRV2-XS_20080929-104521-382_L1C_046-263-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080929-104521-382_L1C_046-263-8_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080929-104521-382_L1C_046-263-8_D_V1-0.zip
run script
2024-01-15T14:13:51.874    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:13:51.875    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080929-104521-382_L1C_046-263-8_D_V1-0.zip
2024-01-15T14:13:51.875    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:13:51.875    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:13:51.875    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:13:51.876    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:13:51.876    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:13:51.876    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:13:51.876    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:13:51.876    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080929-104521-382_L1C_046-263-8_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/09/29/SPOT2-HRV2-XS_20080929-104410-836_L1C_047-255-6_D_V1-0/SPOT2-HRV2-XS_20080929-104410-836_L1C_047-255-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080929-104410-836_L1C_047-255-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080929-104410-836_L1C_047-255-6_D_V1-0.zip
run script
2024-01-15T14:15:19.870    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:15:19.872    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080929-104410-836_L1C_047-255-6_D_V1-0.zip
2024-01-15T14:15:19.872    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:15:19.872    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:15:19.872    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:15:19.872    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:15:19.872    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:15:19.872    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:15:19.872    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:15:19.872    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-15T14:15:22.228    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (184 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080929-104410-836_L1C_047-255-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2008/09/29/SPOT2-HRV2-XS_20080929-104413-786_L1C_047-256-0_D_V1-0/SPOT2-HRV2-XS_20080929-104413-786_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080929-104413-786_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080929-104413-786_L1C_047-256-0_D_V1-0.zip
run script
2024-01-15T14:15:25.465    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:15:25.466    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080929-104413-786_L1C_047-256-0_D_V1-0.zip
2024-01-15T14:15:25.466    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:15:25.466    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:15:25.466    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:15:25.466    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:15:25.467    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:15:25.467    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:15:25.467    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:15:25.467    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080929-104413-786_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/09/29/SPOT2-HRV2-XS_20080929-104422-158_L1C_047-257-0_D_V1-0/SPOT2-HRV2-XS_20080929-104422-158_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080929-104422-158_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080929-104422-158_L1C_047-257-0_D_V1-0.zip
run script
2024-01-15T14:15:28.923    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:15:28.923    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080929-104422-158_L1C_047-257-0_D_V1-0.zip
2024-01-15T14:15:28.923    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:15:28.923    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:15:28.923    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:15:28.923    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:15:28.923    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:15:28.923    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:15:28.923    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:15:28.923    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080929-104422-158_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/09/29/SPOT2-HRV1-XS_20080929-104351-043_L1C_051-254-0_D_V1-0/SPOT2-HRV1-XS_20080929-104351-043_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080929-104351-043_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080929-104351-043_L1C_051-254-0_D_V1-0.zip
run script
2024-01-15T14:15:32.310    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:15:32.311    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080929-104351-043_L1C_051-254-0_D_V1-0.zip
2024-01-15T14:15:32.311    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:15:32.311    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:15:32.311    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:15:32.311    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:15:32.311    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:15:32.311    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:15:32.311    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:15:32.311    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080929-104351-043_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/09/29/SPOT2-HRV1-XS_20080929-104351-945_L1C_051-254-1_D_V1-0/SPOT2-HRV1-XS_20080929-104351-945_L1C_051-254-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080929-104351-945_L1C_051-254-1_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080929-104351-945_L1C_051-254-1_D_V1-0.zip
run script
2024-01-15T14:15:35.546    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:15:35.547    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080929-104351-945_L1C_051-254-1_D_V1-0.zip
2024-01-15T14:15:35.547    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:15:35.547    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:15:35.547    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:15:35.547    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:15:35.547    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:15:35.547    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:15:35.547    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:15:35.547    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080929-104351-945_L1C_051-254-1_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/10/04/SPOT2-HRV1-XS_20081004-104900-738_L1C_046-263-7_D_V1-0/SPOT2-HRV1-XS_20081004-104900-738_L1C_046-263-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20081004-104900-738_L1C_046-263-7_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081004-104900-738_L1C_046-263-7_D_V1-0.zip
run script
2024-01-15T14:15:38.918    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:15:38.918    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081004-104900-738_L1C_046-263-7_D_V1-0.zip
2024-01-15T14:15:38.918    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:15:38.918    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:15:38.918    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:15:38.918    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:15:38.918    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:15:38.918    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:15:38.918    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:15:38.919    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081004-104900-738_L1C_046-263-7_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/10/04/SPOT2-HRV1-XS_20081004-104802-157_L1C_047-256-9_D_V1-0/SPOT2-HRV1-XS_20081004-104802-157_L1C_047-256-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20081004-104802-157_L1C_047-256-9_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081004-104802-157_L1C_047-256-9_D_V1-0.zip
run script
2024-01-15T14:17:04.911    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:17:04.912    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081004-104802-157_L1C_047-256-9_D_V1-0.zip
2024-01-15T14:17:04.912    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:17:04.912    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:17:04.912    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:17:04.912    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:17:04.912    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:17:04.912    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:17:04.913    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:17:04.913    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081004-104802-157_L1C_047-256-9_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/10/04/SPOT2-HRV1-XS_20081004-104802-437_L1C_047-257-0_D_V1-0/SPOT2-HRV1-XS_20081004-104802-437_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20081004-104802-437_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081004-104802-437_L1C_047-257-0_D_V1-0.zip
run script
2024-01-15T14:17:08.484    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:17:08.484    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081004-104802-437_L1C_047-257-0_D_V1-0.zip
2024-01-15T14:17:08.485    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:17:08.485    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:17:08.485    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:17:08.485    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:17:08.485    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:17:08.485    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:17:08.485    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:17:08.485    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081004-104802-437_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/10/04/SPOT2-HRV2-XS_20081004-104813-931_L1C_050-258-8_D_V1-0/SPOT2-HRV2-XS_20081004-104813-931_L1C_050-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081004-104813-931_L1C_050-258-8_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081004-104813-931_L1C_050-258-8_D_V1-0.zip
run script
2024-01-15T14:17:11.975    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:17:11.976    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081004-104813-931_L1C_050-258-8_D_V1-0.zip
2024-01-15T14:17:11.976    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:17:11.976    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:17:11.976    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:17:11.976    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:17:11.976    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:17:11.976    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:17:11.976    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:17:11.976    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081004-104813-931_L1C_050-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/07/09/SPOT2-HRV2-XS_20080709-102344-000_L1C_047-255-0_D_V1-0/SPOT2-HRV2-XS_20080709-102344-000_L1C_047-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080709-102344-000_L1C_047-255-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080709-102344-000_L1C_047-255-0_D_V1-0.zip
run script
2024-01-15T14:19:01.938    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:19:01.939    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080709-102344-000_L1C_047-255-0_D_V1-0.zip
2024-01-15T14:19:01.939    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:19:01.939    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:19:01.939    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:19:01.939    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:19:01.939    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:19:01.939    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:19:01.939    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:19:01.939    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080709-102344-000_L1C_047-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/07/09/SPOT2-HRV2-XS_20080709-102352-227_L1C_047-256-0_D_V1-0/SPOT2-HRV2-XS_20080709-102352-227_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080709-102352-227_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080709-102352-227_L1C_047-256-0_D_V1-0.zip
run script
2024-01-15T14:19:11.121    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:19:11.123    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080709-102352-227_L1C_047-256-0_D_V1-0.zip
2024-01-15T14:19:11.123    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:19:11.123    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:19:11.123    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:19:11.123    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:19:11.123    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:19:11.124    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:19:11.124    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:19:11.124    INFO:run_snow_swh.py::main:Launch snow detection.
ERROR 1: Attempt to create 0x3613 dataset is illegal,sizes must be larger than zero.
ERROR 1: Attempt to create 0x3613 dataset is illegal,sizes must be larger than zero.
ERROR 1: Attempt to create 0x3613 dataset is illegal,sizes must be larger than zero.
ERROR 1: Attempt to create 0x3613 dataset is illegal,sizes must be larger than zero.
ERROR 4: /tmp/slurm-4283301/OUTPUT/SPOT2/2008/7/9/SPOT2-HRV2-XS_20080709-102352-227_L1C_047-256-0_C_V1-0/31TGM/FSC_20080709T102352_SPOT2_31TGM/dem.tif: No such file or directory
GDALOpen failed - 4
/tmp/slurm-4283301/OUTPUT/SPOT2/2008/7/9/SPOT2-HRV2-XS_20080709-102352-227_L1C_047-256-0_C_V1-0/31TGM/FSC_20080709T102352_SPOT2_31TGM/dem.tif: No such file or directory
ERROR 4: /tmp/slurm-4283301/OUTPUT/SPOT2/2008/7/9/SPOT2-HRV2-XS_20080709-102352-227_L1C_047-256-0_C_V1-0/31TGM/FSC_20080709T102352_SPOT2_31TGM/xs1.tif: No such file or directory
ERROR 4: /tmp/slurm-4283301/OUTPUT/SPOT2/2008/7/9/SPOT2-HRV2-XS_20080709-102352-227_L1C_047-256-0_C_V1-0/31TGM/FSC_20080709T102352_SPOT2_31TGM/xs2.tif: No such file or directory
ERROR 4: /tmp/slurm-4283301/OUTPUT/SPOT2/2008/7/9/SPOT2-HRV2-XS_20080709-102352-227_L1C_047-256-0_C_V1-0/31TGM/FSC_20080709T102352_SPOT2_31TGM/xs3.tif: No such file or directory
ERROR 4: /tmp/slurm-4283301/OUTPUT/SPOT2/2008/7/9/SPOT2-HRV2-XS_20080709-102352-227_L1C_047-256-0_C_V1-0/31TGM/FSC_20080709T102352_SPOT2_31TGM/hill.tif: No such file or directory
ERROR 4: /tmp/slurm-4283301/OUTPUT/SPOT2/2008/7/9/SPOT2-HRV2-XS_20080709-102352-227_L1C_047-256-0_C_V1-0/31TGM/FSC_20080709T102352_SPOT2_31TGM/dem.tif: No such file or directory
Traceback (most recent call last):
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/bin/gdal_merge.py", line 4, in <module>
    __import__('pkg_resources').run_script('GDAL==3.4.3', 'gdal_merge.py')
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/pkg_resources/__init__.py", line 672, in run_script
    self.require(requires)[0].run_script(script_name, ns)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/pkg_resources/__init__.py", line 1472, in run_script
    exec(code, namespace, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/GDAL-3.4.3-py3.8-linux-x86_64.egg-info/scripts/gdal_merge.py", line 11, in <module>
    sys.exit(main(sys.argv))
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/osgeo_utils/gdal_merge.py", line 428, in main
    ulx = file_infos[0].ulx
IndexError: list index out of range
rm: cannot remove '/tmp/slurm-4283301/OUTPUT/SPOT2/2008/7/9/SPOT2-HRV2-XS_20080709-102352-227_L1C_047-256-0_C_V1-0/31TGM/FSC_20080709T102352_SPOT2_31TGM/xs1.tif': No such file or directory
rm: cannot remove '/tmp/slurm-4283301/OUTPUT/SPOT2/2008/7/9/SPOT2-HRV2-XS_20080709-102352-227_L1C_047-256-0_C_V1-0/31TGM/FSC_20080709T102352_SPOT2_31TGM/xs2.tif': No such file or directory
rm: cannot remove '/tmp/slurm-4283301/OUTPUT/SPOT2/2008/7/9/SPOT2-HRV2-XS_20080709-102352-227_L1C_047-256-0_C_V1-0/31TGM/FSC_20080709T102352_SPOT2_31TGM/xs3.tif': No such file or directory
rm: cannot remove '/tmp/slurm-4283301/OUTPUT/SPOT2/2008/7/9/SPOT2-HRV2-XS_20080709-102352-227_L1C_047-256-0_C_V1-0/31TGM/FSC_20080709T102352_SPOT2_31TGM/hill.tif': No such file or directory
rm: cannot remove '/tmp/slurm-4283301/OUTPUT/SPOT2/2008/7/9/SPOT2-HRV2-XS_20080709-102352-227_L1C_047-256-0_C_V1-0/31TGM/FSC_20080709T102352_SPOT2_31TGM/dem.tif': No such file or directory
ERROR 4: /tmp/slurm-4283301/OUTPUT/SPOT2/2008/7/9/SPOT2-HRV2-XS_20080709-102352-227_L1C_047-256-0_C_V1-0/31TGM/FSC_20080709T102352_SPOT2_31TGM/merged.tif: No such file or directory
2024-01-15T14:19:11.980    ERROR:run_snow_swh.py::main:'NoneType' object has no attribute 'ReadAsArray'
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080709-102352-227_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
muscate/SPOTWORLDHERITAGE/2008/07/09/SPOT2-HRV2-XS_20080709-102400-463_L1C_047-257-0_D_V1-0/SPOT2-HRV2-XS_20080709-102400-463_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080709-102400-463_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080709-102400-463_L1C_047-257-0_D_V1-0.zip
run script
2024-01-15T14:19:15.592    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:19:15.593    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080709-102400-463_L1C_047-257-0_D_V1-0.zip
2024-01-15T14:19:15.593    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:19:15.593    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:19:15.593    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:19:15.593    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:19:15.593    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:19:15.593    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:19:15.593    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:19:15.593    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080709-102400-463_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/07/09/SPOT2-HRV2-XS_20080709-102401-366_L1C_047-257-1_D_V1-0/SPOT2-HRV2-XS_20080709-102401-366_L1C_047-257-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080709-102401-366_L1C_047-257-1_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080709-102401-366_L1C_047-257-1_D_V1-0.zip
run script
2024-01-15T14:19:19.264    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:19:19.265    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080709-102401-366_L1C_047-257-1_D_V1-0.zip
2024-01-15T14:19:19.265    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:19:19.265    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:19:19.265    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:19:19.266    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:19:19.266    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:19:19.266    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:19:19.266    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:19:19.266    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080709-102401-366_L1C_047-257-1_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/07/09/SPOT2-HRV1-XS_20080709-102333-454_L1C_049-254-0_D_V1-0/SPOT2-HRV1-XS_20080709-102333-454_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080709-102333-454_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080709-102333-454_L1C_049-254-0_D_V1-0.zip
run script
2024-01-15T14:19:22.584    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:19:22.584    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080709-102333-454_L1C_049-254-0_D_V1-0.zip
2024-01-15T14:19:22.584    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:19:22.584    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:19:22.584    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:19:22.584    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:19:22.585    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:19:22.585    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:19:22.585    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:19:22.585    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080709-102333-454_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/07/09/SPOT2-HRV1-XS_20080709-102341-687_L1C_049-255-0_D_V1-0/SPOT2-HRV1-XS_20080709-102341-687_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080709-102341-687_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080709-102341-687_L1C_049-255-0_D_V1-0.zip
run script
2024-01-15T14:19:26.462    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:19:26.463    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080709-102341-687_L1C_049-255-0_D_V1-0.zip
2024-01-15T14:19:26.463    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:19:26.463    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:19:26.463    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:19:26.463    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:19:26.463    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:19:26.463    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:19:26.464    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:19:26.464    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080709-102341-687_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/07/09/SPOT2-HRV1-XS_20080709-102349-932_L1C_049-256-0_D_V1-0/SPOT2-HRV1-XS_20080709-102349-932_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080709-102349-932_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080709-102349-932_L1C_049-256-0_D_V1-0.zip
run script
2024-01-15T14:20:14.309    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:20:14.311    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080709-102349-932_L1C_049-256-0_D_V1-0.zip
2024-01-15T14:20:14.311    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:20:14.311    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:20:14.311    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:20:14.311    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:20:14.311    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:20:14.311    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:20:14.311    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:20:14.311    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080709-102349-932_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/07/09/SPOT2-HRV1-XS_20080709-102358-186_L1C_049-257-0_D_V1-0/SPOT2-HRV1-XS_20080709-102358-186_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080709-102358-186_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080709-102358-186_L1C_049-257-0_D_V1-0.zip
run script
2024-01-15T14:22:26.364    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:22:26.365    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080709-102358-186_L1C_049-257-0_D_V1-0.zip
2024-01-15T14:22:26.365    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:22:26.365    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:22:26.365    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:22:26.365    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:22:26.365    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:22:26.365    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:22:26.365    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:22:26.365    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080709-102358-186_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/07/09/SPOT2-HRV1-XS_20080709-102401-796_L1C_049-257-4_D_V1-0/SPOT2-HRV1-XS_20080709-102401-796_L1C_049-257-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080709-102401-796_L1C_049-257-4_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080709-102401-796_L1C_049-257-4_D_V1-0.zip
run script
2024-01-15T14:24:27.574    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:24:27.575    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080709-102401-796_L1C_049-257-4_D_V1-0.zip
2024-01-15T14:24:27.576    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:24:27.576    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:24:27.576    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:24:27.576    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:24:27.576    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:24:27.576    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:24:27.576    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:24:27.576    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080709-102401-796_L1C_049-257-4_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/07/09/SPOT2-HRV2-XS_20080709-102418-977_L1C_049-259-4_D_V1-0/SPOT2-HRV2-XS_20080709-102418-977_L1C_049-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080709-102418-977_L1C_049-259-4_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080709-102418-977_L1C_049-259-4_D_V1-0.zip
run script
2024-01-15T14:26:10.220    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:26:10.221    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080709-102418-977_L1C_049-259-4_D_V1-0.zip
2024-01-15T14:26:10.221    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:26:10.221    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:26:10.221    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:26:10.221    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:26:10.221    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:26:10.221    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:26:10.221    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:26:10.222    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080709-102418-977_L1C_049-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/07/09/SPOT2-HRV2-XS_20080709-102423-643_L1C_049-260-0_D_V1-0/SPOT2-HRV2-XS_20080709-102423-643_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080709-102423-643_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080709-102423-643_L1C_049-260-0_D_V1-0.zip
run script
2024-01-15T14:26:42.750    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:26:42.751    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080709-102423-643_L1C_049-260-0_D_V1-0.zip
2024-01-15T14:26:42.751    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:26:42.751    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:26:42.751    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:26:42.751    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:26:42.751    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:26:42.751    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:26:42.751    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:26:42.752    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080709-102423-643_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/07/09/SPOT2-HRV2-XS_20080709-102431-924_L1C_049-261-0_D_V1-0/SPOT2-HRV2-XS_20080709-102431-924_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080709-102431-924_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080709-102431-924_L1C_049-261-0_D_V1-0.zip
run script
2024-01-15T14:27:00.217    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:27:00.218    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080709-102431-924_L1C_049-261-0_D_V1-0.zip
2024-01-15T14:27:00.218    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:27:00.218    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:27:00.218    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:27:00.218    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:27:00.219    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:27:00.219    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:27:00.219    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:27:00.219    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-15T14:27:02.026    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1098 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080709-102431-924_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2008/07/09/SPOT2-HRV2-XS_20080709-102440-214_L1C_049-262-0_D_V1-0/SPOT2-HRV2-XS_20080709-102440-214_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080709-102440-214_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080709-102440-214_L1C_049-262-0_D_V1-0.zip
run script
2024-01-15T14:27:05.575    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:27:05.576    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080709-102440-214_L1C_049-262-0_D_V1-0.zip
2024-01-15T14:27:05.576    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:27:05.576    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:27:05.576    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:27:05.576    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:27:05.576    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:27:05.576    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:27:05.576    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:27:05.577    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080709-102440-214_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/07/09/SPOT2-HRV1-XS_20080709-102426-648_L1C_054-261-0_D_V1-0/SPOT2-HRV1-XS_20080709-102426-648_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080709-102426-648_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080709-102426-648_L1C_054-261-0_D_V1-0.zip
run script
2024-01-15T14:27:08.970    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:27:08.971    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080709-102426-648_L1C_054-261-0_D_V1-0.zip
2024-01-15T14:27:08.971    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:27:08.972    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:27:08.972    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:27:08.972    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:27:08.972    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:27:08.972    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:27:08.972    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:27:08.972    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080709-102426-648_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/07/09/SPOT2-HRV1-XS_20080709-102434-980_L1C_054-262-0_D_V1-0/SPOT2-HRV1-XS_20080709-102434-980_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080709-102434-980_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080709-102434-980_L1C_054-262-0_D_V1-0.zip
run script
2024-01-15T14:29:08.297    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:29:08.299    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080709-102434-980_L1C_054-262-0_D_V1-0.zip
2024-01-15T14:29:08.299    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:29:08.299    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:29:08.299    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:29:08.299    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:29:08.299    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:29:08.299    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:29:08.299    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:29:08.299    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080709-102434-980_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/07/14/SPOT2-HRV2-XS_20080714-102726-303_L1C_047-255-0_D_V1-0/SPOT2-HRV2-XS_20080714-102726-303_L1C_047-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080714-102726-303_L1C_047-255-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080714-102726-303_L1C_047-255-0_D_V1-0.zip
run script
2024-01-15T14:31:12.317    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:31:12.319    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080714-102726-303_L1C_047-255-0_D_V1-0.zip
2024-01-15T14:31:12.319    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:31:12.319    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:31:12.319    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:31:12.319    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:31:12.319    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:31:12.319    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:31:12.319    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:31:12.319    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080714-102726-303_L1C_047-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/07/14/SPOT2-HRV2-XS_20080714-102734-544_L1C_047-256-0_D_V1-0/SPOT2-HRV2-XS_20080714-102734-544_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080714-102734-544_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080714-102734-544_L1C_047-256-0_D_V1-0.zip
run script
2024-01-15T14:31:21.758    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:31:21.760    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080714-102734-544_L1C_047-256-0_D_V1-0.zip
2024-01-15T14:31:21.760    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:31:21.760    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:31:21.760    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:31:21.760    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:31:21.760    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:31:21.760    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:31:21.760    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:31:21.761    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080714-102734-544_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/07/14/SPOT2-HRV2-XS_20080714-102738-154_L1C_047-256-4_D_V1-0/SPOT2-HRV2-XS_20080714-102738-154_L1C_047-256-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080714-102738-154_L1C_047-256-4_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080714-102738-154_L1C_047-256-4_D_V1-0.zip
run script
2024-01-15T14:31:25.354    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:31:25.354    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080714-102738-154_L1C_047-256-4_D_V1-0.zip
2024-01-15T14:31:25.354    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:31:25.354    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:31:25.355    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:31:25.355    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:31:25.355    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:31:25.355    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:31:25.355    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:31:25.355    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080714-102738-154_L1C_047-256-4_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/07/14/SPOT2-HRV1-XS_20080714-102738-515_L1C_049-256-7_D_V1-0/SPOT2-HRV1-XS_20080714-102738-515_L1C_049-256-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080714-102738-515_L1C_049-256-7_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080714-102738-515_L1C_049-256-7_D_V1-0.zip
run script
2024-01-15T14:31:29.511    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:31:29.512    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080714-102738-515_L1C_049-256-7_D_V1-0.zip
2024-01-15T14:31:29.512    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:31:29.512    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:31:29.512    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:31:29.512    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:31:29.512    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:31:29.512    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:31:29.513    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:31:29.513    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080714-102738-515_L1C_049-256-7_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/07/14/SPOT2-HRV1-XS_20080714-102754-788_L1C_051-259-0_D_V1-0/SPOT2-HRV1-XS_20080714-102754-788_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080714-102754-788_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080714-102754-788_L1C_051-259-0_D_V1-0.zip
run script
2024-01-15T14:33:22.273    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:33:22.274    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080714-102754-788_L1C_051-259-0_D_V1-0.zip
2024-01-15T14:33:22.274    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:33:22.274    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:33:22.274    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:33:22.274    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:33:22.274    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:33:22.275    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:33:22.275    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:33:22.275    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080714-102754-788_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/07/14/SPOT2-HRV1-XS_20080714-102803-102_L1C_051-260-0_D_V1-0/SPOT2-HRV1-XS_20080714-102803-102_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080714-102803-102_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080714-102803-102_L1C_051-260-0_D_V1-0.zip
run script
2024-01-15T14:36:11.570    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:36:11.571    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080714-102803-102_L1C_051-260-0_D_V1-0.zip
2024-01-15T14:36:11.572    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:36:11.572    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:36:11.572    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:36:11.572    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:36:11.572    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:36:11.572    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:36:11.572    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:36:11.572    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080714-102803-102_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/07/14/SPOT2-HRV1-XS_20080714-102804-907_L1C_051-260-2_D_V1-0/SPOT2-HRV1-XS_20080714-102804-907_L1C_051-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080714-102804-907_L1C_051-260-2_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080714-102804-907_L1C_051-260-2_D_V1-0.zip
run script
2024-01-15T14:38:21.759    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:38:21.760    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080714-102804-907_L1C_051-260-2_D_V1-0.zip
2024-01-15T14:38:21.760    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:38:21.760    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:38:21.760    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:38:21.760    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:38:21.761    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:38:21.761    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:38:21.761    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:38:21.761    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-15T14:38:23.311    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (0 x 3532). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080714-102804-907_L1C_051-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2008/07/14/SPOT2-HRV1-XS_20080714-102824-035_L1C_052-262-6_D_V1-0/SPOT2-HRV1-XS_20080714-102824-035_L1C_052-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080714-102824-035_L1C_052-262-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080714-102824-035_L1C_052-262-6_D_V1-0.zip
run script
2024-01-15T14:38:26.799    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:38:26.800    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080714-102824-035_L1C_052-262-6_D_V1-0.zip
2024-01-15T14:38:26.800    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:38:26.800    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:38:26.800    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:38:26.800    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:38:26.800    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:38:26.800    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:38:26.800    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:38:26.800    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080714-102824-035_L1C_052-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 0 0 ... 2 2 2]
 [1 0 0 ... 2 2 2]
 [1 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/10/25/SPOT2-HRV2-XS_20081025-104313-942_L1C_047-255-8_D_V1-0/SPOT2-HRV2-XS_20081025-104313-942_L1C_047-255-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081025-104313-942_L1C_047-255-8_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081025-104313-942_L1C_047-255-8_D_V1-0.zip
run script
2024-01-15T14:39:58.885    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:39:58.887    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081025-104313-942_L1C_047-255-8_D_V1-0.zip
2024-01-15T14:39:58.887    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:39:58.887    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:39:58.887    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:39:58.887    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:39:58.887    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:39:58.887    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:39:58.887    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:39:58.887    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081025-104313-942_L1C_047-255-8_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/10/25/SPOT2-HRV2-XS_20081025-104315-085_L1C_047-256-0_D_V1-0/SPOT2-HRV2-XS_20081025-104315-085_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081025-104315-085_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081025-104315-085_L1C_047-256-0_D_V1-0.zip
run script
2024-01-15T14:40:02.111    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:40:02.111    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081025-104315-085_L1C_047-256-0_D_V1-0.zip
2024-01-15T14:40:02.111    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:40:02.111    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:40:02.111    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:40:02.111    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:40:02.111    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:40:02.112    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:40:02.112    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:40:02.112    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081025-104315-085_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/10/25/SPOT2-HRV2-XS_20081025-104323-453_L1C_047-257-0_D_V1-0/SPOT2-HRV2-XS_20081025-104323-453_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081025-104323-453_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081025-104323-453_L1C_047-257-0_D_V1-0.zip
run script
2024-01-15T14:40:05.902    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:40:05.902    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081025-104323-453_L1C_047-257-0_D_V1-0.zip
2024-01-15T14:40:05.902    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:40:05.902    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:40:05.902    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:40:05.902    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:40:05.903    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:40:05.903    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:40:05.903    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:40:05.903    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081025-104323-453_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/10/25/SPOT2-HRV2-XS_20081025-104340-815_L1C_049-259-4_D_V1-0/SPOT2-HRV2-XS_20081025-104340-815_L1C_049-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081025-104340-815_L1C_049-259-4_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081025-104340-815_L1C_049-259-4_D_V1-0.zip
run script
2024-01-15T14:40:09.419    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:40:09.421    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081025-104340-815_L1C_049-259-4_D_V1-0.zip
2024-01-15T14:40:09.421    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:40:09.421    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:40:09.421    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:40:09.421    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:40:09.421    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:40:09.421    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:40:09.422    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:40:09.422    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081025-104340-815_L1C_049-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/10/25/SPOT2-HRV2-XS_20081025-104345-622_L1C_049-260-0_D_V1-0/SPOT2-HRV2-XS_20081025-104345-622_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081025-104345-622_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081025-104345-622_L1C_049-260-0_D_V1-0.zip
run script
2024-01-15T14:40:53.426    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:40:53.427    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081025-104345-622_L1C_049-260-0_D_V1-0.zip
2024-01-15T14:40:53.427    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:40:53.427    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:40:53.427    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:40:53.427    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:40:53.427    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:40:53.427    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:40:53.427    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:40:53.427    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081025-104345-622_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/10/25/SPOT2-HRV2-XS_20081025-104352-841_L1C_049-260-8_D_V1-0/SPOT2-HRV2-XS_20081025-104352-841_L1C_049-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081025-104352-841_L1C_049-260-8_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081025-104352-841_L1C_049-260-8_D_V1-0.zip
run script
2024-01-15T14:41:20.691    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:41:20.692    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081025-104352-841_L1C_049-260-8_D_V1-0.zip
2024-01-15T14:41:20.692    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:41:20.692    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:41:20.692    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:41:20.692    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:41:20.692    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:41:20.693    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:41:20.693    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:41:20.693    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081025-104352-841_L1C_049-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/12/12/SPOT2-HRV2-XS_20081212-101920-103_L1C_047-255-9_D_V1-0/SPOT2-HRV2-XS_20081212-101920-103_L1C_047-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081212-101920-103_L1C_047-255-9_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081212-101920-103_L1C_047-255-9_D_V1-0.zip
run script
2024-01-15T14:41:30.344    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:41:30.345    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081212-101920-103_L1C_047-255-9_D_V1-0.zip
2024-01-15T14:41:30.345    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:41:30.345    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:41:30.345    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:41:30.345    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:41:30.345    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:41:30.345    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:41:30.345    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:41:30.346    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081212-101920-103_L1C_047-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/12/12/SPOT2-HRV2-XS_20081212-101920-211_L1C_048-256-0_D_V1-0/SPOT2-HRV2-XS_20081212-101920-211_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081212-101920-211_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081212-101920-211_L1C_048-256-0_D_V1-0.zip
run script
2024-01-15T14:41:48.807    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:41:48.808    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081212-101920-211_L1C_048-256-0_D_V1-0.zip
2024-01-15T14:41:48.808    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:41:48.808    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:41:48.809    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:41:48.809    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:41:48.809    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:41:48.809    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:41:48.809    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:41:48.809    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081212-101920-211_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/12/12/SPOT2-HRV2-XS_20081212-101928-453_L1C_048-257-0_D_V1-0/SPOT2-HRV2-XS_20081212-101928-453_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081212-101928-453_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081212-101928-453_L1C_048-257-0_D_V1-0.zip
run script
2024-01-15T14:42:07.282    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:42:07.283    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081212-101928-453_L1C_048-257-0_D_V1-0.zip
2024-01-15T14:42:07.283    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:42:07.283    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:42:07.283    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:42:07.283    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:42:07.283    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:42:07.283    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:42:07.283    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:42:07.283    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-15T14:42:08.876    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (382 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081212-101928-453_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2008/12/12/SPOT2-HRV2-XS_20081212-101930-258_L1C_048-257-2_D_V1-0/SPOT2-HRV2-XS_20081212-101930-258_L1C_048-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081212-101930-258_L1C_048-257-2_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081212-101930-258_L1C_048-257-2_D_V1-0.zip
run script
2024-01-15T14:42:12.438    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:42:12.440    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081212-101930-258_L1C_048-257-2_D_V1-0.zip
2024-01-15T14:42:12.440    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:42:12.440    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:42:12.440    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:42:12.440    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:42:12.440    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:42:12.440    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:42:12.440    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:42:12.440    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081212-101930-258_L1C_048-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/12/12/SPOT2-HRV2-XS_20081212-101948-372_L1C_052-260-0_D_V1-0/SPOT2-HRV2-XS_20081212-101948-372_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081212-101948-372_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081212-101948-372_L1C_052-260-0_D_V1-0.zip
run script
2024-01-15T14:42:16.052    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:42:16.053    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081212-101948-372_L1C_052-260-0_D_V1-0.zip
2024-01-15T14:42:16.053    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:42:16.053    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:42:16.053    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:42:16.053    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:42:16.053    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:42:16.053    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:42:16.053    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:42:16.053    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081212-101948-372_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/12/12/SPOT2-HRV2-XS_20081212-101956-686_L1C_052-261-0_D_V1-0/SPOT2-HRV2-XS_20081212-101956-686_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081212-101956-686_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081212-101956-686_L1C_052-261-0_D_V1-0.zip
run script
2024-01-15T14:44:39.944    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:44:39.945    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081212-101956-686_L1C_052-261-0_D_V1-0.zip
2024-01-15T14:44:39.945    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:44:39.946    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:44:39.946    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:44:39.946    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:44:39.946    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:44:39.946    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:44:39.946    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:44:39.946    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081212-101956-686_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 1 ... 2 2 2]
 [0 1 1 ... 2 2 2]
 [0 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/12/12/SPOT2-HRV2-XS_20081212-102005-007_L1C_052-262-0_D_V1-0/SPOT2-HRV2-XS_20081212-102005-007_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081212-102005-007_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081212-102005-007_L1C_052-262-0_D_V1-0.zip
run script
2024-01-15T14:47:14.229    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:47:14.230    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081212-102005-007_L1C_052-262-0_D_V1-0.zip
2024-01-15T14:47:14.230    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:47:14.230    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:47:14.230    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:47:14.230    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:47:14.230    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:47:14.231    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:47:14.231    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:47:14.231    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081212-102005-007_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/12/27/SPOT2-HRV2-XS_20081227-103041-867_L1C_047-255-9_D_V1-0/SPOT2-HRV2-XS_20081227-103041-867_L1C_047-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081227-103041-867_L1C_047-255-9_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081227-103041-867_L1C_047-255-9_D_V1-0.zip
run script
2024-01-15T14:49:23.355    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:49:23.356    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081227-103041-867_L1C_047-255-9_D_V1-0.zip
2024-01-15T14:49:23.356    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:49:23.356    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:49:23.356    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:49:23.356    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:49:23.356    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:49:23.356    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:49:23.356    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:49:23.357    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081227-103041-867_L1C_047-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/12/27/SPOT2-HRV2-XS_20081227-103042-036_L1C_047-256-0_D_V1-0/SPOT2-HRV2-XS_20081227-103042-036_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081227-103042-036_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081227-103042-036_L1C_047-256-0_D_V1-0.zip
run script
2024-01-15T14:49:34.918    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:49:34.920    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081227-103042-036_L1C_047-256-0_D_V1-0.zip
2024-01-15T14:49:34.920    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:49:34.920    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:49:34.920    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:49:34.920    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:49:34.920    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:49:34.920    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:49:34.920    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:49:34.920    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081227-103042-036_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/12/27/SPOT2-HRV2-XS_20081227-103050-332_L1C_047-257-0_D_V1-0/SPOT2-HRV2-XS_20081227-103050-332_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081227-103050-332_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081227-103050-332_L1C_047-257-0_D_V1-0.zip
run script
2024-01-15T14:49:46.068    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:49:46.070    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081227-103050-332_L1C_047-257-0_D_V1-0.zip
2024-01-15T14:49:46.070    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:49:46.070    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:49:46.070    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:49:46.070    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:49:46.070    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:49:46.070    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:49:46.070    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:49:46.070    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081227-103050-332_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/12/27/SPOT2-HRV2-XS_20081227-103056-649_L1C_047-257-7_D_V1-0/SPOT2-HRV2-XS_20081227-103056-649_L1C_047-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081227-103056-649_L1C_047-257-7_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081227-103056-649_L1C_047-257-7_D_V1-0.zip
run script
2024-01-15T14:49:49.264    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:49:49.264    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081227-103056-649_L1C_047-257-7_D_V1-0.zip
2024-01-15T14:49:49.265    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:49:49.265    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:49:49.265    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:49:49.265    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:49:49.265    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:49:49.265    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:49:49.265    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:49:49.265    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081227-103056-649_L1C_047-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/12/27/SPOT2-HRV2-XS_20081227-103023-287_L1C_049-254-0_D_V1-0/SPOT2-HRV2-XS_20081227-103023-287_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081227-103023-287_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081227-103023-287_L1C_049-254-0_D_V1-0.zip
run script
2024-01-15T14:49:52.606    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:49:52.606    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081227-103023-287_L1C_049-254-0_D_V1-0.zip
2024-01-15T14:49:52.606    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:49:52.606    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:49:52.606    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:49:52.606    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:49:52.606    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:49:52.606    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:49:52.606    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:49:52.606    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081227-103023-287_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/12/27/SPOT2-HRV2-XS_20081227-103025-092_L1C_049-254-2_D_V1-0/SPOT2-HRV2-XS_20081227-103025-092_L1C_049-254-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081227-103025-092_L1C_049-254-2_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081227-103025-092_L1C_049-254-2_D_V1-0.zip
run script
2024-01-15T14:49:55.891    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:49:55.893    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081227-103025-092_L1C_049-254-2_D_V1-0.zip
2024-01-15T14:49:55.893    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:49:55.893    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:49:55.893    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:49:55.893    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:49:55.893    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:49:55.893    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:49:55.893    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:49:55.893    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081227-103025-092_L1C_049-254-2_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/06/28/SPOT2-HRV1-XS_20080628-103549-135_L1C_047-256-0_D_V1-0/SPOT2-HRV1-XS_20080628-103549-135_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080628-103549-135_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080628-103549-135_L1C_047-256-0_D_V1-0.zip
run script
2024-01-15T14:49:59.484    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:49:59.485    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080628-103549-135_L1C_047-256-0_D_V1-0.zip
2024-01-15T14:49:59.485    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:49:59.485    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:49:59.486    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:49:59.486    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:49:59.486    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:49:59.486    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:49:59.486    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:49:59.486    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080628-103549-135_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/06/28/SPOT2-HRV2-XS_20080628-103530-257_L1C_049-254-0_D_V1-0/SPOT2-HRV2-XS_20080628-103530-257_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080628-103530-257_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080628-103530-257_L1C_049-254-0_D_V1-0.zip
run script
2024-01-15T14:50:02.791    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:50:02.791    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080628-103530-257_L1C_049-254-0_D_V1-0.zip
2024-01-15T14:50:02.792    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:50:02.792    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:50:02.792    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:50:02.792    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:50:02.792    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:50:02.792    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:50:02.792    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:50:02.792    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080628-103530-257_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/06/28/SPOT2-HRV2-XS_20080628-103538-553_L1C_049-255-0_D_V1-0/SPOT2-HRV2-XS_20080628-103538-553_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080628-103538-553_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080628-103538-553_L1C_049-255-0_D_V1-0.zip
run script
2024-01-15T14:50:06.039    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:50:06.039    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080628-103538-553_L1C_049-255-0_D_V1-0.zip
2024-01-15T14:50:06.039    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:50:06.039    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:50:06.039    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:50:06.039    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:50:06.040    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:50:06.040    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:50:06.040    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:50:06.040    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080628-103538-553_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/06/28/SPOT2-HRV2-XS_20080628-103546-858_L1C_049-256-0_D_V1-0/SPOT2-HRV2-XS_20080628-103546-858_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080628-103546-858_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080628-103546-858_L1C_049-256-0_D_V1-0.zip
run script
2024-01-15T14:50:46.013    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:50:46.014    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080628-103546-858_L1C_049-256-0_D_V1-0.zip
2024-01-15T14:50:46.014    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:50:46.014    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:50:46.014    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:50:46.014    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:50:46.014    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:50:46.014    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:50:46.014    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:50:46.014    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-15T14:52:06.572    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (209 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080628-103546-858_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2008/06/28/SPOT2-HRV2-XS_20080628-103555-169_L1C_049-257-0_D_V1-0/SPOT2-HRV2-XS_20080628-103555-169_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080628-103555-169_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080628-103555-169_L1C_049-257-0_D_V1-0.zip
run script
2024-01-15T14:52:10.059    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:52:10.059    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080628-103555-169_L1C_049-257-0_D_V1-0.zip
2024-01-15T14:52:10.059    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:52:10.059    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:52:10.059    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:52:10.059    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:52:10.059    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:52:10.059    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:52:10.059    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:52:10.059    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080628-103555-169_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/06/28/SPOT2-HRV2-XS_20080628-103601-486_L1C_049-257-7_D_V1-0/SPOT2-HRV2-XS_20080628-103601-486_L1C_049-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080628-103601-486_L1C_049-257-7_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080628-103601-486_L1C_049-257-7_D_V1-0.zip
run script
2024-01-15T14:53:20.459    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:53:20.460    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080628-103601-486_L1C_049-257-7_D_V1-0.zip
2024-01-15T14:53:20.461    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:53:20.461    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:53:20.461    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:53:20.461    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:53:20.461    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:53:20.461    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:53:20.461    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:53:20.461    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080628-103601-486_L1C_049-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/07/19/SPOT2-HRV2-XS_20080719-103117-013_L1C_047-256-0_D_V1-0/SPOT2-HRV2-XS_20080719-103117-013_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080719-103117-013_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080719-103117-013_L1C_047-256-0_D_V1-0.zip
run script
2024-01-15T14:54:16.744    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:54:16.745    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080719-103117-013_L1C_047-256-0_D_V1-0.zip
2024-01-15T14:54:16.745    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:54:16.745    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:54:16.745    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:54:16.745    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:54:16.745    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:54:16.745    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:54:16.745    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:54:16.745    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080719-103117-013_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/07/19/SPOT2-HRV1-XS_20080719-103106-313_L1C_049-255-0_D_V1-0/SPOT2-HRV1-XS_20080719-103106-313_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080719-103106-313_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080719-103106-313_L1C_049-255-0_D_V1-0.zip
run script
2024-01-15T14:54:19.914    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:54:19.914    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080719-103106-313_L1C_049-255-0_D_V1-0.zip
2024-01-15T14:54:19.914    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:54:19.914    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:54:19.914    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:54:19.914    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:54:19.915    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:54:19.915    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:54:19.915    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:54:19.915    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080719-103106-313_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/07/19/SPOT2-HRV1-XS_20080719-103114-594_L1C_049-256-0_D_V1-0/SPOT2-HRV1-XS_20080719-103114-594_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080719-103114-594_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080719-103114-594_L1C_049-256-0_D_V1-0.zip
run script
2024-01-15T14:55:00.410    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:55:00.411    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080719-103114-594_L1C_049-256-0_D_V1-0.zip
2024-01-15T14:55:00.411    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:55:00.411    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:55:00.411    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:55:00.411    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:55:00.411    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:55:00.412    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:55:00.412    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:55:00.412    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080719-103114-594_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/07/19/SPOT2-HRV1-XS_20080719-103122-882_L1C_049-257-0_D_V1-0/SPOT2-HRV1-XS_20080719-103122-882_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080719-103122-882_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080719-103122-882_L1C_049-257-0_D_V1-0.zip
run script
2024-01-15T14:56:38.984    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:56:38.985    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080719-103122-882_L1C_049-257-0_D_V1-0.zip
2024-01-15T14:56:38.985    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:56:38.985    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:56:38.985    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:56:38.985    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:56:38.985    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:56:38.985    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:56:38.985    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:56:38.985    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080719-103122-882_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/07/19/SPOT2-HRV1-XS_20080719-103131-181_L1C_049-258-0_D_V1-0/SPOT2-HRV1-XS_20080719-103131-181_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080719-103131-181_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080719-103131-181_L1C_049-258-0_D_V1-0.zip
run script
2024-01-15T14:57:58.025    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:57:58.026    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080719-103131-181_L1C_049-258-0_D_V1-0.zip
2024-01-15T14:57:58.026    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:57:58.026    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:57:58.026    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:57:58.026    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:57:58.026    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:57:58.027    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:57:58.027    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:57:58.027    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080719-103131-181_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/07/19/SPOT2-HRV1-XS_20080719-103136-595_L1C_049-258-6_D_V1-0/SPOT2-HRV1-XS_20080719-103136-595_L1C_049-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080719-103136-595_L1C_049-258-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080719-103136-595_L1C_049-258-6_D_V1-0.zip
run script
2024-01-15T14:58:54.782    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:58:54.783    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080719-103136-595_L1C_049-258-6_D_V1-0.zip
2024-01-15T14:58:54.783    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:58:54.783    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:58:54.783    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:58:54.783    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:58:54.783    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:58:54.783    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:58:54.783    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:58:54.783    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080719-103136-595_L1C_049-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/11/15/SPOT2-HRV2-XS_20081115-103902-370_L1C_047-256-8_D_V1-0/SPOT2-HRV2-XS_20081115-103902-370_L1C_047-256-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081115-103902-370_L1C_047-256-8_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081115-103902-370_L1C_047-256-8_D_V1-0.zip
run script
2024-01-15T14:59:46.286    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:59:46.287    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081115-103902-370_L1C_047-256-8_D_V1-0.zip
2024-01-15T14:59:46.287    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:59:46.287    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:59:46.287    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:59:46.287    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:59:46.287    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:59:46.287    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:59:46.287    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:59:46.287    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081115-103902-370_L1C_047-256-8_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/11/15/SPOT2-HRV2-XS_20081115-103903-495_L1C_047-257-0_D_V1-0/SPOT2-HRV2-XS_20081115-103903-495_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081115-103903-495_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081115-103903-495_L1C_047-257-0_D_V1-0.zip
run script
2024-01-15T14:59:49.643    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:59:49.643    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081115-103903-495_L1C_047-257-0_D_V1-0.zip
2024-01-15T14:59:49.644    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:59:49.644    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:59:49.644    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:59:49.644    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:59:49.644    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:59:49.644    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:59:49.644    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:59:49.644    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081115-103903-495_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/11/15/SPOT2-HRV2-XS_20081115-103911-848_L1C_047-258-0_D_V1-0/SPOT2-HRV2-XS_20081115-103911-848_L1C_047-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081115-103911-848_L1C_047-258-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081115-103911-848_L1C_047-258-0_D_V1-0.zip
run script
2024-01-15T14:59:53.012    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:59:53.012    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081115-103911-848_L1C_047-258-0_D_V1-0.zip
2024-01-15T14:59:53.012    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:59:53.013    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:59:53.013    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:59:53.013    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:59:53.013    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:59:53.013    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:59:53.013    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:59:53.013    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081115-103911-848_L1C_047-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/11/15/SPOT2-HRV2-XS_20081115-103916-360_L1C_047-258-5_D_V1-0/SPOT2-HRV2-XS_20081115-103916-360_L1C_047-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081115-103916-360_L1C_047-258-5_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081115-103916-360_L1C_047-258-5_D_V1-0.zip
run script
2024-01-15T14:59:56.050    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:59:56.051    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081115-103916-360_L1C_047-258-5_D_V1-0.zip
2024-01-15T14:59:56.051    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:59:56.051    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:59:56.052    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:59:56.052    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:59:56.052    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:59:56.052    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:59:56.052    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:59:56.052    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081115-103916-360_L1C_047-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/11/15/SPOT2-HRV2-XS_20081115-103843-534_L1C_049-254-8_D_V1-0/SPOT2-HRV2-XS_20081115-103843-534_L1C_049-254-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081115-103843-534_L1C_049-254-8_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081115-103843-534_L1C_049-254-8_D_V1-0.zip
run script
2024-01-15T14:59:59.065    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T14:59:59.066    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081115-103843-534_L1C_049-254-8_D_V1-0.zip
2024-01-15T14:59:59.066    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T14:59:59.066    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T14:59:59.066    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T14:59:59.066    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T14:59:59.066    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T14:59:59.067    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T14:59:59.067    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T14:59:59.067    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081115-103843-534_L1C_049-254-8_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/11/15/SPOT2-HRV2-XS_20081115-103844-671_L1C_049-255-0_D_V1-0/SPOT2-HRV2-XS_20081115-103844-671_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081115-103844-671_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081115-103844-671_L1C_049-255-0_D_V1-0.zip
run script
2024-01-15T15:00:30.484    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:00:30.485    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081115-103844-671_L1C_049-255-0_D_V1-0.zip
2024-01-15T15:00:30.485    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:00:30.485    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:00:30.485    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:00:30.485    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:00:30.485    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:00:30.485    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:00:30.485    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:00:30.485    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081115-103844-671_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/11/15/SPOT2-HRV2-XS_20081115-103845-573_L1C_049-255-1_D_V1-0/SPOT2-HRV2-XS_20081115-103845-573_L1C_049-255-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081115-103845-573_L1C_049-255-1_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081115-103845-573_L1C_049-255-1_D_V1-0.zip
run script
2024-01-15T15:01:14.461    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:01:14.462    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081115-103845-573_L1C_049-255-1_D_V1-0.zip
2024-01-15T15:01:14.462    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:01:14.462    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:01:14.462    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:01:14.462    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:01:14.462    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:01:14.462    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:01:14.462    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:01:14.463    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081115-103845-573_L1C_049-255-1_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/12/28/SPOT2-HRV1-XS_20081228-101127-651_L1C_047-256-7_D_V1-0/SPOT2-HRV1-XS_20081228-101127-651_L1C_047-256-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20081228-101127-651_L1C_047-256-7_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081228-101127-651_L1C_047-256-7_D_V1-0.zip
run script
2024-01-15T15:02:06.237    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:02:06.238    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081228-101127-651_L1C_047-256-7_D_V1-0.zip
2024-01-15T15:02:06.238    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:02:06.238    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:02:06.239    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:02:06.239    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:02:06.239    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:02:06.239    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:02:06.239    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:02:06.239    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081228-101127-651_L1C_047-256-7_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/12/28/SPOT2-HRV1-XS_20081228-101129-549_L1C_047-257-0_D_V1-0/SPOT2-HRV1-XS_20081228-101129-549_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20081228-101129-549_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081228-101129-549_L1C_047-257-0_D_V1-0.zip
run script
2024-01-15T15:02:09.591    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:02:09.591    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081228-101129-549_L1C_047-257-0_D_V1-0.zip
2024-01-15T15:02:09.591    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:02:09.591    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:02:09.592    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:02:09.592    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:02:09.592    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:02:09.592    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:02:09.592    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:02:09.592    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081228-101129-549_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/12/28/SPOT2-HRV1-XS_20081228-101137-770_L1C_047-258-0_D_V1-0/SPOT2-HRV1-XS_20081228-101137-770_L1C_047-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20081228-101137-770_L1C_047-258-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081228-101137-770_L1C_047-258-0_D_V1-0.zip
run script
2024-01-15T15:02:12.960    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:02:12.961    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081228-101137-770_L1C_047-258-0_D_V1-0.zip
2024-01-15T15:02:12.961    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:02:12.961    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:02:12.961    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:02:12.961    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:02:12.961    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:02:12.961    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:02:12.961    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:02:12.961    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081228-101137-770_L1C_047-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/12/28/SPOT2-HRV1-XS_20081228-101146-003_L1C_048-259-0_D_V1-0/SPOT2-HRV1-XS_20081228-101146-003_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20081228-101146-003_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081228-101146-003_L1C_048-259-0_D_V1-0.zip
run script
2024-01-15T15:02:16.305    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:02:16.306    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081228-101146-003_L1C_048-259-0_D_V1-0.zip
2024-01-15T15:02:16.306    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:02:16.306    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:02:16.307    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:02:16.307    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:02:16.307    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:02:16.307    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:02:16.307    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:02:16.307    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081228-101146-003_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/12/28/SPOT2-HRV1-XS_20081228-101154-245_L1C_048-260-0_D_V1-0/SPOT2-HRV1-XS_20081228-101154-245_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20081228-101154-245_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081228-101154-245_L1C_048-260-0_D_V1-0.zip
run script
2024-01-15T15:02:19.769    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:02:19.770    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081228-101154-245_L1C_048-260-0_D_V1-0.zip
2024-01-15T15:02:19.770    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:02:19.770    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:02:19.770    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:02:19.770    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:02:19.770    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:02:19.770    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:02:19.770    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:02:19.770    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081228-101154-245_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/12/28/SPOT2-HRV2-XS_20081228-101127-047_L1C_049-256-8_D_V1-0/SPOT2-HRV2-XS_20081228-101127-047_L1C_049-256-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081228-101127-047_L1C_049-256-8_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081228-101127-047_L1C_049-256-8_D_V1-0.zip
run script
2024-01-15T15:02:26.917    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:02:26.917    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081228-101127-047_L1C_049-256-8_D_V1-0.zip
2024-01-15T15:02:26.917    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:02:26.917    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:02:26.917    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:02:26.917    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:02:26.917    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:02:26.917    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:02:26.917    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:02:26.918    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081228-101127-047_L1C_049-256-8_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 0 0 ... 2 2 2]
 [1 0 0 ... 2 2 2]
 [1 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/12/28/SPOT2-HRV2-XS_20081228-101128-048_L1C_049-257-0_D_V1-0/SPOT2-HRV2-XS_20081228-101128-048_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081228-101128-048_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081228-101128-048_L1C_049-257-0_D_V1-0.zip
run script
2024-01-15T15:03:43.397    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:03:43.398    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081228-101128-048_L1C_049-257-0_D_V1-0.zip
2024-01-15T15:03:43.398    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:03:43.398    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:03:43.399    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:03:43.399    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:03:43.399    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:03:43.399    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:03:43.399    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:03:43.399    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081228-101128-048_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 0 0 ... 2 2 2]
 [1 0 0 ... 2 2 2]
 [1 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/12/28/SPOT2-HRV2-XS_20081228-101136-281_L1C_049-258-0_D_V1-0/SPOT2-HRV2-XS_20081228-101136-281_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081228-101136-281_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081228-101136-281_L1C_049-258-0_D_V1-0.zip
run script
2024-01-15T15:04:59.015    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:04:59.016    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081228-101136-281_L1C_049-258-0_D_V1-0.zip
2024-01-15T15:04:59.017    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:04:59.017    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:04:59.017    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:04:59.017    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:04:59.017    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:04:59.017    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:04:59.017    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:04:59.017    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081228-101136-281_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/12/28/SPOT2-HRV2-XS_20081228-101144-523_L1C_049-259-0_D_V1-0/SPOT2-HRV2-XS_20081228-101144-523_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081228-101144-523_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081228-101144-523_L1C_049-259-0_D_V1-0.zip
run script
2024-01-15T15:05:57.446    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:05:57.447    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081228-101144-523_L1C_049-259-0_D_V1-0.zip
2024-01-15T15:05:57.447    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:05:57.447    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:05:57.447    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:05:57.447    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:05:57.447    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:05:57.448    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:05:57.448    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:05:57.448    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081228-101144-523_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/12/28/SPOT2-HRV2-XS_20081228-101152-771_L1C_049-260-0_D_V1-0/SPOT2-HRV2-XS_20081228-101152-771_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081228-101152-771_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081228-101152-771_L1C_049-260-0_D_V1-0.zip
run script
2024-01-15T15:06:47.809    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:06:47.811    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081228-101152-771_L1C_049-260-0_D_V1-0.zip
2024-01-15T15:06:47.811    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:06:47.811    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:06:47.811    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:06:47.811    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:06:47.811    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:06:47.811    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:06:47.811    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:06:47.811    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081228-101152-771_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/12/28/SPOT2-HRV2-XS_20081228-101154-576_L1C_049-260-2_D_V1-0/SPOT2-HRV2-XS_20081228-101154-576_L1C_049-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081228-101154-576_L1C_049-260-2_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081228-101154-576_L1C_049-260-2_D_V1-0.zip
run script
2024-01-15T15:07:20.762    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:07:20.764    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081228-101154-576_L1C_049-260-2_D_V1-0.zip
2024-01-15T15:07:20.764    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:07:20.764    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:07:20.764    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:07:20.764    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:07:20.764    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:07:20.764    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:07:20.764    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:07:20.764    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-15T15:07:22.343    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 120). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081228-101154-576_L1C_049-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2008/12/28/SPOT2-HRV1-XS_20081228-101109-859_L1C_051-255-0_D_V1-0/SPOT2-HRV1-XS_20081228-101109-859_L1C_051-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20081228-101109-859_L1C_051-255-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081228-101109-859_L1C_051-255-0_D_V1-0.zip
run script
2024-01-15T15:07:25.468    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:07:25.468    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081228-101109-859_L1C_051-255-0_D_V1-0.zip
2024-01-15T15:07:25.468    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:07:25.468    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:07:25.468    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:07:25.468    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:07:25.468    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:07:25.468    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:07:25.468    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:07:25.469    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081228-101109-859_L1C_051-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 2 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/01/13/SPOT2-HRV1-XS_20080113-105228-104_L1C_047-257-0_D_V1-0/SPOT2-HRV1-XS_20080113-105228-104_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080113-105228-104_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080113-105228-104_L1C_047-257-0_D_V1-0.zip
run script
2024-01-15T15:08:14.935    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:08:14.936    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080113-105228-104_L1C_047-257-0_D_V1-0.zip
2024-01-15T15:08:14.936    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:08:14.936    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:08:14.936    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:08:14.936    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:08:14.937    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:08:14.937    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:08:14.937    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:08:14.937    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080113-105228-104_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/01/13/SPOT2-HRV1-XS_20080113-105233-518_L1C_047-257-6_D_V1-0/SPOT2-HRV1-XS_20080113-105233-518_L1C_047-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080113-105233-518_L1C_047-257-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080113-105233-518_L1C_047-257-6_D_V1-0.zip
run script
2024-01-15T15:08:18.109    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:08:18.109    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080113-105233-518_L1C_047-257-6_D_V1-0.zip
2024-01-15T15:08:18.109    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:08:18.109    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:08:18.109    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:08:18.109    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:08:18.110    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:08:18.110    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:08:18.110    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:08:18.110    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080113-105233-518_L1C_047-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/01/13/SPOT2-HRV1-XS_20080113-105213-157_L1C_048-255-2_D_V1-0/SPOT2-HRV1-XS_20080113-105213-157_L1C_048-255-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080113-105213-157_L1C_048-255-2_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080113-105213-157_L1C_048-255-2_D_V1-0.zip
run script
2024-01-15T15:08:21.204    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:08:21.204    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080113-105213-157_L1C_048-255-2_D_V1-0.zip
2024-01-15T15:08:21.204    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:08:21.204    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:08:21.204    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:08:21.205    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:08:21.205    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:08:21.205    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:08:21.205    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:08:21.205    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080113-105213-157_L1C_048-255-2_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/01/13/SPOT2-HRV1-XS_20080113-105219-727_L1C_048-256-0_D_V1-0/SPOT2-HRV1-XS_20080113-105219-727_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080113-105219-727_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080113-105219-727_L1C_048-256-0_D_V1-0.zip
run script
2024-01-15T15:08:40.330    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:08:40.331    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080113-105219-727_L1C_048-256-0_D_V1-0.zip
2024-01-15T15:08:40.331    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:08:40.331    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:08:40.331    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:08:40.331    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:08:40.332    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:08:40.332    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:08:40.332    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:08:40.332    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080113-105219-727_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/01/13/SPOT2-HRV2-XS_20080113-105222-518_L1C_051-257-0_D_V1-0/SPOT2-HRV2-XS_20080113-105222-518_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080113-105222-518_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080113-105222-518_L1C_051-257-0_D_V1-0.zip
run script
2024-01-15T15:09:00.506    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:09:00.506    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080113-105222-518_L1C_051-257-0_D_V1-0.zip
2024-01-15T15:09:00.507    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:09:00.507    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:09:00.507    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:09:00.507    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:09:00.507    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:09:00.507    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:09:00.507    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:09:00.507    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080113-105222-518_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/01/13/SPOT2-HRV2-XS_20080113-105230-965_L1C_051-258-0_D_V1-0/SPOT2-HRV2-XS_20080113-105230-965_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080113-105230-965_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080113-105230-965_L1C_051-258-0_D_V1-0.zip
run script
2024-01-15T15:12:21.302    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:12:21.303    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080113-105230-965_L1C_051-258-0_D_V1-0.zip
2024-01-15T15:12:21.303    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:12:21.303    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:12:21.303    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:12:21.303    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:12:21.303    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:12:21.303    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:12:21.304    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:12:21.304    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080113-105230-965_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/01/13/SPOT2-HRV2-XS_20080113-105233-672_L1C_051-258-3_D_V1-0/SPOT2-HRV2-XS_20080113-105233-672_L1C_051-258-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080113-105233-672_L1C_051-258-3_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080113-105233-672_L1C_051-258-3_D_V1-0.zip
run script
2024-01-15T15:15:26.257    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:15:26.258    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080113-105233-672_L1C_051-258-3_D_V1-0.zip
2024-01-15T15:15:26.258    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:15:26.259    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:15:26.259    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:15:26.259    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:15:26.259    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:15:26.259    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:15:26.259    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:15:26.259    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-15T15:15:27.834    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 902). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080113-105233-672_L1C_051-258-3_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2008/04/01/SPOT2-HRV2-XS_20080401-103113-197_L1C_047-259-4_D_V1-0/SPOT2-HRV2-XS_20080401-103113-197_L1C_047-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080401-103113-197_L1C_047-259-4_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080401-103113-197_L1C_047-259-4_D_V1-0.zip
run script
2024-01-15T15:15:31.003    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:15:31.004    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080401-103113-197_L1C_047-259-4_D_V1-0.zip
2024-01-15T15:15:31.004    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:15:31.004    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:15:31.004    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:15:31.004    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:15:31.004    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:15:31.004    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:15:31.004    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:15:31.004    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080401-103113-197_L1C_047-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/04/01/SPOT2-HRV2-XS_20080401-103117-862_L1C_047-260-0_D_V1-0/SPOT2-HRV2-XS_20080401-103117-862_L1C_047-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080401-103117-862_L1C_047-260-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080401-103117-862_L1C_047-260-0_D_V1-0.zip
run script
2024-01-15T15:15:34.111    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:15:34.111    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080401-103117-862_L1C_047-260-0_D_V1-0.zip
2024-01-15T15:15:34.111    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:15:34.111    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:15:34.111    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:15:34.112    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:15:34.112    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:15:34.112    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:15:34.112    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:15:34.112    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080401-103117-862_L1C_047-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/04/01/SPOT2-HRV1-XS_20080401-103027-797_L1C_050-254-3_D_V1-0/SPOT2-HRV1-XS_20080401-103027-797_L1C_050-254-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080401-103027-797_L1C_050-254-3_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080401-103027-797_L1C_050-254-3_D_V1-0.zip
run script
2024-01-15T15:15:37.563    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:15:37.565    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080401-103027-797_L1C_050-254-3_D_V1-0.zip
2024-01-15T15:15:37.565    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:15:37.565    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:15:37.565    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:15:37.565    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:15:37.565    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:15:37.565    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:15:37.565    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:15:37.565    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080401-103027-797_L1C_050-254-3_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/04/01/SPOT2-HRV1-XS_20080401-103029-602_L1C_050-254-5_D_V1-0/SPOT2-HRV1-XS_20080401-103029-602_L1C_050-254-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080401-103029-602_L1C_050-254-5_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080401-103029-602_L1C_050-254-5_D_V1-0.zip
run script
2024-01-15T15:15:40.716    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:15:40.717    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080401-103029-602_L1C_050-254-5_D_V1-0.zip
2024-01-15T15:15:40.717    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:15:40.717    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:15:40.718    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:15:40.718    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:15:40.718    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:15:40.718    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:15:40.718    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:15:40.718    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080401-103029-602_L1C_050-254-5_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/04/01/SPOT2-HRV1-XS_20080401-103113-094_L1C_051-260-0_D_V1-0/SPOT2-HRV1-XS_20080401-103113-094_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080401-103113-094_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080401-103113-094_L1C_051-260-0_D_V1-0.zip
run script
2024-01-15T15:15:43.761    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:15:43.762    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080401-103113-094_L1C_051-260-0_D_V1-0.zip
2024-01-15T15:15:43.762    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:15:43.762    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:15:43.763    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:15:43.763    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:15:43.763    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:15:43.763    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:15:43.763    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:15:43.763    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080401-103113-094_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 2 2 ... 2 2 2]
 [2 2 1 ... 2 2 2]
 [2 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/04/01/SPOT2-HRV1-XS_20080401-103121-417_L1C_051-261-0_D_V1-0/SPOT2-HRV1-XS_20080401-103121-417_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080401-103121-417_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080401-103121-417_L1C_051-261-0_D_V1-0.zip
run script
2024-01-15T15:17:52.321    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:17:52.323    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080401-103121-417_L1C_051-261-0_D_V1-0.zip
2024-01-15T15:17:52.323    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:17:52.323    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:17:52.323    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:17:52.323    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:17:52.323    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:17:52.323    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:17:52.323    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:17:52.323    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080401-103121-417_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [2 2 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/08/13/SPOT2-HRV2-XS_20080813-104926-416_L1C_048-254-0_D_V1-0/SPOT2-HRV2-XS_20080813-104926-416_L1C_048-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080813-104926-416_L1C_048-254-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080813-104926-416_L1C_048-254-0_D_V1-0.zip
run script
2024-01-15T15:19:56.938    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:19:56.940    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080813-104926-416_L1C_048-254-0_D_V1-0.zip
2024-01-15T15:19:56.940    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:19:56.940    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:19:56.940    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:19:56.940    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:19:56.940    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:19:56.940    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:19:56.940    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:19:56.940    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080813-104926-416_L1C_048-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/08/13/SPOT2-HRV2-XS_20080813-104934-820_L1C_048-255-0_D_V1-0/SPOT2-HRV2-XS_20080813-104934-820_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080813-104934-820_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080813-104934-820_L1C_048-255-0_D_V1-0.zip
run script
2024-01-15T15:20:00.383    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:20:00.383    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080813-104934-820_L1C_048-255-0_D_V1-0.zip
2024-01-15T15:20:00.383    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:20:00.383    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:20:00.383    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:20:00.383    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:20:00.383    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:20:00.383    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:20:00.383    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:20:00.383    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080813-104934-820_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/08/13/SPOT2-HRV2-XS_20080813-104943-227_L1C_048-256-0_D_V1-0/SPOT2-HRV2-XS_20080813-104943-227_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080813-104943-227_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080813-104943-227_L1C_048-256-0_D_V1-0.zip
run script
2024-01-15T15:20:22.893    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:20:22.894    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080813-104943-227_L1C_048-256-0_D_V1-0.zip
2024-01-15T15:20:22.895    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:20:22.895    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:20:22.895    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:20:22.895    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:20:22.895    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:20:22.895    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:20:22.895    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:20:22.895    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080813-104943-227_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/08/13/SPOT2-HRV2-XS_20080813-104951-641_L1C_048-257-0_D_V1-0/SPOT2-HRV2-XS_20080813-104951-641_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080813-104951-641_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080813-104951-641_L1C_048-257-0_D_V1-0.zip
run script
2024-01-15T15:21:03.579    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:21:03.579    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080813-104951-641_L1C_048-257-0_D_V1-0.zip
2024-01-15T15:21:03.579    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:21:03.579    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:21:03.579    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:21:03.580    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:21:03.580    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:21:03.580    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:21:03.580    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:21:03.580    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080813-104951-641_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/08/13/SPOT2-HRV2-XS_20080813-105000-057_L1C_048-258-0_D_V1-0/SPOT2-HRV2-XS_20080813-105000-057_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080813-105000-057_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080813-105000-057_L1C_048-258-0_D_V1-0.zip
run script
2024-01-15T15:21:22.772    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:21:22.774    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080813-105000-057_L1C_048-258-0_D_V1-0.zip
2024-01-15T15:21:22.774    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:21:22.774    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:21:22.774    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:21:22.774    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:21:22.774    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:21:22.774    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:21:22.774    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:21:22.774    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080813-105000-057_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/08/13/SPOT2-HRV2-XS_20080813-105008-482_L1C_048-259-0_D_V1-0/SPOT2-HRV2-XS_20080813-105008-482_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080813-105008-482_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080813-105008-482_L1C_048-259-0_D_V1-0.zip
run script
2024-01-15T15:21:26.166    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:21:26.166    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080813-105008-482_L1C_048-259-0_D_V1-0.zip
2024-01-15T15:21:26.166    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:21:26.166    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:21:26.166    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:21:26.166    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:21:26.166    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:21:26.166    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:21:26.166    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:21:26.167    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080813-105008-482_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/08/13/SPOT2-HRV2-XS_20080813-105016-908_L1C_048-260-0_D_V1-0/SPOT2-HRV2-XS_20080813-105016-908_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080813-105016-908_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080813-105016-908_L1C_048-260-0_D_V1-0.zip
run script
2024-01-15T15:21:29.348    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:21:29.350    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080813-105016-908_L1C_048-260-0_D_V1-0.zip
2024-01-15T15:21:29.350    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:21:29.350    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:21:29.350    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:21:29.350    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:21:29.350    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:21:29.350    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:21:29.350    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:21:29.350    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080813-105016-908_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/09/24/SPOT2-HRV2-XS_20080924-104014-923_L1C_048-254-0_D_V1-0/SPOT2-HRV2-XS_20080924-104014-923_L1C_048-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080924-104014-923_L1C_048-254-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080924-104014-923_L1C_048-254-0_D_V1-0.zip
run script
2024-01-15T15:21:33.715    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:21:33.716    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080924-104014-923_L1C_048-254-0_D_V1-0.zip
2024-01-15T15:21:33.716    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:21:33.716    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:21:33.716    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:21:33.716    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:21:33.716    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:21:33.716    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:21:33.717    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:21:33.717    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080924-104014-923_L1C_048-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/09/24/SPOT2-HRV2-XS_20080924-104023-270_L1C_048-255-0_D_V1-0/SPOT2-HRV2-XS_20080924-104023-270_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080924-104023-270_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080924-104023-270_L1C_048-255-0_D_V1-0.zip
run script
2024-01-15T15:21:36.743    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:21:36.744    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080924-104023-270_L1C_048-255-0_D_V1-0.zip
2024-01-15T15:21:36.744    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:21:36.744    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:21:36.744    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:21:36.744    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:21:36.744    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:21:36.744    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:21:36.744    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:21:36.744    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-15T15:22:00.128    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (57 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080924-104023-270_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2008/09/24/SPOT2-HRV2-XS_20080924-104031-623_L1C_048-256-0_D_V1-0/SPOT2-HRV2-XS_20080924-104031-623_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080924-104031-623_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080924-104031-623_L1C_048-256-0_D_V1-0.zip
run script
2024-01-15T15:22:03.179    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:22:03.179    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080924-104031-623_L1C_048-256-0_D_V1-0.zip
2024-01-15T15:22:03.179    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:22:03.179    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:22:03.179    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:22:03.179    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:22:03.179    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:22:03.179    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:22:03.179    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:22:03.179    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080924-104031-623_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/09/24/SPOT2-HRV2-XS_20080924-104039-986_L1C_048-257-0_D_V1-0/SPOT2-HRV2-XS_20080924-104039-986_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080924-104039-986_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080924-104039-986_L1C_048-257-0_D_V1-0.zip
run script
2024-01-15T15:22:58.619    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:22:58.621    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080924-104039-986_L1C_048-257-0_D_V1-0.zip
2024-01-15T15:22:58.621    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:22:58.621    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:22:58.621    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:22:58.621    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:22:58.621    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:22:58.621    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:22:58.621    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:22:58.621    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080924-104039-986_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/10/14/SPOT2-HRV1-XS_20081014-105459-199_L1C_048-254-3_D_V1-0/SPOT2-HRV1-XS_20081014-105459-199_L1C_048-254-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20081014-105459-199_L1C_048-254-3_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081014-105459-199_L1C_048-254-3_D_V1-0.zip
run script
2024-01-15T15:23:39.995    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:23:39.997    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081014-105459-199_L1C_048-254-3_D_V1-0.zip
2024-01-15T15:23:39.997    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:23:39.997    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:23:39.997    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:23:39.997    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:23:39.997    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:23:39.997    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:23:39.997    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:23:39.997    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081014-105459-199_L1C_048-254-3_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/10/26/SPOT2-HRV2-XS_20081026-102343-358_L1C_048-254-7_D_V1-0/SPOT2-HRV2-XS_20081026-102343-358_L1C_048-254-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081026-102343-358_L1C_048-254-7_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081026-102343-358_L1C_048-254-7_D_V1-0.zip
run script
2024-01-15T15:23:43.064    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:23:43.065    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081026-102343-358_L1C_048-254-7_D_V1-0.zip
2024-01-15T15:23:43.066    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:23:43.066    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:23:43.066    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:23:43.066    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:23:43.066    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:23:43.066    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:23:43.066    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:23:43.066    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081026-102343-358_L1C_048-254-7_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/10/26/SPOT2-HRV2-XS_20081026-102345-283_L1C_048-255-0_D_V1-0/SPOT2-HRV2-XS_20081026-102345-283_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081026-102345-283_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081026-102345-283_L1C_048-255-0_D_V1-0.zip
run script
2024-01-15T15:23:53.111    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:23:53.113    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081026-102345-283_L1C_048-255-0_D_V1-0.zip
2024-01-15T15:23:53.113    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:23:53.113    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:23:53.113    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:23:53.113    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:23:53.113    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:23:53.113    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:23:53.113    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:23:53.113    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081026-102345-283_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/10/26/SPOT2-HRV2-XS_20081026-102352-502_L1C_048-255-8_D_V1-0/SPOT2-HRV2-XS_20081026-102352-502_L1C_048-255-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20081026-102352-502_L1C_048-255-8_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081026-102352-502_L1C_048-255-8_D_V1-0.zip
run script
2024-01-15T15:24:10.010    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:24:10.012    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081026-102352-502_L1C_048-255-8_D_V1-0.zip
2024-01-15T15:24:10.012    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:24:10.012    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:24:10.012    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:24:10.012    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:24:10.012    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:24:10.012    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:24:10.012    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:24:10.012    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20081026-102352-502_L1C_048-255-8_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/10/26/SPOT2-HRV1-XS_20081026-102343-003_L1C_049-254-8_D_V1-0/SPOT2-HRV1-XS_20081026-102343-003_L1C_049-254-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20081026-102343-003_L1C_049-254-8_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081026-102343-003_L1C_049-254-8_D_V1-0.zip
run script
2024-01-15T15:24:47.734    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:24:47.735    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081026-102343-003_L1C_049-254-8_D_V1-0.zip
2024-01-15T15:24:47.735    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:24:47.735    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:24:47.735    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:24:47.736    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:24:47.736    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:24:47.736    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:24:47.736    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:24:47.736    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081026-102343-003_L1C_049-254-8_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/10/26/SPOT2-HRV1-XS_20081026-102344-035_L1C_049-255-0_D_V1-0/SPOT2-HRV1-XS_20081026-102344-035_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20081026-102344-035_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081026-102344-035_L1C_049-255-0_D_V1-0.zip
run script
2024-01-15T15:25:13.791    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:25:13.792    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081026-102344-035_L1C_049-255-0_D_V1-0.zip
2024-01-15T15:25:13.792    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:25:13.792    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:25:13.792    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:25:13.792    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:25:13.792    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:25:13.792    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:25:13.792    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:25:13.792    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081026-102344-035_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/10/26/SPOT2-HRV1-XS_20081026-102352-295_L1C_049-256-0_D_V1-0/SPOT2-HRV1-XS_20081026-102352-295_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20081026-102352-295_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081026-102352-295_L1C_049-256-0_D_V1-0.zip
run script
2024-01-15T15:25:51.045    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:25:51.046    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081026-102352-295_L1C_049-256-0_D_V1-0.zip
2024-01-15T15:25:51.046    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:25:51.046    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:25:51.047    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:25:51.047    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:25:51.047    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:25:51.047    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:25:51.047    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:25:51.047    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081026-102352-295_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/10/26/SPOT2-HRV1-XS_20081026-102408-914_L1C_050-258-1_D_V1-0/SPOT2-HRV1-XS_20081026-102408-914_L1C_050-258-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20081026-102408-914_L1C_050-258-1_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081026-102408-914_L1C_050-258-1_D_V1-0.zip
run script
2024-01-15T15:27:32.057    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:27:32.058    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081026-102408-914_L1C_050-258-1_D_V1-0.zip
2024-01-15T15:27:32.058    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:27:32.058    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:27:32.058    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:27:32.058    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:27:32.059    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:27:32.059    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:27:32.059    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:27:32.059    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-15T15:29:05.576    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (406 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081026-102408-914_L1C_050-258-1_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2008/10/26/SPOT2-HRV1-XS_20081026-102412-524_L1C_050-258-5_D_V1-0/SPOT2-HRV1-XS_20081026-102412-524_L1C_050-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20081026-102412-524_L1C_050-258-5_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081026-102412-524_L1C_050-258-5_D_V1-0.zip
run script
2024-01-15T15:29:08.584    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:29:08.585    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081026-102412-524_L1C_050-258-5_D_V1-0.zip
2024-01-15T15:29:08.585    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:29:08.585    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:29:08.585    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:29:08.585    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:29:08.585    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:29:08.585    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:29:08.586    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:29:08.586    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20081026-102412-524_L1C_050-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/02/09/SPOT2-HRV2-XS_20080209-103214-523_L1C_048-255-6_D_V1-0/SPOT2-HRV2-XS_20080209-103214-523_L1C_048-255-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080209-103214-523_L1C_048-255-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080209-103214-523_L1C_048-255-6_D_V1-0.zip
run script
2024-01-15T15:30:41.105    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:30:41.106    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080209-103214-523_L1C_048-255-6_D_V1-0.zip
2024-01-15T15:30:41.106    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:30:41.106    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:30:41.106    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:30:41.106    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:30:41.106    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:30:41.107    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:30:41.107    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:30:41.107    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080209-103214-523_L1C_048-255-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/02/09/SPOT2-HRV2-XS_20080209-103217-363_L1C_048-256-0_D_V1-0/SPOT2-HRV2-XS_20080209-103217-363_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080209-103217-363_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080209-103217-363_L1C_048-256-0_D_V1-0.zip
run script
2024-01-15T15:31:24.374    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:31:24.375    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080209-103217-363_L1C_048-256-0_D_V1-0.zip
2024-01-15T15:31:24.376    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:31:24.376    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:31:24.376    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:31:24.376    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:31:24.376    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:31:24.376    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:31:24.376    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:31:24.376    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080209-103217-363_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/02/09/SPOT2-HRV2-XS_20080209-103225-626_L1C_048-257-0_D_V1-0/SPOT2-HRV2-XS_20080209-103225-626_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080209-103225-626_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080209-103225-626_L1C_048-257-0_D_V1-0.zip
run script
2024-01-15T15:32:14.214    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:32:14.215    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080209-103225-626_L1C_048-257-0_D_V1-0.zip
2024-01-15T15:32:14.215    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:32:14.215    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:32:14.215    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:32:14.216    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:32:14.216    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:32:14.216    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:32:14.216    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:32:14.216    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080209-103225-626_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/02/09/SPOT2-HRV2-XS_20080209-103233-898_L1C_048-258-0_D_V1-0/SPOT2-HRV2-XS_20080209-103233-898_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080209-103233-898_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080209-103233-898_L1C_048-258-0_D_V1-0.zip
run script
2024-01-15T15:32:54.096    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:32:54.097    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080209-103233-898_L1C_048-258-0_D_V1-0.zip
2024-01-15T15:32:54.097    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:32:54.097    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:32:54.097    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:32:54.097    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:32:54.097    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:32:54.097    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:32:54.097    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:32:54.097    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080209-103233-898_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/02/09/SPOT2-HRV2-XS_20080209-103237-507_L1C_048-258-4_D_V1-0/SPOT2-HRV2-XS_20080209-103237-507_L1C_048-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080209-103237-507_L1C_048-258-4_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080209-103237-507_L1C_048-258-4_D_V1-0.zip
run script
2024-01-15T15:33:14.531    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:33:14.532    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080209-103237-507_L1C_048-258-4_D_V1-0.zip
2024-01-15T15:33:14.532    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:33:14.532    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:33:14.532    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:33:14.532    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:33:14.532    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:33:14.532    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:33:14.532    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:33:14.532    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080209-103237-507_L1C_048-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/02/09/SPOT2-HRV1-XS_20080209-103214-496_L1C_050-255-8_D_V1-0/SPOT2-HRV1-XS_20080209-103214-496_L1C_050-255-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080209-103214-496_L1C_050-255-8_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080209-103214-496_L1C_050-255-8_D_V1-0.zip
run script
2024-01-15T15:33:31.243    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:33:31.244    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080209-103214-496_L1C_050-255-8_D_V1-0.zip
2024-01-15T15:33:31.244    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:33:31.244    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:33:31.244    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:33:31.244    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:33:31.244    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:33:31.244    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:33:31.244    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:33:31.244    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080209-103214-496_L1C_050-255-8_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/02/09/SPOT2-HRV1-XS_20080209-103215-546_L1C_050-256-0_D_V1-0/SPOT2-HRV1-XS_20080209-103215-546_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080209-103215-546_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080209-103215-546_L1C_050-256-0_D_V1-0.zip
run script
2024-01-15T15:35:39.780    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:35:39.782    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080209-103215-546_L1C_050-256-0_D_V1-0.zip
2024-01-15T15:35:39.782    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:35:39.782    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:35:39.782    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:35:39.782    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:35:39.782    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:35:39.782    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:35:39.782    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:35:39.782    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080209-103215-546_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 1 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/02/09/SPOT2-HRV1-XS_20080209-103223-827_L1C_050-257-0_D_V1-0/SPOT2-HRV1-XS_20080209-103223-827_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080209-103223-827_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080209-103223-827_L1C_050-257-0_D_V1-0.zip
run script
2024-01-15T15:37:59.983    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:37:59.985    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080209-103223-827_L1C_050-257-0_D_V1-0.zip
2024-01-15T15:37:59.985    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:37:59.985    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:37:59.985    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:37:59.985    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:37:59.985    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:37:59.985    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:37:59.985    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:37:59.985    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080209-103223-827_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [0 1 1 ... 2 2 2]
 [0 1 1 ... 2 2 2]
 ...
 [1 1 0 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/02/09/SPOT2-HRV1-XS_20080209-103232-111_L1C_050-258-0_D_V1-0/SPOT2-HRV1-XS_20080209-103232-111_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080209-103232-111_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080209-103232-111_L1C_050-258-0_D_V1-0.zip
run script
2024-01-15T15:40:20.783    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:40:20.785    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080209-103232-111_L1C_050-258-0_D_V1-0.zip
2024-01-15T15:40:20.785    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:40:20.785    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:40:20.785    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:40:20.785    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:40:20.785    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:40:20.785    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:40:20.785    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:40:20.785    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-15T15:41:52.574    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 882). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080209-103232-111_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2008/02/09/SPOT2-HRV1-XS_20080209-103237-525_L1C_050-258-6_D_V1-0/SPOT2-HRV1-XS_20080209-103237-525_L1C_050-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080209-103237-525_L1C_050-258-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080209-103237-525_L1C_050-258-6_D_V1-0.zip
run script
2024-01-15T15:41:55.448    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:41:55.448    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080209-103237-525_L1C_050-258-6_D_V1-0.zip
2024-01-15T15:41:55.449    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:41:55.449    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:41:55.449    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:41:55.449    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:41:55.449    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:41:55.449    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:41:55.449    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:41:55.449    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080209-103237-525_L1C_050-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/01/08/SPOT2-HRV1-XS_20080108-104850-344_L1C_048-257-8_D_V1-0/SPOT2-HRV1-XS_20080108-104850-344_L1C_048-257-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080108-104850-344_L1C_048-257-8_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080108-104850-344_L1C_048-257-8_D_V1-0.zip
run script
2024-01-15T15:43:30.700    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:43:30.701    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080108-104850-344_L1C_048-257-8_D_V1-0.zip
2024-01-15T15:43:30.701    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:43:30.702    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:43:30.702    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:43:30.702    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:43:30.702    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:43:30.702    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:43:30.702    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:43:30.702    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080108-104850-344_L1C_048-257-8_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/01/08/SPOT2-HRV1-XS_20080108-104851-493_L1C_048-258-0_D_V1-0/SPOT2-HRV1-XS_20080108-104851-493_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080108-104851-493_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080108-104851-493_L1C_048-258-0_D_V1-0.zip
run script
2024-01-15T15:44:04.371    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:44:04.373    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080108-104851-493_L1C_048-258-0_D_V1-0.zip
2024-01-15T15:44:04.373    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:44:04.373    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:44:04.373    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:44:04.373    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:44:04.373    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:44:04.373    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:44:04.373    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:44:04.373    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080108-104851-493_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/01/08/SPOT2-HRV1-XS_20080108-104857-810_L1C_048-258-7_D_V1-0/SPOT2-HRV1-XS_20080108-104857-810_L1C_048-258-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080108-104857-810_L1C_048-258-7_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080108-104857-810_L1C_048-258-7_D_V1-0.zip
run script
2024-01-15T15:44:34.808    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:44:34.809    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080108-104857-810_L1C_048-258-7_D_V1-0.zip
2024-01-15T15:44:34.809    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:44:34.809    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:44:34.809    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:44:34.809    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:44:34.809    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:44:34.809    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:44:34.810    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:44:34.810    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080108-104857-810_L1C_048-258-7_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/01/24/SPOT2-HRV2-XS_20080124-104043-342_L1C_048-257-9_D_V1-0/SPOT2-HRV2-XS_20080124-104043-342_L1C_048-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080124-104043-342_L1C_048-257-9_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080124-104043-342_L1C_048-257-9_D_V1-0.zip
run script
2024-01-15T15:44:48.776    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:44:48.777    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080124-104043-342_L1C_048-257-9_D_V1-0.zip
2024-01-15T15:44:48.777    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:44:48.777    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:44:48.777    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:44:48.777    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:44:48.777    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:44:48.777    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:44:48.777    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:44:48.777    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080124-104043-342_L1C_048-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/01/24/SPOT2-HRV2-XS_20080124-104043-535_L1C_048-258-0_D_V1-0/SPOT2-HRV2-XS_20080124-104043-535_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080124-104043-535_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080124-104043-535_L1C_048-258-0_D_V1-0.zip
run script
2024-01-15T15:45:13.713    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:45:13.714    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080124-104043-535_L1C_048-258-0_D_V1-0.zip
2024-01-15T15:45:13.714    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:45:13.714    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:45:13.714    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:45:13.714    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:45:13.714    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:45:13.714    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:45:13.714    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:45:13.714    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080124-104043-535_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/01/24/SPOT2-HRV2-XS_20080124-104048-949_L1C_048-258-6_D_V1-0/SPOT2-HRV2-XS_20080124-104048-949_L1C_048-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080124-104048-949_L1C_048-258-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080124-104048-949_L1C_048-258-6_D_V1-0.zip
run script
2024-01-15T15:45:38.142    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:45:38.143    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080124-104048-949_L1C_048-258-6_D_V1-0.zip
2024-01-15T15:45:38.143    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:45:38.143    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:45:38.143    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:45:38.143    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:45:38.143    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:45:38.143    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:45:38.143    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:45:38.143    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080124-104048-949_L1C_048-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/01/25/SPOT2-HRV2-XS_20080125-102121-209_L1C_048-257-8_D_V1-0/SPOT2-HRV2-XS_20080125-102121-209_L1C_048-257-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080125-102121-209_L1C_048-257-8_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080125-102121-209_L1C_048-257-8_D_V1-0.zip
run script
2024-01-15T15:45:52.055    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:45:52.055    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080125-102121-209_L1C_048-257-8_D_V1-0.zip
2024-01-15T15:45:52.055    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:45:52.056    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:45:52.056    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:45:52.056    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:45:52.056    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:45:52.056    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:45:52.056    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:45:52.056    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080125-102121-209_L1C_048-257-8_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/01/25/SPOT2-HRV2-XS_20080125-102123-119_L1C_048-258-1_D_V1-0/SPOT2-HRV2-XS_20080125-102123-119_L1C_048-258-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080125-102123-119_L1C_048-258-1_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080125-102123-119_L1C_048-258-1_D_V1-0.zip
run script
2024-01-15T15:46:27.902    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:46:27.903    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080125-102123-119_L1C_048-258-1_D_V1-0.zip
2024-01-15T15:46:27.903    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:46:27.904    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:46:27.904    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:46:27.904    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:46:27.904    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:46:27.904    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:46:27.904    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:46:27.904    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080125-102123-119_L1C_048-258-1_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/01/25/SPOT2-HRV1-XS_20080125-102101-226_L1C_050-255-6_D_V1-0/SPOT2-HRV1-XS_20080125-102101-226_L1C_050-255-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080125-102101-226_L1C_050-255-6_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080125-102101-226_L1C_050-255-6_D_V1-0.zip
run script
2024-01-15T15:46:58.091    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:46:58.092    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080125-102101-226_L1C_050-255-6_D_V1-0.zip
2024-01-15T15:46:58.092    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:46:58.092    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:46:58.092    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:46:58.092    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:46:58.092    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:46:58.092    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:46:58.092    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:46:58.092    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080125-102101-226_L1C_050-255-6_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/01/25/SPOT2-HRV1-XS_20080125-102104-033_L1C_050-256-0_D_V1-0/SPOT2-HRV1-XS_20080125-102104-033_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080125-102104-033_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080125-102104-033_L1C_050-256-0_D_V1-0.zip
run script
2024-01-15T15:49:04.538    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:49:04.539    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080125-102104-033_L1C_050-256-0_D_V1-0.zip
2024-01-15T15:49:04.539    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:49:04.539    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:49:04.539    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:49:04.539    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:49:04.539    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:49:04.539    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:49:04.540    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:49:04.540    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080125-102104-033_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/01/25/SPOT2-HRV1-XS_20080125-102104-935_L1C_050-256-1_D_V1-0/SPOT2-HRV1-XS_20080125-102104-935_L1C_050-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080125-102104-935_L1C_050-256-1_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080125-102104-935_L1C_050-256-1_D_V1-0.zip
run script
2024-01-15T15:51:42.887    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:51:42.888    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080125-102104-935_L1C_050-256-1_D_V1-0.zip
2024-01-15T15:51:42.888    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:51:42.888    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:51:42.888    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:51:42.889    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:51:42.889    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:51:42.889    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:51:42.889    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:51:42.889    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080125-102104-935_L1C_050-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/01/25/SPOT2-HRV1-XS_20080125-102120-502_L1C_050-258-0_D_V1-0/SPOT2-HRV1-XS_20080125-102120-502_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080125-102120-502_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080125-102120-502_L1C_050-258-0_D_V1-0.zip
run script
2024-01-15T15:54:18.493    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:54:18.494    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080125-102120-502_L1C_050-258-0_D_V1-0.zip
2024-01-15T15:54:18.494    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:54:18.495    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:54:18.495    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:54:18.495    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:54:18.495    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:54:18.495    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:54:18.495    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:54:18.495    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-15T15:56:00.368    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 474). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080125-102120-502_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2008/01/25/SPOT2-HRV1-XS_20080125-102123-209_L1C_050-258-3_D_V1-0/SPOT2-HRV1-XS_20080125-102123-209_L1C_050-258-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080125-102123-209_L1C_050-258-3_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080125-102123-209_L1C_050-258-3_D_V1-0.zip
run script
2024-01-15T15:56:03.398    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:56:03.399    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080125-102123-209_L1C_050-258-3_D_V1-0.zip
2024-01-15T15:56:03.399    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:56:03.399    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:56:03.399    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:56:03.399    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:56:03.399    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:56:03.399    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:56:03.399    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:56:03.399    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080125-102123-209_L1C_050-258-3_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/01/30/SPOT2-HRV2-XS_20080130-102506-288_L1C_048-257-9_D_V1-0/SPOT2-HRV2-XS_20080130-102506-288_L1C_048-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080130-102506-288_L1C_048-257-9_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080130-102506-288_L1C_048-257-9_D_V1-0.zip
run script
2024-01-15T15:58:07.610    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:58:07.611    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080130-102506-288_L1C_048-257-9_D_V1-0.zip
2024-01-15T15:58:07.611    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:58:07.611    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:58:07.611    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:58:07.611    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:58:07.611    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:58:07.611    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:58:07.611    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:58:07.612    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080130-102506-288_L1C_048-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/01/30/SPOT2-HRV2-XS_20080130-102507-308_L1C_048-258-1_D_V1-0/SPOT2-HRV2-XS_20080130-102507-308_L1C_048-258-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080130-102507-308_L1C_048-258-1_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080130-102507-308_L1C_048-258-1_D_V1-0.zip
run script
2024-01-15T15:58:32.286    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:58:32.287    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080130-102507-308_L1C_048-258-1_D_V1-0.zip
2024-01-15T15:58:32.288    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:58:32.288    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:58:32.288    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:58:32.288    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:58:32.288    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:58:32.288    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:58:32.288    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:58:32.288    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080130-102507-308_L1C_048-258-1_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/01/30/SPOT2-HRV2-XS_20080130-102523-813_L1C_048-260-1_D_V1-0/SPOT2-HRV2-XS_20080130-102523-813_L1C_048-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080130-102523-813_L1C_048-260-1_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080130-102523-813_L1C_048-260-1_D_V1-0.zip
run script
2024-01-15T15:58:56.043    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:58:56.044    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080130-102523-813_L1C_048-260-1_D_V1-0.zip
2024-01-15T15:58:56.044    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:58:56.045    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:58:56.045    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:58:56.045    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:58:56.045    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:58:56.045    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:58:56.045    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:58:56.045    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080130-102523-813_L1C_048-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/01/30/SPOT2-HRV2-XS_20080130-102531-180_L1C_049-261-0_D_V1-0/SPOT2-HRV2-XS_20080130-102531-180_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080130-102531-180_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080130-102531-180_L1C_049-261-0_D_V1-0.zip
run script
2024-01-15T15:58:59.952    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:58:59.953    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080130-102531-180_L1C_049-261-0_D_V1-0.zip
2024-01-15T15:58:59.953    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:58:59.953    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:58:59.953    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:58:59.953    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:58:59.953    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:58:59.953    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:58:59.953    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:58:59.953    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080130-102531-180_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/01/30/SPOT2-HRV2-XS_20080130-102539-452_L1C_049-262-0_D_V1-0/SPOT2-HRV2-XS_20080130-102539-452_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080130-102539-452_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080130-102539-452_L1C_049-262-0_D_V1-0.zip
run script
2024-01-15T15:59:02.841    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:59:02.842    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080130-102539-452_L1C_049-262-0_D_V1-0.zip
2024-01-15T15:59:02.842    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:59:02.842    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:59:02.842    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:59:02.842    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:59:02.842    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:59:02.842    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:59:02.842    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:59:02.842    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080130-102539-452_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/05/27/SPOT2-HRV1-XS_20080527-105219-207_L1C_048-257-0_D_V1-0/SPOT2-HRV1-XS_20080527-105219-207_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080527-105219-207_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080527-105219-207_L1C_048-257-0_D_V1-0.zip
run script
2024-01-15T15:59:06.675    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T15:59:06.676    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080527-105219-207_L1C_048-257-0_D_V1-0.zip
2024-01-15T15:59:06.676    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T15:59:06.677    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T15:59:06.677    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T15:59:06.677    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T15:59:06.677    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T15:59:06.677    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T15:59:06.677    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T15:59:06.677    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080527-105219-207_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/05/27/SPOT2-HRV1-XS_20080527-105220-109_L1C_048-257-1_D_V1-0/SPOT2-HRV1-XS_20080527-105220-109_L1C_048-257-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080527-105220-109_L1C_048-257-1_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080527-105220-109_L1C_048-257-1_D_V1-0.zip
run script
2024-01-15T16:00:10.586    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T16:00:10.587    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080527-105220-109_L1C_048-257-1_D_V1-0.zip
2024-01-15T16:00:10.587    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T16:00:10.588    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T16:00:10.588    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T16:00:10.588    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T16:00:10.588    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T16:00:10.588    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T16:00:10.588    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T16:00:10.588    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080527-105220-109_L1C_048-257-1_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/05/27/SPOT2-HRV1-XS_20080527-105153-940_L1C_049-254-0_D_V1-0/SPOT2-HRV1-XS_20080527-105153-940_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080527-105153-940_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080527-105153-940_L1C_049-254-0_D_V1-0.zip
run script
2024-01-15T16:01:10.707    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T16:01:10.708    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080527-105153-940_L1C_049-254-0_D_V1-0.zip
2024-01-15T16:01:10.708    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T16:01:10.708    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T16:01:10.708    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T16:01:10.708    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T16:01:10.708    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T16:01:10.708    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T16:01:10.708    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T16:01:10.708    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080527-105153-940_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/05/27/SPOT2-HRV2-XS_20080527-105153-212_L1C_049-254-0_D_V1-0/SPOT2-HRV2-XS_20080527-105153-212_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080527-105153-212_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080527-105153-212_L1C_049-254-0_D_V1-0.zip
run script
2024-01-15T16:01:13.725    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T16:01:13.726    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080527-105153-212_L1C_049-254-0_D_V1-0.zip
2024-01-15T16:01:13.726    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T16:01:13.726    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T16:01:13.727    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T16:01:13.727    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T16:01:13.727    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T16:01:13.727    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T16:01:13.727    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T16:01:13.727    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080527-105153-212_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/05/27/SPOT2-HRV1-XS_20080527-105202-356_L1C_049-255-0_D_V1-0/SPOT2-HRV1-XS_20080527-105202-356_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080527-105202-356_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080527-105202-356_L1C_049-255-0_D_V1-0.zip
run script
2024-01-15T16:01:18.057    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T16:01:18.057    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080527-105202-356_L1C_049-255-0_D_V1-0.zip
2024-01-15T16:01:18.057    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T16:01:18.057    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T16:01:18.057    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T16:01:18.057    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T16:01:18.057    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T16:01:18.057    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T16:01:18.057    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T16:01:18.058    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080527-105202-356_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/05/27/SPOT2-HRV2-XS_20080527-105201-637_L1C_049-255-0_D_V1-0/SPOT2-HRV2-XS_20080527-105201-637_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080527-105201-637_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080527-105201-637_L1C_049-255-0_D_V1-0.zip
run script
2024-01-15T16:01:59.116    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T16:01:59.117    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080527-105201-637_L1C_049-255-0_D_V1-0.zip
2024-01-15T16:01:59.117    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T16:01:59.117    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T16:01:59.117    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T16:01:59.117    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T16:01:59.117    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T16:01:59.118    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T16:01:59.118    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T16:01:59.118    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080527-105201-637_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/05/27/SPOT2-HRV1-XS_20080527-105210-778_L1C_049-256-0_D_V1-0/SPOT2-HRV1-XS_20080527-105210-778_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20080527-105210-778_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080527-105210-778_L1C_049-256-0_D_V1-0.zip
run script
2024-01-15T16:02:55.770    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T16:02:55.771    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080527-105210-778_L1C_049-256-0_D_V1-0.zip
2024-01-15T16:02:55.771    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T16:02:55.771    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T16:02:55.772    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T16:02:55.772    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T16:02:55.772    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T16:02:55.772    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T16:02:55.772    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T16:02:55.772    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV1-XS_20080527-105210-778_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/05/27/SPOT2-HRV2-XS_20080527-105210-065_L1C_049-256-0_D_V1-0/SPOT2-HRV2-XS_20080527-105210-065_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20080527-105210-065_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080527-105210-065_L1C_049-256-0_D_V1-0.zip
run script
2024-01-15T16:04:10.336    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200
2024-01-15T16:04:10.338    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080527-105210-065_L1C_049-256-0_D_V1-0.zip
2024-01-15T16:04:10.338    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-15T16:04:10.338    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-15T16:04:10.338    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-15T16:04:10.338    INFO:run_snow_swh.py::main:model type : mtn
2024-01-15T16:04:10.338    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-15T16:04:10.338    INFO:run_snow_swh.py::main:mask inference : None
2024-01-15T16:04:10.338    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-15T16:04:10.338    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4283301/INPUT/SPOT2-HRV2-XS_20080527-105210-065_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4283301/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE2/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
end
[2024-01-15 16:06:12.510228475+00:00] cnes_level2/barrouz/4283301:  Account (env) = cnes_level2
[2024-01-15 16:06:12.511615955+00:00] cnes_level2/barrouz/4283301:     User (env) = barrouz
[2024-01-15 16:06:12.513291840+00:00] cnes_level2/barrouz/4283301:        GroupId = cesbio(426000053)
[2024-01-15 16:06:12.514700360+00:00] cnes_level2/barrouz/4283301:         UserId = barrouz(9134)
[2024-01-15 16:06:12.515957432+00:00] cnes_level2/barrouz/4283301:        Account = cnes_level2
[2024-01-15 16:06:12.517237283+00:00] cnes_level2/barrouz/4283301:        Account = cnes_level2
[2024-01-15 16:06:12.518514545+00:00] cnes_level2/barrouz/4283301:      Partition = cpu2022
[2024-01-15 16:06:12.519841866+00:00] cnes_level2/barrouz/4283301:            QOS = cpu_2022_1280
[2024-01-15 16:06:12.521150377+00:00] cnes_level2/barrouz/4283301:        JobName = inf_ALP_42_TCD-BLUE_AVG-1200
[2024-01-15 16:06:12.522479048+00:00] cnes_level2/barrouz/4283301:     SubmitTime = 2024-01-14T21:02:09
[2024-01-15 16:06:12.523718369+00:00] cnes_level2/barrouz/4283301:        RunTime = 09:05:12
[2024-01-15 16:06:12.525092370+00:00] cnes_level2/barrouz/4283301:      TimeLimit = 10:00:00
[2024-01-15 16:06:12.526307272+00:00] cnes_level2/barrouz/4283301:   EligibleTime = 2024-01-14T21:02:09
[2024-01-15 16:06:12.527506265+00:00] cnes_level2/barrouz/4283301:      StartTime = 2024-01-15T07:01:00
[2024-01-15 16:06:12.528655128+00:00] cnes_level2/barrouz/4283301:        EndTime = 2024-01-15T16:06:12
[2024-01-15 16:06:12.529918010+00:00] cnes_level2/barrouz/4283301:       ExitCode = 0:0
[2024-01-15 16:06:12.531169992+00:00] cnes_level2/barrouz/4283301:       NodeList = trex050
[2024-01-15 16:06:12.532454323+00:00] cnes_level2/barrouz/4283301:      BatchHost = trex050
[2024-01-15 16:06:12.533862093+00:00] cnes_level2/barrouz/4283301:           TRES = 
[2024-01-15 16:06:12.535167354+00:00] cnes_level2/barrouz/4283301:        Command = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
[2024-01-15 16:06:12.536635292+00:00] cnes_level2/barrouz/4283301:        WorkDir = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code
[2024-01-15 16:06:12.537996753+00:00] cnes_level2/barrouz/4283301:         StdErr = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_42_TCD-BLUE_AVG-1200.log
[2024-01-15 16:06:12.538945819+00:00] cnes_level2/barrouz/4283301:         StdOut = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_42_TCD-BLUE_AVG-1200.log

#########################################
#        EVIDEN - CNES                  #
#        Job Accounting                 #
#########################################
Cluster              : trex
JobIDRaw             : 4283301
JobID                : 4283301
JobName              : inf_ALP_42_TCD-BLUE_AVG-1200
Account              : cnes_level2
User                 : barrouz(9134), cesbio(426000053)
Partition            : cpu2022
QOS                  : cpu_2022_1280
Nodelist             : trex050 (1)
State                : COMPLETED  (Exitcode=0:0, DerivedExitCode=0:0, Restarts=0)
Submit date          : 2024-01-14T21:02:09
Start time           : 2024-01-15T07:01:00
End time             : 2024-01-15T16:06:12
Elapsed time         : 09:05:12  (Timelimit=10:00:00, Suspended=00:00:00)
TEI                  : 3 days, 0:41:36
Command              : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
StdOut               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_42_TCD-BLUE_AVG-1200.log
StdErr               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_42_TCD-BLUE_AVG-1200.log

STEP(s) : 2
--------- 
   StepID  | JobName      State       Exit   Start               End                 Elapsed   TotalCPU   CPUTime    ConsumedEnergy MaxDiskRead MaxDiskWrite     MaxRSS MaxRSSTask MaxRSSNode NNodes UserCPU    NodeList
   ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 
   batch   | batch        COMPLETED   0:0    2024-01-15T07:01:00 2024-01-15T16:06:12 09:05:12  1-16:24:52 3-00:41:36      0.261875M  274584.89M   104787.01M  92114700K          0    trex050      1 1-04:43:24 trex050
   extern  | extern       COMPLETED   0:0    2024-01-15T07:01:00 2024-01-15T16:06:12 09:05:12  00:00.001  3-00:41:36      0.261875M       0.00M        0.00M      1692K          0    trex050      1 00:00:00   trex050

