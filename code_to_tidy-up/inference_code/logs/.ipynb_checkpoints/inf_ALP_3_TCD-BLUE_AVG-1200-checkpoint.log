unload conda/22.11.1  : OK 
load conda/22.11.1  : OK 
envs_dirs : /work/scratch/env/barrouz/conda_env/
pkgs_dirs : /work/scratch/env/barrouz/pkgs_conda
INPUT_PATH /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/3.txt
OUTPUT_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
DEM_PATH /work/CAMPUS/etudes/Neige/DEM
TCD_PATH /work/datalake/static_aux/TreeCoverDensity
MODELS_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
KEEP_REFL 0
MASK 1
start
/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/3.txt
muscate/SPOTWORLDHERITAGE/1999/06/29/SPOT2-HRV2-XS_19990629-105847-790_L1C_050-255-8_D_V1-0/SPOT2-HRV2-XS_19990629-105847-790_L1C_050-255-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990629-105847-790_L1C_050-255-8_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990629-105847-790_L1C_050-255-8_D_V1-0.zip
run script
2024-01-09T16:49:13.270    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T16:49:13.271    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990629-105847-790_L1C_050-255-8_D_V1-0.zip
2024-01-09T16:49:13.272    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:49:13.272    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:49:13.272    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T16:49:13.272    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:49:13.272    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:49:13.272    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:49:13.272    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:49:13.272    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990629-105847-790_L1C_050-255-8_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/29/SPOT2-HRV1-XS_19990629-105918-956_L1C_052-260-0_D_V1-0/SPOT2-HRV1-XS_19990629-105918-956_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990629-105918-956_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990629-105918-956_L1C_052-260-0_D_V1-0.zip
run script
2024-01-09T16:52:55.052    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T16:52:55.053    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990629-105918-956_L1C_052-260-0_D_V1-0.zip
2024-01-09T16:52:55.053    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:52:55.053    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:52:55.053    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T16:52:55.053    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:52:55.053    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:52:55.054    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:52:55.054    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:52:55.054    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:54:24.433    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 133). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990629-105918-956_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1999/10/18/SPOT2-HRV1-XS_19991018-102314-688_L1C_050-254-0_D_V1-0/SPOT2-HRV1-XS_19991018-102314-688_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991018-102314-688_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991018-102314-688_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T16:54:27.493    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T16:54:27.493    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991018-102314-688_L1C_050-254-0_D_V1-0.zip
2024-01-09T16:54:27.493    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:54:27.493    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:54:27.493    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T16:54:27.493    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:54:27.493    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:54:27.493    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:54:27.493    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:54:27.493    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991018-102314-688_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1999/10/18/SPOT2-HRV1-XS_19991018-102322-879_L1C_050-255-0_D_V1-0/SPOT2-HRV1-XS_19991018-102322-879_L1C_050-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991018-102322-879_L1C_050-255-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991018-102322-879_L1C_050-255-0_D_V1-0.zip
run script
2024-01-09T16:54:30.583    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T16:54:30.583    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991018-102322-879_L1C_050-255-0_D_V1-0.zip
2024-01-09T16:54:30.583    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:54:30.583    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:54:30.583    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T16:54:30.583    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:54:30.583    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:54:30.583    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:54:30.583    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:54:30.583    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991018-102322-879_L1C_050-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/18/SPOT2-HRV1-XS_19991018-102325-586_L1C_050-255-3_D_V1-0/SPOT2-HRV1-XS_19991018-102325-586_L1C_050-255-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991018-102325-586_L1C_050-255-3_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991018-102325-586_L1C_050-255-3_D_V1-0.zip
run script
2024-01-09T16:55:34.361    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T16:55:34.362    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991018-102325-586_L1C_050-255-3_D_V1-0.zip
2024-01-09T16:55:34.362    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:55:34.362    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:55:34.362    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T16:55:34.362    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:55:34.362    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:55:34.362    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:55:34.362    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:55:34.362    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991018-102325-586_L1C_050-255-3_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/08/25/SPOT2-HRV1-XS_19990825-110240-314_L1C_050-257-5_D_V1-0/SPOT2-HRV1-XS_19990825-110240-314_L1C_050-257-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990825-110240-314_L1C_050-257-5_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990825-110240-314_L1C_050-257-5_D_V1-0.zip
run script
2024-01-09T16:57:28.165    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T16:57:28.166    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990825-110240-314_L1C_050-257-5_D_V1-0.zip
2024-01-09T16:57:28.166    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:57:28.166    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:57:28.167    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T16:57:28.167    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:57:28.167    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:57:28.167    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:57:28.167    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:57:28.167    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990825-110240-314_L1C_050-257-5_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/08/25/SPOT2-HRV1-XS_19990825-110244-269_L1C_050-258-0_D_V1-0/SPOT2-HRV1-XS_19990825-110244-269_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990825-110244-269_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990825-110244-269_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T17:02:10.119    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:02:10.121    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990825-110244-269_L1C_050-258-0_D_V1-0.zip
2024-01-09T17:02:10.121    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:02:10.121    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:02:10.121    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:02:10.121    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:02:10.121    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:02:10.121    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:02:10.121    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:02:10.121    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:06:17.323    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 414). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990825-110244-269_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1999/08/25/SPOT2-HRV1-XS_19990825-110252-740_L1C_050-259-0_D_V1-0/SPOT2-HRV1-XS_19990825-110252-740_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990825-110252-740_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990825-110252-740_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T17:06:20.740    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:06:20.741    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990825-110252-740_L1C_050-259-0_D_V1-0.zip
2024-01-09T17:06:20.741    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:06:20.741    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:06:20.741    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:06:20.742    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:06:20.742    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:06:20.742    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:06:20.742    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:06:20.742    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990825-110252-740_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/21/SPOT2-HRV2-XS_19990921-104322-105_L1C_050-257-5_D_V1-0/SPOT2-HRV2-XS_19990921-104322-105_L1C_050-257-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990921-104322-105_L1C_050-257-5_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990921-104322-105_L1C_050-257-5_D_V1-0.zip
run script
2024-01-09T17:09:46.401    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:09:46.402    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990921-104322-105_L1C_050-257-5_D_V1-0.zip
2024-01-09T17:09:46.402    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:09:46.402    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:09:46.402    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:09:46.402    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:09:46.402    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:09:46.402    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:09:46.402    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:09:46.402    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990921-104322-105_L1C_050-257-5_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 1]
 [0 0 0 ... 0 0 1]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/21/SPOT2-HRV2-XS_19990921-104325-911_L1C_050-258-0_D_V1-0/SPOT2-HRV2-XS_19990921-104325-911_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990921-104325-911_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990921-104325-911_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T17:13:18.708    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:13:18.709    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990921-104325-911_L1C_050-258-0_D_V1-0.zip
2024-01-09T17:13:18.709    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:13:18.709    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:13:18.709    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:13:18.709    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:13:18.709    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:13:18.709    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:13:18.709    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:13:18.709    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:15:15.726    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 216). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990921-104325-911_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1999/09/21/SPOT2-HRV2-XS_19990921-104334-231_L1C_050-259-0_D_V1-0/SPOT2-HRV2-XS_19990921-104334-231_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990921-104334-231_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990921-104334-231_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T17:15:18.551    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:15:18.552    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990921-104334-231_L1C_050-259-0_D_V1-0.zip
2024-01-09T17:15:18.552    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:15:18.552    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:15:18.552    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:15:18.552    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:15:18.552    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:15:18.552    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:15:18.552    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:15:18.552    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990921-104334-231_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/21/SPOT2-HRV2-XS_19990921-104342-563_L1C_050-260-0_D_V1-0/SPOT2-HRV2-XS_19990921-104342-563_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990921-104342-563_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990921-104342-563_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T17:17:49.402    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:17:49.403    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990921-104342-563_L1C_050-260-0_D_V1-0.zip
2024-01-09T17:17:49.403    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:17:49.403    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:17:49.403    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:17:49.403    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:17:49.403    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:17:49.403    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:17:49.403    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:17:49.404    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990921-104342-563_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/21/SPOT2-HRV2-XS_19990921-104344-368_L1C_050-260-2_D_V1-0/SPOT2-HRV2-XS_19990921-104344-368_L1C_050-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990921-104344-368_L1C_050-260-2_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990921-104344-368_L1C_050-260-2_D_V1-0.zip
run script
2024-01-09T17:19:44.537    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:19:44.538    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990921-104344-368_L1C_050-260-2_D_V1-0.zip
2024-01-09T17:19:44.539    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:19:44.539    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:19:44.539    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:19:44.539    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:19:44.539    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:19:44.539    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:19:44.539    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:19:44.539    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:19:45.972    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 414). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990921-104344-368_L1C_050-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1999/09/21/SPOT2-HRV1-XS_19990921-104400-599_L1C_050-262-1_D_V1-0/SPOT2-HRV1-XS_19990921-104400-599_L1C_050-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990921-104400-599_L1C_050-262-1_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990921-104400-599_L1C_050-262-1_D_V1-0.zip
run script
2024-01-09T17:19:48.741    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:19:48.741    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990921-104400-599_L1C_050-262-1_D_V1-0.zip
2024-01-09T17:19:48.741    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:19:48.741    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:19:48.741    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:19:48.741    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:19:48.741    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:19:48.742    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:19:48.742    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:19:48.742    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990921-104400-599_L1C_050-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/21/SPOT2-HRV1-XS_19990921-104406-916_L1C_050-262-8_D_V1-0/SPOT2-HRV1-XS_19990921-104406-916_L1C_050-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990921-104406-916_L1C_050-262-8_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990921-104406-916_L1C_050-262-8_D_V1-0.zip
run script
2024-01-09T17:20:36.223    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:20:36.232    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990921-104406-916_L1C_050-262-8_D_V1-0.zip
2024-01-09T17:20:36.233    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:20:36.233    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:20:36.233    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:20:36.233    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:20:36.233    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:20:36.233    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:20:36.233    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:20:36.233    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990921-104406-916_L1C_050-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/20/SPOT2-HRV2-XS_19990920-110242-849_L1C_050-258-0_D_V1-0/SPOT2-HRV2-XS_19990920-110242-849_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990920-110242-849_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990920-110242-849_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T17:20:54.077    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:20:54.078    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990920-110242-849_L1C_050-258-0_D_V1-0.zip
2024-01-09T17:20:54.078    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:20:54.078    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:20:54.079    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:20:54.079    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:20:54.079    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:20:54.079    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:20:54.079    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:20:54.079    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:24:54.905    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 232). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990920-110242-849_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1999/09/20/SPOT2-HRV2-XS_19990920-110251-319_L1C_050-259-0_D_V1-0/SPOT2-HRV2-XS_19990920-110251-319_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990920-110251-319_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990920-110251-319_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T17:24:58.161    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:24:58.162    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990920-110251-319_L1C_050-259-0_D_V1-0.zip
2024-01-09T17:24:58.162    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:24:58.162    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:24:58.162    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:24:58.162    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:24:58.163    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:24:58.163    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:24:58.163    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:24:58.163    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990920-110251-319_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/27/SPOT2-HRV1-XS_19990927-102755-705_L1C_050-258-0_D_V1-0/SPOT2-HRV1-XS_19990927-102755-705_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990927-102755-705_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990927-102755-705_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T17:28:49.382    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:28:49.382    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990927-102755-705_L1C_050-258-0_D_V1-0.zip
2024-01-09T17:28:49.382    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:28:49.382    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:28:49.382    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:28:49.382    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:28:49.382    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:28:49.382    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:28:49.382    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:28:49.382    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:31:09.464    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 474). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990927-102755-705_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1999/09/27/SPOT2-HRV1-XS_19990927-102803-953_L1C_050-259-0_D_V1-0/SPOT2-HRV1-XS_19990927-102803-953_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990927-102803-953_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990927-102803-953_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T17:31:12.381    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:31:12.381    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990927-102803-953_L1C_050-259-0_D_V1-0.zip
2024-01-09T17:31:12.382    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:31:12.382    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:31:12.382    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:31:12.382    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:31:12.382    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:31:12.382    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:31:12.382    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:31:12.382    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990927-102803-953_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/27/SPOT2-HRV1-XS_19990927-102822-464_L1C_054-261-6_D_V1-0/SPOT2-HRV1-XS_19990927-102822-464_L1C_054-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990927-102822-464_L1C_054-261-6_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990927-102822-464_L1C_054-261-6_D_V1-0.zip
run script
2024-01-09T17:34:08.711    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:34:08.712    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990927-102822-464_L1C_054-261-6_D_V1-0.zip
2024-01-09T17:34:08.712    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:34:08.712    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:34:08.712    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:34:08.712    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:34:08.712    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:34:08.712    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:34:08.712    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:34:08.712    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990927-102822-464_L1C_054-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/27/SPOT2-HRV1-XS_19990927-102825-346_L1C_054-262-0_D_V1-0/SPOT2-HRV1-XS_19990927-102825-346_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990927-102825-346_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990927-102825-346_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T17:36:27.041    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:36:27.042    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990927-102825-346_L1C_054-262-0_D_V1-0.zip
2024-01-09T17:36:27.042    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:36:27.042    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:36:27.042    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:36:27.042    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:36:27.042    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:36:27.042    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:36:27.042    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:36:27.042    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990927-102825-346_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/10/SPOT2-HRV1-XS_19990910-105519-865_L1C_050-260-0_D_V1-0/SPOT2-HRV1-XS_19990910-105519-865_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990910-105519-865_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990910-105519-865_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T17:38:44.616    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:38:44.616    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990910-105519-865_L1C_050-260-0_D_V1-0.zip
2024-01-09T17:38:44.616    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:38:44.616    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:38:44.617    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:38:44.617    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:38:44.617    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:38:44.617    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:38:44.617    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:38:44.617    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:41:04.326    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1762 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990910-105519-865_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1999/09/10/SPOT2-HRV1-XS_19990910-105525-280_L1C_050-260-6_D_V1-0/SPOT2-HRV1-XS_19990910-105525-280_L1C_050-260-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990910-105525-280_L1C_050-260-6_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990910-105525-280_L1C_050-260-6_D_V1-0.zip
run script
2024-01-09T17:41:07.651    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:41:07.652    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990910-105525-280_L1C_050-260-6_D_V1-0.zip
2024-01-09T17:41:07.652    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:41:07.652    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:41:07.652    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:41:07.652    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:41:07.652    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:41:07.652    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:41:07.652    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:41:07.652    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990910-105525-280_L1C_050-260-6_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/10/SPOT2-HRV1-XS_19990910-105500-061_L1C_051-257-6_D_V1-0/SPOT2-HRV1-XS_19990910-105500-061_L1C_051-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990910-105500-061_L1C_051-257-6_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990910-105500-061_L1C_051-257-6_D_V1-0.zip
run script
2024-01-09T17:43:19.762    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:43:19.763    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990910-105500-061_L1C_051-257-6_D_V1-0.zip
2024-01-09T17:43:19.763    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:43:19.763    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:43:19.763    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:43:19.763    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:43:19.763    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:43:19.763    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:43:19.763    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:43:19.763    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990910-105500-061_L1C_051-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/10/SPOT2-HRV1-XS_19990910-105503-048_L1C_051-258-0_D_V1-0/SPOT2-HRV1-XS_19990910-105503-048_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990910-105503-048_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990910-105503-048_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T17:47:26.333    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:47:26.334    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990910-105503-048_L1C_051-258-0_D_V1-0.zip
2024-01-09T17:47:26.334    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:47:26.334    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:47:26.334    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:47:26.334    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:47:26.334    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:47:26.334    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:47:26.334    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:47:26.334    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990910-105503-048_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/09/10/SPOT2-HRV1-XS_19990910-105511-452_L1C_051-259-0_D_V1-0/SPOT2-HRV1-XS_19990910-105511-452_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990910-105511-452_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990910-105511-452_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T17:51:03.060    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:51:03.061    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990910-105511-452_L1C_051-259-0_D_V1-0.zip
2024-01-09T17:51:03.061    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:51:03.061    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:51:03.061    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:51:03.061    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:51:03.061    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:51:03.061    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:51:03.061    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:51:03.061    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990910-105511-452_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/11/01/SPOT2-HRV1-XS_19991101-105455-125_L1C_050-260-0_D_V1-0/SPOT2-HRV1-XS_19991101-105455-125_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991101-105455-125_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991101-105455-125_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T17:53:59.605    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:53:59.606    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991101-105455-125_L1C_050-260-0_D_V1-0.zip
2024-01-09T17:53:59.606    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:53:59.606    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:53:59.606    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:53:59.606    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:53:59.606    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:53:59.606    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:53:59.606    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:53:59.607    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:56:00.182    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (217 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991101-105455-125_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1999/11/01/SPOT2-HRV1-XS_19991101-105503-544_L1C_050-261-0_D_V1-0/SPOT2-HRV1-XS_19991101-105503-544_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991101-105503-544_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991101-105503-544_L1C_050-261-0_D_V1-0.zip
run script
2024-01-09T17:56:03.420    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:56:03.420    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991101-105503-544_L1C_050-261-0_D_V1-0.zip
2024-01-09T17:56:03.420    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:56:03.420    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:56:03.420    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:56:03.420    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:56:03.420    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:56:03.420    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:56:03.420    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:56:03.420    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991101-105503-544_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/11/01/SPOT2-HRV1-XS_19991101-105511-964_L1C_050-262-0_D_V1-0/SPOT2-HRV1-XS_19991101-105511-964_L1C_050-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991101-105511-964_L1C_050-262-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991101-105511-964_L1C_050-262-0_D_V1-0.zip
run script
2024-01-09T17:57:48.436    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:57:48.436    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991101-105511-964_L1C_050-262-0_D_V1-0.zip
2024-01-09T17:57:48.436    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:57:48.436    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:57:48.437    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:57:48.437    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:57:48.437    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:57:48.437    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:57:48.437    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:57:48.437    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991101-105511-964_L1C_050-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/11/01/SPOT2-HRV1-XS_19991101-105443-722_L1C_051-258-6_D_V1-0/SPOT2-HRV1-XS_19991101-105443-722_L1C_051-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991101-105443-722_L1C_051-258-6_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991101-105443-722_L1C_051-258-6_D_V1-0.zip
run script
2024-01-09T17:59:04.825    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:59:04.826    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991101-105443-722_L1C_051-258-6_D_V1-0.zip
2024-01-09T17:59:04.826    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:59:04.826    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:59:04.826    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:59:04.826    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:59:04.826    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:59:04.826    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:59:04.826    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:59:04.826    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991101-105443-722_L1C_051-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 0 ... 2 2 2]
 [1 1 0 ... 2 2 2]
 [1 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/11/01/SPOT2-HRV1-XS_19991101-105446-715_L1C_051-259-0_D_V1-0/SPOT2-HRV1-XS_19991101-105446-715_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991101-105446-715_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991101-105446-715_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T18:02:15.047    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:02:15.048    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991101-105446-715_L1C_051-259-0_D_V1-0.zip
2024-01-09T18:02:15.048    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:02:15.048    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:02:15.048    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:02:15.049    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:02:15.049    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:02:15.049    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:02:15.049    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:02:15.049    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991101-105446-715_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 0 ... 2 2 2]
 [1 0 0 ... 2 2 2]
 [1 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/08/05/SPOT2-HRV2-XS_19990805-104803-030_L1C_050-262-2_D_V1-0/SPOT2-HRV2-XS_19990805-104803-030_L1C_050-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990805-104803-030_L1C_050-262-2_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990805-104803-030_L1C_050-262-2_D_V1-0.zip
run script
2024-01-09T18:05:14.995    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:05:14.996    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990805-104803-030_L1C_050-262-2_D_V1-0.zip
2024-01-09T18:05:14.996    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:05:14.996    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:05:14.996    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:05:14.996    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:05:14.996    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:05:14.996    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:05:14.996    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:05:14.996    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990805-104803-030_L1C_050-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/03/13/SPOT2-HRV2-XS_19990313-103525-218_L1C_051-254-0_D_V1-0/SPOT2-HRV2-XS_19990313-103525-218_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990313-103525-218_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990313-103525-218_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T18:06:12.969    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:06:12.970    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990313-103525-218_L1C_051-254-0_D_V1-0.zip
2024-01-09T18:06:12.970    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:06:12.971    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:06:12.971    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:06:12.971    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:06:12.971    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:06:12.971    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:06:12.971    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:06:12.971    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990313-103525-218_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1999/03/13/SPOT2-HRV2-XS_19990313-103526-120_L1C_051-254-1_D_V1-0/SPOT2-HRV2-XS_19990313-103526-120_L1C_051-254-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990313-103526-120_L1C_051-254-1_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990313-103526-120_L1C_051-254-1_D_V1-0.zip
run script
2024-01-09T18:06:15.946    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:06:15.946    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990313-103526-120_L1C_051-254-1_D_V1-0.zip
2024-01-09T18:06:15.946    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:06:15.946    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:06:15.946    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:06:15.946    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:06:15.946    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:06:15.946    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:06:15.946    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:06:15.946    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990313-103526-120_L1C_051-254-1_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1999/06/30/SPOT2-HRV2-XS_19990630-103943-757_L1C_051-257-4_D_V1-0/SPOT2-HRV2-XS_19990630-103943-757_L1C_051-257-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990630-103943-757_L1C_051-257-4_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990630-103943-757_L1C_051-257-4_D_V1-0.zip
run script
2024-01-09T18:06:19.585    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:06:19.585    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990630-103943-757_L1C_051-257-4_D_V1-0.zip
2024-01-09T18:06:19.585    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:06:19.585    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:06:19.586    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:06:19.586    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:06:19.586    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:06:19.586    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:06:19.586    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:06:19.586    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990630-103943-757_L1C_051-257-4_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/30/SPOT2-HRV2-XS_19990630-103948-444_L1C_051-258-0_D_V1-0/SPOT2-HRV2-XS_19990630-103948-444_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990630-103948-444_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990630-103948-444_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T18:09:31.386    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:09:31.387    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990630-103948-444_L1C_051-258-0_D_V1-0.zip
2024-01-09T18:09:31.387    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:09:31.388    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:09:31.388    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:09:31.388    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:09:31.388    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:09:31.388    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:09:31.388    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:09:31.388    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T18:11:21.272    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 217). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990630-103948-444_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1999/06/30/SPOT2-HRV2-XS_19990630-103956-746_L1C_051-259-0_D_V1-0/SPOT2-HRV2-XS_19990630-103956-746_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990630-103956-746_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990630-103956-746_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T18:11:24.411    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:11:24.412    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990630-103956-746_L1C_051-259-0_D_V1-0.zip
2024-01-09T18:11:24.412    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:11:24.413    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:11:24.413    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:11:24.413    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:11:24.413    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:11:24.413    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:11:24.413    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:11:24.413    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990630-103956-746_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 1 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/30/SPOT2-HRV2-XS_19990630-104005-057_L1C_051-260-0_D_V1-0/SPOT2-HRV2-XS_19990630-104005-057_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990630-104005-057_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990630-104005-057_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T18:13:57.082    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:13:57.084    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990630-104005-057_L1C_051-260-0_D_V1-0.zip
2024-01-09T18:13:57.084    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:13:57.084    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:13:57.084    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:13:57.084    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:13:57.084    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:13:57.084    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:13:57.084    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:13:57.084    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T18:15:45.406    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (205 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990630-104005-057_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1999/06/30/SPOT2-HRV1-XS_19990630-104005-620_L1C_054-260-5_D_V1-0/SPOT2-HRV1-XS_19990630-104005-620_L1C_054-260-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990630-104005-620_L1C_054-260-5_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990630-104005-620_L1C_054-260-5_D_V1-0.zip
run script
2024-01-09T18:15:48.233    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:15:48.234    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990630-104005-620_L1C_054-260-5_D_V1-0.zip
2024-01-09T18:15:48.234    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:15:48.234    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:15:48.234    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:15:48.234    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:15:48.234    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:15:48.234    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:15:48.234    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:15:48.234    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990630-104005-620_L1C_054-260-5_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/25/SPOT2-HRV2-XS_19990625-103615-391_L1C_051-260-5_D_V1-0/SPOT2-HRV2-XS_19990625-103615-391_L1C_051-260-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990625-103615-391_L1C_051-260-5_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990625-103615-391_L1C_051-260-5_D_V1-0.zip
run script
2024-01-09T18:17:49.429    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:17:49.430    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990625-103615-391_L1C_051-260-5_D_V1-0.zip
2024-01-09T18:17:49.430    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:17:49.430    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:17:49.430    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:17:49.431    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:17:49.431    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:17:49.431    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:17:49.431    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:17:49.431    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990625-103615-391_L1C_051-260-5_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/25/SPOT2-HRV2-XS_19990625-103619-178_L1C_051-261-0_D_V1-0/SPOT2-HRV2-XS_19990625-103619-178_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990625-103619-178_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990625-103619-178_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T18:19:40.809    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:19:40.810    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990625-103619-178_L1C_051-261-0_D_V1-0.zip
2024-01-09T18:19:40.810    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:19:40.811    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:19:40.811    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:19:40.811    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:19:40.811    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:19:40.811    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:19:40.811    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:19:40.811    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990625-103619-178_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/25/SPOT2-HRV2-XS_19990625-103627-484_L1C_051-262-0_D_V1-0/SPOT2-HRV2-XS_19990625-103627-484_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990625-103627-484_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990625-103627-484_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T18:21:26.005    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:21:26.006    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990625-103627-484_L1C_051-262-0_D_V1-0.zip
2024-01-09T18:21:26.006    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:21:26.006    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:21:26.006    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:21:26.006    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:21:26.006    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:21:26.006    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:21:26.007    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:21:26.007    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990625-103627-484_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/05/10/SPOT2-HRV2-XS_19990510-102101-059_L1C_051-262-1_D_V1-0/SPOT2-HRV2-XS_19990510-102101-059_L1C_051-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990510-102101-059_L1C_051-262-1_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990510-102101-059_L1C_051-262-1_D_V1-0.zip
run script
2024-01-09T18:22:41.275    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:22:41.277    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990510-102101-059_L1C_051-262-1_D_V1-0.zip
2024-01-09T18:22:41.277    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:22:41.277    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:22:41.277    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:22:41.277    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:22:41.277    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:22:41.277    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:22:41.277    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:22:41.277    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T18:24:47.786    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1666 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990510-102101-059_L1C_051-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1999/05/10/SPOT2-HRV2-XS_19990510-102107-376_L1C_051-262-8_D_V1-0/SPOT2-HRV2-XS_19990510-102107-376_L1C_051-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990510-102107-376_L1C_051-262-8_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990510-102107-376_L1C_051-262-8_D_V1-0.zip
run script
2024-01-09T18:24:50.706    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:24:50.707    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990510-102107-376_L1C_051-262-8_D_V1-0.zip
2024-01-09T18:24:50.707    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:24:50.707    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:24:50.707    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:24:50.707    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:24:50.707    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:24:50.707    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:24:50.707    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:24:50.707    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990510-102107-376_L1C_051-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/03/18/SPOT2-HRV2-XS_19990318-103938-436_L1C_052-257-0_D_V1-0/SPOT2-HRV2-XS_19990318-103938-436_L1C_052-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990318-103938-436_L1C_052-257-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990318-103938-436_L1C_052-257-0_D_V1-0.zip
run script
2024-01-09T18:25:55.162    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:25:55.163    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990318-103938-436_L1C_052-257-0_D_V1-0.zip
2024-01-09T18:25:55.164    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:25:55.164    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:25:55.164    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:25:55.164    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:25:55.164    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:25:55.164    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:25:55.164    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:25:55.164    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990318-103938-436_L1C_052-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 1 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/03/18/SPOT2-HRV2-XS_19990318-103946-747_L1C_052-258-0_D_V1-0/SPOT2-HRV2-XS_19990318-103946-747_L1C_052-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990318-103946-747_L1C_052-258-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990318-103946-747_L1C_052-258-0_D_V1-0.zip
run script
2024-01-09T18:28:36.463    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:28:36.464    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990318-103946-747_L1C_052-258-0_D_V1-0.zip
2024-01-09T18:28:36.464    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:28:36.465    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:28:36.465    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:28:36.465    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:28:36.465    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:28:36.465    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:28:36.465    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:28:36.465    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990318-103946-747_L1C_052-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/03/18/SPOT2-HRV2-XS_19990318-103955-067_L1C_052-259-0_D_V1-0/SPOT2-HRV2-XS_19990318-103955-067_L1C_052-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990318-103955-067_L1C_052-259-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990318-103955-067_L1C_052-259-0_D_V1-0.zip
run script
2024-01-09T18:31:25.278    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:31:25.278    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990318-103955-067_L1C_052-259-0_D_V1-0.zip
2024-01-09T18:31:25.279    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:31:25.279    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:31:25.279    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:31:25.279    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:31:25.279    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:31:25.279    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:31:25.280    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:31:25.280    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990318-103955-067_L1C_052-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 1 0 0]
 [2 2 2 ... 1 0 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/03/18/SPOT2-HRV2-XS_19990318-103957-775_L1C_052-259-3_D_V1-0/SPOT2-HRV2-XS_19990318-103957-775_L1C_052-259-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990318-103957-775_L1C_052-259-3_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990318-103957-775_L1C_052-259-3_D_V1-0.zip
run script
2024-01-09T18:34:27.165    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:34:27.166    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990318-103957-775_L1C_052-259-3_D_V1-0.zip
2024-01-09T18:34:27.166    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:34:27.166    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:34:27.166    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:34:27.166    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:34:27.166    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:34:27.166    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:34:27.166    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:34:27.166    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990318-103957-775_L1C_052-259-3_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 2 2]
 [2 2 2 ... 0 2 2]
 [2 2 2 ... 0 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/05/09/SPOT2-HRV1-XS_19990509-103938-411_L1C_052-257-0_D_V1-0/SPOT2-HRV1-XS_19990509-103938-411_L1C_052-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990509-103938-411_L1C_052-257-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990509-103938-411_L1C_052-257-0_D_V1-0.zip
run script
2024-01-09T18:37:31.348    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:37:31.349    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990509-103938-411_L1C_052-257-0_D_V1-0.zip
2024-01-09T18:37:31.349    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:37:31.349    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:37:31.349    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:37:31.349    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:37:31.349    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:37:31.350    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:37:31.350    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:37:31.350    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990509-103938-411_L1C_052-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 0 0 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/05/09/SPOT2-HRV1-XS_19990509-103946-719_L1C_052-258-0_D_V1-0/SPOT2-HRV1-XS_19990509-103946-719_L1C_052-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990509-103946-719_L1C_052-258-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990509-103946-719_L1C_052-258-0_D_V1-0.zip
run script
2024-01-09T18:40:07.349    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:40:07.351    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990509-103946-719_L1C_052-258-0_D_V1-0.zip
2024-01-09T18:40:07.351    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:40:07.351    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:40:07.351    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:40:07.351    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:40:07.351    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:40:07.351    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:40:07.351    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:40:07.351    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990509-103946-719_L1C_052-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/05/09/SPOT2-HRV1-XS_19990509-103955-036_L1C_052-259-0_D_V1-0/SPOT2-HRV1-XS_19990509-103955-036_L1C_052-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990509-103955-036_L1C_052-259-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990509-103955-036_L1C_052-259-0_D_V1-0.zip
run script
2024-01-09T18:42:49.099    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:42:49.100    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990509-103955-036_L1C_052-259-0_D_V1-0.zip
2024-01-09T18:42:49.100    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:42:49.100    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:42:49.100    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:42:49.100    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:42:49.100    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:42:49.100    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:42:49.100    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:42:49.100    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990509-103955-036_L1C_052-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 2 2]
 [2 2 2 ... 0 2 2]
 [2 2 2 ... 0 0 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 1 0 ... 2 2 2]
 [0 1 1 ... 2 2 2]
 [0 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/05/09/SPOT2-HRV1-XS_19990509-104003-359_L1C_052-260-0_D_V1-0/SPOT2-HRV1-XS_19990509-104003-359_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990509-104003-359_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990509-104003-359_L1C_052-260-0_D_V1-0.zip
run script
2024-01-09T18:45:51.490    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:45:51.491    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990509-104003-359_L1C_052-260-0_D_V1-0.zip
2024-01-09T18:45:51.491    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:45:51.491    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:45:51.491    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:45:51.491    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:45:51.491    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:45:51.491    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:45:51.491    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:45:51.491    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990509-104003-359_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/05/09/SPOT2-HRV1-XS_19990509-104005-164_L1C_052-260-2_D_V1-0/SPOT2-HRV1-XS_19990509-104005-164_L1C_052-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990509-104005-164_L1C_052-260-2_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990509-104005-164_L1C_052-260-2_D_V1-0.zip
run script
2024-01-09T18:48:34.220    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:48:34.221    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990509-104005-164_L1C_052-260-2_D_V1-0.zip
2024-01-09T18:48:34.221    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:48:34.222    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:48:34.222    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:48:34.222    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:48:34.222    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:48:34.222    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:48:34.222    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:48:34.222    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990509-104005-164_L1C_052-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/01/SPOT2-HRV1-XS_19990701-102025-584_L1C_052-257-7_D_V1-0/SPOT2-HRV1-XS_19990701-102025-584_L1C_052-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990701-102025-584_L1C_052-257-7_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990701-102025-584_L1C_052-257-7_D_V1-0.zip
run script
2024-01-09T18:51:13.655    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:51:13.657    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990701-102025-584_L1C_052-257-7_D_V1-0.zip
2024-01-09T18:51:13.657    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:51:13.657    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:51:13.657    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:51:13.657    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:51:13.657    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:51:13.657    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:51:13.657    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:51:13.657    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990701-102025-584_L1C_052-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/01/SPOT2-HRV1-XS_19990701-102027-491_L1C_052-258-0_D_V1-0/SPOT2-HRV1-XS_19990701-102027-491_L1C_052-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990701-102027-491_L1C_052-258-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990701-102027-491_L1C_052-258-0_D_V1-0.zip
run script
2024-01-09T18:54:33.868    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:54:33.869    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990701-102027-491_L1C_052-258-0_D_V1-0.zip
2024-01-09T18:54:33.869    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:54:33.869    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:54:33.869    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:54:33.869    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:54:33.869    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:54:33.869    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:54:33.869    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:54:33.869    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990701-102027-491_L1C_052-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/01/SPOT2-HRV1-XS_19990701-102035-727_L1C_052-259-0_D_V1-0/SPOT2-HRV1-XS_19990701-102035-727_L1C_052-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990701-102035-727_L1C_052-259-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990701-102035-727_L1C_052-259-0_D_V1-0.zip
run script
2024-01-09T18:57:37.983    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:57:37.984    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990701-102035-727_L1C_052-259-0_D_V1-0.zip
2024-01-09T18:57:37.984    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:57:37.984    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:57:37.984    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:57:37.984    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:57:37.984    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:57:37.984    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:57:37.984    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:57:37.984    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990701-102035-727_L1C_052-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/01/SPOT2-HRV1-XS_19990701-102043-969_L1C_052-260-0_D_V1-0/SPOT2-HRV1-XS_19990701-102043-969_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990701-102043-969_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990701-102043-969_L1C_052-260-0_D_V1-0.zip
run script
2024-01-09T19:00:55.924    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:00:55.925    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990701-102043-969_L1C_052-260-0_D_V1-0.zip
2024-01-09T19:00:55.925    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:00:55.925    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:00:55.925    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:00:55.925    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:00:55.925    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:00:55.925    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:00:55.925    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:00:55.925    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990701-102043-969_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/01/SPOT2-HRV1-XS_19990701-102045-774_L1C_052-260-2_D_V1-0/SPOT2-HRV1-XS_19990701-102045-774_L1C_052-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990701-102045-774_L1C_052-260-2_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990701-102045-774_L1C_052-260-2_D_V1-0.zip
run script
2024-01-09T19:03:50.288    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:03:50.289    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990701-102045-774_L1C_052-260-2_D_V1-0.zip
2024-01-09T19:03:50.289    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:03:50.289    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:03:50.289    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:03:50.289    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:03:50.290    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:03:50.290    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:03:50.290    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:03:50.290    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T19:05:17.264    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 1466). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990701-102045-774_L1C_052-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1999/07/05/SPOT2-HRV2-XS_19990705-104336-949_L1C_052-257-6_D_V1-0/SPOT2-HRV2-XS_19990705-104336-949_L1C_052-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990705-104336-949_L1C_052-257-6_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990705-104336-949_L1C_052-257-6_D_V1-0.zip
run script
2024-01-09T19:05:20.218    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:05:20.220    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990705-104336-949_L1C_052-257-6_D_V1-0.zip
2024-01-09T19:05:20.220    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:05:20.220    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:05:20.220    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:05:20.220    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:05:20.220    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:05:20.220    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:05:20.220    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:05:20.220    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990705-104336-949_L1C_052-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/05/SPOT2-HRV2-XS_19990705-104339-870_L1C_052-258-0_D_V1-0/SPOT2-HRV2-XS_19990705-104339-870_L1C_052-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990705-104339-870_L1C_052-258-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990705-104339-870_L1C_052-258-0_D_V1-0.zip
run script
2024-01-09T19:08:16.516    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:08:16.517    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990705-104339-870_L1C_052-258-0_D_V1-0.zip
2024-01-09T19:08:16.517    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:08:16.517    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:08:16.518    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:08:16.518    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:08:16.518    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:08:16.518    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:08:16.518    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:08:16.518    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990705-104339-870_L1C_052-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/05/SPOT2-HRV2-XS_19990705-104348-211_L1C_052-259-0_D_V1-0/SPOT2-HRV2-XS_19990705-104348-211_L1C_052-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990705-104348-211_L1C_052-259-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990705-104348-211_L1C_052-259-0_D_V1-0.zip
run script
2024-01-09T19:11:02.727    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:11:02.728    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990705-104348-211_L1C_052-259-0_D_V1-0.zip
2024-01-09T19:11:02.728    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:11:02.728    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:11:02.728    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:11:02.728    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:11:02.728    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:11:02.728    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:11:02.729    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:11:02.729    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990705-104348-211_L1C_052-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/05/SPOT2-HRV2-XS_19990705-104356-562_L1C_052-260-0_D_V1-0/SPOT2-HRV2-XS_19990705-104356-562_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990705-104356-562_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990705-104356-562_L1C_052-260-0_D_V1-0.zip
run script
2024-01-09T19:14:09.238    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:14:09.239    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990705-104356-562_L1C_052-260-0_D_V1-0.zip
2024-01-09T19:14:09.239    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:14:09.239    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:14:09.239    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:14:09.239    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:14:09.239    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:14:09.239    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:14:09.239    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:14:09.239    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990705-104356-562_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/05/SPOT2-HRV2-XS_19990705-104404-915_L1C_052-261-0_D_V1-0/SPOT2-HRV2-XS_19990705-104404-915_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990705-104404-915_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990705-104404-915_L1C_052-261-0_D_V1-0.zip
run script
2024-01-09T19:16:53.910    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:16:53.911    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990705-104404-915_L1C_052-261-0_D_V1-0.zip
2024-01-09T19:16:53.912    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:16:53.912    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:16:53.912    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:16:53.912    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:16:53.912    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:16:53.912    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:16:53.912    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:16:53.912    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990705-104404-915_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/05/SPOT2-HRV2-XS_19990705-104412-134_L1C_052-261-8_D_V1-0/SPOT2-HRV2-XS_19990705-104412-134_L1C_052-261-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990705-104412-134_L1C_052-261-8_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990705-104412-134_L1C_052-261-8_D_V1-0.zip
run script
2024-01-09T19:19:49.640    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:19:49.641    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990705-104412-134_L1C_052-261-8_D_V1-0.zip
2024-01-09T19:19:49.641    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:19:49.641    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:19:49.642    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:19:49.642    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:19:49.642    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:19:49.642    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:19:49.642    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:19:49.642    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990705-104412-134_L1C_052-261-8_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/05/SPOT2-HRV1-XS_19990705-104402-554_L1C_054-261-0_D_V1-0/SPOT2-HRV1-XS_19990705-104402-554_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990705-104402-554_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990705-104402-554_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T19:22:11.931    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:22:11.932    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990705-104402-554_L1C_054-261-0_D_V1-0.zip
2024-01-09T19:22:11.933    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:22:11.933    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:22:11.933    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:22:11.933    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:22:11.933    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:22:11.933    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:22:11.933    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:22:11.933    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T19:22:13.744    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (242 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990705-104402-554_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1999/07/05/SPOT2-HRV1-XS_19990705-104410-940_L1C_054-262-0_D_V1-0/SPOT2-HRV1-XS_19990705-104410-940_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990705-104410-940_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990705-104410-940_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T19:22:16.779    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:22:16.780    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990705-104410-940_L1C_054-262-0_D_V1-0.zip
2024-01-09T19:22:16.780    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:22:16.780    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:22:16.780    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:22:16.780    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:22:16.780    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:22:16.780    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:22:16.780    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:22:16.780    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990705-104410-940_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/21/SPOT2-HRV1-XS_19990721-103553-504_L1C_052-257-6_D_V1-0/SPOT2-HRV1-XS_19990721-103553-504_L1C_052-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990721-103553-504_L1C_052-257-6_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990721-103553-504_L1C_052-257-6_D_V1-0.zip
run script
2024-01-09T19:24:35.362    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:24:35.363    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990721-103553-504_L1C_052-257-6_D_V1-0.zip
2024-01-09T19:24:35.363    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:24:35.363    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:24:35.363    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:24:35.363    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:24:35.363    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:24:35.363    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:24:35.363    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:24:35.363    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990721-103553-504_L1C_052-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 0]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 2 2]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/21/SPOT2-HRV1-XS_19990721-103556-379_L1C_052-258-0_D_V1-0/SPOT2-HRV1-XS_19990721-103556-379_L1C_052-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990721-103556-379_L1C_052-258-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990721-103556-379_L1C_052-258-0_D_V1-0.zip
run script
2024-01-09T19:27:17.733    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:27:17.734    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990721-103556-379_L1C_052-258-0_D_V1-0.zip
2024-01-09T19:27:17.734    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:27:17.734    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:27:17.734    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:27:17.734    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:27:17.734    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:27:17.734    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:27:17.735    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:27:17.735    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990721-103556-379_L1C_052-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/21/SPOT2-HRV1-XS_19990721-103604-678_L1C_052-259-0_D_V1-0/SPOT2-HRV1-XS_19990721-103604-678_L1C_052-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990721-103604-678_L1C_052-259-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990721-103604-678_L1C_052-259-0_D_V1-0.zip
run script
2024-01-09T19:29:55.547    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:29:55.548    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990721-103604-678_L1C_052-259-0_D_V1-0.zip
2024-01-09T19:29:55.548    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:29:55.548    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:29:55.549    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:29:55.549    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:29:55.549    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:29:55.549    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:29:55.549    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:29:55.549    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990721-103604-678_L1C_052-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/21/SPOT2-HRV1-XS_19990721-103612-984_L1C_052-260-0_D_V1-0/SPOT2-HRV1-XS_19990721-103612-984_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990721-103612-984_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990721-103612-984_L1C_052-260-0_D_V1-0.zip
run script
2024-01-09T19:32:59.855    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:32:59.856    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990721-103612-984_L1C_052-260-0_D_V1-0.zip
2024-01-09T19:32:59.856    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:32:59.856    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:32:59.856    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:32:59.856    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:32:59.856    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:32:59.856    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:32:59.857    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:32:59.857    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990721-103612-984_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/21/SPOT2-HRV1-XS_19990721-103614-788_L1C_052-260-2_D_V1-0/SPOT2-HRV1-XS_19990721-103614-788_L1C_052-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990721-103614-788_L1C_052-260-2_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990721-103614-788_L1C_052-260-2_D_V1-0.zip
run script
2024-01-09T19:35:42.667    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:35:42.669    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990721-103614-788_L1C_052-260-2_D_V1-0.zip
2024-01-09T19:35:42.669    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:35:42.669    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:35:42.669    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:35:42.669    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:35:42.669    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:35:42.669    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:35:42.669    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:35:42.669    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990721-103614-788_L1C_052-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/03/23/SPOT2-HRV1-XS_19990323-104339-391_L1C_052-258-0_D_V1-0/SPOT2-HRV1-XS_19990323-104339-391_L1C_052-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990323-104339-391_L1C_052-258-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990323-104339-391_L1C_052-258-0_D_V1-0.zip
run script
2024-01-09T19:38:23.563    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:38:23.564    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990323-104339-391_L1C_052-258-0_D_V1-0.zip
2024-01-09T19:38:23.564    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:38:23.564    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:38:23.564    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:38:23.564    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:38:23.564    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:38:23.564    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:38:23.564    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:38:23.564    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990323-104339-391_L1C_052-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/03/23/SPOT2-HRV1-XS_19990323-104347-735_L1C_052-259-0_D_V1-0/SPOT2-HRV1-XS_19990323-104347-735_L1C_052-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990323-104347-735_L1C_052-259-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990323-104347-735_L1C_052-259-0_D_V1-0.zip
run script
2024-01-09T19:41:08.323    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:41:08.324    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990323-104347-735_L1C_052-259-0_D_V1-0.zip
2024-01-09T19:41:08.324    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:41:08.324    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:41:08.324    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:41:08.324    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:41:08.324    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:41:08.324    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:41:08.324    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:41:08.324    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990323-104347-735_L1C_052-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 0 1 1]
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/03/23/SPOT2-HRV1-XS_19990323-104356-085_L1C_052-260-0_D_V1-0/SPOT2-HRV1-XS_19990323-104356-085_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990323-104356-085_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990323-104356-085_L1C_052-260-0_D_V1-0.zip
run script
2024-01-09T19:44:12.741    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:44:12.743    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990323-104356-085_L1C_052-260-0_D_V1-0.zip
2024-01-09T19:44:12.743    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:44:12.743    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:44:12.743    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:44:12.743    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:44:12.743    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:44:12.743    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:44:12.743    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:44:12.743    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990323-104356-085_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/03/23/SPOT2-HRV1-XS_19990323-104403-304_L1C_052-260-8_D_V1-0/SPOT2-HRV1-XS_19990323-104403-304_L1C_052-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990323-104403-304_L1C_052-260-8_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990323-104403-304_L1C_052-260-8_D_V1-0.zip
run script
2024-01-09T19:46:57.378    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:46:57.379    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990323-104403-304_L1C_052-260-8_D_V1-0.zip
2024-01-09T19:46:57.379    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:46:57.379    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:46:57.379    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:46:57.379    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:46:57.379    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:46:57.379    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:46:57.379    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:46:57.379    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990323-104403-304_L1C_052-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [2 1 1 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/04/08/SPOT2-HRV2-XS_19990408-103601-730_L1C_052-258-0_D_V1-0/SPOT2-HRV2-XS_19990408-103601-730_L1C_052-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990408-103601-730_L1C_052-258-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990408-103601-730_L1C_052-258-0_D_V1-0.zip
run script
2024-01-09T19:50:00.008    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:50:00.009    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990408-103601-730_L1C_052-258-0_D_V1-0.zip
2024-01-09T19:50:00.009    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:50:00.009    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:50:00.009    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:50:00.010    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:50:00.010    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:50:00.010    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:50:00.010    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:50:00.010    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990408-103601-730_L1C_052-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/04/08/SPOT2-HRV2-XS_19990408-103610-026_L1C_052-259-0_D_V1-0/SPOT2-HRV2-XS_19990408-103610-026_L1C_052-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990408-103610-026_L1C_052-259-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990408-103610-026_L1C_052-259-0_D_V1-0.zip
run script
2024-01-09T19:52:39.374    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:52:39.375    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990408-103610-026_L1C_052-259-0_D_V1-0.zip
2024-01-09T19:52:39.376    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:52:39.376    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:52:39.376    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:52:39.376    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:52:39.376    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:52:39.376    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:52:39.376    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:52:39.376    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990408-103610-026_L1C_052-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/04/08/SPOT2-HRV2-XS_19990408-103618-335_L1C_052-260-0_D_V1-0/SPOT2-HRV2-XS_19990408-103618-335_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990408-103618-335_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990408-103618-335_L1C_052-260-0_D_V1-0.zip
run script
2024-01-09T19:55:38.818    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:55:38.819    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990408-103618-335_L1C_052-260-0_D_V1-0.zip
2024-01-09T19:55:38.819    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:55:38.819    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:55:38.819    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:55:38.819    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:55:38.819    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:55:38.819    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:55:38.819    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:55:38.820    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990408-103618-335_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/04/08/SPOT2-HRV2-XS_19990408-103620-139_L1C_052-260-2_D_V1-0/SPOT2-HRV2-XS_19990408-103620-139_L1C_052-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990408-103620-139_L1C_052-260-2_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990408-103620-139_L1C_052-260-2_D_V1-0.zip
run script
2024-01-09T19:58:20.535    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:58:20.537    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990408-103620-139_L1C_052-260-2_D_V1-0.zip
2024-01-09T19:58:20.537    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:58:20.537    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:58:20.537    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:58:20.537    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:58:20.537    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:58:20.537    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:58:20.537    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:58:20.537    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990408-103620-139_L1C_052-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [2 2 1 ... 2 2 2]
 [2 2 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/26/SPOT2-HRV2-XS_19990626-101648-186_L1C_052-259-8_D_V1-0/SPOT2-HRV2-XS_19990626-101648-186_L1C_052-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990626-101648-186_L1C_052-259-8_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990626-101648-186_L1C_052-259-8_D_V1-0.zip
run script
2024-01-09T20:00:57.239    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:00:57.240    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990626-101648-186_L1C_052-259-8_D_V1-0.zip
2024-01-09T20:00:57.240    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:00:57.240    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:00:57.240    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:00:57.240    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:00:57.240    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:00:57.240    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:00:57.240    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:00:57.240    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T20:02:21.940    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 308). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990626-101648-186_L1C_052-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1999/07/06/SPOT2-HRV2-XS_19990706-102429-147_L1C_052-259-0_D_V1-0/SPOT2-HRV2-XS_19990706-102429-147_L1C_052-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990706-102429-147_L1C_052-259-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990706-102429-147_L1C_052-259-0_D_V1-0.zip
run script
2024-01-09T20:02:25.028    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:02:25.030    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990706-102429-147_L1C_052-259-0_D_V1-0.zip
2024-01-09T20:02:25.030    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:02:25.030    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:02:25.030    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:02:25.030    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:02:25.030    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:02:25.030    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:02:25.030    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:02:25.030    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990706-102429-147_L1C_052-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/06/SPOT2-HRV2-XS_19990706-102437-401_L1C_052-260-0_D_V1-0/SPOT2-HRV2-XS_19990706-102437-401_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990706-102437-401_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990706-102437-401_L1C_052-260-0_D_V1-0.zip
run script
2024-01-09T20:05:20.327    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:05:20.328    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990706-102437-401_L1C_052-260-0_D_V1-0.zip
2024-01-09T20:05:20.328    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:05:20.328    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:05:20.328    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:05:20.328    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:05:20.328    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:05:20.328    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:05:20.328    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:05:20.328    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990706-102437-401_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/06/SPOT2-HRV2-XS_19990706-102439-206_L1C_052-260-2_D_V1-0/SPOT2-HRV2-XS_19990706-102439-206_L1C_052-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990706-102439-206_L1C_052-260-2_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990706-102439-206_L1C_052-260-2_D_V1-0.zip
run script
2024-01-09T20:07:51.595    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:07:51.596    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990706-102439-206_L1C_052-260-2_D_V1-0.zip
2024-01-09T20:07:51.596    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:07:51.596    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:07:51.596    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:07:51.596    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:07:51.596    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:07:51.596    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:07:51.596    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:07:51.596    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T20:09:08.858    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 1442). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990706-102439-206_L1C_052-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1999/10/08/SPOT2-HRV1-XS_19991008-101621-702_L1C_052-259-5_D_V1-0/SPOT2-HRV1-XS_19991008-101621-702_L1C_052-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991008-101621-702_L1C_052-259-5_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991008-101621-702_L1C_052-259-5_D_V1-0.zip
run script
2024-01-09T20:09:11.980    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:09:11.981    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991008-101621-702_L1C_052-259-5_D_V1-0.zip
2024-01-09T20:09:11.981    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:09:11.981    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:09:11.981    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:09:11.981    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:09:11.981    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:09:11.981    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:09:11.981    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:09:11.981    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991008-101621-702_L1C_052-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/08/SPOT2-HRV1-XS_19991008-101625-426_L1C_052-260-0_D_V1-0/SPOT2-HRV1-XS_19991008-101625-426_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991008-101625-426_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991008-101625-426_L1C_052-260-0_D_V1-0.zip
run script
2024-01-09T20:12:15.060    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:12:15.061    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991008-101625-426_L1C_052-260-0_D_V1-0.zip
2024-01-09T20:12:15.061    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:12:15.061    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:12:15.061    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:12:15.062    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:12:15.062    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:12:15.062    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:12:15.062    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:12:15.062    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991008-101625-426_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/08/SPOT2-HRV1-XS_19991008-101633-671_L1C_052-261-0_D_V1-0/SPOT2-HRV1-XS_19991008-101633-671_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991008-101633-671_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991008-101633-671_L1C_052-261-0_D_V1-0.zip
run script
2024-01-09T20:14:56.064    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:14:56.065    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991008-101633-671_L1C_052-261-0_D_V1-0.zip
2024-01-09T20:14:56.065    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:14:56.065    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:14:56.065    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:14:56.065    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:14:56.065    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:14:56.065    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:14:56.066    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:14:56.066    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991008-101633-671_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/08/SPOT2-HRV1-XS_19991008-101641-922_L1C_052-262-0_D_V1-0/SPOT2-HRV1-XS_19991008-101641-922_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991008-101641-922_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991008-101641-922_L1C_052-262-0_D_V1-0.zip
run script
2024-01-09T20:17:49.579    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:17:49.580    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991008-101641-922_L1C_052-262-0_D_V1-0.zip
2024-01-09T20:17:49.580    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:17:49.580    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:17:49.580    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:17:49.580    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:17:49.581    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:17:49.581    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:17:49.581    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:17:49.581    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991008-101641-922_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/08/SPOT2-HRV1-XS_19991008-101645-531_L1C_052-262-4_D_V1-0/SPOT2-HRV1-XS_19991008-101645-531_L1C_052-262-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19991008-101645-531_L1C_052-262-4_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991008-101645-531_L1C_052-262-4_D_V1-0.zip
run script
2024-01-09T20:20:19.483    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:20:19.484    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991008-101645-531_L1C_052-262-4_D_V1-0.zip
2024-01-09T20:20:19.484    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:20:19.484    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:20:19.484    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:20:19.484    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:20:19.485    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:20:19.485    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:20:19.485    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:20:19.485    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19991008-101645-531_L1C_052-262-4_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/08/SPOT2-HRV2-XS_19991008-101631-920_L1C_054-261-0_D_V1-0/SPOT2-HRV2-XS_19991008-101631-920_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19991008-101631-920_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19991008-101631-920_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T20:22:29.086    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:22:29.088    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19991008-101631-920_L1C_054-261-0_D_V1-0.zip
2024-01-09T20:22:29.088    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:22:29.088    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:22:29.088    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:22:29.088    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:22:29.088    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:22:29.088    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:22:29.088    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:22:29.088    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19991008-101631-920_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/10/08/SPOT2-HRV2-XS_19991008-101640-180_L1C_054-262-0_D_V1-0/SPOT2-HRV2-XS_19991008-101640-180_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19991008-101640-180_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19991008-101640-180_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T20:23:58.816    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:23:58.817    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19991008-101640-180_L1C_054-262-0_D_V1-0.zip
2024-01-09T20:23:58.817    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:23:58.817    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:23:58.818    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:23:58.818    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:23:58.818    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:23:58.818    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:23:58.818    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:23:58.818    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19991008-101640-180_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/04/13/SPOT2-HRV2-XS_19990413-104011-696_L1C_052-260-1_D_V1-0/SPOT2-HRV2-XS_19990413-104011-696_L1C_052-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990413-104011-696_L1C_052-260-1_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990413-104011-696_L1C_052-260-1_D_V1-0.zip
run script
2024-01-09T20:25:35.117    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:25:35.118    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990413-104011-696_L1C_052-260-1_D_V1-0.zip
2024-01-09T20:25:35.118    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:25:35.118    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:25:35.118    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:25:35.118    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:25:35.118    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:25:35.118    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:25:35.118    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:25:35.118    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990413-104011-696_L1C_052-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/03/24/SPOT2-HRV1-XS_19990324-102433-582_L1C_053-259-6_D_V1-0/SPOT2-HRV1-XS_19990324-102433-582_L1C_053-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990324-102433-582_L1C_053-259-6_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990324-102433-582_L1C_053-259-6_D_V1-0.zip
run script
2024-01-09T20:27:57.408    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:27:57.409    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990324-102433-582_L1C_053-259-6_D_V1-0.zip
2024-01-09T20:27:57.409    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:27:57.409    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:27:57.409    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:27:57.409    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:27:57.409    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:27:57.410    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:27:57.410    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:27:57.410    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990324-102433-582_L1C_053-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 0]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 0 0 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/03/24/SPOT2-HRV1-XS_19990324-102436-431_L1C_053-260-0_D_V1-0/SPOT2-HRV1-XS_19990324-102436-431_L1C_053-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990324-102436-431_L1C_053-260-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990324-102436-431_L1C_053-260-0_D_V1-0.zip
run script
2024-01-09T20:30:15.301    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:30:15.302    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990324-102436-431_L1C_053-260-0_D_V1-0.zip
2024-01-09T20:30:15.302    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:30:15.302    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:30:15.302    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:30:15.302    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:30:15.302    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:30:15.302    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:30:15.303    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:30:15.303    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990324-102436-431_L1C_053-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/03/24/SPOT2-HRV1-XS_19990324-102439-138_L1C_053-260-3_D_V1-0/SPOT2-HRV1-XS_19990324-102439-138_L1C_053-260-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990324-102439-138_L1C_053-260-3_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990324-102439-138_L1C_053-260-3_D_V1-0.zip
run script
2024-01-09T20:32:26.458    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:32:26.459    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990324-102439-138_L1C_053-260-3_D_V1-0.zip
2024-01-09T20:32:26.459    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:32:26.459    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:32:26.459    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:32:26.459    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:32:26.459    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:32:26.459    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:32:26.459    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:32:26.459    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990324-102439-138_L1C_053-260-3_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/05/29/SPOT2-HRV1-XS_19990529-105537-459_L1C_053-261-0_D_V1-0/SPOT2-HRV1-XS_19990529-105537-459_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990529-105537-459_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990529-105537-459_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T20:34:56.142    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:34:56.143    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990529-105537-459_L1C_053-261-0_D_V1-0.zip
2024-01-09T20:34:56.143    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:34:56.143    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:34:56.143    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:34:56.143    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:34:56.143    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:34:56.143    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:34:56.143    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:34:56.143    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990529-105537-459_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/05/29/SPOT2-HRV1-XS_19990529-105541-068_L1C_053-261-4_D_V1-0/SPOT2-HRV1-XS_19990529-105541-068_L1C_053-261-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990529-105541-068_L1C_053-261-4_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990529-105541-068_L1C_053-261-4_D_V1-0.zip
run script
2024-01-09T20:37:48.078    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:37:48.079    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990529-105541-068_L1C_053-261-4_D_V1-0.zip
2024-01-09T20:37:48.079    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:37:48.079    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:37:48.079    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:37:48.079    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:37:48.079    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:37:48.080    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:37:48.080    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:37:48.080    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990529-105541-068_L1C_053-261-4_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/02/04/SPOT2-HRV2-XS_19990204-104745-629_L1C_054-260-6_D_V1-0/SPOT2-HRV2-XS_19990204-104745-629_L1C_054-260-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990204-104745-629_L1C_054-260-6_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990204-104745-629_L1C_054-260-6_D_V1-0.zip
run script
2024-01-09T20:40:50.869    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:40:50.870    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990204-104745-629_L1C_054-260-6_D_V1-0.zip
2024-01-09T20:40:50.870    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:40:50.871    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:40:50.871    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:40:50.871    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:40:50.871    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:40:50.871    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:40:50.871    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:40:50.871    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990204-104745-629_L1C_054-260-6_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [1 0 0 ... 2 2 2]
 [1 1 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/05/31/SPOT2-HRV1-XS_19990531-101658-283_L1C_054-260-7_D_V1-0/SPOT2-HRV1-XS_19990531-101658-283_L1C_054-260-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990531-101658-283_L1C_054-260-7_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990531-101658-283_L1C_054-260-7_D_V1-0.zip
run script
2024-01-09T20:42:55.325    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:42:55.326    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990531-101658-283_L1C_054-260-7_D_V1-0.zip
2024-01-09T20:42:55.326    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:42:55.326    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:42:55.326    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:42:55.327    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:42:55.327    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:42:55.327    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:42:55.327    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:42:55.327    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990531-101658-283_L1C_054-260-7_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/05/SPOT2-HRV2-XS_19990605-102047-900_L1C_054-260-5_D_V1-0/SPOT2-HRV2-XS_19990605-102047-900_L1C_054-260-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990605-102047-900_L1C_054-260-5_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990605-102047-900_L1C_054-260-5_D_V1-0.zip
run script
2024-01-09T20:44:45.321    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:44:45.322    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990605-102047-900_L1C_054-260-5_D_V1-0.zip
2024-01-09T20:44:45.322    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:44:45.322    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:44:45.322    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:44:45.322    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:44:45.322    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:44:45.322    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:44:45.322    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:44:45.322    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990605-102047-900_L1C_054-260-5_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/06/24/SPOT2-HRV1-XS_19990624-105530-287_L1C_054-260-8_D_V1-0/SPOT2-HRV1-XS_19990624-105530-287_L1C_054-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990624-105530-287_L1C_054-260-8_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990624-105530-287_L1C_054-260-8_D_V1-0.zip
run script
2024-01-09T20:46:26.284    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:46:26.285    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990624-105530-287_L1C_054-260-8_D_V1-0.zip
2024-01-09T20:46:26.285    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:46:26.285    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:46:26.285    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:46:26.285    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:46:26.285    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:46:26.285    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:46:26.285    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:46:26.285    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T20:46:27.820    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (842 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990624-105530-287_L1C_054-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1999/06/24/SPOT2-HRV1-XS_19990624-105531-541_L1C_054-261-0_D_V1-0/SPOT2-HRV1-XS_19990624-105531-541_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990624-105531-541_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990624-105531-541_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T20:46:30.962    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:46:30.963    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990624-105531-541_L1C_054-261-0_D_V1-0.zip
2024-01-09T20:46:30.963    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:46:30.963    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:46:30.963    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:46:30.963    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:46:30.963    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:46:30.963    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:46:30.963    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:46:30.963    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T20:46:33.253    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (248 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990624-105531-541_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1999/06/24/SPOT2-HRV1-XS_19990624-105540-015_L1C_054-262-0_D_V1-0/SPOT2-HRV1-XS_19990624-105540-015_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990624-105540-015_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990624-105540-015_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T20:46:36.195    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:46:36.197    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990624-105540-015_L1C_054-262-0_D_V1-0.zip
2024-01-09T20:46:36.197    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:46:36.197    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:46:36.197    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:46:36.197    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:46:36.197    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:46:36.197    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:46:36.197    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:46:36.197    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990624-105540-015_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/07/27/SPOT2-HRV1-XS_19990727-102048-899_L1C_054-260-8_D_V1-0/SPOT2-HRV1-XS_19990727-102048-899_L1C_054-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990727-102048-899_L1C_054-260-8_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990727-102048-899_L1C_054-260-8_D_V1-0.zip
run script
2024-01-09T20:49:16.862    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:49:16.863    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990727-102048-899_L1C_054-260-8_D_V1-0.zip
2024-01-09T20:49:16.863    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:49:16.863    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:49:16.863    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:49:16.863    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:49:16.863    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:49:16.863    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:49:16.863    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:49:16.863    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990727-102048-899_L1C_054-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/02/10/SPOT2-HRV1-XS_19990210-103225-320_L1C_054-261-0_D_V1-0/SPOT2-HRV1-XS_19990210-103225-320_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990210-103225-320_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990210-103225-320_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T20:50:59.099    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:50:59.100    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990210-103225-320_L1C_054-261-0_D_V1-0.zip
2024-01-09T20:50:59.100    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:50:59.100    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:50:59.100    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:50:59.100    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:50:59.100    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:50:59.101    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:50:59.101    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:50:59.101    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990210-103225-320_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/02/10/SPOT2-HRV1-XS_19990210-103233-634_L1C_054-262-0_D_V1-0/SPOT2-HRV1-XS_19990210-103233-634_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19990210-103233-634_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990210-103233-634_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T20:52:43.985    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:52:43.986    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990210-103233-634_L1C_054-262-0_D_V1-0.zip
2024-01-09T20:52:43.986    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:52:43.986    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:52:43.986    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:52:43.986    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:52:43.986    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:52:43.986    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:52:43.986    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:52:43.986    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T20:52:46.210    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (227 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV1-XS_19990210-103233-634_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1999/08/15/SPOT2-HRV2-XS_19990815-105523-424_L1C_054-261-0_D_V1-0/SPOT2-HRV2-XS_19990815-105523-424_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990815-105523-424_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990815-105523-424_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T20:52:49.110    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:52:49.112    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990815-105523-424_L1C_054-261-0_D_V1-0.zip
2024-01-09T20:52:49.112    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:52:49.112    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:52:49.112    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:52:49.112    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:52:49.112    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:52:49.112    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:52:49.112    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:52:49.112    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990815-105523-424_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/08/15/SPOT2-HRV2-XS_19990815-105531-898_L1C_054-262-0_D_V1-0/SPOT2-HRV2-XS_19990815-105531-898_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990815-105531-898_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990815-105531-898_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T20:55:25.859    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:55:25.861    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990815-105531-898_L1C_054-262-0_D_V1-0.zip
2024-01-09T20:55:25.861    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:55:25.861    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:55:25.861    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:55:25.861    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:55:25.861    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:55:25.861    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:55:25.861    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:55:25.861    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990815-105531-898_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1999/08/15/SPOT2-HRV2-XS_19990815-105536-410_L1C_054-262-5_D_V1-0/SPOT2-HRV2-XS_19990815-105536-410_L1C_054-262-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19990815-105536-410_L1C_054-262-5_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990815-105536-410_L1C_054-262-5_D_V1-0.zip
run script
2024-01-09T20:58:18.317    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:58:18.318    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990815-105536-410_L1C_054-262-5_D_V1-0.zip
2024-01-09T20:58:18.318    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:58:18.318    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:58:18.318    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:58:18.318    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:58:18.318    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:58:18.318    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:58:18.318    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:58:18.319    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT2-HRV2-XS_19990815-105536-410_L1C_054-262-5_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/06/08/SPOT1-HRV1-XS_19970608-102202-192_L1C_046-263-0_D_V1-0/SPOT1-HRV1-XS_19970608-102202-192_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970608-102202-192_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970608-102202-192_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T21:00:24.399    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:00:24.400    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970608-102202-192_L1C_046-263-0_D_V1-0.zip
2024-01-09T21:00:24.400    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:00:24.400    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:00:24.400    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:00:24.400    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:00:24.400    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:00:24.400    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:00:24.400    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:00:24.400    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970608-102202-192_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/06/08/SPOT1-HRV1-XS_19970608-102109-760_L1C_048-256-8_D_V1-0/SPOT1-HRV1-XS_19970608-102109-760_L1C_048-256-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970608-102109-760_L1C_048-256-8_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970608-102109-760_L1C_048-256-8_D_V1-0.zip
run script
2024-01-09T21:00:40.833    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:00:40.835    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970608-102109-760_L1C_048-256-8_D_V1-0.zip
2024-01-09T21:00:40.835    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:00:40.835    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:00:40.835    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:00:40.835    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:00:40.835    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:00:40.835    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:00:40.835    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:00:40.835    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970608-102109-760_L1C_048-256-8_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/06/08/SPOT1-HRV1-XS_19970608-102110-770_L1C_048-257-0_D_V1-0/SPOT1-HRV1-XS_19970608-102110-770_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970608-102110-770_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970608-102110-770_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T21:01:06.052    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:01:06.054    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970608-102110-770_L1C_048-257-0_D_V1-0.zip
2024-01-09T21:01:06.054    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:01:06.054    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:01:06.054    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:01:06.054    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:01:06.054    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:01:06.054    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:01:06.054    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:01:06.054    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970608-102110-770_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/06/08/SPOT1-HRV1-XS_19970608-102119-012_L1C_048-258-0_D_V1-0/SPOT1-HRV1-XS_19970608-102119-012_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970608-102119-012_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970608-102119-012_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T21:01:30.730    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:01:30.731    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970608-102119-012_L1C_048-258-0_D_V1-0.zip
2024-01-09T21:01:30.731    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:01:30.731    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:01:30.731    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:01:30.731    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:01:30.731    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:01:30.732    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:01:30.732    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:01:30.732    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970608-102119-012_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/06/08/SPOT1-HRV1-XS_19970608-102124-427_L1C_048-258-6_D_V1-0/SPOT1-HRV1-XS_19970608-102124-427_L1C_048-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970608-102124-427_L1C_048-258-6_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970608-102124-427_L1C_048-258-6_D_V1-0.zip
run script
2024-01-09T21:01:37.617    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:01:37.618    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970608-102124-427_L1C_048-258-6_D_V1-0.zip
2024-01-09T21:01:37.618    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:01:37.618    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:01:37.618    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:01:37.618    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:01:37.618    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:01:37.618    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:01:37.618    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:01:37.618    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970608-102124-427_L1C_048-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/10/14/SPOT1-HRV2-XS_19971014-110427-048_L1C_046-263-0_D_V1-0/SPOT1-HRV2-XS_19971014-110427-048_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19971014-110427-048_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19971014-110427-048_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T21:01:40.509    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:01:40.511    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19971014-110427-048_L1C_046-263-0_D_V1-0.zip
2024-01-09T21:01:40.511    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:01:40.511    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:01:40.511    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:01:40.511    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:01:40.511    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:01:40.511    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:01:40.511    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:01:40.511    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19971014-110427-048_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/04/17/SPOT1-HRV1-XS_19970417-101919-208_L1C_047-254-6_D_V1-0/SPOT1-HRV1-XS_19970417-101919-208_L1C_047-254-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970417-101919-208_L1C_047-254-6_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970417-101919-208_L1C_047-254-6_D_V1-0.zip
run script
2024-01-09T21:02:04.537    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:02:04.538    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970417-101919-208_L1C_047-254-6_D_V1-0.zip
2024-01-09T21:02:04.538    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:02:04.538    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:02:04.538    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:02:04.538    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:02:04.538    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:02:04.539    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:02:04.539    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:02:04.539    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970417-101919-208_L1C_047-254-6_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/06/12/SPOT1-HRV1-XS_19970612-104410-606_L1C_047-254-6_D_V1-0/SPOT1-HRV1-XS_19970612-104410-606_L1C_047-254-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970612-104410-606_L1C_047-254-6_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970612-104410-606_L1C_047-254-6_D_V1-0.zip
run script
2024-01-09T21:02:10.022    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:02:10.023    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970612-104410-606_L1C_047-254-6_D_V1-0.zip
2024-01-09T21:02:10.023    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:02:10.023    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:02:10.023    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:02:10.023    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:02:10.023    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:02:10.024    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:02:10.024    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:02:10.024    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970612-104410-606_L1C_047-254-6_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/07/09/SPOT1-HRV1-XS_19970709-102544-269_L1C_047-254-6_D_V1-0/SPOT1-HRV1-XS_19970709-102544-269_L1C_047-254-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970709-102544-269_L1C_047-254-6_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970709-102544-269_L1C_047-254-6_D_V1-0.zip
run script
2024-01-09T21:02:15.938    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:02:15.939    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970709-102544-269_L1C_047-254-6_D_V1-0.zip
2024-01-09T21:02:15.939    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:02:15.939    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:02:15.939    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:02:15.939    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:02:15.939    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:02:15.939    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:02:15.939    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:02:15.939    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970709-102544-269_L1C_047-254-6_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/07/09/SPOT1-HRV1-XS_19970709-102602-251_L1C_048-256-8_D_V1-0/SPOT1-HRV1-XS_19970709-102602-251_L1C_048-256-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970709-102602-251_L1C_048-256-8_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970709-102602-251_L1C_048-256-8_D_V1-0.zip
run script
2024-01-09T21:02:21.287    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:02:21.288    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970709-102602-251_L1C_048-256-8_D_V1-0.zip
2024-01-09T21:02:21.288    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:02:21.289    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:02:21.289    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:02:21.289    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:02:21.289    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:02:21.289    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:02:21.289    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:02:21.289    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970709-102602-251_L1C_048-256-8_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/07/09/SPOT1-HRV1-XS_19970709-102603-277_L1C_048-257-0_D_V1-0/SPOT1-HRV1-XS_19970709-102603-277_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970709-102603-277_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970709-102603-277_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T21:02:33.645    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:02:33.646    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970709-102603-277_L1C_048-257-0_D_V1-0.zip
2024-01-09T21:02:33.646    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:02:33.647    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:02:33.648    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:02:33.648    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:02:33.648    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:02:33.648    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:02:33.648    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:02:33.648    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970709-102603-277_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/07/09/SPOT1-HRV1-XS_19970709-102611-528_L1C_048-258-0_D_V1-0/SPOT1-HRV1-XS_19970709-102611-528_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970709-102611-528_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970709-102611-528_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T21:02:44.552    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:02:44.553    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970709-102611-528_L1C_048-258-0_D_V1-0.zip
2024-01-09T21:02:44.553    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:02:44.553    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:02:44.553    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:02:44.553    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:02:44.553    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:02:44.553    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:02:44.553    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:02:44.553    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970709-102611-528_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/07/09/SPOT1-HRV1-XS_19970709-102619-788_L1C_048-259-0_D_V1-0/SPOT1-HRV1-XS_19970709-102619-788_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970709-102619-788_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970709-102619-788_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T21:02:47.569    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:02:47.570    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970709-102619-788_L1C_048-259-0_D_V1-0.zip
2024-01-09T21:02:47.570    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:02:47.570    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:02:47.571    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:02:47.571    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:02:47.571    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:02:47.571    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:02:47.572    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:02:47.572    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970709-102619-788_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/07/09/SPOT1-HRV1-XS_19970709-102621-593_L1C_048-259-2_D_V1-0/SPOT1-HRV1-XS_19970709-102621-593_L1C_048-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970709-102621-593_L1C_048-259-2_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970709-102621-593_L1C_048-259-2_D_V1-0.zip
run script
2024-01-09T21:02:51.029    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:02:51.030    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970709-102621-593_L1C_048-259-2_D_V1-0.zip
2024-01-09T21:02:51.030    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:02:51.031    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:02:51.031    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:02:51.031    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:02:51.031    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:02:51.031    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:02:51.031    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:02:51.031    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970709-102621-593_L1C_048-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/07/09/SPOT1-HRV2-XS_19970709-102602-158_L1C_049-256-9_D_V1-0/SPOT1-HRV2-XS_19970709-102602-158_L1C_049-256-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970709-102602-158_L1C_049-256-9_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970709-102602-158_L1C_049-256-9_D_V1-0.zip
run script
2024-01-09T21:02:54.022    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:02:54.023    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970709-102602-158_L1C_049-256-9_D_V1-0.zip
2024-01-09T21:02:54.023    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:02:54.023    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:02:54.023    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:02:54.023    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:02:54.023    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:02:54.024    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:02:54.024    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:02:54.024    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970709-102602-158_L1C_049-256-9_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/07/09/SPOT1-HRV2-XS_19970709-102602-287_L1C_049-257-0_D_V1-0/SPOT1-HRV2-XS_19970709-102602-287_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970709-102602-287_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970709-102602-287_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T21:03:54.254    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:03:54.255    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970709-102602-287_L1C_049-257-0_D_V1-0.zip
2024-01-09T21:03:54.255    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:03:54.255    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:03:54.255    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:03:54.255    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:03:54.255    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:03:54.256    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:03:54.256    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:03:54.256    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970709-102602-287_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/07/09/SPOT1-HRV2-XS_19970709-102610-547_L1C_049-258-0_D_V1-0/SPOT1-HRV2-XS_19970709-102610-547_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970709-102610-547_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970709-102610-547_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T21:04:52.548    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:04:52.550    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970709-102610-547_L1C_049-258-0_D_V1-0.zip
2024-01-09T21:04:52.550    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:04:52.550    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:04:52.550    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:04:52.550    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:04:52.550    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:04:52.550    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:04:52.550    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:04:52.551    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970709-102610-547_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/07/09/SPOT1-HRV2-XS_19970709-102618-816_L1C_049-259-0_D_V1-0/SPOT1-HRV2-XS_19970709-102618-816_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970709-102618-816_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970709-102618-816_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T21:05:32.562    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:05:32.563    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970709-102618-816_L1C_049-259-0_D_V1-0.zip
2024-01-09T21:05:32.563    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:05:32.563    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:05:32.563    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:05:32.563    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:05:32.563    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:05:32.563    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:05:32.563    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:05:32.563    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970709-102618-816_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/07/09/SPOT1-HRV2-XS_19970709-102621-523_L1C_049-259-3_D_V1-0/SPOT1-HRV2-XS_19970709-102621-523_L1C_049-259-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970709-102621-523_L1C_049-259-3_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970709-102621-523_L1C_049-259-3_D_V1-0.zip
run script
2024-01-09T21:05:58.885    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:05:58.886    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970709-102621-523_L1C_049-259-3_D_V1-0.zip
2024-01-09T21:05:58.886    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:05:58.886    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:05:58.886    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:05:58.886    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:05:58.886    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:05:58.886    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:05:58.886    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:05:58.886    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970709-102621-523_L1C_049-259-3_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/07/09/SPOT1-HRV1-XS_19970709-102640-955_L1C_049-261-6_D_V1-0/SPOT1-HRV1-XS_19970709-102640-955_L1C_049-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970709-102640-955_L1C_049-261-6_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970709-102640-955_L1C_049-261-6_D_V1-0.zip
run script
2024-01-09T21:06:20.401    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:06:20.402    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970709-102640-955_L1C_049-261-6_D_V1-0.zip
2024-01-09T21:06:20.402    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:06:20.402    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:06:20.402    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:06:20.403    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:06:20.403    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:06:20.403    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:06:20.403    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:06:20.403    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970709-102640-955_L1C_049-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/07/09/SPOT1-HRV1-XS_19970709-102643-831_L1C_049-262-0_D_V1-0/SPOT1-HRV1-XS_19970709-102643-831_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970709-102643-831_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970709-102643-831_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T21:06:23.363    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:06:23.364    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970709-102643-831_L1C_049-262-0_D_V1-0.zip
2024-01-09T21:06:23.365    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:06:23.365    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:06:23.365    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:06:23.365    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:06:23.365    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:06:23.365    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:06:23.365    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:06:23.365    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970709-102643-831_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/02/07/SPOT1-HRV2-XS_19970207-104354-306_L1C_047-255-0_D_V1-0/SPOT1-HRV2-XS_19970207-104354-306_L1C_047-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970207-104354-306_L1C_047-255-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970207-104354-306_L1C_047-255-0_D_V1-0.zip
run script
2024-01-09T21:06:26.268    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:06:26.269    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970207-104354-306_L1C_047-255-0_D_V1-0.zip
2024-01-09T21:06:26.269    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:06:26.269    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:06:26.269    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:06:26.269    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:06:26.269    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:06:26.269    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:06:26.269    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:06:26.269    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970207-104354-306_L1C_047-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/02/07/SPOT1-HRV2-XS_19970207-104402-677_L1C_047-256-0_D_V1-0/SPOT1-HRV2-XS_19970207-104402-677_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970207-104402-677_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970207-104402-677_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T21:06:37.973    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:06:37.974    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970207-104402-677_L1C_047-256-0_D_V1-0.zip
2024-01-09T21:06:37.974    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:06:37.974    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:06:37.974    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:06:37.974    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:06:37.974    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:06:37.974    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:06:37.974    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:06:37.975    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T21:06:40.772    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (454 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970207-104402-677_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1997/02/07/SPOT1-HRV2-XS_19970207-104403-580_L1C_047-256-1_D_V1-0/SPOT1-HRV2-XS_19970207-104403-580_L1C_047-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970207-104403-580_L1C_047-256-1_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970207-104403-580_L1C_047-256-1_D_V1-0.zip
run script
2024-01-09T21:06:43.554    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:06:43.555    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970207-104403-580_L1C_047-256-1_D_V1-0.zip
2024-01-09T21:06:43.555    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:06:43.555    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:06:43.555    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:06:43.555    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:06:43.555    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:06:43.555    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:06:43.556    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:06:43.556    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T21:06:45.588    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (466 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970207-104403-580_L1C_047-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1997/03/31/SPOT1-HRV2-XS_19970331-104553-645_L1C_047-255-0_D_V1-0/SPOT1-HRV2-XS_19970331-104553-645_L1C_047-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970331-104553-645_L1C_047-255-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970331-104553-645_L1C_047-255-0_D_V1-0.zip
run script
2024-01-09T21:06:48.553    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:06:48.554    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970331-104553-645_L1C_047-255-0_D_V1-0.zip
2024-01-09T21:06:48.554    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:06:48.554    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:06:48.554    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:06:48.554    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:06:48.554    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:06:48.554    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:06:48.554    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:06:48.554    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970331-104553-645_L1C_047-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/03/31/SPOT1-HRV2-XS_19970331-104602-014_L1C_047-256-0_D_V1-0/SPOT1-HRV2-XS_19970331-104602-014_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970331-104602-014_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970331-104602-014_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T21:06:58.438    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:06:58.440    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970331-104602-014_L1C_047-256-0_D_V1-0.zip
2024-01-09T21:06:58.440    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:06:58.440    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:06:58.440    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:06:58.440    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:06:58.440    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:06:58.440    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:06:58.440    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:06:58.440    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970331-104602-014_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/03/31/SPOT1-HRV2-XS_19970331-104602-916_L1C_047-256-1_D_V1-0/SPOT1-HRV2-XS_19970331-104602-916_L1C_047-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970331-104602-916_L1C_047-256-1_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970331-104602-916_L1C_047-256-1_D_V1-0.zip
run script
2024-01-09T21:07:01.425    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:07:01.427    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970331-104602-916_L1C_047-256-1_D_V1-0.zip
2024-01-09T21:07:01.427    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:07:01.427    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:07:01.427    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:07:01.427    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:07:01.427    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:07:01.427    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:07:01.427    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:07:01.427    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970331-104602-916_L1C_047-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/04/22/SPOT1-HRV1-XS_19970422-102322-556_L1C_047-255-0_D_V1-0/SPOT1-HRV1-XS_19970422-102322-556_L1C_047-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970422-102322-556_L1C_047-255-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970422-102322-556_L1C_047-255-0_D_V1-0.zip
run script
2024-01-09T21:07:04.521    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:07:04.522    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970422-102322-556_L1C_047-255-0_D_V1-0.zip
2024-01-09T21:07:04.522    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:07:04.523    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:07:04.523    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:07:04.523    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:07:04.523    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:07:04.523    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:07:04.523    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:07:04.523    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970422-102322-556_L1C_047-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/04/22/SPOT1-HRV1-XS_19970422-102327-068_L1C_047-255-5_D_V1-0/SPOT1-HRV1-XS_19970422-102327-068_L1C_047-255-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970422-102327-068_L1C_047-255-5_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970422-102327-068_L1C_047-255-5_D_V1-0.zip
run script
2024-01-09T21:07:15.356    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:07:15.357    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970422-102327-068_L1C_047-255-5_D_V1-0.zip
2024-01-09T21:07:15.357    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:07:15.357    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:07:15.357    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:07:15.357    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:07:15.357    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:07:15.357    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:07:15.357    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:07:15.357    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970422-102327-068_L1C_047-255-5_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/07/08/SPOT1-HRV2-XS_19970708-104503-647_L1C_047-255-0_D_V1-0/SPOT1-HRV2-XS_19970708-104503-647_L1C_047-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970708-104503-647_L1C_047-255-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970708-104503-647_L1C_047-255-0_D_V1-0.zip
run script
2024-01-09T21:07:30.159    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:07:30.160    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970708-104503-647_L1C_047-255-0_D_V1-0.zip
2024-01-09T21:07:30.160    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:07:30.160    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:07:30.161    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:07:30.161    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:07:30.161    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:07:30.161    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:07:30.161    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:07:30.161    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970708-104503-647_L1C_047-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/07/08/SPOT1-HRV2-XS_19970708-104504-549_L1C_047-255-1_D_V1-0/SPOT1-HRV2-XS_19970708-104504-549_L1C_047-255-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970708-104504-549_L1C_047-255-1_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970708-104504-549_L1C_047-255-1_D_V1-0.zip
run script
2024-01-09T21:07:44.758    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:07:44.760    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970708-104504-549_L1C_047-255-1_D_V1-0.zip
2024-01-09T21:07:44.760    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:07:44.760    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:07:44.760    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:07:44.760    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:07:44.760    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:07:44.760    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:07:44.760    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:07:44.760    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970708-104504-549_L1C_047-255-1_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/07/08/SPOT1-HRV1-XS_19970708-104557-072_L1C_049-261-6_D_V1-0/SPOT1-HRV1-XS_19970708-104557-072_L1C_049-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970708-104557-072_L1C_049-261-6_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970708-104557-072_L1C_049-261-6_D_V1-0.zip
run script
2024-01-09T21:07:58.420    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:07:58.421    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970708-104557-072_L1C_049-261-6_D_V1-0.zip
2024-01-09T21:07:58.421    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:07:58.421    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:07:58.421    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:07:58.421    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:07:58.421    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:07:58.421    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:07:58.421    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:07:58.422    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970708-104557-072_L1C_049-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/07/08/SPOT1-HRV1-XS_19970708-104600-059_L1C_049-262-0_D_V1-0/SPOT1-HRV1-XS_19970708-104600-059_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970708-104600-059_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970708-104600-059_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T21:08:03.452    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:08:03.454    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970708-104600-059_L1C_049-262-0_D_V1-0.zip
2024-01-09T21:08:03.454    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:08:03.454    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:08:03.454    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:08:03.454    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:08:03.454    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:08:03.454    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:08:03.454    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:08:03.454    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970708-104600-059_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/08/14/SPOT1-HRV2-XS_19970814-103445-452_L1C_047-255-6_D_V1-0/SPOT1-HRV2-XS_19970814-103445-452_L1C_047-255-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970814-103445-452_L1C_047-255-6_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970814-103445-452_L1C_047-255-6_D_V1-0.zip
run script
2024-01-09T21:08:06.497    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:08:06.498    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970814-103445-452_L1C_047-255-6_D_V1-0.zip
2024-01-09T21:08:06.498    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:08:06.498    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:08:06.498    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:08:06.498    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:08:06.498    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:08:06.498    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:08:06.498    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:08:06.498    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970814-103445-452_L1C_047-255-6_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/08/14/SPOT1-HRV2-XS_19970814-103448-303_L1C_047-256-0_D_V1-0/SPOT1-HRV2-XS_19970814-103448-303_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970814-103448-303_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970814-103448-303_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T21:08:09.497    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:08:09.498    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970814-103448-303_L1C_047-256-0_D_V1-0.zip
2024-01-09T21:08:09.498    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:08:09.498    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:08:09.498    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:08:09.498    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:08:09.498    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:08:09.498    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:08:09.498    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:08:09.498    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970814-103448-303_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/08/14/SPOT1-HRV2-XS_19970814-103452-815_L1C_047-256-5_D_V1-0/SPOT1-HRV2-XS_19970814-103452-815_L1C_047-256-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970814-103452-815_L1C_047-256-5_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970814-103452-815_L1C_047-256-5_D_V1-0.zip
run script
2024-01-09T21:08:12.583    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:08:12.584    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970814-103452-815_L1C_047-256-5_D_V1-0.zip
2024-01-09T21:08:12.584    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:08:12.584    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:08:12.584    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:08:12.584    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:08:12.584    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:08:12.584    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:08:12.584    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:08:12.585    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970814-103452-815_L1C_047-256-5_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/08/14/SPOT1-HRV1-XS_19970814-103445-695_L1C_048-255-8_D_V1-0/SPOT1-HRV1-XS_19970814-103445-695_L1C_048-255-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970814-103445-695_L1C_048-255-8_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970814-103445-695_L1C_048-255-8_D_V1-0.zip
run script
2024-01-09T21:08:15.478    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:08:15.480    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970814-103445-695_L1C_048-255-8_D_V1-0.zip
2024-01-09T21:08:15.480    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:08:15.480    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:08:15.480    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:08:15.480    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:08:15.480    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:08:15.480    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:08:15.480    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:08:15.480    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970814-103445-695_L1C_048-255-8_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/14/SPOT1-HRV1-XS_19970814-103446-754_L1C_048-256-0_D_V1-0/SPOT1-HRV1-XS_19970814-103446-754_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970814-103446-754_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970814-103446-754_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T21:09:11.757    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:09:11.758    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970814-103446-754_L1C_048-256-0_D_V1-0.zip
2024-01-09T21:09:11.758    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:09:11.758    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:09:11.758    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:09:11.758    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:09:11.758    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:09:11.758    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:09:11.758    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:09:11.758    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970814-103446-754_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/14/SPOT1-HRV1-XS_19970814-103452-169_L1C_048-256-6_D_V1-0/SPOT1-HRV1-XS_19970814-103452-169_L1C_048-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970814-103452-169_L1C_048-256-6_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970814-103452-169_L1C_048-256-6_D_V1-0.zip
run script
2024-01-09T21:10:08.790    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:10:08.792    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970814-103452-169_L1C_048-256-6_D_V1-0.zip
2024-01-09T21:10:08.792    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:10:08.792    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:10:08.792    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:10:08.792    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:10:08.792    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:10:08.792    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:10:08.792    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:10:08.792    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970814-103452-169_L1C_048-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/14/SPOT1-HRV1-XS_19970814-103540-363_L1C_051-262-8_D_V1-0/SPOT1-HRV1-XS_19970814-103540-363_L1C_051-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970814-103540-363_L1C_051-262-8_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970814-103540-363_L1C_051-262-8_D_V1-0.zip
run script
2024-01-09T21:10:58.544    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:10:58.545    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970814-103540-363_L1C_051-262-8_D_V1-0.zip
2024-01-09T21:10:58.545    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:10:58.545    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:10:58.545    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:10:58.545    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:10:58.545    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:10:58.545    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:10:58.545    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:10:58.545    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970814-103540-363_L1C_051-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/14/SPOT1-HRV1-XS_19970814-103541-503_L1C_051-263-0_D_V1-0/SPOT1-HRV1-XS_19970814-103541-503_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970814-103541-503_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970814-103541-503_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T21:11:43.094    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:11:43.095    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970814-103541-503_L1C_051-263-0_D_V1-0.zip
2024-01-09T21:11:43.095    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:11:43.095    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:11:43.095    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:11:43.095    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:11:43.095    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:11:43.095    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:11:43.095    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:11:43.095    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970814-103541-503_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/14/SPOT1-HRV1-XS_19970814-103521-322_L1C_054-261-0_D_V1-0/SPOT1-HRV1-XS_19970814-103521-322_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970814-103521-322_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970814-103521-322_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T21:12:21.274    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:12:21.275    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970814-103521-322_L1C_054-261-0_D_V1-0.zip
2024-01-09T21:12:21.275    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:12:21.275    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:12:21.275    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:12:21.275    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:12:21.275    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:12:21.275    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:12:21.275    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:12:21.275    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970814-103521-322_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/14/SPOT1-HRV1-XS_19970814-103523-127_L1C_054-261-2_D_V1-0/SPOT1-HRV1-XS_19970814-103523-127_L1C_054-261-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970814-103523-127_L1C_054-261-2_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970814-103523-127_L1C_054-261-2_D_V1-0.zip
run script
2024-01-09T21:14:18.028    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:14:18.030    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970814-103523-127_L1C_054-261-2_D_V1-0.zip
2024-01-09T21:14:18.030    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:14:18.030    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:14:18.030    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:14:18.030    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:14:18.030    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:14:18.030    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:14:18.030    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:14:18.030    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970814-103523-127_L1C_054-261-2_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/23/SPOT1-HRV2-XS_19970823-110159-144_L1C_047-255-4_D_V1-0/SPOT1-HRV2-XS_19970823-110159-144_L1C_047-255-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970823-110159-144_L1C_047-255-4_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970823-110159-144_L1C_047-255-4_D_V1-0.zip
run script
2024-01-09T21:16:18.276    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:16:18.277    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970823-110159-144_L1C_047-255-4_D_V1-0.zip
2024-01-09T21:16:18.277    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:16:18.277    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:16:18.277    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:16:18.278    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:16:18.278    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:16:18.278    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:16:18.278    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:16:18.278    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970823-110159-144_L1C_047-255-4_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/29/SPOT1-HRV2-XS_19970929-105127-529_L1C_047-255-4_D_V1-0/SPOT1-HRV2-XS_19970929-105127-529_L1C_047-255-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970929-105127-529_L1C_047-255-4_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970929-105127-529_L1C_047-255-4_D_V1-0.zip
run script
2024-01-09T21:16:37.515    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:16:37.516    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970929-105127-529_L1C_047-255-4_D_V1-0.zip
2024-01-09T21:16:37.516    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:16:37.517    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:16:37.517    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:16:37.517    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:16:37.517    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:16:37.517    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:16:37.517    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:16:37.517    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970929-105127-529_L1C_047-255-4_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/29/SPOT1-HRV2-XS_19970929-105132-287_L1C_047-256-0_D_V1-0/SPOT1-HRV2-XS_19970929-105132-287_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970929-105132-287_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970929-105132-287_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T21:16:46.211    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:16:46.213    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970929-105132-287_L1C_047-256-0_D_V1-0.zip
2024-01-09T21:16:46.213    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:16:46.213    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:16:46.213    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:16:46.213    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:16:46.213    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:16:46.214    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:16:46.214    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:16:46.214    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970929-105132-287_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/09/29/SPOT1-HRV2-XS_19970929-105140-665_L1C_047-257-0_D_V1-0/SPOT1-HRV2-XS_19970929-105140-665_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970929-105140-665_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970929-105140-665_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T21:16:49.403    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:16:49.404    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970929-105140-665_L1C_047-257-0_D_V1-0.zip
2024-01-09T21:16:49.404    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:16:49.404    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:16:49.404    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:16:49.404    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:16:49.404    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:16:49.405    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:16:49.405    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:16:49.405    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970929-105140-665_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/09/29/SPOT1-HRV1-XS_19970929-105126-984_L1C_050-255-8_D_V1-0/SPOT1-HRV1-XS_19970929-105126-984_L1C_050-255-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970929-105126-984_L1C_050-255-8_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970929-105126-984_L1C_050-255-8_D_V1-0.zip
run script
2024-01-09T21:16:52.510    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:16:52.512    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970929-105126-984_L1C_050-255-8_D_V1-0.zip
2024-01-09T21:16:52.512    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:16:52.512    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:16:52.512    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:16:52.512    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:16:52.512    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:16:52.512    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:16:52.512    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:16:52.512    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970929-105126-984_L1C_050-255-8_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/29/SPOT1-HRV1-XS_19970929-105128-181_L1C_050-256-0_D_V1-0/SPOT1-HRV1-XS_19970929-105128-181_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970929-105128-181_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970929-105128-181_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T21:19:51.212    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:19:51.213    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970929-105128-181_L1C_050-256-0_D_V1-0.zip
2024-01-09T21:19:51.214    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:19:51.214    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:19:51.214    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:19:51.214    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:19:51.214    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:19:51.214    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:19:51.214    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:19:51.214    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970929-105128-181_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/29/SPOT1-HRV1-XS_19970929-105136-601_L1C_050-257-0_D_V1-0/SPOT1-HRV1-XS_19970929-105136-601_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970929-105136-601_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970929-105136-601_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T21:23:06.254    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:23:06.256    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970929-105136-601_L1C_050-257-0_D_V1-0.zip
2024-01-09T21:23:06.256    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:23:06.256    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:23:06.256    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:23:06.256    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:23:06.256    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:23:06.256    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:23:06.256    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:23:06.256    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970929-105136-601_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/29/SPOT1-HRV1-XS_19970929-105145-029_L1C_050-258-0_D_V1-0/SPOT1-HRV1-XS_19970929-105145-029_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970929-105145-029_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970929-105145-029_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T21:26:09.863    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:26:09.864    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970929-105145-029_L1C_050-258-0_D_V1-0.zip
2024-01-09T21:26:09.864    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:26:09.865    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:26:09.865    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:26:09.865    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:26:09.865    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:26:09.865    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:26:09.865    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:26:09.865    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T21:28:00.694    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 228). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970929-105145-029_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1997/09/29/SPOT1-HRV1-XS_19970929-105153-458_L1C_050-259-0_D_V1-0/SPOT1-HRV1-XS_19970929-105153-458_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970929-105153-458_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970929-105153-458_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T21:28:03.732    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:28:03.734    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970929-105153-458_L1C_050-259-0_D_V1-0.zip
2024-01-09T21:28:03.734    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:28:03.734    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:28:03.735    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:28:03.735    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:28:03.735    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:28:03.735    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:28:03.735    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:28:03.735    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970929-105153-458_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/29/SPOT1-HRV1-XS_19970929-105201-895_L1C_050-260-0_D_V1-0/SPOT1-HRV1-XS_19970929-105201-895_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970929-105201-895_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970929-105201-895_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T21:29:39.145    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:29:39.146    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970929-105201-895_L1C_050-260-0_D_V1-0.zip
2024-01-09T21:29:39.146    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:29:39.146    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:29:39.147    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:29:39.147    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:29:39.147    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:29:39.147    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:29:39.147    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:29:39.147    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970929-105201-895_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/29/SPOT1-HRV1-XS_19970929-105204-602_L1C_050-260-3_D_V1-0/SPOT1-HRV1-XS_19970929-105204-602_L1C_050-260-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970929-105204-602_L1C_050-260-3_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970929-105204-602_L1C_050-260-3_D_V1-0.zip
run script
2024-01-09T21:30:47.710    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:30:47.711    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970929-105204-602_L1C_050-260-3_D_V1-0.zip
2024-01-09T21:30:47.711    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:30:47.711    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:30:47.711    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:30:47.711    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:30:47.711    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:30:47.711    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:30:47.711    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:30:47.711    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970929-105204-602_L1C_050-260-3_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/20/SPOT1-HRV1-XS_19970820-101947-356_L1C_047-257-9_D_V1-0/SPOT1-HRV1-XS_19970820-101947-356_L1C_047-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970820-101947-356_L1C_047-257-9_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970820-101947-356_L1C_047-257-9_D_V1-0.zip
run script
2024-01-09T21:31:53.944    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:31:53.946    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970820-101947-356_L1C_047-257-9_D_V1-0.zip
2024-01-09T21:31:53.946    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:31:53.946    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:31:53.946    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:31:53.946    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:31:53.946    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:31:53.946    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:31:53.946    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:31:53.946    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970820-101947-356_L1C_047-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/08/20/SPOT1-HRV1-XS_19970820-101947-455_L1C_047-258-0_D_V1-0/SPOT1-HRV1-XS_19970820-101947-455_L1C_047-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970820-101947-455_L1C_047-258-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970820-101947-455_L1C_047-258-0_D_V1-0.zip
run script
2024-01-09T21:31:57.098    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:31:57.099    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970820-101947-455_L1C_047-258-0_D_V1-0.zip
2024-01-09T21:31:57.099    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:31:57.099    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:31:57.099    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:31:57.099    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:31:57.099    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:31:57.099    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:31:57.099    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:31:57.100    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970820-101947-455_L1C_047-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/08/20/SPOT1-HRV1-XS_19970820-101955-685_L1C_047-259-0_D_V1-0/SPOT1-HRV1-XS_19970820-101955-685_L1C_047-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970820-101955-685_L1C_047-259-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970820-101955-685_L1C_047-259-0_D_V1-0.zip
run script
2024-01-09T21:32:00.262    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:32:00.263    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970820-101955-685_L1C_047-259-0_D_V1-0.zip
2024-01-09T21:32:00.263    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:32:00.263    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:32:00.263    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:32:00.263    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:32:00.263    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:32:00.264    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:32:00.264    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:32:00.264    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970820-101955-685_L1C_047-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/08/20/SPOT1-HRV1-XS_19970820-101958-392_L1C_047-259-3_D_V1-0/SPOT1-HRV1-XS_19970820-101958-392_L1C_047-259-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970820-101958-392_L1C_047-259-3_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970820-101958-392_L1C_047-259-3_D_V1-0.zip
run script
2024-01-09T21:32:03.307    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:32:03.308    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970820-101958-392_L1C_047-259-3_D_V1-0.zip
2024-01-09T21:32:03.308    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:32:03.308    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:32:03.308    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:32:03.308    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:32:03.308    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:32:03.308    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:32:03.308    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:32:03.308    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970820-101958-392_L1C_047-259-3_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/03/01/SPOT1-HRV1-XS_19970301-102126-718_L1C_048-254-0_D_V1-0/SPOT1-HRV1-XS_19970301-102126-718_L1C_048-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970301-102126-718_L1C_048-254-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970301-102126-718_L1C_048-254-0_D_V1-0.zip
run script
2024-01-09T21:32:06.056    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:32:06.057    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970301-102126-718_L1C_048-254-0_D_V1-0.zip
2024-01-09T21:32:06.057    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:32:06.058    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:32:06.058    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:32:06.058    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:32:06.058    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:32:06.058    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:32:06.058    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:32:06.058    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970301-102126-718_L1C_048-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/03/01/SPOT1-HRV1-XS_19970301-102134-945_L1C_048-255-0_D_V1-0/SPOT1-HRV1-XS_19970301-102134-945_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970301-102134-945_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970301-102134-945_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T21:32:09.185    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:32:09.186    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970301-102134-945_L1C_048-255-0_D_V1-0.zip
2024-01-09T21:32:09.186    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:32:09.187    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:32:09.187    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:32:09.187    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:32:09.187    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:32:09.187    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:32:09.187    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:32:09.187    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970301-102134-945_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/03/01/SPOT1-HRV1-XS_19970301-102143-184_L1C_048-256-0_D_V1-0/SPOT1-HRV1-XS_19970301-102143-184_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970301-102143-184_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970301-102143-184_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T21:32:27.567    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:32:27.569    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970301-102143-184_L1C_048-256-0_D_V1-0.zip
2024-01-09T21:32:27.569    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:32:27.569    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:32:27.569    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:32:27.569    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:32:27.569    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:32:27.569    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:32:27.569    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:32:27.569    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970301-102143-184_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/03/01/SPOT1-HRV1-XS_19970301-102151-429_L1C_048-257-0_D_V1-0/SPOT1-HRV1-XS_19970301-102151-429_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970301-102151-429_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970301-102151-429_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T21:33:08.087    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:33:08.088    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970301-102151-429_L1C_048-257-0_D_V1-0.zip
2024-01-09T21:33:08.088    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:33:08.088    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:33:08.088    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:33:08.088    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:33:08.088    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:33:08.088    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:33:08.088    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:33:08.088    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970301-102151-429_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/04/07/SPOT1-HRV1-XS_19970407-101110-883_L1C_048-254-0_D_V1-0/SPOT1-HRV1-XS_19970407-101110-883_L1C_048-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970407-101110-883_L1C_048-254-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970407-101110-883_L1C_048-254-0_D_V1-0.zip
run script
2024-01-09T21:33:34.333    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:33:34.334    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970407-101110-883_L1C_048-254-0_D_V1-0.zip
2024-01-09T21:33:34.334    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:33:34.334    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:33:34.334    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:33:34.334    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:33:34.334    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:33:34.335    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:33:34.335    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:33:34.335    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970407-101110-883_L1C_048-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/04/07/SPOT1-HRV1-XS_19970407-101119-067_L1C_048-255-0_D_V1-0/SPOT1-HRV1-XS_19970407-101119-067_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970407-101119-067_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970407-101119-067_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T21:33:37.321    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:33:37.322    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970407-101119-067_L1C_048-255-0_D_V1-0.zip
2024-01-09T21:33:37.322    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:33:37.322    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:33:37.322    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:33:37.322    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:33:37.322    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:33:37.323    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:33:37.323    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:33:37.323    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970407-101119-067_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/04/07/SPOT1-HRV1-XS_19970407-101127-264_L1C_048-256-0_D_V1-0/SPOT1-HRV1-XS_19970407-101127-264_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970407-101127-264_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970407-101127-264_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T21:33:59.528    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:33:59.530    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970407-101127-264_L1C_048-256-0_D_V1-0.zip
2024-01-09T21:33:59.530    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:33:59.530    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:33:59.530    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:33:59.530    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:33:59.530    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:33:59.530    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:33:59.531    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:33:59.531    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970407-101127-264_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/04/07/SPOT1-HRV1-XS_19970407-101128-167_L1C_048-256-1_D_V1-0/SPOT1-HRV1-XS_19970407-101128-167_L1C_048-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970407-101128-167_L1C_048-256-1_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970407-101128-167_L1C_048-256-1_D_V1-0.zip
run script
2024-01-09T21:34:49.985    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:34:49.986    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970407-101128-167_L1C_048-256-1_D_V1-0.zip
2024-01-09T21:34:49.986    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:34:49.986    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:34:49.986    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:34:49.986    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:34:49.986    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:34:49.986    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:34:49.986    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:34:49.986    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970407-101128-167_L1C_048-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/04/07/SPOT1-HRV1-XS_19970407-101148-007_L1C_049-258-6_D_V1-0/SPOT1-HRV1-XS_19970407-101148-007_L1C_049-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970407-101148-007_L1C_049-258-6_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970407-101148-007_L1C_049-258-6_D_V1-0.zip
run script
2024-01-09T21:35:39.124    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:35:39.125    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970407-101148-007_L1C_049-258-6_D_V1-0.zip
2024-01-09T21:35:39.125    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:35:39.125    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:35:39.125    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:35:39.125    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:35:39.126    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:35:39.126    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:35:39.126    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:35:39.126    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970407-101148-007_L1C_049-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/04/07/SPOT1-HRV1-XS_19970407-101151-728_L1C_050-259-1_D_V1-0/SPOT1-HRV1-XS_19970407-101151-728_L1C_050-259-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970407-101151-728_L1C_050-259-1_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970407-101151-728_L1C_050-259-1_D_V1-0.zip
run script
2024-01-09T21:37:05.291    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:37:05.293    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970407-101151-728_L1C_050-259-1_D_V1-0.zip
2024-01-09T21:37:05.293    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:37:05.293    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:37:05.293    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:37:05.293    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:37:05.293    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:37:05.293    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:37:05.293    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:37:05.293    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970407-101151-728_L1C_050-259-1_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/04/07/SPOT1-HRV2-XS_19970407-101108-206_L1C_051-254-0_D_V1-0/SPOT1-HRV2-XS_19970407-101108-206_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970407-101108-206_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970407-101108-206_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T21:38:24.368    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:38:24.369    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970407-101108-206_L1C_051-254-0_D_V1-0.zip
2024-01-09T21:38:24.369    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:38:24.370    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:38:24.370    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:38:24.370    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:38:24.370    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:38:24.370    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:38:24.370    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:38:24.370    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970407-101108-206_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/04/07/SPOT1-HRV2-XS_19970407-101116-408_L1C_051-255-0_D_V1-0/SPOT1-HRV2-XS_19970407-101116-408_L1C_051-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970407-101116-408_L1C_051-255-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970407-101116-408_L1C_051-255-0_D_V1-0.zip
run script
2024-01-09T21:38:27.676    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:38:27.677    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970407-101116-408_L1C_051-255-0_D_V1-0.zip
2024-01-09T21:38:27.677    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:38:27.677    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:38:27.677    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:38:27.677    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:38:27.677    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:38:27.677    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:38:27.677    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:38:27.677    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970407-101116-408_L1C_051-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/04/07/SPOT1-HRV2-XS_19970407-101128-230_L1C_051-256-4_D_V1-0/SPOT1-HRV2-XS_19970407-101128-230_L1C_051-256-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970407-101128-230_L1C_051-256-4_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970407-101128-230_L1C_051-256-4_D_V1-0.zip
run script
2024-01-09T21:39:20.221    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:39:20.222    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970407-101128-230_L1C_051-256-4_D_V1-0.zip
2024-01-09T21:39:20.222    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:39:20.222    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:39:20.222    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:39:20.222    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:39:20.223    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:39:20.223    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:39:20.223    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:39:20.223    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970407-101128-230_L1C_051-256-4_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/19/SPOT1-HRV1-XS_19970819-103837-351_L1C_048-254-6_D_V1-0/SPOT1-HRV1-XS_19970819-103837-351_L1C_048-254-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970819-103837-351_L1C_048-254-6_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970819-103837-351_L1C_048-254-6_D_V1-0.zip
run script
2024-01-09T21:42:10.869    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:42:10.870    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970819-103837-351_L1C_048-254-6_D_V1-0.zip
2024-01-09T21:42:10.871    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:42:10.871    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:42:10.871    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:42:10.871    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:42:10.871    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:42:10.871    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:42:10.871    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:42:10.871    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970819-103837-351_L1C_048-254-6_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/19/SPOT1-HRV1-XS_19970819-103840-218_L1C_048-255-0_D_V1-0/SPOT1-HRV1-XS_19970819-103840-218_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970819-103840-218_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970819-103840-218_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T21:42:17.146    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:42:17.147    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970819-103840-218_L1C_048-255-0_D_V1-0.zip
2024-01-09T21:42:17.147    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:42:17.147    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:42:17.147    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:42:17.147    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:42:17.147    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:42:17.147    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:42:17.147    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:42:17.147    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970819-103840-218_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/19/SPOT1-HRV1-XS_19970819-103848-511_L1C_048-256-0_D_V1-0/SPOT1-HRV1-XS_19970819-103848-511_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970819-103848-511_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970819-103848-511_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T21:42:30.456    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:42:30.457    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970819-103848-511_L1C_048-256-0_D_V1-0.zip
2024-01-09T21:42:30.457    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:42:30.457    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:42:30.457    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:42:30.457    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:42:30.457    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:42:30.457    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:42:30.457    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:42:30.457    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970819-103848-511_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/19/SPOT1-HRV1-XS_19970819-103856-810_L1C_048-257-0_D_V1-0/SPOT1-HRV1-XS_19970819-103856-810_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970819-103856-810_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970819-103856-810_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T21:42:46.966    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:42:46.967    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970819-103856-810_L1C_048-257-0_D_V1-0.zip
2024-01-09T21:42:46.967    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:42:46.967    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:42:46.967    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:42:46.967    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:42:46.967    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:42:46.967    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:42:46.967    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:42:46.967    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970819-103856-810_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/08/19/SPOT1-HRV1-XS_19970819-103917-628_L1C_050-259-8_D_V1-0/SPOT1-HRV1-XS_19970819-103917-628_L1C_050-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970819-103917-628_L1C_050-259-8_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970819-103917-628_L1C_050-259-8_D_V1-0.zip
run script
2024-01-09T21:42:50.311    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:42:50.311    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970819-103917-628_L1C_050-259-8_D_V1-0.zip
2024-01-09T21:42:50.311    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:42:50.311    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:42:50.311    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:42:50.311    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:42:50.311    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:42:50.311    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:42:50.311    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:42:50.311    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
ERROR 1: Attempt to create 2475x0 dataset is illegal,sizes must be larger than zero.
ERROR 1: Attempt to create 2475x0 dataset is illegal,sizes must be larger than zero.
ERROR 1: Attempt to create 2475x0 dataset is illegal,sizes must be larger than zero.
ERROR 1: Attempt to create 2475x0 dataset is illegal,sizes must be larger than zero.
ERROR 4: /tmp/slurm-4016192/OUTPUT/SPOT1/1997/8/19/SPOT1-HRV1-XS_19970819-103917-628_L1C_050-259-8_C_V1-0/31TGL/FSC_19970819T103917_SPOT1_31TGL/dem.tif: No such file or directory
GDALOpen failed - 4
/tmp/slurm-4016192/OUTPUT/SPOT1/1997/8/19/SPOT1-HRV1-XS_19970819-103917-628_L1C_050-259-8_C_V1-0/31TGL/FSC_19970819T103917_SPOT1_31TGL/dem.tif: No such file or directory
ERROR 4: /tmp/slurm-4016192/OUTPUT/SPOT1/1997/8/19/SPOT1-HRV1-XS_19970819-103917-628_L1C_050-259-8_C_V1-0/31TGL/FSC_19970819T103917_SPOT1_31TGL/xs1.tif: No such file or directory
ERROR 4: /tmp/slurm-4016192/OUTPUT/SPOT1/1997/8/19/SPOT1-HRV1-XS_19970819-103917-628_L1C_050-259-8_C_V1-0/31TGL/FSC_19970819T103917_SPOT1_31TGL/xs2.tif: No such file or directory
ERROR 4: /tmp/slurm-4016192/OUTPUT/SPOT1/1997/8/19/SPOT1-HRV1-XS_19970819-103917-628_L1C_050-259-8_C_V1-0/31TGL/FSC_19970819T103917_SPOT1_31TGL/xs3.tif: No such file or directory
ERROR 4: /tmp/slurm-4016192/OUTPUT/SPOT1/1997/8/19/SPOT1-HRV1-XS_19970819-103917-628_L1C_050-259-8_C_V1-0/31TGL/FSC_19970819T103917_SPOT1_31TGL/hill.tif: No such file or directory
ERROR 4: /tmp/slurm-4016192/OUTPUT/SPOT1/1997/8/19/SPOT1-HRV1-XS_19970819-103917-628_L1C_050-259-8_C_V1-0/31TGL/FSC_19970819T103917_SPOT1_31TGL/dem.tif: No such file or directory
Traceback (most recent call last):
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/bin/gdal_merge.py", line 4, in <module>
    __import__('pkg_resources').run_script('GDAL==3.4.3', 'gdal_merge.py')
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/pkg_resources/__init__.py", line 672, in run_script
    self.require(requires)[0].run_script(script_name, ns)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/pkg_resources/__init__.py", line 1472, in run_script
    exec(code, namespace, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/GDAL-3.4.3-py3.8-linux-x86_64.egg-info/scripts/gdal_merge.py", line 11, in <module>
    sys.exit(main(sys.argv))
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/osgeo_utils/gdal_merge.py", line 428, in main
    ulx = file_infos[0].ulx
IndexError: list index out of range
rm: cannot remove '/tmp/slurm-4016192/OUTPUT/SPOT1/1997/8/19/SPOT1-HRV1-XS_19970819-103917-628_L1C_050-259-8_C_V1-0/31TGL/FSC_19970819T103917_SPOT1_31TGL/xs1.tif': No such file or directory
rm: cannot remove '/tmp/slurm-4016192/OUTPUT/SPOT1/1997/8/19/SPOT1-HRV1-XS_19970819-103917-628_L1C_050-259-8_C_V1-0/31TGL/FSC_19970819T103917_SPOT1_31TGL/xs2.tif': No such file or directory
rm: cannot remove '/tmp/slurm-4016192/OUTPUT/SPOT1/1997/8/19/SPOT1-HRV1-XS_19970819-103917-628_L1C_050-259-8_C_V1-0/31TGL/FSC_19970819T103917_SPOT1_31TGL/xs3.tif': No such file or directory
rm: cannot remove '/tmp/slurm-4016192/OUTPUT/SPOT1/1997/8/19/SPOT1-HRV1-XS_19970819-103917-628_L1C_050-259-8_C_V1-0/31TGL/FSC_19970819T103917_SPOT1_31TGL/hill.tif': No such file or directory
rm: cannot remove '/tmp/slurm-4016192/OUTPUT/SPOT1/1997/8/19/SPOT1-HRV1-XS_19970819-103917-628_L1C_050-259-8_C_V1-0/31TGL/FSC_19970819T103917_SPOT1_31TGL/dem.tif': No such file or directory
ERROR 4: /tmp/slurm-4016192/OUTPUT/SPOT1/1997/8/19/SPOT1-HRV1-XS_19970819-103917-628_L1C_050-259-8_C_V1-0/31TGL/FSC_19970819T103917_SPOT1_31TGL/merged.tif: No such file or directory
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T21:43:57.793    ERROR:run_snow_swh.py::main:'NoneType' object has no attribute 'ReadAsArray'
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970819-103917-628_L1C_050-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/19/SPOT1-HRV1-XS_19970819-103918-759_L1C_050-260-0_D_V1-0/SPOT1-HRV1-XS_19970819-103918-759_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970819-103918-759_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970819-103918-759_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T21:44:01.012    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:44:01.013    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970819-103918-759_L1C_050-260-0_D_V1-0.zip
2024-01-09T21:44:01.013    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:44:01.013    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:44:01.013    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:44:01.013    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:44:01.013    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:44:01.013    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:44:01.013    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:44:01.013    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970819-103918-759_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/19/SPOT1-HRV1-XS_19970819-103927-113_L1C_050-261-0_D_V1-0/SPOT1-HRV1-XS_19970819-103927-113_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970819-103927-113_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970819-103927-113_L1C_050-261-0_D_V1-0.zip
run script
2024-01-09T21:45:09.075    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:45:09.076    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970819-103927-113_L1C_050-261-0_D_V1-0.zip
2024-01-09T21:45:09.076    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:45:09.076    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:45:09.076    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:45:09.076    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:45:09.076    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:45:09.076    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:45:09.076    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:45:09.077    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970819-103927-113_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 0 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/19/SPOT1-HRV1-XS_19970819-103928-917_L1C_050-261-2_D_V1-0/SPOT1-HRV1-XS_19970819-103928-917_L1C_050-261-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970819-103928-917_L1C_050-261-2_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970819-103928-917_L1C_050-261-2_D_V1-0.zip
run script
2024-01-09T21:46:02.196    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:46:02.197    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970819-103928-917_L1C_050-261-2_D_V1-0.zip
2024-01-09T21:46:02.197    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:46:02.197    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:46:02.197    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:46:02.197    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:46:02.197    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:46:02.197    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:46:02.197    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:46:02.197    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970819-103928-917_L1C_050-261-2_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 0 0 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/24/SPOT1-HRV1-XS_19970824-104240-622_L1C_048-254-9_D_V1-0/SPOT1-HRV1-XS_19970824-104240-622_L1C_048-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970824-104240-622_L1C_048-254-9_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970824-104240-622_L1C_048-254-9_D_V1-0.zip
run script
2024-01-09T21:46:52.420    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:46:52.422    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970824-104240-622_L1C_048-254-9_D_V1-0.zip
2024-01-09T21:46:52.422    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:46:52.422    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:46:52.422    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:46:52.422    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:46:52.422    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:46:52.422    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:46:52.422    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:46:52.422    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970824-104240-622_L1C_048-254-9_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/24/SPOT1-HRV1-XS_19970824-104240-808_L1C_048-255-0_D_V1-0/SPOT1-HRV1-XS_19970824-104240-808_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970824-104240-808_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970824-104240-808_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T21:47:05.579    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:47:05.581    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970824-104240-808_L1C_048-255-0_D_V1-0.zip
2024-01-09T21:47:05.581    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:47:05.581    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:47:05.589    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:47:05.589    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:47:05.589    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:47:05.590    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:47:05.590    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:47:05.590    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970824-104240-808_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/24/SPOT1-HRV1-XS_19970824-104244-418_L1C_048-255-4_D_V1-0/SPOT1-HRV1-XS_19970824-104244-418_L1C_048-255-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970824-104244-418_L1C_048-255-4_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970824-104244-418_L1C_048-255-4_D_V1-0.zip
run script
2024-01-09T21:47:17.171    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:47:17.173    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970824-104244-418_L1C_048-255-4_D_V1-0.zip
2024-01-09T21:47:17.173    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:47:17.173    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:47:17.173    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:47:17.173    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:47:17.173    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:47:17.173    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:47:17.174    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:47:17.174    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970824-104244-418_L1C_048-255-4_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/24/SPOT1-HRV1-XS_19970824-104301-491_L1C_049-257-7_D_V1-0/SPOT1-HRV1-XS_19970824-104301-491_L1C_049-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970824-104301-491_L1C_049-257-7_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970824-104301-491_L1C_049-257-7_D_V1-0.zip
run script
2024-01-09T21:47:34.577    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:47:34.578    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970824-104301-491_L1C_049-257-7_D_V1-0.zip
2024-01-09T21:47:34.578    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:47:34.578    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:47:34.578    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:47:34.578    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:47:34.578    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:47:34.578    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:47:34.578    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:47:34.578    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970824-104301-491_L1C_049-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/24/SPOT1-HRV1-XS_19970824-104303-527_L1C_049-258-0_D_V1-0/SPOT1-HRV1-XS_19970824-104303-527_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970824-104303-527_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970824-104303-527_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T21:48:52.501    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:48:52.502    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970824-104303-527_L1C_049-258-0_D_V1-0.zip
2024-01-09T21:48:52.502    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:48:52.503    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:48:52.503    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:48:52.503    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:48:52.503    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:48:52.503    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:48:52.503    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:48:52.503    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T21:49:54.077    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (0 x 2252). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970824-104303-527_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1997/08/24/SPOT1-HRV1-XS_19970824-104311-884_L1C_049-259-0_D_V1-0/SPOT1-HRV1-XS_19970824-104311-884_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970824-104311-884_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970824-104311-884_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T21:49:56.956    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:49:56.957    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970824-104311-884_L1C_049-259-0_D_V1-0.zip
2024-01-09T21:49:56.957    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:49:56.957    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:49:56.957    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:49:56.957    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:49:56.957    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:49:56.958    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:49:56.958    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:49:56.958    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970824-104311-884_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/24/SPOT1-HRV1-XS_19970824-104320-249_L1C_049-260-0_D_V1-0/SPOT1-HRV1-XS_19970824-104320-249_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970824-104320-249_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970824-104320-249_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T21:50:47.619    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:50:47.620    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970824-104320-249_L1C_049-260-0_D_V1-0.zip
2024-01-09T21:50:47.620    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:50:47.620    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:50:47.620    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:50:47.620    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:50:47.620    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:50:47.620    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:50:47.620    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:50:47.620    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970824-104320-249_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/24/SPOT1-HRV1-XS_19970824-104322-956_L1C_049-260-3_D_V1-0/SPOT1-HRV1-XS_19970824-104322-956_L1C_049-260-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970824-104322-956_L1C_049-260-3_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970824-104322-956_L1C_049-260-3_D_V1-0.zip
run script
2024-01-09T21:51:12.815    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:51:12.816    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970824-104322-956_L1C_049-260-3_D_V1-0.zip
2024-01-09T21:51:12.816    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:51:12.816    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:51:12.816    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:51:12.817    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:51:12.817    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:51:12.817    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:51:12.817    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:51:12.817    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970824-104322-956_L1C_049-260-3_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/03/10/SPOT1-HRV2-XS_19970310-104856-872_L1C_048-255-1_D_V1-0/SPOT1-HRV2-XS_19970310-104856-872_L1C_048-255-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970310-104856-872_L1C_048-255-1_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970310-104856-872_L1C_048-255-1_D_V1-0.zip
run script
2024-01-09T21:51:34.117    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:51:34.117    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970310-104856-872_L1C_048-255-1_D_V1-0.zip
2024-01-09T21:51:34.117    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:51:34.117    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:51:34.118    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:51:34.118    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:51:34.118    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:51:34.118    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:51:34.118    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:51:34.118    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970310-104856-872_L1C_048-255-1_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/03/10/SPOT1-HRV2-XS_19970310-104858-677_L1C_048-255-3_D_V1-0/SPOT1-HRV2-XS_19970310-104858-677_L1C_048-255-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970310-104858-677_L1C_048-255-3_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970310-104858-677_L1C_048-255-3_D_V1-0.zip
run script
2024-01-09T21:52:01.913    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:52:01.914    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970310-104858-677_L1C_048-255-3_D_V1-0.zip
2024-01-09T21:52:01.914    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:52:01.914    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:52:01.915    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:52:01.915    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:52:01.915    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:52:01.915    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:52:01.915    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:52:01.915    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970310-104858-677_L1C_048-255-3_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/09/SPOT1-HRV2-XS_19970909-103527-654_L1C_048-255-4_D_V1-0/SPOT1-HRV2-XS_19970909-103527-654_L1C_048-255-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970909-103527-654_L1C_048-255-4_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970909-103527-654_L1C_048-255-4_D_V1-0.zip
run script
2024-01-09T21:52:37.850    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:52:37.851    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970909-103527-654_L1C_048-255-4_D_V1-0.zip
2024-01-09T21:52:37.851    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:52:37.851    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:52:37.851    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:52:37.851    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:52:37.851    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:52:37.852    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:52:37.852    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:52:37.852    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970909-103527-654_L1C_048-255-4_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/09/SPOT1-HRV2-XS_19970909-103532-325_L1C_048-256-0_D_V1-0/SPOT1-HRV2-XS_19970909-103532-325_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970909-103532-325_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970909-103532-325_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T21:53:22.063    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:53:22.063    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970909-103532-325_L1C_048-256-0_D_V1-0.zip
2024-01-09T21:53:22.063    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:53:22.064    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:53:22.064    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:53:22.064    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:53:22.064    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:53:22.064    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:53:22.064    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:53:22.064    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970909-103532-325_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/09/SPOT1-HRV2-XS_19970909-103540-616_L1C_048-257-0_D_V1-0/SPOT1-HRV2-XS_19970909-103540-616_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970909-103540-616_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970909-103540-616_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T21:54:22.289    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:54:22.290    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970909-103540-616_L1C_048-257-0_D_V1-0.zip
2024-01-09T21:54:22.290    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:54:22.290    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:54:22.290    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:54:22.290    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:54:22.290    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:54:22.290    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:54:22.290    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:54:22.290    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970909-103540-616_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/09/SPOT1-HRV2-XS_19970909-103548-912_L1C_048-258-0_D_V1-0/SPOT1-HRV2-XS_19970909-103548-912_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970909-103548-912_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970909-103548-912_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T21:55:12.433    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:55:12.434    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970909-103548-912_L1C_048-258-0_D_V1-0.zip
2024-01-09T21:55:12.434    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:55:12.434    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:55:12.434    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:55:12.434    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:55:12.434    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:55:12.434    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:55:12.434    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:55:12.434    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970909-103548-912_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/09/SPOT1-HRV2-XS_19970909-103557-214_L1C_048-259-0_D_V1-0/SPOT1-HRV2-XS_19970909-103557-214_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970909-103557-214_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970909-103557-214_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T21:55:43.034    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:55:43.035    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970909-103557-214_L1C_048-259-0_D_V1-0.zip
2024-01-09T21:55:43.035    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:55:43.035    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:55:43.035    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:55:43.036    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:55:43.036    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:55:43.036    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:55:43.036    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:55:43.036    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970909-103557-214_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/09/SPOT1-HRV2-XS_19970909-103602-628_L1C_048-259-6_D_V1-0/SPOT1-HRV2-XS_19970909-103602-628_L1C_048-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970909-103602-628_L1C_048-259-6_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970909-103602-628_L1C_048-259-6_D_V1-0.zip
run script
2024-01-09T21:55:55.356    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:55:55.357    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970909-103602-628_L1C_048-259-6_D_V1-0.zip
2024-01-09T21:55:55.357    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:55:55.357    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:55:55.357    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:55:55.357    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:55:55.357    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:55:55.357    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:55:55.357    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:55:55.357    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970909-103602-628_L1C_048-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/09/09/SPOT1-HRV1-XS_19970909-103537-198_L1C_051-257-0_D_V1-0/SPOT1-HRV1-XS_19970909-103537-198_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970909-103537-198_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970909-103537-198_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T21:55:58.100    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:55:58.100    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970909-103537-198_L1C_051-257-0_D_V1-0.zip
2024-01-09T21:55:58.100    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:55:58.100    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:55:58.100    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:55:58.100    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:55:58.101    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:55:58.101    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:55:58.101    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:55:58.101    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970909-103537-198_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 0]
 [0 0 0 ... 1 0 1]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/09/SPOT1-HRV1-XS_19970909-103545-528_L1C_051-258-0_D_V1-0/SPOT1-HRV1-XS_19970909-103545-528_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970909-103545-528_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970909-103545-528_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T21:58:56.828    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:58:56.830    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970909-103545-528_L1C_051-258-0_D_V1-0.zip
2024-01-09T21:58:56.830    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:58:56.830    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:58:56.830    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:58:56.830    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:58:56.830    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:58:56.830    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:58:56.830    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:58:56.830    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:00:15.805    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 350). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970909-103545-528_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1997/09/09/SPOT1-HRV1-XS_19970909-103553-860_L1C_051-259-0_D_V1-0/SPOT1-HRV1-XS_19970909-103553-860_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970909-103553-860_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970909-103553-860_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T22:00:18.624    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:00:18.625    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970909-103553-860_L1C_051-259-0_D_V1-0.zip
2024-01-09T22:00:18.625    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:00:18.625    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:00:18.625    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:00:18.626    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:00:18.626    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:00:18.626    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:00:18.626    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:00:18.626    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970909-103553-860_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/09/SPOT1-HRV1-XS_19970909-103602-204_L1C_051-260-0_D_V1-0/SPOT1-HRV1-XS_19970909-103602-204_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970909-103602-204_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970909-103602-204_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T22:03:09.255    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:03:09.256    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970909-103602-204_L1C_051-260-0_D_V1-0.zip
2024-01-09T22:03:09.256    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:03:09.256    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:03:09.256    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:03:09.256    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:03:09.256    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:03:09.257    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:03:09.257    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:03:09.257    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970909-103602-204_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/10/11/SPOT1-HRV1-XS_19971011-102050-726_L1C_048-255-5_D_V1-0/SPOT1-HRV1-XS_19971011-102050-726_L1C_048-255-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19971011-102050-726_L1C_048-255-5_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971011-102050-726_L1C_048-255-5_D_V1-0.zip
run script
2024-01-09T22:05:17.129    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:05:17.130    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971011-102050-726_L1C_048-255-5_D_V1-0.zip
2024-01-09T22:05:17.130    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:05:17.130    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:05:17.130    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:05:17.130    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:05:17.131    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:05:17.131    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:05:17.131    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:05:17.131    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971011-102050-726_L1C_048-255-5_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/10/11/SPOT1-HRV1-XS_19971011-102054-429_L1C_048-256-0_D_V1-0/SPOT1-HRV1-XS_19971011-102054-429_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19971011-102054-429_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971011-102054-429_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T22:06:06.054    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:06:06.056    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971011-102054-429_L1C_048-256-0_D_V1-0.zip
2024-01-09T22:06:06.056    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:06:06.056    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:06:06.056    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:06:06.056    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:06:06.056    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:06:06.056    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:06:06.056    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:06:06.056    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971011-102054-429_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/10/11/SPOT1-HRV1-XS_19971011-102110-883_L1C_049-258-0_D_V1-0/SPOT1-HRV1-XS_19971011-102110-883_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19971011-102110-883_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971011-102110-883_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T22:07:07.568    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:07:07.570    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971011-102110-883_L1C_049-258-0_D_V1-0.zip
2024-01-09T22:07:07.570    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:07:07.570    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:07:07.570    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:07:07.570    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:07:07.570    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:07:07.570    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:07:07.570    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:07:07.570    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971011-102110-883_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/10/11/SPOT1-HRV1-XS_19971011-102119-125_L1C_049-259-0_D_V1-0/SPOT1-HRV1-XS_19971011-102119-125_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19971011-102119-125_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971011-102119-125_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T22:07:45.045    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:07:45.046    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971011-102119-125_L1C_049-259-0_D_V1-0.zip
2024-01-09T22:07:45.046    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:07:45.046    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:07:45.046    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:07:45.046    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:07:45.047    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:07:45.047    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:07:45.047    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:07:45.047    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971011-102119-125_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/10/11/SPOT1-HRV1-XS_19971011-102127-376_L1C_049-260-0_D_V1-0/SPOT1-HRV1-XS_19971011-102127-376_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19971011-102127-376_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971011-102127-376_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T22:08:11.202    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:08:11.203    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971011-102127-376_L1C_049-260-0_D_V1-0.zip
2024-01-09T22:08:11.203    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:08:11.203    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:08:11.203    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:08:11.203    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:08:11.204    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:08:11.204    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:08:11.204    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:08:11.204    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971011-102127-376_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/10/11/SPOT1-HRV1-XS_19971011-102128-278_L1C_049-260-1_D_V1-0/SPOT1-HRV1-XS_19971011-102128-278_L1C_049-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19971011-102128-278_L1C_049-260-1_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971011-102128-278_L1C_049-260-1_D_V1-0.zip
run script
2024-01-09T22:08:20.924    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:08:20.925    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971011-102128-278_L1C_049-260-1_D_V1-0.zip
2024-01-09T22:08:20.925    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:08:20.925    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:08:20.925    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:08:20.925    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:08:20.925    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:08:20.925    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:08:20.925    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:08:20.925    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971011-102128-278_L1C_049-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/10/11/SPOT1-HRV2-XS_19971011-102108-010_L1C_051-258-0_D_V1-0/SPOT1-HRV2-XS_19971011-102108-010_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19971011-102108-010_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19971011-102108-010_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T22:08:29.060    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:08:29.061    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19971011-102108-010_L1C_051-258-0_D_V1-0.zip
2024-01-09T22:08:29.062    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:08:29.062    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:08:29.062    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:08:29.062    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:08:29.062    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:08:29.062    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:08:29.062    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:08:29.062    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:09:43.989    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 324). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19971011-102108-010_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1997/10/11/SPOT1-HRV2-XS_19971011-102116-270_L1C_051-259-0_D_V1-0/SPOT1-HRV2-XS_19971011-102116-270_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19971011-102116-270_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19971011-102116-270_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T22:09:47.081    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:09:47.082    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19971011-102116-270_L1C_051-259-0_D_V1-0.zip
2024-01-09T22:09:47.082    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:09:47.082    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:09:47.082    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:09:47.083    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:09:47.083    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:09:47.083    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:09:47.083    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:09:47.083    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19971011-102116-270_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/10/11/SPOT1-HRV2-XS_19971011-102124-539_L1C_051-260-0_D_V1-0/SPOT1-HRV2-XS_19971011-102124-539_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19971011-102124-539_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19971011-102124-539_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T22:12:37.553    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:12:37.554    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19971011-102124-539_L1C_051-260-0_D_V1-0.zip
2024-01-09T22:12:37.555    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:12:37.555    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:12:37.555    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:12:37.555    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:12:37.555    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:12:37.555    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:12:37.555    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:12:37.555    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19971011-102124-539_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/10/11/SPOT1-HRV2-XS_19971011-102128-149_L1C_051-260-4_D_V1-0/SPOT1-HRV2-XS_19971011-102128-149_L1C_051-260-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19971011-102128-149_L1C_051-260-4_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19971011-102128-149_L1C_051-260-4_D_V1-0.zip
run script
2024-01-09T22:15:03.851    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:15:03.852    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19971011-102128-149_L1C_051-260-4_D_V1-0.zip
2024-01-09T22:15:03.852    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:15:03.852    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:15:03.852    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:15:03.852    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:15:03.852    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:15:03.852    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:15:03.852    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:15:03.853    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19971011-102128-149_L1C_051-260-4_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/04/10/SPOT1-HRV2-XS_19970410-105409-099_L1C_048-256-8_D_V1-0/SPOT1-HRV2-XS_19970410-105409-099_L1C_048-256-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970410-105409-099_L1C_048-256-8_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970410-105409-099_L1C_048-256-8_D_V1-0.zip
run script
2024-01-09T22:17:39.354    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:17:39.355    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970410-105409-099_L1C_048-256-8_D_V1-0.zip
2024-01-09T22:17:39.355    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:17:39.355    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:17:39.355    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:17:39.355    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:17:39.355    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:17:39.355    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:17:39.355    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:17:39.355    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970410-105409-099_L1C_048-256-8_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/04/10/SPOT1-HRV2-XS_19970410-105410-326_L1C_048-257-0_D_V1-0/SPOT1-HRV2-XS_19970410-105410-326_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970410-105410-326_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970410-105410-326_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T22:17:52.635    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:17:52.636    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970410-105410-326_L1C_048-257-0_D_V1-0.zip
2024-01-09T22:17:52.636    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:17:52.636    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:17:52.636    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:17:52.636    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:17:52.636    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:17:52.636    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:17:52.636    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:17:52.636    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970410-105410-326_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/04/11/SPOT1-HRV1-XS_19970411-103454-834_L1C_048-256-9_D_V1-0/SPOT1-HRV1-XS_19970411-103454-834_L1C_048-256-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970411-103454-834_L1C_048-256-9_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970411-103454-834_L1C_048-256-9_D_V1-0.zip
run script
2024-01-09T22:18:02.583    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:18:02.584    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970411-103454-834_L1C_048-256-9_D_V1-0.zip
2024-01-09T22:18:02.584    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:18:02.584    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:18:02.585    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:18:02.585    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:18:02.585    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:18:02.585    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:18:02.585    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:18:02.585    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970411-103454-834_L1C_048-256-9_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/04/11/SPOT1-HRV1-XS_19970411-103455-014_L1C_048-257-0_D_V1-0/SPOT1-HRV1-XS_19970411-103455-014_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970411-103455-014_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970411-103455-014_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T22:18:17.187    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:18:17.188    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970411-103455-014_L1C_048-257-0_D_V1-0.zip
2024-01-09T22:18:17.188    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:18:17.188    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:18:17.188    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:18:17.188    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:18:17.188    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:18:17.188    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:18:17.188    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:18:17.189    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970411-103455-014_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/04/11/SPOT1-HRV1-XS_19970411-103503-322_L1C_048-258-0_D_V1-0/SPOT1-HRV1-XS_19970411-103503-322_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970411-103503-322_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970411-103503-322_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T22:18:31.114    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:18:31.115    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970411-103503-322_L1C_048-258-0_D_V1-0.zip
2024-01-09T22:18:31.115    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:18:31.115    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:18:31.116    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:18:31.116    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:18:31.116    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:18:31.116    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:18:31.116    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:18:31.116    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970411-103503-322_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/04/11/SPOT1-HRV1-XS_19970411-103511-640_L1C_048-259-0_D_V1-0/SPOT1-HRV1-XS_19970411-103511-640_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970411-103511-640_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970411-103511-640_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T22:18:34.213    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:18:34.213    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970411-103511-640_L1C_048-259-0_D_V1-0.zip
2024-01-09T22:18:34.213    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:18:34.213    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:18:34.213    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:18:34.214    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:18:34.214    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:18:34.214    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:18:34.214    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:18:34.214    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970411-103511-640_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/04/11/SPOT1-HRV1-XS_19970411-103518-859_L1C_048-259-8_D_V1-0/SPOT1-HRV1-XS_19970411-103518-859_L1C_048-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970411-103518-859_L1C_048-259-8_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970411-103518-859_L1C_048-259-8_D_V1-0.zip
run script
2024-01-09T22:18:37.230    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:18:37.231    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970411-103518-859_L1C_048-259-8_D_V1-0.zip
2024-01-09T22:18:37.231    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:18:37.231    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:18:37.231    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:18:37.232    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:18:37.232    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:18:37.232    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:18:37.232    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:18:37.232    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970411-103518-859_L1C_048-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/04/11/SPOT1-HRV2-XS_19970411-103537-090_L1C_049-262-2_D_V1-0/SPOT1-HRV2-XS_19970411-103537-090_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970411-103537-090_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970411-103537-090_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T22:18:40.299    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:18:40.300    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970411-103537-090_L1C_049-262-2_D_V1-0.zip
2024-01-09T22:18:40.300    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:18:40.300    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:18:40.300    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:18:40.300    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:18:40.300    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:18:40.300    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:18:40.300    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:18:40.300    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970411-103537-090_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/04/11/SPOT1-HRV2-XS_19970411-103519-749_L1C_054-260-9_D_V1-0/SPOT1-HRV2-XS_19970411-103519-749_L1C_054-260-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970411-103519-749_L1C_054-260-9_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970411-103519-749_L1C_054-260-9_D_V1-0.zip
run script
2024-01-09T22:18:43.523    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:18:43.523    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970411-103519-749_L1C_054-260-9_D_V1-0.zip
2024-01-09T22:18:43.523    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:18:43.523    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:18:43.523    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:18:43.524    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:18:43.524    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:18:43.524    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:18:43.524    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:18:43.524    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970411-103519-749_L1C_054-260-9_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/24/SPOT1-HRV1-XS_19970924-104731-330_L1C_048-256-0_D_V1-0/SPOT1-HRV1-XS_19970924-104731-330_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970924-104731-330_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970924-104731-330_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T22:20:33.325    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:20:33.326    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970924-104731-330_L1C_048-256-0_D_V1-0.zip
2024-01-09T22:20:33.326    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:20:33.326    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:20:33.326    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:20:33.326    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:20:33.326    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:20:33.327    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:20:33.327    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:20:33.327    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970924-104731-330_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/24/SPOT1-HRV1-XS_19970924-104739-695_L1C_048-257-0_D_V1-0/SPOT1-HRV1-XS_19970924-104739-695_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970924-104739-695_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970924-104739-695_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T22:21:44.239    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:21:44.240    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970924-104739-695_L1C_048-257-0_D_V1-0.zip
2024-01-09T22:21:44.240    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:21:44.240    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:21:44.240    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:21:44.240    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:21:44.240    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:21:44.240    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:21:44.241    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:21:44.241    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970924-104739-695_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/24/SPOT1-HRV1-XS_19970924-104740-598_L1C_048-257-1_D_V1-0/SPOT1-HRV1-XS_19970924-104740-598_L1C_048-257-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970924-104740-598_L1C_048-257-1_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970924-104740-598_L1C_048-257-1_D_V1-0.zip
run script
2024-01-09T22:22:36.638    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:22:36.639    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970924-104740-598_L1C_048-257-1_D_V1-0.zip
2024-01-09T22:22:36.640    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:22:36.640    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:22:36.640    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:22:36.640    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:22:36.640    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:22:36.640    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:22:36.640    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:22:36.640    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970924-104740-598_L1C_048-257-1_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/24/SPOT1-HRV1-XS_19970924-104728-385_L1C_049-255-6_D_V1-0/SPOT1-HRV1-XS_19970924-104728-385_L1C_049-255-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970924-104728-385_L1C_049-255-6_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970924-104728-385_L1C_049-255-6_D_V1-0.zip
run script
2024-01-09T22:23:25.570    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:23:25.571    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970924-104728-385_L1C_049-255-6_D_V1-0.zip
2024-01-09T22:23:25.571    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:23:25.571    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:23:25.571    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:23:25.572    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:23:25.572    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:23:25.572    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:23:25.572    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:23:25.572    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970924-104728-385_L1C_049-255-6_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/24/SPOT1-HRV2-XS_19970924-104728-984_L1C_050-255-9_D_V1-0/SPOT1-HRV2-XS_19970924-104728-984_L1C_050-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970924-104728-984_L1C_050-255-9_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970924-104728-984_L1C_050-255-9_D_V1-0.zip
run script
2024-01-09T22:24:21.195    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:24:21.196    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970924-104728-984_L1C_050-255-9_D_V1-0.zip
2024-01-09T22:24:21.196    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:24:21.196    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:24:21.196    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:24:21.196    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:24:21.196    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:24:21.196    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:24:21.196    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:24:21.196    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970924-104728-984_L1C_050-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/24/SPOT1-HRV2-XS_19970924-104729-246_L1C_050-256-0_D_V1-0/SPOT1-HRV2-XS_19970924-104729-246_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970924-104729-246_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970924-104729-246_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T22:27:13.559    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:27:13.561    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970924-104729-246_L1C_050-256-0_D_V1-0.zip
2024-01-09T22:27:13.561    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:27:13.561    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:27:13.561    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:27:13.561    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:27:13.561    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:27:13.561    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:27:13.561    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:27:13.561    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970924-104729-246_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/24/SPOT1-HRV2-XS_19970924-104737-632_L1C_050-257-0_D_V1-0/SPOT1-HRV2-XS_19970924-104737-632_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970924-104737-632_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970924-104737-632_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T22:30:09.593    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:30:09.594    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970924-104737-632_L1C_050-257-0_D_V1-0.zip
2024-01-09T22:30:09.594    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:30:09.594    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:30:09.594    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:30:09.594    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:30:09.595    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:30:09.595    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:30:09.595    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:30:09.595    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970924-104737-632_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/24/SPOT1-HRV2-XS_19970924-104740-339_L1C_050-257-3_D_V1-0/SPOT1-HRV2-XS_19970924-104740-339_L1C_050-257-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970924-104740-339_L1C_050-257-3_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970924-104740-339_L1C_050-257-3_D_V1-0.zip
run script
2024-01-09T22:32:52.517    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:32:52.519    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970924-104740-339_L1C_050-257-3_D_V1-0.zip
2024-01-09T22:32:52.519    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:32:52.519    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:32:52.519    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:32:52.519    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:32:52.519    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:32:52.519    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:32:52.519    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:32:52.519    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970924-104740-339_L1C_050-257-3_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/24/SPOT1-HRV1-XS_19970924-104757-897_L1C_050-259-4_D_V1-0/SPOT1-HRV1-XS_19970924-104757-897_L1C_050-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970924-104757-897_L1C_050-259-4_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970924-104757-897_L1C_050-259-4_D_V1-0.zip
run script
2024-01-09T22:35:30.529    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:35:30.531    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970924-104757-897_L1C_050-259-4_D_V1-0.zip
2024-01-09T22:35:30.531    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:35:30.531    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:35:30.531    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:35:30.531    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:35:30.531    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:35:30.531    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:35:30.531    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:35:30.531    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970924-104757-897_L1C_050-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/24/SPOT1-HRV1-XS_19970924-104802-692_L1C_050-260-0_D_V1-0/SPOT1-HRV1-XS_19970924-104802-692_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970924-104802-692_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970924-104802-692_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T22:36:59.296    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:36:59.297    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970924-104802-692_L1C_050-260-0_D_V1-0.zip
2024-01-09T22:36:59.297    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:36:59.297    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:36:59.297    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:36:59.297    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:36:59.297    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:36:59.297    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:36:59.297    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:36:59.298    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970924-104802-692_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/24/SPOT1-HRV1-XS_19970924-104811-102_L1C_050-261-0_D_V1-0/SPOT1-HRV1-XS_19970924-104811-102_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970924-104811-102_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970924-104811-102_L1C_050-261-0_D_V1-0.zip
run script
2024-01-09T22:38:08.802    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:38:08.803    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970924-104811-102_L1C_050-261-0_D_V1-0.zip
2024-01-09T22:38:08.803    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:38:08.803    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:38:08.803    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:38:08.803    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:38:08.803    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:38:08.803    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:38:08.803    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:38:08.803    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970924-104811-102_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/24/SPOT1-HRV1-XS_19970924-104819-518_L1C_050-262-0_D_V1-0/SPOT1-HRV1-XS_19970924-104819-518_L1C_050-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970924-104819-518_L1C_050-262-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970924-104819-518_L1C_050-262-0_D_V1-0.zip
run script
2024-01-09T22:39:02.011    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:39:02.012    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970924-104819-518_L1C_050-262-0_D_V1-0.zip
2024-01-09T22:39:02.012    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:39:02.013    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:39:02.013    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:39:02.013    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:39:02.013    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:39:02.013    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:39:02.013    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:39:02.013    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970924-104819-518_L1C_050-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/24/SPOT1-HRV2-XS_19970924-104815-361_L1C_052-262-0_D_V1-0/SPOT1-HRV2-XS_19970924-104815-361_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970924-104815-361_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970924-104815-361_L1C_052-262-0_D_V1-0.zip
run script
2024-01-09T22:39:29.186    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:39:29.187    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970924-104815-361_L1C_052-262-0_D_V1-0.zip
2024-01-09T22:39:29.187    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:39:29.187    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:39:29.187    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:39:29.187    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:39:29.187    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:39:29.187    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:39:29.187    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:39:29.188    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970924-104815-361_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/24/SPOT1-HRV2-XS_19970924-104820-776_L1C_052-262-6_D_V1-0/SPOT1-HRV2-XS_19970924-104820-776_L1C_052-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970924-104820-776_L1C_052-262-6_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970924-104820-776_L1C_052-262-6_D_V1-0.zip
run script
2024-01-09T22:42:10.266    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:42:10.267    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970924-104820-776_L1C_052-262-6_D_V1-0.zip
2024-01-09T22:42:10.268    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:42:10.268    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:42:10.268    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:42:10.268    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:42:10.268    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:42:10.268    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:42:10.268    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:42:10.268    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970924-104820-776_L1C_052-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/24/SPOT1-HRV2-XS_19970924-104758-116_L1C_053-259-9_D_V1-0/SPOT1-HRV2-XS_19970924-104758-116_L1C_053-259-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970924-104758-116_L1C_053-259-9_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970924-104758-116_L1C_053-259-9_D_V1-0.zip
run script
2024-01-09T22:44:02.151    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:44:02.152    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970924-104758-116_L1C_053-259-9_D_V1-0.zip
2024-01-09T22:44:02.152    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:44:02.152    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:44:02.153    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:44:02.153    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:44:02.153    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:44:02.153    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:44:02.153    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:44:02.153    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:44:52.538    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 98). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970924-104758-116_L1C_053-259-9_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1997/09/24/SPOT1-HRV2-XS_19970924-104806-903_L1C_053-261-0_D_V1-0/SPOT1-HRV2-XS_19970924-104806-903_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970924-104806-903_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970924-104806-903_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T22:44:55.694    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:44:55.695    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970924-104806-903_L1C_053-261-0_D_V1-0.zip
2024-01-09T22:44:55.695    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:44:55.695    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:44:55.695    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:44:55.695    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:44:55.695    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:44:55.695    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:44:55.695    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:44:55.695    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970924-104806-903_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/10/20/SPOT1-HRV1-XS_19971020-104809-309_L1C_048-256-0_D_V1-0/SPOT1-HRV1-XS_19971020-104809-309_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19971020-104809-309_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971020-104809-309_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T22:47:57.634    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:47:57.636    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971020-104809-309_L1C_048-256-0_D_V1-0.zip
2024-01-09T22:47:57.636    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:47:57.636    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:47:57.636    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:47:57.636    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:47:57.636    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:47:57.636    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:47:57.636    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:47:57.636    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971020-104809-309_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/10/20/SPOT1-HRV1-XS_19971020-104817-674_L1C_048-257-0_D_V1-0/SPOT1-HRV1-XS_19971020-104817-674_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19971020-104817-674_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971020-104817-674_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T22:49:07.533    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:49:07.534    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971020-104817-674_L1C_048-257-0_D_V1-0.zip
2024-01-09T22:49:07.534    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:49:07.534    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:49:07.535    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:49:07.535    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:49:07.535    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:49:07.535    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:49:07.535    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:49:07.535    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971020-104817-674_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/10/20/SPOT1-HRV1-XS_19971020-104826-048_L1C_048-258-0_D_V1-0/SPOT1-HRV1-XS_19971020-104826-048_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19971020-104826-048_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971020-104826-048_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T22:50:02.272    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:50:02.273    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971020-104826-048_L1C_048-258-0_D_V1-0.zip
2024-01-09T22:50:02.273    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:50:02.273    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:50:02.273    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:50:02.274    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:50:02.274    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:50:02.274    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:50:02.274    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:50:02.274    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971020-104826-048_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [0 0 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/10/20/SPOT1-HRV1-XS_19971020-104828-755_L1C_048-258-3_D_V1-0/SPOT1-HRV1-XS_19971020-104828-755_L1C_048-258-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19971020-104828-755_L1C_048-258-3_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971020-104828-755_L1C_048-258-3_D_V1-0.zip
run script
2024-01-09T22:50:31.535    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:50:31.536    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971020-104828-755_L1C_048-258-3_D_V1-0.zip
2024-01-09T22:50:31.536    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:50:31.536    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:50:31.536    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:50:31.536    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:50:31.536    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:50:31.537    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:50:31.537    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:50:31.537    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:50:32.973    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 72). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971020-104828-755_L1C_048-258-3_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1997/10/20/SPOT1-HRV1-XS_19971020-104809-071_L1C_049-255-9_D_V1-0/SPOT1-HRV1-XS_19971020-104809-071_L1C_049-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19971020-104809-071_L1C_049-255-9_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971020-104809-071_L1C_049-255-9_D_V1-0.zip
run script
2024-01-09T22:50:35.909    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:50:35.911    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971020-104809-071_L1C_049-255-9_D_V1-0.zip
2024-01-09T22:50:35.911    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:50:35.911    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:50:35.911    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:50:35.911    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:50:35.911    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:50:35.911    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:50:35.911    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:50:35.911    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971020-104809-071_L1C_049-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/10/20/SPOT1-HRV2-XS_19971020-104750-069_L1C_050-254-0_D_V1-0/SPOT1-HRV2-XS_19971020-104750-069_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19971020-104750-069_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19971020-104750-069_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T22:51:46.568    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:51:46.569    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19971020-104750-069_L1C_050-254-0_D_V1-0.zip
2024-01-09T22:51:46.570    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:51:46.570    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:51:46.570    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:51:46.570    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:51:46.570    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:51:46.570    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:51:46.570    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:51:46.570    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19971020-104750-069_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/10/20/SPOT1-HRV2-XS_19971020-104827-976_L1C_053-259-0_D_V1-0/SPOT1-HRV2-XS_19971020-104827-976_L1C_053-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19971020-104827-976_L1C_053-259-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19971020-104827-976_L1C_053-259-0_D_V1-0.zip
run script
2024-01-09T22:51:49.558    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:51:49.560    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19971020-104827-976_L1C_053-259-0_D_V1-0.zip
2024-01-09T22:51:49.560    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:51:49.560    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:51:49.560    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:51:49.560    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:51:49.560    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:51:49.560    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:51:49.560    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:51:49.560    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19971020-104827-976_L1C_053-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/01/13/SPOT1-HRV2-XS_19970113-102409-595_L1C_048-257-5_D_V1-0/SPOT1-HRV2-XS_19970113-102409-595_L1C_048-257-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970113-102409-595_L1C_048-257-5_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970113-102409-595_L1C_048-257-5_D_V1-0.zip
run script
2024-01-09T22:54:45.679    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:54:45.680    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970113-102409-595_L1C_048-257-5_D_V1-0.zip
2024-01-09T22:54:45.680    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:54:45.680    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:54:45.681    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:54:45.681    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:54:45.681    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:54:45.681    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:54:45.681    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:54:45.681    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970113-102409-595_L1C_048-257-5_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 0 0 1]
 [1 0 0 1]
 [1 0 0 1]
 ...
 [2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [1 1 1 1]
 [1 1 1 1]
 [1 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/01/13/SPOT1-HRV2-XS_19970113-102413-355_L1C_048-258-0_D_V1-0/SPOT1-HRV2-XS_19970113-102413-355_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970113-102413-355_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970113-102413-355_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T22:54:55.347    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:54:55.349    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970113-102413-355_L1C_048-258-0_D_V1-0.zip
2024-01-09T22:54:55.349    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:54:55.349    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:54:55.349    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:54:55.349    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:54:55.349    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:54:55.349    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:54:55.349    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:54:55.349    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970113-102413-355_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/01/13/SPOT1-HRV2-XS_19970113-102421-636_L1C_048-259-0_D_V1-0/SPOT1-HRV2-XS_19970113-102421-636_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970113-102421-636_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970113-102421-636_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T22:54:58.760    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:54:58.761    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970113-102421-636_L1C_048-259-0_D_V1-0.zip
2024-01-09T22:54:58.761    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:54:58.762    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:54:58.762    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:54:58.762    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:54:58.762    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:54:58.762    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:54:58.762    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:54:58.762    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970113-102421-636_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/01/13/SPOT1-HRV2-XS_19970113-102425-246_L1C_048-259-4_D_V1-0/SPOT1-HRV2-XS_19970113-102425-246_L1C_048-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970113-102425-246_L1C_048-259-4_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970113-102425-246_L1C_048-259-4_D_V1-0.zip
run script
2024-01-09T22:55:02.051    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:55:02.052    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970113-102425-246_L1C_048-259-4_D_V1-0.zip
2024-01-09T22:55:02.052    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:55:02.053    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:55:02.053    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:55:02.053    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:55:02.053    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:55:02.053    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:55:02.053    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:55:02.053    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970113-102425-246_L1C_048-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/05/03/SPOT1-HRV1-XS_19970503-101224-353_L1C_048-257-5_D_V1-0/SPOT1-HRV1-XS_19970503-101224-353_L1C_048-257-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970503-101224-353_L1C_048-257-5_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970503-101224-353_L1C_048-257-5_D_V1-0.zip
run script
2024-01-09T22:55:05.398    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:55:05.399    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970503-101224-353_L1C_048-257-5_D_V1-0.zip
2024-01-09T22:55:05.399    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:55:05.399    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:55:05.399    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:55:05.399    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:55:05.399    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:55:05.399    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:55:05.399    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:55:05.399    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970503-101224-353_L1C_048-257-5_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/05/03/SPOT1-HRV1-XS_19970503-101228-062_L1C_049-258-0_D_V1-0/SPOT1-HRV1-XS_19970503-101228-062_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970503-101228-062_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970503-101228-062_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T22:55:59.967    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:55:59.969    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970503-101228-062_L1C_049-258-0_D_V1-0.zip
2024-01-09T22:55:59.969    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:55:59.969    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:55:59.969    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:55:59.969    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:55:59.969    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:55:59.969    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:55:59.969    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:55:59.969    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970503-101228-062_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/05/03/SPOT1-HRV1-XS_19970503-101236-292_L1C_049-259-0_D_V1-0/SPOT1-HRV1-XS_19970503-101236-292_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970503-101236-292_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970503-101236-292_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T22:56:44.354    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:56:44.355    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970503-101236-292_L1C_049-259-0_D_V1-0.zip
2024-01-09T22:56:44.355    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:56:44.355    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:56:44.355    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:56:44.355    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:56:44.355    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:56:44.356    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:56:44.356    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:56:44.356    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970503-101236-292_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/05/03/SPOT1-HRV1-XS_19970503-101244-531_L1C_049-260-0_D_V1-0/SPOT1-HRV1-XS_19970503-101244-531_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970503-101244-531_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970503-101244-531_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T22:57:19.843    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:57:19.844    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970503-101244-531_L1C_049-260-0_D_V1-0.zip
2024-01-09T22:57:19.844    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:57:19.844    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:57:19.844    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:57:19.844    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:57:19.844    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:57:19.845    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:57:19.845    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:57:19.845    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970503-101244-531_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/05/03/SPOT1-HRV1-XS_19970503-101247-238_L1C_049-260-3_D_V1-0/SPOT1-HRV1-XS_19970503-101247-238_L1C_049-260-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970503-101247-238_L1C_049-260-3_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970503-101247-238_L1C_049-260-3_D_V1-0.zip
run script
2024-01-09T22:57:39.315    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:57:39.316    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970503-101247-238_L1C_049-260-3_D_V1-0.zip
2024-01-09T22:57:39.316    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:57:39.316    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:57:39.316    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:57:39.316    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:57:39.316    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:57:39.316    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:57:39.316    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:57:39.316    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970503-101247-238_L1C_049-260-3_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/05/03/SPOT1-HRV1-XS_19970503-101304-318_L1C_051-262-6_D_V1-0/SPOT1-HRV1-XS_19970503-101304-318_L1C_051-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970503-101304-318_L1C_051-262-6_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970503-101304-318_L1C_051-262-6_D_V1-0.zip
run script
2024-01-09T22:57:55.544    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:57:55.545    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970503-101304-318_L1C_051-262-6_D_V1-0.zip
2024-01-09T22:57:55.545    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:57:55.545    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:57:55.545    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:57:55.545    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:57:55.545    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:57:55.545    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:57:55.545    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:57:55.546    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970503-101304-318_L1C_051-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/05/03/SPOT1-HRV1-XS_19970503-101307-178_L1C_051-263-0_D_V1-0/SPOT1-HRV1-XS_19970503-101307-178_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970503-101307-178_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970503-101307-178_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T22:59:05.471    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:59:05.472    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970503-101307-178_L1C_051-263-0_D_V1-0.zip
2024-01-09T22:59:05.472    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:59:05.472    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:59:05.472    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:59:05.472    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:59:05.472    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:59:05.472    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:59:05.472    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:59:05.472    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970503-101307-178_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/13/SPOT1-HRV1-XS_19970813-105410-177_L1C_048-257-0_D_V1-0/SPOT1-HRV1-XS_19970813-105410-177_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970813-105410-177_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970813-105410-177_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T22:59:46.966    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:59:46.967    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970813-105410-177_L1C_048-257-0_D_V1-0.zip
2024-01-09T22:59:46.967    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:59:46.967    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:59:46.967    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:59:46.967    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:59:46.967    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:59:46.967    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:59:46.967    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:59:46.967    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970813-105410-177_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/13/SPOT1-HRV1-XS_19970813-105418-612_L1C_048-258-0_D_V1-0/SPOT1-HRV1-XS_19970813-105418-612_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970813-105418-612_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970813-105418-612_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T23:00:49.953    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:00:49.954    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970813-105418-612_L1C_048-258-0_D_V1-0.zip
2024-01-09T23:00:49.954    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:00:49.954    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:00:49.954    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:00:49.954    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:00:49.955    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:00:49.955    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:00:49.955    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:00:49.955    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T23:01:22.796    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 266). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970813-105418-612_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1997/08/13/SPOT1-HRV1-XS_19970813-105427-046_L1C_048-259-0_D_V1-0/SPOT1-HRV1-XS_19970813-105427-046_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970813-105427-046_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970813-105427-046_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T23:01:25.958    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:01:25.960    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970813-105427-046_L1C_048-259-0_D_V1-0.zip
2024-01-09T23:01:25.960    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:01:25.960    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:01:25.960    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:01:25.960    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:01:25.960    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:01:25.960    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:01:25.960    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:01:25.960    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970813-105427-046_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/13/SPOT1-HRV1-XS_19970813-105428-851_L1C_048-259-2_D_V1-0/SPOT1-HRV1-XS_19970813-105428-851_L1C_048-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970813-105428-851_L1C_048-259-2_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970813-105428-851_L1C_048-259-2_D_V1-0.zip
run script
2024-01-09T23:01:38.067    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:01:38.068    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970813-105428-851_L1C_048-259-2_D_V1-0.zip
2024-01-09T23:01:38.068    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:01:38.068    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:01:38.068    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:01:38.068    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:01:38.068    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:01:38.068    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:01:38.068    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:01:38.069    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T23:01:40.131    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (159 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970813-105428-851_L1C_048-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1997/08/13/SPOT1-HRV1-XS_19970813-105358-744_L1C_049-255-6_D_V1-0/SPOT1-HRV1-XS_19970813-105358-744_L1C_049-255-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970813-105358-744_L1C_049-255-6_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970813-105358-744_L1C_049-255-6_D_V1-0.zip
run script
2024-01-09T23:01:43.956    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:01:43.957    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970813-105358-744_L1C_049-255-6_D_V1-0.zip
2024-01-09T23:01:43.957    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:01:43.957    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:01:43.957    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:01:43.957    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:01:43.957    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:01:43.957    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:01:43.957    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:01:43.957    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T23:02:52.274    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (662 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970813-105358-744_L1C_049-255-6_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1997/08/13/SPOT1-HRV1-XS_19970813-105401-752_L1C_049-256-0_D_V1-0/SPOT1-HRV1-XS_19970813-105401-752_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970813-105401-752_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970813-105401-752_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T23:02:57.438    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:02:57.439    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970813-105401-752_L1C_049-256-0_D_V1-0.zip
2024-01-09T23:02:57.440    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:02:57.440    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:02:57.440    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:02:57.440    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:02:57.440    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:02:57.440    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:02:57.440    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:02:57.440    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970813-105401-752_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/13/SPOT1-HRV2-XS_19970813-105358-404_L1C_050-255-8_D_V1-0/SPOT1-HRV2-XS_19970813-105358-404_L1C_050-255-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970813-105358-404_L1C_050-255-8_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970813-105358-404_L1C_050-255-8_D_V1-0.zip
run script
2024-01-09T23:04:16.073    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:04:16.074    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970813-105358-404_L1C_050-255-8_D_V1-0.zip
2024-01-09T23:04:16.074    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:04:16.074    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:04:16.074    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:04:16.074    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:04:16.074    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:04:16.074    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:04:16.074    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:04:16.074    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970813-105358-404_L1C_050-255-8_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/13/SPOT1-HRV2-XS_19970813-105359-634_L1C_050-256-0_D_V1-0/SPOT1-HRV2-XS_19970813-105359-634_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970813-105359-634_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970813-105359-634_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T23:07:25.695    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:07:25.696    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970813-105359-634_L1C_050-256-0_D_V1-0.zip
2024-01-09T23:07:25.696    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:07:25.696    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:07:25.697    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:07:25.697    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:07:25.697    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:07:25.697    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:07:25.697    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:07:25.697    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970813-105359-634_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/13/SPOT1-HRV2-XS_19970813-105408-087_L1C_050-257-0_D_V1-0/SPOT1-HRV2-XS_19970813-105408-087_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970813-105408-087_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970813-105408-087_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T23:10:53.124    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:10:53.125    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970813-105408-087_L1C_050-257-0_D_V1-0.zip
2024-01-09T23:10:53.125    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:10:53.126    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:10:53.126    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:10:53.126    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:10:53.126    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:10:53.126    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:10:53.126    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:10:53.126    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970813-105408-087_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/13/SPOT1-HRV2-XS_19970813-105416-542_L1C_050-258-0_D_V1-0/SPOT1-HRV2-XS_19970813-105416-542_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970813-105416-542_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970813-105416-542_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T23:14:07.996    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:14:07.998    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970813-105416-542_L1C_050-258-0_D_V1-0.zip
2024-01-09T23:14:07.998    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:14:07.998    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:14:07.998    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:14:07.998    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:14:07.998    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:14:07.998    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:14:07.998    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:14:07.998    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T23:15:59.014    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 874). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970813-105416-542_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1997/08/13/SPOT1-HRV2-XS_19970813-105425-001_L1C_050-259-0_D_V1-0/SPOT1-HRV2-XS_19970813-105425-001_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970813-105425-001_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970813-105425-001_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T23:16:01.989    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:16:01.991    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970813-105425-001_L1C_050-259-0_D_V1-0.zip
2024-01-09T23:16:01.991    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:16:01.991    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:16:01.991    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:16:01.991    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:16:01.991    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:16:01.991    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:16:01.991    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:16:01.991    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970813-105425-001_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/13/SPOT1-HRV2-XS_19970813-105428-610_L1C_050-259-4_D_V1-0/SPOT1-HRV2-XS_19970813-105428-610_L1C_050-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970813-105428-610_L1C_050-259-4_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970813-105428-610_L1C_050-259-4_D_V1-0.zip
run script
2024-01-09T23:17:36.312    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:17:36.313    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970813-105428-610_L1C_050-259-4_D_V1-0.zip
2024-01-09T23:17:36.313    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:17:36.314    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:17:36.314    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:17:36.314    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:17:36.314    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:17:36.314    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:17:36.314    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:17:36.314    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970813-105428-610_L1C_050-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/14/SPOT1-HRV1-XS_19970914-103940-559_L1C_048-257-0_D_V1-0/SPOT1-HRV1-XS_19970914-103940-559_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970914-103940-559_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970914-103940-559_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T23:19:00.406    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:19:00.407    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970914-103940-559_L1C_048-257-0_D_V1-0.zip
2024-01-09T23:19:00.407    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:19:00.408    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:19:00.408    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:19:00.408    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:19:00.408    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:19:00.408    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:19:00.408    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:19:00.408    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970914-103940-559_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/14/SPOT1-HRV1-XS_19970914-103948-879_L1C_048-258-0_D_V1-0/SPOT1-HRV1-XS_19970914-103948-879_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970914-103948-879_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970914-103948-879_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T23:19:52.274    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:19:52.275    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970914-103948-879_L1C_048-258-0_D_V1-0.zip
2024-01-09T23:19:52.275    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:19:52.275    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:19:52.275    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:19:52.275    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:19:52.275    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:19:52.276    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:19:52.276    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:19:52.276    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970914-103948-879_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/14/SPOT1-HRV1-XS_19970914-103957-205_L1C_048-259-0_D_V1-0/SPOT1-HRV1-XS_19970914-103957-205_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970914-103957-205_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970914-103957-205_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T23:20:22.186    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:20:22.188    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970914-103957-205_L1C_048-259-0_D_V1-0.zip
2024-01-09T23:20:22.188    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:20:22.188    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:20:22.188    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:20:22.188    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:20:22.188    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:20:22.188    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:20:22.188    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:20:22.188    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970914-103957-205_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/14/SPOT1-HRV1-XS_19970914-104005-540_L1C_048-260-0_D_V1-0/SPOT1-HRV1-XS_19970914-104005-540_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970914-104005-540_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970914-104005-540_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T23:20:33.987    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:20:33.988    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970914-104005-540_L1C_048-260-0_D_V1-0.zip
2024-01-09T23:20:33.988    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:20:33.988    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:20:33.988    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:20:33.988    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:20:33.988    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:20:33.988    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:20:33.988    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:20:33.988    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970914-104005-540_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/09/14/SPOT1-HRV1-XS_19970914-103930-260_L1C_049-255-7_D_V1-0/SPOT1-HRV1-XS_19970914-103930-260_L1C_049-255-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970914-103930-260_L1C_049-255-7_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970914-103930-260_L1C_049-255-7_D_V1-0.zip
run script
2024-01-09T23:20:36.841    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:20:36.842    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970914-103930-260_L1C_049-255-7_D_V1-0.zip
2024-01-09T23:20:36.842    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:20:36.842    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:20:36.842    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:20:36.843    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:20:36.843    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:20:36.843    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:20:36.843    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:20:36.843    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970914-103930-260_L1C_049-255-7_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/14/SPOT1-HRV1-XS_19970914-103932-248_L1C_049-256-0_D_V1-0/SPOT1-HRV1-XS_19970914-103932-248_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970914-103932-248_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970914-103932-248_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T23:21:36.139    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:21:36.141    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970914-103932-248_L1C_049-256-0_D_V1-0.zip
2024-01-09T23:21:36.141    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:21:36.141    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:21:36.141    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:21:36.141    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:21:36.141    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:21:36.141    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:21:36.141    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:21:36.141    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970914-103932-248_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/14/SPOT1-HRV2-XS_19970914-103930-272_L1C_050-255-9_D_V1-0/SPOT1-HRV2-XS_19970914-103930-272_L1C_050-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970914-103930-272_L1C_050-255-9_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970914-103930-272_L1C_050-255-9_D_V1-0.zip
run script
2024-01-09T23:22:42.146    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:22:42.147    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970914-103930-272_L1C_050-255-9_D_V1-0.zip
2024-01-09T23:22:42.147    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:22:42.147    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:22:42.147    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:22:42.147    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:22:42.147    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:22:42.147    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:22:42.147    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:22:42.147    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970914-103930-272_L1C_050-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/14/SPOT1-HRV2-XS_19970914-103930-473_L1C_050-256-0_D_V1-0/SPOT1-HRV2-XS_19970914-103930-473_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970914-103930-473_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970914-103930-473_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T23:25:17.327    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:25:17.328    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970914-103930-473_L1C_050-256-0_D_V1-0.zip
2024-01-09T23:25:17.329    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:25:17.329    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:25:17.329    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:25:17.329    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:25:17.329    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:25:17.329    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:25:17.329    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:25:17.329    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970914-103930-473_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/14/SPOT1-HRV2-XS_19970914-103938-802_L1C_050-257-0_D_V1-0/SPOT1-HRV2-XS_19970914-103938-802_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19970914-103938-802_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970914-103938-802_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T23:27:53.212    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:27:53.213    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970914-103938-802_L1C_050-257-0_D_V1-0.zip
2024-01-09T23:27:53.213    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:27:53.213    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:27:53.213    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:27:53.213    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:27:53.214    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:27:53.214    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:27:53.214    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:27:53.214    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970914-103938-802_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/14/SPOT1-HRV2-XS_19970914-103947-137_L1C_050-258-0_D_V1-0/SPOT1-HRV2-XS_19970914-103947-137_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970914-103947-137_L1C_050-258-0_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970914-103947-137_L1C_050-258-0_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/1997/09/14/SPOT1-HRV2-XS_19970914-103955-482_L1C_050-259-0_D_V1-0/SPOT1-HRV2-XS_19970914-103955-482_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970914-103955-482_L1C_050-259-0_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970914-103955-482_L1C_050-259-0_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/1997/09/14/SPOT1-HRV2-XS_19970914-104003-832_L1C_050-260-0_D_V1-0/SPOT1-HRV2-XS_19970914-104003-832_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970914-104003-832_L1C_050-260-0_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970914-104003-832_L1C_050-260-0_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/1997/09/14/SPOT1-HRV2-XS_19970914-104005-637_L1C_050-260-2_D_V1-0/SPOT1-HRV2-XS_19970914-104005-637_L1C_050-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970914-104005-637_L1C_050-260-2_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19970914-104005-637_L1C_050-260-2_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/1997/10/21/SPOT1-HRV1-XS_19971021-102900-648_L1C_048-257-0_D_V1-0/SPOT1-HRV1-XS_19971021-102900-648_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971021-102900-648_L1C_048-257-0_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971021-102900-648_L1C_048-257-0_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/1997/10/21/SPOT1-HRV1-XS_19971021-102908-908_L1C_048-258-0_D_V1-0/SPOT1-HRV1-XS_19971021-102908-908_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971021-102908-908_L1C_048-258-0_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971021-102908-908_L1C_048-258-0_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/1997/10/21/SPOT1-HRV1-XS_19971021-102917-174_L1C_049-259-0_D_V1-0/SPOT1-HRV1-XS_19971021-102917-174_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971021-102917-174_L1C_049-259-0_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971021-102917-174_L1C_049-259-0_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/1997/10/21/SPOT1-HRV1-XS_19971021-102922-588_L1C_049-259-6_D_V1-0/SPOT1-HRV1-XS_19971021-102922-588_L1C_049-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971021-102922-588_L1C_049-259-6_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19971021-102922-588_L1C_049-259-6_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/1997/10/21/SPOT1-HRV2-XS_19971021-102857-414_L1C_051-257-0_D_V1-0/SPOT1-HRV2-XS_19971021-102857-414_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19971021-102857-414_L1C_051-257-0_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19971021-102857-414_L1C_051-257-0_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/1997/10/21/SPOT1-HRV2-XS_19971021-102905-698_L1C_051-258-0_D_V1-0/SPOT1-HRV2-XS_19971021-102905-698_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19971021-102905-698_L1C_051-258-0_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19971021-102905-698_L1C_051-258-0_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/1997/10/21/SPOT1-HRV2-XS_19971021-102913-991_L1C_051-259-0_D_V1-0/SPOT1-HRV2-XS_19971021-102913-991_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19971021-102913-991_L1C_051-259-0_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19971021-102913-991_L1C_051-259-0_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/1997/10/21/SPOT1-HRV2-XS_19971021-102923-196_L1C_051-260-1_D_V1-0/SPOT1-HRV2-XS_19971021-102923-196_L1C_051-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19971021-102923-196_L1C_051-260-1_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016192/INPUT/SPOT1-HRV2-XS_19971021-102923-196_L1C_051-260-1_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/1997/07/20/SPOT1-HRV1-XS_19970720-101457-059_L1C_048-258-1_D_V1-0/SPOT1-HRV1-XS_19970720-101457-059_L1C_048-258-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970720-101457-059_L1C_048-258-1_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970720-101457-059_L1C_048-258-1_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/1997/07/20/SPOT1-HRV1-XS_19970720-101504-383_L1C_048-259-0_D_V1-0/SPOT1-HRV1-XS_19970720-101504-383_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970720-101504-383_L1C_048-259-0_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970720-101504-383_L1C_048-259-0_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/1997/07/20/SPOT1-HRV1-XS_19970720-101508-895_L1C_048-259-5_D_V1-0/SPOT1-HRV1-XS_19970720-101508-895_L1C_048-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970720-101508-895_L1C_048-259-5_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970720-101508-895_L1C_048-259-5_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/1997/07/20/SPOT1-HRV1-XS_19970720-101527-184_L1C_049-261-7_D_V1-0/SPOT1-HRV1-XS_19970720-101527-184_L1C_049-261-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970720-101527-184_L1C_049-261-7_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970720-101527-184_L1C_049-261-7_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/1997/07/20/SPOT1-HRV1-XS_19970720-101529-121_L1C_049-262-0_D_V1-0/SPOT1-HRV1-XS_19970720-101529-121_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970720-101529-121_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970720-101529-121_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T23:30:51.169    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:30:51.170    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970720-101529-121_L1C_049-262-0_D_V1-0.zip
2024-01-09T23:30:51.170    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:30:51.170    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:30:51.170    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:30:51.170    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:30:51.170    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:30:51.171    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:30:51.171    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:30:51.171    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970720-101529-121_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/07/29/SPOT1-HRV1-XS_19970729-104224-794_L1C_048-258-9_D_V1-0/SPOT1-HRV1-XS_19970729-104224-794_L1C_048-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970729-104224-794_L1C_048-258-9_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970729-104224-794_L1C_048-258-9_D_V1-0.zip
run script
2024-01-09T23:30:54.063    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:30:54.064    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970729-104224-794_L1C_048-258-9_D_V1-0.zip
2024-01-09T23:30:54.064    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:30:54.065    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:30:54.065    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:30:54.065    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:30:54.065    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:30:54.065    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:30:54.065    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:30:54.065    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970729-104224-794_L1C_048-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/07/29/SPOT1-HRV1-XS_19970729-104225-019_L1C_048-259-0_D_V1-0/SPOT1-HRV1-XS_19970729-104225-019_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970729-104225-019_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970729-104225-019_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T23:31:03.473    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:31:03.474    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970729-104225-019_L1C_048-259-0_D_V1-0.zip
2024-01-09T23:31:03.474    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:31:03.474    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:31:03.474    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:31:03.474    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:31:03.474    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:31:03.475    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:31:03.475    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:31:03.475    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016192/INPUT/SPOT1-HRV1-XS_19970729-104225-019_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016192/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
end
[2024-01-09 23:31:09.788248076+00:00] cnes_level2/barrouz/4016192:  Account (env) = cnes_level2
[2024-01-09 23:31:09.789641110+00:00] cnes_level2/barrouz/4016192:     User (env) = barrouz
[2024-01-09 23:31:09.790982725+00:00] cnes_level2/barrouz/4016192:        GroupId = cesbio(426000053)
[2024-01-09 23:31:09.792368749+00:00] cnes_level2/barrouz/4016192:         UserId = barrouz(9134)
[2024-01-09 23:31:09.793609834+00:00] cnes_level2/barrouz/4016192:        Account = cnes_level2
[2024-01-09 23:31:09.794849579+00:00] cnes_level2/barrouz/4016192:        Account = cnes_level2
[2024-01-09 23:31:09.796077944+00:00] cnes_level2/barrouz/4016192:      Partition = cpu2022
[2024-01-09 23:31:09.797293729+00:00] cnes_level2/barrouz/4016192:            QOS = cpu_2022_1280
[2024-01-09 23:31:09.798579763+00:00] cnes_level2/barrouz/4016192:        JobName = inf_ALP_3_TCD-BLUE_AVG-1200
[2024-01-09 23:31:09.799791768+00:00] cnes_level2/barrouz/4016192:     SubmitTime = 2024-01-09T10:51:51
[2024-01-09 23:31:09.800956994+00:00] cnes_level2/barrouz/4016192:        RunTime = 06:42:03
[2024-01-09 23:31:09.802214308+00:00] cnes_level2/barrouz/4016192:      TimeLimit = 1-16:00:00
[2024-01-09 23:31:09.803545033+00:00] cnes_level2/barrouz/4016192:   EligibleTime = 2024-01-09T10:51:51
[2024-01-09 23:31:09.804856738+00:00] cnes_level2/barrouz/4016192:      StartTime = 2024-01-09T16:49:06
[2024-01-09 23:31:09.806183332+00:00] cnes_level2/barrouz/4016192:        EndTime = 2024-01-09T23:31:09
[2024-01-09 23:31:09.807443817+00:00] cnes_level2/barrouz/4016192:       ExitCode = 0:0
[2024-01-09 23:31:09.808641682+00:00] cnes_level2/barrouz/4016192:       NodeList = trex008
[2024-01-09 23:31:09.809866837+00:00] cnes_level2/barrouz/4016192:      BatchHost = trex008
[2024-01-09 23:31:09.811200231+00:00] cnes_level2/barrouz/4016192:           TRES = 
[2024-01-09 23:31:09.812802245+00:00] cnes_level2/barrouz/4016192:        Command = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
[2024-01-09 23:31:09.814148439+00:00] cnes_level2/barrouz/4016192:        WorkDir = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code
[2024-01-09 23:31:09.815474354+00:00] cnes_level2/barrouz/4016192:         StdErr = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_3_TCD-BLUE_AVG-1200.log
[2024-01-09 23:31:09.816800228+00:00] cnes_level2/barrouz/4016192:         StdOut = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_3_TCD-BLUE_AVG-1200.log

#########################################
#        EVIDEN - CNES                  #
#        Job Accounting                 #
#########################################
Cluster              : trex
JobIDRaw             : 4016192
JobID                : 4016192
JobName              : inf_ALP_3_TCD-BLUE_AVG-1200
Account              : cnes_level2
User                 : barrouz(9134), cesbio(426000053)
Partition            : cpu2022
QOS                  : cpu_2022_1280
Nodelist             : trex008 (1)
State                : COMPLETED  (Exitcode=0:0, DerivedExitCode=0:0, Restarts=0)
Submit date          : 2024-01-09T10:51:51
Start time           : 2024-01-09T16:49:06
End time             : 2024-01-09T23:31:09
Elapsed time         : 06:42:03  (Timelimit=1-16:00:00, Suspended=00:00:00)
TEI                  : 2 days, 5:36:24
Command              : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
StdOut               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_3_TCD-BLUE_AVG-1200.log
StdErr               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_3_TCD-BLUE_AVG-1200.log

STEP(s) : 2
--------- 
   StepID  | JobName      State       Exit   Start               End                 Elapsed   TotalCPU   CPUTime    ConsumedEnergy MaxDiskRead MaxDiskWrite     MaxRSS MaxRSSTask MaxRSSNode NNodes UserCPU    NodeList
   ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 
   batch   | batch        COMPLETED   0:0    2024-01-09T16:49:06 2024-01-09T23:31:09 06:42:03  1-09:07:21 2-05:36:24      0.191875M  183977.60M    73697.06M 100998080K          0    trex008      1 23:27:29   trex008
   extern  | extern       COMPLETED   0:0    2024-01-09T16:49:06 2024-01-09T23:31:09 06:42:03  00:00.001  2-05:36:24      0.191875M       0.00M        0.00M      1688K          0    trex008      1 00:00:00   trex008

