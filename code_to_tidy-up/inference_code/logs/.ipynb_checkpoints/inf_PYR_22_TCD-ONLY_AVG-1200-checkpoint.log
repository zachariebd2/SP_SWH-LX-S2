unload conda/22.11.1  : OK 
load conda/22.11.1  : OK 
envs_dirs : /work/scratch/env/barrouz/conda_env/
pkgs_dirs : /work/scratch/env/barrouz/pkgs_conda
INPUT_PATH /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/PYR/22.txt
OUTPUT_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
DEM_PATH /work/CAMPUS/etudes/Neige/DEM
TCD_PATH /work/datalake/static_aux/TreeCoverDensity
MODELS_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
KEEP_REFL 0
MASK 1
start
/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/PYR/22.txt
muscate/SPOTWORLDHERITAGE/1997/06/23/SPOT1-HRV1-XS_19970623-103426-191_L1C_045-265-0_D_V1-0/SPOT1-HRV1-XS_19970623-103426-191_L1C_045-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970623-103426-191_L1C_045-265-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19970623-103426-191_L1C_045-265-0_D_V1-0.zip
run script
2024-01-10T19:49:05.798    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T19:49:05.800    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19970623-103426-191_L1C_045-265-0_D_V1-0.zip
2024-01-10T19:49:05.800    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T19:49:05.800    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T19:49:05.800    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T19:49:05.800    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T19:49:05.800    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T19:49:05.800    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T19:49:05.800    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T19:49:05.801    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T19:49:09.025    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (190 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19970623-103426-191_L1C_045-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1997/07/08/SPOT1-HRV1-XS_19970708-104620-922_L1C_043-263-6_D_V1-0/SPOT1-HRV1-XS_19970708-104620-922_L1C_043-263-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970708-104620-922_L1C_043-263-6_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19970708-104620-922_L1C_043-263-6_D_V1-0.zip
run script
2024-01-10T19:49:12.316    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T19:49:12.316    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19970708-104620-922_L1C_043-263-6_D_V1-0.zip
2024-01-10T19:49:12.316    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T19:49:12.316    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T19:49:12.317    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T19:49:12.317    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T19:49:12.317    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T19:49:12.317    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T19:49:12.317    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T19:49:12.317    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19970708-104620-922_L1C_043-263-6_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/07/08/SPOT1-HRV1-XS_19970708-104624-758_L1C_043-264-1_D_V1-0/SPOT1-HRV1-XS_19970708-104624-758_L1C_043-264-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970708-104624-758_L1C_043-264-1_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19970708-104624-758_L1C_043-264-1_D_V1-0.zip
run script
2024-01-10T19:50:51.029    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T19:50:51.030    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19970708-104624-758_L1C_043-264-1_D_V1-0.zip
2024-01-10T19:50:51.030    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T19:50:51.030    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T19:50:51.030    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T19:50:51.030    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T19:50:51.030    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T19:50:51.030    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T19:50:51.031    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T19:50:51.031    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19970708-104624-758_L1C_043-264-1_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/07/29/SPOT1-HRV1-XS_19970729-104305-555_L1C_043-263-0_D_V1-0/SPOT1-HRV1-XS_19970729-104305-555_L1C_043-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970729-104305-555_L1C_043-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19970729-104305-555_L1C_043-263-0_D_V1-0.zip
run script
2024-01-10T19:52:24.176    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T19:52:24.177    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19970729-104305-555_L1C_043-263-0_D_V1-0.zip
2024-01-10T19:52:24.177    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T19:52:24.177    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T19:52:24.177    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T19:52:24.177    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T19:52:24.177    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T19:52:24.177    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T19:52:24.177    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T19:52:24.177    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19970729-104305-555_L1C_043-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/07/29/SPOT1-HRV1-XS_19970729-104307-360_L1C_043-263-2_D_V1-0/SPOT1-HRV1-XS_19970729-104307-360_L1C_043-263-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970729-104307-360_L1C_043-263-2_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19970729-104307-360_L1C_043-263-2_D_V1-0.zip
run script
2024-01-10T19:53:37.223    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T19:53:37.223    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19970729-104307-360_L1C_043-263-2_D_V1-0.zip
2024-01-10T19:53:37.224    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T19:53:37.224    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T19:53:37.224    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T19:53:37.224    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T19:53:37.224    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T19:53:37.224    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T19:53:37.224    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T19:53:37.224    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19970729-104307-360_L1C_043-263-2_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/07/18/SPOT1-HRV1-XS_19970718-105427-814_L1C_043-264-0_D_V1-0/SPOT1-HRV1-XS_19970718-105427-814_L1C_043-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970718-105427-814_L1C_043-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19970718-105427-814_L1C_043-264-0_D_V1-0.zip
run script
2024-01-10T19:55:07.896    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T19:55:07.897    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19970718-105427-814_L1C_043-264-0_D_V1-0.zip
2024-01-10T19:55:07.898    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T19:55:07.898    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T19:55:07.898    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T19:55:07.898    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T19:55:07.898    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T19:55:07.898    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T19:55:07.898    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T19:55:07.898    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19970718-105427-814_L1C_043-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/07/18/SPOT1-HRV1-XS_19970718-105432-326_L1C_043-264-5_D_V1-0/SPOT1-HRV1-XS_19970718-105432-326_L1C_043-264-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970718-105432-326_L1C_043-264-5_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19970718-105432-326_L1C_043-264-5_D_V1-0.zip
run script
2024-01-10T19:56:49.200    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T19:56:49.200    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19970718-105432-326_L1C_043-264-5_D_V1-0.zip
2024-01-10T19:56:49.200    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T19:56:49.200    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T19:56:49.200    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T19:56:49.200    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T19:56:49.201    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T19:56:49.201    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T19:56:49.201    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T19:56:49.201    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19970718-105432-326_L1C_043-264-5_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/30/SPOT1-HRV1-XS_19970830-102844-717_L1C_043-264-1_D_V1-0/SPOT1-HRV1-XS_19970830-102844-717_L1C_043-264-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970830-102844-717_L1C_043-264-1_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19970830-102844-717_L1C_043-264-1_D_V1-0.zip
run script
2024-01-10T19:57:51.092    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T19:57:51.093    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19970830-102844-717_L1C_043-264-1_D_V1-0.zip
2024-01-10T19:57:51.093    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T19:57:51.093    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T19:57:51.093    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T19:57:51.093    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T19:57:51.093    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T19:57:51.093    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T19:57:51.093    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T19:57:51.093    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19970830-102844-717_L1C_043-264-1_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/05/23/SPOT1-HRV1-XS_19970523-102916-553_L1C_044-263-0_D_V1-0/SPOT1-HRV1-XS_19970523-102916-553_L1C_044-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970523-102916-553_L1C_044-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19970523-102916-553_L1C_044-263-0_D_V1-0.zip
run script
2024-01-10T19:59:45.023    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T19:59:45.023    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19970523-102916-553_L1C_044-263-0_D_V1-0.zip
2024-01-10T19:59:45.023    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T19:59:45.023    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T19:59:45.023    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T19:59:45.023    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T19:59:45.023    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T19:59:45.023    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T19:59:45.024    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T19:59:45.024    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19970523-102916-553_L1C_044-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/10/14/SPOT1-HRV1-XS_19971014-110429-589_L1C_045-263-0_D_V1-0/SPOT1-HRV1-XS_19971014-110429-589_L1C_045-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19971014-110429-589_L1C_045-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19971014-110429-589_L1C_045-263-0_D_V1-0.zip
run script
2024-01-10T20:01:06.684    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:01:06.684    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19971014-110429-589_L1C_045-263-0_D_V1-0.zip
2024-01-10T20:01:06.684    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:01:06.684    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:01:06.684    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:01:06.685    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:01:06.685    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:01:06.685    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:01:06.685    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:01:06.685    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19971014-110429-589_L1C_045-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/10/14/SPOT1-HRV1-XS_19971014-110438-063_L1C_045-264-0_D_V1-0/SPOT1-HRV1-XS_19971014-110438-063_L1C_045-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19971014-110438-063_L1C_045-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19971014-110438-063_L1C_045-264-0_D_V1-0.zip
run script
2024-01-10T20:02:24.460    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:02:24.461    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19971014-110438-063_L1C_045-264-0_D_V1-0.zip
2024-01-10T20:02:24.461    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:02:24.461    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:02:24.461    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:02:24.461    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:02:24.461    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:02:24.461    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:02:24.461    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:02:24.461    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19971014-110438-063_L1C_045-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/10/14/SPOT1-HRV1-XS_19971014-110446-542_L1C_045-265-0_D_V1-0/SPOT1-HRV1-XS_19971014-110446-542_L1C_045-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19971014-110446-542_L1C_045-265-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19971014-110446-542_L1C_045-265-0_D_V1-0.zip
run script
2024-01-10T20:04:22.201    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:04:22.202    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19971014-110446-542_L1C_045-265-0_D_V1-0.zip
2024-01-10T20:04:22.202    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:04:22.202    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:04:22.202    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:04:22.202    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:04:22.202    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:04:22.202    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:04:22.202    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:04:22.202    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19971014-110446-542_L1C_045-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/10/14/SPOT1-HRV2-XS_19971014-110427-048_L1C_046-263-0_D_V1-0/SPOT1-HRV2-XS_19971014-110427-048_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19971014-110427-048_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT1-HRV2-XS_19971014-110427-048_L1C_046-263-0_D_V1-0.zip
run script
2024-01-10T20:05:00.389    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:05:00.390    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT1-HRV2-XS_19971014-110427-048_L1C_046-263-0_D_V1-0.zip
2024-01-10T20:05:00.390    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:05:00.390    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:05:00.391    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:05:00.391    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:05:00.391    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:05:00.391    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:05:00.391    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:05:00.391    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT1-HRV2-XS_19971014-110427-048_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/10/14/SPOT1-HRV2-XS_19971014-110435-548_L1C_046-264-0_D_V1-0/SPOT1-HRV2-XS_19971014-110435-548_L1C_046-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19971014-110435-548_L1C_046-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT1-HRV2-XS_19971014-110435-548_L1C_046-264-0_D_V1-0.zip
run script
2024-01-10T20:05:23.059    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:05:23.060    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT1-HRV2-XS_19971014-110435-548_L1C_046-264-0_D_V1-0.zip
2024-01-10T20:05:23.061    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:05:23.061    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:05:23.061    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:05:23.061    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:05:23.061    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:05:23.061    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:05:23.061    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:05:23.061    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT1-HRV2-XS_19971014-110435-548_L1C_046-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/10/14/SPOT1-HRV2-XS_19971014-110444-052_L1C_046-265-0_D_V1-0/SPOT1-HRV2-XS_19971014-110444-052_L1C_046-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19971014-110444-052_L1C_046-265-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT1-HRV2-XS_19971014-110444-052_L1C_046-265-0_D_V1-0.zip
run script
2024-01-10T20:06:14.276    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:06:14.277    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT1-HRV2-XS_19971014-110444-052_L1C_046-265-0_D_V1-0.zip
2024-01-10T20:06:14.278    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:06:14.278    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:06:14.278    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:06:14.278    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:06:14.278    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:06:14.278    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:06:14.278    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:06:14.278    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT1-HRV2-XS_19971014-110444-052_L1C_046-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/11/14/SPOT1-HRV1-XS_19971114-110859-409_L1C_045-263-0_D_V1-0/SPOT1-HRV1-XS_19971114-110859-409_L1C_045-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19971114-110859-409_L1C_045-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19971114-110859-409_L1C_045-263-0_D_V1-0.zip
run script
2024-01-10T20:06:37.887    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:06:37.888    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19971114-110859-409_L1C_045-263-0_D_V1-0.zip
2024-01-10T20:06:37.888    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:06:37.888    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:06:37.888    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:06:37.888    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:06:37.888    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:06:37.888    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:06:37.888    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:06:37.888    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19971114-110859-409_L1C_045-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/11/14/SPOT1-HRV1-XS_19971114-110907-910_L1C_045-264-0_D_V1-0/SPOT1-HRV1-XS_19971114-110907-910_L1C_045-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19971114-110907-910_L1C_045-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19971114-110907-910_L1C_045-264-0_D_V1-0.zip
run script
2024-01-10T20:08:09.533    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:08:09.534    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19971114-110907-910_L1C_045-264-0_D_V1-0.zip
2024-01-10T20:08:09.534    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:08:09.534    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:08:09.534    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:08:09.534    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:08:09.535    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:08:09.535    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:08:09.535    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:08:09.535    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19971114-110907-910_L1C_045-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/11/14/SPOT1-HRV1-XS_19971114-110909-715_L1C_045-264-2_D_V1-0/SPOT1-HRV1-XS_19971114-110909-715_L1C_045-264-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19971114-110909-715_L1C_045-264-2_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19971114-110909-715_L1C_045-264-2_D_V1-0.zip
run script
2024-01-10T20:10:34.849    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:10:34.850    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19971114-110909-715_L1C_045-264-2_D_V1-0.zip
2024-01-10T20:10:34.850    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:10:34.850    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:10:34.850    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:10:34.850    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:10:34.850    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:10:34.851    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:10:34.851    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:10:34.851    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19971114-110909-715_L1C_045-264-2_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/06/08/SPOT1-HRV1-XS_19970608-102220-354_L1C_045-265-0_D_V1-0/SPOT1-HRV1-XS_19970608-102220-354_L1C_045-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970608-102220-354_L1C_045-265-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19970608-102220-354_L1C_045-265-0_D_V1-0.zip
run script
2024-01-10T20:12:36.567    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:12:36.567    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19970608-102220-354_L1C_045-265-0_D_V1-0.zip
2024-01-10T20:12:36.567    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:12:36.567    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:12:36.567    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:12:36.567    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:12:36.567    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:12:36.567    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:12:36.567    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:12:36.567    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19970608-102220-354_L1C_045-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/06/08/SPOT1-HRV1-XS_19970608-102202-192_L1C_046-263-0_D_V1-0/SPOT1-HRV1-XS_19970608-102202-192_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19970608-102202-192_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19970608-102202-192_L1C_046-263-0_D_V1-0.zip
run script
2024-01-10T20:13:10.531    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:13:10.532    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19970608-102202-192_L1C_046-263-0_D_V1-0.zip
2024-01-10T20:13:10.532    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:13:10.532    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:13:10.532    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:13:10.532    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:13:10.532    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:13:10.532    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:13:10.532    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:13:10.532    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT1-HRV1-XS_19970608-102202-192_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 2]
 [2 2 2 ... 0 0 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/03/27/SPOT4-HRVIR1-XS_19980327-111954-260_L1C_036-262-0_D_V1-0/SPOT4-HRVIR1-XS_19980327-111954-260_L1C_036-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980327-111954-260_L1C_036-262-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980327-111954-260_L1C_036-262-0_D_V1-0.zip
run script
2024-01-10T20:13:26.355    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:13:26.357    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980327-111954-260_L1C_036-262-0_D_V1-0.zip
2024-01-10T20:13:26.357    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:13:26.357    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:13:26.357    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:13:26.357    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:13:26.357    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:13:26.358    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:13:26.358    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:13:26.358    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T20:13:27.765    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 630). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980327-111954-260_L1C_036-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1998/03/27/SPOT4-HRVIR1-XS_19980327-112001-479_L1C_036-262-8_D_V1-0/SPOT4-HRVIR1-XS_19980327-112001-479_L1C_036-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980327-112001-479_L1C_036-262-8_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980327-112001-479_L1C_036-262-8_D_V1-0.zip
run script
2024-01-10T20:13:30.962    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:13:30.963    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980327-112001-479_L1C_036-262-8_D_V1-0.zip
2024-01-10T20:13:30.963    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:13:30.963    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:13:30.963    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:13:30.963    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:13:30.963    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:13:30.963    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:13:30.963    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:13:30.963    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980327-112001-479_L1C_036-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/23/SPOT4-HRVIR2-XS_19980723-113006-692_L1C_036-262-9_D_V1-0/SPOT4-HRVIR2-XS_19980723-113006-692_L1C_036-262-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980723-113006-692_L1C_036-262-9_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980723-113006-692_L1C_036-262-9_D_V1-0.zip
run script
2024-01-10T20:14:04.739    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:14:04.740    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980723-113006-692_L1C_036-262-9_D_V1-0.zip
2024-01-10T20:14:04.740    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:14:04.740    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:14:04.740    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:14:04.740    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:14:04.740    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:14:04.740    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:14:04.740    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:14:04.740    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980723-113006-692_L1C_036-262-9_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/23/SPOT4-HRVIR2-XS_19980723-113007-065_L1C_036-263-0_D_V1-0/SPOT4-HRVIR2-XS_19980723-113007-065_L1C_036-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980723-113007-065_L1C_036-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980723-113007-065_L1C_036-263-0_D_V1-0.zip
run script
2024-01-10T20:15:13.770    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:15:13.770    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980723-113007-065_L1C_036-263-0_D_V1-0.zip
2024-01-10T20:15:13.770    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:15:13.770    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:15:13.770    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:15:13.770    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:15:13.771    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:15:13.771    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:15:13.771    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:15:13.771    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980723-113007-065_L1C_036-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/23/SPOT4-HRVIR2-XS_19980723-113008-870_L1C_036-263-2_D_V1-0/SPOT4-HRVIR2-XS_19980723-113008-870_L1C_036-263-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980723-113008-870_L1C_036-263-2_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980723-113008-870_L1C_036-263-2_D_V1-0.zip
run script
2024-01-10T20:16:24.364    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:16:24.365    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980723-113008-870_L1C_036-263-2_D_V1-0.zip
2024-01-10T20:16:24.365    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:16:24.365    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:16:24.365    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:16:24.365    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:16:24.365    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:16:24.365    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:16:24.365    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:16:24.366    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980723-113008-870_L1C_036-263-2_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/09/SPOT4-HRVIR1-XS_19980809-110304-939_L1C_036-262-4_D_V1-0/SPOT4-HRVIR1-XS_19980809-110304-939_L1C_036-262-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980809-110304-939_L1C_036-262-4_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980809-110304-939_L1C_036-262-4_D_V1-0.zip
run script
2024-01-10T20:17:41.949    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:17:41.949    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980809-110304-939_L1C_036-262-4_D_V1-0.zip
2024-01-10T20:17:41.950    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:17:41.950    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:17:41.950    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:17:41.950    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:17:41.950    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:17:41.950    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:17:41.950    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:17:41.950    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980809-110304-939_L1C_036-262-4_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/09/SPOT4-HRVIR2-XS_19980809-110315-741_L1C_038-263-9_D_V1-0/SPOT4-HRVIR2-XS_19980809-110315-741_L1C_038-263-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980809-110315-741_L1C_038-263-9_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980809-110315-741_L1C_038-263-9_D_V1-0.zip
run script
2024-01-10T20:18:08.553    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:18:08.554    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980809-110315-741_L1C_038-263-9_D_V1-0.zip
2024-01-10T20:18:08.555    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:18:08.555    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:18:08.555    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:18:08.555    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:18:08.555    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:18:08.555    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:18:08.555    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:18:08.555    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980809-110315-741_L1C_038-263-9_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/09/SPOT4-HRVIR2-XS_19980809-110315-954_L1C_038-264-0_D_V1-0/SPOT4-HRVIR2-XS_19980809-110315-954_L1C_038-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980809-110315-954_L1C_038-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980809-110315-954_L1C_038-264-0_D_V1-0.zip
run script
2024-01-10T20:19:53.422    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:19:53.424    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980809-110315-954_L1C_038-264-0_D_V1-0.zip
2024-01-10T20:19:53.424    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:19:53.424    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:19:53.424    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:19:53.424    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:19:53.424    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:19:53.424    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:19:53.424    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:19:53.424    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980809-110315-954_L1C_038-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/12/17/SPOT4-HRVIR1-XS_19981217-110312-950_L1C_036-262-7_D_V1-0/SPOT4-HRVIR1-XS_19981217-110312-950_L1C_036-262-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19981217-110312-950_L1C_036-262-7_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981217-110312-950_L1C_036-262-7_D_V1-0.zip
run script
2024-01-10T20:21:35.296    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:21:35.296    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981217-110312-950_L1C_036-262-7_D_V1-0.zip
2024-01-10T20:21:35.296    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:21:35.296    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:21:35.296    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:21:35.296    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:21:35.296    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:21:35.296    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:21:35.297    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:21:35.297    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981217-110312-950_L1C_036-262-7_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/11/21/SPOT4-HRVIR1-XS_19981121-110318-857_L1C_037-262-8_D_V1-0/SPOT4-HRVIR1-XS_19981121-110318-857_L1C_037-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19981121-110318-857_L1C_037-262-8_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981121-110318-857_L1C_037-262-8_D_V1-0.zip
run script
2024-01-10T20:22:06.876    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:22:06.878    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981121-110318-857_L1C_037-262-8_D_V1-0.zip
2024-01-10T20:22:06.878    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:22:06.878    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:22:06.878    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:22:06.878    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:22:06.878    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:22:06.878    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:22:06.878    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:22:06.878    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981121-110318-857_L1C_037-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/11/21/SPOT4-HRVIR1-XS_19981121-110319-958_L1C_037-263-0_D_V1-0/SPOT4-HRVIR1-XS_19981121-110319-958_L1C_037-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19981121-110319-958_L1C_037-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981121-110319-958_L1C_037-263-0_D_V1-0.zip
run script
2024-01-10T20:23:03.210    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:23:03.211    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981121-110319-958_L1C_037-263-0_D_V1-0.zip
2024-01-10T20:23:03.211    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:23:03.211    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:23:03.211    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:23:03.211    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:23:03.211    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:23:03.211    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:23:03.211    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:23:03.211    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981121-110319-958_L1C_037-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/30/SPOT4-HRVIR2-XS_19980730-105524-757_L1C_037-263-1_D_V1-0/SPOT4-HRVIR2-XS_19980730-105524-757_L1C_037-263-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980730-105524-757_L1C_037-263-1_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980730-105524-757_L1C_037-263-1_D_V1-0.zip
run script
2024-01-10T20:24:11.729    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:24:11.730    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980730-105524-757_L1C_037-263-1_D_V1-0.zip
2024-01-10T20:24:11.730    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:24:11.730    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:24:11.730    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:24:11.730    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:24:11.730    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:24:11.730    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:24:11.731    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:24:11.731    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980730-105524-757_L1C_037-263-1_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/29/SPOT4-HRVIR1-XS_19980629-105119-271_L1C_038-262-8_D_V1-0/SPOT4-HRVIR1-XS_19980629-105119-271_L1C_038-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980629-105119-271_L1C_038-262-8_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980629-105119-271_L1C_038-262-8_D_V1-0.zip
run script
2024-01-10T20:25:26.642    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:25:26.643    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980629-105119-271_L1C_038-262-8_D_V1-0.zip
2024-01-10T20:25:26.643    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:25:26.643    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:25:26.643    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:25:26.643    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:25:26.643    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:25:26.643    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:25:26.643    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:25:26.643    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980629-105119-271_L1C_038-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/29/SPOT4-HRVIR1-XS_19980629-105120-333_L1C_038-263-0_D_V1-0/SPOT4-HRVIR1-XS_19980629-105120-333_L1C_038-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980629-105120-333_L1C_038-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980629-105120-333_L1C_038-263-0_D_V1-0.zip
run script
2024-01-10T20:26:32.962    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:26:32.963    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980629-105120-333_L1C_038-263-0_D_V1-0.zip
2024-01-10T20:26:32.963    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:26:32.963    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:26:32.963    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:26:32.964    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:26:32.964    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:26:32.964    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:26:32.964    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:26:32.964    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980629-105120-333_L1C_038-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/29/SPOT4-HRVIR1-XS_19980629-105128-623_L1C_038-264-0_D_V1-0/SPOT4-HRVIR1-XS_19980629-105128-623_L1C_038-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980629-105128-623_L1C_038-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980629-105128-623_L1C_038-264-0_D_V1-0.zip
run script
2024-01-10T20:27:51.390    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:27:51.391    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980629-105128-623_L1C_038-264-0_D_V1-0.zip
2024-01-10T20:27:51.391    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:27:51.391    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:27:51.391    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:27:51.391    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:27:51.391    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:27:51.391    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:27:51.391    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:27:51.391    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980629-105128-623_L1C_038-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/29/SPOT4-HRVIR2-XS_19980629-105118-742_L1C_039-262-9_D_V1-0/SPOT4-HRVIR2-XS_19980629-105118-742_L1C_039-262-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980629-105118-742_L1C_039-262-9_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980629-105118-742_L1C_039-262-9_D_V1-0.zip
run script
2024-01-10T20:29:44.035    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:29:44.036    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980629-105118-742_L1C_039-262-9_D_V1-0.zip
2024-01-10T20:29:44.036    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:29:44.036    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:29:44.036    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:29:44.036    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:29:44.036    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:29:44.036    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:29:44.036    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:29:44.036    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T20:30:47.976    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (140 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980629-105118-742_L1C_039-262-9_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1998/06/29/SPOT4-HRVIR2-XS_19980629-105118-910_L1C_040-263-0_D_V1-0/SPOT4-HRVIR2-XS_19980629-105118-910_L1C_040-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980629-105118-910_L1C_040-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980629-105118-910_L1C_040-263-0_D_V1-0.zip
run script
2024-01-10T20:30:50.888    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:30:50.888    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980629-105118-910_L1C_040-263-0_D_V1-0.zip
2024-01-10T20:30:50.889    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:30:50.889    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:30:50.889    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:30:50.889    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:30:50.889    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:30:50.889    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:30:50.889    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:30:50.889    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T20:31:57.146    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (143 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980629-105118-910_L1C_040-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1998/06/29/SPOT4-HRVIR2-XS_19980629-105127-207_L1C_040-264-0_D_V1-0/SPOT4-HRVIR2-XS_19980629-105127-207_L1C_040-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980629-105127-207_L1C_040-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980629-105127-207_L1C_040-264-0_D_V1-0.zip
run script
2024-01-10T20:32:00.386    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:32:00.386    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980629-105127-207_L1C_040-264-0_D_V1-0.zip
2024-01-10T20:32:00.386    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:32:00.386    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:32:00.386    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:32:00.386    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:32:00.387    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:32:00.387    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:32:00.387    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:32:00.387    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980629-105127-207_L1C_040-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/29/SPOT4-HRVIR2-XS_19980629-105129-011_L1C_040-264-2_D_V1-0/SPOT4-HRVIR2-XS_19980629-105129-011_L1C_040-264-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980629-105129-011_L1C_040-264-2_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980629-105129-011_L1C_040-264-2_D_V1-0.zip
run script
2024-01-10T20:33:46.252    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:33:46.252    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980629-105129-011_L1C_040-264-2_D_V1-0.zip
2024-01-10T20:33:46.252    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:33:46.252    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:33:46.252    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:33:46.252    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:33:46.253    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:33:46.253    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:33:46.253    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:33:46.253    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980629-105129-011_L1C_040-264-2_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/08/SPOT4-HRVIR1-XS_19980708-111824-343_L1C_038-262-7_D_V1-0/SPOT4-HRVIR1-XS_19980708-111824-343_L1C_038-262-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980708-111824-343_L1C_038-262-7_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980708-111824-343_L1C_038-262-7_D_V1-0.zip
run script
2024-01-10T20:35:25.667    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:35:25.669    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980708-111824-343_L1C_038-262-7_D_V1-0.zip
2024-01-10T20:35:25.669    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:35:25.669    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:35:25.669    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:35:25.669    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:35:25.669    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:35:25.669    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:35:25.669    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:35:25.669    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980708-111824-343_L1C_038-262-7_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/08/SPOT4-HRVIR2-XS_19980708-111832-751_L1C_039-264-0_D_V1-0/SPOT4-HRVIR2-XS_19980708-111832-751_L1C_039-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980708-111832-751_L1C_039-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980708-111832-751_L1C_039-264-0_D_V1-0.zip
run script
2024-01-10T20:36:28.942    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:36:28.943    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980708-111832-751_L1C_039-264-0_D_V1-0.zip
2024-01-10T20:36:28.943    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:36:28.943    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:36:28.943    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:36:28.943    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:36:28.943    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:36:28.944    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:36:28.944    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:36:28.944    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980708-111832-751_L1C_039-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/09/SPOT4-HRVIR1-XS_19980709-105908-913_L1C_038-262-9_D_V1-0/SPOT4-HRVIR1-XS_19980709-105908-913_L1C_038-262-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980709-105908-913_L1C_038-262-9_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980709-105908-913_L1C_038-262-9_D_V1-0.zip
run script
2024-01-10T20:38:39.981    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:38:39.981    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980709-105908-913_L1C_038-262-9_D_V1-0.zip
2024-01-10T20:38:39.981    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:38:39.981    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:38:39.981    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:38:39.981    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:38:39.982    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:38:39.982    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:38:39.982    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:38:39.982    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980709-105908-913_L1C_038-262-9_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/09/SPOT4-HRVIR1-XS_19980709-105909-099_L1C_038-263-0_D_V1-0/SPOT4-HRVIR1-XS_19980709-105909-099_L1C_038-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980709-105909-099_L1C_038-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980709-105909-099_L1C_038-263-0_D_V1-0.zip
run script
2024-01-10T20:39:52.261    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:39:52.261    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980709-105909-099_L1C_038-263-0_D_V1-0.zip
2024-01-10T20:39:52.261    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:39:52.262    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:39:52.262    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:39:52.262    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:39:52.262    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:39:52.262    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:39:52.262    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:39:52.262    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980709-105909-099_L1C_038-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/09/SPOT4-HRVIR1-XS_19980709-105917-416_L1C_038-264-0_D_V1-0/SPOT4-HRVIR1-XS_19980709-105917-416_L1C_038-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980709-105917-416_L1C_038-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980709-105917-416_L1C_038-264-0_D_V1-0.zip
run script
2024-01-10T20:41:08.376    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:41:08.377    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980709-105917-416_L1C_038-264-0_D_V1-0.zip
2024-01-10T20:41:08.377    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:41:08.377    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:41:08.377    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:41:08.378    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:41:08.378    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:41:08.378    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:41:08.378    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:41:08.378    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980709-105917-416_L1C_038-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/09/SPOT4-HRVIR2-XS_19980709-105907-159_L1C_039-262-9_D_V1-0/SPOT4-HRVIR2-XS_19980709-105907-159_L1C_039-262-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980709-105907-159_L1C_039-262-9_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980709-105907-159_L1C_039-262-9_D_V1-0.zip
run script
2024-01-10T20:42:55.301    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:42:55.302    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980709-105907-159_L1C_039-262-9_D_V1-0.zip
2024-01-10T20:42:55.303    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:42:55.303    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:42:55.303    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:42:55.303    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:42:55.303    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:42:55.303    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:42:55.303    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:42:55.303    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T20:43:56.475    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (570 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980709-105907-159_L1C_039-262-9_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1998/07/09/SPOT4-HRVIR2-XS_19980709-105907-357_L1C_040-263-0_D_V1-0/SPOT4-HRVIR2-XS_19980709-105907-357_L1C_040-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980709-105907-357_L1C_040-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980709-105907-357_L1C_040-263-0_D_V1-0.zip
run script
2024-01-10T20:43:59.456    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:43:59.457    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980709-105907-357_L1C_040-263-0_D_V1-0.zip
2024-01-10T20:43:59.457    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:43:59.457    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:43:59.457    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:43:59.457    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:43:59.457    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:43:59.457    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:43:59.457    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:43:59.457    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T20:45:02.060    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2364 x 0). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980709-105907-357_L1C_040-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1998/07/09/SPOT4-HRVIR2-XS_19980709-105915-687_L1C_040-264-0_D_V1-0/SPOT4-HRVIR2-XS_19980709-105915-687_L1C_040-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980709-105915-687_L1C_040-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980709-105915-687_L1C_040-264-0_D_V1-0.zip
run script
2024-01-10T20:45:05.317    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:45:05.317    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980709-105915-687_L1C_040-264-0_D_V1-0.zip
2024-01-10T20:45:05.317    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:45:05.318    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:45:05.318    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:45:05.318    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:45:05.318    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:45:05.318    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:45:05.318    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:45:05.318    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980709-105915-687_L1C_040-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/09/SPOT4-HRVIR2-XS_19980709-105917-491_L1C_040-264-2_D_V1-0/SPOT4-HRVIR2-XS_19980709-105917-491_L1C_040-264-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980709-105917-491_L1C_040-264-2_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980709-105917-491_L1C_040-264-2_D_V1-0.zip
run script
2024-01-10T20:46:48.153    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:46:48.154    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980709-105917-491_L1C_040-264-2_D_V1-0.zip
2024-01-10T20:46:48.154    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:46:48.154    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:46:48.154    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:46:48.154    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:46:48.154    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:46:48.154    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:46:48.154    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:46:48.155    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980709-105917-491_L1C_040-264-2_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/14/SPOT4-HRVIR2-XS_19980714-110302-271_L1C_038-262-9_D_V1-0/SPOT4-HRVIR2-XS_19980714-110302-271_L1C_038-262-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980714-110302-271_L1C_038-262-9_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980714-110302-271_L1C_038-262-9_D_V1-0.zip
run script
2024-01-10T20:48:30.432    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:48:30.433    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980714-110302-271_L1C_038-262-9_D_V1-0.zip
2024-01-10T20:48:30.433    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:48:30.434    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:48:30.434    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:48:30.434    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:48:30.434    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:48:30.434    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:48:30.434    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:48:30.434    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980714-110302-271_L1C_038-262-9_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/14/SPOT4-HRVIR2-XS_19980714-110302-475_L1C_038-263-0_D_V1-0/SPOT4-HRVIR2-XS_19980714-110302-475_L1C_038-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980714-110302-475_L1C_038-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980714-110302-475_L1C_038-263-0_D_V1-0.zip
run script
2024-01-10T20:49:42.116    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:49:42.117    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980714-110302-475_L1C_038-263-0_D_V1-0.zip
2024-01-10T20:49:42.117    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:49:42.117    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:49:42.117    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:49:42.117    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:49:42.117    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:49:42.117    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:49:42.117    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:49:42.117    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980714-110302-475_L1C_038-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/14/SPOT4-HRVIR2-XS_19980714-110310-810_L1C_038-264-0_D_V1-0/SPOT4-HRVIR2-XS_19980714-110310-810_L1C_038-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980714-110310-810_L1C_038-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980714-110310-810_L1C_038-264-0_D_V1-0.zip
run script
2024-01-10T20:50:54.875    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:50:54.876    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980714-110310-810_L1C_038-264-0_D_V1-0.zip
2024-01-10T20:50:54.876    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:50:54.876    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:50:54.876    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:50:54.876    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:50:54.876    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:50:54.876    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:50:54.876    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:50:54.876    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980714-110310-810_L1C_038-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/14/SPOT4-HRVIR1-XS_19980714-110300-984_L1C_039-263-0_D_V1-0/SPOT4-HRVIR1-XS_19980714-110300-984_L1C_039-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980714-110300-984_L1C_039-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980714-110300-984_L1C_039-263-0_D_V1-0.zip
run script
2024-01-10T20:52:38.971    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:52:38.972    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980714-110300-984_L1C_039-263-0_D_V1-0.zip
2024-01-10T20:52:38.972    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:52:38.972    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:52:38.972    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:52:38.972    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:52:38.972    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:52:38.972    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:52:38.973    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:52:38.973    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980714-110300-984_L1C_039-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/14/SPOT4-HRVIR1-XS_19980714-110309-332_L1C_039-264-0_D_V1-0/SPOT4-HRVIR1-XS_19980714-110309-332_L1C_039-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980714-110309-332_L1C_039-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980714-110309-332_L1C_039-264-0_D_V1-0.zip
run script
2024-01-10T20:53:42.874    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:53:42.874    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980714-110309-332_L1C_039-264-0_D_V1-0.zip
2024-01-10T20:53:42.874    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:53:42.874    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:53:42.875    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:53:42.875    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:53:42.875    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:53:42.875    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:53:42.875    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:53:42.875    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980714-110309-332_L1C_039-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/14/SPOT4-HRVIR1-XS_19980714-110311-136_L1C_039-264-2_D_V1-0/SPOT4-HRVIR1-XS_19980714-110311-136_L1C_039-264-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980714-110311-136_L1C_039-264-2_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980714-110311-136_L1C_039-264-2_D_V1-0.zip
run script
2024-01-10T20:55:29.969    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:55:29.970    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980714-110311-136_L1C_039-264-2_D_V1-0.zip
2024-01-10T20:55:29.970    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:55:29.970    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:55:29.970    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:55:29.970    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:55:29.971    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:55:29.971    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:55:29.971    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:55:29.971    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980714-110311-136_L1C_039-264-2_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/09/SPOT4-HRVIR2-XS_19980909-110659-120_L1C_038-262-7_D_V1-0/SPOT4-HRVIR2-XS_19980909-110659-120_L1C_038-262-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980909-110659-120_L1C_038-262-7_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980909-110659-120_L1C_038-262-7_D_V1-0.zip
run script
2024-01-10T20:57:08.386    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:57:08.387    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980909-110659-120_L1C_038-262-7_D_V1-0.zip
2024-01-10T20:57:08.387    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:57:08.387    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:57:08.387    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:57:08.387    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:57:08.387    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:57:08.387    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:57:08.387    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:57:08.387    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980909-110659-120_L1C_038-262-7_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/09/SPOT4-HRVIR2-XS_19980909-110701-150_L1C_038-263-0_D_V1-0/SPOT4-HRVIR2-XS_19980909-110701-150_L1C_038-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980909-110701-150_L1C_038-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980909-110701-150_L1C_038-263-0_D_V1-0.zip
run script
2024-01-10T20:58:05.813    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:58:05.814    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980909-110701-150_L1C_038-263-0_D_V1-0.zip
2024-01-10T20:58:05.814    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:58:05.814    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:58:05.814    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:58:05.814    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:58:05.814    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:58:05.814    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:58:05.815    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:58:05.815    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980909-110701-150_L1C_038-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/09/SPOT4-HRVIR2-XS_19980909-110709-503_L1C_038-264-0_D_V1-0/SPOT4-HRVIR2-XS_19980909-110709-503_L1C_038-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980909-110709-503_L1C_038-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980909-110709-503_L1C_038-264-0_D_V1-0.zip
run script
2024-01-10T20:59:22.085    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T20:59:22.086    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980909-110709-503_L1C_038-264-0_D_V1-0.zip
2024-01-10T20:59:22.086    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T20:59:22.086    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T20:59:22.086    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T20:59:22.086    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T20:59:22.086    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T20:59:22.086    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T20:59:22.087    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T20:59:22.087    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980909-110709-503_L1C_038-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/09/SPOT4-HRVIR1-XS_19980909-110659-574_L1C_039-263-0_D_V1-0/SPOT4-HRVIR1-XS_19980909-110659-574_L1C_039-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980909-110659-574_L1C_039-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980909-110659-574_L1C_039-263-0_D_V1-0.zip
run script
2024-01-10T21:01:09.370    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T21:01:09.371    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980909-110659-574_L1C_039-263-0_D_V1-0.zip
2024-01-10T21:01:09.371    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:01:09.371    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:01:09.371    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T21:01:09.371    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:01:09.371    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:01:09.371    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:01:09.371    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:01:09.371    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T21:01:12.530    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (586 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980909-110659-574_L1C_039-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1998/09/09/SPOT4-HRVIR1-XS_19980909-110707-939_L1C_039-264-0_D_V1-0/SPOT4-HRVIR1-XS_19980909-110707-939_L1C_039-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980909-110707-939_L1C_039-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980909-110707-939_L1C_039-264-0_D_V1-0.zip
run script
2024-01-10T21:01:15.786    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T21:01:15.786    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980909-110707-939_L1C_039-264-0_D_V1-0.zip
2024-01-10T21:01:15.786    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:01:15.786    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:01:15.786    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T21:01:15.786    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:01:15.786    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:01:15.786    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:01:15.786    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:01:15.786    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980909-110707-939_L1C_039-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/09/SPOT4-HRVIR1-XS_19980909-110709-744_L1C_039-264-2_D_V1-0/SPOT4-HRVIR1-XS_19980909-110709-744_L1C_039-264-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980909-110709-744_L1C_039-264-2_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980909-110709-744_L1C_039-264-2_D_V1-0.zip
run script
2024-01-10T21:03:04.682    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T21:03:04.682    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980909-110709-744_L1C_039-264-2_D_V1-0.zip
2024-01-10T21:03:04.682    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:03:04.682    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:03:04.682    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T21:03:04.682    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:03:04.682    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:03:04.682    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:03:04.683    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:03:04.683    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980909-110709-744_L1C_039-264-2_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/22/SPOT4-HRVIR1-XS_19980622-112601-240_L1C_038-263-0_D_V1-0/SPOT4-HRVIR1-XS_19980622-112601-240_L1C_038-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980622-112601-240_L1C_038-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980622-112601-240_L1C_038-263-0_D_V1-0.zip
run script
2024-01-10T21:04:44.589    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T21:04:44.590    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980622-112601-240_L1C_038-263-0_D_V1-0.zip
2024-01-10T21:04:44.590    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:04:44.590    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:04:44.590    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T21:04:44.590    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:04:44.590    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:04:44.590    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:04:44.590    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:04:44.590    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980622-112601-240_L1C_038-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/19/SPOT4-HRVIR2-XS_19980719-110656-445_L1C_038-263-0_D_V1-0/SPOT4-HRVIR2-XS_19980719-110656-445_L1C_038-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980719-110656-445_L1C_038-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980719-110656-445_L1C_038-263-0_D_V1-0.zip
run script
2024-01-10T21:06:25.984    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T21:06:25.985    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980719-110656-445_L1C_038-263-0_D_V1-0.zip
2024-01-10T21:06:25.985    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:06:25.985    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:06:25.985    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T21:06:25.985    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:06:25.985    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:06:25.985    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:06:25.985    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:06:25.985    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980719-110656-445_L1C_038-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/19/SPOT4-HRVIR2-XS_19980719-110658-250_L1C_038-263-2_D_V1-0/SPOT4-HRVIR2-XS_19980719-110658-250_L1C_038-263-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980719-110658-250_L1C_038-263-2_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980719-110658-250_L1C_038-263-2_D_V1-0.zip
run script
2024-01-10T21:07:43.453    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T21:07:43.455    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980719-110658-250_L1C_038-263-2_D_V1-0.zip
2024-01-10T21:07:43.455    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:07:43.455    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:07:43.455    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T21:07:43.455    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:07:43.455    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:07:43.455    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:07:43.455    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:07:43.455    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980719-110658-250_L1C_038-263-2_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/19/SPOT4-HRVIR1-XS_19980719-110649-160_L1C_043-263-0_D_V1-0/SPOT4-HRVIR1-XS_19980719-110649-160_L1C_043-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980719-110649-160_L1C_043-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980719-110649-160_L1C_043-263-0_D_V1-0.zip
run script
2024-01-10T21:09:11.702    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T21:09:11.702    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980719-110649-160_L1C_043-263-0_D_V1-0.zip
2024-01-10T21:09:11.702    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:09:11.702    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:09:11.702    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T21:09:11.702    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:09:11.702    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:09:11.702    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:09:11.702    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:09:11.703    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980719-110649-160_L1C_043-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/19/SPOT4-HRVIR1-XS_19980719-110657-573_L1C_043-264-0_D_V1-0/SPOT4-HRVIR1-XS_19980719-110657-573_L1C_043-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980719-110657-573_L1C_043-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980719-110657-573_L1C_043-264-0_D_V1-0.zip
run script
2024-01-10T21:10:39.459    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T21:10:39.461    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980719-110657-573_L1C_043-264-0_D_V1-0.zip
2024-01-10T21:10:39.461    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:10:39.461    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:10:39.461    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T21:10:39.461    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:10:39.461    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:10:39.461    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:10:39.461    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:10:39.461    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980719-110657-573_L1C_043-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/08/SPOT4-HRVIR1-XS_19980808-112228-076_L1C_038-263-4_D_V1-0/SPOT4-HRVIR1-XS_19980808-112228-076_L1C_038-263-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980808-112228-076_L1C_038-263-4_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980808-112228-076_L1C_038-263-4_D_V1-0.zip
run script
2024-01-10T21:12:38.914    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T21:12:38.916    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980808-112228-076_L1C_038-263-4_D_V1-0.zip
2024-01-10T21:12:38.916    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:12:38.916    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:12:38.916    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T21:12:38.916    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:12:38.916    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:12:38.916    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:12:38.916    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:12:38.916    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980808-112228-076_L1C_038-263-4_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/08/SPOT4-HRVIR1-XS_19980808-112232-925_L1C_038-264-0_D_V1-0/SPOT4-HRVIR1-XS_19980808-112232-925_L1C_038-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980808-112232-925_L1C_038-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980808-112232-925_L1C_038-264-0_D_V1-0.zip
run script
2024-01-10T21:14:50.202    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T21:14:50.202    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980808-112232-925_L1C_038-264-0_D_V1-0.zip
2024-01-10T21:14:50.202    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:14:50.202    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:14:50.202    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T21:14:50.202    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:14:50.202    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:14:50.203    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:14:50.203    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:14:50.203    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980808-112232-925_L1C_038-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/08/SPOT4-HRVIR2-XS_19980808-112228-792_L1C_039-263-7_D_V1-0/SPOT4-HRVIR2-XS_19980808-112228-792_L1C_039-263-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980808-112228-792_L1C_039-263-7_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980808-112228-792_L1C_039-263-7_D_V1-0.zip
run script
2024-01-10T21:17:05.547    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T21:17:05.548    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980808-112228-792_L1C_039-263-7_D_V1-0.zip
2024-01-10T21:17:05.548    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:17:05.548    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:17:05.548    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T21:17:05.548    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:17:05.548    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:17:05.548    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:17:05.548    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:17:05.548    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980808-112228-792_L1C_039-263-7_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/08/SPOT4-HRVIR2-XS_19980808-112230-958_L1C_039-264-0_D_V1-0/SPOT4-HRVIR2-XS_19980808-112230-958_L1C_039-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980808-112230-958_L1C_039-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980808-112230-958_L1C_039-264-0_D_V1-0.zip
run script
2024-01-10T21:19:33.721    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T21:19:33.722    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980808-112230-958_L1C_039-264-0_D_V1-0.zip
2024-01-10T21:19:33.723    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:19:33.723    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:19:33.723    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T21:19:33.723    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:19:33.723    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:19:33.723    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:19:33.723    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:19:33.723    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980808-112230-958_L1C_039-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/14/SPOT4-HRVIR2-XS_19980814-110705-509_L1C_038-263-7_D_V1-0/SPOT4-HRVIR2-XS_19980814-110705-509_L1C_038-263-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980814-110705-509_L1C_038-263-7_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980814-110705-509_L1C_038-263-7_D_V1-0.zip
run script
2024-01-10T21:21:53.594    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T21:21:53.595    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980814-110705-509_L1C_038-263-7_D_V1-0.zip
2024-01-10T21:21:53.595    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:21:53.595    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:21:53.595    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T21:21:53.595    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:21:53.595    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:21:53.596    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:21:53.596    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:21:53.596    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980814-110705-509_L1C_038-263-7_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/14/SPOT4-HRVIR2-XS_19980814-110707-546_L1C_038-264-0_D_V1-0/SPOT4-HRVIR2-XS_19980814-110707-546_L1C_038-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980814-110707-546_L1C_038-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980814-110707-546_L1C_038-264-0_D_V1-0.zip
run script
2024-01-10T21:23:38.956    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T21:23:38.956    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980814-110707-546_L1C_038-264-0_D_V1-0.zip
2024-01-10T21:23:38.956    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:23:38.956    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:23:38.956    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T21:23:38.956    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:23:38.956    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:23:38.957    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:23:38.957    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:23:38.957    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980814-110707-546_L1C_038-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/14/SPOT4-HRVIR1-XS_19980814-110655-783_L1C_041-263-0_D_V1-0/SPOT4-HRVIR1-XS_19980814-110655-783_L1C_041-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980814-110655-783_L1C_041-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980814-110655-783_L1C_041-263-0_D_V1-0.zip
run script
2024-01-10T21:25:21.823    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T21:25:21.824    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980814-110655-783_L1C_041-263-0_D_V1-0.zip
2024-01-10T21:25:21.824    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:25:21.824    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:25:21.824    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T21:25:21.824    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:25:21.824    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:25:21.825    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:25:21.825    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:25:21.825    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980814-110655-783_L1C_041-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/14/SPOT4-HRVIR1-XS_19980814-110704-166_L1C_041-264-0_D_V1-0/SPOT4-HRVIR1-XS_19980814-110704-166_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980814-110704-166_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980814-110704-166_L1C_041-264-0_D_V1-0.zip
run script
2024-01-10T21:26:45.206    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T21:26:45.207    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980814-110704-166_L1C_041-264-0_D_V1-0.zip
2024-01-10T21:26:45.207    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:26:45.207    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:26:45.208    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T21:26:45.208    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:26:45.208    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:26:45.208    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:26:45.208    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:26:45.208    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980814-110704-166_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/14/SPOT4-HRVIR1-XS_19980814-110707-776_L1C_041-264-4_D_V1-0/SPOT4-HRVIR1-XS_19980814-110707-776_L1C_041-264-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980814-110707-776_L1C_041-264-4_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980814-110707-776_L1C_041-264-4_D_V1-0.zip
run script
2024-01-10T21:28:46.712    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T21:28:46.713    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980814-110707-776_L1C_041-264-4_D_V1-0.zip
2024-01-10T21:28:46.713    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:28:46.713    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:28:46.713    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T21:28:46.713    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:28:46.713    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:28:46.713    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:28:46.713    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:28:46.713    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980814-110707-776_L1C_041-264-4_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/20/SPOT4-HRVIR1-XS_19980820-105134-646_L1C_038-263-4_D_V1-0/SPOT4-HRVIR1-XS_19980820-105134-646_L1C_038-263-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980820-105134-646_L1C_038-263-4_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980820-105134-646_L1C_038-263-4_D_V1-0.zip
run script
2024-01-10T21:30:19.917    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T21:30:19.918    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980820-105134-646_L1C_038-263-4_D_V1-0.zip
2024-01-10T21:30:19.918    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:30:19.918    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:30:19.918    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T21:30:19.918    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:30:19.918    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:30:19.918    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:30:19.918    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:30:19.918    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980820-105134-646_L1C_038-263-4_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/20/SPOT4-HRVIR1-XS_19980820-105139-326_L1C_038-264-0_D_V1-0/SPOT4-HRVIR1-XS_19980820-105139-326_L1C_038-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980820-105139-326_L1C_038-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980820-105139-326_L1C_038-264-0_D_V1-0.zip
run script
2024-01-10T21:32:09.709    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T21:32:09.710    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980820-105139-326_L1C_038-264-0_D_V1-0.zip
2024-01-10T21:32:09.710    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:32:09.710    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:32:09.710    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T21:32:09.710    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:32:09.710    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:32:09.710    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:32:09.710    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:32:09.710    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980820-105139-326_L1C_038-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/20/SPOT4-HRVIR2-XS_19980820-105134-643_L1C_041-263-7_D_V1-0/SPOT4-HRVIR2-XS_19980820-105134-643_L1C_041-263-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980820-105134-643_L1C_041-263-7_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980820-105134-643_L1C_041-263-7_D_V1-0.zip
run script
2024-01-10T21:33:58.876    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T21:33:58.877    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980820-105134-643_L1C_041-263-7_D_V1-0.zip
2024-01-10T21:33:58.877    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:33:58.877    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:33:58.877    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T21:33:58.877    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:33:58.877    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:33:58.878    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:33:58.878    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:33:58.878    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980820-105134-643_L1C_041-263-7_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/20/SPOT4-HRVIR2-XS_19980820-105136-634_L1C_041-264-0_D_V1-0/SPOT4-HRVIR2-XS_19980820-105136-634_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980820-105136-634_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980820-105136-634_L1C_041-264-0_D_V1-0.zip
run script
2024-01-10T21:35:53.714    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T21:35:53.714    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980820-105136-634_L1C_041-264-0_D_V1-0.zip
2024-01-10T21:35:53.714    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:35:53.714    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:35:53.714    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T21:35:53.714    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:35:53.714    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:35:53.714    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:35:53.714    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:35:53.715    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980820-105136-634_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/20/SPOT4-HRVIR2-XS_19980820-105139-341_L1C_041-264-3_D_V1-0/SPOT4-HRVIR2-XS_19980820-105139-341_L1C_041-264-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980820-105139-341_L1C_041-264-3_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980820-105139-341_L1C_041-264-3_D_V1-0.zip
run script
2024-01-10T21:37:48.692    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T21:37:48.693    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980820-105139-341_L1C_041-264-3_D_V1-0.zip
2024-01-10T21:37:48.693    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:37:48.694    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:37:48.694    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T21:37:48.694    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:37:48.694    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:37:48.694    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:37:48.694    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:37:48.694    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980820-105139-341_L1C_041-264-3_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/25/SPOT4-HRVIR1-XS_19980825-105525-942_L1C_038-263-4_D_V1-0/SPOT4-HRVIR1-XS_19980825-105525-942_L1C_038-263-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980825-105525-942_L1C_038-263-4_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980825-105525-942_L1C_038-263-4_D_V1-0.zip
run script
2024-01-10T21:39:30.012    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T21:39:30.013    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980825-105525-942_L1C_038-263-4_D_V1-0.zip
2024-01-10T21:39:30.013    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:39:30.013    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:39:30.013    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T21:39:30.013    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:39:30.014    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:39:30.014    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:39:30.014    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:39:30.014    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980825-105525-942_L1C_038-263-4_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/25/SPOT4-HRVIR1-XS_19980825-105530-634_L1C_038-264-0_D_V1-0/SPOT4-HRVIR1-XS_19980825-105530-634_L1C_038-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980825-105530-634_L1C_038-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980825-105530-634_L1C_038-264-0_D_V1-0.zip
run script
2024-01-10T21:41:17.950    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T21:41:17.950    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980825-105530-634_L1C_038-264-0_D_V1-0.zip
2024-01-10T21:41:17.950    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:41:17.950    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:41:17.950    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T21:41:17.950    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:41:17.950    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:41:17.950    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:41:17.950    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:41:17.950    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980825-105530-634_L1C_038-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/25/SPOT4-HRVIR2-XS_19980825-105525-900_L1C_041-263-7_D_V1-0/SPOT4-HRVIR2-XS_19980825-105525-900_L1C_041-263-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980825-105525-900_L1C_041-263-7_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980825-105525-900_L1C_041-263-7_D_V1-0.zip
run script
2024-01-10T21:43:03.559    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T21:43:03.560    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980825-105525-900_L1C_041-263-7_D_V1-0.zip
2024-01-10T21:43:03.560    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:43:03.560    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:43:03.560    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T21:43:03.560    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:43:03.560    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:43:03.560    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:43:03.560    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:43:03.560    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980825-105525-900_L1C_041-263-7_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/25/SPOT4-HRVIR2-XS_19980825-105527-906_L1C_041-264-0_D_V1-0/SPOT4-HRVIR2-XS_19980825-105527-906_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980825-105527-906_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980825-105527-906_L1C_041-264-0_D_V1-0.zip
run script
2024-01-10T21:45:07.194    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T21:45:07.195    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980825-105527-906_L1C_041-264-0_D_V1-0.zip
2024-01-10T21:45:07.195    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:45:07.195    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:45:07.195    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T21:45:07.195    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:45:07.195    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:45:07.195    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:45:07.195    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:45:07.195    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980825-105527-906_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/25/SPOT4-HRVIR2-XS_19980825-105530-613_L1C_041-264-3_D_V1-0/SPOT4-HRVIR2-XS_19980825-105530-613_L1C_041-264-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980825-105530-613_L1C_041-264-3_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980825-105530-613_L1C_041-264-3_D_V1-0.zip
run script
2024-01-10T21:47:05.638    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T21:47:05.639    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980825-105530-613_L1C_041-264-3_D_V1-0.zip
2024-01-10T21:47:05.639    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:47:05.639    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:47:05.639    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T21:47:05.639    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:47:05.639    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:47:05.639    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:47:05.639    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:47:05.639    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980825-105530-613_L1C_041-264-3_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/29/SPOT4-HRVIR2-XS_19980829-111834-894_L1C_038-263-4_D_V1-0/SPOT4-HRVIR2-XS_19980829-111834-894_L1C_038-263-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980829-111834-894_L1C_038-263-4_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980829-111834-894_L1C_038-263-4_D_V1-0.zip
run script
2024-01-10T21:48:47.700    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T21:48:47.701    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980829-111834-894_L1C_038-263-4_D_V1-0.zip
2024-01-10T21:48:47.701    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:48:47.701    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:48:47.701    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T21:48:47.701    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:48:47.701    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:48:47.702    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:48:47.702    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:48:47.702    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980829-111834-894_L1C_038-263-4_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/29/SPOT4-HRVIR2-XS_19980829-111839-713_L1C_038-264-0_D_V1-0/SPOT4-HRVIR2-XS_19980829-111839-713_L1C_038-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980829-111839-713_L1C_038-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980829-111839-713_L1C_038-264-0_D_V1-0.zip
run script
2024-01-10T21:50:52.491    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T21:50:52.492    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980829-111839-713_L1C_038-264-0_D_V1-0.zip
2024-01-10T21:50:52.492    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:50:52.492    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:50:52.492    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T21:50:52.492    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:50:52.492    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:50:52.492    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:50:52.492    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:50:52.492    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980829-111839-713_L1C_038-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/29/SPOT4-HRVIR1-XS_19980829-111835-258_L1C_041-263-9_D_V1-0/SPOT4-HRVIR1-XS_19980829-111835-258_L1C_041-263-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980829-111835-258_L1C_041-263-9_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980829-111835-258_L1C_041-263-9_D_V1-0.zip
run script
2024-01-10T21:52:55.091    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T21:52:55.091    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980829-111835-258_L1C_041-263-9_D_V1-0.zip
2024-01-10T21:52:55.091    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:52:55.091    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:52:55.091    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T21:52:55.091    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:52:55.091    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:52:55.091    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:52:55.091    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:52:55.091    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980829-111835-258_L1C_041-263-9_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/29/SPOT4-HRVIR1-XS_19980829-111835-604_L1C_041-264-0_D_V1-0/SPOT4-HRVIR1-XS_19980829-111835-604_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980829-111835-604_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980829-111835-604_L1C_041-264-0_D_V1-0.zip
run script
2024-01-10T21:55:21.701    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T21:55:21.702    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980829-111835-604_L1C_041-264-0_D_V1-0.zip
2024-01-10T21:55:21.702    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:55:21.702    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:55:21.702    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T21:55:21.702    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:55:21.702    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:55:21.703    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:55:21.703    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:55:21.703    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980829-111835-604_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/29/SPOT4-HRVIR1-XS_19980829-111840-116_L1C_041-264-5_D_V1-0/SPOT4-HRVIR1-XS_19980829-111840-116_L1C_041-264-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980829-111840-116_L1C_041-264-5_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980829-111840-116_L1C_041-264-5_D_V1-0.zip
run script
2024-01-10T21:57:47.797    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T21:57:47.798    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980829-111840-116_L1C_041-264-5_D_V1-0.zip
2024-01-10T21:57:47.798    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:57:47.798    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:57:47.798    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T21:57:47.798    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:57:47.798    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:57:47.798    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:57:47.798    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:57:47.798    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980829-111840-116_L1C_041-264-5_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/30/SPOT4-HRVIR1-XS_19980830-105916-686_L1C_038-263-4_D_V1-0/SPOT4-HRVIR1-XS_19980830-105916-686_L1C_038-263-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980830-105916-686_L1C_038-263-4_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980830-105916-686_L1C_038-263-4_D_V1-0.zip
run script
2024-01-10T21:59:31.138    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T21:59:31.139    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980830-105916-686_L1C_038-263-4_D_V1-0.zip
2024-01-10T21:59:31.140    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T21:59:31.140    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T21:59:31.140    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T21:59:31.140    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T21:59:31.140    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T21:59:31.140    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T21:59:31.140    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T21:59:31.140    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980830-105916-686_L1C_038-263-4_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/30/SPOT4-HRVIR1-XS_19980830-105921-394_L1C_038-264-0_D_V1-0/SPOT4-HRVIR1-XS_19980830-105921-394_L1C_038-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980830-105921-394_L1C_038-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980830-105921-394_L1C_038-264-0_D_V1-0.zip
run script
2024-01-10T22:01:13.807    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:01:13.809    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980830-105921-394_L1C_038-264-0_D_V1-0.zip
2024-01-10T22:01:13.809    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:01:13.809    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:01:13.809    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:01:13.809    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:01:13.809    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:01:13.809    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:01:13.809    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:01:13.810    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980830-105921-394_L1C_038-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/30/SPOT4-HRVIR2-XS_19980830-105917-201_L1C_041-263-8_D_V1-0/SPOT4-HRVIR2-XS_19980830-105917-201_L1C_041-263-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980830-105917-201_L1C_041-263-8_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980830-105917-201_L1C_041-263-8_D_V1-0.zip
run script
2024-01-10T22:02:56.879    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:02:56.879    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980830-105917-201_L1C_041-263-8_D_V1-0.zip
2024-01-10T22:02:56.879    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:02:56.879    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:02:56.879    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:02:56.879    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:02:56.879    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:02:56.880    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:02:56.880    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:02:56.880    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980830-105917-201_L1C_041-263-8_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/30/SPOT4-HRVIR2-XS_19980830-105918-320_L1C_041-264-0_D_V1-0/SPOT4-HRVIR2-XS_19980830-105918-320_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980830-105918-320_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980830-105918-320_L1C_041-264-0_D_V1-0.zip
run script
2024-01-10T22:04:50.711    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:04:50.712    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980830-105918-320_L1C_041-264-0_D_V1-0.zip
2024-01-10T22:04:50.713    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:04:50.713    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:04:50.713    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:04:50.713    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:04:50.713    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:04:50.713    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:04:50.713    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:04:50.713    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980830-105918-320_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/30/SPOT4-HRVIR2-XS_19980830-105921-929_L1C_041-264-4_D_V1-0/SPOT4-HRVIR2-XS_19980830-105921-929_L1C_041-264-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980830-105921-929_L1C_041-264-4_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980830-105921-929_L1C_041-264-4_D_V1-0.zip
run script
2024-01-10T22:06:43.445    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:06:43.446    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980830-105921-929_L1C_041-264-4_D_V1-0.zip
2024-01-10T22:06:43.447    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:06:43.447    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:06:43.447    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:06:43.447    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:06:43.447    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:06:43.447    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:06:43.447    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:06:43.447    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980830-105921-929_L1C_041-264-4_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 0 0 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/03/SPOT4-HRVIR1-XS_19980903-112223-284_L1C_038-263-0_D_V1-0/SPOT4-HRVIR1-XS_19980903-112223-284_L1C_038-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980903-112223-284_L1C_038-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980903-112223-284_L1C_038-263-0_D_V1-0.zip
run script
2024-01-10T22:08:13.074    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:08:13.075    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980903-112223-284_L1C_038-263-0_D_V1-0.zip
2024-01-10T22:08:13.075    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:08:13.075    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:08:13.075    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:08:13.075    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:08:13.076    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:08:13.076    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:08:13.076    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:08:13.076    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980903-112223-284_L1C_038-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/24/SPOT4-HRVIR2-XS_19980624-104722-346_L1C_039-262-7_D_V1-0/SPOT4-HRVIR2-XS_19980624-104722-346_L1C_039-262-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980624-104722-346_L1C_039-262-7_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980624-104722-346_L1C_039-262-7_D_V1-0.zip
run script
2024-01-10T22:09:44.020    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:09:44.021    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980624-104722-346_L1C_039-262-7_D_V1-0.zip
2024-01-10T22:09:44.021    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:09:44.021    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:09:44.021    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:09:44.021    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:09:44.021    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:09:44.021    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:09:44.021    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:09:44.021    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980624-104722-346_L1C_039-262-7_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/24/SPOT4-HRVIR2-XS_19980624-104724-304_L1C_039-263-0_D_V1-0/SPOT4-HRVIR2-XS_19980624-104724-304_L1C_039-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980624-104724-304_L1C_039-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980624-104724-304_L1C_039-263-0_D_V1-0.zip
run script
2024-01-10T22:10:42.933    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:10:42.933    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980624-104724-304_L1C_039-263-0_D_V1-0.zip
2024-01-10T22:10:42.933    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:10:42.933    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:10:42.933    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:10:42.933    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:10:42.933    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:10:42.933    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:10:42.933    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:10:42.933    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980624-104724-304_L1C_039-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/24/SPOT4-HRVIR2-XS_19980624-104732-588_L1C_039-264-0_D_V1-0/SPOT4-HRVIR2-XS_19980624-104732-588_L1C_039-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980624-104732-588_L1C_039-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980624-104732-588_L1C_039-264-0_D_V1-0.zip
run script
2024-01-10T22:12:00.611    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:12:00.612    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980624-104732-588_L1C_039-264-0_D_V1-0.zip
2024-01-10T22:12:00.612    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:12:00.612    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:12:00.613    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:12:00.613    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:12:00.613    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:12:00.613    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:12:00.613    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:12:00.613    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980624-104732-588_L1C_039-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/24/SPOT4-HRVIR1-XS_19980624-104722-926_L1C_041-263-0_D_V1-0/SPOT4-HRVIR1-XS_19980624-104722-926_L1C_041-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980624-104722-926_L1C_041-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980624-104722-926_L1C_041-263-0_D_V1-0.zip
run script
2024-01-10T22:13:53.803    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:13:53.804    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980624-104722-926_L1C_041-263-0_D_V1-0.zip
2024-01-10T22:13:53.804    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:13:53.804    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:13:53.804    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:13:53.804    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:13:53.804    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:13:53.804    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:13:53.804    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:13:53.804    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980624-104722-926_L1C_041-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 0 0]
 [2 2 2 ... 2 2 0]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/24/SPOT4-HRVIR1-XS_19980624-104731-216_L1C_041-264-0_D_V1-0/SPOT4-HRVIR1-XS_19980624-104731-216_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980624-104731-216_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980624-104731-216_L1C_041-264-0_D_V1-0.zip
run script
2024-01-10T22:15:17.221    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:15:17.222    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980624-104731-216_L1C_041-264-0_D_V1-0.zip
2024-01-10T22:15:17.223    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:15:17.223    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:15:17.223    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:15:17.223    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:15:17.223    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:15:17.223    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:15:17.223    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:15:17.223    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980624-104731-216_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/24/SPOT4-HRVIR1-XS_19980624-104732-119_L1C_041-264-1_D_V1-0/SPOT4-HRVIR1-XS_19980624-104732-119_L1C_041-264-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980624-104732-119_L1C_041-264-1_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980624-104732-119_L1C_041-264-1_D_V1-0.zip
run script
2024-01-10T22:17:15.602    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:17:15.603    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980624-104732-119_L1C_041-264-1_D_V1-0.zip
2024-01-10T22:17:15.603    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:17:15.603    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:17:15.603    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:17:15.603    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:17:15.603    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:17:15.603    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:17:15.603    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:17:15.603    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980624-104732-119_L1C_041-264-1_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/15/SPOT4-HRVIR2-XS_19980715-104340-357_L1C_039-262-8_D_V1-0/SPOT4-HRVIR2-XS_19980715-104340-357_L1C_039-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980715-104340-357_L1C_039-262-8_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980715-104340-357_L1C_039-262-8_D_V1-0.zip
run script
2024-01-10T22:19:21.305    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:19:21.305    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980715-104340-357_L1C_039-262-8_D_V1-0.zip
2024-01-10T22:19:21.306    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:19:21.306    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:19:21.306    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:19:21.306    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:19:21.306    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:19:21.306    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:19:21.306    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:19:21.306    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980715-104340-357_L1C_039-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/15/SPOT4-HRVIR2-XS_19980715-104341-407_L1C_039-263-0_D_V1-0/SPOT4-HRVIR2-XS_19980715-104341-407_L1C_039-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980715-104341-407_L1C_039-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980715-104341-407_L1C_039-263-0_D_V1-0.zip
run script
2024-01-10T22:20:35.006    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:20:35.007    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980715-104341-407_L1C_039-263-0_D_V1-0.zip
2024-01-10T22:20:35.007    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:20:35.007    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:20:35.007    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:20:35.007    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:20:35.007    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:20:35.007    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:20:35.007    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:20:35.007    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980715-104341-407_L1C_039-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/15/SPOT4-HRVIR2-XS_19980715-104349-682_L1C_039-264-0_D_V1-0/SPOT4-HRVIR2-XS_19980715-104349-682_L1C_039-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980715-104349-682_L1C_039-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980715-104349-682_L1C_039-264-0_D_V1-0.zip
run script
2024-01-10T22:21:59.255    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:21:59.256    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980715-104349-682_L1C_039-264-0_D_V1-0.zip
2024-01-10T22:21:59.256    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:21:59.256    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:21:59.256    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:21:59.256    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:21:59.256    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:21:59.257    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:21:59.257    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:21:59.257    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980715-104349-682_L1C_039-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/15/SPOT4-HRVIR1-XS_19980715-104342-981_L1C_041-263-3_D_V1-0/SPOT4-HRVIR1-XS_19980715-104342-981_L1C_041-263-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980715-104342-981_L1C_041-263-3_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980715-104342-981_L1C_041-263-3_D_V1-0.zip
run script
2024-01-10T22:24:01.510    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:24:01.512    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980715-104342-981_L1C_041-263-3_D_V1-0.zip
2024-01-10T22:24:01.512    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:24:01.512    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:24:01.512    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:24:01.512    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:24:01.512    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:24:01.512    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:24:01.512    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:24:01.512    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980715-104342-981_L1C_041-263-3_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 2]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/15/SPOT4-HRVIR1-XS_19980715-104348-555_L1C_041-264-0_D_V1-0/SPOT4-HRVIR1-XS_19980715-104348-555_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980715-104348-555_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980715-104348-555_L1C_041-264-0_D_V1-0.zip
run script
2024-01-10T22:26:01.015    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:26:01.016    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980715-104348-555_L1C_041-264-0_D_V1-0.zip
2024-01-10T22:26:01.016    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:26:01.016    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:26:01.016    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:26:01.016    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:26:01.016    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:26:01.016    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:26:01.016    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:26:01.017    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980715-104348-555_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/25/SPOT4-HRVIR2-XS_19980925-105921-471_L1C_039-262-8_D_V1-0/SPOT4-HRVIR2-XS_19980925-105921-471_L1C_039-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980925-105921-471_L1C_039-262-8_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980925-105921-471_L1C_039-262-8_D_V1-0.zip
run script
2024-01-10T22:28:09.387    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:28:09.387    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980925-105921-471_L1C_039-262-8_D_V1-0.zip
2024-01-10T22:28:09.387    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:28:09.387    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:28:09.387    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:28:09.387    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:28:09.387    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:28:09.388    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:28:09.388    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:28:09.388    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T22:28:11.602    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (129 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980925-105921-471_L1C_039-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1998/09/25/SPOT4-HRVIR2-XS_19980925-105922-572_L1C_039-263-0_D_V1-0/SPOT4-HRVIR2-XS_19980925-105922-572_L1C_039-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980925-105922-572_L1C_039-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980925-105922-572_L1C_039-263-0_D_V1-0.zip
run script
2024-01-10T22:28:14.717    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:28:14.717    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980925-105922-572_L1C_039-263-0_D_V1-0.zip
2024-01-10T22:28:14.717    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:28:14.717    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:28:14.717    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:28:14.717    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:28:14.718    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:28:14.718    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:28:14.718    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:28:14.718    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T22:28:17.672    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (582 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980925-105922-572_L1C_039-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1998/09/25/SPOT4-HRVIR1-XS_19980925-105927-151_L1C_041-263-7_D_V1-0/SPOT4-HRVIR1-XS_19980925-105927-151_L1C_041-263-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980925-105927-151_L1C_041-263-7_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980925-105927-151_L1C_041-263-7_D_V1-0.zip
run script
2024-01-10T22:28:20.483    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:28:20.484    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980925-105927-151_L1C_041-263-7_D_V1-0.zip
2024-01-10T22:28:20.484    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:28:20.484    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:28:20.484    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:28:20.484    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:28:20.484    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:28:20.484    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:28:20.484    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:28:20.484    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980925-105927-151_L1C_041-263-7_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/25/SPOT4-HRVIR1-XS_19980925-105929-172_L1C_041-264-0_D_V1-0/SPOT4-HRVIR1-XS_19980925-105929-172_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980925-105929-172_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980925-105929-172_L1C_041-264-0_D_V1-0.zip
run script
2024-01-10T22:30:17.361    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:30:17.362    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980925-105929-172_L1C_041-264-0_D_V1-0.zip
2024-01-10T22:30:17.362    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:30:17.362    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:30:17.362    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:30:17.362    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:30:17.362    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:30:17.362    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:30:17.362    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:30:17.362    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980925-105929-172_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/04/21/SPOT4-HRVIR2-XS_19980421-111758-278_L1C_039-263-6_D_V1-0/SPOT4-HRVIR2-XS_19980421-111758-278_L1C_039-263-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980421-111758-278_L1C_039-263-6_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980421-111758-278_L1C_039-263-6_D_V1-0.zip
run script
2024-01-10T22:32:12.342    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:32:12.342    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980421-111758-278_L1C_039-263-6_D_V1-0.zip
2024-01-10T22:32:12.343    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:32:12.343    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:32:12.343    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:32:12.343    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:32:12.343    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:32:12.343    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:32:12.343    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:32:12.343    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980421-111758-278_L1C_039-263-6_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/04/21/SPOT4-HRVIR2-XS_19980421-111801-316_L1C_039-264-0_D_V1-0/SPOT4-HRVIR2-XS_19980421-111801-316_L1C_039-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980421-111801-316_L1C_039-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980421-111801-316_L1C_039-264-0_D_V1-0.zip
run script
2024-01-10T22:34:24.386    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:34:24.386    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980421-111801-316_L1C_039-264-0_D_V1-0.zip
2024-01-10T22:34:24.386    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:34:24.386    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:34:24.386    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:34:24.386    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:34:24.386    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:34:24.386    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:34:24.386    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:34:24.387    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980421-111801-316_L1C_039-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/04/21/SPOT4-HRVIR2-XS_19980421-111802-219_L1C_039-264-1_D_V1-0/SPOT4-HRVIR2-XS_19980421-111802-219_L1C_039-264-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980421-111802-219_L1C_039-264-1_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980421-111802-219_L1C_039-264-1_D_V1-0.zip
run script
2024-01-10T22:36:33.188    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:36:33.190    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980421-111802-219_L1C_039-264-1_D_V1-0.zip
2024-01-10T22:36:33.190    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:36:33.190    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:36:33.190    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:36:33.190    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:36:33.190    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:36:33.190    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:36:33.190    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:36:33.190    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980421-111802-219_L1C_039-264-1_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/04/21/SPOT4-HRVIR1-XS_19980421-111758-230_L1C_041-263-8_D_V1-0/SPOT4-HRVIR1-XS_19980421-111758-230_L1C_041-263-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980421-111758-230_L1C_041-263-8_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980421-111758-230_L1C_041-263-8_D_V1-0.zip
run script
2024-01-10T22:38:44.553    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:38:44.554    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980421-111758-230_L1C_041-263-8_D_V1-0.zip
2024-01-10T22:38:44.554    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:38:44.555    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:38:44.555    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:38:44.555    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:38:44.555    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:38:44.555    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:38:44.555    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:38:44.555    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980421-111758-230_L1C_041-263-8_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/04/21/SPOT4-HRVIR1-XS_19980421-111759-478_L1C_041-264-0_D_V1-0/SPOT4-HRVIR1-XS_19980421-111759-478_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980421-111759-478_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980421-111759-478_L1C_041-264-0_D_V1-0.zip
run script
2024-01-10T22:41:14.787    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:41:14.789    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980421-111759-478_L1C_041-264-0_D_V1-0.zip
2024-01-10T22:41:14.789    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:41:14.789    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:41:14.789    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:41:14.789    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:41:14.789    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:41:14.789    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:41:14.789    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:41:14.789    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980421-111759-478_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/04/21/SPOT4-HRVIR1-XS_19980421-111802-186_L1C_041-264-3_D_V1-0/SPOT4-HRVIR1-XS_19980421-111802-186_L1C_041-264-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980421-111802-186_L1C_041-264-3_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980421-111802-186_L1C_041-264-3_D_V1-0.zip
run script
2024-01-10T22:43:43.386    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:43:43.387    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980421-111802-186_L1C_041-264-3_D_V1-0.zip
2024-01-10T22:43:43.387    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:43:43.387    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:43:43.387    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:43:43.387    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:43:43.387    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:43:43.387    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:43:43.387    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:43:43.387    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980421-111802-186_L1C_041-264-3_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/10/SPOT4-HRVIR2-XS_19980810-104352-305_L1C_039-263-7_D_V1-0/SPOT4-HRVIR2-XS_19980810-104352-305_L1C_039-263-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980810-104352-305_L1C_039-263-7_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980810-104352-305_L1C_039-263-7_D_V1-0.zip
run script
2024-01-10T22:45:46.125    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:45:46.126    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980810-104352-305_L1C_039-263-7_D_V1-0.zip
2024-01-10T22:45:46.126    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:45:46.126    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:45:46.126    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:45:46.126    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:45:46.126    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:45:46.127    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:45:46.127    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:45:46.127    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980810-104352-305_L1C_039-263-7_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/10/SPOT4-HRVIR2-XS_19980810-104354-263_L1C_039-264-0_D_V1-0/SPOT4-HRVIR2-XS_19980810-104354-263_L1C_039-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980810-104354-263_L1C_039-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980810-104354-263_L1C_039-264-0_D_V1-0.zip
run script
2024-01-10T22:47:49.824    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:47:49.824    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980810-104354-263_L1C_039-264-0_D_V1-0.zip
2024-01-10T22:47:49.824    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:47:49.824    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:47:49.824    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:47:49.824    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:47:49.824    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:47:49.824    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:47:49.824    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:47:49.825    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980810-104354-263_L1C_039-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/10/SPOT4-HRVIR1-XS_19980810-104352-726_L1C_041-263-9_D_V1-0/SPOT4-HRVIR1-XS_19980810-104352-726_L1C_041-263-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980810-104352-726_L1C_041-263-9_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980810-104352-726_L1C_041-263-9_D_V1-0.zip
run script
2024-01-10T22:49:51.064    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:49:51.065    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980810-104352-726_L1C_041-263-9_D_V1-0.zip
2024-01-10T22:49:51.065    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:49:51.065    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:49:51.065    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:49:51.066    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:49:51.066    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:49:51.066    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:49:51.066    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:49:51.066    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980810-104352-726_L1C_041-263-9_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/10/SPOT4-HRVIR1-XS_19980810-104352-888_L1C_041-264-0_D_V1-0/SPOT4-HRVIR1-XS_19980810-104352-888_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980810-104352-888_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980810-104352-888_L1C_041-264-0_D_V1-0.zip
run script
2024-01-10T22:51:57.671    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:51:57.672    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980810-104352-888_L1C_041-264-0_D_V1-0.zip
2024-01-10T22:51:57.672    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:51:57.672    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:51:57.672    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:51:57.672    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:51:57.672    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:51:57.672    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:51:57.672    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:51:57.672    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980810-104352-888_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/30/SPOT4-HRVIR2-XS_19980930-110315-139_L1C_039-263-0_D_V1-0/SPOT4-HRVIR2-XS_19980930-110315-139_L1C_039-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980930-110315-139_L1C_039-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980930-110315-139_L1C_039-263-0_D_V1-0.zip
run script
2024-01-10T22:54:03.430    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:54:03.431    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980930-110315-139_L1C_039-263-0_D_V1-0.zip
2024-01-10T22:54:03.431    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:54:03.431    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:54:03.432    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:54:03.432    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:54:03.432    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:54:03.432    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:54:03.432    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:54:03.432    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T22:54:05.820    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (153 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980930-110315-139_L1C_039-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1998/09/30/SPOT4-HRVIR2-XS_19980930-110322-359_L1C_039-263-8_D_V1-0/SPOT4-HRVIR2-XS_19980930-110322-359_L1C_039-263-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980930-110322-359_L1C_039-263-8_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980930-110322-359_L1C_039-263-8_D_V1-0.zip
run script
2024-01-10T22:54:09.325    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:54:09.326    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980930-110322-359_L1C_039-263-8_D_V1-0.zip
2024-01-10T22:54:09.326    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:54:09.326    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:54:09.326    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:54:09.326    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:54:09.326    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:54:09.326    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:54:09.326    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:54:09.326    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980930-110322-359_L1C_039-263-8_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/10/11/SPOT4-HRVIR1-XS_19981011-105139-676_L1C_039-263-0_D_V1-0/SPOT4-HRVIR1-XS_19981011-105139-676_L1C_039-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19981011-105139-676_L1C_039-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981011-105139-676_L1C_039-263-0_D_V1-0.zip
run script
2024-01-10T22:55:54.228    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:55:54.229    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981011-105139-676_L1C_039-263-0_D_V1-0.zip
2024-01-10T22:55:54.229    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:55:54.229    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:55:54.229    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:55:54.229    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:55:54.229    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:55:54.229    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:55:54.230    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:55:54.230    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T22:55:56.266    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (304 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981011-105139-676_L1C_039-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1998/10/11/SPOT4-HRVIR1-XS_19981011-105145-993_L1C_039-263-7_D_V1-0/SPOT4-HRVIR1-XS_19981011-105145-993_L1C_039-263-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19981011-105145-993_L1C_039-263-7_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981011-105145-993_L1C_039-263-7_D_V1-0.zip
run script
2024-01-10T22:55:59.365    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:55:59.365    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981011-105145-993_L1C_039-263-7_D_V1-0.zip
2024-01-10T22:55:59.365    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:55:59.365    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:55:59.365    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:55:59.365    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:55:59.365    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:55:59.365    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:55:59.366    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:55:59.366    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981011-105145-993_L1C_039-263-7_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/10/11/SPOT4-HRVIR2-XS_19981011-105143-657_L1C_041-263-6_D_V1-0/SPOT4-HRVIR2-XS_19981011-105143-657_L1C_041-263-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19981011-105143-657_L1C_041-263-6_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981011-105143-657_L1C_041-263-6_D_V1-0.zip
run script
2024-01-10T22:57:45.904    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:57:45.905    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981011-105143-657_L1C_041-263-6_D_V1-0.zip
2024-01-10T22:57:45.905    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:57:45.905    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:57:45.906    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:57:45.906    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:57:45.906    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:57:45.906    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:57:45.906    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:57:45.906    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981011-105143-657_L1C_041-263-6_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/10/11/SPOT4-HRVIR2-XS_19981011-105146-548_L1C_041-264-0_D_V1-0/SPOT4-HRVIR2-XS_19981011-105146-548_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19981011-105146-548_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981011-105146-548_L1C_041-264-0_D_V1-0.zip
run script
2024-01-10T22:59:44.003    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T22:59:44.004    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981011-105146-548_L1C_041-264-0_D_V1-0.zip
2024-01-10T22:59:44.004    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T22:59:44.004    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T22:59:44.004    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T22:59:44.004    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T22:59:44.004    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T22:59:44.004    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T22:59:44.004    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T22:59:44.004    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981011-105146-548_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/10/11/SPOT4-HRVIR2-XS_19981011-105150-158_L1C_041-264-4_D_V1-0/SPOT4-HRVIR2-XS_19981011-105150-158_L1C_041-264-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19981011-105150-158_L1C_041-264-4_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981011-105150-158_L1C_041-264-4_D_V1-0.zip
run script
2024-01-10T23:01:38.820    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T23:01:38.821    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981011-105150-158_L1C_041-264-4_D_V1-0.zip
2024-01-10T23:01:38.821    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:01:38.821    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:01:38.821    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T23:01:38.821    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:01:38.821    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:01:38.821    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:01:38.822    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:01:38.822    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981011-105150-158_L1C_041-264-4_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/26/SPOT4-HRVIR2-XS_19980926-103956-166_L1C_041-262-4_D_V1-0/SPOT4-HRVIR2-XS_19980926-103956-166_L1C_041-262-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980926-103956-166_L1C_041-262-4_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980926-103956-166_L1C_041-262-4_D_V1-0.zip
run script
2024-01-10T23:03:10.381    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T23:03:10.381    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980926-103956-166_L1C_041-262-4_D_V1-0.zip
2024-01-10T23:03:10.381    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:03:10.381    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:03:10.381    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T23:03:10.381    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:03:10.381    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:03:10.381    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:03:10.381    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:03:10.381    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980926-103956-166_L1C_041-262-4_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/26/SPOT4-HRVIR2-XS_19980926-104000-823_L1C_041-263-0_D_V1-0/SPOT4-HRVIR2-XS_19980926-104000-823_L1C_041-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980926-104000-823_L1C_041-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980926-104000-823_L1C_041-263-0_D_V1-0.zip
run script
2024-01-10T23:03:48.404    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T23:03:48.405    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980926-104000-823_L1C_041-263-0_D_V1-0.zip
2024-01-10T23:03:48.406    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:03:48.406    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:03:48.406    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T23:03:48.406    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:03:48.406    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:03:48.406    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:03:48.406    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:03:48.406    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980926-104000-823_L1C_041-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/26/SPOT4-HRVIR2-XS_19980926-104009-095_L1C_041-264-0_D_V1-0/SPOT4-HRVIR2-XS_19980926-104009-095_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980926-104009-095_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980926-104009-095_L1C_041-264-0_D_V1-0.zip
run script
2024-01-10T23:05:19.204    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T23:05:19.204    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980926-104009-095_L1C_041-264-0_D_V1-0.zip
2024-01-10T23:05:19.205    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:05:19.205    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:05:19.205    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T23:05:19.205    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:05:19.205    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:05:19.205    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:05:19.205    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:05:19.205    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980926-104009-095_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/26/SPOT4-HRVIR1-XS_19980926-104007-049_L1C_043-263-9_D_V1-0/SPOT4-HRVIR1-XS_19980926-104007-049_L1C_043-263-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980926-104007-049_L1C_043-263-9_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980926-104007-049_L1C_043-263-9_D_V1-0.zip
run script
2024-01-10T23:07:32.683    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T23:07:32.684    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980926-104007-049_L1C_043-263-9_D_V1-0.zip
2024-01-10T23:07:32.684    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:07:32.684    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:07:32.684    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T23:07:32.684    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:07:32.684    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:07:32.684    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:07:32.684    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:07:32.685    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980926-104007-049_L1C_043-263-9_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/26/SPOT4-HRVIR1-XS_19980926-104007-209_L1C_043-264-0_D_V1-0/SPOT4-HRVIR1-XS_19980926-104007-209_L1C_043-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980926-104007-209_L1C_043-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980926-104007-209_L1C_043-264-0_D_V1-0.zip
run script
2024-01-10T23:09:28.942    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T23:09:28.943    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980926-104007-209_L1C_043-264-0_D_V1-0.zip
2024-01-10T23:09:28.943    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:09:28.943    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:09:28.943    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T23:09:28.943    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:09:28.943    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:09:28.944    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:09:28.944    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:09:28.944    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980926-104007-209_L1C_043-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/15/SPOT4-HRVIR2-XS_19980815-104742-983_L1C_041-263-7_D_V1-0/SPOT4-HRVIR2-XS_19980815-104742-983_L1C_041-263-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980815-104742-983_L1C_041-263-7_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980815-104742-983_L1C_041-263-7_D_V1-0.zip
run script
2024-01-10T23:11:24.719    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T23:11:24.720    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980815-104742-983_L1C_041-263-7_D_V1-0.zip
2024-01-10T23:11:24.720    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:11:24.721    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:11:24.721    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T23:11:24.721    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:11:24.721    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:11:24.721    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:11:24.721    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:11:24.721    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980815-104742-983_L1C_041-263-7_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/15/SPOT4-HRVIR2-XS_19980815-104744-959_L1C_041-264-0_D_V1-0/SPOT4-HRVIR2-XS_19980815-104744-959_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980815-104744-959_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980815-104744-959_L1C_041-264-0_D_V1-0.zip
run script
2024-01-10T23:13:28.327    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T23:13:28.328    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980815-104744-959_L1C_041-264-0_D_V1-0.zip
2024-01-10T23:13:28.328    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:13:28.328    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:13:28.328    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T23:13:28.329    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:13:28.329    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:13:28.329    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:13:28.329    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:13:28.329    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980815-104744-959_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/20/SPOT4-HRVIR1-XS_19980920-105533-881_L1C_041-263-7_D_V1-0/SPOT4-HRVIR1-XS_19980920-105533-881_L1C_041-263-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980920-105533-881_L1C_041-263-7_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980920-105533-881_L1C_041-263-7_D_V1-0.zip
run script
2024-01-10T23:15:29.758    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T23:15:29.759    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980920-105533-881_L1C_041-263-7_D_V1-0.zip
2024-01-10T23:15:29.759    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:15:29.759    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:15:29.759    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T23:15:29.759    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:15:29.759    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:15:29.759    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:15:29.759    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:15:29.759    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980920-105533-881_L1C_041-263-7_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/20/SPOT4-HRVIR1-XS_19980920-105535-884_L1C_041-264-0_D_V1-0/SPOT4-HRVIR1-XS_19980920-105535-884_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980920-105535-884_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980920-105535-884_L1C_041-264-0_D_V1-0.zip
run script
2024-01-10T23:17:26.187    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T23:17:26.187    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980920-105535-884_L1C_041-264-0_D_V1-0.zip
2024-01-10T23:17:26.187    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:17:26.187    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:17:26.187    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T23:17:26.187    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:17:26.187    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:17:26.187    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:17:26.188    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:17:26.188    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980920-105535-884_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/24/SPOT4-HRVIR1-XS_19980924-111839-347_L1C_041-263-2_D_V1-0/SPOT4-HRVIR1-XS_19980924-111839-347_L1C_041-263-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980924-111839-347_L1C_041-263-2_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980924-111839-347_L1C_041-263-2_D_V1-0.zip
run script
2024-01-10T23:19:22.396    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T23:19:22.397    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980924-111839-347_L1C_041-263-2_D_V1-0.zip
2024-01-10T23:19:22.397    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:19:22.398    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:19:22.398    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T23:19:22.398    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:19:22.398    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:19:22.398    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:19:22.398    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:19:22.398    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980924-111839-347_L1C_041-263-2_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/24/SPOT4-HRVIR1-XS_19980924-111846-009_L1C_041-264-0_D_V1-0/SPOT4-HRVIR1-XS_19980924-111846-009_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980924-111846-009_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980924-111846-009_L1C_041-264-0_D_V1-0.zip
run script
2024-01-10T23:21:27.891    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T23:21:27.892    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980924-111846-009_L1C_041-264-0_D_V1-0.zip
2024-01-10T23:21:27.892    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:21:27.892    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:21:27.893    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T23:21:27.893    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:21:27.893    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:21:27.893    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:21:27.893    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:21:27.893    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980924-111846-009_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/29/SPOT4-HRVIR1-XS_19980929-112232-154_L1C_041-263-3_D_V1-0/SPOT4-HRVIR1-XS_19980929-112232-154_L1C_041-263-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980929-112232-154_L1C_041-263-3_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980929-112232-154_L1C_041-263-3_D_V1-0.zip
run script
2024-01-10T23:23:59.286    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T23:23:59.287    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980929-112232-154_L1C_041-263-3_D_V1-0.zip
2024-01-10T23:23:59.287    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:23:59.287    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:23:59.287    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T23:23:59.287    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:23:59.287    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:23:59.287    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:23:59.287    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:23:59.287    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980929-112232-154_L1C_041-263-3_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/29/SPOT4-HRVIR1-XS_19980929-112237-951_L1C_041-264-0_D_V1-0/SPOT4-HRVIR1-XS_19980929-112237-951_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980929-112237-951_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980929-112237-951_L1C_041-264-0_D_V1-0.zip
run script
2024-01-10T23:26:27.680    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T23:26:27.681    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980929-112237-951_L1C_041-264-0_D_V1-0.zip
2024-01-10T23:26:27.681    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:26:27.682    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:26:27.682    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T23:26:27.682    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:26:27.682    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:26:27.682    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:26:27.682    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:26:27.682    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980929-112237-951_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/10/15/SPOT4-HRVIR2-XS_19981015-111455-321_L1C_041-263-9_D_V1-0/SPOT4-HRVIR2-XS_19981015-111455-321_L1C_041-263-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19981015-111455-321_L1C_041-263-9_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981015-111455-321_L1C_041-263-9_D_V1-0.zip
run script
2024-01-10T23:29:07.959    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T23:29:07.959    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981015-111455-321_L1C_041-263-9_D_V1-0.zip
2024-01-10T23:29:07.959    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:29:07.959    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:29:07.959    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T23:29:07.959    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:29:07.959    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:29:07.959    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:29:07.959    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:29:07.959    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981015-111455-321_L1C_041-263-9_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/10/15/SPOT4-HRVIR2-XS_19981015-111455-637_L1C_041-264-0_D_V1-0/SPOT4-HRVIR2-XS_19981015-111455-637_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19981015-111455-637_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981015-111455-637_L1C_041-264-0_D_V1-0.zip
run script
2024-01-10T23:31:24.232    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T23:31:24.232    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981015-111455-637_L1C_041-264-0_D_V1-0.zip
2024-01-10T23:31:24.232    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:31:24.232    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:31:24.232    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T23:31:24.232    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:31:24.232    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:31:24.232    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:31:24.232    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:31:24.232    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981015-111455-637_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/10/16/SPOT4-HRVIR1-XS_19981016-105536-654_L1C_041-263-8_D_V1-0/SPOT4-HRVIR1-XS_19981016-105536-654_L1C_041-263-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19981016-105536-654_L1C_041-263-8_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981016-105536-654_L1C_041-263-8_D_V1-0.zip
run script
2024-01-10T23:33:42.549    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T23:33:42.550    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981016-105536-654_L1C_041-263-8_D_V1-0.zip
2024-01-10T23:33:42.550    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:33:42.550    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:33:42.550    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T23:33:42.550    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:33:42.550    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:33:42.550    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:33:42.550    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:33:42.550    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981016-105536-654_L1C_041-263-8_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/10/16/SPOT4-HRVIR1-XS_19981016-105537-757_L1C_041-264-0_D_V1-0/SPOT4-HRVIR1-XS_19981016-105537-757_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19981016-105537-757_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981016-105537-757_L1C_041-264-0_D_V1-0.zip
run script
2024-01-10T23:35:36.587    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T23:35:36.589    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981016-105537-757_L1C_041-264-0_D_V1-0.zip
2024-01-10T23:35:36.589    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:35:36.589    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:35:36.589    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T23:35:36.589    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:35:36.589    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:35:36.589    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:35:36.589    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:35:36.589    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981016-105537-757_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/10/16/SPOT4-HRVIR2-XS_19981016-105532-991_L1C_042-263-5_D_V1-0/SPOT4-HRVIR2-XS_19981016-105532-991_L1C_042-263-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19981016-105532-991_L1C_042-263-5_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981016-105532-991_L1C_042-263-5_D_V1-0.zip
run script
2024-01-10T23:37:32.005    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T23:37:32.006    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981016-105532-991_L1C_042-263-5_D_V1-0.zip
2024-01-10T23:37:32.006    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:37:32.006    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:37:32.006    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T23:37:32.006    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:37:32.006    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:37:32.006    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:37:32.006    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:37:32.006    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981016-105532-991_L1C_042-263-5_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/10/16/SPOT4-HRVIR2-XS_19981016-105536-806_L1C_042-264-0_D_V1-0/SPOT4-HRVIR2-XS_19981016-105536-806_L1C_042-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19981016-105536-806_L1C_042-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981016-105536-806_L1C_042-264-0_D_V1-0.zip
run script
2024-01-10T23:39:27.410    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T23:39:27.411    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981016-105536-806_L1C_042-264-0_D_V1-0.zip
2024-01-10T23:39:27.411    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:39:27.411    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:39:27.412    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T23:39:27.412    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:39:27.412    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:39:27.412    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:39:27.412    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:39:27.412    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981016-105536-806_L1C_042-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/10/16/SPOT4-HRVIR2-XS_19981016-105537-708_L1C_042-264-1_D_V1-0/SPOT4-HRVIR2-XS_19981016-105537-708_L1C_042-264-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19981016-105537-708_L1C_042-264-1_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981016-105537-708_L1C_042-264-1_D_V1-0.zip
run script
2024-01-10T23:41:19.067    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T23:41:19.068    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981016-105537-708_L1C_042-264-1_D_V1-0.zip
2024-01-10T23:41:19.068    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:41:19.068    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:41:19.068    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T23:41:19.068    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:41:19.068    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:41:19.069    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:41:19.069    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:41:19.069    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981016-105537-708_L1C_042-264-1_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/10/20/SPOT4-HRVIR2-XS_19981020-111845-003_L1C_041-263-9_D_V1-0/SPOT4-HRVIR2-XS_19981020-111845-003_L1C_041-263-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19981020-111845-003_L1C_041-263-9_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981020-111845-003_L1C_041-263-9_D_V1-0.zip
run script
2024-01-10T23:43:11.217    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T23:43:11.218    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981020-111845-003_L1C_041-263-9_D_V1-0.zip
2024-01-10T23:43:11.218    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:43:11.218    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:43:11.218    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T23:43:11.218    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:43:11.218    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:43:11.218    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:43:11.218    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:43:11.218    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981020-111845-003_L1C_041-263-9_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/10/21/SPOT4-HRVIR2-XS_19981021-105923-550_L1C_041-263-4_D_V1-0/SPOT4-HRVIR2-XS_19981021-105923-550_L1C_041-263-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19981021-105923-550_L1C_041-263-4_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981021-105923-550_L1C_041-263-4_D_V1-0.zip
run script
2024-01-10T23:45:36.390    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T23:45:36.392    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981021-105923-550_L1C_041-263-4_D_V1-0.zip
2024-01-10T23:45:36.392    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:45:36.392    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:45:36.392    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T23:45:36.392    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:45:36.392    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:45:36.392    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:45:36.392    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:45:36.392    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981021-105923-550_L1C_041-263-4_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/10/21/SPOT4-HRVIR2-XS_19981021-105928-281_L1C_041-264-0_D_V1-0/SPOT4-HRVIR2-XS_19981021-105928-281_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19981021-105928-281_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981021-105928-281_L1C_041-264-0_D_V1-0.zip
run script
2024-01-10T23:47:30.532    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T23:47:30.532    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981021-105928-281_L1C_041-264-0_D_V1-0.zip
2024-01-10T23:47:30.533    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:47:30.533    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:47:30.533    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T23:47:30.533    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:47:30.533    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:47:30.533    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:47:30.533    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:47:30.533    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981021-105928-281_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/10/22/SPOT4-HRVIR2-XS_19981022-104007-367_L1C_041-263-9_D_V1-0/SPOT4-HRVIR2-XS_19981022-104007-367_L1C_041-263-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19981022-104007-367_L1C_041-263-9_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981022-104007-367_L1C_041-263-9_D_V1-0.zip
run script
2024-01-10T23:49:24.356    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T23:49:24.357    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981022-104007-367_L1C_041-263-9_D_V1-0.zip
2024-01-10T23:49:24.357    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:49:24.357    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:49:24.357    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T23:49:24.357    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:49:24.357    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:49:24.357    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:49:24.357    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:49:24.357    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981022-104007-367_L1C_041-263-9_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/10/22/SPOT4-HRVIR2-XS_19981022-104007-518_L1C_041-264-0_D_V1-0/SPOT4-HRVIR2-XS_19981022-104007-518_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19981022-104007-518_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981022-104007-518_L1C_041-264-0_D_V1-0.zip
run script
2024-01-10T23:51:34.522    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T23:51:34.524    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981022-104007-518_L1C_041-264-0_D_V1-0.zip
2024-01-10T23:51:34.524    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:51:34.524    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:51:34.524    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T23:51:34.524    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:51:34.524    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:51:34.524    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:51:34.524    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:51:34.524    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981022-104007-518_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/10/26/SPOT4-HRVIR1-XS_19981026-110316-927_L1C_041-263-8_D_V1-0/SPOT4-HRVIR1-XS_19981026-110316-927_L1C_041-263-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19981026-110316-927_L1C_041-263-8_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981026-110316-927_L1C_041-263-8_D_V1-0.zip
run script
2024-01-10T23:53:43.154    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T23:53:43.155    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981026-110316-927_L1C_041-263-8_D_V1-0.zip
2024-01-10T23:53:43.155    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:53:43.155    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:53:43.155    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T23:53:43.155    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:53:43.156    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:53:43.156    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:53:43.156    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:53:43.156    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981026-110316-927_L1C_041-263-8_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/10/26/SPOT4-HRVIR1-XS_19981026-110318-966_L1C_041-264-1_D_V1-0/SPOT4-HRVIR1-XS_19981026-110318-966_L1C_041-264-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19981026-110318-966_L1C_041-264-1_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981026-110318-966_L1C_041-264-1_D_V1-0.zip
run script
2024-01-10T23:55:39.644    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T23:55:39.644    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981026-110318-966_L1C_041-264-1_D_V1-0.zip
2024-01-10T23:55:39.644    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:55:39.645    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:55:39.645    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T23:55:39.645    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:55:39.645    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:55:39.645    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:55:39.645    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:55:39.645    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981026-110318-966_L1C_041-264-1_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/10/27/SPOT4-HRVIR1-XS_19981027-104357-765_L1C_041-263-9_D_V1-0/SPOT4-HRVIR1-XS_19981027-104357-765_L1C_041-263-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19981027-104357-765_L1C_041-263-9_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981027-104357-765_L1C_041-263-9_D_V1-0.zip
run script
2024-01-10T23:57:34.955    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T23:57:34.956    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981027-104357-765_L1C_041-263-9_D_V1-0.zip
2024-01-10T23:57:34.956    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:57:34.956    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:57:34.956    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T23:57:34.956    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:57:34.956    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:57:34.956    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:57:34.956    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:57:34.956    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981027-104357-765_L1C_041-263-9_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/10/27/SPOT4-HRVIR1-XS_19981027-104357-924_L1C_041-264-0_D_V1-0/SPOT4-HRVIR1-XS_19981027-104357-924_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19981027-104357-924_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981027-104357-924_L1C_041-264-0_D_V1-0.zip
run script
2024-01-10T23:59:39.443    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-10T23:59:39.444    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981027-104357-924_L1C_041-264-0_D_V1-0.zip
2024-01-10T23:59:39.444    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T23:59:39.444    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T23:59:39.444    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T23:59:39.444    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T23:59:39.444    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T23:59:39.444    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T23:59:39.444    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T23:59:39.445    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981027-104357-924_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/04/SPOT4-HRVIR1-XS_19980804-105911-097_L1C_042-263-0_D_V1-0/SPOT4-HRVIR1-XS_19980804-105911-097_L1C_042-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980804-105911-097_L1C_042-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980804-105911-097_L1C_042-263-0_D_V1-0.zip
run script
2024-01-11T00:01:42.925    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:01:42.926    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980804-105911-097_L1C_042-263-0_D_V1-0.zip
2024-01-11T00:01:42.926    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:01:42.926    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:01:42.926    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:01:42.926    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:01:42.926    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:01:42.926    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:01:42.926    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:01:42.927    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980804-105911-097_L1C_042-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/20/SPOT4-HRVIR2-XS_19980720-104727-588_L1C_043-262-5_D_V1-0/SPOT4-HRVIR2-XS_19980720-104727-588_L1C_043-262-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980720-104727-588_L1C_043-262-5_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980720-104727-588_L1C_043-262-5_D_V1-0.zip
run script
2024-01-11T00:02:59.929    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:02:59.930    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980720-104727-588_L1C_043-262-5_D_V1-0.zip
2024-01-11T00:02:59.931    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:02:59.931    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:02:59.931    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:02:59.931    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:02:59.931    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:02:59.931    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:02:59.931    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:02:59.931    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980720-104727-588_L1C_043-262-5_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 0 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/20/SPOT4-HRVIR2-XS_19980720-104731-378_L1C_043-263-0_D_V1-0/SPOT4-HRVIR2-XS_19980720-104731-378_L1C_043-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980720-104731-378_L1C_043-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980720-104731-378_L1C_043-263-0_D_V1-0.zip
run script
2024-01-11T00:03:42.604    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:03:42.605    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980720-104731-378_L1C_043-263-0_D_V1-0.zip
2024-01-11T00:03:42.605    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:03:42.605    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:03:42.605    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:03:42.605    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:03:42.605    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:03:42.605    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:03:42.606    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:03:42.606    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980720-104731-378_L1C_043-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/20/SPOT4-HRVIR2-XS_19980720-104739-686_L1C_043-264-0_D_V1-0/SPOT4-HRVIR2-XS_19980720-104739-686_L1C_043-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980720-104739-686_L1C_043-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980720-104739-686_L1C_043-264-0_D_V1-0.zip
run script
2024-01-11T00:05:00.894    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:05:00.894    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980720-104739-686_L1C_043-264-0_D_V1-0.zip
2024-01-11T00:05:00.894    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:05:00.894    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:05:00.894    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:05:00.894    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:05:00.894    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:05:00.895    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:05:00.895    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:05:00.895    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980720-104739-686_L1C_043-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/20/SPOT4-HRVIR1-XS_19980720-104728-880_L1C_044-262-8_D_V1-0/SPOT4-HRVIR1-XS_19980720-104728-880_L1C_044-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980720-104728-880_L1C_044-262-8_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980720-104728-880_L1C_044-262-8_D_V1-0.zip
run script
2024-01-11T00:06:42.762    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:06:42.763    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980720-104728-880_L1C_044-262-8_D_V1-0.zip
2024-01-11T00:06:42.763    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:06:42.764    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:06:42.764    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:06:42.764    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:06:42.764    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:06:42.764    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:06:42.764    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:06:42.764    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980720-104728-880_L1C_044-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/20/SPOT4-HRVIR1-XS_19980720-104729-972_L1C_044-263-0_D_V1-0/SPOT4-HRVIR1-XS_19980720-104729-972_L1C_044-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980720-104729-972_L1C_044-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980720-104729-972_L1C_044-263-0_D_V1-0.zip
run script
2024-01-11T00:07:44.009    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:07:44.011    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980720-104729-972_L1C_044-263-0_D_V1-0.zip
2024-01-11T00:07:44.011    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:07:44.011    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:07:44.011    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:07:44.011    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:07:44.011    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:07:44.011    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:07:44.011    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:07:44.011    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980720-104729-972_L1C_044-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/20/SPOT4-HRVIR1-XS_19980720-104738-289_L1C_044-264-0_D_V1-0/SPOT4-HRVIR1-XS_19980720-104738-289_L1C_044-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980720-104738-289_L1C_044-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980720-104738-289_L1C_044-264-0_D_V1-0.zip
run script
2024-01-11T00:08:53.892    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:08:53.893    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980720-104738-289_L1C_044-264-0_D_V1-0.zip
2024-01-11T00:08:53.893    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:08:53.893    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:08:53.893    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:08:53.893    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:08:53.893    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:08:53.894    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:08:53.894    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:08:53.894    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980720-104738-289_L1C_044-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/20/SPOT4-HRVIR1-XS_19980720-104746-615_L1C_044-265-0_D_V1-0/SPOT4-HRVIR1-XS_19980720-104746-615_L1C_044-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980720-104746-615_L1C_044-265-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980720-104746-615_L1C_044-265-0_D_V1-0.zip
run script
2024-01-11T00:10:34.524    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:10:34.525    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980720-104746-615_L1C_044-265-0_D_V1-0.zip
2024-01-11T00:10:34.525    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:10:34.525    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:10:34.525    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:10:34.525    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:10:34.525    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:10:34.525    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:10:34.525    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:10:34.526    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980720-104746-615_L1C_044-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/25/SPOT4-HRVIR1-XS_19980725-105124-553_L1C_043-263-0_D_V1-0/SPOT4-HRVIR1-XS_19980725-105124-553_L1C_043-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980725-105124-553_L1C_043-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980725-105124-553_L1C_043-263-0_D_V1-0.zip
run script
2024-01-11T00:11:05.732    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:11:05.732    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980725-105124-553_L1C_043-263-0_D_V1-0.zip
2024-01-11T00:11:05.732    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:11:05.732    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:11:05.732    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:11:05.732    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:11:05.732    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:11:05.732    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:11:05.732    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:11:05.732    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980725-105124-553_L1C_043-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/25/SPOT4-HRVIR1-XS_19980725-105132-876_L1C_043-264-0_D_V1-0/SPOT4-HRVIR1-XS_19980725-105132-876_L1C_043-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980725-105132-876_L1C_043-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980725-105132-876_L1C_043-264-0_D_V1-0.zip
run script
2024-01-11T00:12:22.802    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:12:22.803    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980725-105132-876_L1C_043-264-0_D_V1-0.zip
2024-01-11T00:12:22.803    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:12:22.804    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:12:22.804    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:12:22.804    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:12:22.804    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:12:22.804    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:12:22.804    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:12:22.804    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980725-105132-876_L1C_043-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/25/SPOT4-HRVIR2-XS_19980725-105123-058_L1C_044-263-0_D_V1-0/SPOT4-HRVIR2-XS_19980725-105123-058_L1C_044-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980725-105123-058_L1C_044-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980725-105123-058_L1C_044-263-0_D_V1-0.zip
run script
2024-01-11T00:14:03.420    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:14:03.421    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980725-105123-058_L1C_044-263-0_D_V1-0.zip
2024-01-11T00:14:03.421    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:14:03.421    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:14:03.421    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:14:03.421    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:14:03.421    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:14:03.421    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:14:03.421    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:14:03.421    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980725-105123-058_L1C_044-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 2 2]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/25/SPOT4-HRVIR2-XS_19980725-105131-393_L1C_044-264-0_D_V1-0/SPOT4-HRVIR2-XS_19980725-105131-393_L1C_044-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980725-105131-393_L1C_044-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980725-105131-393_L1C_044-264-0_D_V1-0.zip
run script
2024-01-11T00:15:13.952    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:15:13.953    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980725-105131-393_L1C_044-264-0_D_V1-0.zip
2024-01-11T00:15:13.953    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:15:13.953    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:15:13.954    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:15:13.954    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:15:13.954    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:15:13.954    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:15:13.954    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:15:13.954    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980725-105131-393_L1C_044-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/25/SPOT4-HRVIR2-XS_19980725-105139-737_L1C_044-265-0_D_V1-0/SPOT4-HRVIR2-XS_19980725-105139-737_L1C_044-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980725-105139-737_L1C_044-265-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980725-105139-737_L1C_044-265-0_D_V1-0.zip
run script
2024-01-11T00:16:53.087    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:16:53.088    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980725-105139-737_L1C_044-265-0_D_V1-0.zip
2024-01-11T00:16:53.088    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:16:53.089    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:16:53.089    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:16:53.089    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:16:53.089    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:16:53.089    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:16:53.089    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:16:53.089    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980725-105139-737_L1C_044-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 2]
 [2 2 2 ... 0 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/11/17/SPOT4-HRVIR1-XS_19981117-104010-206_L1C_043-263-9_D_V1-0/SPOT4-HRVIR1-XS_19981117-104010-206_L1C_043-263-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19981117-104010-206_L1C_043-263-9_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981117-104010-206_L1C_043-263-9_D_V1-0.zip
run script
2024-01-11T00:17:24.112    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:17:24.113    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981117-104010-206_L1C_043-263-9_D_V1-0.zip
2024-01-11T00:17:24.114    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:17:24.114    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:17:24.114    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:17:24.114    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:17:24.114    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:17:24.114    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:17:24.114    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:17:24.114    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981117-104010-206_L1C_043-263-9_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/11/17/SPOT4-HRVIR1-XS_19981117-104010-366_L1C_043-264-0_D_V1-0/SPOT4-HRVIR1-XS_19981117-104010-366_L1C_043-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19981117-104010-366_L1C_043-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981117-104010-366_L1C_043-264-0_D_V1-0.zip
run script
2024-01-11T00:19:15.344    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:19:15.345    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981117-104010-366_L1C_043-264-0_D_V1-0.zip
2024-01-11T00:19:15.345    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:19:15.345    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:19:15.345    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:19:15.345    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:19:15.345    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:19:15.345    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:19:15.346    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:19:15.346    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981117-104010-366_L1C_043-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/19/SPOT4-HRVIR2-XS_19980619-104331-242_L1C_044-263-8_D_V1-0/SPOT4-HRVIR2-XS_19980619-104331-242_L1C_044-263-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980619-104331-242_L1C_044-263-8_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980619-104331-242_L1C_044-263-8_D_V1-0.zip
run script
2024-01-11T00:21:05.836    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:21:05.836    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980619-104331-242_L1C_044-263-8_D_V1-0.zip
2024-01-11T00:21:05.836    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:21:05.836    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:21:05.836    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:21:05.836    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:21:05.836    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:21:05.836    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:21:05.836    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:21:05.837    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980619-104331-242_L1C_044-263-8_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/19/SPOT4-HRVIR2-XS_19980619-104332-325_L1C_044-264-0_D_V1-0/SPOT4-HRVIR2-XS_19980619-104332-325_L1C_044-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980619-104332-325_L1C_044-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980619-104332-325_L1C_044-264-0_D_V1-0.zip
run script
2024-01-11T00:22:46.309    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:22:46.309    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980619-104332-325_L1C_044-264-0_D_V1-0.zip
2024-01-11T00:22:46.309    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:22:46.310    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:22:46.310    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:22:46.310    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:22:46.310    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:22:46.310    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:22:46.310    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:22:46.310    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980619-104332-325_L1C_044-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/19/SPOT4-HRVIR2-XS_19980619-104340-633_L1C_044-265-0_D_V1-0/SPOT4-HRVIR2-XS_19980619-104340-633_L1C_044-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980619-104340-633_L1C_044-265-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980619-104340-633_L1C_044-265-0_D_V1-0.zip
run script
2024-01-11T00:24:29.152    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:24:29.152    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980619-104340-633_L1C_044-265-0_D_V1-0.zip
2024-01-11T00:24:29.152    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:24:29.152    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:24:29.152    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:24:29.152    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:24:29.152    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:24:29.152    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:24:29.152    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:24:29.153    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980619-104340-633_L1C_044-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/11/22/SPOT4-HRVIR1-XS_19981122-104359-402_L1C_044-263-7_D_V1-0/SPOT4-HRVIR1-XS_19981122-104359-402_L1C_044-263-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19981122-104359-402_L1C_044-263-7_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981122-104359-402_L1C_044-263-7_D_V1-0.zip
run script
2024-01-11T00:25:00.984    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:25:00.984    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981122-104359-402_L1C_044-263-7_D_V1-0.zip
2024-01-11T00:25:00.984    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:25:00.984    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:25:00.984    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:25:00.984    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:25:00.984    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:25:00.984    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:25:00.984    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:25:00.984    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981122-104359-402_L1C_044-263-7_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/11/22/SPOT4-HRVIR1-XS_19981122-104401-384_L1C_044-264-0_D_V1-0/SPOT4-HRVIR1-XS_19981122-104401-384_L1C_044-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19981122-104401-384_L1C_044-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981122-104401-384_L1C_044-264-0_D_V1-0.zip
run script
2024-01-11T00:26:46.930    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:26:46.931    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981122-104401-384_L1C_044-264-0_D_V1-0.zip
2024-01-11T00:26:46.931    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:26:46.931    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:26:46.931    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:26:46.931    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:26:46.931    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:26:46.931    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:26:46.932    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:26:46.932    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19981122-104401-384_L1C_044-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/30/SPOT4-HRVIR2-XS_19980630-103159-089_L1C_045-263-7_D_V1-0/SPOT4-HRVIR2-XS_19980630-103159-089_L1C_045-263-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980630-103159-089_L1C_045-263-7_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980630-103159-089_L1C_045-263-7_D_V1-0.zip
run script
2024-01-11T00:28:32.450    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:28:32.451    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980630-103159-089_L1C_045-263-7_D_V1-0.zip
2024-01-11T00:28:32.451    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:28:32.451    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:28:32.451    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:28:32.451    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:28:32.451    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:28:32.452    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:28:32.452    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:28:32.452    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980630-103159-089_L1C_045-263-7_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/30/SPOT4-HRVIR2-XS_19980630-103201-047_L1C_045-264-0_D_V1-0/SPOT4-HRVIR2-XS_19980630-103201-047_L1C_045-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980630-103201-047_L1C_045-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980630-103201-047_L1C_045-264-0_D_V1-0.zip
run script
2024-01-11T00:29:56.395    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:29:56.396    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980630-103201-047_L1C_045-264-0_D_V1-0.zip
2024-01-11T00:29:56.396    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:29:56.396    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:29:56.396    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:29:56.396    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:29:56.396    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:29:56.396    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:29:56.397    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:29:56.397    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980630-103201-047_L1C_045-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/30/SPOT4-HRVIR2-XS_19980630-103209-331_L1C_045-265-0_D_V1-0/SPOT4-HRVIR2-XS_19980630-103209-331_L1C_045-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980630-103209-331_L1C_045-265-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980630-103209-331_L1C_045-265-0_D_V1-0.zip
run script
2024-01-11T00:31:25.262    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:31:25.262    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980630-103209-331_L1C_045-265-0_D_V1-0.zip
2024-01-11T00:31:25.262    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:31:25.262    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:31:25.262    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:31:25.262    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:31:25.262    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:31:25.263    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:31:25.263    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:31:25.263    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980630-103209-331_L1C_045-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/21/SPOT4-HRVIR1-XS_19980821-103202-727_L1C_045-263-0_D_V1-0/SPOT4-HRVIR1-XS_19980821-103202-727_L1C_045-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980821-103202-727_L1C_045-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980821-103202-727_L1C_045-263-0_D_V1-0.zip
run script
2024-01-11T00:31:55.105    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:31:55.106    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980821-103202-727_L1C_045-263-0_D_V1-0.zip
2024-01-11T00:31:55.106    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:31:55.106    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:31:55.106    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:31:55.106    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:31:55.106    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:31:55.106    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:31:55.107    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:31:55.107    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980821-103202-727_L1C_045-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/21/SPOT4-HRVIR2-XS_19980821-103206-185_L1C_046-263-4_D_V1-0/SPOT4-HRVIR2-XS_19980821-103206-185_L1C_046-263-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980821-103206-185_L1C_046-263-4_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980821-103206-185_L1C_046-263-4_D_V1-0.zip
run script
2024-01-11T00:32:48.042    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:32:48.043    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980821-103206-185_L1C_046-263-4_D_V1-0.zip
2024-01-11T00:32:48.043    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:32:48.043    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:32:48.043    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:32:48.043    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:32:48.043    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:32:48.043    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:32:48.043    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:32:48.044    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980821-103206-185_L1C_046-263-4_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/21/SPOT4-HRVIR1-XS_19980821-103211-002_L1C_046-264-0_D_V1-0/SPOT4-HRVIR1-XS_19980821-103211-002_L1C_046-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980821-103211-002_L1C_046-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980821-103211-002_L1C_046-264-0_D_V1-0.zip
run script
2024-01-11T00:33:56.114    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:33:56.114    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980821-103211-002_L1C_046-264-0_D_V1-0.zip
2024-01-11T00:33:56.114    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:33:56.114    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:33:56.115    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:33:56.115    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:33:56.115    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:33:56.115    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:33:56.115    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:33:56.115    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980821-103211-002_L1C_046-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/21/SPOT4-HRVIR2-XS_19980821-103210-854_L1C_046-264-0_D_V1-0/SPOT4-HRVIR2-XS_19980821-103210-854_L1C_046-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980821-103210-854_L1C_046-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980821-103210-854_L1C_046-264-0_D_V1-0.zip
run script
2024-01-11T00:35:14.798    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:35:14.799    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980821-103210-854_L1C_046-264-0_D_V1-0.zip
2024-01-11T00:35:14.799    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:35:14.799    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:35:14.799    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:35:14.799    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:35:14.799    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:35:14.799    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:35:14.799    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:35:14.799    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980821-103210-854_L1C_046-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/11/07/SPOT4-HRVIR2-XS_19981107-103211-933_L1C_046-262-8_D_V1-0/SPOT4-HRVIR2-XS_19981107-103211-933_L1C_046-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19981107-103211-933_L1C_046-262-8_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981107-103211-933_L1C_046-262-8_D_V1-0.zip
run script
2024-01-11T00:36:33.171    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:36:33.172    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981107-103211-933_L1C_046-262-8_D_V1-0.zip
2024-01-11T00:36:33.172    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:36:33.172    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:36:33.173    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:36:33.173    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:36:33.173    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:36:33.173    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:36:33.173    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:36:33.173    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19981107-103211-933_L1C_046-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/19/SPOT4-HRVIR1-XS_19980519-103920-619_L1C_047-264-0_D_V1-0/SPOT4-HRVIR1-XS_19980519-103920-619_L1C_047-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980519-103920-619_L1C_047-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980519-103920-619_L1C_047-264-0_D_V1-0.zip
run script
2024-01-11T00:37:18.613    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:37:18.614    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980519-103920-619_L1C_047-264-0_D_V1-0.zip
2024-01-11T00:37:18.614    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:37:18.614    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:37:18.614    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:37:18.614    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:37:18.615    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:37:18.615    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:37:18.615    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:37:18.615    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980519-103920-619_L1C_047-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/19/SPOT4-HRVIR1-XS_19980519-103928-930_L1C_047-265-0_D_V1-0/SPOT4-HRVIR1-XS_19980519-103928-930_L1C_047-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_19980519-103928-930_L1C_047-265-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980519-103928-930_L1C_047-265-0_D_V1-0.zip
run script
2024-01-11T00:37:39.164    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:37:39.164    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980519-103928-930_L1C_047-265-0_D_V1-0.zip
2024-01-11T00:37:39.164    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:37:39.164    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:37:39.164    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:37:39.164    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:37:39.164    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:37:39.164    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:37:39.164    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:37:39.164    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR1-XS_19980519-103928-930_L1C_047-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/09/SPOT4-HRVIR2-XS_19980509-103117-693_L1C_048-262-0_D_V1-0/SPOT4-HRVIR2-XS_19980509-103117-693_L1C_048-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_19980509-103117-693_L1C_048-262-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980509-103117-693_L1C_048-262-0_D_V1-0.zip
run script
2024-01-11T00:37:51.788    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:37:51.789    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980509-103117-693_L1C_048-262-0_D_V1-0.zip
2024-01-11T00:37:51.789    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:37:51.789    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:37:51.789    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:37:51.789    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:37:51.789    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:37:51.789    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:37:51.789    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:37:51.789    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT4-HRVIR2-XS_19980509-103117-693_L1C_048-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1992/05/20/SPOT2-HRV1-XS_19920520-112257-705_L1C_036-262-4_D_V1-0/SPOT2-HRV1-XS_19920520-112257-705_L1C_036-262-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920520-112257-705_L1C_036-262-4_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920520-112257-705_L1C_036-262-4_D_V1-0.zip
run script
2024-01-11T00:37:56.371    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:37:56.371    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920520-112257-705_L1C_036-262-4_D_V1-0.zip
2024-01-11T00:37:56.372    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:37:56.372    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:37:56.372    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:37:56.372    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:37:56.372    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:37:56.372    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:37:56.372    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:37:56.372    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920520-112257-705_L1C_036-262-4_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/05/20/SPOT2-HRV2-XS_19920520-112257-735_L1C_038-262-6_D_V1-0/SPOT2-HRV2-XS_19920520-112257-735_L1C_038-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920520-112257-735_L1C_038-262-6_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920520-112257-735_L1C_038-262-6_D_V1-0.zip
run script
2024-01-11T00:38:29.873    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:38:29.873    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920520-112257-735_L1C_038-262-6_D_V1-0.zip
2024-01-11T00:38:29.873    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:38:29.874    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:38:29.874    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:38:29.874    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:38:29.874    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:38:29.874    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:38:29.874    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:38:29.874    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920520-112257-735_L1C_038-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/17/SPOT2-HRV1-XS_19920817-111201-258_L1C_037-262-6_D_V1-0/SPOT2-HRV1-XS_19920817-111201-258_L1C_037-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920817-111201-258_L1C_037-262-6_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920817-111201-258_L1C_037-262-6_D_V1-0.zip
run script
2024-01-11T00:39:29.625    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:39:29.626    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920817-111201-258_L1C_037-262-6_D_V1-0.zip
2024-01-11T00:39:29.626    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:39:29.626    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:39:29.626    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:39:29.626    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:39:29.626    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:39:29.626    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:39:29.626    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:39:29.626    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-11T00:40:11.897    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (374 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920817-111201-258_L1C_037-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1992/08/17/SPOT2-HRV1-XS_19920817-111204-203_L1C_037-263-0_D_V1-0/SPOT2-HRV1-XS_19920817-111204-203_L1C_037-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920817-111204-203_L1C_037-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920817-111204-203_L1C_037-263-0_D_V1-0.zip
run script
2024-01-11T00:40:15.155    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:40:15.156    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920817-111204-203_L1C_037-263-0_D_V1-0.zip
2024-01-11T00:40:15.156    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:40:15.156    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:40:15.156    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:40:15.156    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:40:15.156    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:40:15.156    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:40:15.156    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:40:15.156    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920817-111204-203_L1C_037-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/09/06/SPOT2-HRV2-XS_19920906-112727-623_L1C_037-262-3_D_V1-0/SPOT2-HRV2-XS_19920906-112727-623_L1C_037-262-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920906-112727-623_L1C_037-262-3_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920906-112727-623_L1C_037-262-3_D_V1-0.zip
run script
2024-01-11T00:41:24.265    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:41:24.266    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920906-112727-623_L1C_037-262-3_D_V1-0.zip
2024-01-11T00:41:24.266    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:41:24.266    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:41:24.266    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:41:24.266    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:41:24.267    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:41:24.267    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:41:24.267    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:41:24.267    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-11T00:41:53.575    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (98 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920906-112727-623_L1C_037-262-3_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1992/09/12/SPOT2-HRV1-XS_19920912-111204-963_L1C_037-262-2_D_V1-0/SPOT2-HRV1-XS_19920912-111204-963_L1C_037-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920912-111204-963_L1C_037-262-2_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920912-111204-963_L1C_037-262-2_D_V1-0.zip
run script
2024-01-11T00:41:56.446    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:41:56.447    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920912-111204-963_L1C_037-262-2_D_V1-0.zip
2024-01-11T00:41:56.447    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:41:56.447    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:41:56.447    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:41:56.447    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:41:56.447    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:41:56.447    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:41:56.447    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:41:56.447    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920912-111204-963_L1C_037-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/09/12/SPOT2-HRV2-XS_19920912-111206-909_L1C_038-262-6_D_V1-0/SPOT2-HRV2-XS_19920912-111206-909_L1C_038-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920912-111206-909_L1C_038-262-6_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920912-111206-909_L1C_038-262-6_D_V1-0.zip
run script
2024-01-11T00:42:10.086    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:42:10.086    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920912-111206-909_L1C_038-262-6_D_V1-0.zip
2024-01-11T00:42:10.086    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:42:10.087    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:42:10.087    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:42:10.087    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:42:10.087    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:42:10.087    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:42:10.087    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:42:10.087    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920912-111206-909_L1C_038-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/14/SPOT2-HRV1-XS_19920414-111448-837_L1C_037-263-1_D_V1-0/SPOT2-HRV1-XS_19920414-111448-837_L1C_037-263-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920414-111448-837_L1C_037-263-1_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920414-111448-837_L1C_037-263-1_D_V1-0.zip
run script
2024-01-11T00:43:09.040    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:43:09.041    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920414-111448-837_L1C_037-263-1_D_V1-0.zip
2024-01-11T00:43:09.041    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:43:09.041    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:43:09.041    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:43:09.041    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:43:09.041    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:43:09.041    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:43:09.042    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:43:09.042    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920414-111448-837_L1C_037-263-1_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/14/SPOT2-HRV2-XS_19920414-111448-365_L1C_039-263-4_D_V1-0/SPOT2-HRV2-XS_19920414-111448-365_L1C_039-263-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920414-111448-365_L1C_039-263-4_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920414-111448-365_L1C_039-263-4_D_V1-0.zip
run script
2024-01-11T00:44:26.723    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:44:26.724    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920414-111448-365_L1C_039-263-4_D_V1-0.zip
2024-01-11T00:44:26.724    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:44:26.724    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:44:26.724    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:44:26.724    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:44:26.724    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:44:26.724    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:44:26.724    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:44:26.724    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920414-111448-365_L1C_039-263-4_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/14/SPOT2-HRV2-XS_19920414-111453-175_L1C_039-264-0_D_V1-0/SPOT2-HRV2-XS_19920414-111453-175_L1C_039-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920414-111453-175_L1C_039-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920414-111453-175_L1C_039-264-0_D_V1-0.zip
run script
2024-01-11T00:46:21.020    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:46:21.022    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920414-111453-175_L1C_039-264-0_D_V1-0.zip
2024-01-11T00:46:21.022    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:46:21.022    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:46:21.022    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:46:21.022    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:46:21.022    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:46:21.022    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:46:21.022    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:46:21.022    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920414-111453-175_L1C_039-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/16/SPOT2-HRV2-XS_19920816-113121-245_L1C_037-263-0_D_V1-0/SPOT2-HRV2-XS_19920816-113121-245_L1C_037-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920816-113121-245_L1C_037-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920816-113121-245_L1C_037-263-0_D_V1-0.zip
run script
2024-01-11T00:48:18.392    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:48:18.393    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920816-113121-245_L1C_037-263-0_D_V1-0.zip
2024-01-11T00:48:18.393    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:48:18.393    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:48:18.393    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:48:18.393    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:48:18.393    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:48:18.393    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:48:18.393    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:48:18.393    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920816-113121-245_L1C_037-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/27/SPOT2-HRV1-XS_19920827-111953-391_L1C_037-263-5_D_V1-0/SPOT2-HRV1-XS_19920827-111953-391_L1C_037-263-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920827-111953-391_L1C_037-263-5_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920827-111953-391_L1C_037-263-5_D_V1-0.zip
run script
2024-01-11T00:49:41.480    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:49:41.481    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920827-111953-391_L1C_037-263-5_D_V1-0.zip
2024-01-11T00:49:41.482    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:49:41.482    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:49:41.482    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:49:41.482    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:49:41.482    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:49:41.482    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:49:41.482    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:49:41.482    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920827-111953-391_L1C_037-263-5_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/27/SPOT2-HRV2-XS_19920827-111954-959_L1C_038-264-0_D_V1-0/SPOT2-HRV2-XS_19920827-111954-959_L1C_038-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920827-111954-959_L1C_038-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920827-111954-959_L1C_038-264-0_D_V1-0.zip
run script
2024-01-11T00:51:25.034    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:51:25.035    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920827-111954-959_L1C_038-264-0_D_V1-0.zip
2024-01-11T00:51:25.035    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:51:25.035    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:51:25.035    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:51:25.036    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:51:25.036    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:51:25.036    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:51:25.036    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:51:25.036    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920827-111954-959_L1C_038-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/27/SPOT2-HRV2-XS_19920827-111946-217_L1C_039-262-9_D_V1-0/SPOT2-HRV2-XS_19920827-111946-217_L1C_039-262-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920827-111946-217_L1C_039-262-9_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920827-111946-217_L1C_039-262-9_D_V1-0.zip
run script
2024-01-11T00:53:23.299    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:53:23.301    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920827-111946-217_L1C_039-262-9_D_V1-0.zip
2024-01-11T00:53:23.301    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:53:23.301    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:53:23.301    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:53:23.301    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:53:23.301    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:53:23.301    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:53:23.301    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:53:23.301    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920827-111946-217_L1C_039-262-9_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/27/SPOT2-HRV2-XS_19920827-111946-521_L1C_039-263-0_D_V1-0/SPOT2-HRV2-XS_19920827-111946-521_L1C_039-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920827-111946-521_L1C_039-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920827-111946-521_L1C_039-263-0_D_V1-0.zip
run script
2024-01-11T00:54:42.413    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:54:42.414    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920827-111946-521_L1C_039-263-0_D_V1-0.zip
2024-01-11T00:54:42.414    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:54:42.414    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:54:42.414    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:54:42.414    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:54:42.415    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:54:42.415    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:54:42.415    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:54:42.415    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920827-111946-521_L1C_039-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/02/27/SPOT2-HRV1-XS_19920227-111853-798_L1C_038-263-0_D_V1-0/SPOT2-HRV1-XS_19920227-111853-798_L1C_038-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920227-111853-798_L1C_038-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920227-111853-798_L1C_038-263-0_D_V1-0.zip
run script
2024-01-11T00:56:04.546    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:56:04.547    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920227-111853-798_L1C_038-263-0_D_V1-0.zip
2024-01-11T00:56:04.547    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:56:04.547    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:56:04.547    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:56:04.547    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:56:04.547    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:56:04.547    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:56:04.547    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:56:04.547    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920227-111853-798_L1C_038-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/02/27/SPOT2-HRV1-XS_19920227-111902-226_L1C_038-264-0_D_V1-0/SPOT2-HRV1-XS_19920227-111902-226_L1C_038-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920227-111902-226_L1C_038-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920227-111902-226_L1C_038-264-0_D_V1-0.zip
run script
2024-01-11T00:57:25.737    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:57:25.737    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920227-111902-226_L1C_038-264-0_D_V1-0.zip
2024-01-11T00:57:25.737    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:57:25.737    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:57:25.737    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:57:25.737    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:57:25.738    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:57:25.738    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:57:25.738    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:57:25.738    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920227-111902-226_L1C_038-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/03/20/SPOT2-HRV1-XS_19920320-105542-112_L1C_038-263-0_D_V1-0/SPOT2-HRV1-XS_19920320-105542-112_L1C_038-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920320-105542-112_L1C_038-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920320-105542-112_L1C_038-263-0_D_V1-0.zip
run script
2024-01-11T00:59:30.883    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T00:59:30.884    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920320-105542-112_L1C_038-263-0_D_V1-0.zip
2024-01-11T00:59:30.884    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T00:59:30.884    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T00:59:30.884    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T00:59:30.884    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T00:59:30.884    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T00:59:30.884    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T00:59:30.884    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T00:59:30.884    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920320-105542-112_L1C_038-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 0 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]
 [2 2 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/03/20/SPOT2-HRV2-XS_19920320-105521-266_L1C_048-262-0_D_V1-0/SPOT2-HRV2-XS_19920320-105521-266_L1C_048-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920320-105521-266_L1C_048-262-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920320-105521-266_L1C_048-262-0_D_V1-0.zip
run script
2024-01-11T01:00:44.288    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:00:44.289    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920320-105521-266_L1C_048-262-0_D_V1-0.zip
2024-01-11T01:00:44.289    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:00:44.289    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:00:44.289    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:00:44.289    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:00:44.289    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:00:44.289    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:00:44.289    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:00:44.289    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920320-105521-266_L1C_048-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1992/05/10/SPOT2-HRV1-XS_19920510-111508-584_L1C_038-263-0_D_V1-0/SPOT2-HRV1-XS_19920510-111508-584_L1C_038-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920510-111508-584_L1C_038-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920510-111508-584_L1C_038-263-0_D_V1-0.zip
run script
2024-01-11T01:00:47.201    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:00:47.202    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920510-111508-584_L1C_038-263-0_D_V1-0.zip
2024-01-11T01:00:47.202    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:00:47.202    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:00:47.202    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:00:47.202    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:00:47.202    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:00:47.202    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:00:47.202    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:00:47.202    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920510-111508-584_L1C_038-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/05/10/SPOT2-HRV1-XS_19920510-111516-986_L1C_038-264-0_D_V1-0/SPOT2-HRV1-XS_19920510-111516-986_L1C_038-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920510-111516-986_L1C_038-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920510-111516-986_L1C_038-264-0_D_V1-0.zip
run script
2024-01-11T01:02:06.304    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:02:06.304    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920510-111516-986_L1C_038-264-0_D_V1-0.zip
2024-01-11T01:02:06.304    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:02:06.304    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:02:06.304    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:02:06.305    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:02:06.305    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:02:06.305    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:02:06.305    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:02:06.305    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920510-111516-986_L1C_038-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/05/21/SPOT2-HRV1-XS_19920521-110343-018_L1C_038-263-0_D_V1-0/SPOT2-HRV1-XS_19920521-110343-018_L1C_038-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920521-110343-018_L1C_038-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920521-110343-018_L1C_038-263-0_D_V1-0.zip
run script
2024-01-11T01:03:58.036    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:03:58.037    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920521-110343-018_L1C_038-263-0_D_V1-0.zip
2024-01-11T01:03:58.037    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:03:58.038    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:03:58.038    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:03:58.038    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:03:58.038    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:03:58.038    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:03:58.038    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:03:58.038    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920521-110343-018_L1C_038-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/05/21/SPOT2-HRV1-XS_19920521-110348-432_L1C_038-263-6_D_V1-0/SPOT2-HRV1-XS_19920521-110348-432_L1C_038-263-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920521-110348-432_L1C_038-263-6_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920521-110348-432_L1C_038-263-6_D_V1-0.zip
run script
2024-01-11T01:05:09.786    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:05:09.787    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920521-110348-432_L1C_038-263-6_D_V1-0.zip
2024-01-11T01:05:09.788    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:05:09.788    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:05:09.788    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:05:09.788    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:05:09.788    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:05:09.788    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:05:09.788    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:05:09.788    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920521-110348-432_L1C_038-263-6_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/07/11/SPOT2-HRV2-XS_19920711-112321-059_L1C_038-263-0_D_V1-0/SPOT2-HRV2-XS_19920711-112321-059_L1C_038-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920711-112321-059_L1C_038-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920711-112321-059_L1C_038-263-0_D_V1-0.zip
run script
2024-01-11T01:06:55.141    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:06:55.142    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920711-112321-059_L1C_038-263-0_D_V1-0.zip
2024-01-11T01:06:55.142    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:06:55.142    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:06:55.143    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:06:55.143    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:06:55.143    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:06:55.143    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:06:55.143    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:06:55.143    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920711-112321-059_L1C_038-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/07/11/SPOT2-HRV2-XS_19920711-112329-515_L1C_038-264-0_D_V1-0/SPOT2-HRV2-XS_19920711-112329-515_L1C_038-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920711-112329-515_L1C_038-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920711-112329-515_L1C_038-264-0_D_V1-0.zip
run script
2024-01-11T01:08:25.999    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:08:26.000    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920711-112329-515_L1C_038-264-0_D_V1-0.zip
2024-01-11T01:08:26.000    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:08:26.000    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:08:26.000    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:08:26.000    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:08:26.000    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:08:26.000    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:08:26.000    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:08:26.000    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920711-112329-515_L1C_038-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/09/02/SPOT2-HRV1-XS_19920902-110421-219_L1C_038-263-0_D_V1-0/SPOT2-HRV1-XS_19920902-110421-219_L1C_038-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920902-110421-219_L1C_038-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920902-110421-219_L1C_038-263-0_D_V1-0.zip
run script
2024-01-11T01:10:33.484    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:10:33.485    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920902-110421-219_L1C_038-263-0_D_V1-0.zip
2024-01-11T01:10:33.485    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:10:33.485    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:10:33.486    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:10:33.486    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:10:33.486    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:10:33.486    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:10:33.486    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:10:33.486    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920902-110421-219_L1C_038-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 2 2]
 [0 0 0 ... 0 2 2]
 [0 0 0 ... 0 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/09/27/SPOT2-HRV2-XS_19920927-112348-496_L1C_038-263-0_D_V1-0/SPOT2-HRV2-XS_19920927-112348-496_L1C_038-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920927-112348-496_L1C_038-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920927-112348-496_L1C_038-263-0_D_V1-0.zip
run script
2024-01-11T01:11:44.952    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:11:44.953    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920927-112348-496_L1C_038-263-0_D_V1-0.zip
2024-01-11T01:11:44.953    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:11:44.953    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:11:44.953    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:11:44.953    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:11:44.953    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:11:44.953    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:11:44.954    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:11:44.954    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920927-112348-496_L1C_038-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 2 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/05/27/SPOT2-HRV1-XS_19920527-104812-033_L1C_039-262-3_D_V1-0/SPOT2-HRV1-XS_19920527-104812-033_L1C_039-262-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920527-104812-033_L1C_039-262-3_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920527-104812-033_L1C_039-262-3_D_V1-0.zip
run script
2024-01-11T01:13:15.054    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:13:15.055    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920527-104812-033_L1C_039-262-3_D_V1-0.zip
2024-01-11T01:13:15.055    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:13:15.055    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:13:15.055    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:13:15.055    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:13:15.056    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:13:15.056    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:13:15.056    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:13:15.056    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920527-104812-033_L1C_039-262-3_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/05/27/SPOT2-HRV1-XS_19920527-104817-598_L1C_039-263-0_D_V1-0/SPOT2-HRV1-XS_19920527-104817-598_L1C_039-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920527-104817-598_L1C_039-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920527-104817-598_L1C_039-263-0_D_V1-0.zip
run script
2024-01-11T01:13:38.646    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:13:38.647    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920527-104817-598_L1C_039-263-0_D_V1-0.zip
2024-01-11T01:13:38.647    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:13:38.647    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:13:38.648    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:13:38.648    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:13:38.648    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:13:38.648    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:13:38.648    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:13:38.648    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920527-104817-598_L1C_039-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/05/27/SPOT2-HRV1-XS_19920527-104825-882_L1C_039-264-0_D_V1-0/SPOT2-HRV1-XS_19920527-104825-882_L1C_039-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920527-104825-882_L1C_039-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920527-104825-882_L1C_039-264-0_D_V1-0.zip
run script
2024-01-11T01:14:54.534    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:14:54.535    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920527-104825-882_L1C_039-264-0_D_V1-0.zip
2024-01-11T01:14:54.536    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:14:54.536    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:14:54.536    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:14:54.536    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:14:54.536    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:14:54.536    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:14:54.536    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:14:54.536    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920527-104825-882_L1C_039-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/09/17/SPOT2-HRV2-XS_19920917-111559-243_L1C_039-262-6_D_V1-0/SPOT2-HRV2-XS_19920917-111559-243_L1C_039-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920917-111559-243_L1C_039-262-6_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920917-111559-243_L1C_039-262-6_D_V1-0.zip
run script
2024-01-11T01:16:53.665    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:16:53.666    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920917-111559-243_L1C_039-262-6_D_V1-0.zip
2024-01-11T01:16:53.666    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:16:53.666    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:16:53.666    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:16:53.667    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:16:53.667    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:16:53.667    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:16:53.667    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:16:53.667    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920917-111559-243_L1C_039-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/01/06/SPOT2-HRV2-XS_19920106-111906-964_L1C_039-263-0_D_V1-0/SPOT2-HRV2-XS_19920106-111906-964_L1C_039-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920106-111906-964_L1C_039-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920106-111906-964_L1C_039-263-0_D_V1-0.zip
run script
2024-01-11T01:17:44.626    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:17:44.626    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920106-111906-964_L1C_039-263-0_D_V1-0.zip
2024-01-11T01:17:44.626    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:17:44.626    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:17:44.626    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:17:44.626    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:17:44.626    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:17:44.626    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:17:44.626    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:17:44.626    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920106-111906-964_L1C_039-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/01/06/SPOT2-HRV2-XS_19920106-111915-401_L1C_039-264-0_D_V1-0/SPOT2-HRV2-XS_19920106-111915-401_L1C_039-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920106-111915-401_L1C_039-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920106-111915-401_L1C_039-264-0_D_V1-0.zip
run script
2024-01-11T01:19:09.435    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:19:09.436    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920106-111915-401_L1C_039-264-0_D_V1-0.zip
2024-01-11T01:19:09.436    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:19:09.436    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:19:09.436    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:19:09.436    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:19:09.436    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:19:09.436    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:19:09.436    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:19:09.436    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920106-111915-401_L1C_039-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/02/17/SPOT2-HRV2-XS_19920217-111112-565_L1C_039-263-0_D_V1-0/SPOT2-HRV2-XS_19920217-111112-565_L1C_039-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920217-111112-565_L1C_039-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920217-111112-565_L1C_039-263-0_D_V1-0.zip
run script
2024-01-11T01:21:14.037    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:21:14.038    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920217-111112-565_L1C_039-263-0_D_V1-0.zip
2024-01-11T01:21:14.038    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:21:14.038    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:21:14.038    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:21:14.038    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:21:14.038    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:21:14.038    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:21:14.038    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:21:14.038    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920217-111112-565_L1C_039-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 0 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/02/17/SPOT2-HRV2-XS_19920217-111120-952_L1C_039-264-0_D_V1-0/SPOT2-HRV2-XS_19920217-111120-952_L1C_039-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920217-111120-952_L1C_039-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920217-111120-952_L1C_039-264-0_D_V1-0.zip
run script
2024-01-11T01:22:29.515    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:22:29.516    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920217-111120-952_L1C_039-264-0_D_V1-0.zip
2024-01-11T01:22:29.516    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:22:29.516    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:22:29.516    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:22:29.516    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:22:29.516    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:22:29.517    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:22:29.517    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:22:29.517    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920217-111120-952_L1C_039-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/19/SPOT2-HRV1-XS_19920419-111842-821_L1C_039-263-0_D_V1-0/SPOT2-HRV1-XS_19920419-111842-821_L1C_039-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920419-111842-821_L1C_039-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920419-111842-821_L1C_039-263-0_D_V1-0.zip
run script
2024-01-11T01:24:18.384    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:24:18.386    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920419-111842-821_L1C_039-263-0_D_V1-0.zip
2024-01-11T01:24:18.386    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:24:18.386    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:24:18.386    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:24:18.386    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:24:18.386    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:24:18.386    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:24:18.386    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:24:18.386    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920419-111842-821_L1C_039-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/19/SPOT2-HRV1-XS_19920419-111851-264_L1C_039-264-0_D_V1-0/SPOT2-HRV1-XS_19920419-111851-264_L1C_039-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920419-111851-264_L1C_039-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920419-111851-264_L1C_039-264-0_D_V1-0.zip
run script
2024-01-11T01:25:42.644    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:25:42.645    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920419-111851-264_L1C_039-264-0_D_V1-0.zip
2024-01-11T01:25:42.645    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:25:42.646    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:25:42.646    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:25:42.646    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:25:42.646    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:25:42.646    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:25:42.646    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:25:42.646    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920419-111851-264_L1C_039-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/19/SPOT2-HRV2-XS_19920419-111848-214_L1C_041-264-0_D_V1-0/SPOT2-HRV2-XS_19920419-111848-214_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920419-111848-214_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920419-111848-214_L1C_041-264-0_D_V1-0.zip
run script
2024-01-11T01:27:45.061    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:27:45.063    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920419-111848-214_L1C_041-264-0_D_V1-0.zip
2024-01-11T01:27:45.063    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:27:45.063    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:27:45.063    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:27:45.063    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:27:45.063    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:27:45.063    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:27:45.063    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:27:45.063    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920419-111848-214_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/24/SPOT2-HRV1-XS_19920424-112238-476_L1C_039-263-0_D_V1-0/SPOT2-HRV1-XS_19920424-112238-476_L1C_039-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920424-112238-476_L1C_039-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920424-112238-476_L1C_039-263-0_D_V1-0.zip
run script
2024-01-11T01:30:08.242    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:30:08.243    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920424-112238-476_L1C_039-263-0_D_V1-0.zip
2024-01-11T01:30:08.243    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:30:08.243    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:30:08.243    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:30:08.243    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:30:08.243    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:30:08.243    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:30:08.243    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:30:08.243    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920424-112238-476_L1C_039-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/24/SPOT2-HRV1-XS_19920424-112246-947_L1C_039-264-0_D_V1-0/SPOT2-HRV1-XS_19920424-112246-947_L1C_039-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920424-112246-947_L1C_039-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920424-112246-947_L1C_039-264-0_D_V1-0.zip
run script
2024-01-11T01:31:39.222    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:31:39.223    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920424-112246-947_L1C_039-264-0_D_V1-0.zip
2024-01-11T01:31:39.223    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:31:39.223    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:31:39.223    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:31:39.223    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:31:39.223    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:31:39.223    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:31:39.223    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:31:39.224    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920424-112246-947_L1C_039-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/24/SPOT2-HRV2-XS_19920424-112235-965_L1C_040-263-0_D_V1-0/SPOT2-HRV2-XS_19920424-112235-965_L1C_040-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920424-112235-965_L1C_040-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920424-112235-965_L1C_040-263-0_D_V1-0.zip
run script
2024-01-11T01:33:52.442    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:33:52.443    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920424-112235-965_L1C_040-263-0_D_V1-0.zip
2024-01-11T01:33:52.443    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:33:52.443    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:33:52.443    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:33:52.443    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:33:52.443    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:33:52.443    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:33:52.443    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:33:52.443    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920424-112235-965_L1C_040-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/24/SPOT2-HRV2-XS_19920424-112244-462_L1C_040-264-0_D_V1-0/SPOT2-HRV2-XS_19920424-112244-462_L1C_040-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920424-112244-462_L1C_040-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920424-112244-462_L1C_040-264-0_D_V1-0.zip
run script
2024-01-11T01:35:37.300    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:35:37.301    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920424-112244-462_L1C_040-264-0_D_V1-0.zip
2024-01-11T01:35:37.301    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:35:37.301    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:35:37.301    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:35:37.301    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:35:37.301    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:35:37.301    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:35:37.301    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:35:37.301    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920424-112244-462_L1C_040-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/07/SPOT2-HRV1-XS_19920807-110416-532_L1C_039-263-0_D_V1-0/SPOT2-HRV1-XS_19920807-110416-532_L1C_039-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920807-110416-532_L1C_039-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920807-110416-532_L1C_039-263-0_D_V1-0.zip
run script
2024-01-11T01:38:19.500    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:38:19.501    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920807-110416-532_L1C_039-263-0_D_V1-0.zip
2024-01-11T01:38:19.501    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:38:19.501    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:38:19.501    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:38:19.501    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:38:19.501    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:38:19.501    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:38:19.501    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:38:19.501    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920807-110416-532_L1C_039-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/07/SPOT2-HRV1-XS_19920807-110424-873_L1C_039-264-0_D_V1-0/SPOT2-HRV1-XS_19920807-110424-873_L1C_039-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920807-110424-873_L1C_039-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920807-110424-873_L1C_039-264-0_D_V1-0.zip
run script
2024-01-11T01:39:34.912    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:39:34.913    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920807-110424-873_L1C_039-264-0_D_V1-0.zip
2024-01-11T01:39:34.913    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:39:34.913    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:39:34.913    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:39:34.913    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:39:34.913    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:39:34.913    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:39:34.913    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:39:34.913    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920807-110424-873_L1C_039-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/07/SPOT2-HRV2-XS_19920807-110414-685_L1C_040-263-0_D_V1-0/SPOT2-HRV2-XS_19920807-110414-685_L1C_040-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920807-110414-685_L1C_040-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920807-110414-685_L1C_040-263-0_D_V1-0.zip
run script
2024-01-11T01:41:19.450    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:41:19.451    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920807-110414-685_L1C_040-263-0_D_V1-0.zip
2024-01-11T01:41:19.451    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:41:19.451    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:41:19.451    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:41:19.451    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:41:19.451    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:41:19.452    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:41:19.452    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:41:19.452    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920807-110414-685_L1C_040-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/07/SPOT2-HRV2-XS_19920807-110423-041_L1C_040-264-0_D_V1-0/SPOT2-HRV2-XS_19920807-110423-041_L1C_040-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920807-110423-041_L1C_040-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920807-110423-041_L1C_040-264-0_D_V1-0.zip
run script
2024-01-11T01:42:42.805    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:42:42.806    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920807-110423-041_L1C_040-264-0_D_V1-0.zip
2024-01-11T01:42:42.806    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:42:42.806    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:42:42.806    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:42:42.806    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:42:42.806    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:42:42.807    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:42:42.807    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:42:42.807    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920807-110423-041_L1C_040-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/06/16/SPOT2-HRV2-XS_19920616-110359-547_L1C_039-264-1_D_V1-0/SPOT2-HRV2-XS_19920616-110359-547_L1C_039-264-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920616-110359-547_L1C_039-264-1_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920616-110359-547_L1C_039-264-1_D_V1-0.zip
run script
2024-01-11T01:44:33.083    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:44:33.084    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920616-110359-547_L1C_039-264-1_D_V1-0.zip
2024-01-11T01:44:33.084    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:44:33.084    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:44:33.084    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:44:33.084    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:44:33.084    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:44:33.084    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:44:33.084    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:44:33.084    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920616-110359-547_L1C_039-264-1_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/01/SPOT2-HRV2-XS_19920801-111937-807_L1C_040-263-0_D_V1-0/SPOT2-HRV2-XS_19920801-111937-807_L1C_040-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920801-111937-807_L1C_040-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920801-111937-807_L1C_040-263-0_D_V1-0.zip
run script
2024-01-11T01:46:17.152    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:46:17.153    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920801-111937-807_L1C_040-263-0_D_V1-0.zip
2024-01-11T01:46:17.153    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:46:17.153    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:46:17.153    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:46:17.153    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:46:17.154    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:46:17.154    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:46:17.154    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:46:17.154    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920801-111937-807_L1C_040-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/01/SPOT2-HRV2-XS_19920801-111946-272_L1C_040-264-0_D_V1-0/SPOT2-HRV2-XS_19920801-111946-272_L1C_040-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920801-111946-272_L1C_040-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920801-111946-272_L1C_040-264-0_D_V1-0.zip
run script
2024-01-11T01:47:58.272    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:47:58.273    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920801-111946-272_L1C_040-264-0_D_V1-0.zip
2024-01-11T01:47:58.273    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:47:58.273    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:47:58.273    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:47:58.273    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:47:58.273    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:47:58.273    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:47:58.274    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:47:58.274    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920801-111946-272_L1C_040-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/02/SPOT2-HRV1-XS_19920802-110021-365_L1C_040-263-0_D_V1-0/SPOT2-HRV1-XS_19920802-110021-365_L1C_040-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920802-110021-365_L1C_040-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920802-110021-365_L1C_040-263-0_D_V1-0.zip
run script
2024-01-11T01:50:30.159    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:50:30.160    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920802-110021-365_L1C_040-263-0_D_V1-0.zip
2024-01-11T01:50:30.160    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:50:30.160    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:50:30.160    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:50:30.160    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:50:30.160    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:50:30.160    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:50:30.160    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:50:30.161    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920802-110021-365_L1C_040-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/02/SPOT2-HRV1-XS_19920802-110029-700_L1C_040-264-0_D_V1-0/SPOT2-HRV1-XS_19920802-110029-700_L1C_040-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920802-110029-700_L1C_040-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920802-110029-700_L1C_040-264-0_D_V1-0.zip
run script
2024-01-11T01:51:51.118    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:51:51.119    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920802-110029-700_L1C_040-264-0_D_V1-0.zip
2024-01-11T01:51:51.119    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:51:51.119    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:51:51.119    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:51:51.119    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:51:51.119    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:51:51.119    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:51:51.120    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:51:51.120    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920802-110029-700_L1C_040-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/02/SPOT2-HRV2-XS_19920802-110021-188_L1C_047-264-0_D_V1-0/SPOT2-HRV2-XS_19920802-110021-188_L1C_047-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920802-110021-188_L1C_047-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920802-110021-188_L1C_047-264-0_D_V1-0.zip
run script
2024-01-11T01:53:32.105    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:53:32.106    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920802-110021-188_L1C_047-264-0_D_V1-0.zip
2024-01-11T01:53:32.106    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:53:32.106    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:53:32.106    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:53:32.106    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:53:32.106    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:53:32.106    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:53:32.106    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:53:32.106    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920802-110021-188_L1C_047-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/02/SPOT2-HRV2-XS_19920802-110029-604_L1C_047-265-0_D_V1-0/SPOT2-HRV2-XS_19920802-110029-604_L1C_047-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920802-110029-604_L1C_047-265-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920802-110029-604_L1C_047-265-0_D_V1-0.zip
run script
2024-01-11T01:53:57.581    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:53:57.582    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920802-110029-604_L1C_047-265-0_D_V1-0.zip
2024-01-11T01:53:57.582    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:53:57.582    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:53:57.582    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:53:57.582    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:53:57.582    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:53:57.583    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:53:57.583    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:53:57.583    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920802-110029-604_L1C_047-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/06/SPOT2-HRV1-XS_19920806-112330-581_L1C_040-263-0_D_V1-0/SPOT2-HRV1-XS_19920806-112330-581_L1C_040-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920806-112330-581_L1C_040-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920806-112330-581_L1C_040-263-0_D_V1-0.zip
run script
2024-01-11T01:54:11.707    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:54:11.707    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920806-112330-581_L1C_040-263-0_D_V1-0.zip
2024-01-11T01:54:11.707    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:54:11.707    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:54:11.707    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:54:11.708    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:54:11.708    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:54:11.708    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:54:11.708    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:54:11.708    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920806-112330-581_L1C_040-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/06/SPOT2-HRV1-XS_19920806-112339-082_L1C_040-264-0_D_V1-0/SPOT2-HRV1-XS_19920806-112339-082_L1C_040-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920806-112339-082_L1C_040-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920806-112339-082_L1C_040-264-0_D_V1-0.zip
run script
2024-01-11T01:55:57.144    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:55:57.146    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920806-112339-082_L1C_040-264-0_D_V1-0.zip
2024-01-11T01:55:57.146    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:55:57.146    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:55:57.146    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:55:57.146    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:55:57.146    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:55:57.146    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:55:57.146    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:55:57.146    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920806-112339-082_L1C_040-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/09/01/SPOT2-HRV2-XS_19920901-112340-848_L1C_040-263-6_D_V1-0/SPOT2-HRV2-XS_19920901-112340-848_L1C_040-263-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920901-112340-848_L1C_040-263-6_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920901-112340-848_L1C_040-263-6_D_V1-0.zip
run script
2024-01-11T01:58:38.330    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T01:58:38.331    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920901-112340-848_L1C_040-263-6_D_V1-0.zip
2024-01-11T01:58:38.331    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T01:58:38.331    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T01:58:38.331    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T01:58:38.331    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T01:58:38.331    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T01:58:38.331    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T01:58:38.331    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T01:58:38.331    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920901-112340-848_L1C_040-263-6_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/09/01/SPOT2-HRV2-XS_19920901-112343-922_L1C_040-264-0_D_V1-0/SPOT2-HRV2-XS_19920901-112343-922_L1C_040-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920901-112343-922_L1C_040-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920901-112343-922_L1C_040-264-0_D_V1-0.zip
run script
2024-01-11T02:01:20.976    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:01:20.977    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920901-112343-922_L1C_040-264-0_D_V1-0.zip
2024-01-11T02:01:20.977    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:01:20.978    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:01:20.978    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:01:20.978    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:01:20.978    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:01:20.978    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:01:20.978    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:01:20.978    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920901-112343-922_L1C_040-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/01/18/SPOT2-HRV2-XS_19920118-104814-004_L1C_040-264-0_D_V1-0/SPOT2-HRV2-XS_19920118-104814-004_L1C_040-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920118-104814-004_L1C_040-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920118-104814-004_L1C_040-264-0_D_V1-0.zip
run script
2024-01-11T02:03:49.899    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:03:49.901    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920118-104814-004_L1C_040-264-0_D_V1-0.zip
2024-01-11T02:03:49.901    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:03:49.901    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:03:49.901    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:03:49.901    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:03:49.901    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:03:49.901    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:03:49.901    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:03:49.901    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920118-104814-004_L1C_040-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/03/19/SPOT2-HRV2-XS_19920319-111457-032_L1C_041-263-0_D_V1-0/SPOT2-HRV2-XS_19920319-111457-032_L1C_041-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920319-111457-032_L1C_041-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920319-111457-032_L1C_041-263-0_D_V1-0.zip
run script
2024-01-11T02:05:39.544    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:05:39.545    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920319-111457-032_L1C_041-263-0_D_V1-0.zip
2024-01-11T02:05:39.545    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:05:39.545    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:05:39.545    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:05:39.545    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:05:39.545    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:05:39.545    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:05:39.545    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:05:39.545    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920319-111457-032_L1C_041-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/03/19/SPOT2-HRV2-XS_19920319-111504-251_L1C_041-263-8_D_V1-0/SPOT2-HRV2-XS_19920319-111504-251_L1C_041-263-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920319-111504-251_L1C_041-263-8_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920319-111504-251_L1C_041-263-8_D_V1-0.zip
run script
2024-01-11T02:07:14.600    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:07:14.602    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920319-111504-251_L1C_041-263-8_D_V1-0.zip
2024-01-11T02:07:14.602    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:07:14.602    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:07:14.602    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:07:14.602    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:07:14.602    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:07:14.602    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:07:14.602    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:07:14.602    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920319-111504-251_L1C_041-263-8_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/03/31/SPOT2-HRV1-XS_19920331-104354-293_L1C_041-263-0_D_V1-0/SPOT2-HRV1-XS_19920331-104354-293_L1C_041-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920331-104354-293_L1C_041-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920331-104354-293_L1C_041-263-0_D_V1-0.zip
run script
2024-01-11T02:09:29.482    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:09:29.483    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920331-104354-293_L1C_041-263-0_D_V1-0.zip
2024-01-11T02:09:29.483    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:09:29.483    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:09:29.484    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:09:29.484    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:09:29.484    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:09:29.484    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:09:29.484    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:09:29.484    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920331-104354-293_L1C_041-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/03/31/SPOT2-HRV1-XS_19920331-104402-575_L1C_041-264-0_D_V1-0/SPOT2-HRV1-XS_19920331-104402-575_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920331-104402-575_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920331-104402-575_L1C_041-264-0_D_V1-0.zip
run script
2024-01-11T02:10:54.574    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:10:54.576    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920331-104402-575_L1C_041-264-0_D_V1-0.zip
2024-01-11T02:10:54.576    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:10:54.576    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:10:54.576    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:10:54.576    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:10:54.576    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:10:54.576    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:10:54.576    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:10:54.576    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920331-104402-575_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/20/SPOT2-HRV1-XS_19920420-105923-412_L1C_041-263-0_D_V1-0/SPOT2-HRV1-XS_19920420-105923-412_L1C_041-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920420-105923-412_L1C_041-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920420-105923-412_L1C_041-263-0_D_V1-0.zip
run script
2024-01-11T02:12:56.262    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:12:56.263    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920420-105923-412_L1C_041-263-0_D_V1-0.zip
2024-01-11T02:12:56.263    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:12:56.263    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:12:56.263    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:12:56.263    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:12:56.263    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:12:56.263    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:12:56.263    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:12:56.263    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920420-105923-412_L1C_041-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/20/SPOT2-HRV1-XS_19920420-105930-631_L1C_041-263-8_D_V1-0/SPOT2-HRV1-XS_19920420-105930-631_L1C_041-263-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920420-105930-631_L1C_041-263-8_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920420-105930-631_L1C_041-263-8_D_V1-0.zip
run script
2024-01-11T02:14:16.757    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:14:16.759    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920420-105930-631_L1C_041-263-8_D_V1-0.zip
2024-01-11T02:14:16.759    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:14:16.759    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:14:16.759    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:14:16.759    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:14:16.759    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:14:16.759    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:14:16.759    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:14:16.759    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920420-105930-631_L1C_041-263-8_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/21/SPOT2-HRV1-XS_19920421-104004-778_L1C_041-263-0_D_V1-0/SPOT2-HRV1-XS_19920421-104004-778_L1C_041-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920421-104004-778_L1C_041-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920421-104004-778_L1C_041-263-0_D_V1-0.zip
run script
2024-01-11T02:16:08.980    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:16:08.981    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920421-104004-778_L1C_041-263-0_D_V1-0.zip
2024-01-11T02:16:08.981    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:16:08.981    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:16:08.981    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:16:08.981    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:16:08.981    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:16:08.981    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:16:08.981    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:16:08.982    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920421-104004-778_L1C_041-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/21/SPOT2-HRV1-XS_19920421-104013-053_L1C_041-264-0_D_V1-0/SPOT2-HRV1-XS_19920421-104013-053_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920421-104013-053_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920421-104013-053_L1C_041-264-0_D_V1-0.zip
run script
2024-01-11T02:17:38.661    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:17:38.662    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920421-104013-053_L1C_041-264-0_D_V1-0.zip
2024-01-11T02:17:38.662    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:17:38.662    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:17:38.662    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:17:38.662    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:17:38.663    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:17:38.663    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:17:38.663    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:17:38.663    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920421-104013-053_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/21/SPOT2-HRV2-XS_19920421-104000-949_L1C_045-263-0_D_V1-0/SPOT2-HRV2-XS_19920421-104000-949_L1C_045-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920421-104000-949_L1C_045-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920421-104000-949_L1C_045-263-0_D_V1-0.zip
run script
2024-01-11T02:19:49.945    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:19:49.946    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920421-104000-949_L1C_045-263-0_D_V1-0.zip
2024-01-11T02:19:49.946    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:19:49.946    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:19:49.946    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:19:49.946    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:19:49.947    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:19:49.947    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:19:49.947    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:19:49.947    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920421-104000-949_L1C_045-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/21/SPOT2-HRV2-XS_19920421-104009-242_L1C_045-264-0_D_V1-0/SPOT2-HRV2-XS_19920421-104009-242_L1C_045-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920421-104009-242_L1C_045-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920421-104009-242_L1C_045-264-0_D_V1-0.zip
run script
2024-01-11T02:21:02.985    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:21:02.986    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920421-104009-242_L1C_045-264-0_D_V1-0.zip
2024-01-11T02:21:02.986    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:21:02.986    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:21:02.986    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:21:02.986    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:21:02.986    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:21:02.986    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:21:02.986    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:21:02.986    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920421-104009-242_L1C_045-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/21/SPOT2-HRV2-XS_19920421-104017-544_L1C_045-265-0_D_V1-0/SPOT2-HRV2-XS_19920421-104017-544_L1C_045-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920421-104017-544_L1C_045-265-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920421-104017-544_L1C_045-265-0_D_V1-0.zip
run script
2024-01-11T02:22:39.467    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:22:39.467    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920421-104017-544_L1C_045-265-0_D_V1-0.zip
2024-01-11T02:22:39.467    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:22:39.467    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:22:39.467    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:22:39.467    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:22:39.467    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:22:39.467    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:22:39.467    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:22:39.467    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-11T02:22:40.911    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (112 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920421-104017-544_L1C_045-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1992/04/26/SPOT2-HRV1-XS_19920426-104400-631_L1C_041-263-0_D_V1-0/SPOT2-HRV1-XS_19920426-104400-631_L1C_041-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920426-104400-631_L1C_041-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920426-104400-631_L1C_041-263-0_D_V1-0.zip
run script
2024-01-11T02:22:43.818    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:22:43.818    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920426-104400-631_L1C_041-263-0_D_V1-0.zip
2024-01-11T02:22:43.818    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:22:43.818    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:22:43.818    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:22:43.818    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:22:43.818    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:22:43.818    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:22:43.818    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:22:43.818    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920426-104400-631_L1C_041-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/26/SPOT2-HRV1-XS_19920426-104408-915_L1C_041-264-0_D_V1-0/SPOT2-HRV1-XS_19920426-104408-915_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920426-104408-915_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920426-104408-915_L1C_041-264-0_D_V1-0.zip
run script
2024-01-11T02:24:10.816    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:24:10.817    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920426-104408-915_L1C_041-264-0_D_V1-0.zip
2024-01-11T02:24:10.817    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:24:10.817    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:24:10.817    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:24:10.817    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:24:10.817    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:24:10.818    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:24:10.818    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:24:10.818    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920426-104408-915_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/26/SPOT2-HRV2-XS_19920426-104356-823_L1C_045-263-0_D_V1-0/SPOT2-HRV2-XS_19920426-104356-823_L1C_045-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920426-104356-823_L1C_045-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920426-104356-823_L1C_045-263-0_D_V1-0.zip
run script
2024-01-11T02:26:15.036    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:26:15.036    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920426-104356-823_L1C_045-263-0_D_V1-0.zip
2024-01-11T02:26:15.036    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:26:15.036    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:26:15.036    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:26:15.037    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:26:15.037    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:26:15.037    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:26:15.037    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:26:15.037    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920426-104356-823_L1C_045-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/26/SPOT2-HRV2-XS_19920426-104405-128_L1C_045-264-0_D_V1-0/SPOT2-HRV2-XS_19920426-104405-128_L1C_045-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920426-104405-128_L1C_045-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920426-104405-128_L1C_045-264-0_D_V1-0.zip
run script
2024-01-11T02:27:26.036    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:27:26.036    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920426-104405-128_L1C_045-264-0_D_V1-0.zip
2024-01-11T02:27:26.037    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:27:26.037    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:27:26.037    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:27:26.037    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:27:26.037    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:27:26.037    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:27:26.037    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:27:26.037    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920426-104405-128_L1C_045-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/26/SPOT2-HRV2-XS_19920426-104413-442_L1C_045-265-0_D_V1-0/SPOT2-HRV2-XS_19920426-104413-442_L1C_045-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920426-104413-442_L1C_045-265-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920426-104413-442_L1C_045-265-0_D_V1-0.zip
run script
2024-01-11T02:28:57.187    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:28:57.188    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920426-104413-442_L1C_045-265-0_D_V1-0.zip
2024-01-11T02:28:57.188    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:28:57.188    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:28:57.188    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:28:57.188    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:28:57.188    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:28:57.188    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:28:57.188    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:28:57.188    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920426-104413-442_L1C_045-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/05/15/SPOT2-HRV2-XS_19920515-111900-628_L1C_041-263-0_D_V1-0/SPOT2-HRV2-XS_19920515-111900-628_L1C_041-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920515-111900-628_L1C_041-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920515-111900-628_L1C_041-263-0_D_V1-0.zip
run script
2024-01-11T02:29:27.026    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:29:27.026    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920515-111900-628_L1C_041-263-0_D_V1-0.zip
2024-01-11T02:29:27.026    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:29:27.026    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:29:27.026    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:29:27.026    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:29:27.026    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:29:27.026    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:29:27.026    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:29:27.026    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920515-111900-628_L1C_041-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/05/15/SPOT2-HRV2-XS_19920515-111909-105_L1C_041-264-0_D_V1-0/SPOT2-HRV2-XS_19920515-111909-105_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920515-111909-105_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920515-111909-105_L1C_041-264-0_D_V1-0.zip
run script
2024-01-11T02:31:10.628    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:31:10.629    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920515-111909-105_L1C_041-264-0_D_V1-0.zip
2024-01-11T02:31:10.629    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:31:10.629    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:31:10.630    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:31:10.630    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:31:10.630    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:31:10.630    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:31:10.630    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:31:10.630    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920515-111909-105_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/05/17/SPOT2-HRV1-XS_19920517-104025-029_L1C_041-263-0_D_V1-0/SPOT2-HRV1-XS_19920517-104025-029_L1C_041-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920517-104025-029_L1C_041-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920517-104025-029_L1C_041-263-0_D_V1-0.zip
run script
2024-01-11T02:33:38.694    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:33:38.695    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920517-104025-029_L1C_041-263-0_D_V1-0.zip
2024-01-11T02:33:38.696    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:33:38.696    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:33:38.696    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:33:38.696    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:33:38.696    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:33:38.696    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:33:38.696    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:33:38.696    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920517-104025-029_L1C_041-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 0 2 2]
 [2 2 2 ... 0 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/05/17/SPOT2-HRV1-XS_19920517-104033-304_L1C_042-264-0_D_V1-0/SPOT2-HRV1-XS_19920517-104033-304_L1C_042-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920517-104033-304_L1C_042-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920517-104033-304_L1C_042-264-0_D_V1-0.zip
run script
2024-01-11T02:35:08.340    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:35:08.341    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920517-104033-304_L1C_042-264-0_D_V1-0.zip
2024-01-11T02:35:08.341    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:35:08.341    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:35:08.341    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:35:08.341    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:35:08.341    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:35:08.341    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:35:08.341    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:35:08.341    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920517-104033-304_L1C_042-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/05/17/SPOT2-HRV2-XS_19920517-104023-826_L1C_043-263-0_D_V1-0/SPOT2-HRV2-XS_19920517-104023-826_L1C_043-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920517-104023-826_L1C_043-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920517-104023-826_L1C_043-263-0_D_V1-0.zip
run script
2024-01-11T02:37:13.568    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:37:13.569    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920517-104023-826_L1C_043-263-0_D_V1-0.zip
2024-01-11T02:37:13.569    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:37:13.569    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:37:13.569    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:37:13.569    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:37:13.569    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:37:13.569    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:37:13.569    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:37:13.569    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920517-104023-826_L1C_043-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/05/17/SPOT2-HRV2-XS_19920517-104032-107_L1C_043-264-0_D_V1-0/SPOT2-HRV2-XS_19920517-104032-107_L1C_043-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920517-104032-107_L1C_043-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920517-104032-107_L1C_043-264-0_D_V1-0.zip
run script
2024-01-11T02:38:38.439    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:38:38.439    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920517-104032-107_L1C_043-264-0_D_V1-0.zip
2024-01-11T02:38:38.439    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:38:38.439    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:38:38.439    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:38:38.439    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:38:38.440    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:38:38.440    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:38:38.440    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:38:38.440    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920517-104032-107_L1C_043-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/06/26/SPOT2-HRV1-XS_19920626-111131-909_L1C_041-263-0_D_V1-0/SPOT2-HRV1-XS_19920626-111131-909_L1C_041-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920626-111131-909_L1C_041-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920626-111131-909_L1C_041-263-0_D_V1-0.zip
run script
2024-01-11T02:40:33.750    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:40:33.750    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920626-111131-909_L1C_041-263-0_D_V1-0.zip
2024-01-11T02:40:33.751    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:40:33.751    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:40:33.751    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:40:33.751    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:40:33.751    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:40:33.751    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:40:33.751    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:40:33.751    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920626-111131-909_L1C_041-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/06/26/SPOT2-HRV1-XS_19920626-111140-319_L1C_041-264-0_D_V1-0/SPOT2-HRV1-XS_19920626-111140-319_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920626-111140-319_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920626-111140-319_L1C_041-264-0_D_V1-0.zip
run script
2024-01-11T02:42:03.524    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:42:03.525    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920626-111140-319_L1C_041-264-0_D_V1-0.zip
2024-01-11T02:42:03.525    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:42:03.525    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:42:03.525    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:42:03.525    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:42:03.525    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:42:03.525    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:42:03.525    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:42:03.525    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920626-111140-319_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/07/02/SPOT2-HRV1-XS_19920702-105609-525_L1C_041-263-0_D_V1-0/SPOT2-HRV1-XS_19920702-105609-525_L1C_041-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920702-105609-525_L1C_041-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920702-105609-525_L1C_041-263-0_D_V1-0.zip
run script
2024-01-11T02:44:08.656    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:44:08.657    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920702-105609-525_L1C_041-263-0_D_V1-0.zip
2024-01-11T02:44:08.657    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:44:08.658    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:44:08.658    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:44:08.658    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:44:08.658    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:44:08.658    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:44:08.658    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:44:08.682    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920702-105609-525_L1C_041-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/07/02/SPOT2-HRV1-XS_19920702-105617-852_L1C_041-264-0_D_V1-0/SPOT2-HRV1-XS_19920702-105617-852_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920702-105617-852_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920702-105617-852_L1C_041-264-0_D_V1-0.zip
run script
2024-01-11T02:45:29.698    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:45:29.698    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920702-105617-852_L1C_041-264-0_D_V1-0.zip
2024-01-11T02:45:29.698    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:45:29.698    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:45:29.699    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:45:29.699    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:45:29.699    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:45:29.699    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:45:29.699    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:45:29.699    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920702-105617-852_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/09/07/SPOT2-HRV2-XS_19920907-110811-334_L1C_041-263-0_D_V1-0/SPOT2-HRV2-XS_19920907-110811-334_L1C_041-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920907-110811-334_L1C_041-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920907-110811-334_L1C_041-263-0_D_V1-0.zip
run script
2024-01-11T02:47:22.445    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:47:22.446    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920907-110811-334_L1C_041-263-0_D_V1-0.zip
2024-01-11T02:47:22.446    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:47:22.446    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:47:22.447    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:47:22.447    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:47:22.447    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:47:22.447    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:47:22.447    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:47:22.447    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920907-110811-334_L1C_041-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/09/07/SPOT2-HRV2-XS_19920907-110819-726_L1C_041-264-0_D_V1-0/SPOT2-HRV2-XS_19920907-110819-726_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920907-110819-726_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920907-110819-726_L1C_041-264-0_D_V1-0.zip
run script
2024-01-11T02:48:49.480    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:48:49.481    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920907-110819-726_L1C_041-264-0_D_V1-0.zip
2024-01-11T02:48:49.481    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:48:49.481    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:48:49.481    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:48:49.481    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:48:49.481    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:48:49.481    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:48:49.481    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:48:49.481    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920907-110819-726_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/09/07/SPOT2-HRV2-XS_19920907-110820-628_L1C_041-264-1_D_V1-0/SPOT2-HRV2-XS_19920907-110820-628_L1C_041-264-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920907-110820-628_L1C_041-264-1_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920907-110820-628_L1C_041-264-1_D_V1-0.zip
run script
2024-01-11T02:50:50.142    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:50:50.143    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920907-110820-628_L1C_041-264-1_D_V1-0.zip
2024-01-11T02:50:50.143    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:50:50.143    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:50:50.143    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:50:50.143    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:50:50.143    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:50:50.143    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:50:50.143    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:50:50.143    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920907-110820-628_L1C_041-264-1_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/10/18/SPOT2-HRV1-XS_19921018-111958-651_L1C_041-263-0_D_V1-0/SPOT2-HRV1-XS_19921018-111958-651_L1C_041-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19921018-111958-651_L1C_041-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19921018-111958-651_L1C_041-263-0_D_V1-0.zip
run script
2024-01-11T02:52:52.902    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:52:52.902    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19921018-111958-651_L1C_041-263-0_D_V1-0.zip
2024-01-11T02:52:52.902    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:52:52.902    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:52:52.903    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:52:52.903    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:52:52.903    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:52:52.903    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:52:52.903    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:52:52.903    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19921018-111958-651_L1C_041-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/10/18/SPOT2-HRV1-XS_19921018-112007-128_L1C_041-264-0_D_V1-0/SPOT2-HRV1-XS_19921018-112007-128_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19921018-112007-128_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19921018-112007-128_L1C_041-264-0_D_V1-0.zip
run script
2024-01-11T02:54:35.411    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:54:35.412    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19921018-112007-128_L1C_041-264-0_D_V1-0.zip
2024-01-11T02:54:35.412    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:54:35.412    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:54:35.412    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:54:35.412    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:54:35.412    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:54:35.412    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:54:35.412    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:54:35.412    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19921018-112007-128_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/10/18/SPOT2-HRV2-XS_19921018-112005-028_L1C_043-264-0_D_V1-0/SPOT2-HRV2-XS_19921018-112005-028_L1C_043-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19921018-112005-028_L1C_043-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19921018-112005-028_L1C_043-264-0_D_V1-0.zip
run script
2024-01-11T02:57:02.322    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:57:02.323    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19921018-112005-028_L1C_043-264-0_D_V1-0.zip
2024-01-11T02:57:02.323    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:57:02.323    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:57:02.323    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:57:02.323    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:57:02.323    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:57:02.323    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:57:02.323    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:57:02.323    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19921018-112005-028_L1C_043-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/07/17/SPOT2-HRV2-XS_19920717-110803-627_L1C_041-264-0_D_V1-0/SPOT2-HRV2-XS_19920717-110803-627_L1C_041-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920717-110803-627_L1C_041-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920717-110803-627_L1C_041-264-0_D_V1-0.zip
run script
2024-01-11T02:59:32.600    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T02:59:32.601    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920717-110803-627_L1C_041-264-0_D_V1-0.zip
2024-01-11T02:59:32.601    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T02:59:32.601    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T02:59:32.601    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T02:59:32.601    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T02:59:32.601    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T02:59:32.601    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T02:59:32.602    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T02:59:32.602    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920717-110803-627_L1C_041-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/07/28/SPOT2-HRV1-XS_19920728-105623-671_L1C_042-262-8_D_V1-0/SPOT2-HRV1-XS_19920728-105623-671_L1C_042-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920728-105623-671_L1C_042-262-8_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920728-105623-671_L1C_042-262-8_D_V1-0.zip
run script
2024-01-11T03:01:34.798    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T03:01:34.799    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920728-105623-671_L1C_042-262-8_D_V1-0.zip
2024-01-11T03:01:34.799    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T03:01:34.800    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T03:01:34.800    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T03:01:34.800    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T03:01:34.800    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T03:01:34.800    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T03:01:34.800    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T03:01:34.800    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920728-105623-671_L1C_042-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/02/23/SPOT2-HRV1-XS_19920223-105542-472_L1C_042-263-0_D_V1-0/SPOT2-HRV1-XS_19920223-105542-472_L1C_042-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920223-105542-472_L1C_042-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920223-105542-472_L1C_042-263-0_D_V1-0.zip
run script
2024-01-11T03:02:40.406    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T03:02:40.406    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920223-105542-472_L1C_042-263-0_D_V1-0.zip
2024-01-11T03:02:40.406    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T03:02:40.406    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T03:02:40.406    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T03:02:40.406    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T03:02:40.406    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T03:02:40.406    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T03:02:40.407    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T03:02:40.407    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-11T03:03:49.758    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (626 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920223-105542-472_L1C_042-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1992/02/23/SPOT2-HRV1-XS_19920223-105546-082_L1C_042-263-4_D_V1-0/SPOT2-HRV1-XS_19920223-105546-082_L1C_042-263-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19920223-105546-082_L1C_042-263-4_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920223-105546-082_L1C_042-263-4_D_V1-0.zip
run script
2024-01-11T03:03:52.663    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T03:03:52.663    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920223-105546-082_L1C_042-263-4_D_V1-0.zip
2024-01-11T03:03:52.663    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T03:03:52.664    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T03:03:52.664    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T03:03:52.664    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T03:03:52.664    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T03:03:52.664    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T03:03:52.664    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T03:03:52.664    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19920223-105546-082_L1C_042-263-4_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/07/22/SPOT2-HRV2-XS_19920722-111145-674_L1C_043-262-8_D_V1-0/SPOT2-HRV2-XS_19920722-111145-674_L1C_043-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920722-111145-674_L1C_043-262-8_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920722-111145-674_L1C_043-262-8_D_V1-0.zip
run script
2024-01-11T03:05:26.822    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T03:05:26.823    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920722-111145-674_L1C_043-262-8_D_V1-0.zip
2024-01-11T03:05:26.824    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T03:05:26.824    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T03:05:26.824    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T03:05:26.824    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T03:05:26.824    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T03:05:26.824    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T03:05:26.824    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T03:05:26.824    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920722-111145-674_L1C_043-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/07/22/SPOT2-HRV2-XS_19920722-111155-333_L1C_043-264-0_D_V1-0/SPOT2-HRV2-XS_19920722-111155-333_L1C_043-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920722-111155-333_L1C_043-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920722-111155-333_L1C_043-264-0_D_V1-0.zip
run script
2024-01-11T03:06:45.079    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T03:06:45.080    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920722-111155-333_L1C_043-264-0_D_V1-0.zip
2024-01-11T03:06:45.080    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T03:06:45.080    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T03:06:45.080    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T03:06:45.080    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T03:06:45.080    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T03:06:45.080    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T03:06:45.080    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T03:06:45.080    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920722-111155-333_L1C_043-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/02/29/SPOT2-HRV2-XS_19920229-104007-703_L1C_043-263-0_D_V1-0/SPOT2-HRV2-XS_19920229-104007-703_L1C_043-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920229-104007-703_L1C_043-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920229-104007-703_L1C_043-263-0_D_V1-0.zip
run script
2024-01-11T03:08:51.481    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T03:08:51.481    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920229-104007-703_L1C_043-263-0_D_V1-0.zip
2024-01-11T03:08:51.481    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T03:08:51.482    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T03:08:51.482    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T03:08:51.482    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T03:08:51.482    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T03:08:51.482    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T03:08:51.482    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T03:08:51.482    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920229-104007-703_L1C_043-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/02/29/SPOT2-HRV2-XS_19920229-104015-984_L1C_043-264-0_D_V1-0/SPOT2-HRV2-XS_19920229-104015-984_L1C_043-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920229-104015-984_L1C_043-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920229-104015-984_L1C_043-264-0_D_V1-0.zip
run script
2024-01-11T03:10:15.307    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T03:10:15.308    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920229-104015-984_L1C_043-264-0_D_V1-0.zip
2024-01-11T03:10:15.308    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T03:10:15.308    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T03:10:15.308    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T03:10:15.309    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T03:10:15.309    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T03:10:15.309    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T03:10:15.309    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T03:10:15.309    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920229-104015-984_L1C_043-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/10/20/SPOT2-HRV1-XS_19921020-104127-867_L1C_043-263-7_D_V1-0/SPOT2-HRV1-XS_19921020-104127-867_L1C_043-263-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19921020-104127-867_L1C_043-263-7_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19921020-104127-867_L1C_043-263-7_D_V1-0.zip
run script
2024-01-11T03:12:07.658    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T03:12:07.659    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19921020-104127-867_L1C_043-263-7_D_V1-0.zip
2024-01-11T03:12:07.659    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T03:12:07.659    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T03:12:07.659    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T03:12:07.659    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T03:12:07.659    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T03:12:07.659    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T03:12:07.659    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T03:12:07.659    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV1-XS_19921020-104127-867_L1C_043-263-7_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/10/20/SPOT2-HRV2-XS_19921020-104127-058_L1C_044-263-8_D_V1-0/SPOT2-HRV2-XS_19921020-104127-058_L1C_044-263-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19921020-104127-058_L1C_044-263-8_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19921020-104127-058_L1C_044-263-8_D_V1-0.zip
run script
2024-01-11T03:13:58.723    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T03:13:58.724    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19921020-104127-058_L1C_044-263-8_D_V1-0.zip
2024-01-11T03:13:58.724    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T03:13:58.724    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T03:13:58.724    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T03:13:58.724    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T03:13:58.724    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T03:13:58.724    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T03:13:58.724    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T03:13:58.724    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19921020-104127-058_L1C_044-263-8_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/10/20/SPOT2-HRV2-XS_19921020-104128-126_L1C_044-264-0_D_V1-0/SPOT2-HRV2-XS_19921020-104128-126_L1C_044-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19921020-104128-126_L1C_044-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19921020-104128-126_L1C_044-264-0_D_V1-0.zip
run script
2024-01-11T03:15:45.938    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T03:15:45.939    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19921020-104128-126_L1C_044-264-0_D_V1-0.zip
2024-01-11T03:15:45.939    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T03:15:45.939    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T03:15:45.939    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T03:15:45.939    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T03:15:45.940    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T03:15:45.940    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T03:15:45.940    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T03:15:45.940    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19921020-104128-126_L1C_044-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/30/SPOT2-HRV2-XS_19920430-110708-229_L1C_044-263-0_D_V1-0/SPOT2-HRV2-XS_19920430-110708-229_L1C_044-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920430-110708-229_L1C_044-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920430-110708-229_L1C_044-263-0_D_V1-0.zip
run script
2024-01-11T03:17:32.778    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T03:17:32.779    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920430-110708-229_L1C_044-263-0_D_V1-0.zip
2024-01-11T03:17:32.779    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T03:17:32.779    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T03:17:32.779    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T03:17:32.779    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T03:17:32.779    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T03:17:32.779    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T03:17:32.779    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T03:17:32.779    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920430-110708-229_L1C_044-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/30/SPOT2-HRV2-XS_19920430-110716-663_L1C_044-264-0_D_V1-0/SPOT2-HRV2-XS_19920430-110716-663_L1C_044-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920430-110716-663_L1C_044-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920430-110716-663_L1C_044-264-0_D_V1-0.zip
run script
2024-01-11T03:18:53.461    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T03:18:53.462    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920430-110716-663_L1C_044-264-0_D_V1-0.zip
2024-01-11T03:18:53.462    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T03:18:53.462    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T03:18:53.463    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T03:18:53.463    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T03:18:53.463    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T03:18:53.463    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T03:18:53.463    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T03:18:53.463    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920430-110716-663_L1C_044-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/04/30/SPOT2-HRV2-XS_19920430-110725-104_L1C_044-265-0_D_V1-0/SPOT2-HRV2-XS_19920430-110725-104_L1C_044-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920430-110725-104_L1C_044-265-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920430-110725-104_L1C_044-265-0_D_V1-0.zip
run script
2024-01-11T03:20:52.440    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T03:20:52.441    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920430-110725-104_L1C_044-265-0_D_V1-0.zip
2024-01-11T03:20:52.441    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T03:20:52.441    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T03:20:52.442    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T03:20:52.442    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T03:20:52.442    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T03:20:52.442    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T03:20:52.442    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T03:20:52.442    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920430-110725-104_L1C_044-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/28/SPOT2-HRV2-XS_19920828-110021-625_L1C_044-263-0_D_V1-0/SPOT2-HRV2-XS_19920828-110021-625_L1C_044-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920828-110021-625_L1C_044-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920828-110021-625_L1C_044-263-0_D_V1-0.zip
run script
2024-01-11T03:21:28.622    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T03:21:28.623    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920828-110021-625_L1C_044-263-0_D_V1-0.zip
2024-01-11T03:21:28.623    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T03:21:28.623    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T03:21:28.623    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T03:21:28.623    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T03:21:28.623    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T03:21:28.623    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T03:21:28.623    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T03:21:28.623    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920828-110021-625_L1C_044-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/08/28/SPOT2-HRV2-XS_19920828-110027-941_L1C_044-263-7_D_V1-0/SPOT2-HRV2-XS_19920828-110027-941_L1C_044-263-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920828-110027-941_L1C_044-263-7_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920828-110027-941_L1C_044-263-7_D_V1-0.zip
run script
2024-01-11T03:22:41.332    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T03:22:41.333    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920828-110027-941_L1C_044-263-7_D_V1-0.zip
2024-01-11T03:22:41.333    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T03:22:41.333    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T03:22:41.334    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T03:22:41.334    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T03:22:41.334    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T03:22:41.334    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T03:22:41.334    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T03:22:41.334    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920828-110027-941_L1C_044-263-7_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/09/13/SPOT2-HRV2-XS_19920913-105243-913_L1C_044-263-0_D_V1-0/SPOT2-HRV2-XS_19920913-105243-913_L1C_044-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920913-105243-913_L1C_044-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920913-105243-913_L1C_044-263-0_D_V1-0.zip
run script
2024-01-11T03:24:21.478    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T03:24:21.479    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920913-105243-913_L1C_044-263-0_D_V1-0.zip
2024-01-11T03:24:21.479    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T03:24:21.479    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T03:24:21.479    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T03:24:21.479    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T03:24:21.479    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T03:24:21.479    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T03:24:21.479    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T03:24:21.479    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920913-105243-913_L1C_044-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 0 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/09/13/SPOT2-HRV2-XS_19920913-105252-252_L1C_044-264-0_D_V1-0/SPOT2-HRV2-XS_19920913-105252-252_L1C_044-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920913-105252-252_L1C_044-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920913-105252-252_L1C_044-264-0_D_V1-0.zip
run script
2024-01-11T03:25:31.178    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T03:25:31.179    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920913-105252-252_L1C_044-264-0_D_V1-0.zip
2024-01-11T03:25:31.179    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T03:25:31.179    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T03:25:31.179    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T03:25:31.179    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T03:25:31.180    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T03:25:31.180    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T03:25:31.180    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T03:25:31.180    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-11T03:25:33.296    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (213 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920913-105252-252_L1C_044-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1992/09/13/SPOT2-HRV2-XS_19920913-105300-596_L1C_045-265-0_D_V1-0/SPOT2-HRV2-XS_19920913-105300-596_L1C_045-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920913-105300-596_L1C_045-265-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920913-105300-596_L1C_045-265-0_D_V1-0.zip
run script
2024-01-11T03:25:36.263    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T03:25:36.263    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920913-105300-596_L1C_045-265-0_D_V1-0.zip
2024-01-11T03:25:36.263    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T03:25:36.263    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T03:25:36.263    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T03:25:36.263    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T03:25:36.263    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T03:25:36.263    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T03:25:36.263    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T03:25:36.263    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920913-105300-596_L1C_045-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/10/24/SPOT2-HRV2-XS_19921024-110431-913_L1C_044-263-0_D_V1-0/SPOT2-HRV2-XS_19921024-110431-913_L1C_044-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19921024-110431-913_L1C_044-263-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19921024-110431-913_L1C_044-263-0_D_V1-0.zip
run script
2024-01-11T03:26:05.881    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T03:26:05.882    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19921024-110431-913_L1C_044-263-0_D_V1-0.zip
2024-01-11T03:26:05.882    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T03:26:05.882    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T03:26:05.882    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T03:26:05.882    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T03:26:05.883    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T03:26:05.883    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T03:26:05.883    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T03:26:05.883    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19921024-110431-913_L1C_044-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/10/24/SPOT2-HRV2-XS_19921024-110440-314_L1C_044-264-0_D_V1-0/SPOT2-HRV2-XS_19921024-110440-314_L1C_044-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19921024-110440-314_L1C_044-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19921024-110440-314_L1C_044-264-0_D_V1-0.zip
run script
2024-01-11T03:27:21.021    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T03:27:21.022    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19921024-110440-314_L1C_044-264-0_D_V1-0.zip
2024-01-11T03:27:21.022    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T03:27:21.022    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T03:27:21.023    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T03:27:21.023    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T03:27:21.023    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T03:27:21.023    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T03:27:21.023    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T03:27:21.023    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19921024-110440-314_L1C_044-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/10/24/SPOT2-HRV2-XS_19921024-110448-722_L1C_044-265-0_D_V1-0/SPOT2-HRV2-XS_19921024-110448-722_L1C_044-265-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19921024-110448-722_L1C_044-265-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19921024-110448-722_L1C_044-265-0_D_V1-0.zip
run script
2024-01-11T03:29:12.105    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T03:29:12.106    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19921024-110448-722_L1C_044-265-0_D_V1-0.zip
2024-01-11T03:29:12.106    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T03:29:12.106    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T03:29:12.106    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T03:29:12.106    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T03:29:12.106    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T03:29:12.106    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T03:29:12.106    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T03:29:12.107    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19921024-110448-722_L1C_044-265-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 1 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1992/06/07/SPOT2-HRV2-XS_19920607-103648-271_L1C_044-264-0_D_V1-0/SPOT2-HRV2-XS_19920607-103648-271_L1C_044-264-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19920607-103648-271_L1C_044-264-0_D_V1-0.zip
/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920607-103648-271_L1C_044-264-0_D_V1-0.zip
run script
2024-01-11T03:29:45.604    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200
2024-01-11T03:29:45.606    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920607-103648-271_L1C_044-264-0_D_V1-0.zip
2024-01-11T03:29:45.606    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-11T03:29:45.606    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-11T03:29:45.606    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-11T03:29:45.606    INFO:run_snow_swh.py::main:model type : mtn
2024-01-11T03:29:45.606    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-11T03:29:45.606    INFO:run_snow_swh.py::main:mask inference : None
2024-01-11T03:29:45.606    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-11T03:29:45.606    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4122098/INPUT/SPOT2-HRV2-XS_19920607-103648-271_L1C_044-264-0_D_V1-0.zip', job_dir='/tmp/slurm-4122098/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/PYR/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
end
[2024-01-11 03:31:36.511971729+00:00] cnes_level2/barrouz/4122098:  Account (env) = cnes_level2
[2024-01-11 03:31:36.513312087+00:00] cnes_level2/barrouz/4122098:     User (env) = barrouz
[2024-01-11 03:31:36.514569945+00:00] cnes_level2/barrouz/4122098:        GroupId = cesbio(426000053)
[2024-01-11 03:31:36.515948653+00:00] cnes_level2/barrouz/4122098:         UserId = barrouz(9134)
[2024-01-11 03:31:36.517252071+00:00] cnes_level2/barrouz/4122098:        Account = cnes_level2
[2024-01-11 03:31:36.518596748+00:00] cnes_level2/barrouz/4122098:        Account = cnes_level2
[2024-01-11 03:31:36.519888867+00:00] cnes_level2/barrouz/4122098:      Partition = cpu2022
[2024-01-11 03:31:36.521148885+00:00] cnes_level2/barrouz/4122098:            QOS = cpu_2022_1280
[2024-01-11 03:31:36.522466933+00:00] cnes_level2/barrouz/4122098:        JobName = inf_PYR_22_TCD-ONLY_AVG-1200
[2024-01-11 03:31:36.523805341+00:00] cnes_level2/barrouz/4122098:     SubmitTime = 2024-01-10T19:48:28
[2024-01-11 03:31:36.525070419+00:00] cnes_level2/barrouz/4122098:        RunTime = 07:42:43
[2024-01-11 03:31:36.526424937+00:00] cnes_level2/barrouz/4122098:      TimeLimit = 1-16:00:00
[2024-01-11 03:31:36.527682425+00:00] cnes_level2/barrouz/4122098:   EligibleTime = 2024-01-10T19:48:28
[2024-01-11 03:31:36.528971884+00:00] cnes_level2/barrouz/4122098:      StartTime = 2024-01-10T19:48:53
[2024-01-11 03:31:36.530230902+00:00] cnes_level2/barrouz/4122098:        EndTime = 2024-01-11T03:31:36
[2024-01-11 03:31:36.531497311+00:00] cnes_level2/barrouz/4122098:       ExitCode = 0:0
[2024-01-11 03:31:36.532739559+00:00] cnes_level2/barrouz/4122098:       NodeList = trex068
[2024-01-11 03:31:36.534024748+00:00] cnes_level2/barrouz/4122098:      BatchHost = trex068
[2024-01-11 03:31:36.535210697+00:00] cnes_level2/barrouz/4122098:           TRES = 
[2024-01-11 03:31:36.536330307+00:00] cnes_level2/barrouz/4122098:        Command = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
[2024-01-11 03:31:36.537606345+00:00] cnes_level2/barrouz/4122098:        WorkDir = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code
[2024-01-11 03:31:36.538907983+00:00] cnes_level2/barrouz/4122098:         StdErr = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_PYR_22_TCD-ONLY_AVG-1200.log
[2024-01-11 03:31:36.540129202+00:00] cnes_level2/barrouz/4122098:         StdOut = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_PYR_22_TCD-ONLY_AVG-1200.log

#########################################
#        EVIDEN - CNES                  #
#        Job Accounting                 #
#########################################
Cluster              : trex
JobIDRaw             : 4122098
JobID                : 4122098
JobName              : inf_PYR_22_TCD-ONLY_AVG-1200
Account              : cnes_level2
User                 : barrouz(9134), cesbio(426000053)
Partition            : cpu2022
QOS                  : cpu_2022_1280
Nodelist             : trex068 (1)
State                : COMPLETED  (Exitcode=0:0, DerivedExitCode=0:0, Restarts=0)
Submit date          : 2024-01-10T19:48:28
Start time           : 2024-01-10T19:48:53
End time             : 2024-01-11T03:31:36
Elapsed time         : 07:42:43  (Timelimit=1-16:00:00, Suspended=00:00:00)
TEI                  : 2 days, 13:41:44
Command              : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
StdOut               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_PYR_22_TCD-ONLY_AVG-1200.log
StdErr               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_PYR_22_TCD-ONLY_AVG-1200.log

STEP(s) : 2
--------- 
   StepID  | JobName      State       Exit   Start               End                 Elapsed   TotalCPU   CPUTime    ConsumedEnergy MaxDiskRead MaxDiskWrite     MaxRSS MaxRSSTask MaxRSSNode NNodes UserCPU    NodeList
   ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 
   batch   | batch        COMPLETED   0:0    2024-01-10T19:48:53 2024-01-11T03:31:36 07:42:43  1-13:27:46 2-13:41:44          0.22M  233904.79M   106318.93M 101246484K          0    trex068      1 1-01:26:20 trex068
   extern  | extern       COMPLETED   0:0    2024-01-10T19:48:53 2024-01-11T03:31:36 07:42:43  00:00.001  2-13:41:44          0.22M       0.00M        0.00M      1672K          0    trex068      1 00:00:00   trex068

