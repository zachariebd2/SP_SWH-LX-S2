unload conda/22.11.1  : OK 
load conda/22.11.1  : OK 
envs_dirs : /work/scratch/env/barrouz/conda_env/
pkgs_dirs : /work/scratch/env/barrouz/pkgs_conda
INPUT_PATH /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/5.txt
OUTPUT_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
DEM_PATH /work/CAMPUS/etudes/Neige/DEM
TCD_PATH /work/datalake/static_aux/TreeCoverDensity
MODELS_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
KEEP_REFL 0
MASK 1
start
/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/5.txt
muscate/SPOTWORLDHERITAGE/1998/05/07/SPOT1-HRV2-XS_19980507-102453-892_L1C_048-255-7_D_V1-0/SPOT1-HRV2-XS_19980507-102453-892_L1C_048-255-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980507-102453-892_L1C_048-255-7_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980507-102453-892_L1C_048-255-7_D_V1-0.zip
run script
2024-01-09T16:55:31.734    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T16:55:31.735    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980507-102453-892_L1C_048-255-7_D_V1-0.zip
2024-01-09T16:55:31.735    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:55:31.735    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:55:31.735    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T16:55:31.735    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:55:31.736    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:55:31.736    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:55:31.736    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:55:31.736    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980507-102453-892_L1C_048-255-7_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 0 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [2 2 1 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/07/SPOT1-HRV1-XS_19980507-102541-990_L1C_049-261-6_D_V1-0/SPOT1-HRV1-XS_19980507-102541-990_L1C_049-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980507-102541-990_L1C_049-261-6_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980507-102541-990_L1C_049-261-6_D_V1-0.zip
run script
2024-01-09T16:56:07.294    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T16:56:07.296    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980507-102541-990_L1C_049-261-6_D_V1-0.zip
2024-01-09T16:56:07.296    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:56:07.296    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:56:07.296    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T16:56:07.296    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:56:07.296    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:56:07.296    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:56:07.296    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:56:07.296    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980507-102541-990_L1C_049-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/05/07/SPOT1-HRV1-XS_19980507-102544-839_L1C_049-262-0_D_V1-0/SPOT1-HRV1-XS_19980507-102544-839_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980507-102544-839_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980507-102544-839_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T16:56:10.480    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T16:56:10.480    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980507-102544-839_L1C_049-262-0_D_V1-0.zip
2024-01-09T16:56:10.481    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:56:10.481    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:56:10.481    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T16:56:10.481    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:56:10.481    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:56:10.481    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:56:10.481    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:56:10.481    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980507-102544-839_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/07/19/SPOT1-HRV1-XS_19980719-102152-921_L1C_048-254-8_D_V1-0/SPOT1-HRV1-XS_19980719-102152-921_L1C_048-254-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980719-102152-921_L1C_048-254-8_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980719-102152-921_L1C_048-254-8_D_V1-0.zip
run script
2024-01-09T16:56:13.808    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T16:56:13.809    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980719-102152-921_L1C_048-254-8_D_V1-0.zip
2024-01-09T16:56:13.809    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:56:13.809    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:56:13.810    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T16:56:13.810    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:56:13.810    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:56:13.810    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:56:13.810    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:56:13.810    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980719-102152-921_L1C_048-254-8_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/19/SPOT1-HRV1-XS_19980719-102153-886_L1C_048-255-0_D_V1-0/SPOT1-HRV1-XS_19980719-102153-886_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980719-102153-886_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980719-102153-886_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T16:56:32.349    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T16:56:32.350    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980719-102153-886_L1C_048-255-0_D_V1-0.zip
2024-01-09T16:56:32.350    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:56:32.350    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:56:32.350    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T16:56:32.350    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:56:32.350    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:56:32.351    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:56:32.351    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:56:32.351    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980719-102153-886_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/19/SPOT1-HRV1-XS_19980719-102158-398_L1C_048-255-5_D_V1-0/SPOT1-HRV1-XS_19980719-102158-398_L1C_048-255-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980719-102158-398_L1C_048-255-5_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980719-102158-398_L1C_048-255-5_D_V1-0.zip
run script
2024-01-09T16:56:54.562    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T16:56:54.563    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980719-102158-398_L1C_048-255-5_D_V1-0.zip
2024-01-09T16:56:54.563    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:56:54.563    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:56:54.563    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T16:56:54.563    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:56:54.563    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:56:54.563    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:56:54.563    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:56:54.563    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980719-102158-398_L1C_048-255-5_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/19/SPOT1-HRV2-XS_19980719-102235-791_L1C_054-260-7_D_V1-0/SPOT1-HRV2-XS_19980719-102235-791_L1C_054-260-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980719-102235-791_L1C_054-260-7_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980719-102235-791_L1C_054-260-7_D_V1-0.zip
run script
2024-01-09T16:57:31.428    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T16:57:31.432    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980719-102235-791_L1C_054-260-7_D_V1-0.zip
2024-01-09T16:57:31.432    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:57:31.441    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:57:31.441    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T16:57:31.441    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:57:31.441    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:57:31.442    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:57:31.442    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:57:31.442    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980719-102235-791_L1C_054-260-7_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/19/SPOT1-HRV2-XS_19980719-102237-752_L1C_054-261-0_D_V1-0/SPOT1-HRV2-XS_19980719-102237-752_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980719-102237-752_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980719-102237-752_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T16:59:12.806    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T16:59:12.808    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980719-102237-752_L1C_054-261-0_D_V1-0.zip
2024-01-09T16:59:12.808    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:59:12.808    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:59:12.808    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T16:59:12.808    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:59:12.808    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:59:12.808    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:59:12.808    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:59:12.808    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980719-102237-752_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/19/SPOT1-HRV2-XS_19980719-102246-036_L1C_054-262-0_D_V1-0/SPOT1-HRV2-XS_19980719-102246-036_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980719-102246-036_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980719-102246-036_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T17:00:57.010    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:00:57.011    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980719-102246-036_L1C_054-262-0_D_V1-0.zip
2024-01-09T17:00:57.011    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:00:57.011    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:00:57.011    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:00:57.011    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:00:57.012    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:00:57.012    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:00:57.012    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:00:57.012    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980719-102246-036_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/19/SPOT1-HRV1-XS_19980719-102235-791_L1C_055-260-8_D_V1-0/SPOT1-HRV1-XS_19980719-102235-791_L1C_055-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980719-102235-791_L1C_055-260-8_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980719-102235-791_L1C_055-260-8_D_V1-0.zip
run script
2024-01-09T17:02:40.482    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:02:40.483    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980719-102235-791_L1C_055-260-8_D_V1-0.zip
2024-01-09T17:02:40.483    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:02:40.483    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:02:40.483    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:02:40.483    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:02:40.483    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:02:40.483    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:02:40.483    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:02:40.483    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980719-102235-791_L1C_055-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/19/SPOT1-HRV1-XS_19980719-102236-856_L1C_055-261-0_D_V1-0/SPOT1-HRV1-XS_19980719-102236-856_L1C_055-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980719-102236-856_L1C_055-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980719-102236-856_L1C_055-261-0_D_V1-0.zip
run script
2024-01-09T17:03:32.914    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:03:32.915    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980719-102236-856_L1C_055-261-0_D_V1-0.zip
2024-01-09T17:03:32.915    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:03:32.915    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:03:32.915    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:03:32.915    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:03:32.915    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:03:32.915    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:03:32.915    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:03:32.916    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980719-102236-856_L1C_055-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/19/SPOT1-HRV1-XS_19980719-102245-146_L1C_055-262-0_D_V1-0/SPOT1-HRV1-XS_19980719-102245-146_L1C_055-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980719-102245-146_L1C_055-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980719-102245-146_L1C_055-262-0_D_V1-0.zip
run script
2024-01-09T17:04:27.907    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:04:27.908    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980719-102245-146_L1C_055-262-0_D_V1-0.zip
2024-01-09T17:04:27.908    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:04:27.908    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:04:27.908    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:04:27.908    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:04:27.908    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:04:27.908    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:04:27.908    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:04:27.909    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980719-102245-146_L1C_055-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 0]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 0 0 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/23/SPOT1-HRV1-XS_19980723-104509-023_L1C_048-254-8_D_V1-0/SPOT1-HRV1-XS_19980723-104509-023_L1C_048-254-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980723-104509-023_L1C_048-254-8_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980723-104509-023_L1C_048-254-8_D_V1-0.zip
run script
2024-01-09T17:05:25.305    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:05:25.306    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980723-104509-023_L1C_048-254-8_D_V1-0.zip
2024-01-09T17:05:25.306    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:05:25.306    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:05:25.306    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:05:25.306    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:05:25.306    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:05:25.306    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:05:25.306    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:05:25.306    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980723-104509-023_L1C_048-254-8_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/23/SPOT1-HRV1-XS_19980723-104510-085_L1C_048-255-0_D_V1-0/SPOT1-HRV1-XS_19980723-104510-085_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980723-104510-085_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980723-104510-085_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T17:05:37.799    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:05:37.799    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980723-104510-085_L1C_048-255-0_D_V1-0.zip
2024-01-09T17:05:37.800    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:05:37.800    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:05:37.800    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:05:37.800    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:05:37.800    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:05:37.800    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:05:37.800    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:05:37.800    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980723-104510-085_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/23/SPOT1-HRV1-XS_19980723-104518-375_L1C_048-256-0_D_V1-0/SPOT1-HRV1-XS_19980723-104518-375_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980723-104518-375_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980723-104518-375_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T17:05:52.304    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:05:52.305    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980723-104518-375_L1C_048-256-0_D_V1-0.zip
2024-01-09T17:05:52.305    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:05:52.305    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:05:52.305    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:05:52.305    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:05:52.305    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:05:52.305    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:05:52.305    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:05:52.305    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980723-104518-375_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/23/SPOT1-HRV1-XS_19980723-104551-665_L1C_054-261-0_D_V1-0/SPOT1-HRV1-XS_19980723-104551-665_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980723-104551-665_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980723-104551-665_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T17:06:11.464    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:06:11.465    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980723-104551-665_L1C_054-261-0_D_V1-0.zip
2024-01-09T17:06:11.465    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:06:11.465    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:06:11.465    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:06:11.465    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:06:11.465    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:06:11.465    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:06:11.465    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:06:11.466    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980723-104551-665_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/23/SPOT1-HRV1-XS_19980723-104600-075_L1C_054-262-0_D_V1-0/SPOT1-HRV1-XS_19980723-104600-075_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980723-104600-075_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980723-104600-075_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T17:08:20.038    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:08:20.039    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980723-104600-075_L1C_054-262-0_D_V1-0.zip
2024-01-09T17:08:20.039    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:08:20.039    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:08:20.039    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:08:20.039    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:08:20.039    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:08:20.039    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:08:20.039    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:08:20.039    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980723-104600-075_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/07/SPOT1-HRV1-XS_19980807-105700-464_L1C_048-254-9_D_V1-0/SPOT1-HRV1-XS_19980807-105700-464_L1C_048-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980807-105700-464_L1C_048-254-9_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980807-105700-464_L1C_048-254-9_D_V1-0.zip
run script
2024-01-09T17:10:38.258    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:10:38.259    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980807-105700-464_L1C_048-254-9_D_V1-0.zip
2024-01-09T17:10:38.259    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:10:38.259    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:10:38.259    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:10:38.259    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:10:38.259    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:10:38.259    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:10:38.259    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:10:38.260    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980807-105700-464_L1C_048-254-9_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/07/SPOT1-HRV1-XS_19980807-105700-717_L1C_048-255-0_D_V1-0/SPOT1-HRV1-XS_19980807-105700-717_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980807-105700-717_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980807-105700-717_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T17:11:05.427    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:11:05.428    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980807-105700-717_L1C_048-255-0_D_V1-0.zip
2024-01-09T17:11:05.428    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:11:05.428    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:11:05.428    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:11:05.428    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:11:05.428    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:11:05.429    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:11:05.429    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:11:05.429    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980807-105700-717_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/07/SPOT1-HRV1-XS_19980807-105705-229_L1C_048-255-5_D_V1-0/SPOT1-HRV1-XS_19980807-105705-229_L1C_048-255-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980807-105705-229_L1C_048-255-5_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980807-105705-229_L1C_048-255-5_D_V1-0.zip
run script
2024-01-09T17:11:28.488    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:11:28.489    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980807-105705-229_L1C_048-255-5_D_V1-0.zip
2024-01-09T17:11:28.490    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:11:28.490    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:11:28.490    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:11:28.490    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:11:28.490    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:11:28.490    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:11:28.490    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:11:28.490    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980807-105705-229_L1C_048-255-5_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/07/SPOT1-HRV2-XS_19980807-105723-382_L1C_049-257-9_D_V1-0/SPOT1-HRV2-XS_19980807-105723-382_L1C_049-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980807-105723-382_L1C_049-257-9_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980807-105723-382_L1C_049-257-9_D_V1-0.zip
run script
2024-01-09T17:12:11.876    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:12:11.877    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980807-105723-382_L1C_049-257-9_D_V1-0.zip
2024-01-09T17:12:11.877    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:12:11.877    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:12:11.877    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:12:11.877    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:12:11.878    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:12:11.878    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:12:11.878    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:12:11.878    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:13:41.003    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 686). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980807-105723-382_L1C_049-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1998/08/07/SPOT1-HRV2-XS_19980807-105723-674_L1C_049-258-0_D_V1-0/SPOT1-HRV2-XS_19980807-105723-674_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980807-105723-674_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980807-105723-674_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T17:13:44.186    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:13:44.187    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980807-105723-674_L1C_049-258-0_D_V1-0.zip
2024-01-09T17:13:44.187    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:13:44.187    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:13:44.187    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:13:44.187    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:13:44.187    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:13:44.187    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:13:44.188    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:13:44.188    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:15:10.286    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 176). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980807-105723-674_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1998/08/07/SPOT1-HRV2-XS_19980807-105732-090_L1C_049-259-0_D_V1-0/SPOT1-HRV2-XS_19980807-105732-090_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980807-105732-090_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980807-105732-090_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T17:15:13.361    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:15:13.362    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980807-105732-090_L1C_049-259-0_D_V1-0.zip
2024-01-09T17:15:13.362    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:15:13.362    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:15:13.362    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:15:13.362    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:15:13.362    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:15:13.362    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:15:13.363    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:15:13.363    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980807-105732-090_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/07/SPOT1-HRV2-XS_19980807-105740-516_L1C_049-260-0_D_V1-0/SPOT1-HRV2-XS_19980807-105740-516_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980807-105740-516_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980807-105740-516_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T17:16:26.508    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:16:26.510    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980807-105740-516_L1C_049-260-0_D_V1-0.zip
2024-01-09T17:16:26.510    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:16:26.510    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:16:26.510    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:16:26.510    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:16:26.510    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:16:26.510    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:16:26.510    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:16:26.510    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980807-105740-516_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/07/SPOT1-HRV2-XS_19980807-105748-944_L1C_049-261-0_D_V1-0/SPOT1-HRV2-XS_19980807-105748-944_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980807-105748-944_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980807-105748-944_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T17:17:12.119    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:17:12.120    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980807-105748-944_L1C_049-261-0_D_V1-0.zip
2024-01-09T17:17:12.120    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:17:12.120    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:17:12.121    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:17:12.121    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:17:12.121    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:17:12.121    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:17:12.121    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:17:12.121    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980807-105748-944_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/07/SPOT1-HRV2-XS_19980807-105757-376_L1C_049-262-0_D_V1-0/SPOT1-HRV2-XS_19980807-105757-376_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980807-105757-376_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980807-105757-376_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T17:17:36.888    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:17:36.889    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980807-105757-376_L1C_049-262-0_D_V1-0.zip
2024-01-09T17:17:36.889    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:17:36.889    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:17:36.889    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:17:36.889    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:17:36.889    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:17:36.889    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:17:36.889    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:17:36.889    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980807-105757-376_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/08/07/SPOT1-HRV1-XS_19980807-105735-544_L1C_052-260-0_D_V1-0/SPOT1-HRV1-XS_19980807-105735-544_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980807-105735-544_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980807-105735-544_L1C_052-260-0_D_V1-0.zip
run script
2024-01-09T17:17:40.140    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:17:40.141    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980807-105735-544_L1C_052-260-0_D_V1-0.zip
2024-01-09T17:17:40.141    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:17:40.141    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:17:40.141    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:17:40.141    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:17:40.141    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:17:40.141    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:17:40.141    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:17:40.141    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:18:43.531    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 258). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980807-105735-544_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1998/08/07/SPOT1-HRV1-XS_19980807-105744-026_L1C_052-261-0_D_V1-0/SPOT1-HRV1-XS_19980807-105744-026_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980807-105744-026_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980807-105744-026_L1C_052-261-0_D_V1-0.zip
run script
2024-01-09T17:18:46.654    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:18:46.654    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980807-105744-026_L1C_052-261-0_D_V1-0.zip
2024-01-09T17:18:46.654    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:18:46.655    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:18:46.655    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:18:46.655    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:18:46.655    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:18:46.655    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:18:46.655    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:18:46.655    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980807-105744-026_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/07/SPOT1-HRV1-XS_19980807-105752-512_L1C_052-262-0_D_V1-0/SPOT1-HRV1-XS_19980807-105752-512_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980807-105752-512_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980807-105752-512_L1C_052-262-0_D_V1-0.zip
run script
2024-01-09T17:22:16.295    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:22:16.296    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980807-105752-512_L1C_052-262-0_D_V1-0.zip
2024-01-09T17:22:16.296    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:22:16.296    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:22:16.296    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:22:16.296    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:22:16.296    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:22:16.296    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:22:16.296    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:22:16.296    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980807-105752-512_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/07/SPOT1-HRV1-XS_19980807-105757-024_L1C_052-262-5_D_V1-0/SPOT1-HRV1-XS_19980807-105757-024_L1C_052-262-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980807-105757-024_L1C_052-262-5_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980807-105757-024_L1C_052-262-5_D_V1-0.zip
run script
2024-01-09T17:25:21.739    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:25:21.740    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980807-105757-024_L1C_052-262-5_D_V1-0.zip
2024-01-09T17:25:21.740    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:25:21.740    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:25:21.740    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:25:21.740    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:25:21.740    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:25:21.741    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:25:21.741    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:25:21.741    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980807-105757-024_L1C_052-262-5_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/07/SPOT1-HRV1-XS_19980807-105723-100_L1C_053-258-5_D_V1-0/SPOT1-HRV1-XS_19980807-105723-100_L1C_053-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980807-105723-100_L1C_053-258-5_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980807-105723-100_L1C_053-258-5_D_V1-0.zip
run script
2024-01-09T17:27:42.434    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:27:42.435    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980807-105723-100_L1C_053-258-5_D_V1-0.zip
2024-01-09T17:27:42.435    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:27:42.435    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:27:42.435    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:27:42.435    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:27:42.436    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:27:42.436    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:27:42.436    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:27:42.436    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980807-105723-100_L1C_053-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/07/SPOT1-HRV1-XS_19980807-105727-064_L1C_053-259-0_D_V1-0/SPOT1-HRV1-XS_19980807-105727-064_L1C_053-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980807-105727-064_L1C_053-259-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980807-105727-064_L1C_053-259-0_D_V1-0.zip
run script
2024-01-09T17:31:01.503    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:31:01.504    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980807-105727-064_L1C_053-259-0_D_V1-0.zip
2024-01-09T17:31:01.504    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:31:01.504    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:31:01.504    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:31:01.504    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:31:01.504    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:31:01.504    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:31:01.504    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:31:01.504    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980807-105727-064_L1C_053-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/16/SPOT1-HRV1-XS_19980516-105159-424_L1C_048-255-2_D_V1-0/SPOT1-HRV1-XS_19980516-105159-424_L1C_048-255-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980516-105159-424_L1C_048-255-2_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980516-105159-424_L1C_048-255-2_D_V1-0.zip
run script
2024-01-09T17:34:35.356    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:34:35.358    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980516-105159-424_L1C_048-255-2_D_V1-0.zip
2024-01-09T17:34:35.358    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:34:35.358    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:34:35.358    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:34:35.358    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:34:35.358    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:34:35.358    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:34:35.358    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:34:35.358    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980516-105159-424_L1C_048-255-2_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/16/SPOT1-HRV1-XS_19980516-105205-969_L1C_048-256-0_D_V1-0/SPOT1-HRV1-XS_19980516-105205-969_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980516-105205-969_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980516-105205-969_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T17:35:12.110    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:35:12.112    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980516-105205-969_L1C_048-256-0_D_V1-0.zip
2024-01-09T17:35:12.112    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:35:12.112    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:35:12.112    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:35:12.112    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:35:12.112    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:35:12.112    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:35:12.112    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:35:12.112    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980516-105205-969_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/16/SPOT1-HRV1-XS_19980516-105214-329_L1C_048-257-0_D_V1-0/SPOT1-HRV1-XS_19980516-105214-329_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980516-105214-329_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980516-105214-329_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T17:36:10.468    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:36:10.470    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980516-105214-329_L1C_048-257-0_D_V1-0.zip
2024-01-09T17:36:10.470    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:36:10.470    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:36:10.470    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:36:10.470    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:36:10.470    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:36:10.470    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:36:10.470    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:36:10.470    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980516-105214-329_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/02/13/SPOT1-HRV1-XS_19980213-102004-233_L1C_048-257-5_D_V1-0/SPOT1-HRV1-XS_19980213-102004-233_L1C_048-257-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980213-102004-233_L1C_048-257-5_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980213-102004-233_L1C_048-257-5_D_V1-0.zip
run script
2024-01-09T17:36:53.406    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:36:53.407    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980213-102004-233_L1C_048-257-5_D_V1-0.zip
2024-01-09T17:36:53.407    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:36:53.407    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:36:53.407    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:36:53.407    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:36:53.407    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:36:53.407    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:36:53.407    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:36:53.408    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980213-102004-233_L1C_048-257-5_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [1 0 0 ... 0 0 0]
 [1 0 0 ... 0 0 0]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 1 1 1]
 [0 1 1 ... 1 1 1]
 [0 1 0 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/02/13/SPOT1-HRV1-XS_19980213-102007-942_L1C_048-258-0_D_V1-0/SPOT1-HRV1-XS_19980213-102007-942_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980213-102007-942_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980213-102007-942_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T17:37:25.428    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:37:25.429    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980213-102007-942_L1C_048-258-0_D_V1-0.zip
2024-01-09T17:37:25.429    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:37:25.430    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:37:25.430    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:37:25.430    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:37:25.430    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:37:25.430    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:37:25.430    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:37:25.430    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980213-102007-942_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/02/13/SPOT1-HRV1-XS_19980213-102016-172_L1C_048-259-0_D_V1-0/SPOT1-HRV1-XS_19980213-102016-172_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980213-102016-172_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980213-102016-172_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T17:37:47.959    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:37:47.960    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980213-102016-172_L1C_048-259-0_D_V1-0.zip
2024-01-09T17:37:47.961    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:37:47.961    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:37:47.961    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:37:47.961    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:37:47.961    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:37:47.961    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:37:47.961    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:37:47.961    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980213-102016-172_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/02/13/SPOT1-HRV1-XS_19980213-102024-411_L1C_048-260-0_D_V1-0/SPOT1-HRV1-XS_19980213-102024-411_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980213-102024-411_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980213-102024-411_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T17:37:57.897    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:37:57.898    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980213-102024-411_L1C_048-260-0_D_V1-0.zip
2024-01-09T17:37:57.898    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:37:57.898    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:37:57.898    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:37:57.899    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:37:57.899    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:37:57.899    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:37:57.899    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:37:57.899    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980213-102024-411_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/02/13/SPOT1-HRV1-XS_19980213-102032-659_L1C_048-261-0_D_V1-0/SPOT1-HRV1-XS_19980213-102032-659_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980213-102032-659_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980213-102032-659_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T17:38:01.115    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:38:01.115    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980213-102032-659_L1C_048-261-0_D_V1-0.zip
2024-01-09T17:38:01.115    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:38:01.115    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:38:01.116    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:38:01.116    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:38:01.116    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:38:01.116    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:38:01.116    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:38:01.116    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980213-102032-659_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/02/13/SPOT1-HRV2-XS_19980213-101934-403_L1C_049-254-0_D_V1-0/SPOT1-HRV2-XS_19980213-101934-403_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980213-101934-403_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980213-101934-403_L1C_049-254-0_D_V1-0.zip
run script
2024-01-09T17:38:04.073    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:38:04.074    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980213-101934-403_L1C_049-254-0_D_V1-0.zip
2024-01-09T17:38:04.074    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:38:04.074    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:38:04.074    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:38:04.074    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:38:04.074    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:38:04.074    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:38:04.074    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:38:04.074    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980213-101934-403_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/02/13/SPOT1-HRV2-XS_19980213-101942-594_L1C_049-255-0_D_V1-0/SPOT1-HRV2-XS_19980213-101942-594_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980213-101942-594_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980213-101942-594_L1C_049-255-0_D_V1-0.zip
run script
2024-01-09T17:38:07.285    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:38:07.285    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980213-101942-594_L1C_049-255-0_D_V1-0.zip
2024-01-09T17:38:07.286    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:38:07.286    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:38:07.286    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:38:07.286    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:38:07.286    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:38:07.286    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:38:07.286    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:38:07.286    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980213-101942-594_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/02/13/SPOT1-HRV2-XS_19980213-101946-203_L1C_049-255-4_D_V1-0/SPOT1-HRV2-XS_19980213-101946-203_L1C_049-255-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980213-101946-203_L1C_049-255-4_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980213-101946-203_L1C_049-255-4_D_V1-0.zip
run script
2024-01-09T17:38:46.051    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:38:46.052    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980213-101946-203_L1C_049-255-4_D_V1-0.zip
2024-01-09T17:38:46.052    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:38:46.052    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:38:46.052    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:38:46.052    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:38:46.052    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:38:46.052    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:38:46.052    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:38:46.053    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980213-101946-203_L1C_049-255-4_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 1 1 0]
 [0 0 0 ... 1 1 0]
 [0 0 0 ... 1 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/02/13/SPOT1-HRV1-XS_19980213-102040-916_L1C_049-262-0_D_V1-0/SPOT1-HRV1-XS_19980213-102040-916_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980213-102040-916_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980213-102040-916_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T17:39:55.537    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:39:55.538    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980213-102040-916_L1C_049-262-0_D_V1-0.zip
2024-01-09T17:39:55.538    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:39:55.538    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:39:55.538    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:39:55.538    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:39:55.538    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:39:55.538    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:39:55.538    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:39:55.538    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980213-102040-916_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/02/13/SPOT1-HRV1-XS_19980213-101933-179_L1C_050-254-0_D_V1-0/SPOT1-HRV1-XS_19980213-101933-179_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980213-101933-179_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980213-101933-179_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T17:39:59.024    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:39:59.025    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980213-101933-179_L1C_050-254-0_D_V1-0.zip
2024-01-09T17:39:59.025    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:39:59.025    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:39:59.025    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:39:59.025    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:39:59.025    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:39:59.025    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:39:59.025    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:39:59.025    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980213-101933-179_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/02/13/SPOT1-HRV1-XS_19980213-101941-379_L1C_050-255-0_D_V1-0/SPOT1-HRV1-XS_19980213-101941-379_L1C_050-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980213-101941-379_L1C_050-255-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980213-101941-379_L1C_050-255-0_D_V1-0.zip
run script
2024-01-09T17:40:03.048    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:40:03.049    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980213-101941-379_L1C_050-255-0_D_V1-0.zip
2024-01-09T17:40:03.049    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:40:03.049    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:40:03.050    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:40:03.050    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:40:03.050    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:40:03.050    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:40:03.050    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:40:03.050    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980213-101941-379_L1C_050-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/02/13/SPOT1-HRV1-XS_19980213-101945-891_L1C_050-255-5_D_V1-0/SPOT1-HRV1-XS_19980213-101945-891_L1C_050-255-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980213-101945-891_L1C_050-255-5_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980213-101945-891_L1C_050-255-5_D_V1-0.zip
run script
2024-01-09T17:41:00.943    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:41:00.944    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980213-101945-891_L1C_050-255-5_D_V1-0.zip
2024-01-09T17:41:00.944    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:41:00.945    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:41:00.945    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:41:00.945    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:41:00.945    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:41:00.945    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:41:00.945    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:41:00.945    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980213-101945-891_L1C_050-255-5_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/02/13/SPOT1-HRV2-XS_19980213-102004-321_L1C_051-257-8_D_V1-0/SPOT1-HRV2-XS_19980213-102004-321_L1C_051-257-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980213-102004-321_L1C_051-257-8_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980213-102004-321_L1C_051-257-8_D_V1-0.zip
run script
2024-01-09T17:43:10.688    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:43:10.690    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980213-102004-321_L1C_051-257-8_D_V1-0.zip
2024-01-09T17:43:10.690    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:43:10.690    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:43:10.690    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:43:10.690    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:43:10.690    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:43:10.690    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:43:10.690    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:43:10.690    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:46:17.678    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 310). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980213-102004-321_L1C_051-257-8_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1998/02/13/SPOT1-HRV2-XS_19980213-102005-334_L1C_051-258-0_D_V1-0/SPOT1-HRV2-XS_19980213-102005-334_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980213-102005-334_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980213-102005-334_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T17:46:20.825    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:46:20.826    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980213-102005-334_L1C_051-258-0_D_V1-0.zip
2024-01-09T17:46:20.826    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:46:20.826    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:46:20.826    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:46:20.826    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:46:20.826    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:46:20.826    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:46:20.826    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:46:20.827    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:48:05.165    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 225). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980213-102005-334_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1998/02/13/SPOT1-HRV2-XS_19980213-102013-579_L1C_051-259-0_D_V1-0/SPOT1-HRV2-XS_19980213-102013-579_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980213-102013-579_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980213-102013-579_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T17:48:08.510    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:48:08.511    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980213-102013-579_L1C_051-259-0_D_V1-0.zip
2024-01-09T17:48:08.512    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:48:08.512    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:48:08.512    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:48:08.512    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:48:08.512    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:48:08.512    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:48:08.512    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:48:08.512    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980213-102013-579_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 1 1 ... 2 2 2]
 [2 1 1 ... 2 2 2]
 [2 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [0 0 1 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/02/13/SPOT1-HRV2-XS_19980213-102021-830_L1C_051-260-0_D_V1-0/SPOT1-HRV2-XS_19980213-102021-830_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980213-102021-830_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980213-102021-830_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T17:51:17.118    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:51:17.119    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980213-102021-830_L1C_051-260-0_D_V1-0.zip
2024-01-09T17:51:17.119    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:51:17.119    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:51:17.119    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:51:17.122    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:51:17.122    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:51:17.123    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:51:17.123    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:51:17.123    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980213-102021-830_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/02/13/SPOT1-HRV2-XS_19980213-102030-093_L1C_051-261-0_D_V1-0/SPOT1-HRV2-XS_19980213-102030-093_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980213-102030-093_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980213-102030-093_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T17:53:43.430    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:53:43.431    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980213-102030-093_L1C_051-261-0_D_V1-0.zip
2024-01-09T17:53:43.431    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:53:43.431    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:53:43.431    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:53:43.431    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:53:43.431    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:53:43.431    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:53:43.431    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:53:43.431    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980213-102030-093_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 1 1 ... 2 2 2]
 [0 1 1 ... 2 2 2]
 [0 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/02/13/SPOT1-HRV2-XS_19980213-102038-362_L1C_051-262-0_D_V1-0/SPOT1-HRV2-XS_19980213-102038-362_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980213-102038-362_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980213-102038-362_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T17:56:08.379    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:56:08.380    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980213-102038-362_L1C_051-262-0_D_V1-0.zip
2024-01-09T17:56:08.380    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:56:08.380    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:56:08.380    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:56:08.380    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:56:08.380    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:56:08.380    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:56:08.380    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:56:08.380    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980213-102038-362_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/02/13/SPOT1-HRV2-XS_19980213-102046-643_L1C_051-263-0_D_V1-0/SPOT1-HRV2-XS_19980213-102046-643_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980213-102046-643_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980213-102046-643_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T17:57:58.172    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:57:58.183    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980213-102046-643_L1C_051-263-0_D_V1-0.zip
2024-01-09T17:57:58.184    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:57:58.184    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:57:58.184    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:57:58.184    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:57:58.184    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:57:58.184    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:57:58.184    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:57:58.184    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980213-102046-643_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/12/SPOT1-HRV2-XS_19980812-110121-055_L1C_048-258-0_D_V1-0/SPOT1-HRV2-XS_19980812-110121-055_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980812-110121-055_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980812-110121-055_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T17:58:42.275    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:58:42.276    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980812-110121-055_L1C_048-258-0_D_V1-0.zip
2024-01-09T17:58:42.276    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:58:42.276    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:58:42.276    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:58:42.276    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:58:42.276    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:58:42.276    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:58:42.276    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:58:42.277    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:59:24.405    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 156). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980812-110121-055_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1998/08/12/SPOT1-HRV2-XS_19980812-110129-492_L1C_048-259-0_D_V1-0/SPOT1-HRV2-XS_19980812-110129-492_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980812-110129-492_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980812-110129-492_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T17:59:27.595    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:59:27.595    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980812-110129-492_L1C_048-259-0_D_V1-0.zip
2024-01-09T17:59:27.595    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:59:27.595    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:59:27.595    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:59:27.595    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:59:27.595    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:59:27.595    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:59:27.595    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:59:27.595    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980812-110129-492_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/12/SPOT1-HRV2-XS_19980812-110137-933_L1C_048-260-0_D_V1-0/SPOT1-HRV2-XS_19980812-110137-933_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980812-110137-933_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980812-110137-933_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T17:59:47.581    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:59:47.583    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980812-110137-933_L1C_048-260-0_D_V1-0.zip
2024-01-09T17:59:47.583    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:59:47.583    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:59:47.583    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:59:47.583    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:59:47.583    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:59:47.583    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:59:47.583    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:59:47.583    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980812-110137-933_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/08/12/SPOT1-HRV2-XS_19980812-110146-379_L1C_048-261-0_D_V1-0/SPOT1-HRV2-XS_19980812-110146-379_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980812-110146-379_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980812-110146-379_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T17:59:50.612    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:59:50.613    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980812-110146-379_L1C_048-261-0_D_V1-0.zip
2024-01-09T17:59:50.613    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:59:50.613    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:59:50.613    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:59:50.613    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:59:50.613    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:59:50.613    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:59:50.613    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:59:50.613    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980812-110146-379_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/08/12/SPOT1-HRV1-XS_19980812-110054-684_L1C_049-255-0_D_V1-0/SPOT1-HRV1-XS_19980812-110054-684_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980812-110054-684_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980812-110054-684_L1C_049-255-0_D_V1-0.zip
run script
2024-01-09T17:59:53.542    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T17:59:53.542    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980812-110054-684_L1C_049-255-0_D_V1-0.zip
2024-01-09T17:59:53.542    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:59:53.542    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:59:53.542    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T17:59:53.542    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:59:53.542    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:59:53.542    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:59:53.542    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:59:53.542    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980812-110054-684_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/12/SPOT1-HRV1-XS_19980812-110101-000_L1C_049-255-7_D_V1-0/SPOT1-HRV1-XS_19980812-110101-000_L1C_049-255-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980812-110101-000_L1C_049-255-7_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980812-110101-000_L1C_049-255-7_D_V1-0.zip
run script
2024-01-09T18:01:03.190    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:01:03.191    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980812-110101-000_L1C_049-255-7_D_V1-0.zip
2024-01-09T18:01:03.192    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:01:03.192    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:01:03.192    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:01:03.192    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:01:03.192    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:01:03.192    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:01:03.192    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:01:03.192    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980812-110101-000_L1C_049-255-7_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/12/SPOT1-HRV2-XS_19980812-110118-940_L1C_049-257-7_D_V1-0/SPOT1-HRV2-XS_19980812-110118-940_L1C_049-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980812-110118-940_L1C_049-257-7_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980812-110118-940_L1C_049-257-7_D_V1-0.zip
run script
2024-01-09T18:03:42.423    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:03:42.424    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980812-110118-940_L1C_049-257-7_D_V1-0.zip
2024-01-09T18:03:42.425    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:03:42.425    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:03:42.425    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:03:42.425    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:03:42.425    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:03:42.425    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:03:42.425    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:03:42.425    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980812-110118-940_L1C_049-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/12/SPOT1-HRV1-XS_19980812-110046-252_L1C_050-254-0_D_V1-0/SPOT1-HRV1-XS_19980812-110046-252_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980812-110046-252_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980812-110046-252_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T18:04:31.593    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:04:31.594    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980812-110046-252_L1C_050-254-0_D_V1-0.zip
2024-01-09T18:04:31.594    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:04:31.594    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:04:31.594    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:04:31.594    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:04:31.594    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:04:31.594    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:04:31.594    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:04:31.594    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980812-110046-252_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/08/12/SPOT1-HRV2-XS_19980812-110043-972_L1C_051-254-0_D_V1-0/SPOT1-HRV2-XS_19980812-110043-972_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980812-110043-972_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980812-110043-972_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T18:04:34.639    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:04:34.641    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980812-110043-972_L1C_051-254-0_D_V1-0.zip
2024-01-09T18:04:34.641    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:04:34.641    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:04:34.641    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:04:34.641    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:04:34.641    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:04:34.641    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:04:34.641    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:04:34.641    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980812-110043-972_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/08/12/SPOT1-HRV2-XS_19980812-110052-431_L1C_051-255-0_D_V1-0/SPOT1-HRV2-XS_19980812-110052-431_L1C_051-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980812-110052-431_L1C_051-255-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980812-110052-431_L1C_051-255-0_D_V1-0.zip
run script
2024-01-09T18:04:37.642    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:04:37.643    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980812-110052-431_L1C_051-255-0_D_V1-0.zip
2024-01-09T18:04:37.644    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:04:37.644    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:04:37.644    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:04:37.644    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:04:37.644    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:04:37.644    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:04:37.644    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:04:37.644    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980812-110052-431_L1C_051-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/12/SPOT1-HRV2-XS_19980812-110100-892_L1C_051-256-0_D_V1-0/SPOT1-HRV2-XS_19980812-110100-892_L1C_051-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980812-110100-892_L1C_051-256-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980812-110100-892_L1C_051-256-0_D_V1-0.zip
run script
2024-01-09T18:05:50.570    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:05:50.571    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980812-110100-892_L1C_051-256-0_D_V1-0.zip
2024-01-09T18:05:50.571    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:05:50.571    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:05:50.571    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:05:50.571    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:05:50.572    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:05:50.572    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:05:50.572    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:05:50.572    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980812-110100-892_L1C_051-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/14/SPOT1-HRV1-XS_19980814-102249-474_L1C_048-258-4_D_V1-0/SPOT1-HRV1-XS_19980814-102249-474_L1C_048-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980814-102249-474_L1C_048-258-4_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980814-102249-474_L1C_048-258-4_D_V1-0.zip
run script
2024-01-09T18:09:26.910    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:09:26.911    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980814-102249-474_L1C_048-258-4_D_V1-0.zip
2024-01-09T18:09:26.911    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:09:26.911    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:09:26.911    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:09:26.911    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:09:26.911    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:09:26.912    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:09:26.912    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:09:26.912    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980814-102249-474_L1C_048-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/14/SPOT1-HRV1-XS_19980814-102254-091_L1C_048-259-0_D_V1-0/SPOT1-HRV1-XS_19980814-102254-091_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980814-102254-091_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980814-102254-091_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T18:09:45.254    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:09:45.255    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980814-102254-091_L1C_048-259-0_D_V1-0.zip
2024-01-09T18:09:45.255    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:09:45.255    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:09:45.256    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:09:45.256    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:09:45.256    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:09:45.256    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:09:45.256    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:09:45.256    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980814-102254-091_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 1 1 2]
 [1 1 1 ... 1 1 2]
 [1 1 1 ... 1 1 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/14/SPOT1-HRV1-XS_19980814-102302-327_L1C_048-260-0_D_V1-0/SPOT1-HRV1-XS_19980814-102302-327_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980814-102302-327_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980814-102302-327_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T18:09:55.057    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:09:55.058    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980814-102302-327_L1C_048-260-0_D_V1-0.zip
2024-01-09T18:09:55.058    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:09:55.058    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:09:55.058    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:09:55.058    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:09:55.058    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:09:55.058    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:09:55.058    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:09:55.058    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980814-102302-327_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/08/14/SPOT1-HRV1-XS_19980814-102310-569_L1C_048-261-0_D_V1-0/SPOT1-HRV1-XS_19980814-102310-569_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980814-102310-569_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980814-102310-569_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T18:09:58.499    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:09:58.501    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980814-102310-569_L1C_048-261-0_D_V1-0.zip
2024-01-09T18:09:58.501    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:09:58.501    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:09:58.501    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:09:58.501    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:09:58.501    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:09:58.501    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:09:58.501    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:09:58.501    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980814-102310-569_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/08/14/SPOT1-HRV1-XS_19980814-102318-823_L1C_049-262-0_D_V1-0/SPOT1-HRV1-XS_19980814-102318-823_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980814-102318-823_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980814-102318-823_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T18:10:01.826    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:10:01.826    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980814-102318-823_L1C_049-262-0_D_V1-0.zip
2024-01-09T18:10:01.826    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:10:01.826    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:10:01.826    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:10:01.826    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:10:01.826    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:10:01.826    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:10:01.826    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:10:01.826    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980814-102318-823_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/08/14/SPOT1-HRV2-XS_19980814-102250-046_L1C_052-258-9_D_V1-0/SPOT1-HRV2-XS_19980814-102250-046_L1C_052-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980814-102250-046_L1C_052-258-9_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980814-102250-046_L1C_052-258-9_D_V1-0.zip
run script
2024-01-09T18:10:04.924    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:10:04.925    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980814-102250-046_L1C_052-258-9_D_V1-0.zip
2024-01-09T18:10:04.925    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:10:04.925    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:10:04.925    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:10:04.925    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:10:04.925    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:10:04.925    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:10:04.925    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:10:04.925    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980814-102250-046_L1C_052-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/14/SPOT1-HRV2-XS_19980814-102258-429_L1C_052-260-0_D_V1-0/SPOT1-HRV2-XS_19980814-102258-429_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980814-102258-429_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980814-102258-429_L1C_052-260-0_D_V1-0.zip
run script
2024-01-09T18:12:31.307    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:12:31.308    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980814-102258-429_L1C_052-260-0_D_V1-0.zip
2024-01-09T18:12:31.308    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:12:31.308    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:12:31.308    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:12:31.308    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:12:31.308    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:12:31.308    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:12:31.308    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:12:31.308    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980814-102258-429_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/14/SPOT1-HRV2-XS_19980814-102306-695_L1C_052-261-0_D_V1-0/SPOT1-HRV2-XS_19980814-102306-695_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980814-102306-695_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980814-102306-695_L1C_052-261-0_D_V1-0.zip
run script
2024-01-09T18:15:05.158    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:15:05.159    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980814-102306-695_L1C_052-261-0_D_V1-0.zip
2024-01-09T18:15:05.159    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:15:05.159    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:15:05.159    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:15:05.159    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:15:05.159    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:15:05.159    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:15:05.159    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:15:05.159    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980814-102306-695_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/14/SPOT1-HRV2-XS_19980814-102314-967_L1C_053-262-0_D_V1-0/SPOT1-HRV2-XS_19980814-102314-967_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980814-102314-967_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980814-102314-967_L1C_053-262-0_D_V1-0.zip
run script
2024-01-09T18:17:52.568    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:17:52.569    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980814-102314-967_L1C_053-262-0_D_V1-0.zip
2024-01-09T18:17:52.569    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:17:52.569    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:17:52.570    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:17:52.570    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:17:52.570    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:17:52.570    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:17:52.570    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:17:52.570    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980814-102314-967_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/05/SPOT1-HRV1-XS_19980505-110410-702_L1C_048-260-8_D_V1-0/SPOT1-HRV1-XS_19980505-110410-702_L1C_048-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980505-110410-702_L1C_048-260-8_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980505-110410-702_L1C_048-260-8_D_V1-0.zip
run script
2024-01-09T18:20:12.430    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:20:12.431    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980505-110410-702_L1C_048-260-8_D_V1-0.zip
2024-01-09T18:20:12.431    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:20:12.431    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:20:12.431    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:20:12.431    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:20:12.431    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:20:12.431    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:20:12.431    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:20:12.432    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980505-110410-702_L1C_048-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/05/05/SPOT1-HRV2-XS_19980505-110410-401_L1C_048-260-8_D_V1-0/SPOT1-HRV2-XS_19980505-110410-401_L1C_048-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980505-110410-401_L1C_048-260-8_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980505-110410-401_L1C_048-260-8_D_V1-0.zip
run script
2024-01-09T18:20:15.687    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:20:15.687    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980505-110410-401_L1C_048-260-8_D_V1-0.zip
2024-01-09T18:20:15.687    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:20:15.687    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:20:15.687    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:20:15.687    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:20:15.687    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:20:15.688    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:20:15.688    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:20:15.688    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980505-110410-401_L1C_048-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/05/05/SPOT1-HRV1-XS_19980505-110411-962_L1C_048-261-0_D_V1-0/SPOT1-HRV1-XS_19980505-110411-962_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980505-110411-962_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980505-110411-962_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T18:20:19.111    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:20:19.112    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980505-110411-962_L1C_048-261-0_D_V1-0.zip
2024-01-09T18:20:19.112    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:20:19.112    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:20:19.112    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:20:19.112    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:20:19.112    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:20:19.112    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:20:19.113    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:20:19.113    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980505-110411-962_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/05/05/SPOT1-HRV2-XS_19980505-110411-661_L1C_048-261-0_D_V1-0/SPOT1-HRV2-XS_19980505-110411-661_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980505-110411-661_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980505-110411-661_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T18:20:22.227    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:20:22.227    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980505-110411-661_L1C_048-261-0_D_V1-0.zip
2024-01-09T18:20:22.227    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:20:22.227    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:20:22.227    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:20:22.227    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:20:22.227    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:20:22.227    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:20:22.227    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:20:22.227    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980505-110411-661_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/03/21/SPOT1-HRV1-XS_19980321-102850-844_L1C_048-261-5_D_V1-0/SPOT1-HRV1-XS_19980321-102850-844_L1C_048-261-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980321-102850-844_L1C_048-261-5_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980321-102850-844_L1C_048-261-5_D_V1-0.zip
run script
2024-01-09T18:20:25.314    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:20:25.315    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980321-102850-844_L1C_048-261-5_D_V1-0.zip
2024-01-09T18:20:25.315    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:20:25.315    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:20:25.315    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:20:25.315    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:20:25.315    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:20:25.315    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:20:25.315    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:20:25.315    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980321-102850-844_L1C_048-261-5_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/04/20/SPOT1-HRV1-XS_19980420-105231-818_L1C_048-261-6_D_V1-0/SPOT1-HRV1-XS_19980420-105231-818_L1C_048-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980420-105231-818_L1C_048-261-6_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980420-105231-818_L1C_048-261-6_D_V1-0.zip
run script
2024-01-09T18:20:28.427    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:20:28.428    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980420-105231-818_L1C_048-261-6_D_V1-0.zip
2024-01-09T18:20:28.428    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:20:28.428    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:20:28.428    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:20:28.428    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:20:28.428    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:20:28.428    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:20:28.428    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:20:28.428    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980420-105231-818_L1C_048-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/04/20/SPOT1-HRV1-XS_19980420-105234-796_L1C_048-262-0_D_V1-0/SPOT1-HRV1-XS_19980420-105234-796_L1C_048-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980420-105234-796_L1C_048-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980420-105234-796_L1C_048-262-0_D_V1-0.zip
run script
2024-01-09T18:20:31.648    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:20:31.649    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980420-105234-796_L1C_048-262-0_D_V1-0.zip
2024-01-09T18:20:31.649    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:20:31.649    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:20:31.649    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:20:31.649    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:20:31.649    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:20:31.649    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:20:31.649    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:20:31.649    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980420-105234-796_L1C_048-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/08/17/SPOT1-HRV1-XS_19980817-110441-917_L1C_049-254-0_D_V1-0/SPOT1-HRV1-XS_19980817-110441-917_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980817-110441-917_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980817-110441-917_L1C_049-254-0_D_V1-0.zip
run script
2024-01-09T18:20:34.800    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:20:34.801    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980817-110441-917_L1C_049-254-0_D_V1-0.zip
2024-01-09T18:20:34.801    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:20:34.801    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:20:34.801    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:20:34.801    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:20:34.801    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:20:34.801    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:20:34.801    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:20:34.801    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980817-110441-917_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/08/17/SPOT1-HRV1-XS_19980817-110450-385_L1C_049-255-0_D_V1-0/SPOT1-HRV1-XS_19980817-110450-385_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980817-110450-385_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980817-110450-385_L1C_049-255-0_D_V1-0.zip
run script
2024-01-09T18:20:38.070    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:20:38.071    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980817-110450-385_L1C_049-255-0_D_V1-0.zip
2024-01-09T18:20:38.071    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:20:38.071    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:20:38.071    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:20:38.071    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:20:38.071    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:20:38.071    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:20:38.071    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:20:38.071    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980817-110450-385_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/17/SPOT1-HRV1-XS_19980817-110453-092_L1C_049-255-3_D_V1-0/SPOT1-HRV1-XS_19980817-110453-092_L1C_049-255-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980817-110453-092_L1C_049-255-3_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980817-110453-092_L1C_049-255-3_D_V1-0.zip
run script
2024-01-09T18:21:53.331    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:21:53.332    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980817-110453-092_L1C_049-255-3_D_V1-0.zip
2024-01-09T18:21:53.333    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:21:53.333    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:21:53.333    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:21:53.333    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:21:53.333    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:21:53.333    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:21:53.333    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:21:53.333    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980817-110453-092_L1C_049-255-3_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/22/SPOT1-HRV1-XS_19980722-110438-401_L1C_049-256-8_D_V1-0/SPOT1-HRV1-XS_19980722-110438-401_L1C_049-256-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980722-110438-401_L1C_049-256-8_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980722-110438-401_L1C_049-256-8_D_V1-0.zip
run script
2024-01-09T18:23:47.803    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:23:47.804    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980722-110438-401_L1C_049-256-8_D_V1-0.zip
2024-01-09T18:23:47.804    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:23:47.804    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:23:47.804    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:23:47.804    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:23:47.804    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:23:47.804    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:23:47.804    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:23:47.804    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980722-110438-401_L1C_049-256-8_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/22/SPOT1-HRV1-XS_19980722-110439-659_L1C_049-257-0_D_V1-0/SPOT1-HRV1-XS_19980722-110439-659_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980722-110439-659_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980722-110439-659_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T18:26:16.802    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:26:16.803    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980722-110439-659_L1C_049-257-0_D_V1-0.zip
2024-01-09T18:26:16.803    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:26:16.803    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:26:16.803    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:26:16.803    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:26:16.803    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:26:16.803    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:26:16.803    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:26:16.804    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980722-110439-659_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/22/SPOT1-HRV1-XS_19980722-110448-138_L1C_049-258-0_D_V1-0/SPOT1-HRV1-XS_19980722-110448-138_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980722-110448-138_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980722-110448-138_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T18:28:29.046    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:28:29.047    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980722-110448-138_L1C_049-258-0_D_V1-0.zip
2024-01-09T18:28:29.047    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:28:29.047    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:28:29.047    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:28:29.047    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:28:29.047    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:28:29.047    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:28:29.047    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:28:29.048    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T18:29:43.160    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 310). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980722-110448-138_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1998/07/22/SPOT1-HRV1-XS_19980722-110456-621_L1C_049-259-0_D_V1-0/SPOT1-HRV1-XS_19980722-110456-621_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980722-110456-621_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980722-110456-621_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T18:29:46.509    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:29:46.510    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980722-110456-621_L1C_049-259-0_D_V1-0.zip
2024-01-09T18:29:46.510    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:29:46.510    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:29:46.511    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:29:46.511    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:29:46.511    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:29:46.511    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:29:46.511    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:29:46.511    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980722-110456-621_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/22/SPOT1-HRV1-XS_19980722-110505-107_L1C_049-260-0_D_V1-0/SPOT1-HRV1-XS_19980722-110505-107_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980722-110505-107_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980722-110505-107_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T18:30:54.061    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:30:54.062    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980722-110505-107_L1C_049-260-0_D_V1-0.zip
2024-01-09T18:30:54.062    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:30:54.062    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:30:54.062    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:30:54.062    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:30:54.062    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:30:54.063    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:30:54.063    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:30:54.063    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980722-110505-107_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/22/SPOT1-HRV1-XS_19980722-110513-598_L1C_049-261-0_D_V1-0/SPOT1-HRV1-XS_19980722-110513-598_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980722-110513-598_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980722-110513-598_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T18:31:27.827    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:31:27.828    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980722-110513-598_L1C_049-261-0_D_V1-0.zip
2024-01-09T18:31:27.828    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:31:27.828    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:31:27.828    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:31:27.828    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:31:27.828    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:31:27.828    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:31:27.828    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:31:27.828    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T18:31:30.292    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (151 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980722-110513-598_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1998/07/22/SPOT1-HRV1-XS_19980722-110519-915_L1C_049-261-7_D_V1-0/SPOT1-HRV1-XS_19980722-110519-915_L1C_049-261-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980722-110519-915_L1C_049-261-7_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980722-110519-915_L1C_049-261-7_D_V1-0.zip
run script
2024-01-09T18:31:33.403    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:31:33.404    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980722-110519-915_L1C_049-261-7_D_V1-0.zip
2024-01-09T18:31:33.404    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:31:33.404    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:31:33.404    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:31:33.404    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:31:33.404    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:31:33.404    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:31:33.404    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:31:33.404    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980722-110519-915_L1C_049-261-7_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/02/12/SPOT1-HRV1-XS_19980212-103933-982_L1C_049-258-8_D_V1-0/SPOT1-HRV1-XS_19980212-103933-982_L1C_049-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980212-103933-982_L1C_049-258-8_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980212-103933-982_L1C_049-258-8_D_V1-0.zip
run script
2024-01-09T18:31:36.732    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:31:36.732    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980212-103933-982_L1C_049-258-8_D_V1-0.zip
2024-01-09T18:31:36.732    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:31:36.732    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:31:36.732    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:31:36.732    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:31:36.732    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:31:36.732    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:31:36.732    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:31:36.732    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980212-103933-982_L1C_049-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/02/12/SPOT1-HRV1-XS_19980212-103935-071_L1C_049-259-0_D_V1-0/SPOT1-HRV1-XS_19980212-103935-071_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980212-103935-071_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980212-103935-071_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T18:31:56.803    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:31:56.804    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980212-103935-071_L1C_049-259-0_D_V1-0.zip
2024-01-09T18:31:56.804    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:31:56.804    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:31:56.804    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:31:56.804    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:31:56.804    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:31:56.804    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:31:56.804    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:31:56.804    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980212-103935-071_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/02/12/SPOT1-HRV1-XS_19980212-103936-875_L1C_049-259-2_D_V1-0/SPOT1-HRV1-XS_19980212-103936-875_L1C_049-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980212-103936-875_L1C_049-259-2_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980212-103936-875_L1C_049-259-2_D_V1-0.zip
run script
2024-01-09T18:32:28.188    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:32:28.189    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980212-103936-875_L1C_049-259-2_D_V1-0.zip
2024-01-09T18:32:28.189    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:32:28.189    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:32:28.189    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:32:28.190    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:32:28.190    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:32:28.190    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:32:28.190    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:32:28.190    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980212-103936-875_L1C_049-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/02/12/SPOT1-HRV2-XS_19980212-103915-275_L1C_051-257-0_D_V1-0/SPOT1-HRV2-XS_19980212-103915-275_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980212-103915-275_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980212-103915-275_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T18:32:40.739    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:32:40.740    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980212-103915-275_L1C_051-257-0_D_V1-0.zip
2024-01-09T18:32:40.740    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:32:40.740    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:32:40.740    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:32:40.740    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:32:40.740    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:32:40.740    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:32:40.740    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:32:40.740    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980212-103915-275_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/02/12/SPOT1-HRV2-XS_19980212-103933-741_L1C_051-259-2_D_V1-0/SPOT1-HRV2-XS_19980212-103933-741_L1C_051-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980212-103933-741_L1C_051-259-2_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980212-103933-741_L1C_051-259-2_D_V1-0.zip
run script
2024-01-09T18:35:22.772    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:35:22.773    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980212-103933-741_L1C_051-259-2_D_V1-0.zip
2024-01-09T18:35:22.773    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:35:22.773    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:35:22.773    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:35:22.773    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:35:22.773    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:35:22.773    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:35:22.773    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:35:22.773    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980212-103933-741_L1C_051-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/02/12/SPOT1-HRV2-XS_19980212-103937-351_L1C_051-259-6_D_V1-0/SPOT1-HRV2-XS_19980212-103937-351_L1C_051-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980212-103937-351_L1C_051-259-6_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980212-103937-351_L1C_051-259-6_D_V1-0.zip
run script
2024-01-09T18:38:10.934    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:38:10.935    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980212-103937-351_L1C_051-259-6_D_V1-0.zip
2024-01-09T18:38:10.935    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:38:10.935    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:38:10.935    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:38:10.935    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:38:10.935    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:38:10.935    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:38:10.935    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:38:10.935    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980212-103937-351_L1C_051-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/27/SPOT1-HRV1-XS_19980627-104525-391_L1C_049-258-8_D_V1-0/SPOT1-HRV1-XS_19980627-104525-391_L1C_049-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980627-104525-391_L1C_049-258-8_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980627-104525-391_L1C_049-258-8_D_V1-0.zip
run script
2024-01-09T18:40:43.888    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:40:43.889    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980627-104525-391_L1C_049-258-8_D_V1-0.zip
2024-01-09T18:40:43.889    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:40:43.889    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:40:43.889    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:40:43.889    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:40:43.889    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:40:43.889    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:40:43.890    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:40:43.890    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980627-104525-391_L1C_049-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/27/SPOT1-HRV1-XS_19980627-104526-501_L1C_049-259-0_D_V1-0/SPOT1-HRV1-XS_19980627-104526-501_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980627-104526-501_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980627-104526-501_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T18:41:12.613    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:41:12.615    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980627-104526-501_L1C_049-259-0_D_V1-0.zip
2024-01-09T18:41:12.615    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:41:12.615    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:41:12.615    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:41:12.615    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:41:12.615    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:41:12.615    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:41:12.615    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:41:12.615    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980627-104526-501_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/27/SPOT1-HRV1-XS_19980627-104529-208_L1C_049-259-3_D_V1-0/SPOT1-HRV1-XS_19980627-104529-208_L1C_049-259-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980627-104529-208_L1C_049-259-3_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980627-104529-208_L1C_049-259-3_D_V1-0.zip
run script
2024-01-09T18:41:38.726    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:41:38.727    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980627-104529-208_L1C_049-259-3_D_V1-0.zip
2024-01-09T18:41:38.727    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:41:38.727    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:41:38.727    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:41:38.727    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:41:38.727    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:41:38.727    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:41:38.727    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:41:38.727    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980627-104529-208_L1C_049-259-3_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/27/SPOT1-HRV1-XS_19980627-104548-592_L1C_049-261-6_D_V1-0/SPOT1-HRV1-XS_19980627-104548-592_L1C_049-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980627-104548-592_L1C_049-261-6_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980627-104548-592_L1C_049-261-6_D_V1-0.zip
run script
2024-01-09T18:41:57.896    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:41:57.897    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980627-104548-592_L1C_049-261-6_D_V1-0.zip
2024-01-09T18:41:57.897    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:41:57.897    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:41:57.898    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:41:57.898    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:41:57.898    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:41:57.898    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:41:57.898    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:41:57.898    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980627-104548-592_L1C_049-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/06/27/SPOT1-HRV1-XS_19980627-104551-527_L1C_049-262-0_D_V1-0/SPOT1-HRV1-XS_19980627-104551-527_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980627-104551-527_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980627-104551-527_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T18:42:00.952    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:42:00.953    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980627-104551-527_L1C_049-262-0_D_V1-0.zip
2024-01-09T18:42:00.953    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:42:00.953    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:42:00.953    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:42:00.953    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:42:00.953    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:42:00.953    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:42:00.953    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:42:00.953    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980627-104551-527_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/07/02/SPOT1-HRV2-XS_19980702-104915-582_L1C_049-258-3_D_V1-0/SPOT1-HRV2-XS_19980702-104915-582_L1C_049-258-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980702-104915-582_L1C_049-258-3_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980702-104915-582_L1C_049-258-3_D_V1-0.zip
run script
2024-01-09T18:42:03.927    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:42:03.927    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980702-104915-582_L1C_049-258-3_D_V1-0.zip
2024-01-09T18:42:03.927    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:42:03.927    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:42:03.928    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:42:03.928    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:42:03.928    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:42:03.928    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:42:03.928    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:42:03.928    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T18:42:05.895    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 78). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980702-104915-582_L1C_049-258-3_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1998/07/02/SPOT1-HRV2-XS_19980702-104921-231_L1C_049-259-0_D_V1-0/SPOT1-HRV2-XS_19980702-104921-231_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980702-104921-231_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980702-104921-231_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T18:42:08.885    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:42:08.886    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980702-104921-231_L1C_049-259-0_D_V1-0.zip
2024-01-09T18:42:08.886    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:42:08.886    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:42:08.886    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:42:08.886    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:42:08.886    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:42:08.886    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:42:08.886    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:42:08.886    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980702-104921-231_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/02/SPOT1-HRV2-XS_19980702-104923-036_L1C_049-259-2_D_V1-0/SPOT1-HRV2-XS_19980702-104923-036_L1C_049-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980702-104923-036_L1C_049-259-2_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980702-104923-036_L1C_049-259-2_D_V1-0.zip
run script
2024-01-09T18:42:40.073    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:42:40.073    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980702-104923-036_L1C_049-259-2_D_V1-0.zip
2024-01-09T18:42:40.074    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:42:40.074    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:42:40.074    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:42:40.074    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:42:40.074    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:42:40.074    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:42:40.074    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:42:40.074    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980702-104923-036_L1C_049-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/02/SPOT1-HRV1-XS_19980702-104946-216_L1C_049-262-0_D_V1-0/SPOT1-HRV1-XS_19980702-104946-216_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980702-104946-216_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980702-104946-216_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T18:43:06.425    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:43:06.425    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980702-104946-216_L1C_049-262-0_D_V1-0.zip
2024-01-09T18:43:06.425    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:43:06.425    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:43:06.426    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:43:06.426    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:43:06.426    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:43:06.426    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:43:06.426    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:43:06.426    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980702-104946-216_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/08/19/SPOT1-HRV1-XS_19980819-102648-938_L1C_049-258-8_D_V1-0/SPOT1-HRV1-XS_19980819-102648-938_L1C_049-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980819-102648-938_L1C_049-258-8_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980819-102648-938_L1C_049-258-8_D_V1-0.zip
run script
2024-01-09T18:43:09.335    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:43:09.335    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980819-102648-938_L1C_049-258-8_D_V1-0.zip
2024-01-09T18:43:09.335    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:43:09.335    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:43:09.335    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:43:09.335    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:43:09.335    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:43:09.335    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:43:09.335    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:43:09.335    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980819-102648-938_L1C_049-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/19/SPOT1-HRV1-XS_19980819-102649-961_L1C_049-259-0_D_V1-0/SPOT1-HRV1-XS_19980819-102649-961_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980819-102649-961_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980819-102649-961_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T18:44:07.503    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:44:07.504    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980819-102649-961_L1C_049-259-0_D_V1-0.zip
2024-01-09T18:44:07.504    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:44:07.504    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:44:07.504    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:44:07.504    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:44:07.504    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:44:07.504    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:44:07.504    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:44:07.504    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980819-102649-961_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/19/SPOT1-HRV1-XS_19980819-102658-209_L1C_049-260-0_D_V1-0/SPOT1-HRV1-XS_19980819-102658-209_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980819-102658-209_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980819-102658-209_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T18:45:02.445    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:45:02.447    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980819-102658-209_L1C_049-260-0_D_V1-0.zip
2024-01-09T18:45:02.447    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:45:02.447    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:45:02.447    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:45:02.447    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:45:02.447    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:45:02.447    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:45:02.447    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:45:02.447    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980819-102658-209_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/19/SPOT1-HRV1-XS_19980819-102706-469_L1C_049-261-0_D_V1-0/SPOT1-HRV1-XS_19980819-102706-469_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980819-102706-469_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980819-102706-469_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T18:45:39.001    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:45:39.003    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980819-102706-469_L1C_049-261-0_D_V1-0.zip
2024-01-09T18:45:39.003    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:45:39.003    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:45:39.003    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:45:39.003    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:45:39.003    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:45:39.003    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:45:39.003    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:45:39.003    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980819-102706-469_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 ...
 [0 0 0 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/19/SPOT1-HRV1-XS_19980819-102714-735_L1C_049-262-0_D_V1-0/SPOT1-HRV1-XS_19980819-102714-735_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980819-102714-735_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980819-102714-735_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T18:46:05.693    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:46:05.694    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980819-102714-735_L1C_049-262-0_D_V1-0.zip
2024-01-09T18:46:05.694    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:46:05.694    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:46:05.694    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:46:05.694    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:46:05.694    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:46:05.694    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:46:05.694    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:46:05.694    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980819-102714-735_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/19/SPOT1-HRV1-XS_19980819-102607-753_L1C_050-254-0_D_V1-0/SPOT1-HRV1-XS_19980819-102607-753_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980819-102607-753_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980819-102607-753_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T18:46:15.811    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:46:15.812    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980819-102607-753_L1C_050-254-0_D_V1-0.zip
2024-01-09T18:46:15.812    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:46:15.812    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:46:15.813    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:46:15.813    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:46:15.813    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:46:15.813    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:46:15.813    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:46:15.813    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980819-102607-753_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/08/19/SPOT1-HRV1-XS_19980819-102608-655_L1C_050-254-1_D_V1-0/SPOT1-HRV1-XS_19980819-102608-655_L1C_050-254-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980819-102608-655_L1C_050-254-1_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980819-102608-655_L1C_050-254-1_D_V1-0.zip
run script
2024-01-09T18:46:19.088    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:46:19.089    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980819-102608-655_L1C_050-254-1_D_V1-0.zip
2024-01-09T18:46:19.089    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:46:19.089    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:46:19.089    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:46:19.089    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:46:19.089    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:46:19.089    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:46:19.089    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:46:19.089    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980819-102608-655_L1C_050-254-1_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/06/21/SPOT1-HRV2-XS_19980621-110054-572_L1C_049-260-0_D_V1-0/SPOT1-HRV2-XS_19980621-110054-572_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980621-110054-572_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980621-110054-572_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T18:46:22.319    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:46:22.319    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980621-110054-572_L1C_049-260-0_D_V1-0.zip
2024-01-09T18:46:22.319    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:46:22.319    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:46:22.319    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:46:22.319    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:46:22.319    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:46:22.320    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:46:22.320    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:46:22.320    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980621-110054-572_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/21/SPOT1-HRV2-XS_19980621-110101-792_L1C_049-260-8_D_V1-0/SPOT1-HRV2-XS_19980621-110101-792_L1C_049-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980621-110101-792_L1C_049-260-8_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980621-110101-792_L1C_049-260-8_D_V1-0.zip
run script
2024-01-09T18:47:26.567    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:47:26.568    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980621-110101-792_L1C_049-260-8_D_V1-0.zip
2024-01-09T18:47:26.568    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:47:26.568    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:47:26.568    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:47:26.568    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:47:26.569    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:47:26.569    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:47:26.569    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:47:26.569    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980621-110101-792_L1C_049-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/21/SPOT1-HRV2-XS_19980621-110017-700_L1C_050-255-6_D_V1-0/SPOT1-HRV2-XS_19980621-110017-700_L1C_050-255-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980621-110017-700_L1C_050-255-6_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980621-110017-700_L1C_050-255-6_D_V1-0.zip
run script
2024-01-09T18:48:14.443    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:48:14.444    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980621-110017-700_L1C_050-255-6_D_V1-0.zip
2024-01-09T18:48:14.444    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:48:14.444    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:48:14.444    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:48:14.444    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:48:14.444    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:48:14.444    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:48:14.444    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:48:14.445    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980621-110017-700_L1C_050-255-6_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/21/SPOT1-HRV2-XS_19980621-110020-735_L1C_050-256-0_D_V1-0/SPOT1-HRV2-XS_19980621-110020-735_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980621-110020-735_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980621-110020-735_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T18:51:01.502    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:51:01.504    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980621-110020-735_L1C_050-256-0_D_V1-0.zip
2024-01-09T18:51:01.504    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:51:01.504    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:51:01.504    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:51:01.504    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:51:01.504    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:51:01.504    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:51:01.504    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:51:01.504    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980621-110020-735_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/21/SPOT1-HRV2-XS_19980621-110029-188_L1C_050-257-0_D_V1-0/SPOT1-HRV2-XS_19980621-110029-188_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980621-110029-188_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980621-110029-188_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T18:54:32.612    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:54:32.613    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980621-110029-188_L1C_050-257-0_D_V1-0.zip
2024-01-09T18:54:32.613    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:54:32.613    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:54:32.613    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:54:32.613    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:54:32.613    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:54:32.613    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:54:32.613    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:54:32.613    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980621-110029-188_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/21/SPOT1-HRV2-XS_19980621-110037-646_L1C_050-258-0_D_V1-0/SPOT1-HRV2-XS_19980621-110037-646_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980621-110037-646_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980621-110037-646_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T18:57:56.784    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:57:56.785    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980621-110037-646_L1C_050-258-0_D_V1-0.zip
2024-01-09T18:57:56.785    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:57:56.785    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:57:56.785    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:57:56.785    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:57:56.786    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:57:56.786    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:57:56.786    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:57:56.786    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T18:59:51.798    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 434). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980621-110037-646_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1998/06/21/SPOT1-HRV2-XS_19980621-110046-108_L1C_050-259-0_D_V1-0/SPOT1-HRV2-XS_19980621-110046-108_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980621-110046-108_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980621-110046-108_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T18:59:55.191    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T18:59:55.191    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980621-110046-108_L1C_050-259-0_D_V1-0.zip
2024-01-09T18:59:55.191    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:59:55.191    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:59:55.191    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T18:59:55.191    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:59:55.191    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:59:55.191    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:59:55.191    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:59:55.191    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980621-110046-108_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/21/SPOT1-HRV1-XS_19980621-110027-040_L1C_051-257-0_D_V1-0/SPOT1-HRV1-XS_19980621-110027-040_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980621-110027-040_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980621-110027-040_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T19:01:31.017    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:01:31.020    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980621-110027-040_L1C_051-257-0_D_V1-0.zip
2024-01-09T19:01:31.020    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:01:31.020    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:01:31.020    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:01:31.020    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:01:31.020    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:01:31.020    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:01:31.021    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:01:31.021    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980621-110027-040_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/21/SPOT1-HRV1-XS_19980621-110035-523_L1C_051-258-0_D_V1-0/SPOT1-HRV1-XS_19980621-110035-523_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980621-110035-523_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980621-110035-523_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T19:05:30.321    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:05:30.321    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980621-110035-523_L1C_051-258-0_D_V1-0.zip
2024-01-09T19:05:30.321    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:05:30.321    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:05:30.322    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:05:30.322    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:05:30.322    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:05:30.322    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:05:30.322    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:05:30.322    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980621-110035-523_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/21/SPOT1-HRV1-XS_19980621-110044-008_L1C_051-259-0_D_V1-0/SPOT1-HRV1-XS_19980621-110044-008_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980621-110044-008_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980621-110044-008_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T19:09:06.427    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:09:06.428    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980621-110044-008_L1C_051-259-0_D_V1-0.zip
2024-01-09T19:09:06.428    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:09:06.429    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:09:06.429    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:09:06.429    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:09:06.429    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:09:06.429    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:09:06.429    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:09:06.429    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980621-110044-008_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 0 0 ... 2 2 2]
 [0 0 1 ... 2 2 2]
 [0 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/21/SPOT1-HRV1-XS_19980621-110052-497_L1C_051-260-0_D_V1-0/SPOT1-HRV1-XS_19980621-110052-497_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980621-110052-497_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980621-110052-497_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T19:12:56.683    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:12:56.684    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980621-110052-497_L1C_051-260-0_D_V1-0.zip
2024-01-09T19:12:56.684    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:12:56.684    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:12:56.684    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:12:56.684    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:12:56.684    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:12:56.684    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:12:56.684    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:12:56.685    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980621-110052-497_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/21/SPOT1-HRV1-XS_19980621-110101-891_L1C_051-261-1_D_V1-0/SPOT1-HRV1-XS_19980621-110101-891_L1C_051-261-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980621-110101-891_L1C_051-261-1_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980621-110101-891_L1C_051-261-1_D_V1-0.zip
run script
2024-01-09T19:15:59.499    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:15:59.500    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980621-110101-891_L1C_051-261-1_D_V1-0.zip
2024-01-09T19:15:59.500    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:15:59.501    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:15:59.501    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:15:59.501    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:15:59.501    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:15:59.501    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:15:59.501    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:15:59.501    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980621-110101-891_L1C_051-261-1_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/26/SPOT1-HRV2-XS_19980626-110450-009_L1C_049-260-0_D_V1-0/SPOT1-HRV2-XS_19980626-110450-009_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980626-110450-009_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980626-110450-009_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T19:18:13.884    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:18:13.885    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980626-110450-009_L1C_049-260-0_D_V1-0.zip
2024-01-09T19:18:13.885    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:18:13.885    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:18:13.886    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:18:13.886    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:18:13.886    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:18:13.886    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:18:13.886    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:18:13.886    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980626-110450-009_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/26/SPOT1-HRV2-XS_19980626-110458-504_L1C_049-261-0_D_V1-0/SPOT1-HRV2-XS_19980626-110458-504_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980626-110458-504_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980626-110458-504_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T19:18:54.623    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:18:54.624    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980626-110458-504_L1C_049-261-0_D_V1-0.zip
2024-01-09T19:18:54.624    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:18:54.624    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:18:54.624    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:18:54.624    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:18:54.624    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:18:54.624    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:18:54.624    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:18:54.624    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980626-110458-504_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/26/SPOT1-HRV2-XS_19980626-110505-723_L1C_049-261-8_D_V1-0/SPOT1-HRV2-XS_19980626-110505-723_L1C_049-261-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980626-110505-723_L1C_049-261-8_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980626-110505-723_L1C_049-261-8_D_V1-0.zip
run script
2024-01-09T19:19:10.048    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:19:10.050    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980626-110505-723_L1C_049-261-8_D_V1-0.zip
2024-01-09T19:19:10.050    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:19:10.050    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:19:10.050    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:19:10.050    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:19:10.050    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:19:10.050    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:19:10.050    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:19:10.051    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980626-110505-723_L1C_049-261-8_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/04/21/SPOT1-HRV1-XS_19980421-103313-271_L1C_049-261-5_D_V1-0/SPOT1-HRV1-XS_19980421-103313-271_L1C_049-261-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980421-103313-271_L1C_049-261-5_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980421-103313-271_L1C_049-261-5_D_V1-0.zip
run script
2024-01-09T19:19:13.049    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:19:13.050    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980421-103313-271_L1C_049-261-5_D_V1-0.zip
2024-01-09T19:19:13.050    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:19:13.050    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:19:13.050    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:19:13.050    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:19:13.050    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:19:13.050    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:19:13.051    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:19:13.051    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980421-103313-271_L1C_049-261-5_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/04/21/SPOT1-HRV1-XS_19980421-103317-049_L1C_049-262-0_D_V1-0/SPOT1-HRV1-XS_19980421-103317-049_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980421-103317-049_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980421-103317-049_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T19:19:16.161    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:19:16.162    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980421-103317-049_L1C_049-262-0_D_V1-0.zip
2024-01-09T19:19:16.162    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:19:16.162    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:19:16.164    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:19:16.164    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:19:16.164    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:19:16.164    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:19:16.164    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:19:16.164    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980421-103317-049_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/04/21/SPOT1-HRV1-XS_19980421-103318-854_L1C_049-262-2_D_V1-0/SPOT1-HRV1-XS_19980421-103318-854_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980421-103318-854_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980421-103318-854_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T19:19:19.131    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:19:19.131    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980421-103318-854_L1C_049-262-2_D_V1-0.zip
2024-01-09T19:19:19.131    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:19:19.131    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:19:19.131    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:19:19.131    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:19:19.131    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:19:19.132    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:19:19.132    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:19:19.132    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980421-103318-854_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/04/25/SPOT1-HRV1-XS_19980425-105626-859_L1C_049-261-6_D_V1-0/SPOT1-HRV1-XS_19980425-105626-859_L1C_049-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980425-105626-859_L1C_049-261-6_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980425-105626-859_L1C_049-261-6_D_V1-0.zip
run script
2024-01-09T19:19:22.138    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:19:22.138    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980425-105626-859_L1C_049-261-6_D_V1-0.zip
2024-01-09T19:19:22.138    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:19:22.138    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:19:22.138    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:19:22.138    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:19:22.138    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:19:22.138    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:19:22.139    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:19:22.139    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980425-105626-859_L1C_049-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/04/25/SPOT1-HRV1-XS_19980425-105629-873_L1C_049-262-0_D_V1-0/SPOT1-HRV1-XS_19980425-105629-873_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980425-105629-873_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980425-105629-873_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T19:19:25.255    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:19:25.255    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980425-105629-873_L1C_049-262-0_D_V1-0.zip
2024-01-09T19:19:25.255    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:19:25.255    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:19:25.256    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:19:25.256    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:19:25.256    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:19:25.256    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:19:25.256    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:19:25.256    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980425-105629-873_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/04/25/SPOT1-HRV1-XS_19980425-105529-875_L1C_050-254-9_D_V1-0/SPOT1-HRV1-XS_19980425-105529-875_L1C_050-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980425-105529-875_L1C_050-254-9_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980425-105529-875_L1C_050-254-9_D_V1-0.zip
run script
2024-01-09T19:19:28.344    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:19:28.345    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980425-105529-875_L1C_050-254-9_D_V1-0.zip
2024-01-09T19:19:28.345    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:19:28.345    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:19:28.345    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:19:28.345    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:19:28.345    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:19:28.345    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:19:28.345    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:19:28.345    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980425-105529-875_L1C_050-254-9_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/04/25/SPOT1-HRV1-XS_19980425-105530-155_L1C_050-255-0_D_V1-0/SPOT1-HRV1-XS_19980425-105530-155_L1C_050-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980425-105530-155_L1C_050-255-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980425-105530-155_L1C_050-255-0_D_V1-0.zip
run script
2024-01-09T19:20:28.019    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:20:28.020    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980425-105530-155_L1C_050-255-0_D_V1-0.zip
2024-01-09T19:20:28.020    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:20:28.020    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:20:28.021    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:20:28.021    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:20:28.021    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:20:28.021    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:20:28.021    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:20:28.021    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980425-105530-155_L1C_050-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/04/25/SPOT1-HRV1-XS_19980425-105538-563_L1C_050-256-0_D_V1-0/SPOT1-HRV1-XS_19980425-105538-563_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980425-105538-563_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980425-105538-563_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T19:21:34.093    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:21:34.094    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980425-105538-563_L1C_050-256-0_D_V1-0.zip
2024-01-09T19:21:34.094    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:21:34.095    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:21:34.095    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:21:34.095    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:21:34.095    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:21:34.095    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:21:34.095    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:21:34.095    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980425-105538-563_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/04/25/SPOT1-HRV1-XS_19980425-105546-973_L1C_050-257-0_D_V1-0/SPOT1-HRV1-XS_19980425-105546-973_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980425-105546-973_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980425-105546-973_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T19:24:34.414    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:24:34.415    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980425-105546-973_L1C_050-257-0_D_V1-0.zip
2024-01-09T19:24:34.415    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:24:34.415    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:24:34.416    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:24:34.416    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:24:34.416    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:24:34.416    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:24:34.416    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:24:34.416    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980425-105546-973_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/04/25/SPOT1-HRV1-XS_19980425-105548-778_L1C_050-257-2_D_V1-0/SPOT1-HRV1-XS_19980425-105548-778_L1C_050-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980425-105548-778_L1C_050-257-2_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980425-105548-778_L1C_050-257-2_D_V1-0.zip
run script
2024-01-09T19:27:22.245    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:27:22.247    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980425-105548-778_L1C_050-257-2_D_V1-0.zip
2024-01-09T19:27:22.247    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:27:22.247    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:27:22.247    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:27:22.247    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:27:22.247    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:27:22.247    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:27:22.247    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:27:22.247    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980425-105548-778_L1C_050-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/04/25/SPOT1-HRV1-XS_19980425-105607-409_L1C_053-260-0_D_V1-0/SPOT1-HRV1-XS_19980425-105607-409_L1C_053-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980425-105607-409_L1C_053-260-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980425-105607-409_L1C_053-260-0_D_V1-0.zip
run script
2024-01-09T19:29:35.340    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:29:35.342    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980425-105607-409_L1C_053-260-0_D_V1-0.zip
2024-01-09T19:29:35.342    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:29:35.342    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:29:35.342    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:29:35.342    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:29:35.342    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:29:35.342    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:29:35.342    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:29:35.342    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T19:30:42.361    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 244). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980425-105607-409_L1C_053-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1998/04/25/SPOT1-HRV1-XS_19980425-105609-214_L1C_053-260-2_D_V1-0/SPOT1-HRV1-XS_19980425-105609-214_L1C_053-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980425-105609-214_L1C_053-260-2_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980425-105609-214_L1C_053-260-2_D_V1-0.zip
run script
2024-01-09T19:30:45.520    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:30:45.521    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980425-105609-214_L1C_053-260-2_D_V1-0.zip
2024-01-09T19:30:45.521    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:30:45.521    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:30:45.521    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:30:45.521    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:30:45.521    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:30:45.522    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:30:45.522    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:30:45.522    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T19:30:47.981    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 130). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980425-105609-214_L1C_053-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1998/06/22/SPOT1-HRV1-XS_19980622-104153-139_L1C_049-261-6_D_V1-0/SPOT1-HRV1-XS_19980622-104153-139_L1C_049-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980622-104153-139_L1C_049-261-6_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980622-104153-139_L1C_049-261-6_D_V1-0.zip
run script
2024-01-09T19:30:50.953    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:30:50.953    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980622-104153-139_L1C_049-261-6_D_V1-0.zip
2024-01-09T19:30:50.953    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:30:50.953    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:30:50.954    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:30:50.954    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:30:50.954    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:30:50.954    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:30:50.954    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:30:50.954    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980622-104153-139_L1C_049-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/06/22/SPOT1-HRV1-XS_19980622-104156-054_L1C_049-262-0_D_V1-0/SPOT1-HRV1-XS_19980622-104156-054_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980622-104156-054_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980622-104156-054_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T19:30:53.946    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:30:53.947    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980622-104156-054_L1C_049-262-0_D_V1-0.zip
2024-01-09T19:30:53.947    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:30:53.947    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:30:53.947    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:30:53.947    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:30:53.947    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:30:53.947    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:30:53.947    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:30:53.947    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980622-104156-054_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/06/22/SPOT1-HRV1-XS_19980622-104157-859_L1C_049-262-2_D_V1-0/SPOT1-HRV1-XS_19980622-104157-859_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980622-104157-859_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980622-104157-859_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T19:30:57.150    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:30:57.151    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980622-104157-859_L1C_049-262-2_D_V1-0.zip
2024-01-09T19:30:57.151    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:30:57.151    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:30:57.151    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:30:57.151    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:30:57.151    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:30:57.151    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:30:57.152    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:30:57.152    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980622-104157-859_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/06/22/SPOT1-HRV2-XS_19980622-104047-601_L1C_050-254-0_D_V1-0/SPOT1-HRV2-XS_19980622-104047-601_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980622-104047-601_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980622-104047-601_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T19:31:00.398    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:31:00.400    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980622-104047-601_L1C_050-254-0_D_V1-0.zip
2024-01-09T19:31:00.400    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:31:00.400    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:31:00.400    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:31:00.400    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:31:00.400    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:31:00.400    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:31:00.400    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:31:00.400    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980622-104047-601_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/06/22/SPOT1-HRV2-XS_19980622-104050-308_L1C_050-254-3_D_V1-0/SPOT1-HRV2-XS_19980622-104050-308_L1C_050-254-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980622-104050-308_L1C_050-254-3_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980622-104050-308_L1C_050-254-3_D_V1-0.zip
run script
2024-01-09T19:31:03.430    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:31:03.431    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980622-104050-308_L1C_050-254-3_D_V1-0.zip
2024-01-09T19:31:03.431    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:31:03.431    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:31:03.431    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:31:03.431    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:31:03.431    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:31:03.431    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:31:03.431    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:31:03.431    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980622-104050-308_L1C_050-254-3_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/07/03/SPOT1-HRV1-XS_19980703-103025-180_L1C_049-261-6_D_V1-0/SPOT1-HRV1-XS_19980703-103025-180_L1C_049-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980703-103025-180_L1C_049-261-6_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980703-103025-180_L1C_049-261-6_D_V1-0.zip
run script
2024-01-09T19:31:06.487    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:31:06.488    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980703-103025-180_L1C_049-261-6_D_V1-0.zip
2024-01-09T19:31:06.488    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:31:06.489    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:31:06.489    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:31:06.489    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:31:06.489    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:31:06.489    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:31:06.489    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:31:06.489    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980703-103025-180_L1C_049-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/07/03/SPOT1-HRV1-XS_19980703-103028-044_L1C_049-262-0_D_V1-0/SPOT1-HRV1-XS_19980703-103028-044_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980703-103028-044_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980703-103028-044_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T19:31:09.581    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:31:09.583    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980703-103028-044_L1C_049-262-0_D_V1-0.zip
2024-01-09T19:31:09.583    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:31:09.583    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:31:09.583    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:31:09.583    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:31:09.583    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:31:09.583    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:31:09.583    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:31:09.583    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980703-103028-044_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/09/09/SPOT1-HRV1-XS_19980909-102335-352_L1C_049-261-8_D_V1-0/SPOT1-HRV1-XS_19980909-102335-352_L1C_049-261-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980909-102335-352_L1C_049-261-8_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980909-102335-352_L1C_049-261-8_D_V1-0.zip
run script
2024-01-09T19:31:12.683    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:31:12.684    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980909-102335-352_L1C_049-261-8_D_V1-0.zip
2024-01-09T19:31:12.684    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:31:12.684    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:31:12.684    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:31:12.684    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:31:12.684    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:31:12.684    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:31:12.684    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:31:12.685    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980909-102335-352_L1C_049-261-8_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/09/09/SPOT1-HRV1-XS_19980909-102336-390_L1C_049-262-0_D_V1-0/SPOT1-HRV1-XS_19980909-102336-390_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980909-102336-390_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980909-102336-390_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T19:31:15.820    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:31:15.821    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980909-102336-390_L1C_049-262-0_D_V1-0.zip
2024-01-09T19:31:15.821    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:31:15.821    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:31:15.821    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:31:15.821    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:31:15.821    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:31:15.821    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:31:15.821    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:31:15.821    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980909-102336-390_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/11/19/SPOT1-HRV1-XS_19981119-105847-234_L1C_049-261-8_D_V1-0/SPOT1-HRV1-XS_19981119-105847-234_L1C_049-261-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19981119-105847-234_L1C_049-261-8_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19981119-105847-234_L1C_049-261-8_D_V1-0.zip
run script
2024-01-09T19:31:18.921    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:31:18.922    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19981119-105847-234_L1C_049-261-8_D_V1-0.zip
2024-01-09T19:31:18.922    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:31:18.922    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:31:18.922    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:31:18.922    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:31:18.922    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:31:18.922    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:31:18.922    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:31:18.922    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19981119-105847-234_L1C_049-261-8_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/11/19/SPOT1-HRV1-XS_19981119-105848-446_L1C_049-262-0_D_V1-0/SPOT1-HRV1-XS_19981119-105848-446_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19981119-105848-446_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19981119-105848-446_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T19:31:21.865    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:31:21.866    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19981119-105848-446_L1C_049-262-0_D_V1-0.zip
2024-01-09T19:31:21.866    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:31:21.866    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:31:21.866    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:31:21.866    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:31:21.866    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:31:21.866    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:31:21.866    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:31:21.866    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19981119-105848-446_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/03/10/SPOT1-HRV1-XS_19980310-103915-202_L1C_050-254-0_D_V1-0/SPOT1-HRV1-XS_19980310-103915-202_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980310-103915-202_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980310-103915-202_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T19:31:25.318    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:31:25.319    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980310-103915-202_L1C_050-254-0_D_V1-0.zip
2024-01-09T19:31:25.319    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:31:25.319    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:31:25.319    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:31:25.319    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:31:25.319    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:31:25.319    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:31:25.320    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:31:25.320    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980310-103915-202_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/03/10/SPOT1-HRV1-XS_19980310-103923-486_L1C_050-255-0_D_V1-0/SPOT1-HRV1-XS_19980310-103923-486_L1C_050-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980310-103923-486_L1C_050-255-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980310-103923-486_L1C_050-255-0_D_V1-0.zip
run script
2024-01-09T19:31:28.910    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:31:28.912    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980310-103923-486_L1C_050-255-0_D_V1-0.zip
2024-01-09T19:31:28.912    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:31:28.912    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:31:28.912    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:31:28.912    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:31:28.912    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:31:28.912    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:31:28.912    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:31:28.912    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980310-103923-486_L1C_050-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/03/10/SPOT1-HRV1-XS_19980310-103931-776_L1C_050-256-0_D_V1-0/SPOT1-HRV1-XS_19980310-103931-776_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980310-103931-776_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980310-103931-776_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T19:32:19.102    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:32:19.103    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980310-103931-776_L1C_050-256-0_D_V1-0.zip
2024-01-09T19:32:19.103    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:32:19.103    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:32:19.103    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:32:19.103    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:32:19.103    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:32:19.104    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:32:19.104    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:32:19.104    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980310-103931-776_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/03/10/SPOT1-HRV1-XS_19980310-103940-075_L1C_050-257-0_D_V1-0/SPOT1-HRV1-XS_19980310-103940-075_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980310-103940-075_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980310-103940-075_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T19:34:37.865    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:34:37.866    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980310-103940-075_L1C_050-257-0_D_V1-0.zip
2024-01-09T19:34:37.866    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:34:37.866    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:34:37.866    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:34:37.866    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:34:37.866    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:34:37.866    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:34:37.866    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:34:37.866    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980310-103940-075_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/03/10/SPOT1-HRV1-XS_19980310-103948-383_L1C_050-258-0_D_V1-0/SPOT1-HRV1-XS_19980310-103948-383_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980310-103948-383_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980310-103948-383_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T19:36:31.567    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:36:31.568    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980310-103948-383_L1C_050-258-0_D_V1-0.zip
2024-01-09T19:36:31.568    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:36:31.568    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:36:31.568    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:36:31.569    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:36:31.569    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:36:31.569    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:36:31.569    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:36:31.569    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T19:37:52.947    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (0 x 2940). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980310-103948-383_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1998/03/10/SPOT1-HRV1-XS_19980310-103956-697_L1C_050-259-0_D_V1-0/SPOT1-HRV1-XS_19980310-103956-697_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980310-103956-697_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980310-103956-697_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T19:37:56.114    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:37:56.115    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980310-103956-697_L1C_050-259-0_D_V1-0.zip
2024-01-09T19:37:56.115    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:37:56.115    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:37:56.115    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:37:56.115    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:37:56.115    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:37:56.115    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:37:56.115    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:37:56.116    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980310-103956-697_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/03/10/SPOT1-HRV1-XS_19980310-104005-021_L1C_050-260-0_D_V1-0/SPOT1-HRV1-XS_19980310-104005-021_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980310-104005-021_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980310-104005-021_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T19:39:10.943    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:39:10.944    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980310-104005-021_L1C_050-260-0_D_V1-0.zip
2024-01-09T19:39:10.944    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:39:10.944    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:39:10.945    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:39:10.945    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:39:10.945    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:39:10.945    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:39:10.945    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:39:10.945    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980310-104005-021_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/03/10/SPOT1-HRV1-XS_19980310-104013-350_L1C_050-261-0_D_V1-0/SPOT1-HRV1-XS_19980310-104013-350_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980310-104013-350_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980310-104013-350_L1C_050-261-0_D_V1-0.zip
run script
2024-01-09T19:40:00.324    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:40:00.325    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980310-104013-350_L1C_050-261-0_D_V1-0.zip
2024-01-09T19:40:00.325    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:40:00.325    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:40:00.325    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:40:00.325    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:40:00.325    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:40:00.326    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:40:00.326    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:40:00.326    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980310-104013-350_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/03/10/SPOT1-HRV1-XS_19980310-104021-685_L1C_050-262-0_D_V1-0/SPOT1-HRV1-XS_19980310-104021-685_L1C_050-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980310-104021-685_L1C_050-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980310-104021-685_L1C_050-262-0_D_V1-0.zip
run script
2024-01-09T19:40:36.030    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:40:36.031    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980310-104021-685_L1C_050-262-0_D_V1-0.zip
2024-01-09T19:40:36.031    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:40:36.031    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:40:36.031    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:40:36.031    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:40:36.032    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:40:36.032    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:40:36.032    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:40:36.032    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980310-104021-685_L1C_050-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/23/SPOT1-HRV2-XS_19980523-101708-366_L1C_050-254-0_D_V1-0/SPOT1-HRV2-XS_19980523-101708-366_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980523-101708-366_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980523-101708-366_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T19:40:51.372    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:40:51.373    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980523-101708-366_L1C_050-254-0_D_V1-0.zip
2024-01-09T19:40:51.374    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:40:51.374    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:40:51.374    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:40:51.374    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:40:51.374    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:40:51.374    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:40:51.374    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:40:51.374    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980523-101708-366_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/05/23/SPOT1-HRV2-XS_19980523-101716-554_L1C_050-255-0_D_V1-0/SPOT1-HRV2-XS_19980523-101716-554_L1C_050-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980523-101716-554_L1C_050-255-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980523-101716-554_L1C_050-255-0_D_V1-0.zip
run script
2024-01-09T19:40:54.536    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:40:54.537    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980523-101716-554_L1C_050-255-0_D_V1-0.zip
2024-01-09T19:40:54.537    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:40:54.537    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:40:54.537    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:40:54.537    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:40:54.537    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:40:54.537    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:40:54.537    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:40:54.537    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980523-101716-554_L1C_050-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/23/SPOT1-HRV2-XS_19980523-101719-261_L1C_050-255-3_D_V1-0/SPOT1-HRV2-XS_19980523-101719-261_L1C_050-255-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980523-101719-261_L1C_050-255-3_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980523-101719-261_L1C_050-255-3_D_V1-0.zip
run script
2024-01-09T19:41:53.460    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:41:53.462    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980523-101719-261_L1C_050-255-3_D_V1-0.zip
2024-01-09T19:41:53.462    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:41:53.462    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:41:53.462    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:41:53.462    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:41:53.462    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:41:53.462    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:41:53.462    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:41:53.462    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980523-101719-261_L1C_050-255-3_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/23/SPOT1-HRV1-XS_19980523-101707-139_L1C_051-254-0_D_V1-0/SPOT1-HRV1-XS_19980523-101707-139_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980523-101707-139_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980523-101707-139_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T19:43:34.953    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:43:34.954    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980523-101707-139_L1C_051-254-0_D_V1-0.zip
2024-01-09T19:43:34.954    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:43:34.954    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:43:34.955    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:43:34.955    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:43:34.955    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:43:34.955    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:43:34.955    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:43:34.955    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980523-101707-139_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/05/23/SPOT1-HRV2-XS_19980523-101737-366_L1C_052-257-7_D_V1-0/SPOT1-HRV2-XS_19980523-101737-366_L1C_052-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980523-101737-366_L1C_052-257-7_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980523-101737-366_L1C_052-257-7_D_V1-0.zip
run script
2024-01-09T19:43:37.993    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:43:37.994    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980523-101737-366_L1C_052-257-7_D_V1-0.zip
2024-01-09T19:43:37.994    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:43:37.994    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:43:37.994    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:43:37.994    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:43:37.994    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:43:37.994    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:43:37.994    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:43:37.994    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980523-101737-366_L1C_052-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 2 2 1]
 [2 2 2 ... 1 1 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/23/SPOT1-HRV2-XS_19980523-101739-279_L1C_052-258-0_D_V1-0/SPOT1-HRV2-XS_19980523-101739-279_L1C_052-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980523-101739-279_L1C_052-258-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980523-101739-279_L1C_052-258-0_D_V1-0.zip
run script
2024-01-09T19:46:03.855    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:46:03.856    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980523-101739-279_L1C_052-258-0_D_V1-0.zip
2024-01-09T19:46:03.856    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:46:03.856    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:46:03.856    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:46:03.856    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:46:03.857    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:46:03.857    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:46:03.857    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:46:03.857    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980523-101739-279_L1C_052-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/23/SPOT1-HRV2-XS_19980523-101747-518_L1C_052-259-0_D_V1-0/SPOT1-HRV2-XS_19980523-101747-518_L1C_052-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980523-101747-518_L1C_052-259-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980523-101747-518_L1C_052-259-0_D_V1-0.zip
run script
2024-01-09T19:48:20.784    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:48:20.785    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980523-101747-518_L1C_052-259-0_D_V1-0.zip
2024-01-09T19:48:20.785    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:48:20.785    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:48:20.785    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:48:20.786    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:48:20.786    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:48:20.786    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:48:20.786    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:48:20.786    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980523-101747-518_L1C_052-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/23/SPOT1-HRV2-XS_19980523-101755-766_L1C_053-260-0_D_V1-0/SPOT1-HRV2-XS_19980523-101755-766_L1C_053-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980523-101755-766_L1C_053-260-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980523-101755-766_L1C_053-260-0_D_V1-0.zip
run script
2024-01-09T19:51:07.818    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:51:07.819    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980523-101755-766_L1C_053-260-0_D_V1-0.zip
2024-01-09T19:51:07.819    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:51:07.819    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:51:07.819    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:51:07.819    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:51:07.819    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:51:07.819    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:51:07.819    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:51:07.819    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980523-101755-766_L1C_053-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/23/SPOT1-HRV2-XS_19980523-101804-023_L1C_053-261-0_D_V1-0/SPOT1-HRV2-XS_19980523-101804-023_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980523-101804-023_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980523-101804-023_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T19:53:41.150    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:53:41.151    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980523-101804-023_L1C_053-261-0_D_V1-0.zip
2024-01-09T19:53:41.151    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:53:41.151    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:53:41.151    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:53:41.151    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:53:41.151    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:53:41.151    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:53:41.151    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:53:41.151    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980523-101804-023_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/23/SPOT1-HRV2-XS_19980523-101812-289_L1C_053-262-0_D_V1-0/SPOT1-HRV2-XS_19980523-101812-289_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980523-101812-289_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980523-101812-289_L1C_053-262-0_D_V1-0.zip
run script
2024-01-09T19:56:08.371    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:56:08.372    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980523-101812-289_L1C_053-262-0_D_V1-0.zip
2024-01-09T19:56:08.372    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:56:08.373    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:56:08.373    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:56:08.373    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:56:08.373    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:56:08.373    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:56:08.373    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:56:08.373    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980523-101812-289_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/01/SPOT1-HRV2-XS_19980601-104421-841_L1C_050-254-0_D_V1-0/SPOT1-HRV2-XS_19980601-104421-841_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980601-104421-841_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980601-104421-841_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T19:58:37.572    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:58:37.573    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980601-104421-841_L1C_050-254-0_D_V1-0.zip
2024-01-09T19:58:37.573    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:58:37.573    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:58:37.573    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:58:37.573    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:58:37.573    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:58:37.573    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:58:37.573    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:58:37.573    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980601-104421-841_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/06/01/SPOT1-HRV2-XS_19980601-104425-450_L1C_050-254-4_D_V1-0/SPOT1-HRV2-XS_19980601-104425-450_L1C_050-254-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980601-104425-450_L1C_050-254-4_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980601-104425-450_L1C_050-254-4_D_V1-0.zip
run script
2024-01-09T19:58:40.465    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:58:40.466    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980601-104425-450_L1C_050-254-4_D_V1-0.zip
2024-01-09T19:58:40.467    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:58:40.467    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:58:40.468    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:58:40.468    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:58:40.468    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:58:40.468    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:58:40.468    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:58:40.468    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980601-104425-450_L1C_050-254-4_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/06/01/SPOT1-HRV2-XS_19980601-104511-187_L1C_054-260-6_D_V1-0/SPOT1-HRV2-XS_19980601-104511-187_L1C_054-260-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980601-104511-187_L1C_054-260-6_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980601-104511-187_L1C_054-260-6_D_V1-0.zip
run script
2024-01-09T19:58:43.422    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:58:43.423    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980601-104511-187_L1C_054-260-6_D_V1-0.zip
2024-01-09T19:58:43.423    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:58:43.424    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:58:43.424    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:58:43.424    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:58:43.424    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:58:43.424    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:58:43.424    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:58:43.424    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980601-104511-187_L1C_054-260-6_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/01/SPOT1-HRV2-XS_19980601-104514-183_L1C_054-261-0_D_V1-0/SPOT1-HRV2-XS_19980601-104514-183_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980601-104514-183_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980601-104514-183_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T20:00:36.227    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:00:36.229    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980601-104514-183_L1C_054-261-0_D_V1-0.zip
2024-01-09T20:00:36.229    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:00:36.229    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:00:36.229    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:00:36.229    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:00:36.229    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:00:36.229    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:00:36.229    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:00:36.230    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980601-104514-183_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/11/SPOT1-HRV1-XS_19980511-104805-753_L1C_050-255-8_D_V1-0/SPOT1-HRV1-XS_19980511-104805-753_L1C_050-255-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980511-104805-753_L1C_050-255-8_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980511-104805-753_L1C_050-255-8_D_V1-0.zip
run script
2024-01-09T20:02:36.046    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:02:36.047    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980511-104805-753_L1C_050-255-8_D_V1-0.zip
2024-01-09T20:02:36.047    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:02:36.047    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:02:36.047    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:02:36.047    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:02:36.047    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:02:36.047    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:02:36.047    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:02:36.047    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980511-104805-753_L1C_050-255-8_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/11/SPOT1-HRV1-XS_19980511-104806-878_L1C_050-256-0_D_V1-0/SPOT1-HRV1-XS_19980511-104806-878_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980511-104806-878_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980511-104806-878_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T20:05:05.264    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:05:05.265    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980511-104806-878_L1C_050-256-0_D_V1-0.zip
2024-01-09T20:05:05.265    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:05:05.265    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:05:05.265    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:05:05.266    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:05:05.266    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:05:05.266    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:05:05.266    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:05:05.266    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980511-104806-878_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/11/SPOT1-HRV1-XS_19980511-104815-228_L1C_050-257-0_D_V1-0/SPOT1-HRV1-XS_19980511-104815-228_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980511-104815-228_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980511-104815-228_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T20:07:44.379    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:07:44.380    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980511-104815-228_L1C_050-257-0_D_V1-0.zip
2024-01-09T20:07:44.380    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:07:44.380    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:07:44.380    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:07:44.380    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:07:44.380    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:07:44.380    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:07:44.380    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:07:44.380    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980511-104815-228_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/11/SPOT1-HRV1-XS_19980511-104823-587_L1C_050-258-0_D_V1-0/SPOT1-HRV1-XS_19980511-104823-587_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980511-104823-587_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980511-104823-587_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T20:10:12.505    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:10:12.506    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980511-104823-587_L1C_050-258-0_D_V1-0.zip
2024-01-09T20:10:12.506    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:10:12.506    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:10:12.506    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:10:12.506    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:10:12.506    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:10:12.506    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:10:12.507    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:10:12.507    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T20:11:45.042    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 806). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980511-104823-587_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1998/05/11/SPOT1-HRV1-XS_19980511-104831-950_L1C_050-259-0_D_V1-0/SPOT1-HRV1-XS_19980511-104831-950_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980511-104831-950_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980511-104831-950_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T20:11:47.956    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:11:47.957    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980511-104831-950_L1C_050-259-0_D_V1-0.zip
2024-01-09T20:11:47.957    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:11:47.957    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:11:47.958    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:11:47.958    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:11:47.958    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:11:47.958    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:11:47.958    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:11:47.958    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980511-104831-950_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/11/SPOT1-HRV1-XS_19980511-104840-321_L1C_050-260-0_D_V1-0/SPOT1-HRV1-XS_19980511-104840-321_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980511-104840-321_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980511-104840-321_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T20:13:11.126    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:13:11.127    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980511-104840-321_L1C_050-260-0_D_V1-0.zip
2024-01-09T20:13:11.127    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:13:11.127    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:13:11.127    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:13:11.127    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:13:11.127    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:13:11.127    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:13:11.127    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:13:11.127    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980511-104840-321_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/11/SPOT1-HRV1-XS_19980511-104848-695_L1C_050-261-0_D_V1-0/SPOT1-HRV1-XS_19980511-104848-695_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980511-104848-695_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980511-104848-695_L1C_050-261-0_D_V1-0.zip
run script
2024-01-09T20:13:58.817    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:13:58.818    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980511-104848-695_L1C_050-261-0_D_V1-0.zip
2024-01-09T20:13:58.818    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:13:58.818    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:13:58.818    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:13:58.819    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:13:58.819    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:13:58.819    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:13:58.819    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:13:58.819    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980511-104848-695_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/11/SPOT1-HRV1-XS_19980511-104850-500_L1C_050-261-2_D_V1-0/SPOT1-HRV1-XS_19980511-104850-500_L1C_050-261-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980511-104850-500_L1C_050-261-2_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980511-104850-500_L1C_050-261-2_D_V1-0.zip
run script
2024-01-09T20:14:34.241    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:14:34.243    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980511-104850-500_L1C_050-261-2_D_V1-0.zip
2024-01-09T20:14:34.243    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:14:34.243    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:14:34.243    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:14:34.243    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:14:34.243    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:14:34.243    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:14:34.243    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:14:34.243    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980511-104850-500_L1C_050-261-2_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/22/SPOT1-HRV1-XS_19980522-103643-606_L1C_050-255-8_D_V1-0/SPOT1-HRV1-XS_19980522-103643-606_L1C_050-255-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980522-103643-606_L1C_050-255-8_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980522-103643-606_L1C_050-255-8_D_V1-0.zip
run script
2024-01-09T20:15:10.094    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:15:10.095    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980522-103643-606_L1C_050-255-8_D_V1-0.zip
2024-01-09T20:15:10.096    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:15:10.096    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:15:10.096    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:15:10.096    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:15:10.096    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:15:10.096    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:15:10.096    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:15:10.096    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980522-103643-606_L1C_050-255-8_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/22/SPOT1-HRV1-XS_19980522-103644-656_L1C_050-256-0_D_V1-0/SPOT1-HRV1-XS_19980522-103644-656_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980522-103644-656_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980522-103644-656_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T20:17:20.698    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:17:20.700    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980522-103644-656_L1C_050-256-0_D_V1-0.zip
2024-01-09T20:17:20.700    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:17:20.700    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:17:20.700    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:17:20.700    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:17:20.700    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:17:20.700    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:17:20.700    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:17:20.700    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980522-103644-656_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/22/SPOT1-HRV1-XS_19980522-103652-934_L1C_050-257-0_D_V1-0/SPOT1-HRV1-XS_19980522-103652-934_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980522-103652-934_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980522-103652-934_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T20:19:40.228    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:19:40.229    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980522-103652-934_L1C_050-257-0_D_V1-0.zip
2024-01-09T20:19:40.229    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:19:40.229    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:19:40.229    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:19:40.229    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:19:40.229    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:19:40.229    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:19:40.229    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:19:40.229    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980522-103652-934_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/22/SPOT1-HRV1-XS_19980522-103701-221_L1C_050-258-0_D_V1-0/SPOT1-HRV1-XS_19980522-103701-221_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980522-103701-221_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980522-103701-221_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T20:21:53.854    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:21:53.855    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980522-103701-221_L1C_050-258-0_D_V1-0.zip
2024-01-09T20:21:53.855    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:21:53.855    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:21:53.855    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:21:53.855    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:21:53.855    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:21:53.855    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:21:53.855    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:21:53.855    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980522-103701-221_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/22/SPOT1-HRV1-XS_19980522-103709-514_L1C_050-259-0_D_V1-0/SPOT1-HRV1-XS_19980522-103709-514_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980522-103709-514_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980522-103709-514_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T20:23:23.312    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:23:23.313    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980522-103709-514_L1C_050-259-0_D_V1-0.zip
2024-01-09T20:23:23.313    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:23:23.313    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:23:23.313    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:23:23.314    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:23:23.314    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:23:23.314    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:23:23.314    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:23:23.314    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980522-103709-514_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/22/SPOT1-HRV1-XS_19980522-103718-718_L1C_050-260-1_D_V1-0/SPOT1-HRV1-XS_19980522-103718-718_L1C_050-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980522-103718-718_L1C_050-260-1_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980522-103718-718_L1C_050-260-1_D_V1-0.zip
run script
2024-01-09T20:24:42.100    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:24:42.101    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980522-103718-718_L1C_050-260-1_D_V1-0.zip
2024-01-09T20:24:42.101    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:24:42.101    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:24:42.101    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:24:42.101    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:24:42.101    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:24:42.101    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:24:42.101    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:24:42.101    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980522-103718-718_L1C_050-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/22/SPOT1-HRV2-XS_19980522-103643-925_L1C_051-256-1_D_V1-0/SPOT1-HRV2-XS_19980522-103643-925_L1C_051-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980522-103643-925_L1C_051-256-1_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980522-103643-925_L1C_051-256-1_D_V1-0.zip
run script
2024-01-09T20:25:30.145    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:25:30.147    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980522-103643-925_L1C_051-256-1_D_V1-0.zip
2024-01-09T20:25:30.147    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:25:30.147    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:25:30.147    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:25:30.147    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:25:30.147    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:25:30.147    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:25:30.147    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:25:30.147    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980522-103643-925_L1C_051-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/22/SPOT1-HRV2-XS_19980522-103651-315_L1C_051-257-0_D_V1-0/SPOT1-HRV2-XS_19980522-103651-315_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980522-103651-315_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980522-103651-315_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T20:28:15.360    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:28:15.361    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980522-103651-315_L1C_051-257-0_D_V1-0.zip
2024-01-09T20:28:15.361    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:28:15.361    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:28:15.361    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:28:15.361    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:28:15.361    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:28:15.362    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:28:15.362    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:28:15.362    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980522-103651-315_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 2 ... 2 2 2]
 [1 1 2 ... 2 2 2]
 [1 1 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/22/SPOT1-HRV2-XS_19980522-103659-614_L1C_051-258-0_D_V1-0/SPOT1-HRV2-XS_19980522-103659-614_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980522-103659-614_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980522-103659-614_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T20:31:20.079    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:31:20.080    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980522-103659-614_L1C_051-258-0_D_V1-0.zip
2024-01-09T20:31:20.080    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:31:20.080    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:31:20.080    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:31:20.080    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:31:20.080    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:31:20.080    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:31:20.080    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:31:20.080    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T20:32:54.088    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 205). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980522-103659-614_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1998/05/22/SPOT1-HRV2-XS_19980522-103707-922_L1C_051-259-0_D_V1-0/SPOT1-HRV2-XS_19980522-103707-922_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980522-103707-922_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980522-103707-922_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T20:32:57.217    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:32:57.218    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980522-103707-922_L1C_051-259-0_D_V1-0.zip
2024-01-09T20:32:57.218    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:32:57.219    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:32:57.219    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:32:57.219    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:32:57.219    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:32:57.219    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:32:57.219    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:32:57.219    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980522-103707-922_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/22/SPOT1-HRV2-XS_19980522-103716-240_L1C_051-260-0_D_V1-0/SPOT1-HRV2-XS_19980522-103716-240_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980522-103716-240_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980522-103716-240_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T20:35:37.888    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:35:37.889    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980522-103716-240_L1C_051-260-0_D_V1-0.zip
2024-01-09T20:35:37.890    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:35:37.890    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:35:37.890    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:35:37.890    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:35:37.890    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:35:37.890    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:35:37.890    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:35:37.890    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980522-103716-240_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/22/SPOT1-HRV2-XS_19980522-103718-947_L1C_051-260-3_D_V1-0/SPOT1-HRV2-XS_19980522-103718-947_L1C_051-260-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980522-103718-947_L1C_051-260-3_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980522-103718-947_L1C_051-260-3_D_V1-0.zip
run script
2024-01-09T20:37:38.860    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:37:38.861    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980522-103718-947_L1C_051-260-3_D_V1-0.zip
2024-01-09T20:37:38.861    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:37:38.861    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:37:38.861    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:37:38.862    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:37:38.862    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:37:38.862    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:37:38.862    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:37:38.862    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980522-103718-947_L1C_051-260-3_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/17/SPOT1-HRV2-XS_19980717-110051-207_L1C_050-257-8_D_V1-0/SPOT1-HRV2-XS_19980717-110051-207_L1C_050-257-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980717-110051-207_L1C_050-257-8_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980717-110051-207_L1C_050-257-8_D_V1-0.zip
run script
2024-01-09T20:39:25.328    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:39:25.330    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980717-110051-207_L1C_050-257-8_D_V1-0.zip
2024-01-09T20:39:25.330    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:39:25.330    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:39:25.330    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:39:25.330    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:39:25.330    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:39:25.330    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:39:25.330    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:39:25.331    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980717-110051-207_L1C_050-257-8_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/17/SPOT1-HRV2-XS_19980717-110052-449_L1C_050-258-0_D_V1-0/SPOT1-HRV2-XS_19980717-110052-449_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980717-110052-449_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980717-110052-449_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T20:42:39.227    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:42:39.229    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980717-110052-449_L1C_050-258-0_D_V1-0.zip
2024-01-09T20:42:39.229    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:42:39.229    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:42:39.229    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:42:39.229    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:42:39.229    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:42:39.229    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:42:39.229    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:42:39.229    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T20:45:29.664    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 490). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980717-110052-449_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1998/07/17/SPOT1-HRV2-XS_19980717-110053-352_L1C_050-258-1_D_V1-0/SPOT1-HRV2-XS_19980717-110053-352_L1C_050-258-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980717-110053-352_L1C_050-258-1_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980717-110053-352_L1C_050-258-1_D_V1-0.zip
run script
2024-01-09T20:45:32.806    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:45:32.806    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980717-110053-352_L1C_050-258-1_D_V1-0.zip
2024-01-09T20:45:32.806    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:45:32.806    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:45:32.806    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:45:32.806    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:45:32.806    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:45:32.806    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:45:32.807    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:45:32.807    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980717-110053-352_L1C_050-258-1_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/13/SPOT1-HRV1-XS_19980913-104628-807_L1C_050-259-6_D_V1-0/SPOT1-HRV1-XS_19980913-104628-807_L1C_050-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980913-104628-807_L1C_050-259-6_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980913-104628-807_L1C_050-259-6_D_V1-0.zip
run script
2024-01-09T20:48:16.028    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:48:16.029    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980913-104628-807_L1C_050-259-6_D_V1-0.zip
2024-01-09T20:48:16.029    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:48:16.029    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:48:16.029    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:48:16.029    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:48:16.029    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:48:16.029    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:48:16.029    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:48:16.029    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980913-104628-807_L1C_050-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/13/SPOT1-HRV1-XS_19980913-104631-740_L1C_050-260-0_D_V1-0/SPOT1-HRV1-XS_19980913-104631-740_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980913-104631-740_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980913-104631-740_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T20:49:34.911    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:49:34.913    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980913-104631-740_L1C_050-260-0_D_V1-0.zip
2024-01-09T20:49:34.913    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:49:34.913    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:49:34.913    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:49:34.913    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:49:34.913    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:49:34.913    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:49:34.913    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:49:34.913    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980913-104631-740_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/13/SPOT1-HRV1-XS_19980913-104640-093_L1C_050-261-0_D_V1-0/SPOT1-HRV1-XS_19980913-104640-093_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980913-104640-093_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980913-104640-093_L1C_050-261-0_D_V1-0.zip
run script
2024-01-09T20:50:41.095    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:50:41.096    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980913-104640-093_L1C_050-261-0_D_V1-0.zip
2024-01-09T20:50:41.096    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:50:41.096    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:50:41.096    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:50:41.096    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:50:41.097    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:50:41.097    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:50:41.097    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:50:41.097    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980913-104640-093_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/13/SPOT1-HRV1-XS_19980913-104648-453_L1C_050-262-0_D_V1-0/SPOT1-HRV1-XS_19980913-104648-453_L1C_050-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980913-104648-453_L1C_050-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980913-104648-453_L1C_050-262-0_D_V1-0.zip
run script
2024-01-09T20:51:34.266    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:51:34.267    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980913-104648-453_L1C_050-262-0_D_V1-0.zip
2024-01-09T20:51:34.268    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:51:34.268    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:51:34.268    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:51:34.268    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:51:34.268    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:51:34.268    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:51:34.268    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:51:34.268    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980913-104648-453_L1C_050-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/13/SPOT1-HRV2-XS_19980913-104628-804_L1C_051-259-8_D_V1-0/SPOT1-HRV2-XS_19980913-104628-804_L1C_051-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980913-104628-804_L1C_051-259-8_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980913-104628-804_L1C_051-259-8_D_V1-0.zip
run script
2024-01-09T20:52:04.038    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:52:04.040    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980913-104628-804_L1C_051-259-8_D_V1-0.zip
2024-01-09T20:52:04.040    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:52:04.040    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:52:04.040    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:52:04.040    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:52:04.040    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:52:04.040    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:52:04.040    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:52:04.040    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T20:53:50.169    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 224). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980913-104628-804_L1C_051-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1998/09/13/SPOT1-HRV2-XS_19980913-104629-950_L1C_051-260-0_D_V1-0/SPOT1-HRV2-XS_19980913-104629-950_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980913-104629-950_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980913-104629-950_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T20:53:53.121    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:53:53.123    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980913-104629-950_L1C_051-260-0_D_V1-0.zip
2024-01-09T20:53:53.123    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:53:53.123    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:53:53.123    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:53:53.123    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:53:53.123    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:53:53.123    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:53:53.123    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:53:53.123    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980913-104629-950_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/13/SPOT1-HRV2-XS_19980913-104638-322_L1C_051-261-0_D_V1-0/SPOT1-HRV2-XS_19980913-104638-322_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980913-104638-322_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980913-104638-322_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T20:56:12.859    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:56:12.860    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980913-104638-322_L1C_051-261-0_D_V1-0.zip
2024-01-09T20:56:12.860    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:56:12.861    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:56:12.861    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:56:12.861    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:56:12.861    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:56:12.861    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:56:12.861    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:56:12.861    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980913-104638-322_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/13/SPOT1-HRV2-XS_19980913-104646-699_L1C_051-262-0_D_V1-0/SPOT1-HRV2-XS_19980913-104646-699_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980913-104646-699_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980913-104646-699_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T20:58:23.920    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:58:23.921    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980913-104646-699_L1C_051-262-0_D_V1-0.zip
2024-01-09T20:58:23.922    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:58:23.922    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:58:23.922    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:58:23.922    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:58:23.922    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:58:23.922    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:58:23.922    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:58:23.922    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980913-104646-699_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/13/SPOT1-HRV2-XS_19980913-104655-079_L1C_051-263-0_D_V1-0/SPOT1-HRV2-XS_19980913-104655-079_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980913-104655-079_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980913-104655-079_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T21:00:06.155    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:00:06.157    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980913-104655-079_L1C_051-263-0_D_V1-0.zip
2024-01-09T21:00:06.157    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:00:06.157    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:00:06.157    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:00:06.157    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:00:06.157    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:00:06.157    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:00:06.157    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:00:06.157    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980913-104655-079_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/23/SPOT1-HRV2-XS_19980923-105413-318_L1C_050-259-5_D_V1-0/SPOT1-HRV2-XS_19980923-105413-318_L1C_050-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980923-105413-318_L1C_050-259-5_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980923-105413-318_L1C_050-259-5_D_V1-0.zip
run script
2024-01-09T21:00:44.351    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:00:44.353    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980923-105413-318_L1C_050-259-5_D_V1-0.zip
2024-01-09T21:00:44.353    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:00:44.353    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:00:44.353    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:00:44.353    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:00:44.353    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:00:44.353    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:00:44.353    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:00:44.353    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980923-105413-318_L1C_050-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/23/SPOT1-HRV2-XS_19980923-105417-210_L1C_050-260-0_D_V1-0/SPOT1-HRV2-XS_19980923-105417-210_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980923-105417-210_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980923-105417-210_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T21:02:21.728    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:02:21.729    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980923-105417-210_L1C_050-260-0_D_V1-0.zip
2024-01-09T21:02:21.729    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:02:21.729    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:02:21.729    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:02:21.729    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:02:21.729    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:02:21.729    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:02:21.729    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:02:21.729    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980923-105417-210_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/23/SPOT1-HRV2-XS_19980923-105425-620_L1C_050-261-0_D_V1-0/SPOT1-HRV2-XS_19980923-105425-620_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980923-105425-620_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980923-105425-620_L1C_050-261-0_D_V1-0.zip
run script
2024-01-09T21:03:40.396    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:03:40.397    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980923-105425-620_L1C_050-261-0_D_V1-0.zip
2024-01-09T21:03:40.398    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:03:40.398    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:03:40.398    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:03:40.398    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:03:40.398    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:03:40.398    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:03:40.398    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:03:40.398    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980923-105425-620_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/23/SPOT1-HRV2-XS_19980923-105434-034_L1C_050-262-0_D_V1-0/SPOT1-HRV2-XS_19980923-105434-034_L1C_050-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980923-105434-034_L1C_050-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980923-105434-034_L1C_050-262-0_D_V1-0.zip
run script
2024-01-09T21:04:43.072    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:04:43.074    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980923-105434-034_L1C_050-262-0_D_V1-0.zip
2024-01-09T21:04:43.074    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:04:43.074    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:04:43.074    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:04:43.074    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:04:43.074    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:04:43.074    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:04:43.074    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:04:43.074    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980923-105434-034_L1C_050-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/28/SPOT1-HRV1-XS_19980628-102614-930_L1C_050-260-0_D_V1-0/SPOT1-HRV1-XS_19980628-102614-930_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980628-102614-930_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980628-102614-930_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T21:05:20.253    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:05:20.255    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980628-102614-930_L1C_050-260-0_D_V1-0.zip
2024-01-09T21:05:20.255    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:05:20.255    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:05:20.255    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:05:20.255    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:05:20.255    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:05:20.255    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:05:20.255    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:05:20.255    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980628-102614-930_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/28/SPOT1-HRV1-XS_19980628-102623-196_L1C_050-261-0_D_V1-0/SPOT1-HRV1-XS_19980628-102623-196_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980628-102623-196_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980628-102623-196_L1C_050-261-0_D_V1-0.zip
run script
2024-01-09T21:06:24.988    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:06:24.989    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980628-102623-196_L1C_050-261-0_D_V1-0.zip
2024-01-09T21:06:24.990    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:06:24.990    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:06:24.990    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:06:24.990    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:06:24.990    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:06:24.990    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:06:24.990    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:06:24.990    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980628-102623-196_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/28/SPOT1-HRV1-XS_19980628-102631-468_L1C_050-262-0_D_V1-0/SPOT1-HRV1-XS_19980628-102631-468_L1C_050-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980628-102631-468_L1C_050-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980628-102631-468_L1C_050-262-0_D_V1-0.zip
run script
2024-01-09T21:07:21.547    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:07:21.549    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980628-102631-468_L1C_050-262-0_D_V1-0.zip
2024-01-09T21:07:21.549    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:07:21.549    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:07:21.549    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:07:21.549    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:07:21.549    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:07:21.549    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:07:21.549    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:07:21.549    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980628-102631-468_L1C_050-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/28/SPOT1-HRV2-XS_19980628-102614-184_L1C_052-260-2_D_V1-0/SPOT1-HRV2-XS_19980628-102614-184_L1C_052-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980628-102614-184_L1C_052-260-2_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980628-102614-184_L1C_052-260-2_D_V1-0.zip
run script
2024-01-09T21:07:58.691    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:07:58.692    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980628-102614-184_L1C_052-260-2_D_V1-0.zip
2024-01-09T21:07:58.692    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:07:58.692    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:07:58.692    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:07:58.692    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:07:58.693    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:07:58.693    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:07:58.693    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:07:58.693    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T21:09:07.841    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 754). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980628-102614-184_L1C_052-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1998/06/28/SPOT1-HRV2-XS_19980628-102620-660_L1C_052-261-0_D_V1-0/SPOT1-HRV2-XS_19980628-102620-660_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980628-102620-660_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980628-102620-660_L1C_052-261-0_D_V1-0.zip
run script
2024-01-09T21:09:11.251    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:09:11.253    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980628-102620-660_L1C_052-261-0_D_V1-0.zip
2024-01-09T21:09:11.253    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:09:11.253    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:09:11.253    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:09:11.253    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:09:11.253    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:09:11.253    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:09:11.253    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:09:11.253    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980628-102620-660_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/28/SPOT1-HRV2-XS_19980628-102628-947_L1C_052-262-0_D_V1-0/SPOT1-HRV2-XS_19980628-102628-947_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980628-102628-947_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980628-102628-947_L1C_052-262-0_D_V1-0.zip
run script
2024-01-09T21:11:52.197    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:11:52.198    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980628-102628-947_L1C_052-262-0_D_V1-0.zip
2024-01-09T21:11:52.198    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:11:52.198    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:11:52.198    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:11:52.198    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:11:52.198    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:11:52.199    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:11:52.199    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:11:52.199    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980628-102628-947_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/17/SPOT1-HRV1-XS_19980617-103651-284_L1C_051-254-0_D_V1-0/SPOT1-HRV1-XS_19980617-103651-284_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980617-103651-284_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980617-103651-284_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T21:14:08.188    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:14:08.189    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980617-103651-284_L1C_051-254-0_D_V1-0.zip
2024-01-09T21:14:08.189    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:14:08.189    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:14:08.189    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:14:08.189    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:14:08.189    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:14:08.189    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:14:08.189    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:14:08.189    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980617-103651-284_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/06/17/SPOT1-HRV2-XS_19980617-103752-830_L1C_051-261-4_D_V1-0/SPOT1-HRV2-XS_19980617-103752-830_L1C_051-261-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980617-103752-830_L1C_051-261-4_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980617-103752-830_L1C_051-261-4_D_V1-0.zip
run script
2024-01-09T21:14:11.386    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:14:11.388    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980617-103752-830_L1C_051-261-4_D_V1-0.zip
2024-01-09T21:14:11.388    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:14:11.388    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:14:11.388    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:14:11.388    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:14:11.388    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:14:11.388    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:14:11.388    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:14:11.388    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T21:16:02.832    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (794 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980617-103752-830_L1C_051-261-4_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1998/06/17/SPOT1-HRV2-XS_19980617-103757-553_L1C_051-262-0_D_V1-0/SPOT1-HRV2-XS_19980617-103757-553_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980617-103757-553_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980617-103757-553_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T21:16:06.047    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:16:06.047    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980617-103757-553_L1C_051-262-0_D_V1-0.zip
2024-01-09T21:16:06.047    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:16:06.047    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:16:06.047    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:16:06.048    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:16:06.048    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:16:06.048    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:16:06.048    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:16:06.048    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980617-103757-553_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/17/SPOT1-HRV2-XS_19980617-103805-894_L1C_051-263-0_D_V1-0/SPOT1-HRV2-XS_19980617-103805-894_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980617-103805-894_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980617-103805-894_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T21:17:31.766    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:17:31.768    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980617-103805-894_L1C_051-263-0_D_V1-0.zip
2024-01-09T21:17:31.768    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:17:31.768    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:17:31.768    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:17:31.768    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:17:31.768    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:17:31.768    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:17:31.768    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:17:31.768    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980617-103805-894_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/10/25/SPOT1-HRV1-XS_19981025-103818-386_L1C_051-254-0_D_V1-0/SPOT1-HRV1-XS_19981025-103818-386_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19981025-103818-386_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19981025-103818-386_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T21:18:11.568    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:18:11.569    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19981025-103818-386_L1C_051-254-0_D_V1-0.zip
2024-01-09T21:18:11.569    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:18:11.569    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:18:11.569    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:18:11.569    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:18:11.569    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:18:11.569    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:18:11.569    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:18:11.569    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19981025-103818-386_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1998/05/21/SPOT1-HRV2-XS_19980521-105620-682_L1C_051-258-6_D_V1-0/SPOT1-HRV2-XS_19980521-105620-682_L1C_051-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980521-105620-682_L1C_051-258-6_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980521-105620-682_L1C_051-258-6_D_V1-0.zip
run script
2024-01-09T21:18:14.786    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:18:14.787    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980521-105620-682_L1C_051-258-6_D_V1-0.zip
2024-01-09T21:18:14.787    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:18:14.787    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:18:14.788    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:18:14.788    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:18:14.788    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:18:14.788    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:18:14.788    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:18:14.788    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980521-105620-682_L1C_051-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/21/SPOT1-HRV2-XS_19980521-105623-718_L1C_051-259-0_D_V1-0/SPOT1-HRV2-XS_19980521-105623-718_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980521-105623-718_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980521-105623-718_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T21:21:51.190    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:21:51.192    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980521-105623-718_L1C_051-259-0_D_V1-0.zip
2024-01-09T21:21:51.192    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:21:51.192    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:21:51.192    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:21:51.192    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:21:51.192    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:21:51.193    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:21:51.193    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:21:51.193    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980521-105623-718_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/21/SPOT1-HRV2-XS_19980521-105632-173_L1C_051-260-0_D_V1-0/SPOT1-HRV2-XS_19980521-105632-173_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980521-105632-173_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980521-105632-173_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T21:25:25.080    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:25:25.081    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980521-105632-173_L1C_051-260-0_D_V1-0.zip
2024-01-09T21:25:25.081    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:25:25.081    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:25:25.081    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:25:25.081    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:25:25.081    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:25:25.081    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:25:25.082    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:25:25.082    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980521-105632-173_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/21/SPOT1-HRV2-XS_19980521-105640-628_L1C_051-261-0_D_V1-0/SPOT1-HRV2-XS_19980521-105640-628_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980521-105640-628_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980521-105640-628_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T21:28:13.290    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:28:13.291    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980521-105640-628_L1C_051-261-0_D_V1-0.zip
2024-01-09T21:28:13.291    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:28:13.291    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:28:13.291    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:28:13.291    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:28:13.291    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:28:13.292    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:28:13.292    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:28:13.292    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T21:30:28.113    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (130 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980521-105640-628_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1998/05/21/SPOT1-HRV2-XS_19980521-105649-090_L1C_051-262-0_D_V1-0/SPOT1-HRV2-XS_19980521-105649-090_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980521-105649-090_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980521-105649-090_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T21:30:31.363    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:30:31.364    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980521-105649-090_L1C_051-262-0_D_V1-0.zip
2024-01-09T21:30:31.364    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:30:31.364    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:30:31.364    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:30:31.364    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:30:31.364    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:30:31.364    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:30:31.364    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:30:31.364    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980521-105649-090_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/21/SPOT1-HRV2-XS_19980521-105657-554_L1C_051-263-0_D_V1-0/SPOT1-HRV2-XS_19980521-105657-554_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980521-105657-554_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980521-105657-554_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T21:32:08.199    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:32:08.201    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980521-105657-554_L1C_051-263-0_D_V1-0.zip
2024-01-09T21:32:08.201    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:32:08.201    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:32:08.201    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:32:08.201    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:32:08.201    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:32:08.201    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:32:08.201    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:32:08.201    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980521-105657-554_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/21/SPOT1-HRV1-XS_19980521-105638-183_L1C_052-261-0_D_V1-0/SPOT1-HRV1-XS_19980521-105638-183_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980521-105638-183_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980521-105638-183_L1C_052-261-0_D_V1-0.zip
run script
2024-01-09T21:32:41.090    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:32:41.091    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980521-105638-183_L1C_052-261-0_D_V1-0.zip
2024-01-09T21:32:41.091    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:32:41.091    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:32:41.091    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:32:41.091    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:32:41.091    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:32:41.091    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:32:41.092    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:32:41.092    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980521-105638-183_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/21/SPOT1-HRV1-XS_19980521-105646-672_L1C_052-262-0_D_V1-0/SPOT1-HRV1-XS_19980521-105646-672_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980521-105646-672_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980521-105646-672_L1C_052-262-0_D_V1-0.zip
run script
2024-01-09T21:36:04.028    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:36:04.030    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980521-105646-672_L1C_052-262-0_D_V1-0.zip
2024-01-09T21:36:04.030    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:36:04.030    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:36:04.030    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:36:04.030    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:36:04.030    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:36:04.030    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:36:04.030    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:36:04.030    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980521-105646-672_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/21/SPOT1-HRV1-XS_19980521-105655-160_L1C_052-263-0_D_V1-0/SPOT1-HRV1-XS_19980521-105655-160_L1C_052-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980521-105655-160_L1C_052-263-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980521-105655-160_L1C_052-263-0_D_V1-0.zip
run script
2024-01-09T21:39:00.290    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:39:00.291    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980521-105655-160_L1C_052-263-0_D_V1-0.zip
2024-01-09T21:39:00.291    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:39:00.291    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:39:00.292    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:39:00.292    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:39:00.292    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:39:00.292    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:39:00.292    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:39:00.292    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980521-105655-160_L1C_052-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/21/SPOT1-HRV1-XS_19980521-105621-215_L1C_053-259-0_D_V1-0/SPOT1-HRV1-XS_19980521-105621-215_L1C_053-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980521-105621-215_L1C_053-259-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980521-105621-215_L1C_053-259-0_D_V1-0.zip
run script
2024-01-09T21:40:22.035    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:40:22.035    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980521-105621-215_L1C_053-259-0_D_V1-0.zip
2024-01-09T21:40:22.035    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:40:22.036    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:40:22.036    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:40:22.036    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:40:22.036    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:40:22.036    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:40:22.036    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:40:22.036    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980521-105621-215_L1C_053-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 1]
 [0 0 0 ... 0 1 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/21/SPOT1-HRV1-XS_19980521-105629-697_L1C_053-260-0_D_V1-0/SPOT1-HRV1-XS_19980521-105629-697_L1C_053-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980521-105629-697_L1C_053-260-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980521-105629-697_L1C_053-260-0_D_V1-0.zip
run script
2024-01-09T21:43:49.726    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:43:49.727    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980521-105629-697_L1C_053-260-0_D_V1-0.zip
2024-01-09T21:43:49.727    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:43:49.727    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:43:49.727    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:43:49.727    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:43:49.728    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:43:49.728    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:43:49.728    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:43:49.728    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T21:44:56.597    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 244). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980521-105629-697_L1C_053-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1998/05/26/SPOT1-HRV1-XS_19980526-110024-310_L1C_051-259-5_D_V1-0/SPOT1-HRV1-XS_19980526-110024-310_L1C_051-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980526-110024-310_L1C_051-259-5_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980526-110024-310_L1C_051-259-5_D_V1-0.zip
run script
2024-01-09T21:44:59.802    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:44:59.803    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980526-110024-310_L1C_051-259-5_D_V1-0.zip
2024-01-09T21:44:59.803    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:44:59.803    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:44:59.803    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:44:59.803    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:44:59.803    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:44:59.803    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:44:59.803    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:44:59.803    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980526-110024-310_L1C_051-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/26/SPOT1-HRV1-XS_19980526-110028-293_L1C_051-260-0_D_V1-0/SPOT1-HRV1-XS_19980526-110028-293_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980526-110028-293_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980526-110028-293_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T21:48:47.308    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:48:47.309    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980526-110028-293_L1C_051-260-0_D_V1-0.zip
2024-01-09T21:48:47.310    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:48:47.310    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:48:47.310    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:48:47.310    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:48:47.310    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:48:47.310    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:48:47.310    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:48:47.310    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980526-110028-293_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/26/SPOT1-HRV1-XS_19980526-110037-690_L1C_051-261-1_D_V1-0/SPOT1-HRV1-XS_19980526-110037-690_L1C_051-261-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980526-110037-690_L1C_051-261-1_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980526-110037-690_L1C_051-261-1_D_V1-0.zip
run script
2024-01-09T21:52:14.388    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:52:14.389    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980526-110037-690_L1C_051-261-1_D_V1-0.zip
2024-01-09T21:52:14.389    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:52:14.389    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:52:14.389    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:52:14.389    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:52:14.389    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:52:14.389    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:52:14.389    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:52:14.389    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980526-110037-690_L1C_051-261-1_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/02/18/SPOT1-HRV2-XS_19980218-102426-230_L1C_051-260-8_D_V1-0/SPOT1-HRV2-XS_19980218-102426-230_L1C_051-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980218-102426-230_L1C_051-260-8_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980218-102426-230_L1C_051-260-8_D_V1-0.zip
run script
2024-01-09T21:55:11.084    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:55:11.085    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980218-102426-230_L1C_051-260-8_D_V1-0.zip
2024-01-09T21:55:11.085    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:55:11.085    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:55:11.085    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:55:11.085    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:55:11.086    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:55:11.086    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:55:11.086    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:55:11.086    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980218-102426-230_L1C_051-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/02/18/SPOT1-HRV2-XS_19980218-102427-286_L1C_051-261-0_D_V1-0/SPOT1-HRV2-XS_19980218-102427-286_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980218-102427-286_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980218-102427-286_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T21:57:18.656    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:57:18.657    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980218-102427-286_L1C_051-261-0_D_V1-0.zip
2024-01-09T21:57:18.657    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:57:18.657    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:57:18.657    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:57:18.657    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:57:18.658    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:57:18.658    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:57:18.658    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:57:18.658    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T21:59:19.162    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (120 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980218-102427-286_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1998/02/18/SPOT1-HRV2-XS_19980218-102435-567_L1C_051-262-0_D_V1-0/SPOT1-HRV2-XS_19980218-102435-567_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980218-102435-567_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980218-102435-567_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T21:59:22.018    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:59:22.019    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980218-102435-567_L1C_051-262-0_D_V1-0.zip
2024-01-09T21:59:22.019    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:59:22.019    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:59:22.019    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:59:22.019    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:59:22.019    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:59:22.019    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:59:22.019    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:59:22.019    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980218-102435-567_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/02/18/SPOT1-HRV2-XS_19980218-102443-854_L1C_051-263-0_D_V1-0/SPOT1-HRV2-XS_19980218-102443-854_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980218-102443-854_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980218-102443-854_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T22:00:57.712    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:00:57.713    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980218-102443-854_L1C_051-263-0_D_V1-0.zip
2024-01-09T22:00:57.713    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:00:57.714    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:00:57.714    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:00:57.714    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:00:57.714    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:00:57.714    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:00:57.714    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:00:57.714    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980218-102443-854_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/18/SPOT1-HRV2-XS_19980918-105022-965_L1C_051-260-0_D_V1-0/SPOT1-HRV2-XS_19980918-105022-965_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980918-105022-965_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980918-105022-965_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T22:01:35.194    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:01:35.195    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980918-105022-965_L1C_051-260-0_D_V1-0.zip
2024-01-09T22:01:35.195    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:01:35.195    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:01:35.195    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:01:35.195    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:01:35.195    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:01:35.196    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:01:35.196    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:01:35.196    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980918-105022-965_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/18/SPOT1-HRV2-XS_19980918-105031-363_L1C_051-261-0_D_V1-0/SPOT1-HRV2-XS_19980918-105031-363_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980918-105031-363_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980918-105031-363_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T22:04:02.024    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:04:02.025    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980918-105031-363_L1C_051-261-0_D_V1-0.zip
2024-01-09T22:04:02.025    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:04:02.025    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:04:02.025    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:04:02.026    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:04:02.026    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:04:02.026    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:04:02.026    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:04:02.026    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980918-105031-363_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/18/SPOT1-HRV2-XS_19980918-105039-768_L1C_051-262-0_D_V1-0/SPOT1-HRV2-XS_19980918-105039-768_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980918-105039-768_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980918-105039-768_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T22:06:20.682    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:06:20.684    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980918-105039-768_L1C_051-262-0_D_V1-0.zip
2024-01-09T22:06:20.684    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:06:20.684    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:06:20.684    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:06:20.684    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:06:20.684    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:06:20.684    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:06:20.684    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:06:20.684    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980918-105039-768_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/18/SPOT1-HRV2-XS_19980918-105048-175_L1C_051-263-0_D_V1-0/SPOT1-HRV2-XS_19980918-105048-175_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980918-105048-175_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980918-105048-175_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T22:08:03.627    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:08:03.628    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980918-105048-175_L1C_051-263-0_D_V1-0.zip
2024-01-09T22:08:03.628    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:08:03.628    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:08:03.628    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:08:03.628    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:08:03.628    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:08:03.629    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:08:03.629    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:08:03.629    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980918-105048-175_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/18/SPOT1-HRV1-XS_19980918-105029-402_L1C_052-261-0_D_V1-0/SPOT1-HRV1-XS_19980918-105029-402_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980918-105029-402_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980918-105029-402_L1C_052-261-0_D_V1-0.zip
run script
2024-01-09T22:08:41.053    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:08:41.054    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980918-105029-402_L1C_052-261-0_D_V1-0.zip
2024-01-09T22:08:41.054    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:08:41.054    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:08:41.055    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:08:41.055    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:08:41.055    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:08:41.055    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:08:41.055    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:08:41.055    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980918-105029-402_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/18/SPOT1-HRV1-XS_19980918-105037-825_L1C_052-262-0_D_V1-0/SPOT1-HRV1-XS_19980918-105037-825_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980918-105037-825_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980918-105037-825_L1C_052-262-0_D_V1-0.zip
run script
2024-01-09T22:11:36.565    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:11:36.566    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980918-105037-825_L1C_052-262-0_D_V1-0.zip
2024-01-09T22:11:36.566    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:11:36.566    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:11:36.566    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:11:36.567    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:11:36.567    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:11:36.567    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:11:36.567    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:11:36.567    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980918-105037-825_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/09/18/SPOT1-HRV1-XS_19980918-105046-253_L1C_052-263-0_D_V1-0/SPOT1-HRV1-XS_19980918-105046-253_L1C_052-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980918-105046-253_L1C_052-263-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980918-105046-253_L1C_052-263-0_D_V1-0.zip
run script
2024-01-09T22:14:10.747    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:14:10.749    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980918-105046-253_L1C_052-263-0_D_V1-0.zip
2024-01-09T22:14:10.749    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:14:10.749    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:14:10.749    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:14:10.749    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:14:10.749    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:14:10.749    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:14:10.749    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:14:10.749    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980918-105046-253_L1C_052-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/12/SPOT1-HRV2-XS_19980612-103353-435_L1C_051-261-0_D_V1-0/SPOT1-HRV2-XS_19980612-103353-435_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980612-103353-435_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980612-103353-435_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T22:15:12.688    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:15:12.690    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980612-103353-435_L1C_051-261-0_D_V1-0.zip
2024-01-09T22:15:12.690    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:15:12.690    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:15:12.690    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:15:12.690    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:15:12.690    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:15:12.690    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:15:12.690    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:15:12.690    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980612-103353-435_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/12/SPOT1-HRV2-XS_19980612-103358-849_L1C_051-261-6_D_V1-0/SPOT1-HRV2-XS_19980612-103358-849_L1C_051-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980612-103358-849_L1C_051-261-6_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980612-103358-849_L1C_051-261-6_D_V1-0.zip
run script
2024-01-09T22:17:12.357    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:17:12.358    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980612-103358-849_L1C_051-261-6_D_V1-0.zip
2024-01-09T22:17:12.358    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:17:12.359    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:17:12.359    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:17:12.359    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:17:12.359    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:17:12.368    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:17:12.368    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:17:12.368    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980612-103358-849_L1C_051-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/18/SPOT1-HRV2-XS_19980718-104159-823_L1C_051-261-0_D_V1-0/SPOT1-HRV2-XS_19980718-104159-823_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980718-104159-823_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980718-104159-823_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T22:18:56.077    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:18:56.078    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980718-104159-823_L1C_051-261-0_D_V1-0.zip
2024-01-09T22:18:56.078    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:18:56.079    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:18:56.079    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:18:56.079    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:18:56.079    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:18:56.079    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:18:56.079    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:18:56.079    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980718-104159-823_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/18/SPOT1-HRV2-XS_19980718-104208-173_L1C_051-262-0_D_V1-0/SPOT1-HRV2-XS_19980718-104208-173_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980718-104208-173_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980718-104208-173_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T22:20:57.957    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:20:57.958    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980718-104208-173_L1C_051-262-0_D_V1-0.zip
2024-01-09T22:20:57.958    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:20:57.958    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:20:57.959    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:20:57.959    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:20:57.959    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:20:57.959    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:20:57.959    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:20:57.959    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980718-104208-173_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/18/SPOT1-HRV2-XS_19980718-104209-978_L1C_051-262-2_D_V1-0/SPOT1-HRV2-XS_19980718-104209-978_L1C_051-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980718-104209-978_L1C_051-262-2_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980718-104209-978_L1C_051-262-2_D_V1-0.zip
run script
2024-01-09T22:22:35.491    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:22:35.493    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980718-104209-978_L1C_051-262-2_D_V1-0.zip
2024-01-09T22:22:35.493    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:22:35.493    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:22:35.493    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:22:35.493    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:22:35.493    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:22:35.493    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:22:35.493    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:22:35.493    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980718-104209-978_L1C_051-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/17/SPOT1-HRV2-XS_19980517-103307-616_L1C_052-258-8_D_V1-0/SPOT1-HRV2-XS_19980517-103307-616_L1C_052-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980517-103307-616_L1C_052-258-8_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980517-103307-616_L1C_052-258-8_D_V1-0.zip
run script
2024-01-09T22:24:08.514    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:24:08.515    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980517-103307-616_L1C_052-258-8_D_V1-0.zip
2024-01-09T22:24:08.515    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:24:08.515    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:24:08.515    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:24:08.515    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:24:08.515    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:24:08.515    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:24:08.515    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:24:08.515    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980517-103307-616_L1C_052-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/17/SPOT1-HRV2-XS_19980517-103308-698_L1C_053-259-0_D_V1-0/SPOT1-HRV2-XS_19980517-103308-698_L1C_053-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980517-103308-698_L1C_053-259-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980517-103308-698_L1C_053-259-0_D_V1-0.zip
run script
2024-01-09T22:26:32.511    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:26:32.513    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980517-103308-698_L1C_053-259-0_D_V1-0.zip
2024-01-09T22:26:32.513    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:26:32.513    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:26:32.513    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:26:32.513    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:26:32.513    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:26:32.513    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:26:32.513    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:26:32.513    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980517-103308-698_L1C_053-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/17/SPOT1-HRV2-XS_19980517-103317-007_L1C_053-260-0_D_V1-0/SPOT1-HRV2-XS_19980517-103317-007_L1C_053-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980517-103317-007_L1C_053-260-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980517-103317-007_L1C_053-260-0_D_V1-0.zip
run script
2024-01-09T22:28:57.240    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:28:57.241    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980517-103317-007_L1C_053-260-0_D_V1-0.zip
2024-01-09T22:28:57.241    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:28:57.241    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:28:57.241    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:28:57.241    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:28:57.241    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:28:57.241    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:28:57.241    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:28:57.241    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980517-103317-007_L1C_053-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/17/SPOT1-HRV2-XS_19980517-103325-327_L1C_053-261-0_D_V1-0/SPOT1-HRV2-XS_19980517-103325-327_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980517-103325-327_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980517-103325-327_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T22:31:20.914    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:31:20.916    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980517-103325-327_L1C_053-261-0_D_V1-0.zip
2024-01-09T22:31:20.916    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:31:20.916    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:31:20.916    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:31:20.916    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:31:20.916    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:31:20.916    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:31:20.916    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:31:20.916    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980517-103325-327_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/17/SPOT1-HRV2-XS_19980517-103333-650_L1C_053-262-0_D_V1-0/SPOT1-HRV2-XS_19980517-103333-650_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980517-103333-650_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980517-103333-650_L1C_053-262-0_D_V1-0.zip
run script
2024-01-09T22:33:56.124    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:33:56.126    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980517-103333-650_L1C_053-262-0_D_V1-0.zip
2024-01-09T22:33:56.126    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:33:56.126    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:33:56.126    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:33:56.126    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:33:56.126    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:33:56.126    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:33:56.126    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:33:56.126    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980517-103333-650_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/13/SPOT1-HRV1-XS_19980713-103743-276_L1C_052-258-4_D_V1-0/SPOT1-HRV1-XS_19980713-103743-276_L1C_052-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980713-103743-276_L1C_052-258-4_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980713-103743-276_L1C_052-258-4_D_V1-0.zip
run script
2024-01-09T22:36:10.641    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:36:10.642    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980713-103743-276_L1C_052-258-4_D_V1-0.zip
2024-01-09T22:36:10.642    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:36:10.642    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:36:10.642    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:36:10.642    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:36:10.642    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:36:10.642    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:36:10.642    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:36:10.643    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:36:12.803    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 130). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980713-103743-276_L1C_052-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1998/07/13/SPOT1-HRV1-XS_19980713-103747-986_L1C_052-259-0_D_V1-0/SPOT1-HRV1-XS_19980713-103747-986_L1C_052-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980713-103747-986_L1C_052-259-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980713-103747-986_L1C_052-259-0_D_V1-0.zip
run script
2024-01-09T22:36:16.026    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:36:16.027    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980713-103747-986_L1C_052-259-0_D_V1-0.zip
2024-01-09T22:36:16.027    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:36:16.027    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:36:16.027    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:36:16.027    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:36:16.027    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:36:16.027    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:36:16.027    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:36:16.027    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980713-103747-986_L1C_052-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/13/SPOT1-HRV1-XS_19980713-103756-315_L1C_052-260-0_D_V1-0/SPOT1-HRV1-XS_19980713-103756-315_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980713-103756-315_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980713-103756-315_L1C_052-260-0_D_V1-0.zip
run script
2024-01-09T22:38:58.356    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:38:58.357    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980713-103756-315_L1C_052-260-0_D_V1-0.zip
2024-01-09T22:38:58.357    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:38:58.357    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:38:58.357    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:38:58.357    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:38:58.357    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:38:58.357    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:38:58.358    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:38:58.358    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980713-103756-315_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/13/SPOT1-HRV1-XS_19980713-103804-653_L1C_052-261-0_D_V1-0/SPOT1-HRV1-XS_19980713-103804-653_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980713-103804-653_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980713-103804-653_L1C_052-261-0_D_V1-0.zip
run script
2024-01-09T22:41:24.676    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:41:24.677    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980713-103804-653_L1C_052-261-0_D_V1-0.zip
2024-01-09T22:41:24.677    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:41:24.677    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:41:24.677    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:41:24.677    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:41:24.677    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:41:24.677    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:41:24.677    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:41:24.677    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980713-103804-653_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/28/SPOT1-HRV2-XS_19980728-104941-587_L1C_052-259-8_D_V1-0/SPOT1-HRV2-XS_19980728-104941-587_L1C_052-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980728-104941-587_L1C_052-259-8_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980728-104941-587_L1C_052-259-8_D_V1-0.zip
run script
2024-01-09T22:44:02.740    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:44:02.742    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980728-104941-587_L1C_052-259-8_D_V1-0.zip
2024-01-09T22:44:02.742    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:44:02.742    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:44:02.742    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:44:02.742    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:44:02.742    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:44:02.742    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:44:02.742    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:44:02.742    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980728-104941-587_L1C_052-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/28/SPOT1-HRV2-XS_19980728-104942-775_L1C_052-260-0_D_V1-0/SPOT1-HRV2-XS_19980728-104942-775_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980728-104942-775_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980728-104942-775_L1C_052-260-0_D_V1-0.zip
run script
2024-01-09T22:46:52.129    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:46:52.130    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980728-104942-775_L1C_052-260-0_D_V1-0.zip
2024-01-09T22:46:52.130    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:46:52.130    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:46:52.130    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:46:52.130    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:46:52.131    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:46:52.131    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:46:52.131    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:46:52.131    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980728-104942-775_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/28/SPOT1-HRV2-XS_19980728-104949-994_L1C_052-260-8_D_V1-0/SPOT1-HRV2-XS_19980728-104949-994_L1C_052-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980728-104949-994_L1C_052-260-8_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980728-104949-994_L1C_052-260-8_D_V1-0.zip
run script
2024-01-09T22:49:37.322    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:49:37.323    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980728-104949-994_L1C_052-260-8_D_V1-0.zip
2024-01-09T22:49:37.323    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:49:37.323    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:49:37.323    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:49:37.323    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:49:37.323    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:49:37.323    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:49:37.323    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:49:37.323    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980728-104949-994_L1C_052-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/28/SPOT1-HRV1-XS_19980728-104950-018_L1C_054-261-1_D_V1-0/SPOT1-HRV1-XS_19980728-104950-018_L1C_054-261-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980728-104950-018_L1C_054-261-1_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980728-104950-018_L1C_054-261-1_D_V1-0.zip
run script
2024-01-09T22:52:32.787    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:52:32.788    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980728-104950-018_L1C_054-261-1_D_V1-0.zip
2024-01-09T22:52:32.788    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:52:32.788    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:52:32.788    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:52:32.788    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:52:32.788    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:52:32.788    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:52:32.788    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:52:32.788    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980728-104950-018_L1C_054-261-1_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/04/06/SPOT1-HRV2-XS_19980406-102113-761_L1C_052-260-9_D_V1-0/SPOT1-HRV2-XS_19980406-102113-761_L1C_052-260-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980406-102113-761_L1C_052-260-9_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980406-102113-761_L1C_052-260-9_D_V1-0.zip
run script
2024-01-09T22:55:05.577    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:55:05.578    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980406-102113-761_L1C_052-260-9_D_V1-0.zip
2024-01-09T22:55:05.579    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:55:05.579    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:55:05.579    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:55:05.579    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:55:05.579    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:55:05.579    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:55:05.579    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:55:05.579    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980406-102113-761_L1C_052-260-9_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/04/06/SPOT1-HRV2-XS_19980406-102113-906_L1C_053-261-0_D_V1-0/SPOT1-HRV2-XS_19980406-102113-906_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980406-102113-906_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980406-102113-906_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T22:57:51.436    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:57:51.437    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980406-102113-906_L1C_053-261-0_D_V1-0.zip
2024-01-09T22:57:51.437    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:57:51.437    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:57:51.438    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:57:51.438    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:57:51.438    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:57:51.438    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:57:51.438    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:57:51.438    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980406-102113-906_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/04/06/SPOT1-HRV2-XS_19980406-102122-181_L1C_053-262-0_D_V1-0/SPOT1-HRV2-XS_19980406-102122-181_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980406-102122-181_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980406-102122-181_L1C_053-262-0_D_V1-0.zip
run script
2024-01-09T23:00:37.665    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:00:37.666    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980406-102122-181_L1C_053-262-0_D_V1-0.zip
2024-01-09T23:00:37.667    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:00:37.667    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:00:37.667    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:00:37.667    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:00:37.667    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:00:37.667    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:00:37.667    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:00:37.667    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980406-102122-181_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/18/SPOT1-HRV1-XS_19980618-101827-784_L1C_052-260-8_D_V1-0/SPOT1-HRV1-XS_19980618-101827-784_L1C_052-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980618-101827-784_L1C_052-260-8_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980618-101827-784_L1C_052-260-8_D_V1-0.zip
run script
2024-01-09T23:02:58.014    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:02:58.015    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980618-101827-784_L1C_052-260-8_D_V1-0.zip
2024-01-09T23:02:58.015    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:02:58.015    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:02:58.015    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:02:58.015    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:02:58.015    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:02:58.015    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:02:58.016    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:02:58.016    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980618-101827-784_L1C_052-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/18/SPOT1-HRV1-XS_19980618-101828-822_L1C_052-261-0_D_V1-0/SPOT1-HRV1-XS_19980618-101828-822_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980618-101828-822_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980618-101828-822_L1C_052-261-0_D_V1-0.zip
run script
2024-01-09T23:05:49.035    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:05:49.036    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980618-101828-822_L1C_052-261-0_D_V1-0.zip
2024-01-09T23:05:49.036    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:05:49.036    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:05:49.036    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:05:49.036    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:05:49.036    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:05:49.036    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:05:49.036    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:05:49.036    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980618-101828-822_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/18/SPOT1-HRV1-XS_19980618-101837-088_L1C_053-262-0_D_V1-0/SPOT1-HRV1-XS_19980618-101837-088_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980618-101837-088_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980618-101837-088_L1C_053-262-0_D_V1-0.zip
run script
2024-01-09T23:08:39.609    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:08:39.611    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980618-101837-088_L1C_053-262-0_D_V1-0.zip
2024-01-09T23:08:39.611    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:08:39.611    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:08:39.611    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:08:39.611    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:08:39.611    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:08:39.611    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:08:39.611    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:08:39.611    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980618-101837-088_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/03/05/SPOT1-HRV1-XS_19980305-103614-201_L1C_052-261-0_D_V1-0/SPOT1-HRV1-XS_19980305-103614-201_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980305-103614-201_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980305-103614-201_L1C_052-261-0_D_V1-0.zip
run script
2024-01-09T23:11:05.359    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:11:05.360    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980305-103614-201_L1C_052-261-0_D_V1-0.zip
2024-01-09T23:11:05.360    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:11:05.360    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:11:05.360    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:11:05.361    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:11:05.361    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:11:05.361    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:11:05.361    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:11:05.361    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980305-103614-201_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 0]
 [2 2 2 ... 2 0 0]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/03/05/SPOT1-HRV1-XS_19980305-103622-545_L1C_052-262-0_D_V1-0/SPOT1-HRV1-XS_19980305-103622-545_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980305-103622-545_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980305-103622-545_L1C_052-262-0_D_V1-0.zip
run script
2024-01-09T23:13:42.099    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:13:42.100    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980305-103622-545_L1C_052-262-0_D_V1-0.zip
2024-01-09T23:13:42.100    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:13:42.100    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:13:42.101    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:13:42.101    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:13:42.101    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:13:42.101    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:13:42.101    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:13:42.101    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980305-103622-545_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/12/SPOT1-HRV2-XS_19980512-102934-866_L1C_052-261-8_D_V1-0/SPOT1-HRV2-XS_19980512-102934-866_L1C_052-261-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980512-102934-866_L1C_052-261-8_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980512-102934-866_L1C_052-261-8_D_V1-0.zip
run script
2024-01-09T23:15:57.149    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:15:57.151    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980512-102934-866_L1C_052-261-8_D_V1-0.zip
2024-01-09T23:15:57.151    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:15:57.151    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:15:57.151    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:15:57.151    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:15:57.151    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:15:57.151    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:15:57.151    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:15:57.151    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980512-102934-866_L1C_052-261-8_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/12/SPOT1-HRV2-XS_19980512-102935-949_L1C_052-262-0_D_V1-0/SPOT1-HRV2-XS_19980512-102935-949_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980512-102935-949_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980512-102935-949_L1C_052-262-0_D_V1-0.zip
run script
2024-01-09T23:18:11.892    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:18:11.893    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980512-102935-949_L1C_052-262-0_D_V1-0.zip
2024-01-09T23:18:11.894    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:18:11.894    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:18:11.894    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:18:11.894    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:18:11.894    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:18:11.894    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:18:11.894    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:18:11.894    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980512-102935-949_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/08/SPOT1-HRV1-XS_19980708-103418-441_L1C_052-261-9_D_V1-0/SPOT1-HRV1-XS_19980708-103418-441_L1C_052-261-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980708-103418-441_L1C_052-261-9_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980708-103418-441_L1C_052-261-9_D_V1-0.zip
run script
2024-01-09T23:20:26.853    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:20:26.854    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980708-103418-441_L1C_052-261-9_D_V1-0.zip
2024-01-09T23:20:26.854    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:20:26.855    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:20:26.855    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:20:26.855    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:20:26.855    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:20:26.855    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:20:26.855    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:20:26.855    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980708-103418-441_L1C_052-261-9_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/08/SPOT1-HRV1-XS_19980708-103421-350_L1C_052-262-3_D_V1-0/SPOT1-HRV1-XS_19980708-103421-350_L1C_052-262-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980708-103421-350_L1C_052-262-3_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980708-103421-350_L1C_052-262-3_D_V1-0.zip
run script
2024-01-09T23:22:39.323    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:22:39.324    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980708-103421-350_L1C_052-262-3_D_V1-0.zip
2024-01-09T23:22:39.324    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:22:39.324    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:22:39.324    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:22:39.324    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:22:39.324    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:22:39.325    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:22:39.325    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:22:39.325    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980708-103421-350_L1C_052-262-3_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/09/SPOT1-HRV1-XS_19980809-101906-800_L1C_053-260-7_D_V1-0/SPOT1-HRV1-XS_19980809-101906-800_L1C_053-260-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980809-101906-800_L1C_053-260-7_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980809-101906-800_L1C_053-260-7_D_V1-0.zip
run script
2024-01-09T23:24:44.164    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:24:44.165    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980809-101906-800_L1C_053-260-7_D_V1-0.zip
2024-01-09T23:24:44.165    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:24:44.165    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:24:44.165    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:24:44.165    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:24:44.165    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:24:44.165    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:24:44.165    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:24:44.165    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980809-101906-800_L1C_053-260-7_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/09/SPOT1-HRV1-XS_19980809-101908-743_L1C_054-261-0_D_V1-0/SPOT1-HRV1-XS_19980809-101908-743_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980809-101908-743_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980809-101908-743_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T23:26:52.677    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:26:52.678    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980809-101908-743_L1C_054-261-0_D_V1-0.zip
2024-01-09T23:26:52.678    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:26:52.678    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:26:52.678    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:26:52.678    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:26:52.678    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:26:52.678    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:26:52.678    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:26:52.678    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980809-101908-743_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/08/09/SPOT1-HRV1-XS_19980809-101917-012_L1C_054-262-0_D_V1-0/SPOT1-HRV1-XS_19980809-101917-012_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980809-101917-012_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980809-101917-012_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T23:29:04.606    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:29:04.607    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980809-101917-012_L1C_054-262-0_D_V1-0.zip
2024-01-09T23:29:04.607    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:29:04.607    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:29:04.608    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:29:04.608    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:29:04.608    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:29:04.608    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:29:04.608    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:29:04.608    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980809-101917-012_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/07/SPOT1-HRV1-XS_19980607-103003-814_L1C_053-262-0_D_V1-0/SPOT1-HRV1-XS_19980607-103003-814_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980607-103003-814_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980607-103003-814_L1C_053-262-0_D_V1-0.zip
run script
2024-01-09T23:31:14.805    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:31:14.806    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980607-103003-814_L1C_053-262-0_D_V1-0.zip
2024-01-09T23:31:14.806    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:31:14.806    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:31:14.807    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:31:14.807    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:31:14.807    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:31:14.807    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:31:14.807    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:31:14.807    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980607-103003-814_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/02/SPOT1-HRV1-XS_19980602-102554-459_L1C_054-260-6_D_V1-0/SPOT1-HRV1-XS_19980602-102554-459_L1C_054-260-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980602-102554-459_L1C_054-260-6_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980602-102554-459_L1C_054-260-6_D_V1-0.zip
run script
2024-01-09T23:33:27.540    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:33:27.541    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980602-102554-459_L1C_054-260-6_D_V1-0.zip
2024-01-09T23:33:27.541    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:33:27.542    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:33:27.542    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:33:27.542    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:33:27.542    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:33:27.542    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:33:27.542    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:33:27.542    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980602-102554-459_L1C_054-260-6_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/02/SPOT1-HRV1-XS_19980602-102557-338_L1C_054-261-0_D_V1-0/SPOT1-HRV1-XS_19980602-102557-338_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980602-102557-338_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980602-102557-338_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T23:35:14.864    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:35:14.865    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980602-102557-338_L1C_054-261-0_D_V1-0.zip
2024-01-09T23:35:14.865    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:35:14.865    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:35:14.865    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:35:14.865    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:35:14.865    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:35:14.866    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:35:14.866    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:35:14.866    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980602-102557-338_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/02/SPOT1-HRV1-XS_19980602-102605-640_L1C_054-262-0_D_V1-0/SPOT1-HRV1-XS_19980602-102605-640_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980602-102605-640_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980602-102605-640_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T23:37:06.810    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:37:06.811    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980602-102605-640_L1C_054-262-0_D_V1-0.zip
2024-01-09T23:37:06.811    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:37:06.811    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:37:06.811    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:37:06.811    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:37:06.811    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:37:06.811    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:37:06.811    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:37:06.811    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980602-102605-640_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/06/13/SPOT1-HRV2-XS_19980613-101429-928_L1C_054-260-8_D_V1-0/SPOT1-HRV2-XS_19980613-101429-928_L1C_054-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980613-101429-928_L1C_054-260-8_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980613-101429-928_L1C_054-260-8_D_V1-0.zip
run script
2024-01-09T23:38:51.339    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:38:51.341    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980613-101429-928_L1C_054-260-8_D_V1-0.zip
2024-01-09T23:38:51.341    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:38:51.341    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:38:51.341    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:38:51.341    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:38:51.341    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:38:51.341    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:38:51.341    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:38:51.341    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980613-101429-928_L1C_054-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/29/SPOT1-HRV2-XS_19980729-103030-814_L1C_054-260-7_D_V1-0/SPOT1-HRV2-XS_19980729-103030-814_L1C_054-260-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980729-103030-814_L1C_054-260-7_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980729-103030-814_L1C_054-260-7_D_V1-0.zip
run script
2024-01-09T23:40:36.124    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:40:36.125    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980729-103030-814_L1C_054-260-7_D_V1-0.zip
2024-01-09T23:40:36.125    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:40:36.125    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:40:36.125    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:40:36.125    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:40:36.125    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:40:36.125    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:40:36.125    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:40:36.125    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980729-103030-814_L1C_054-260-7_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/29/SPOT1-HRV2-XS_19980729-103032-802_L1C_054-261-0_D_V1-0/SPOT1-HRV2-XS_19980729-103032-802_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980729-103032-802_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980729-103032-802_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T23:42:27.789    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:42:27.791    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980729-103032-802_L1C_054-261-0_D_V1-0.zip
2024-01-09T23:42:27.791    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:42:27.791    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:42:27.791    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:42:27.791    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:42:27.791    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:42:27.791    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:42:27.791    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:42:27.791    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T23:42:29.850    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (118 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980729-103032-802_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1998/07/29/SPOT1-HRV2-XS_19980729-103040-021_L1C_054-261-8_D_V1-0/SPOT1-HRV2-XS_19980729-103040-021_L1C_054-261-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980729-103040-021_L1C_054-261-8_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980729-103040-021_L1C_054-261-8_D_V1-0.zip
run script
2024-01-09T23:42:32.667    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:42:32.668    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980729-103040-021_L1C_054-261-8_D_V1-0.zip
2024-01-09T23:42:32.668    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:42:32.668    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:42:32.668    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:42:32.668    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:42:32.668    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:42:32.668    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:42:32.669    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:42:32.669    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980729-103040-021_L1C_054-261-8_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/29/SPOT1-HRV1-XS_19980729-103031-313_L1C_055-261-0_D_V1-0/SPOT1-HRV1-XS_19980729-103031-313_L1C_055-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980729-103031-313_L1C_055-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980729-103031-313_L1C_055-261-0_D_V1-0.zip
run script
2024-01-09T23:44:27.014    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:44:27.015    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980729-103031-313_L1C_055-261-0_D_V1-0.zip
2024-01-09T23:44:27.016    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:44:27.016    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:44:27.016    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:44:27.016    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:44:27.016    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:44:27.016    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:44:27.016    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:44:27.016    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980729-103031-313_L1C_055-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 2 2]
 [2 2 2 ... 0 0 2]
 [2 2 2 ... 0 0 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/29/SPOT1-HRV1-XS_19980729-103039-639_L1C_055-262-0_D_V1-0/SPOT1-HRV1-XS_19980729-103039-639_L1C_055-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980729-103039-639_L1C_055-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980729-103039-639_L1C_055-262-0_D_V1-0.zip
run script
2024-01-09T23:45:20.974    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:45:20.975    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980729-103039-639_L1C_055-262-0_D_V1-0.zip
2024-01-09T23:45:20.975    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:45:20.975    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:45:20.975    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:45:20.975    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:45:20.975    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:45:20.975    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:45:20.976    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:45:20.976    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980729-103039-639_L1C_055-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/01/17/SPOT1-HRV1-XS_19980117-103915-939_L1C_054-261-0_D_V1-0/SPOT1-HRV1-XS_19980117-103915-939_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980117-103915-939_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980117-103915-939_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T23:46:28.897    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:46:28.898    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980117-103915-939_L1C_054-261-0_D_V1-0.zip
2024-01-09T23:46:28.898    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:46:28.898    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:46:28.899    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:46:28.899    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:46:28.899    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:46:28.899    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:46:28.899    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:46:28.899    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980117-103915-939_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/01/17/SPOT1-HRV1-XS_19980117-103921-353_L1C_054-261-6_D_V1-0/SPOT1-HRV1-XS_19980117-103921-353_L1C_054-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980117-103921-353_L1C_054-261-6_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980117-103921-353_L1C_054-261-6_D_V1-0.zip
run script
2024-01-09T23:48:29.309    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:48:29.310    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980117-103921-353_L1C_054-261-6_D_V1-0.zip
2024-01-09T23:48:29.310    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:48:29.310    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:48:29.310    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:48:29.310    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:48:29.310    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:48:29.310    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:48:29.311    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:48:29.311    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T23:50:24.425    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 978). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980117-103921-353_L1C_054-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1998/01/22/SPOT1-HRV1-XS_19980122-104313-313_L1C_054-261-0_D_V1-0/SPOT1-HRV1-XS_19980122-104313-313_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980122-104313-313_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980122-104313-313_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T23:50:27.506    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:50:27.507    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980122-104313-313_L1C_054-261-0_D_V1-0.zip
2024-01-09T23:50:27.507    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:50:27.507    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:50:27.507    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:50:27.507    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:50:27.507    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:50:27.508    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:50:27.508    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:50:27.508    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980122-104313-313_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/01/22/SPOT1-HRV1-XS_19980122-104321-726_L1C_054-262-0_D_V1-0/SPOT1-HRV1-XS_19980122-104321-726_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980122-104321-726_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980122-104321-726_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T23:52:38.205    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:52:38.206    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980122-104321-726_L1C_054-262-0_D_V1-0.zip
2024-01-09T23:52:38.206    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:52:38.207    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:52:38.207    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:52:38.207    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:52:38.207    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:52:38.207    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:52:38.207    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:52:38.207    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980122-104321-726_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/05/18/SPOT1-HRV1-XS_19980518-101404-938_L1C_054-261-0_D_V1-0/SPOT1-HRV1-XS_19980518-101404-938_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980518-101404-938_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980518-101404-938_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T23:54:53.637    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:54:53.639    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980518-101404-938_L1C_054-261-0_D_V1-0.zip
2024-01-09T23:54:53.639    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:54:53.639    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:54:53.639    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:54:53.639    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:54:53.639    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:54:53.639    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:54:53.639    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:54:53.639    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980518-101404-938_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/09/SPOT1-HRV2-XS_19980709-101448-995_L1C_054-261-0_D_V1-0/SPOT1-HRV2-XS_19980709-101448-995_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980709-101448-995_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980709-101448-995_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T23:56:46.608    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:56:46.608    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980709-101448-995_L1C_054-261-0_D_V1-0.zip
2024-01-09T23:56:46.608    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:56:46.608    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:56:46.608    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:56:46.608    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:56:46.608    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:56:46.608    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:56:46.609    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:56:46.609    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980709-101448-995_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/09/SPOT1-HRV2-XS_19980709-101457-258_L1C_054-262-0_D_V1-0/SPOT1-HRV2-XS_19980709-101457-258_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980709-101457-258_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980709-101457-258_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T23:58:29.793    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:58:29.794    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980709-101457-258_L1C_054-262-0_D_V1-0.zip
2024-01-09T23:58:29.794    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:58:29.794    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:58:29.795    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:58:29.795    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:58:29.795    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:58:29.795    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:58:29.795    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:58:29.795    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980709-101457-258_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/09/SPOT1-HRV2-XS_19980709-101459-063_L1C_054-262-2_D_V1-0/SPOT1-HRV2-XS_19980709-101459-063_L1C_054-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980709-101459-063_L1C_054-262-2_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980709-101459-063_L1C_054-262-2_D_V1-0.zip
run script
2024-01-10T00:00:16.723    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:00:16.724    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980709-101459-063_L1C_054-262-2_D_V1-0.zip
2024-01-10T00:00:16.724    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:00:16.724    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:00:16.724    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:00:16.724    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:00:16.724    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:00:16.724    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:00:16.724    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:00:16.724    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980709-101459-063_L1C_054-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/24/SPOT1-HRV2-XS_19980724-102640-951_L1C_054-261-7_D_V1-0/SPOT1-HRV2-XS_19980724-102640-951_L1C_054-261-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980724-102640-951_L1C_054-261-7_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980724-102640-951_L1C_054-261-7_D_V1-0.zip
run script
2024-01-10T00:02:05.672    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:02:05.673    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980724-102640-951_L1C_054-261-7_D_V1-0.zip
2024-01-10T00:02:05.673    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:02:05.674    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:02:05.674    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:02:05.674    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:02:05.674    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:02:05.674    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:02:05.674    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:02:05.674    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980724-102640-951_L1C_054-261-7_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/24/SPOT1-HRV2-XS_19980724-102642-756_L1C_054-261-9_D_V1-0/SPOT1-HRV2-XS_19980724-102642-756_L1C_054-261-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19980724-102642-756_L1C_054-261-9_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980724-102642-756_L1C_054-261-9_D_V1-0.zip
run script
2024-01-10T00:03:47.969    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:03:47.970    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980724-102642-756_L1C_054-261-9_D_V1-0.zip
2024-01-10T00:03:47.970    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:03:47.970    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:03:47.970    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:03:47.970    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:03:47.970    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:03:47.970    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:03:47.970    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:03:47.970    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV2-XS_19980724-102642-756_L1C_054-261-9_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1998/07/24/SPOT1-HRV1-XS_19980724-102641-576_L1C_055-261-9_D_V1-0/SPOT1-HRV1-XS_19980724-102641-576_L1C_055-261-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19980724-102641-576_L1C_055-261-9_D_V1-0.zip
/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980724-102641-576_L1C_055-261-9_D_V1-0.zip
run script
2024-01-10T00:05:26.884    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:05:26.885    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980724-102641-576_L1C_055-261-9_D_V1-0.zip
2024-01-10T00:05:26.885    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:05:26.885    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:05:26.885    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:05:26.885    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:05:26.885    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:05:26.885    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:05:26.886    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:05:26.886    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016194/INPUT/SPOT1-HRV1-XS_19980724-102641-576_L1C_055-261-9_D_V1-0.zip', job_dir='/tmp/slurm-4016194/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
end
[2024-01-10 00:06:20.916751934+00:00] cnes_level2/barrouz/4016194:  Account (env) = cnes_level2
[2024-01-10 00:06:20.917847607+00:00] cnes_level2/barrouz/4016194:     User (env) = barrouz
[2024-01-10 00:06:20.918879221+00:00] cnes_level2/barrouz/4016194:        GroupId = cesbio(426000053)
[2024-01-10 00:06:20.919911974+00:00] cnes_level2/barrouz/4016194:         UserId = barrouz(9134)
[2024-01-10 00:06:20.920922628+00:00] cnes_level2/barrouz/4016194:        Account = cnes_level2
[2024-01-10 00:06:20.921939802+00:00] cnes_level2/barrouz/4016194:        Account = cnes_level2
[2024-01-10 00:06:20.922935106+00:00] cnes_level2/barrouz/4016194:      Partition = cpu2022
[2024-01-10 00:06:20.923954309+00:00] cnes_level2/barrouz/4016194:            QOS = cpu_2022_1280
[2024-01-10 00:06:20.924937283+00:00] cnes_level2/barrouz/4016194:        JobName = inf_ALP_5_TCD-BLUE_AVG-1200
[2024-01-10 00:06:20.925947777+00:00] cnes_level2/barrouz/4016194:     SubmitTime = 2024-01-09T10:51:52
[2024-01-10 00:06:20.926945711+00:00] cnes_level2/barrouz/4016194:        RunTime = 07:11:01
[2024-01-10 00:06:20.927952265+00:00] cnes_level2/barrouz/4016194:      TimeLimit = 1-16:00:00
[2024-01-10 00:06:20.928952309+00:00] cnes_level2/barrouz/4016194:   EligibleTime = 2024-01-09T10:51:52
[2024-01-10 00:06:20.929948212+00:00] cnes_level2/barrouz/4016194:      StartTime = 2024-01-09T16:55:19
[2024-01-10 00:06:20.930921117+00:00] cnes_level2/barrouz/4016194:        EndTime = 2024-01-10T00:06:20
[2024-01-10 00:06:20.931907411+00:00] cnes_level2/barrouz/4016194:       ExitCode = 0:0
[2024-01-10 00:06:20.932889544+00:00] cnes_level2/barrouz/4016194:       NodeList = trex055
[2024-01-10 00:06:20.933868838+00:00] cnes_level2/barrouz/4016194:      BatchHost = trex055
[2024-01-10 00:06:20.934835592+00:00] cnes_level2/barrouz/4016194:           TRES = 
[2024-01-10 00:06:20.935822717+00:00] cnes_level2/barrouz/4016194:        Command = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
[2024-01-10 00:06:20.936816180+00:00] cnes_level2/barrouz/4016194:        WorkDir = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code
[2024-01-10 00:06:20.937835164+00:00] cnes_level2/barrouz/4016194:         StdErr = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_5_TCD-BLUE_AVG-1200.log
[2024-01-10 00:06:20.938864848+00:00] cnes_level2/barrouz/4016194:         StdOut = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_5_TCD-BLUE_AVG-1200.log

#########################################
#        EVIDEN - CNES                  #
#        Job Accounting                 #
#########################################
Cluster              : trex
JobIDRaw             : 4016194
JobID                : 4016194
JobName              : inf_ALP_5_TCD-BLUE_AVG-1200
Account              : cnes_level2
User                 : barrouz(9134), cesbio(426000053)
Partition            : cpu2022
QOS                  : cpu_2022_1280
Nodelist             : trex055 (1)
State                : COMPLETED  (Exitcode=0:0, DerivedExitCode=0:0, Restarts=0)
Submit date          : 2024-01-09T10:51:52
Start time           : 2024-01-09T16:55:19
End time             : 2024-01-10T00:06:20
Elapsed time         : 07:11:01  (Timelimit=1-16:00:00, Suspended=00:00:00)
TEI                  : 2 days, 9:28:08
Command              : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
StdOut               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_5_TCD-BLUE_AVG-1200.log
StdErr               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_5_TCD-BLUE_AVG-1200.log

STEP(s) : 2
--------- 
   StepID  | JobName      State       Exit   Start               End                 Elapsed   TotalCPU   CPUTime    ConsumedEnergy MaxDiskRead MaxDiskWrite     MaxRSS MaxRSSTask MaxRSSNode NNodes UserCPU    NodeList
   ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 
   batch   | batch        COMPLETED   0:0    2024-01-09T16:55:19 2024-01-10T00:06:20 07:11:01  1-13:49:23 2-09:28:08       0.17125G  199611.20M    82088.74M 106065044K          0    trex055      1 20:20:26   trex055
   extern  | extern       COMPLETED   0:0    2024-01-09T16:55:19 2024-01-10T00:06:20 07:11:01  00:00.001  2-09:28:08       0.17125G       0.00M        0.00M      1680K          0    trex055      1 00:00:00   trex055

