unload conda/22.11.1  : OK 
load conda/22.11.1  : OK 
envs_dirs : /work/scratch/env/barrouz/conda_env/
pkgs_dirs : /work/scratch/env/barrouz/pkgs_conda
INPUT_PATH /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/58.txt
OUTPUT_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
DEM_PATH /work/CAMPUS/etudes/Neige/DEM
TCD_PATH /work/datalake/static_aux/TreeCoverDensity
MODELS_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
KEEP_REFL 0
MASK 1
start
/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/58.txt
muscate/SPOTWORLDHERITAGE/2000/06/21/SPOT4-HRVIR1-XS_20000621-104737-181_L1C_046-263-2_D_V1-0/SPOT4-HRVIR1-XS_20000621-104737-181_L1C_046-263-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000621-104737-181_L1C_046-263-2_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000621-104737-181_L1C_046-263-2_D_V1-0.zip
run script
2024-01-09T22:45:02.332    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:45:02.333    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000621-104737-181_L1C_046-263-2_D_V1-0.zip
2024-01-09T22:45:02.333    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:45:02.333    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:45:02.333    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:45:02.333    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:45:02.333    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:45:02.333    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:45:02.333    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:45:02.334    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000621-104737-181_L1C_046-263-2_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 2]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/21/SPOT4-HRVIR2-XS_20000621-104641-998_L1C_048-256-8_D_V1-0/SPOT4-HRVIR2-XS_20000621-104641-998_L1C_048-256-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000621-104641-998_L1C_048-256-8_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000621-104641-998_L1C_048-256-8_D_V1-0.zip
run script
2024-01-09T22:46:05.057    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:46:05.058    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000621-104641-998_L1C_048-256-8_D_V1-0.zip
2024-01-09T22:46:05.058    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:46:05.058    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:46:05.058    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:46:05.058    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:46:05.058    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:46:05.058    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:46:05.058    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:46:05.058    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000621-104641-998_L1C_048-256-8_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/06/21/SPOT4-HRVIR2-XS_20000621-104643-078_L1C_048-257-0_D_V1-0/SPOT4-HRVIR2-XS_20000621-104643-078_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000621-104643-078_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000621-104643-078_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T22:46:08.670    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:46:08.671    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000621-104643-078_L1C_048-257-0_D_V1-0.zip
2024-01-09T22:46:08.671    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:46:08.671    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:46:08.671    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:46:08.672    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:46:08.672    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:46:08.672    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:46:08.672    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:46:08.672    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000621-104643-078_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/06/21/SPOT4-HRVIR2-XS_20000621-104651-383_L1C_048-258-0_D_V1-0/SPOT4-HRVIR2-XS_20000621-104651-383_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000621-104651-383_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000621-104651-383_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T22:46:12.435    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:46:12.436    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000621-104651-383_L1C_048-258-0_D_V1-0.zip
2024-01-09T22:46:12.436    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:46:12.436    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:46:12.436    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:46:12.436    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:46:12.436    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:46:12.437    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:46:12.437    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:46:12.437    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000621-104651-383_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/06/21/SPOT4-HRVIR2-XS_20000621-104653-188_L1C_048-258-2_D_V1-0/SPOT4-HRVIR2-XS_20000621-104653-188_L1C_048-258-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000621-104653-188_L1C_048-258-2_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000621-104653-188_L1C_048-258-2_D_V1-0.zip
run script
2024-01-09T22:46:16.293    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:46:16.294    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000621-104653-188_L1C_048-258-2_D_V1-0.zip
2024-01-09T22:46:16.294    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:46:16.294    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:46:16.295    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:46:16.295    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:46:16.295    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:46:16.295    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:46:16.295    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:46:16.295    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000621-104653-188_L1C_048-258-2_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/06/21/SPOT4-HRVIR2-XS_20000621-104615-040_L1C_050-254-0_D_V1-0/SPOT4-HRVIR2-XS_20000621-104615-040_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000621-104615-040_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000621-104615-040_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T22:46:20.414    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:46:20.415    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000621-104615-040_L1C_050-254-0_D_V1-0.zip
2024-01-09T22:46:20.415    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:46:20.415    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:46:20.415    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:46:20.416    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:46:20.416    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:46:20.416    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:46:20.416    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:46:20.416    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000621-104615-040_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/06/21/SPOT4-HRVIR2-XS_20000621-104710-320_L1C_051-260-8_D_V1-0/SPOT4-HRVIR2-XS_20000621-104710-320_L1C_051-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000621-104710-320_L1C_051-260-8_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000621-104710-320_L1C_051-260-8_D_V1-0.zip
run script
2024-01-09T22:46:24.171    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:46:24.172    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000621-104710-320_L1C_051-260-8_D_V1-0.zip
2024-01-09T22:46:24.172    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:46:24.172    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:46:24.172    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:46:24.172    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:46:24.172    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:46:24.173    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:46:24.173    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:46:24.173    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000621-104710-320_L1C_051-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/21/SPOT4-HRVIR2-XS_20000621-104711-475_L1C_051-261-0_D_V1-0/SPOT4-HRVIR2-XS_20000621-104711-475_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000621-104711-475_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000621-104711-475_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T22:49:09.023    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:49:09.024    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000621-104711-475_L1C_051-261-0_D_V1-0.zip
2024-01-09T22:49:09.025    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:49:09.025    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:49:09.025    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:49:09.025    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:49:09.025    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:49:09.025    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:49:09.025    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:49:09.025    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000621-104711-475_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/21/SPOT4-HRVIR2-XS_20000621-104719-852_L1C_051-262-0_D_V1-0/SPOT4-HRVIR2-XS_20000621-104719-852_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000621-104719-852_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000621-104719-852_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T22:51:36.756    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:51:36.757    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000621-104719-852_L1C_051-262-0_D_V1-0.zip
2024-01-09T22:51:36.757    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:51:36.757    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:51:36.757    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:51:36.757    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:51:36.757    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:51:36.757    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:51:36.757    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:51:36.758    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000621-104719-852_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/21/SPOT4-HRVIR2-XS_20000621-104723-462_L1C_051-262-4_D_V1-0/SPOT4-HRVIR2-XS_20000621-104723-462_L1C_051-262-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000621-104723-462_L1C_051-262-4_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000621-104723-462_L1C_051-262-4_D_V1-0.zip
run script
2024-01-09T22:53:33.137    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:53:33.139    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000621-104723-462_L1C_051-262-4_D_V1-0.zip
2024-01-09T22:53:33.139    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:53:33.139    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:53:33.139    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:53:33.139    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:53:33.139    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:53:33.139    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:53:33.139    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:53:33.140    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000621-104723-462_L1C_051-262-4_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/25/SPOT4-HRVIR2-XS_20000625-111039-562_L1C_046-262-7_D_V1-0/SPOT4-HRVIR2-XS_20000625-111039-562_L1C_046-262-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000625-111039-562_L1C_046-262-7_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000625-111039-562_L1C_046-262-7_D_V1-0.zip
run script
2024-01-09T22:55:06.150    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:55:06.151    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000625-111039-562_L1C_046-262-7_D_V1-0.zip
2024-01-09T22:55:06.152    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:55:06.152    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:55:06.152    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:55:06.152    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:55:06.152    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:55:06.152    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:55:06.152    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:55:06.152    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000625-111039-562_L1C_046-262-7_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/25/SPOT4-HRVIR1-XS_20000625-110948-670_L1C_047-257-0_D_V1-0/SPOT4-HRVIR1-XS_20000625-110948-670_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000625-110948-670_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000625-110948-670_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T22:55:55.405    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:55:55.406    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000625-110948-670_L1C_047-257-0_D_V1-0.zip
2024-01-09T22:55:55.406    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:55:55.406    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:55:55.406    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:55:55.406    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:55:55.406    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:55:55.406    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:55:55.406    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:55:55.406    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:55:57.811    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (108 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000625-110948-670_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/06/25/SPOT4-HRVIR1-XS_20000625-110957-152_L1C_047-258-0_D_V1-0/SPOT4-HRVIR1-XS_20000625-110957-152_L1C_047-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000625-110957-152_L1C_047-258-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000625-110957-152_L1C_047-258-0_D_V1-0.zip
run script
2024-01-09T22:56:01.094    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:56:01.096    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000625-110957-152_L1C_047-258-0_D_V1-0.zip
2024-01-09T22:56:01.096    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:56:01.096    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:56:01.096    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:56:01.096    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:56:01.096    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:56:01.096    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:56:01.096    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:56:01.096    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000625-110957-152_L1C_047-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/06/25/SPOT4-HRVIR1-XS_20000625-110958-957_L1C_047-258-2_D_V1-0/SPOT4-HRVIR1-XS_20000625-110958-957_L1C_047-258-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000625-110958-957_L1C_047-258-2_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000625-110958-957_L1C_047-258-2_D_V1-0.zip
run script
2024-01-09T22:56:04.755    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:56:04.757    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000625-110958-957_L1C_047-258-2_D_V1-0.zip
2024-01-09T22:56:04.757    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:56:04.757    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:56:04.757    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:56:04.757    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:56:04.757    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:56:04.757    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:56:04.757    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:56:04.757    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000625-110958-957_L1C_047-258-2_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/06/25/SPOT4-HRVIR1-XS_20000625-110944-699_L1C_048-256-5_D_V1-0/SPOT4-HRVIR1-XS_20000625-110944-699_L1C_048-256-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000625-110944-699_L1C_048-256-5_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000625-110944-699_L1C_048-256-5_D_V1-0.zip
run script
2024-01-09T22:56:08.476    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:56:08.477    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000625-110944-699_L1C_048-256-5_D_V1-0.zip
2024-01-09T22:56:08.477    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:56:08.477    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:56:08.477    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:56:08.477    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:56:08.477    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:56:08.477    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:56:08.477    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:56:08.477    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000625-110944-699_L1C_048-256-5_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/27/SPOT4-HRVIR2-XS_20000627-103202-427_L1C_046-262-8_D_V1-0/SPOT4-HRVIR2-XS_20000627-103202-427_L1C_046-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000627-103202-427_L1C_046-262-8_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000627-103202-427_L1C_046-262-8_D_V1-0.zip
run script
2024-01-09T22:56:30.498    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:56:30.499    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000627-103202-427_L1C_046-262-8_D_V1-0.zip
2024-01-09T22:56:30.499    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:56:30.499    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:56:30.499    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:56:30.499    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:56:30.499    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:56:30.500    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:56:30.500    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:56:30.500    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000627-103202-427_L1C_046-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/27/SPOT4-HRVIR2-XS_20000627-103203-477_L1C_046-263-0_D_V1-0/SPOT4-HRVIR2-XS_20000627-103203-477_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000627-103203-477_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000627-103203-477_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T22:57:14.673    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:57:14.674    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000627-103203-477_L1C_046-263-0_D_V1-0.zip
2024-01-09T22:57:14.674    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:57:14.674    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:57:14.674    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:57:14.674    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:57:14.674    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:57:14.675    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:57:14.675    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:57:14.675    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000627-103203-477_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/27/SPOT4-HRVIR2-XS_20000627-103049-515_L1C_049-254-4_D_V1-0/SPOT4-HRVIR2-XS_20000627-103049-515_L1C_049-254-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000627-103049-515_L1C_049-254-4_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000627-103049-515_L1C_049-254-4_D_V1-0.zip
run script
2024-01-09T22:58:10.412    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:58:10.413    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000627-103049-515_L1C_049-254-4_D_V1-0.zip
2024-01-09T22:58:10.413    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:58:10.413    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:58:10.413    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:58:10.413    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:58:10.413    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:58:10.413    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:58:10.413    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:58:10.413    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000627-103049-515_L1C_049-254-4_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/06/27/SPOT4-HRVIR2-XS_20000627-103054-120_L1C_049-255-0_D_V1-0/SPOT4-HRVIR2-XS_20000627-103054-120_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000627-103054-120_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000627-103054-120_L1C_049-255-0_D_V1-0.zip
run script
2024-01-09T22:58:14.222    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:58:14.223    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000627-103054-120_L1C_049-255-0_D_V1-0.zip
2024-01-09T22:58:14.223    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:58:14.223    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:58:14.223    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:58:14.223    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:58:14.223    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:58:14.224    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:58:14.224    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:58:14.224    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000627-103054-120_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/27/SPOT4-HRVIR1-XS_20000627-103105-042_L1C_050-256-4_D_V1-0/SPOT4-HRVIR1-XS_20000627-103105-042_L1C_050-256-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000627-103105-042_L1C_050-256-4_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000627-103105-042_L1C_050-256-4_D_V1-0.zip
run script
2024-01-09T22:58:49.860    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:58:49.861    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000627-103105-042_L1C_050-256-4_D_V1-0.zip
2024-01-09T22:58:49.861    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:58:49.861    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:58:49.862    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:58:49.862    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:58:49.862    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:58:49.862    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:58:49.862    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:58:49.862    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000627-103105-042_L1C_050-256-4_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/27/SPOT4-HRVIR1-XS_20000627-103108-652_L1C_050-256-8_D_V1-0/SPOT4-HRVIR1-XS_20000627-103108-652_L1C_050-256-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000627-103108-652_L1C_050-256-8_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000627-103108-652_L1C_050-256-8_D_V1-0.zip
run script
2024-01-09T23:01:06.936    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:01:06.938    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000627-103108-652_L1C_050-256-8_D_V1-0.zip
2024-01-09T23:01:06.938    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:01:06.938    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:01:06.938    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:01:06.938    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:01:06.938    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:01:06.938    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:01:06.938    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:01:06.938    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000627-103108-652_L1C_050-256-8_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/27/SPOT4-HRVIR1-XS_20000627-103122-804_L1C_050-258-6_D_V1-0/SPOT4-HRVIR1-XS_20000627-103122-804_L1C_050-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000627-103122-804_L1C_050-258-6_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000627-103122-804_L1C_050-258-6_D_V1-0.zip
run script
2024-01-09T23:03:35.951    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:03:35.951    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000627-103122-804_L1C_050-258-6_D_V1-0.zip
2024-01-09T23:03:35.951    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:03:35.951    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:03:35.951    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:03:35.951    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:03:35.951    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:03:35.951    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:03:35.951    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:03:35.952    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000627-103122-804_L1C_050-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/27/SPOT4-HRVIR1-XS_20000627-103125-653_L1C_050-259-0_D_V1-0/SPOT4-HRVIR1-XS_20000627-103125-653_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000627-103125-653_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000627-103125-653_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T23:05:51.134    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:05:51.135    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000627-103125-653_L1C_050-259-0_D_V1-0.zip
2024-01-09T23:05:51.135    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:05:51.135    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:05:51.135    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:05:51.135    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:05:51.135    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:05:51.135    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:05:51.135    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:05:51.135    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0ERROR 1: /tmp/slurm-4016258/OUTPUT/SPOT4/2000/6/27/SPOT4-HRVIR1-XS_20000627-103125-653_L1C_050-259-0_C_V1-0/32TLR/FSC_20000627T103125_SPOT4_32TLR/nodata.tif, band 1: Split bands are read-only.
...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000627-103125-653_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/27/SPOT4-HRVIR1-XS_20000627-103133-922_L1C_050-260-0_D_V1-0/SPOT4-HRVIR1-XS_20000627-103133-922_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000627-103133-922_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000627-103133-922_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T23:07:59.851    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:07:59.852    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000627-103133-922_L1C_050-260-0_D_V1-0.zip
2024-01-09T23:07:59.852    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:07:59.852    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:07:59.852    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:07:59.852    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:07:59.852    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:07:59.852    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:07:59.852    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:07:59.853    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000627-103133-922_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/27/SPOT4-HRVIR1-XS_20000627-103142-203_L1C_050-261-0_D_V1-0/SPOT4-HRVIR1-XS_20000627-103142-203_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000627-103142-203_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000627-103142-203_L1C_050-261-0_D_V1-0.zip
run script
2024-01-09T23:09:35.404    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:09:35.405    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000627-103142-203_L1C_050-261-0_D_V1-0.zip
2024-01-09T23:09:35.405    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:09:35.405    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:09:35.405    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:09:35.405    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:09:35.405    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:09:35.405    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:09:35.405    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:09:35.405    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000627-103142-203_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/27/SPOT4-HRVIR1-XS_20000627-103145-812_L1C_050-261-4_D_V1-0/SPOT4-HRVIR1-XS_20000627-103145-812_L1C_050-261-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000627-103145-812_L1C_050-261-4_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000627-103145-812_L1C_050-261-4_D_V1-0.zip
run script
2024-01-09T23:11:00.697    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:11:00.698    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000627-103145-812_L1C_050-261-4_D_V1-0.zip
2024-01-09T23:11:00.698    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:11:00.698    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:11:00.698    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:11:00.698    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:11:00.698    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:11:00.698    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:11:00.699    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:11:00.699    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000627-103145-812_L1C_050-261-4_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/11/SPOT4-HRVIR2-XS_20000811-110647-401_L1C_046-262-9_D_V1-0/SPOT4-HRVIR2-XS_20000811-110647-401_L1C_046-262-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000811-110647-401_L1C_046-262-9_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000811-110647-401_L1C_046-262-9_D_V1-0.zip
run script
2024-01-09T23:12:17.836    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:12:17.838    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000811-110647-401_L1C_046-262-9_D_V1-0.zip
2024-01-09T23:12:17.838    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:12:17.838    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:12:17.838    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:12:17.838    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:12:17.838    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:12:17.838    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:12:17.838    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:12:17.838    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000811-110647-401_L1C_046-262-9_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/11/SPOT4-HRVIR2-XS_20000811-110647-738_L1C_046-263-0_D_V1-0/SPOT4-HRVIR2-XS_20000811-110647-738_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000811-110647-738_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000811-110647-738_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T23:12:42.150    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:12:42.151    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000811-110647-738_L1C_046-263-0_D_V1-0.zip
2024-01-09T23:12:42.151    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:12:42.151    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:12:42.151    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:12:42.151    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:12:42.151    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:12:42.151    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:12:42.151    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:12:42.151    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000811-110647-738_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/11/SPOT4-HRVIR2-XS_20000811-110605-915_L1C_048-258-2_D_V1-0/SPOT4-HRVIR2-XS_20000811-110605-915_L1C_048-258-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000811-110605-915_L1C_048-258-2_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000811-110605-915_L1C_048-258-2_D_V1-0.zip
run script
2024-01-09T23:13:10.406    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:13:10.407    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000811-110605-915_L1C_048-258-2_D_V1-0.zip
2024-01-09T23:13:10.407    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:13:10.407    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:13:10.407    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:13:10.407    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:13:10.407    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:13:10.407    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:13:10.407    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:13:10.407    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000811-110605-915_L1C_048-258-2_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/11/SPOT4-HRVIR2-XS_20000811-110612-569_L1C_048-259-0_D_V1-0/SPOT4-HRVIR2-XS_20000811-110612-569_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000811-110612-569_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000811-110612-569_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T23:13:14.187    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:13:14.188    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000811-110612-569_L1C_048-259-0_D_V1-0.zip
2024-01-09T23:13:14.189    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:13:14.189    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:13:14.189    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:13:14.189    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:13:14.189    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:13:14.189    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:13:14.189    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:13:14.189    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000811-110612-569_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/11/SPOT4-HRVIR2-XS_20000811-110628-690_L1C_048-260-9_D_V1-0/SPOT4-HRVIR2-XS_20000811-110628-690_L1C_048-260-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000811-110628-690_L1C_048-260-9_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000811-110628-690_L1C_048-260-9_D_V1-0.zip
run script
2024-01-09T23:13:18.028    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:13:18.029    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000811-110628-690_L1C_048-260-9_D_V1-0.zip
2024-01-09T23:13:18.029    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:13:18.029    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:13:18.029    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:13:18.029    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:13:18.029    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:13:18.030    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:13:18.030    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:13:18.030    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000811-110628-690_L1C_048-260-9_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/06/15/SPOT4-HRVIR2-XS_20000615-110307-214_L1C_046-263-4_D_V1-0/SPOT4-HRVIR2-XS_20000615-110307-214_L1C_046-263-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000615-110307-214_L1C_046-263-4_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000615-110307-214_L1C_046-263-4_D_V1-0.zip
run script
2024-01-09T23:13:21.563    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:13:21.565    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000615-110307-214_L1C_046-263-4_D_V1-0.zip
2024-01-09T23:13:21.565    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:13:21.565    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:13:21.565    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:13:21.565    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:13:21.565    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:13:21.565    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:13:21.565    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:13:21.566    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000615-110307-214_L1C_046-263-4_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/15/SPOT4-HRVIR2-XS_20000615-110205-052_L1C_048-256-3_D_V1-0/SPOT4-HRVIR2-XS_20000615-110205-052_L1C_048-256-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000615-110205-052_L1C_048-256-3_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000615-110205-052_L1C_048-256-3_D_V1-0.zip
run script
2024-01-09T23:14:49.266    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:14:49.267    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000615-110205-052_L1C_048-256-3_D_V1-0.zip
2024-01-09T23:14:49.268    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:14:49.268    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:14:49.268    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:14:49.268    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:14:49.268    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:14:49.268    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:14:49.268    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:14:49.268    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000615-110205-052_L1C_048-256-3_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/15/SPOT4-HRVIR2-XS_20000615-110210-466_L1C_048-256-9_D_V1-0/SPOT4-HRVIR2-XS_20000615-110210-466_L1C_048-256-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000615-110210-466_L1C_048-256-9_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000615-110210-466_L1C_048-256-9_D_V1-0.zip
run script
2024-01-09T23:15:15.440    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:15:15.441    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000615-110210-466_L1C_048-256-9_D_V1-0.zip
2024-01-09T23:15:15.441    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:15:15.441    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:15:15.441    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:15:15.441    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:15:15.441    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:15:15.441    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:15:15.441    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:15:15.441    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000615-110210-466_L1C_048-256-9_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/15/SPOT4-HRVIR1-XS_20000615-110220-852_L1C_049-258-5_D_V1-0/SPOT4-HRVIR1-XS_20000615-110220-852_L1C_049-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000615-110220-852_L1C_049-258-5_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000615-110220-852_L1C_049-258-5_D_V1-0.zip
run script
2024-01-09T23:15:27.620    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:15:27.621    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000615-110220-852_L1C_049-258-5_D_V1-0.zip
2024-01-09T23:15:27.621    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:15:27.621    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:15:27.621    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:15:27.621    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:15:27.621    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:15:27.621    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:15:27.621    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:15:27.621    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000615-110220-852_L1C_049-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/15/SPOT4-HRVIR1-XS_20000615-110224-792_L1C_049-259-0_D_V1-0/SPOT4-HRVIR1-XS_20000615-110224-792_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000615-110224-792_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000615-110224-792_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T23:17:08.914    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:17:08.915    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000615-110224-792_L1C_049-259-0_D_V1-0.zip
2024-01-09T23:17:08.916    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:17:08.916    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:17:08.916    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:17:08.916    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:17:08.916    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:17:08.916    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:17:08.916    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:17:08.916    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000615-110224-792_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/15/SPOT4-HRVIR1-XS_20000615-110233-251_L1C_049-260-0_D_V1-0/SPOT4-HRVIR1-XS_20000615-110233-251_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000615-110233-251_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000615-110233-251_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T23:18:32.127    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:18:32.128    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000615-110233-251_L1C_049-260-0_D_V1-0.zip
2024-01-09T23:18:32.129    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:18:32.129    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:18:32.129    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:18:32.129    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:18:32.129    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:18:32.129    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:18:32.129    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:18:32.129    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000615-110233-251_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/15/SPOT4-HRVIR1-XS_20000615-110235-056_L1C_049-260-2_D_V1-0/SPOT4-HRVIR1-XS_20000615-110235-056_L1C_049-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000615-110235-056_L1C_049-260-2_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000615-110235-056_L1C_049-260-2_D_V1-0.zip
run script
2024-01-09T23:19:25.281    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:19:25.283    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000615-110235-056_L1C_049-260-2_D_V1-0.zip
2024-01-09T23:19:25.283    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:19:25.283    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:19:25.283    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:19:25.283    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:19:25.283    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:19:25.283    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:19:25.283    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:19:25.283    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000615-110235-056_L1C_049-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/15/SPOT4-HRVIR1-XS_20000615-110248-756_L1C_051-262-1_D_V1-0/SPOT4-HRVIR1-XS_20000615-110248-756_L1C_051-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000615-110248-756_L1C_051-262-1_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000615-110248-756_L1C_051-262-1_D_V1-0.zip
run script
2024-01-09T23:20:13.963    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:20:13.964    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000615-110248-756_L1C_051-262-1_D_V1-0.zip
2024-01-09T23:20:13.964    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:20:13.964    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:20:13.964    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:20:13.964    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:20:13.964    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:20:13.965    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:20:13.965    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:20:13.965    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000615-110248-756_L1C_051-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/28/SPOT4-HRVIR2-XS_20000828-103948-525_L1C_046-263-0_D_V1-0/SPOT4-HRVIR2-XS_20000828-103948-525_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000828-103948-525_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000828-103948-525_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T23:21:44.843    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:21:44.845    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000828-103948-525_L1C_046-263-0_D_V1-0.zip
2024-01-09T23:21:44.845    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:21:44.845    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:21:44.845    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:21:44.845    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:21:44.845    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:21:44.845    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:21:44.845    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:21:44.845    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000828-103948-525_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/28/SPOT4-HRVIR1-XS_20000828-103910-199_L1C_047-258-5_D_V1-0/SPOT4-HRVIR1-XS_20000828-103910-199_L1C_047-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000828-103910-199_L1C_047-258-5_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000828-103910-199_L1C_047-258-5_D_V1-0.zip
run script
2024-01-09T23:22:08.218    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:22:08.219    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000828-103910-199_L1C_047-258-5_D_V1-0.zip
2024-01-09T23:22:08.220    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:22:08.220    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:22:08.220    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:22:08.220    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:22:08.220    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:22:08.220    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:22:08.220    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:22:08.220    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000828-103910-199_L1C_047-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/28/SPOT4-HRVIR1-XS_20000828-103913-959_L1C_047-259-0_D_V1-0/SPOT4-HRVIR1-XS_20000828-103913-959_L1C_047-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000828-103913-959_L1C_047-259-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000828-103913-959_L1C_047-259-0_D_V1-0.zip
run script
2024-01-09T23:22:11.548    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:22:11.549    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000828-103913-959_L1C_047-259-0_D_V1-0.zip
2024-01-09T23:22:11.549    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:22:11.549    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:22:11.549    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:22:11.549    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:22:11.550    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:22:11.550    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:22:11.550    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:22:11.550    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000828-103913-959_L1C_047-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/11/24/SPOT4-HRVIR2-XS_20001124-104711-323_L1C_046-263-2_D_V1-0/SPOT4-HRVIR2-XS_20001124-104711-323_L1C_046-263-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001124-104711-323_L1C_046-263-2_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001124-104711-323_L1C_046-263-2_D_V1-0.zip
run script
2024-01-09T23:22:14.639    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:22:14.640    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001124-104711-323_L1C_046-263-2_D_V1-0.zip
2024-01-09T23:22:14.640    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:22:14.640    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:22:14.641    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:22:14.641    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:22:14.641    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:22:14.641    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:22:14.641    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:22:14.641    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001124-104711-323_L1C_046-263-2_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/08/SPOT4-HRVIR1-XS_20000408-110915-497_L1C_047-254-0_D_V1-0/SPOT4-HRVIR1-XS_20000408-110915-497_L1C_047-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000408-110915-497_L1C_047-254-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000408-110915-497_L1C_047-254-0_D_V1-0.zip
run script
2024-01-09T23:23:00.455    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:23:00.456    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000408-110915-497_L1C_047-254-0_D_V1-0.zip
2024-01-09T23:23:00.456    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:23:00.457    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:23:00.457    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:23:00.457    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:23:00.457    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:23:00.457    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:23:00.457    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:23:00.457    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000408-110915-497_L1C_047-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/05/01/SPOT4-HRVIR1-XS_20000501-102702-342_L1C_047-254-9_D_V1-0/SPOT4-HRVIR1-XS_20000501-102702-342_L1C_047-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000501-102702-342_L1C_047-254-9_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000501-102702-342_L1C_047-254-9_D_V1-0.zip
run script
2024-01-09T23:23:04.039    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:23:04.040    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000501-102702-342_L1C_047-254-9_D_V1-0.zip
2024-01-09T23:23:04.041    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:23:04.041    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:23:04.041    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:23:04.041    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:23:04.041    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:23:04.041    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:23:04.041    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:23:04.041    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000501-102702-342_L1C_047-254-9_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/01/SPOT4-HRVIR1-XS_20000501-102702-418_L1C_048-255-0_D_V1-0/SPOT4-HRVIR1-XS_20000501-102702-418_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000501-102702-418_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000501-102702-418_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T23:23:19.927    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:23:19.929    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000501-102702-418_L1C_048-255-0_D_V1-0.zip
2024-01-09T23:23:19.929    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:23:19.929    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:23:19.929    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:23:19.929    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:23:19.929    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:23:19.929    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:23:19.929    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:23:19.929    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000501-102702-418_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/01/SPOT4-HRVIR1-XS_20000501-102710-620_L1C_048-256-0_D_V1-0/SPOT4-HRVIR1-XS_20000501-102710-620_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000501-102710-620_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000501-102710-620_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T23:23:37.604    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:23:37.605    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000501-102710-620_L1C_048-256-0_D_V1-0.zip
2024-01-09T23:23:37.605    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:23:37.605    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:23:37.605    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:23:37.605    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:23:37.605    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:23:37.605    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:23:37.605    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:23:37.605    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000501-102710-620_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/01/SPOT4-HRVIR1-XS_20000501-102718-838_L1C_048-257-0_D_V1-0/SPOT4-HRVIR1-XS_20000501-102718-838_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000501-102718-838_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000501-102718-838_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T23:24:10.533    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:24:10.535    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000501-102718-838_L1C_048-257-0_D_V1-0.zip
2024-01-09T23:24:10.535    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:24:10.535    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:24:10.535    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:24:10.535    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:24:10.535    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:24:10.535    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:24:10.535    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:24:10.535    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000501-102718-838_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/01/SPOT4-HRVIR1-XS_20000501-102727-062_L1C_048-258-0_D_V1-0/SPOT4-HRVIR1-XS_20000501-102727-062_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000501-102727-062_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000501-102727-062_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T23:24:31.308    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:24:31.309    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000501-102727-062_L1C_048-258-0_D_V1-0.zip
2024-01-09T23:24:31.309    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:24:31.309    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:24:31.309    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:24:31.310    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:24:31.310    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:24:31.310    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:24:31.310    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:24:31.310    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T23:24:33.988    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1802 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000501-102727-062_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/05/01/SPOT4-HRVIR1-XS_20000501-102749-219_L1C_051-261-0_D_V1-0/SPOT4-HRVIR1-XS_20000501-102749-219_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000501-102749-219_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000501-102749-219_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T23:24:37.342    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:24:37.343    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000501-102749-219_L1C_051-261-0_D_V1-0.zip
2024-01-09T23:24:37.344    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:24:37.344    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:24:37.344    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:24:37.344    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:24:37.344    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:24:37.344    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:24:37.344    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:24:37.344    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000501-102749-219_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/11/SPOT4-HRVIR1-XS_20000511-103441-033_L1C_047-254-4_D_V1-0/SPOT4-HRVIR1-XS_20000511-103441-033_L1C_047-254-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000511-103441-033_L1C_047-254-4_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000511-103441-033_L1C_047-254-4_D_V1-0.zip
run script
2024-01-09T23:26:36.517    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:26:36.518    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000511-103441-033_L1C_047-254-4_D_V1-0.zip
2024-01-09T23:26:36.518    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:26:36.518    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:26:36.519    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:26:36.519    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:26:36.519    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:26:36.519    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:26:36.519    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:26:36.519    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000511-103441-033_L1C_047-254-4_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/02/23/SPOT4-HRVIR2-XS_20000223-103427-479_L1C_047-255-0_D_V1-0/SPOT4-HRVIR2-XS_20000223-103427-479_L1C_047-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000223-103427-479_L1C_047-255-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000223-103427-479_L1C_047-255-0_D_V1-0.zip
run script
2024-01-09T23:26:39.761    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:26:39.762    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000223-103427-479_L1C_047-255-0_D_V1-0.zip
2024-01-09T23:26:39.762    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:26:39.762    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:26:39.762    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:26:39.762    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:26:39.762    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:26:39.762    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:26:39.762    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:26:39.762    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000223-103427-479_L1C_047-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/02/23/SPOT4-HRVIR2-XS_20000223-103435-712_L1C_047-256-0_D_V1-0/SPOT4-HRVIR2-XS_20000223-103435-712_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000223-103435-712_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000223-103435-712_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T23:26:51.166    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:26:51.168    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000223-103435-712_L1C_047-256-0_D_V1-0.zip
2024-01-09T23:26:51.168    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:26:51.168    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:26:51.168    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:26:51.168    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:26:51.168    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:26:51.168    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:26:51.168    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:26:51.169    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000223-103435-712_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/03/15/SPOT4-HRVIR1-XS_20000315-103057-055_L1C_047-256-7_D_V1-0/SPOT4-HRVIR1-XS_20000315-103057-055_L1C_047-256-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000315-103057-055_L1C_047-256-7_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000315-103057-055_L1C_047-256-7_D_V1-0.zip
run script
2024-01-09T23:27:05.924    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:27:05.925    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000315-103057-055_L1C_047-256-7_D_V1-0.zip
2024-01-09T23:27:05.925    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:27:05.925    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:27:05.926    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:27:05.926    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:27:05.926    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:27:05.926    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:27:05.926    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:27:05.926    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000315-103057-055_L1C_047-256-7_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/03/15/SPOT4-HRVIR1-XS_20000315-103058-962_L1C_047-257-0_D_V1-0/SPOT4-HRVIR1-XS_20000315-103058-962_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000315-103058-962_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000315-103058-962_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T23:27:09.476    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:27:09.477    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000315-103058-962_L1C_047-257-0_D_V1-0.zip
2024-01-09T23:27:09.477    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:27:09.477    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:27:09.478    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:27:09.478    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:27:09.478    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:27:09.478    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:27:09.478    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:27:09.478    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000315-103058-962_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/03/15/SPOT4-HRVIR1-XS_20000315-103101-669_L1C_047-257-3_D_V1-0/SPOT4-HRVIR1-XS_20000315-103101-669_L1C_047-257-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000315-103101-669_L1C_047-257-3_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000315-103101-669_L1C_047-257-3_D_V1-0.zip
run script
2024-01-09T23:27:13.031    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:27:13.031    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000315-103101-669_L1C_047-257-3_D_V1-0.zip
2024-01-09T23:27:13.031    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:27:13.031    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:27:13.031    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:27:13.031    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:27:13.031    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:27:13.031    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:27:13.032    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:27:13.032    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000315-103101-669_L1C_047-257-3_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/03/15/SPOT4-HRVIR2-XS_20000315-103116-567_L1C_048-259-2_D_V1-0/SPOT4-HRVIR2-XS_20000315-103116-567_L1C_048-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000315-103116-567_L1C_048-259-2_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000315-103116-567_L1C_048-259-2_D_V1-0.zip
run script
2024-01-09T23:27:16.434    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:27:16.435    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000315-103116-567_L1C_048-259-2_D_V1-0.zip
2024-01-09T23:27:16.435    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:27:16.435    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:27:16.435    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:27:16.435    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:27:16.435    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:27:16.435    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:27:16.436    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:27:16.436    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000315-103116-567_L1C_048-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/03/15/SPOT4-HRVIR2-XS_20000315-103119-275_L1C_048-259-5_D_V1-0/SPOT4-HRVIR2-XS_20000315-103119-275_L1C_048-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000315-103119-275_L1C_048-259-5_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000315-103119-275_L1C_048-259-5_D_V1-0.zip
run script
2024-01-09T23:27:19.808    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:27:19.809    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000315-103119-275_L1C_048-259-5_D_V1-0.zip
2024-01-09T23:27:19.809    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:27:19.809    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:27:19.809    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:27:19.809    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:27:19.810    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:27:19.810    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:27:19.810    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:27:19.810    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000315-103119-275_L1C_048-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/03/15/SPOT4-HRVIR2-XS_20000315-103143-426_L1C_051-262-8_D_V1-0/SPOT4-HRVIR2-XS_20000315-103143-426_L1C_051-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000315-103143-426_L1C_051-262-8_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000315-103143-426_L1C_051-262-8_D_V1-0.zip
run script
2024-01-09T23:27:23.196    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:27:23.198    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000315-103143-426_L1C_051-262-8_D_V1-0.zip
2024-01-09T23:27:23.198    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:27:23.198    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:27:23.198    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:27:23.198    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:27:23.198    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:27:23.198    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:27:23.198    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:27:23.198    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000315-103143-426_L1C_051-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/03/15/SPOT4-HRVIR2-XS_20000315-103144-509_L1C_051-263-0_D_V1-0/SPOT4-HRVIR2-XS_20000315-103144-509_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000315-103144-509_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000315-103144-509_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T23:28:27.951    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:28:27.952    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000315-103144-509_L1C_051-263-0_D_V1-0.zip
2024-01-09T23:28:27.952    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:28:27.952    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:28:27.952    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:28:27.952    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:28:27.952    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:28:27.953    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:28:27.953    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:28:27.953    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000315-103144-509_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/03/20/SPOT4-HRVIR2-XS_20000320-103441-309_L1C_047-256-1_D_V1-0/SPOT4-HRVIR2-XS_20000320-103441-309_L1C_047-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000320-103441-309_L1C_047-256-1_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000320-103441-309_L1C_047-256-1_D_V1-0.zip
run script
2024-01-09T23:29:19.723    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:29:19.724    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000320-103441-309_L1C_047-256-1_D_V1-0.zip
2024-01-09T23:29:19.724    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:29:19.724    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:29:19.724    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:29:19.724    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:29:19.724    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:29:19.724    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:29:19.724    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:29:19.724    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000320-103441-309_L1C_047-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/03/20/SPOT4-HRVIR2-XS_20000320-103446-723_L1C_047-256-7_D_V1-0/SPOT4-HRVIR2-XS_20000320-103446-723_L1C_047-256-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000320-103446-723_L1C_047-256-7_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000320-103446-723_L1C_047-256-7_D_V1-0.zip
run script
2024-01-09T23:29:23.226    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:29:23.227    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000320-103446-723_L1C_047-256-7_D_V1-0.zip
2024-01-09T23:29:23.227    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:29:23.228    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:29:23.228    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:29:23.228    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:29:23.228    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:29:23.228    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:29:23.228    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:29:23.228    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000320-103446-723_L1C_047-256-7_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/02/SPOT4-HRVIR1-XS_20000902-104256-157_L1C_047-257-9_D_V1-0/SPOT4-HRVIR1-XS_20000902-104256-157_L1C_047-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000902-104256-157_L1C_047-257-9_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000902-104256-157_L1C_047-257-9_D_V1-0.zip
run script
2024-01-09T23:29:26.627    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:29:26.627    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000902-104256-157_L1C_047-257-9_D_V1-0.zip
2024-01-09T23:29:26.627    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:29:26.628    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:29:26.628    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:29:26.628    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:29:26.628    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:29:26.628    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:29:26.628    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:29:26.628    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000902-104256-157_L1C_047-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/13/SPOT4-HRVIR2-XS_20000813-102735-933_L1C_047-258-8_D_V1-0/SPOT4-HRVIR2-XS_20000813-102735-933_L1C_047-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000813-102735-933_L1C_047-258-8_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000813-102735-933_L1C_047-258-8_D_V1-0.zip
run script
2024-01-09T23:29:30.200    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:29:30.201    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000813-102735-933_L1C_047-258-8_D_V1-0.zip
2024-01-09T23:29:30.201    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:29:30.201    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:29:30.202    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:29:30.202    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:29:30.202    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:29:30.202    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:29:30.202    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:29:30.202    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000813-102735-933_L1C_047-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/13/SPOT4-HRVIR2-XS_20000813-102653-739_L1C_049-254-0_D_V1-0/SPOT4-HRVIR2-XS_20000813-102653-739_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000813-102653-739_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000813-102653-739_L1C_049-254-0_D_V1-0.zip
run script
2024-01-09T23:29:33.677    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:29:33.678    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000813-102653-739_L1C_049-254-0_D_V1-0.zip
2024-01-09T23:29:33.679    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:29:33.679    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:29:33.679    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:29:33.679    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:29:33.679    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:29:33.679    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:29:33.679    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:29:33.679    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000813-102653-739_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/13/SPOT4-HRVIR2-XS_20000813-102701-942_L1C_049-255-0_D_V1-0/SPOT4-HRVIR2-XS_20000813-102701-942_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000813-102701-942_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000813-102701-942_L1C_049-255-0_D_V1-0.zip
run script
2024-01-09T23:29:37.320    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:29:37.321    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000813-102701-942_L1C_049-255-0_D_V1-0.zip
2024-01-09T23:29:37.321    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:29:37.321    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:29:37.321    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:29:37.321    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:29:37.321    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:29:37.321    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:29:37.321    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:29:37.322    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000813-102701-942_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/13/SPOT4-HRVIR1-XS_20000813-102747-210_L1C_053-260-9_D_V1-0/SPOT4-HRVIR1-XS_20000813-102747-210_L1C_053-260-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000813-102747-210_L1C_053-260-9_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000813-102747-210_L1C_053-260-9_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/2000/08/13/SPOT4-HRVIR1-XS_20000813-102755-674_L1C_054-262-0_D_V1-0/SPOT4-HRVIR1-XS_20000813-102755-674_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000813-102755-674_L1C_054-262-0_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000813-102755-674_L1C_054-262-0_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/2000/08/16/SPOT4-HRVIR2-XS_20000816-110957-905_L1C_047-258-1_D_V1-0/SPOT4-HRVIR2-XS_20000816-110957-905_L1C_047-258-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000816-110957-905_L1C_047-258-1_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000816-110957-905_L1C_047-258-1_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/2000/08/16/SPOT4-HRVIR2-XS_20000816-111005-124_L1C_047-258-9_D_V1-0/SPOT4-HRVIR2-XS_20000816-111005-124_L1C_047-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000816-111005-124_L1C_047-258-9_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000816-111005-124_L1C_047-258-9_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/2000/08/22/SPOT4-HRVIR2-XS_20000822-105437-497_L1C_047-258-5_D_V1-0/SPOT4-HRVIR2-XS_20000822-105437-497_L1C_047-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000822-105437-497_L1C_047-258-5_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000822-105437-497_L1C_047-258-5_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/2000/08/22/SPOT4-HRVIR2-XS_20000822-105441-107_L1C_047-258-9_D_V1-0/SPOT4-HRVIR2-XS_20000822-105441-107_L1C_047-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000822-105441-107_L1C_047-258-9_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000822-105441-107_L1C_047-258-9_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/2000/08/27/SPOT4-HRVIR2-XS_20000827-105828-319_L1C_047-258-5_D_V1-0/SPOT4-HRVIR2-XS_20000827-105828-319_L1C_047-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000827-105828-319_L1C_047-258-5_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000827-105828-319_L1C_047-258-5_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/2000/08/27/SPOT4-HRVIR2-XS_20000827-105831-929_L1C_047-258-9_D_V1-0/SPOT4-HRVIR2-XS_20000827-105831-929_L1C_047-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000827-105831-929_L1C_047-258-9_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000827-105831-929_L1C_047-258-9_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/2000/08/27/SPOT4-HRVIR1-XS_20000827-105842-236_L1C_052-261-1_D_V1-0/SPOT4-HRVIR1-XS_20000827-105842-236_L1C_052-261-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000827-105842-236_L1C_052-261-1_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000827-105842-236_L1C_052-261-1_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/2000/08/27/SPOT4-HRVIR1-XS_20000827-105849-820_L1C_052-262-0_D_V1-0/SPOT4-HRVIR1-XS_20000827-105849-820_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000827-105849-820_L1C_052-262-0_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000827-105849-820_L1C_052-262-0_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/2000/08/27/SPOT4-HRVIR1-XS_20000827-105858-308_L1C_052-263-0_D_V1-0/SPOT4-HRVIR1-XS_20000827-105858-308_L1C_052-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000827-105858-308_L1C_052-263-0_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000827-105858-308_L1C_052-263-0_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/2000/09/01/SPOT4-HRVIR2-XS_20000901-110217-670_L1C_047-258-4_D_V1-0/SPOT4-HRVIR2-XS_20000901-110217-670_L1C_047-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000901-110217-670_L1C_047-258-4_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000901-110217-670_L1C_047-258-4_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/2000/09/01/SPOT4-HRVIR2-XS_20000901-110221-279_L1C_047-258-8_D_V1-0/SPOT4-HRVIR2-XS_20000901-110221-279_L1C_047-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000901-110221-279_L1C_047-258-8_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000901-110221-279_L1C_047-258-8_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/2000/09/06/SPOT4-HRVIR2-XS_20000906-110610-300_L1C_047-258-8_D_V1-0/SPOT4-HRVIR2-XS_20000906-110610-300_L1C_047-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000906-110610-300_L1C_047-258-8_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000906-110610-300_L1C_047-258-8_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/2000/09/07/SPOT4-HRVIR2-XS_20000907-104645-752_L1C_047-258-0_D_V1-0/SPOT4-HRVIR2-XS_20000907-104645-752_L1C_047-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000907-104645-752_L1C_047-258-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000907-104645-752_L1C_047-258-0_D_V1-0.zip
run script
2024-01-09T23:30:51.968    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:30:51.968    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000907-104645-752_L1C_047-258-0_D_V1-0.zip
2024-01-09T23:30:51.968    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:30:51.968    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:30:51.968    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:30:51.968    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:30:51.968    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:30:51.968    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:30:51.968    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:30:51.968    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000907-104645-752_L1C_047-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/08/SPOT4-HRVIR2-XS_20000908-102729-732_L1C_047-258-5_D_V1-0/SPOT4-HRVIR2-XS_20000908-102729-732_L1C_047-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000908-102729-732_L1C_047-258-5_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000908-102729-732_L1C_047-258-5_D_V1-0.zip
run script
2024-01-09T23:30:55.226    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:30:55.227    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000908-102729-732_L1C_047-258-5_D_V1-0.zip
2024-01-09T23:30:55.227    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:30:55.227    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:30:55.228    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:30:55.228    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:30:55.228    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:30:55.228    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:30:55.228    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:30:55.228    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000908-102729-732_L1C_047-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/08/SPOT4-HRVIR2-XS_20000908-102732-439_L1C_047-258-8_D_V1-0/SPOT4-HRVIR2-XS_20000908-102732-439_L1C_047-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000908-102732-439_L1C_047-258-8_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000908-102732-439_L1C_047-258-8_D_V1-0.zip
run script
2024-01-09T23:30:58.824    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:30:58.825    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000908-102732-439_L1C_047-258-8_D_V1-0.zip
2024-01-09T23:30:58.825    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:30:58.825    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:30:58.825    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:30:58.825    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:30:58.825    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:30:58.825    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:30:58.825    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:30:58.825    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000908-102732-439_L1C_047-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/08/SPOT4-HRVIR1-XS_20000908-102703-120_L1C_049-255-5_D_V1-0/SPOT4-HRVIR1-XS_20000908-102703-120_L1C_049-255-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000908-102703-120_L1C_049-255-5_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000908-102703-120_L1C_049-255-5_D_V1-0.zip
run script
2024-01-09T23:31:02.392    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:31:02.393    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000908-102703-120_L1C_049-255-5_D_V1-0.zip
2024-01-09T23:31:02.393    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:31:02.393    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:31:02.393    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:31:02.393    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:31:02.393    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:31:02.393    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:31:02.393    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:31:02.393    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000908-102703-120_L1C_049-255-5_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/08/SPOT4-HRVIR1-XS_20000908-102706-820_L1C_049-256-0_D_V1-0/SPOT4-HRVIR1-XS_20000908-102706-820_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000908-102706-820_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000908-102706-820_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T23:32:42.221    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:32:42.221    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000908-102706-820_L1C_049-256-0_D_V1-0.zip
2024-01-09T23:32:42.221    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:32:42.222    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:32:42.222    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:32:42.222    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:32:42.222    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:32:42.222    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:32:42.222    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:32:42.222    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000908-102706-820_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/08/SPOT4-HRVIR1-XS_20000908-102715-043_L1C_049-257-0_D_V1-0/SPOT4-HRVIR1-XS_20000908-102715-043_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000908-102715-043_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000908-102715-043_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T23:34:49.643    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:34:49.645    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000908-102715-043_L1C_049-257-0_D_V1-0.zip
2024-01-09T23:34:49.645    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:34:49.645    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:34:49.645    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:34:49.645    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:34:49.645    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:34:49.645    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:34:49.646    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:34:49.646    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T23:36:31.346    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (76 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000908-102715-043_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/09/08/SPOT4-HRVIR1-XS_20000908-102743-715_L1C_053-260-9_D_V1-0/SPOT4-HRVIR1-XS_20000908-102743-715_L1C_053-260-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000908-102743-715_L1C_053-260-9_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000908-102743-715_L1C_053-260-9_D_V1-0.zip
run script
2024-01-09T23:36:34.815    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:36:34.816    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000908-102743-715_L1C_053-260-9_D_V1-0.zip
2024-01-09T23:36:34.816    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:36:34.816    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:36:34.816    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:36:34.816    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:36:34.816    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:36:34.816    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:36:34.816    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:36:34.816    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000908-102743-715_L1C_053-260-9_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/08/SPOT4-HRVIR1-XS_20000908-102743-884_L1C_054-261-0_D_V1-0/SPOT4-HRVIR1-XS_20000908-102743-884_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000908-102743-884_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000908-102743-884_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T23:38:46.441    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:38:46.443    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000908-102743-884_L1C_054-261-0_D_V1-0.zip
2024-01-09T23:38:46.443    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:38:46.443    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:38:46.443    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:38:46.443    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:38:46.443    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:38:46.443    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:38:46.443    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:38:46.443    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000908-102743-884_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/08/SPOT4-HRVIR1-XS_20000908-102752-180_L1C_054-262-0_D_V1-0/SPOT4-HRVIR1-XS_20000908-102752-180_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000908-102752-180_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000908-102752-180_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T23:40:56.724    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:40:56.726    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000908-102752-180_L1C_054-262-0_D_V1-0.zip
2024-01-09T23:40:56.726    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:40:56.726    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:40:56.726    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:40:56.726    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:40:56.726    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:40:56.726    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:40:56.726    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:40:56.726    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000908-102752-180_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/11/SPOT4-HRVIR2-XS_20000911-110950-592_L1C_047-258-0_D_V1-0/SPOT4-HRVIR2-XS_20000911-110950-592_L1C_047-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000911-110950-592_L1C_047-258-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000911-110950-592_L1C_047-258-0_D_V1-0.zip
run script
2024-01-09T23:43:16.194    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:43:16.196    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000911-110950-592_L1C_047-258-0_D_V1-0.zip
2024-01-09T23:43:16.196    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:43:16.196    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:43:16.196    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:43:16.196    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:43:16.196    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:43:16.196    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:43:16.196    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:43:16.196    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000911-110950-592_L1C_047-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/11/SPOT4-HRVIR2-XS_20000911-110958-714_L1C_047-258-9_D_V1-0/SPOT4-HRVIR2-XS_20000911-110958-714_L1C_047-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000911-110958-714_L1C_047-258-9_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000911-110958-714_L1C_047-258-9_D_V1-0.zip
run script
2024-01-09T23:43:19.799    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:43:19.800    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000911-110958-714_L1C_047-258-9_D_V1-0.zip
2024-01-09T23:43:19.801    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:43:19.801    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:43:19.801    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:43:19.801    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:43:19.801    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:43:19.801    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:43:19.801    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:43:19.801    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000911-110958-714_L1C_047-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/11/SPOT4-HRVIR2-XS_20000911-110949-323_L1C_048-257-8_D_V1-0/SPOT4-HRVIR2-XS_20000911-110949-323_L1C_048-257-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000911-110949-323_L1C_048-257-8_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000911-110949-323_L1C_048-257-8_D_V1-0.zip
run script
2024-01-09T23:43:23.676    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:43:23.677    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000911-110949-323_L1C_048-257-8_D_V1-0.zip
2024-01-09T23:43:23.677    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:43:23.677    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:43:23.677    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:43:23.677    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:43:23.678    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:43:23.678    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:43:23.678    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:43:23.678    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000911-110949-323_L1C_048-257-8_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/21/SPOT4-HRVIR1-XS_20000721-111006-430_L1C_047-259-0_D_V1-0/SPOT4-HRVIR1-XS_20000721-111006-430_L1C_047-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000721-111006-430_L1C_047-259-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000721-111006-430_L1C_047-259-0_D_V1-0.zip
run script
2024-01-09T23:43:27.487    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:43:27.489    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000721-111006-430_L1C_047-259-0_D_V1-0.zip
2024-01-09T23:43:27.489    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:43:27.489    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:43:27.489    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:43:27.489    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:43:27.489    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:43:27.489    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:43:27.489    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:43:27.489    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000721-111006-430_L1C_047-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/21/SPOT4-HRVIR1-XS_20000721-111014-922_L1C_047-260-0_D_V1-0/SPOT4-HRVIR1-XS_20000721-111014-922_L1C_047-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000721-111014-922_L1C_047-260-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000721-111014-922_L1C_047-260-0_D_V1-0.zip
run script
2024-01-09T23:43:31.081    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:43:31.082    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000721-111014-922_L1C_047-260-0_D_V1-0.zip
2024-01-09T23:43:31.082    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:43:31.082    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:43:31.082    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:43:31.082    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:43:31.082    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:43:31.082    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:43:31.082    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:43:31.083    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000721-111014-922_L1C_047-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/10/28/SPOT4-HRVIR2-XS_20001028-110613-406_L1C_047-259-7_D_V1-0/SPOT4-HRVIR2-XS_20001028-110613-406_L1C_047-259-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001028-110613-406_L1C_047-259-7_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001028-110613-406_L1C_047-259-7_D_V1-0.zip
run script
2024-01-09T23:43:34.878    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:43:34.879    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001028-110613-406_L1C_047-259-7_D_V1-0.zip
2024-01-09T23:43:34.880    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:43:34.880    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:43:34.880    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:43:34.880    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:43:34.880    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:43:34.880    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:43:34.880    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:43:34.880    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001028-110613-406_L1C_047-259-7_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/10/28/SPOT4-HRVIR2-XS_20001028-110615-541_L1C_047-260-0_D_V1-0/SPOT4-HRVIR2-XS_20001028-110615-541_L1C_047-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001028-110615-541_L1C_047-260-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001028-110615-541_L1C_047-260-0_D_V1-0.zip
run script
2024-01-09T23:43:38.420    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:43:38.421    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001028-110615-541_L1C_047-260-0_D_V1-0.zip
2024-01-09T23:43:38.421    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:43:38.421    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:43:38.421    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:43:38.421    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:43:38.421    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:43:38.421    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:43:38.421    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:43:38.421    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001028-110615-541_L1C_047-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/01/27/SPOT4-HRVIR1-XS_20000127-105335-766_L1C_048-254-0_D_V1-0/SPOT4-HRVIR1-XS_20000127-105335-766_L1C_048-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000127-105335-766_L1C_048-254-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000127-105335-766_L1C_048-254-0_D_V1-0.zip
run script
2024-01-09T23:43:41.928    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:43:41.929    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000127-105335-766_L1C_048-254-0_D_V1-0.zip
2024-01-09T23:43:41.929    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:43:41.929    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:43:41.930    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:43:41.930    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:43:41.930    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:43:41.930    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:43:41.930    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:43:41.930    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000127-105335-766_L1C_048-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/01/27/SPOT4-HRVIR1-XS_20000127-105344-105_L1C_048-255-0_D_V1-0/SPOT4-HRVIR1-XS_20000127-105344-105_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000127-105344-105_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000127-105344-105_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T23:43:45.316    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:43:45.317    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000127-105344-105_L1C_048-255-0_D_V1-0.zip
2024-01-09T23:43:45.317    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:43:45.317    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:43:45.317    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:43:45.317    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:43:45.317    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:43:45.317    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:43:45.317    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:43:45.318    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000127-105344-105_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/01/27/SPOT4-HRVIR1-XS_20000127-105352-449_L1C_048-256-0_D_V1-0/SPOT4-HRVIR1-XS_20000127-105352-449_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000127-105352-449_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000127-105352-449_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T23:44:02.420    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:44:02.421    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000127-105352-449_L1C_048-256-0_D_V1-0.zip
2024-01-09T23:44:02.421    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:44:02.421    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:44:02.421    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:44:02.421    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:44:02.421    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:44:02.421    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:44:02.421    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:44:02.421    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000127-105352-449_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/01/27/SPOT4-HRVIR2-XS_20000127-105332-574_L1C_050-254-0_D_V1-0/SPOT4-HRVIR2-XS_20000127-105332-574_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000127-105332-574_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000127-105332-574_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T23:44:26.367    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:44:26.368    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000127-105332-574_L1C_050-254-0_D_V1-0.zip
2024-01-09T23:44:26.368    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:44:26.368    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:44:26.368    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:44:26.368    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:44:26.368    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:44:26.368    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:44:26.368    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:44:26.368    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000127-105332-574_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/01/27/SPOT4-HRVIR2-XS_20000127-105340-945_L1C_050-255-0_D_V1-0/SPOT4-HRVIR2-XS_20000127-105340-945_L1C_050-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000127-105340-945_L1C_050-255-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000127-105340-945_L1C_050-255-0_D_V1-0.zip
run script
2024-01-09T23:44:30.300    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:44:30.301    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000127-105340-945_L1C_050-255-0_D_V1-0.zip
2024-01-09T23:44:30.301    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:44:30.301    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:44:30.301    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:44:30.302    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:44:30.302    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:44:30.302    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:44:30.302    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:44:30.302    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000127-105340-945_L1C_050-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/01/27/SPOT4-HRVIR2-XS_20000127-105349-322_L1C_050-256-0_D_V1-0/SPOT4-HRVIR2-XS_20000127-105349-322_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000127-105349-322_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000127-105349-322_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T23:45:34.545    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:45:34.547    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000127-105349-322_L1C_050-256-0_D_V1-0.zip
2024-01-09T23:45:34.547    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:45:34.547    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:45:34.547    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:45:34.547    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:45:34.547    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:45:34.547    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:45:34.547    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:45:34.547    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000127-105349-322_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/10/SPOT4-HRVIR1-XS_20000410-103038-830_L1C_048-254-0_D_V1-0/SPOT4-HRVIR1-XS_20000410-103038-830_L1C_048-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000410-103038-830_L1C_048-254-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000410-103038-830_L1C_048-254-0_D_V1-0.zip
run script
2024-01-09T23:48:40.038    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:48:40.040    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000410-103038-830_L1C_048-254-0_D_V1-0.zip
2024-01-09T23:48:40.040    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:48:40.040    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:48:40.040    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:48:40.040    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:48:40.040    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:48:40.040    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:48:40.040    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:48:40.040    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000410-103038-830_L1C_048-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/10/SPOT4-HRVIR1-XS_20000410-103059-966_L1C_049-256-7_D_V1-0/SPOT4-HRVIR1-XS_20000410-103059-966_L1C_049-256-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000410-103059-966_L1C_049-256-7_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000410-103059-966_L1C_049-256-7_D_V1-0.zip
run script
2024-01-09T23:48:43.899    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:48:43.900    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000410-103059-966_L1C_049-256-7_D_V1-0.zip
2024-01-09T23:48:43.901    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:48:43.901    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:48:43.901    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:48:43.901    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:48:43.901    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:48:43.901    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:48:43.901    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:48:43.901    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000410-103059-966_L1C_049-256-7_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/10/SPOT4-HRVIR1-XS_20000410-103101-888_L1C_049-257-0_D_V1-0/SPOT4-HRVIR1-XS_20000410-103101-888_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000410-103101-888_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000410-103101-888_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T23:50:51.581    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:50:51.582    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000410-103101-888_L1C_049-257-0_D_V1-0.zip
2024-01-09T23:50:51.582    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:50:51.582    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:50:51.582    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:50:51.582    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:50:51.582    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:50:51.582    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:50:51.582    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:50:51.582    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000410-103101-888_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/17/SPOT4-HRVIR1-XS_20000617-102315-495_L1C_048-254-9_D_V1-0/SPOT4-HRVIR1-XS_20000617-102315-495_L1C_048-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000617-102315-495_L1C_048-254-9_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000617-102315-495_L1C_048-254-9_D_V1-0.zip
run script
2024-01-09T23:52:47.255    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:52:47.256    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000617-102315-495_L1C_048-254-9_D_V1-0.zip
2024-01-09T23:52:47.256    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:52:47.256    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:52:47.256    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:52:47.256    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:52:47.257    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:52:47.257    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:52:47.257    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:52:47.257    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000617-102315-495_L1C_048-254-9_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/17/SPOT4-HRVIR1-XS_20000617-102315-558_L1C_048-255-0_D_V1-0/SPOT4-HRVIR1-XS_20000617-102315-558_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000617-102315-558_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000617-102315-558_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T23:53:06.646    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:53:06.648    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000617-102315-558_L1C_048-255-0_D_V1-0.zip
2024-01-09T23:53:06.648    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:53:06.648    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:53:06.648    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:53:06.648    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:53:06.648    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:53:06.648    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:53:06.648    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:53:06.648    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000617-102315-558_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/17/SPOT4-HRVIR2-XS_20000617-102325-872_L1C_050-256-4_D_V1-0/SPOT4-HRVIR2-XS_20000617-102325-872_L1C_050-256-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000617-102325-872_L1C_050-256-4_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000617-102325-872_L1C_050-256-4_D_V1-0.zip
run script
2024-01-09T23:53:27.265    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:53:27.266    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000617-102325-872_L1C_050-256-4_D_V1-0.zip
2024-01-09T23:53:27.266    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:53:27.266    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:53:27.267    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:53:27.267    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:53:27.267    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:53:27.267    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:53:27.267    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:53:27.267    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000617-102325-872_L1C_050-256-4_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/17/SPOT4-HRVIR2-XS_20000617-102329-482_L1C_050-256-8_D_V1-0/SPOT4-HRVIR2-XS_20000617-102329-482_L1C_050-256-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000617-102329-482_L1C_050-256-8_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000617-102329-482_L1C_050-256-8_D_V1-0.zip
run script
2024-01-09T23:55:58.386    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:55:58.387    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000617-102329-482_L1C_050-256-8_D_V1-0.zip
2024-01-09T23:55:58.387    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:55:58.387    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:55:58.387    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:55:58.387    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:55:58.388    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:55:58.388    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:55:58.388    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:55:58.388    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000617-102329-482_L1C_050-256-8_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/17/SPOT4-HRVIR1-XS_20000617-102412-233_L1C_050-262-1_D_V1-0/SPOT4-HRVIR1-XS_20000617-102412-233_L1C_050-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000617-102412-233_L1C_050-262-1_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000617-102412-233_L1C_050-262-1_D_V1-0.zip
run script
2024-01-09T23:58:27.535    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:58:27.537    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000617-102412-233_L1C_050-262-1_D_V1-0.zip
2024-01-09T23:58:27.537    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:58:27.537    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:58:27.537    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:58:27.537    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:58:27.537    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:58:27.537    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:58:27.537    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:58:27.537    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000617-102412-233_L1C_050-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/17/SPOT4-HRVIR2-XS_20000617-102344-200_L1C_052-258-9_D_V1-0/SPOT4-HRVIR2-XS_20000617-102344-200_L1C_052-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000617-102344-200_L1C_052-258-9_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000617-102344-200_L1C_052-258-9_D_V1-0.zip
run script
2024-01-09T23:59:29.705    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:59:29.706    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000617-102344-200_L1C_052-258-9_D_V1-0.zip
2024-01-09T23:59:29.706    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:59:29.706    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:59:29.706    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:59:29.706    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:59:29.706    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:59:29.707    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:59:29.707    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:59:29.707    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000617-102344-200_L1C_052-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 0 0 ... 0 0 0]
 [2 0 0 ... 0 0 0]
 [2 0 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/17/SPOT4-HRVIR2-XS_20000617-102344-329_L1C_053-259-0_D_V1-0/SPOT4-HRVIR2-XS_20000617-102344-329_L1C_053-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000617-102344-329_L1C_053-259-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000617-102344-329_L1C_053-259-0_D_V1-0.zip
run script
2024-01-10T00:02:02.189    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:02:02.190    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000617-102344-329_L1C_053-259-0_D_V1-0.zip
2024-01-10T00:02:02.190    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:02:02.190    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:02:02.190    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:02:02.190    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:02:02.190    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:02:02.190    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:02:02.190    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:02:02.191    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000617-102344-329_L1C_053-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/17/SPOT4-HRVIR2-XS_20000617-102352-589_L1C_053-260-0_D_V1-0/SPOT4-HRVIR2-XS_20000617-102352-589_L1C_053-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000617-102352-589_L1C_053-260-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000617-102352-589_L1C_053-260-0_D_V1-0.zip
run script
2024-01-10T00:04:47.269    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:04:47.270    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000617-102352-589_L1C_053-260-0_D_V1-0.zip
2024-01-10T00:04:47.270    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:04:47.270    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:04:47.270    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:04:47.270    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:04:47.271    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:04:47.271    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:04:47.271    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:04:47.271    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000617-102352-589_L1C_053-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/17/SPOT4-HRVIR2-XS_20000617-102401-758_L1C_053-261-1_D_V1-0/SPOT4-HRVIR2-XS_20000617-102401-758_L1C_053-261-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000617-102401-758_L1C_053-261-1_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000617-102401-758_L1C_053-261-1_D_V1-0.zip
run script
2024-01-10T00:07:23.886    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:07:23.887    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000617-102401-758_L1C_053-261-1_D_V1-0.zip
2024-01-10T00:07:23.887    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:07:23.887    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:07:23.887    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:07:23.887    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:07:23.887    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:07:23.887    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:07:23.887    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:07:23.887    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000617-102401-758_L1C_053-261-1_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/29/SPOT4-HRVIR2-XS_20000929-102310-893_L1C_048-255-3_D_V1-0/SPOT4-HRVIR2-XS_20000929-102310-893_L1C_048-255-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000929-102310-893_L1C_048-255-3_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000929-102310-893_L1C_048-255-3_D_V1-0.zip
run script
2024-01-10T00:10:12.725    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:10:12.726    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000929-102310-893_L1C_048-255-3_D_V1-0.zip
2024-01-10T00:10:12.726    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:10:12.726    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:10:12.726    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:10:12.726    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:10:12.727    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:10:12.727    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:10:12.727    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:10:12.727    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000929-102310-893_L1C_048-255-3_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/11/20/SPOT4-HRVIR2-XS_20001120-102253-044_L1C_048-255-0_D_V1-0/SPOT4-HRVIR2-XS_20001120-102253-044_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001120-102253-044_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001120-102253-044_L1C_048-255-0_D_V1-0.zip
run script
2024-01-10T00:10:50.169    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:10:50.170    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001120-102253-044_L1C_048-255-0_D_V1-0.zip
2024-01-10T00:10:50.170    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:10:50.170    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:10:50.170    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:10:50.170    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:10:50.170    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:10:50.171    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:10:50.171    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:10:50.171    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T00:11:18.266    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (52 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001120-102253-044_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/11/20/SPOT4-HRVIR2-XS_20001120-102254-849_L1C_048-255-2_D_V1-0/SPOT4-HRVIR2-XS_20001120-102254-849_L1C_048-255-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001120-102254-849_L1C_048-255-2_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001120-102254-849_L1C_048-255-2_D_V1-0.zip
run script
2024-01-10T00:11:21.717    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:11:21.718    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001120-102254-849_L1C_048-255-2_D_V1-0.zip
2024-01-10T00:11:21.719    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:11:21.719    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:11:21.719    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:11:21.719    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:11:21.719    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:11:21.719    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:11:21.719    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:11:21.719    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001120-102254-849_L1C_048-255-2_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/26/SPOT4-HRVIR1-XS_20000626-105027-882_L1C_048-256-5_D_V1-0/SPOT4-HRVIR1-XS_20000626-105027-882_L1C_048-256-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000626-105027-882_L1C_048-256-5_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000626-105027-882_L1C_048-256-5_D_V1-0.zip
run script
2024-01-10T00:12:00.836    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:12:00.837    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000626-105027-882_L1C_048-256-5_D_V1-0.zip
2024-01-10T00:12:00.837    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:12:00.837    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:12:00.837    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:12:00.837    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:12:00.837    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:12:00.837    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:12:00.838    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:12:00.838    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000626-105027-882_L1C_048-256-5_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/26/SPOT4-HRVIR1-XS_20000626-105031-491_L1C_048-256-9_D_V1-0/SPOT4-HRVIR1-XS_20000626-105031-491_L1C_048-256-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000626-105031-491_L1C_048-256-9_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000626-105031-491_L1C_048-256-9_D_V1-0.zip
run script
2024-01-10T00:12:19.071    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:12:19.072    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000626-105031-491_L1C_048-256-9_D_V1-0.zip
2024-01-10T00:12:19.073    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:12:19.073    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:12:19.073    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:12:19.073    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:12:19.073    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:12:19.073    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:12:19.073    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:12:19.073    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T00:12:21.148    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (746 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000626-105031-491_L1C_048-256-9_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/06/26/SPOT4-HRVIR2-XS_20000626-105045-925_L1C_049-259-0_D_V1-0/SPOT4-HRVIR2-XS_20000626-105045-925_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000626-105045-925_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000626-105045-925_L1C_049-259-0_D_V1-0.zip
run script
2024-01-10T00:12:24.746    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:12:24.747    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000626-105045-925_L1C_049-259-0_D_V1-0.zip
2024-01-10T00:12:24.747    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:12:24.747    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:12:24.747    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:12:24.747    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:12:24.747    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:12:24.747    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:12:24.747    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:12:24.748    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000626-105045-925_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/26/SPOT4-HRVIR2-XS_20000626-105054-293_L1C_049-260-0_D_V1-0/SPOT4-HRVIR2-XS_20000626-105054-293_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000626-105054-293_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000626-105054-293_L1C_049-260-0_D_V1-0.zip
run script
2024-01-10T00:13:37.497    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:13:37.499    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000626-105054-293_L1C_049-260-0_D_V1-0.zip
2024-01-10T00:13:37.499    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:13:37.499    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:13:37.499    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:13:37.499    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:13:37.499    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:13:37.499    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:13:37.499    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:13:37.499    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000626-105054-293_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/26/SPOT4-HRVIR2-XS_20000626-105056-098_L1C_049-260-2_D_V1-0/SPOT4-HRVIR2-XS_20000626-105056-098_L1C_049-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000626-105056-098_L1C_049-260-2_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000626-105056-098_L1C_049-260-2_D_V1-0.zip
run script
2024-01-10T00:14:24.886    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:14:24.887    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000626-105056-098_L1C_049-260-2_D_V1-0.zip
2024-01-10T00:14:24.887    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:14:24.888    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:14:24.888    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:14:24.888    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:14:24.888    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:14:24.888    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:14:24.888    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:14:24.888    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T00:14:26.978    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 140). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000626-105056-098_L1C_049-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/06/26/SPOT4-HRVIR2-XS_20000626-105110-621_L1C_050-262-1_D_V1-0/SPOT4-HRVIR2-XS_20000626-105110-621_L1C_050-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000626-105110-621_L1C_050-262-1_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000626-105110-621_L1C_050-262-1_D_V1-0.zip
run script
2024-01-10T00:14:30.813    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:14:30.814    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000626-105110-621_L1C_050-262-1_D_V1-0.zip
2024-01-10T00:14:30.814    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:14:30.814    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:14:30.814    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:14:30.814    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:14:30.814    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:14:30.814    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:14:30.814    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:14:30.815    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000626-105110-621_L1C_050-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/01/SPOT4-HRVIR2-XS_20000701-105411-668_L1C_048-256-1_D_V1-0/SPOT4-HRVIR2-XS_20000701-105411-668_L1C_048-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000701-105411-668_L1C_048-256-1_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000701-105411-668_L1C_048-256-1_D_V1-0.zip
run script
2024-01-10T00:15:28.965    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:15:28.967    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000701-105411-668_L1C_048-256-1_D_V1-0.zip
2024-01-10T00:15:28.967    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:15:28.967    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:15:28.967    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:15:28.967    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:15:28.967    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:15:28.967    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:15:28.967    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:15:28.967    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000701-105411-668_L1C_048-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/01/SPOT4-HRVIR2-XS_20000701-105419-116_L1C_048-257-0_D_V1-0/SPOT4-HRVIR2-XS_20000701-105419-116_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000701-105419-116_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000701-105419-116_L1C_048-257-0_D_V1-0.zip
run script
2024-01-10T00:16:01.877    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:16:01.878    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000701-105419-116_L1C_048-257-0_D_V1-0.zip
2024-01-10T00:16:01.878    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:16:01.878    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:16:01.878    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:16:01.878    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:16:01.878    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:16:01.879    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:16:01.879    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:16:01.879    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000701-105419-116_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/01/SPOT4-HRVIR1-XS_20000701-105440-426_L1C_048-259-6_D_V1-0/SPOT4-HRVIR1-XS_20000701-105440-426_L1C_048-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000701-105440-426_L1C_048-259-6_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000701-105440-426_L1C_048-259-6_D_V1-0.zip
run script
2024-01-10T00:16:14.721    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:16:14.722    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000701-105440-426_L1C_048-259-6_D_V1-0.zip
2024-01-10T00:16:14.722    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:16:14.722    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:16:14.722    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:16:14.722    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:16:14.722    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:16:14.722    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:16:14.722    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:16:14.722    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000701-105440-426_L1C_048-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/01/SPOT4-HRVIR1-XS_20000701-105444-295_L1C_048-260-1_D_V1-0/SPOT4-HRVIR1-XS_20000701-105444-295_L1C_048-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000701-105444-295_L1C_048-260-1_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000701-105444-295_L1C_048-260-1_D_V1-0.zip
run script
2024-01-10T00:16:20.021    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:16:20.022    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000701-105444-295_L1C_048-260-1_D_V1-0.zip
2024-01-10T00:16:20.022    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:16:20.022    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:16:20.022    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:16:20.022    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:16:20.022    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:16:20.023    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:16:20.023    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:16:20.023    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000701-105444-295_L1C_048-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/11/25/SPOT4-HRVIR2-XS_20001125-102649-455_L1C_048-256-2_D_V1-0/SPOT4-HRVIR2-XS_20001125-102649-455_L1C_048-256-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001125-102649-455_L1C_048-256-2_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001125-102649-455_L1C_048-256-2_D_V1-0.zip
run script
2024-01-10T00:16:23.733    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:16:23.734    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001125-102649-455_L1C_048-256-2_D_V1-0.zip
2024-01-10T00:16:23.734    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:16:23.734    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:16:23.734    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:16:23.734    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:16:23.734    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:16:23.734    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:16:23.734    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:16:23.734    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001125-102649-455_L1C_048-256-2_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/11/25/SPOT4-HRVIR2-XS_20001125-102655-868_L1C_048-257-0_D_V1-0/SPOT4-HRVIR2-XS_20001125-102655-868_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001125-102655-868_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001125-102655-868_L1C_048-257-0_D_V1-0.zip
run script
2024-01-10T00:17:04.601    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:17:04.602    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001125-102655-868_L1C_048-257-0_D_V1-0.zip
2024-01-10T00:17:04.602    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:17:04.602    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:17:04.602    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:17:04.602    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:17:04.602    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:17:04.602    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:17:04.602    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:17:04.602    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001125-102655-868_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/11/25/SPOT4-HRVIR2-XS_20001125-102704-092_L1C_048-258-0_D_V1-0/SPOT4-HRVIR2-XS_20001125-102704-092_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001125-102704-092_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001125-102704-092_L1C_048-258-0_D_V1-0.zip
run script
2024-01-10T00:17:35.917    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:17:35.918    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001125-102704-092_L1C_048-258-0_D_V1-0.zip
2024-01-10T00:17:35.918    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:17:35.918    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:17:35.918    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:17:35.918    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:17:35.918    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:17:35.918    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:17:35.918    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:17:35.918    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001125-102704-092_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/11/25/SPOT4-HRVIR2-XS_20001125-102712-328_L1C_048-259-0_D_V1-0/SPOT4-HRVIR2-XS_20001125-102712-328_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001125-102712-328_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001125-102712-328_L1C_048-259-0_D_V1-0.zip
run script
2024-01-10T00:17:49.515    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:17:49.516    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001125-102712-328_L1C_048-259-0_D_V1-0.zip
2024-01-10T00:17:49.517    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:17:49.517    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:17:49.517    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:17:49.517    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:17:49.517    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:17:49.517    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:17:49.517    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:17:49.517    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001125-102712-328_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/20/SPOT4-HRVIR1-XS_20000420-103908-726_L1C_048-259-2_D_V1-0/SPOT4-HRVIR1-XS_20000420-103908-726_L1C_048-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000420-103908-726_L1C_048-259-2_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000420-103908-726_L1C_048-259-2_D_V1-0.zip
run script
2024-01-10T00:17:53.458    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:17:53.459    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000420-103908-726_L1C_048-259-2_D_V1-0.zip
2024-01-10T00:17:53.459    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:17:53.459    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:17:53.459    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:17:53.459    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:17:53.459    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:17:53.459    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:17:53.459    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:17:53.460    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000420-103908-726_L1C_048-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/20/SPOT4-HRVIR1-XS_20000420-103912-335_L1C_048-259-6_D_V1-0/SPOT4-HRVIR1-XS_20000420-103912-335_L1C_048-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000420-103912-335_L1C_048-259-6_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000420-103912-335_L1C_048-259-6_D_V1-0.zip
run script
2024-01-10T00:17:57.075    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:17:57.076    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000420-103912-335_L1C_048-259-6_D_V1-0.zip
2024-01-10T00:17:57.076    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:17:57.076    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:17:57.076    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:17:57.076    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:17:57.076    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:17:57.076    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:17:57.077    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:17:57.077    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000420-103912-335_L1C_048-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/25/SPOT4-HRVIR1-XS_20000425-104304-258_L1C_048-259-3_D_V1-0/SPOT4-HRVIR1-XS_20000425-104304-258_L1C_048-259-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000425-104304-258_L1C_048-259-3_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000425-104304-258_L1C_048-259-3_D_V1-0.zip
run script
2024-01-10T00:18:00.583    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:18:00.584    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000425-104304-258_L1C_048-259-3_D_V1-0.zip
2024-01-10T00:18:00.584    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:18:00.584    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:18:00.584    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:18:00.584    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:18:00.584    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:18:00.584    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:18:00.584    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:18:00.584    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000425-104304-258_L1C_048-259-3_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/25/SPOT4-HRVIR1-XS_20000425-104306-965_L1C_048-259-6_D_V1-0/SPOT4-HRVIR1-XS_20000425-104306-965_L1C_048-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000425-104306-965_L1C_048-259-6_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000425-104306-965_L1C_048-259-6_D_V1-0.zip
run script
2024-01-10T00:18:04.219    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:18:04.220    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000425-104306-965_L1C_048-259-6_D_V1-0.zip
2024-01-10T00:18:04.220    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:18:04.220    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:18:04.220    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:18:04.220    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:18:04.221    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:18:04.221    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:18:04.221    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:18:04.221    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000425-104306-965_L1C_048-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/25/SPOT4-HRVIR1-XS_20000425-104216-779_L1C_051-254-0_D_V1-0/SPOT4-HRVIR1-XS_20000425-104216-779_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000425-104216-779_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000425-104216-779_L1C_051-254-0_D_V1-0.zip
run script
2024-01-10T00:18:07.713    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:18:07.714    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000425-104216-779_L1C_051-254-0_D_V1-0.zip
2024-01-10T00:18:07.714    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:18:07.714    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:18:07.714    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:18:07.714    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:18:07.714    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:18:07.714    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:18:07.714    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:18:07.715    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000425-104216-779_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/05/20/SPOT4-HRVIR2-XS_20000520-110218-690_L1C_048-259-6_D_V1-0/SPOT4-HRVIR2-XS_20000520-110218-690_L1C_048-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000520-110218-690_L1C_048-259-6_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000520-110218-690_L1C_048-259-6_D_V1-0.zip
run script
2024-01-10T00:18:11.481    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:18:11.483    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000520-110218-690_L1C_048-259-6_D_V1-0.zip
2024-01-10T00:18:11.483    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:18:11.483    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:18:11.483    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:18:11.483    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:18:11.483    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:18:11.483    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:18:11.483    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:18:11.483    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000520-110218-690_L1C_048-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/05/20/SPOT4-HRVIR2-XS_20000520-110219-593_L1C_048-259-7_D_V1-0/SPOT4-HRVIR2-XS_20000520-110219-593_L1C_048-259-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000520-110219-593_L1C_048-259-7_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000520-110219-593_L1C_048-259-7_D_V1-0.zip
run script
2024-01-10T00:18:15.503    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:18:15.503    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000520-110219-593_L1C_048-259-7_D_V1-0.zip
2024-01-10T00:18:15.504    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:18:15.504    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:18:15.504    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:18:15.504    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:18:15.504    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:18:15.504    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:18:15.504    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:18:15.504    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000520-110219-593_L1C_048-259-7_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/05/22/SPOT4-HRVIR1-XS_20000522-102337-582_L1C_048-259-4_D_V1-0/SPOT4-HRVIR1-XS_20000522-102337-582_L1C_048-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000522-102337-582_L1C_048-259-4_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000522-102337-582_L1C_048-259-4_D_V1-0.zip
run script
2024-01-10T00:18:19.532    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:18:19.533    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000522-102337-582_L1C_048-259-4_D_V1-0.zip
2024-01-10T00:18:19.533    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:18:19.533    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:18:19.534    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:18:19.534    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:18:19.534    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:18:19.534    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:18:19.534    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:18:19.534    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T00:18:22.498    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (187 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000522-102337-582_L1C_048-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/05/22/SPOT4-HRVIR1-XS_20000522-102342-209_L1C_048-260-0_D_V1-0/SPOT4-HRVIR1-XS_20000522-102342-209_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000522-102342-209_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000522-102342-209_L1C_048-260-0_D_V1-0.zip
run script
2024-01-10T00:18:26.346    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:18:26.347    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000522-102342-209_L1C_048-260-0_D_V1-0.zip
2024-01-10T00:18:26.347    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:18:26.347    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:18:26.347    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:18:26.347    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:18:26.347    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:18:26.347    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:18:26.347    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:18:26.347    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000522-102342-209_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/05/22/SPOT4-HRVIR2-XS_20000522-102308-366_L1C_049-256-0_D_V1-0/SPOT4-HRVIR2-XS_20000522-102308-366_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000522-102308-366_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000522-102308-366_L1C_049-256-0_D_V1-0.zip
run script
2024-01-10T00:18:29.736    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:18:29.737    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000522-102308-366_L1C_049-256-0_D_V1-0.zip
2024-01-10T00:18:29.737    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:18:29.737    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:18:29.737    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:18:29.737    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:18:29.738    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:18:29.738    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:18:29.738    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:18:29.738    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000522-102308-366_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/13/SPOT4-HRVIR2-XS_20000913-103126-469_L1C_048-259-5_D_V1-0/SPOT4-HRVIR2-XS_20000913-103126-469_L1C_048-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000913-103126-469_L1C_048-259-5_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000913-103126-469_L1C_048-259-5_D_V1-0.zip
run script
2024-01-10T00:20:28.994    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:20:28.995    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000913-103126-469_L1C_048-259-5_D_V1-0.zip
2024-01-10T00:20:28.996    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:20:28.996    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:20:28.996    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:20:28.996    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:20:28.996    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:20:28.996    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:20:28.996    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:20:28.996    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000913-103126-469_L1C_048-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/13/SPOT4-HRVIR2-XS_20000913-103130-208_L1C_048-260-0_D_V1-0/SPOT4-HRVIR2-XS_20000913-103130-208_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000913-103130-208_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000913-103130-208_L1C_048-260-0_D_V1-0.zip
run script
2024-01-10T00:20:33.118    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:20:33.119    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000913-103130-208_L1C_048-260-0_D_V1-0.zip
2024-01-10T00:20:33.119    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:20:33.120    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:20:33.120    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:20:33.120    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:20:33.120    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:20:33.120    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:20:33.120    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:20:33.120    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000913-103130-208_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/13/SPOT4-HRVIR1-XS_20000913-103141-166_L1C_052-261-8_D_V1-0/SPOT4-HRVIR1-XS_20000913-103141-166_L1C_052-261-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000913-103141-166_L1C_052-261-8_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000913-103141-166_L1C_052-261-8_D_V1-0.zip
run script
2024-01-10T00:20:36.573    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:20:36.574    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000913-103141-166_L1C_052-261-8_D_V1-0.zip
2024-01-10T00:20:36.574    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:20:36.574    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:20:36.574    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:20:36.574    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:20:36.574    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:20:36.574    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:20:36.574    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:20:36.574    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000913-103141-166_L1C_052-261-8_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/13/SPOT4-HRVIR1-XS_20000913-103142-246_L1C_052-262-0_D_V1-0/SPOT4-HRVIR1-XS_20000913-103142-246_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000913-103142-246_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000913-103142-246_L1C_052-262-0_D_V1-0.zip
run script
2024-01-10T00:22:59.262    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:22:59.263    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000913-103142-246_L1C_052-262-0_D_V1-0.zip
2024-01-10T00:22:59.263    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:22:59.263    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:22:59.264    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:22:59.264    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:22:59.264    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:22:59.264    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:22:59.264    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:22:59.264    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000913-103142-246_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/22/SPOT4-HRVIR2-XS_20000922-105830-600_L1C_048-259-4_D_V1-0/SPOT4-HRVIR2-XS_20000922-105830-600_L1C_048-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000922-105830-600_L1C_048-259-4_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000922-105830-600_L1C_048-259-4_D_V1-0.zip
run script
2024-01-10T00:25:16.399    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:25:16.399    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000922-105830-600_L1C_048-259-4_D_V1-0.zip
2024-01-10T00:25:16.399    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:25:16.400    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:25:16.400    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:25:16.400    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:25:16.400    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:25:16.400    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:25:16.400    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:25:16.400    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000922-105830-600_L1C_048-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/22/SPOT4-HRVIR2-XS_20000922-105835-392_L1C_048-260-0_D_V1-0/SPOT4-HRVIR2-XS_20000922-105835-392_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000922-105835-392_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000922-105835-392_L1C_048-260-0_D_V1-0.zip
run script
2024-01-10T00:25:19.980    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:25:19.981    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000922-105835-392_L1C_048-260-0_D_V1-0.zip
2024-01-10T00:25:19.981    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:25:19.981    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:25:19.982    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:25:19.982    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:25:19.982    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:25:19.982    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:25:19.982    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:25:19.982    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000922-105835-392_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/02/08/SPOT4-HRVIR1-XS_20000208-102344-108_L1C_048-261-9_D_V1-0/SPOT4-HRVIR1-XS_20000208-102344-108_L1C_048-261-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000208-102344-108_L1C_048-261-9_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000208-102344-108_L1C_048-261-9_D_V1-0.zip
run script
2024-01-10T00:25:23.500    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:25:23.501    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000208-102344-108_L1C_048-261-9_D_V1-0.zip
2024-01-10T00:25:23.501    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:25:23.501    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:25:23.501    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:25:23.501    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:25:23.501    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:25:23.501    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:25:23.501    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:25:23.502    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000208-102344-108_L1C_048-261-9_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/02/08/SPOT4-HRVIR2-XS_20000208-102343-948_L1C_049-261-9_D_V1-0/SPOT4-HRVIR2-XS_20000208-102343-948_L1C_049-261-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000208-102343-948_L1C_049-261-9_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000208-102343-948_L1C_049-261-9_D_V1-0.zip
run script
2024-01-10T00:25:27.208    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:25:27.209    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000208-102343-948_L1C_049-261-9_D_V1-0.zip
2024-01-10T00:25:27.209    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:25:27.209    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:25:27.209    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:25:27.209    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:25:27.209    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:25:27.209    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:25:27.209    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:25:27.209    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000208-102343-948_L1C_049-261-9_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/02/08/SPOT4-HRVIR1-XS_20000208-102344-240_L1C_049-262-0_D_V1-0/SPOT4-HRVIR1-XS_20000208-102344-240_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000208-102344-240_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000208-102344-240_L1C_049-262-0_D_V1-0.zip
run script
2024-01-10T00:25:31.008    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:25:31.009    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000208-102344-240_L1C_049-262-0_D_V1-0.zip
2024-01-10T00:25:31.009    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:25:31.009    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:25:31.009    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:25:31.009    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:25:31.009    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:25:31.010    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:25:31.010    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:25:31.010    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000208-102344-240_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/26/SPOT4-HRVIR1-XS_20000426-102307-572_L1C_049-254-9_D_V1-0/SPOT4-HRVIR1-XS_20000426-102307-572_L1C_049-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000426-102307-572_L1C_049-254-9_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000426-102307-572_L1C_049-254-9_D_V1-0.zip
run script
2024-01-10T00:25:34.657    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:25:34.658    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000426-102307-572_L1C_049-254-9_D_V1-0.zip
2024-01-10T00:25:34.658    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:25:34.658    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:25:34.658    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:25:34.658    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:25:34.659    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:25:34.659    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:25:34.659    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:25:34.659    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000426-102307-572_L1C_049-254-9_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/26/SPOT4-HRVIR1-XS_20000426-102307-641_L1C_049-255-0_D_V1-0/SPOT4-HRVIR1-XS_20000426-102307-641_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000426-102307-641_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000426-102307-641_L1C_049-255-0_D_V1-0.zip
run script
2024-01-10T00:26:23.171    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:26:23.172    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000426-102307-641_L1C_049-255-0_D_V1-0.zip
2024-01-10T00:26:23.173    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:26:23.173    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:26:23.173    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:26:23.173    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:26:23.173    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:26:23.173    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:26:23.173    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:26:23.173    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000426-102307-641_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/26/SPOT4-HRVIR1-XS_20000426-102315-844_L1C_049-256-0_D_V1-0/SPOT4-HRVIR1-XS_20000426-102315-844_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000426-102315-844_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000426-102315-844_L1C_049-256-0_D_V1-0.zip
run script
2024-01-10T00:27:11.998    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:27:12.000    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000426-102315-844_L1C_049-256-0_D_V1-0.zip
2024-01-10T00:27:12.000    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:27:12.000    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:27:12.000    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:27:12.000    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:27:12.000    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:27:12.000    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:27:12.000    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:27:12.000    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000426-102315-844_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/26/SPOT4-HRVIR1-XS_20000426-102324-056_L1C_049-257-0_D_V1-0/SPOT4-HRVIR1-XS_20000426-102324-056_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000426-102324-056_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000426-102324-056_L1C_049-257-0_D_V1-0.zip
run script
2024-01-10T00:29:20.344    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:29:20.345    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000426-102324-056_L1C_049-257-0_D_V1-0.zip
2024-01-10T00:29:20.345    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:29:20.345    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:29:20.345    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:29:20.345    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:29:20.345    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:29:20.345    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:29:20.345    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:29:20.345    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T00:31:01.274    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (140 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000426-102324-056_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/04/26/SPOT4-HRVIR2-XS_20000426-102338-697_L1C_049-258-7_D_V1-0/SPOT4-HRVIR2-XS_20000426-102338-697_L1C_049-258-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000426-102338-697_L1C_049-258-7_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000426-102338-697_L1C_049-258-7_D_V1-0.zip
run script
2024-01-10T00:31:05.354    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:31:05.354    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000426-102338-697_L1C_049-258-7_D_V1-0.zip
2024-01-10T00:31:05.354    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:31:05.354    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:31:05.354    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:31:05.354    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:31:05.354    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:31:05.355    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:31:05.355    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:31:05.355    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000426-102338-697_L1C_049-258-7_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/26/SPOT4-HRVIR2-XS_20000426-102340-613_L1C_049-259-0_D_V1-0/SPOT4-HRVIR2-XS_20000426-102340-613_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000426-102340-613_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000426-102340-613_L1C_049-259-0_D_V1-0.zip
run script
2024-01-10T00:32:26.207    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:32:26.209    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000426-102340-613_L1C_049-259-0_D_V1-0.zip
2024-01-10T00:32:26.209    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:32:26.209    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:32:26.209    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:32:26.209    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:32:26.209    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:32:26.209    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:32:26.209    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:32:26.209    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000426-102340-613_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/26/SPOT4-HRVIR2-XS_20000426-102349-758_L1C_049-260-1_D_V1-0/SPOT4-HRVIR2-XS_20000426-102349-758_L1C_049-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000426-102349-758_L1C_049-260-1_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000426-102349-758_L1C_049-260-1_D_V1-0.zip
run script
2024-01-10T00:33:45.395    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:33:45.397    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000426-102349-758_L1C_049-260-1_D_V1-0.zip
2024-01-10T00:33:45.397    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:33:45.397    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:33:45.397    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:33:45.397    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:33:45.397    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:33:45.397    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:33:45.397    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:33:45.397    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000426-102349-758_L1C_049-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/26/SPOT4-HRVIR1-XS_20000426-102400-481_L1C_051-261-5_D_V1-0/SPOT4-HRVIR1-XS_20000426-102400-481_L1C_051-261-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000426-102400-481_L1C_051-261-5_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000426-102400-481_L1C_051-261-5_D_V1-0.zip
run script
2024-01-10T00:34:37.562    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:34:37.564    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000426-102400-481_L1C_051-261-5_D_V1-0.zip
2024-01-10T00:34:37.564    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:34:37.564    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:34:37.564    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:34:37.564    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:34:37.564    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:34:37.564    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:34:37.564    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:34:37.564    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000426-102400-481_L1C_051-261-5_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/26/SPOT4-HRVIR1-XS_20000426-102404-235_L1C_051-262-0_D_V1-0/SPOT4-HRVIR1-XS_20000426-102404-235_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000426-102404-235_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000426-102404-235_L1C_051-262-0_D_V1-0.zip
run script
2024-01-10T00:36:31.389    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:36:31.390    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000426-102404-235_L1C_051-262-0_D_V1-0.zip
2024-01-10T00:36:31.390    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:36:31.390    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:36:31.391    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:36:31.391    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:36:31.391    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:36:31.391    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:36:31.391    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:36:31.391    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000426-102404-235_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/26/SPOT4-HRVIR1-XS_20000426-102412-510_L1C_051-263-0_D_V1-0/SPOT4-HRVIR1-XS_20000426-102412-510_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000426-102412-510_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000426-102412-510_L1C_051-263-0_D_V1-0.zip
run script
2024-01-10T00:38:13.077    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:38:13.078    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000426-102412-510_L1C_051-263-0_D_V1-0.zip
2024-01-10T00:38:13.078    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:38:13.078    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:38:13.078    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:38:13.078    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:38:13.078    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:38:13.078    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:38:13.078    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:38:13.078    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000426-102412-510_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/10/30/SPOT4-HRVIR1-XS_20001030-102647-864_L1C_049-254-0_D_V1-0/SPOT4-HRVIR1-XS_20001030-102647-864_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20001030-102647-864_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20001030-102647-864_L1C_049-254-0_D_V1-0.zip
run script
2024-01-10T00:38:56.726    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:38:56.727    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20001030-102647-864_L1C_049-254-0_D_V1-0.zip
2024-01-10T00:38:56.728    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:38:56.728    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:38:56.728    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:38:56.728    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:38:56.728    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:38:56.728    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:38:56.728    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:38:56.728    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20001030-102647-864_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/10/30/SPOT4-HRVIR1-XS_20001030-102656-067_L1C_049-255-0_D_V1-0/SPOT4-HRVIR1-XS_20001030-102656-067_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20001030-102656-067_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20001030-102656-067_L1C_049-255-0_D_V1-0.zip
run script
2024-01-10T00:39:00.103    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:39:00.104    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20001030-102656-067_L1C_049-255-0_D_V1-0.zip
2024-01-10T00:39:00.104    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:39:00.105    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:39:00.105    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:39:00.105    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:39:00.105    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:39:00.105    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:39:00.105    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:39:00.105    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20001030-102656-067_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/02/SPOT4-HRVIR1-XS_20000702-103450-071_L1C_049-255-9_D_V1-0/SPOT4-HRVIR1-XS_20000702-103450-071_L1C_049-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000702-103450-071_L1C_049-255-9_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000702-103450-071_L1C_049-255-9_D_V1-0.zip
run script
2024-01-10T00:39:57.095    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:39:57.096    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000702-103450-071_L1C_049-255-9_D_V1-0.zip
2024-01-10T00:39:57.096    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:39:57.096    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:39:57.097    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:39:57.097    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:39:57.097    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:39:57.097    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:39:57.097    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:39:57.097    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T00:41:40.688    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (204 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000702-103450-071_L1C_049-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/07/02/SPOT4-HRVIR1-XS_20000702-103452-896_L1C_049-256-3_D_V1-0/SPOT4-HRVIR1-XS_20000702-103452-896_L1C_049-256-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000702-103452-896_L1C_049-256-3_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000702-103452-896_L1C_049-256-3_D_V1-0.zip
run script
2024-01-10T00:41:44.458    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:41:44.459    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000702-103452-896_L1C_049-256-3_D_V1-0.zip
2024-01-10T00:41:44.460    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:41:44.460    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:41:44.460    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:41:44.460    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:41:44.460    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:41:44.460    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:41:44.460    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:41:44.460    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000702-103452-896_L1C_049-256-3_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/02/SPOT4-HRVIR2-XS_20000702-103539-525_L1C_050-262-1_D_V1-0/SPOT4-HRVIR2-XS_20000702-103539-525_L1C_050-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000702-103539-525_L1C_050-262-1_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000702-103539-525_L1C_050-262-1_D_V1-0.zip
run script
2024-01-10T00:43:20.414    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:43:20.415    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000702-103539-525_L1C_050-262-1_D_V1-0.zip
2024-01-10T00:43:20.415    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:43:20.415    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:43:20.416    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:43:20.416    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:43:20.416    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:43:20.416    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:43:20.416    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:43:20.416    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000702-103539-525_L1C_050-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/02/SPOT4-HRVIR2-XS_20000702-103543-135_L1C_050-262-5_D_V1-0/SPOT4-HRVIR2-XS_20000702-103543-135_L1C_050-262-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000702-103543-135_L1C_050-262-5_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000702-103543-135_L1C_050-262-5_D_V1-0.zip
run script
2024-01-10T00:44:18.659    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:44:18.660    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000702-103543-135_L1C_050-262-5_D_V1-0.zip
2024-01-10T00:44:18.660    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:44:18.660    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:44:18.660    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:44:18.660    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:44:18.660    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:44:18.660    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:44:18.660    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:44:18.660    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000702-103543-135_L1C_050-262-5_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/10/25/SPOT4-HRVIR1-XS_20001025-102301-112_L1C_049-255-0_D_V1-0/SPOT4-HRVIR1-XS_20001025-102301-112_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20001025-102301-112_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20001025-102301-112_L1C_049-255-0_D_V1-0.zip
run script
2024-01-10T00:44:52.405    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:44:52.406    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20001025-102301-112_L1C_049-255-0_D_V1-0.zip
2024-01-10T00:44:52.406    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:44:52.406    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:44:52.406    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:44:52.406    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:44:52.406    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:44:52.406    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:44:52.406    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:44:52.406    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20001025-102301-112_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/01/13/SPOT4-HRVIR1-XS_20000113-102252-508_L1C_049-256-0_D_V1-0/SPOT4-HRVIR1-XS_20000113-102252-508_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000113-102252-508_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000113-102252-508_L1C_049-256-0_D_V1-0.zip
run script
2024-01-10T00:45:47.833    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:45:47.834    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000113-102252-508_L1C_049-256-0_D_V1-0.zip
2024-01-10T00:45:47.834    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:45:47.834    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:45:47.834    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:45:47.834    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:45:47.834    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:45:47.835    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:45:47.835    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:45:47.835    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000113-102252-508_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/01/13/SPOT4-HRVIR2-XS_20000113-102235-143_L1C_050-254-0_D_V1-0/SPOT4-HRVIR2-XS_20000113-102235-143_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000113-102235-143_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000113-102235-143_L1C_050-254-0_D_V1-0.zip
run script
2024-01-10T00:48:13.860    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:48:13.861    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000113-102235-143_L1C_050-254-0_D_V1-0.zip
2024-01-10T00:48:13.861    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:48:13.861    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:48:13.861    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:48:13.861    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:48:13.861    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:48:13.861    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:48:13.861    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:48:13.861    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000113-102235-143_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/01/13/SPOT4-HRVIR2-XS_20000113-102243-340_L1C_050-255-0_D_V1-0/SPOT4-HRVIR2-XS_20000113-102243-340_L1C_050-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000113-102243-340_L1C_050-255-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000113-102243-340_L1C_050-255-0_D_V1-0.zip
run script
2024-01-10T00:48:17.513    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:48:17.514    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000113-102243-340_L1C_050-255-0_D_V1-0.zip
2024-01-10T00:48:17.514    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:48:17.514    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:48:17.514    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:48:17.514    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:48:17.514    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:48:17.514    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:48:17.514    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:48:17.514    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000113-102243-340_L1C_050-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/01/13/SPOT4-HRVIR2-XS_20000113-102251-548_L1C_050-256-0_D_V1-0/SPOT4-HRVIR2-XS_20000113-102251-548_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000113-102251-548_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000113-102251-548_L1C_050-256-0_D_V1-0.zip
run script
2024-01-10T00:49:24.113    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:49:24.114    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000113-102251-548_L1C_050-256-0_D_V1-0.zip
2024-01-10T00:49:24.114    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:49:24.114    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:49:24.114    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:49:24.114    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:49:24.114    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:49:24.115    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:49:24.115    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:49:24.115    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000113-102251-548_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/01/13/SPOT4-HRVIR2-XS_20000113-102252-451_L1C_050-256-1_D_V1-0/SPOT4-HRVIR2-XS_20000113-102252-451_L1C_050-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000113-102252-451_L1C_050-256-1_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000113-102252-451_L1C_050-256-1_D_V1-0.zip
run script
2024-01-10T00:52:55.076    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:52:55.077    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000113-102252-451_L1C_050-256-1_D_V1-0.zip
2024-01-10T00:52:55.077    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:52:55.077    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:52:55.077    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:52:55.078    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:52:55.078    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:52:55.078    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:52:55.078    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:52:55.078    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000113-102252-451_L1C_050-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/15/SPOT4-HRVIR2-XS_20000515-105801-098_L1C_049-256-2_D_V1-0/SPOT4-HRVIR2-XS_20000515-105801-098_L1C_049-256-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000515-105801-098_L1C_049-256-2_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000515-105801-098_L1C_049-256-2_D_V1-0.zip
run script
2024-01-10T00:56:38.455    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:56:38.455    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000515-105801-098_L1C_049-256-2_D_V1-0.zip
2024-01-10T00:56:38.455    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:56:38.455    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:56:38.456    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:56:38.456    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:56:38.456    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:56:38.456    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:56:38.456    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:56:38.456    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000515-105801-098_L1C_049-256-2_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/15/SPOT4-HRVIR2-XS_20000515-105807-701_L1C_049-257-0_D_V1-0/SPOT4-HRVIR2-XS_20000515-105807-701_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000515-105807-701_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000515-105807-701_L1C_049-257-0_D_V1-0.zip
run script
2024-01-10T00:59:56.298    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:59:56.299    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000515-105807-701_L1C_049-257-0_D_V1-0.zip
2024-01-10T00:59:56.299    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:59:56.299    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:59:56.299    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:59:56.299    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:59:56.299    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:59:56.299    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:59:56.299    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:59:56.299    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000515-105807-701_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/15/SPOT4-HRVIR2-XS_20000515-105809-505_L1C_049-257-2_D_V1-0/SPOT4-HRVIR2-XS_20000515-105809-505_L1C_049-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000515-105809-505_L1C_049-257-2_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000515-105809-505_L1C_049-257-2_D_V1-0.zip
run script
2024-01-10T01:02:37.559    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:02:37.561    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000515-105809-505_L1C_049-257-2_D_V1-0.zip
2024-01-10T01:02:37.561    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:02:37.561    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:02:37.561    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:02:37.561    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:02:37.561    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:02:37.561    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:02:37.561    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:02:37.561    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000515-105809-505_L1C_049-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/15/SPOT4-HRVIR1-XS_20000515-105834-290_L1C_051-260-5_D_V1-0/SPOT4-HRVIR1-XS_20000515-105834-290_L1C_051-260-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000515-105834-290_L1C_051-260-5_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000515-105834-290_L1C_051-260-5_D_V1-0.zip
run script
2024-01-10T01:05:12.025    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:05:12.026    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000515-105834-290_L1C_051-260-5_D_V1-0.zip
2024-01-10T01:05:12.026    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:05:12.026    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:05:12.026    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:05:12.026    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:05:12.026    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:05:12.026    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:05:12.027    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:05:12.027    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000515-105834-290_L1C_051-260-5_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/15/SPOT4-HRVIR1-XS_20000515-105838-240_L1C_051-261-0_D_V1-0/SPOT4-HRVIR1-XS_20000515-105838-240_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000515-105838-240_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000515-105838-240_L1C_051-261-0_D_V1-0.zip
run script
2024-01-10T01:09:06.999    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:09:07.001    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000515-105838-240_L1C_051-261-0_D_V1-0.zip
2024-01-10T01:09:07.001    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:09:07.001    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:09:07.001    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:09:07.001    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:09:07.001    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:09:07.001    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:09:07.001    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:09:07.001    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000515-105838-240_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/15/SPOT4-HRVIR1-XS_20000515-105846-704_L1C_051-262-0_D_V1-0/SPOT4-HRVIR1-XS_20000515-105846-704_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000515-105846-704_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000515-105846-704_L1C_051-262-0_D_V1-0.zip
run script
2024-01-10T01:12:47.975    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:12:47.976    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000515-105846-704_L1C_051-262-0_D_V1-0.zip
2024-01-10T01:12:47.976    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:12:47.976    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:12:47.977    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:12:47.977    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:12:47.977    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:12:47.977    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:12:47.977    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:12:47.977    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000515-105846-704_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/15/SPOT4-HRVIR1-XS_20000515-105849-412_L1C_051-262-3_D_V1-0/SPOT4-HRVIR1-XS_20000515-105849-412_L1C_051-262-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000515-105849-412_L1C_051-262-3_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000515-105849-412_L1C_051-262-3_D_V1-0.zip
run script
2024-01-10T01:15:16.675    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:15:16.677    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000515-105849-412_L1C_051-262-3_D_V1-0.zip
2024-01-10T01:15:16.677    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:15:16.677    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:15:16.677    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:15:16.677    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:15:16.677    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:15:16.677    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:15:16.677    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:15:16.677    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000515-105849-412_L1C_051-262-3_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/15/SPOT4-HRVIR1-XS_20000515-105819-560_L1C_052-258-9_D_V1-0/SPOT4-HRVIR1-XS_20000515-105819-560_L1C_052-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000515-105819-560_L1C_052-258-9_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000515-105819-560_L1C_052-258-9_D_V1-0.zip
run script
2024-01-10T01:17:19.671    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:17:19.673    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000515-105819-560_L1C_052-258-9_D_V1-0.zip
2024-01-10T01:17:19.673    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:17:19.673    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:17:19.673    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:17:19.673    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:17:19.673    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:17:19.673    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:17:19.673    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:17:19.674    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000515-105819-560_L1C_052-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 0 ... 0 1 0]
 [1 1 0 ... 0 0 0]
 [1 1 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/16/SPOT4-HRVIR1-XS_20000516-103846-977_L1C_049-256-6_D_V1-0/SPOT4-HRVIR1-XS_20000516-103846-977_L1C_049-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000516-103846-977_L1C_049-256-6_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000516-103846-977_L1C_049-256-6_D_V1-0.zip
run script
2024-01-10T01:22:01.075    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:22:01.076    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000516-103846-977_L1C_049-256-6_D_V1-0.zip
2024-01-10T01:22:01.077    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:22:01.077    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:22:01.077    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:22:01.077    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:22:01.077    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:22:01.077    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:22:01.077    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:22:01.077    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000516-103846-977_L1C_049-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/16/SPOT4-HRVIR1-XS_20000516-103849-838_L1C_049-257-0_D_V1-0/SPOT4-HRVIR1-XS_20000516-103849-838_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000516-103849-838_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000516-103849-838_L1C_049-257-0_D_V1-0.zip
run script
2024-01-10T01:24:04.245    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:24:04.245    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000516-103849-838_L1C_049-257-0_D_V1-0.zip
2024-01-10T01:24:04.245    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:24:04.245    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:24:04.245    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:24:04.245    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:24:04.245    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:24:04.245    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:24:04.245    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:24:04.246    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T01:25:58.811    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (77 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000516-103849-838_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/05/16/SPOT4-HRVIR1-XS_20000516-103850-740_L1C_049-257-1_D_V1-0/SPOT4-HRVIR1-XS_20000516-103850-740_L1C_049-257-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000516-103850-740_L1C_049-257-1_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000516-103850-740_L1C_049-257-1_D_V1-0.zip
run script
2024-01-10T01:26:02.311    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:26:02.312    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000516-103850-740_L1C_049-257-1_D_V1-0.zip
2024-01-10T01:26:02.312    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:26:02.312    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:26:02.312    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:26:02.312    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:26:02.312    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:26:02.313    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:26:02.313    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:26:02.313    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T01:27:57.483    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (786 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000516-103850-740_L1C_049-257-1_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/05/16/SPOT4-HRVIR1-XS_20000516-103906-409_L1C_049-259-0_D_V1-0/SPOT4-HRVIR1-XS_20000516-103906-409_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000516-103906-409_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000516-103906-409_L1C_049-259-0_D_V1-0.zip
run script
2024-01-10T01:28:00.879    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:28:00.880    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000516-103906-409_L1C_049-259-0_D_V1-0.zip
2024-01-10T01:28:00.880    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:28:00.880    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:28:00.880    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:28:00.880    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:28:00.880    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:28:00.880    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:28:00.881    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:28:00.881    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000516-103906-409_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/16/SPOT4-HRVIR1-XS_20000516-103914-708_L1C_049-260-0_D_V1-0/SPOT4-HRVIR1-XS_20000516-103914-708_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000516-103914-708_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000516-103914-708_L1C_049-260-0_D_V1-0.zip
run script
2024-01-10T01:29:18.074    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:29:18.075    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000516-103914-708_L1C_049-260-0_D_V1-0.zip
2024-01-10T01:29:18.075    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:29:18.075    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:29:18.075    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:29:18.075    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:29:18.076    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:29:18.076    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:29:18.076    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:29:18.076    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000516-103914-708_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/16/SPOT4-HRVIR1-XS_20000516-103916-512_L1C_049-260-2_D_V1-0/SPOT4-HRVIR1-XS_20000516-103916-512_L1C_049-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000516-103916-512_L1C_049-260-2_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000516-103916-512_L1C_049-260-2_D_V1-0.zip
run script
2024-01-10T01:30:01.360    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:30:01.361    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000516-103916-512_L1C_049-260-2_D_V1-0.zip
2024-01-10T01:30:01.361    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:30:01.361    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:30:01.361    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:30:01.361    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:30:01.361    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:30:01.361    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:30:01.362    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:30:01.362    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T01:30:04.014    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 75). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000516-103916-512_L1C_049-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/06/22/SPOT4-HRVIR2-XS_20000622-102715-651_L1C_049-256-3_D_V1-0/SPOT4-HRVIR2-XS_20000622-102715-651_L1C_049-256-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000622-102715-651_L1C_049-256-3_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000622-102715-651_L1C_049-256-3_D_V1-0.zip
run script
2024-01-10T01:30:07.136    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:30:07.137    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000622-102715-651_L1C_049-256-3_D_V1-0.zip
2024-01-10T01:30:07.137    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:30:07.137    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:30:07.137    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:30:07.137    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:30:07.137    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:30:07.137    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:30:07.137    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:30:07.138    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000622-102715-651_L1C_049-256-3_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/22/SPOT4-HRVIR2-XS_20000622-102730-748_L1C_052-258-5_D_V1-0/SPOT4-HRVIR2-XS_20000622-102730-748_L1C_052-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000622-102730-748_L1C_052-258-5_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000622-102730-748_L1C_052-258-5_D_V1-0.zip
run script
2024-01-10T01:31:50.054    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:31:50.055    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000622-102730-748_L1C_052-258-5_D_V1-0.zip
2024-01-10T01:31:50.055    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:31:50.055    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:31:50.055    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:31:50.055    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:31:50.055    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:31:50.055    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:31:50.055    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:31:50.055    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000622-102730-748_L1C_052-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/22/SPOT4-HRVIR2-XS_20000622-102734-499_L1C_052-259-0_D_V1-0/SPOT4-HRVIR2-XS_20000622-102734-499_L1C_052-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000622-102734-499_L1C_052-259-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000622-102734-499_L1C_052-259-0_D_V1-0.zip
run script
2024-01-10T01:34:29.249    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:34:29.250    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000622-102734-499_L1C_052-259-0_D_V1-0.zip
2024-01-10T01:34:29.250    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:34:29.250    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:34:29.250    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:34:29.250    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:34:29.250    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:34:29.250    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:34:29.250    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:34:29.251    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000622-102734-499_L1C_052-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/22/SPOT4-HRVIR2-XS_20000622-102741-719_L1C_052-259-8_D_V1-0/SPOT4-HRVIR2-XS_20000622-102741-719_L1C_052-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000622-102741-719_L1C_052-259-8_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000622-102741-719_L1C_052-259-8_D_V1-0.zip
run script
2024-01-10T01:37:18.269    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:37:18.270    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000622-102741-719_L1C_052-259-8_D_V1-0.zip
2024-01-10T01:37:18.279    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:37:18.279    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:37:18.279    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:37:18.279    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:37:18.279    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:37:18.279    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:37:18.279    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:37:18.279    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T01:38:17.270    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 434). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000622-102741-719_L1C_052-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/07/18/SPOT4-HRVIR2-XS_20000718-102713-013_L1C_049-256-1_D_V1-0/SPOT4-HRVIR2-XS_20000718-102713-013_L1C_049-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000718-102713-013_L1C_049-256-1_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000718-102713-013_L1C_049-256-1_D_V1-0.zip
run script
2024-01-10T01:38:20.663    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:38:20.664    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000718-102713-013_L1C_049-256-1_D_V1-0.zip
2024-01-10T01:38:20.664    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:38:20.665    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:38:20.665    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:38:20.665    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:38:20.665    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:38:20.665    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:38:20.665    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:38:20.665    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000718-102713-013_L1C_049-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/18/SPOT4-HRVIR2-XS_20000718-102714-818_L1C_049-256-3_D_V1-0/SPOT4-HRVIR2-XS_20000718-102714-818_L1C_049-256-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000718-102714-818_L1C_049-256-3_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000718-102714-818_L1C_049-256-3_D_V1-0.zip
run script
2024-01-10T01:40:07.492    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:40:07.493    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000718-102714-818_L1C_049-256-3_D_V1-0.zip
2024-01-10T01:40:07.493    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:40:07.493    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:40:07.493    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:40:07.493    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:40:07.493    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:40:07.493    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:40:07.493    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:40:07.494    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000718-102714-818_L1C_049-256-3_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/18/SPOT4-HRVIR2-XS_20000718-102754-991_L1C_049-261-1_D_V1-0/SPOT4-HRVIR2-XS_20000718-102754-991_L1C_049-261-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000718-102754-991_L1C_049-261-1_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000718-102754-991_L1C_049-261-1_D_V1-0.zip
run script
2024-01-10T01:41:51.763    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:41:51.765    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000718-102754-991_L1C_049-261-1_D_V1-0.zip
2024-01-10T01:41:51.765    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:41:51.765    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:41:51.765    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:41:51.765    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:41:51.765    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:41:51.765    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:41:51.765    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:41:51.765    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000718-102754-991_L1C_049-261-1_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/18/SPOT4-HRVIR2-XS_20000718-102759-503_L1C_049-261-6_D_V1-0/SPOT4-HRVIR2-XS_20000718-102759-503_L1C_049-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000718-102759-503_L1C_049-261-6_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000718-102759-503_L1C_049-261-6_D_V1-0.zip
run script
2024-01-10T01:41:55.422    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:41:55.423    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000718-102759-503_L1C_049-261-6_D_V1-0.zip
2024-01-10T01:41:55.423    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:41:55.423    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:41:55.423    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:41:55.423    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:41:55.423    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:41:55.423    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:41:55.424    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:41:55.424    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000718-102759-503_L1C_049-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/18/SPOT4-HRVIR1-XS_20000718-102727-669_L1C_050-258-0_D_V1-0/SPOT4-HRVIR1-XS_20000718-102727-669_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000718-102727-669_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000718-102727-669_L1C_050-258-0_D_V1-0.zip
run script
2024-01-10T01:41:58.800    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:41:58.800    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000718-102727-669_L1C_050-258-0_D_V1-0.zip
2024-01-10T01:41:58.800    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:41:58.800    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:41:58.800    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:41:58.800    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:41:58.800    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:41:58.800    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:41:58.800    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:41:58.801    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T01:43:52.185    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 480). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000718-102727-669_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/07/18/SPOT4-HRVIR1-XS_20000718-102735-917_L1C_050-259-0_D_V1-0/SPOT4-HRVIR1-XS_20000718-102735-917_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000718-102735-917_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000718-102735-917_L1C_050-259-0_D_V1-0.zip
run script
2024-01-10T01:43:56.548    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:43:56.549    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000718-102735-917_L1C_050-259-0_D_V1-0.zip
2024-01-10T01:43:56.549    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:43:56.549    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:43:56.549    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:43:56.549    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:43:56.549    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:43:56.550    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:43:56.550    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:43:56.550    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T01:46:02.753    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (186 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000718-102735-917_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/07/18/SPOT4-HRVIR1-XS_20000718-102744-174_L1C_050-260-0_D_V1-0/SPOT4-HRVIR1-XS_20000718-102744-174_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000718-102744-174_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000718-102744-174_L1C_050-260-0_D_V1-0.zip
run script
2024-01-10T01:46:06.118    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:46:06.119    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000718-102744-174_L1C_050-260-0_D_V1-0.zip
2024-01-10T01:46:06.120    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:46:06.120    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:46:06.120    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:46:06.120    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:46:06.120    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:46:06.120    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:46:06.120    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:46:06.120    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000718-102744-174_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/18/SPOT4-HRVIR1-XS_20000718-102653-959_L1C_051-254-0_D_V1-0/SPOT4-HRVIR1-XS_20000718-102653-959_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000718-102653-959_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000718-102653-959_L1C_051-254-0_D_V1-0.zip
run script
2024-01-10T01:47:40.409    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:47:40.410    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000718-102653-959_L1C_051-254-0_D_V1-0.zip
2024-01-10T01:47:40.411    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:47:40.411    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:47:40.411    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:47:40.411    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:47:40.411    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:47:40.411    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:47:40.411    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:47:40.411    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000718-102653-959_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/10/09/SPOT4-HRVIR1-XS_20001009-103102-045_L1C_049-256-7_D_V1-0/SPOT4-HRVIR1-XS_20001009-103102-045_L1C_049-256-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20001009-103102-045_L1C_049-256-7_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20001009-103102-045_L1C_049-256-7_D_V1-0.zip
run script
2024-01-10T01:47:43.722    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:47:43.724    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20001009-103102-045_L1C_049-256-7_D_V1-0.zip
2024-01-10T01:47:43.724    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:47:43.724    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:47:43.724    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:47:43.724    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:47:43.724    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:47:43.724    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:47:43.724    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:47:43.724    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20001009-103102-045_L1C_049-256-7_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/10/09/SPOT4-HRVIR2-XS_20001009-103059-728_L1C_051-256-7_D_V1-0/SPOT4-HRVIR2-XS_20001009-103059-728_L1C_051-256-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001009-103059-728_L1C_051-256-7_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001009-103059-728_L1C_051-256-7_D_V1-0.zip
run script
2024-01-10T01:49:18.659    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:49:18.660    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001009-103059-728_L1C_051-256-7_D_V1-0.zip
2024-01-10T01:49:18.660    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:49:18.660    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:49:18.660    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:49:18.660    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:49:18.661    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:49:18.661    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:49:18.661    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:49:18.661    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001009-103059-728_L1C_051-256-7_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/10/09/SPOT4-HRVIR2-XS_20001009-103101-662_L1C_051-257-0_D_V1-0/SPOT4-HRVIR2-XS_20001009-103101-662_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001009-103101-662_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001009-103101-662_L1C_051-257-0_D_V1-0.zip
run script
2024-01-10T01:52:35.741    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:52:35.742    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001009-103101-662_L1C_051-257-0_D_V1-0.zip
2024-01-10T01:52:35.742    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:52:35.742    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:52:35.742    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:52:35.742    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:52:35.743    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:52:35.743    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:52:35.743    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:52:35.743    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001009-103101-662_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/10/09/SPOT4-HRVIR2-XS_20001009-103106-174_L1C_051-257-5_D_V1-0/SPOT4-HRVIR2-XS_20001009-103106-174_L1C_051-257-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001009-103106-174_L1C_051-257-5_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001009-103106-174_L1C_051-257-5_D_V1-0.zip
run script
2024-01-10T01:55:46.499    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:55:46.501    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001009-103106-174_L1C_051-257-5_D_V1-0.zip
2024-01-10T01:55:46.501    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:55:46.501    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:55:46.501    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:55:46.501    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:55:46.501    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:55:46.501    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:55:46.501    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:55:46.501    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001009-103106-174_L1C_051-257-5_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/10/09/SPOT4-HRVIR1-XS_20001009-103117-125_L1C_052-258-9_D_V1-0/SPOT4-HRVIR1-XS_20001009-103117-125_L1C_052-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20001009-103117-125_L1C_052-258-9_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20001009-103117-125_L1C_052-258-9_D_V1-0.zip
run script
2024-01-10T01:58:51.375    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:58:51.376    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20001009-103117-125_L1C_052-258-9_D_V1-0.zip
2024-01-10T01:58:51.376    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:58:51.377    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:58:51.377    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:58:51.377    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:58:51.377    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:58:51.377    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:58:51.377    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:58:51.377    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20001009-103117-125_L1C_052-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 0 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/10/09/SPOT4-HRVIR1-XS_20001009-103124-501_L1C_052-259-8_D_V1-0/SPOT4-HRVIR1-XS_20001009-103124-501_L1C_052-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20001009-103124-501_L1C_052-259-8_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20001009-103124-501_L1C_052-259-8_D_V1-0.zip
run script
2024-01-10T02:01:47.807    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:01:47.808    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20001009-103124-501_L1C_052-259-8_D_V1-0.zip
2024-01-10T02:01:47.808    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:01:47.808    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:01:47.808    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:01:47.808    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:01:47.808    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:01:47.808    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:01:47.808    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:01:47.808    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T02:02:58.182    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 514). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20001009-103124-501_L1C_052-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/10/14/SPOT4-HRVIR2-XS_20001014-103444-331_L1C_049-256-1_D_V1-0/SPOT4-HRVIR2-XS_20001014-103444-331_L1C_049-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001014-103444-331_L1C_049-256-1_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001014-103444-331_L1C_049-256-1_D_V1-0.zip
run script
2024-01-10T02:03:01.417    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:03:01.419    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001014-103444-331_L1C_049-256-1_D_V1-0.zip
2024-01-10T02:03:01.419    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:03:01.419    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:03:01.419    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:03:01.419    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:03:01.419    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:03:01.419    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:03:01.419    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:03:01.419    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001014-103444-331_L1C_049-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/10/14/SPOT4-HRVIR2-XS_20001014-103446-136_L1C_049-256-3_D_V1-0/SPOT4-HRVIR2-XS_20001014-103446-136_L1C_049-256-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001014-103446-136_L1C_049-256-3_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001014-103446-136_L1C_049-256-3_D_V1-0.zip
run script
2024-01-10T02:04:36.569    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:04:36.571    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001014-103446-136_L1C_049-256-3_D_V1-0.zip
2024-01-10T02:04:36.571    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:04:36.571    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:04:36.571    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:04:36.571    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:04:36.571    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:04:36.571    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:04:36.571    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:04:36.571    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T02:06:02.967    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (414 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20001014-103446-136_L1C_049-256-3_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/10/14/SPOT4-HRVIR1-XS_20001014-103511-773_L1C_052-259-8_D_V1-0/SPOT4-HRVIR1-XS_20001014-103511-773_L1C_052-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20001014-103511-773_L1C_052-259-8_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20001014-103511-773_L1C_052-259-8_D_V1-0.zip
run script
2024-01-10T02:06:05.924    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:06:05.925    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20001014-103511-773_L1C_052-259-8_D_V1-0.zip
2024-01-10T02:06:05.925    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:06:05.925    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:06:05.925    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:06:05.925    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:06:05.925    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:06:05.925    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:06:05.925    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:06:05.925    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20001014-103511-773_L1C_052-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/04/SPOT4-HRVIR1-XS_20000404-104631-729_L1C_049-257-1_D_V1-0/SPOT4-HRVIR1-XS_20000404-104631-729_L1C_049-257-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000404-104631-729_L1C_049-257-1_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000404-104631-729_L1C_049-257-1_D_V1-0.zip
run script
2024-01-10T02:08:41.903    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:08:41.904    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000404-104631-729_L1C_049-257-1_D_V1-0.zip
2024-01-10T02:08:41.904    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:08:41.904    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:08:41.904    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:08:41.904    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:08:41.904    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:08:41.904    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:08:41.904    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:08:41.904    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T02:10:27.151    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (186 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000404-104631-729_L1C_049-257-1_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/07/11/SPOT4-HRVIR2-XS_20000711-110202-209_L1C_049-257-0_D_V1-0/SPOT4-HRVIR2-XS_20000711-110202-209_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000711-110202-209_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000711-110202-209_L1C_049-257-0_D_V1-0.zip
run script
2024-01-10T02:10:30.174    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:10:30.174    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000711-110202-209_L1C_049-257-0_D_V1-0.zip
2024-01-10T02:10:30.174    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:10:30.174    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:10:30.174    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:10:30.174    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:10:30.174    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:10:30.174    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:10:30.174    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:10:30.174    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000711-110202-209_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/11/SPOT4-HRVIR2-XS_20000711-110226-169_L1C_050-260-0_D_V1-0/SPOT4-HRVIR2-XS_20000711-110226-169_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000711-110226-169_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000711-110226-169_L1C_050-260-0_D_V1-0.zip
run script
2024-01-10T02:13:10.031    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:13:10.032    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000711-110226-169_L1C_050-260-0_D_V1-0.zip
2024-01-10T02:13:10.032    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:13:10.032    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:13:10.032    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:13:10.032    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:13:10.032    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:13:10.032    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:13:10.032    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:13:10.032    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000711-110226-169_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/16/SPOT4-HRVIR1-XS_20000716-110603-017_L1C_049-257-8_D_V1-0/SPOT4-HRVIR1-XS_20000716-110603-017_L1C_049-257-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000716-110603-017_L1C_049-257-8_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000716-110603-017_L1C_049-257-8_D_V1-0.zip
run script
2024-01-10T02:14:46.464    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:14:46.466    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000716-110603-017_L1C_049-257-8_D_V1-0.zip
2024-01-10T02:14:46.466    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:14:46.466    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:14:46.466    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:14:46.466    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:14:46.466    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:14:46.466    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:14:46.466    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:14:46.467    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000716-110603-017_L1C_049-257-8_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/16/SPOT4-HRVIR1-XS_20000716-110604-277_L1C_049-258-0_D_V1-0/SPOT4-HRVIR1-XS_20000716-110604-277_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000716-110604-277_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000716-110604-277_L1C_049-258-0_D_V1-0.zip
run script
2024-01-10T02:16:17.741    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:16:17.742    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000716-110604-277_L1C_049-258-0_D_V1-0.zip
2024-01-10T02:16:17.742    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:16:17.743    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:16:17.743    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:16:17.743    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:16:17.743    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:16:17.743    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:16:17.743    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:16:17.743    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T02:17:37.303    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 550). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000716-110604-277_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/07/16/SPOT4-HRVIR1-XS_20000716-110612-759_L1C_049-259-0_D_V1-0/SPOT4-HRVIR1-XS_20000716-110612-759_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000716-110612-759_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000716-110612-759_L1C_049-259-0_D_V1-0.zip
run script
2024-01-10T02:17:40.569    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:17:40.570    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000716-110612-759_L1C_049-259-0_D_V1-0.zip
2024-01-10T02:17:40.570    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:17:40.570    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:17:40.570    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:17:40.570    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:17:40.571    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:17:40.571    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:17:40.571    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:17:40.571    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000716-110612-759_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/16/SPOT4-HRVIR1-XS_20000716-110621-245_L1C_049-260-0_D_V1-0/SPOT4-HRVIR1-XS_20000716-110621-245_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000716-110621-245_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000716-110621-245_L1C_049-260-0_D_V1-0.zip
run script
2024-01-10T02:18:40.599    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:18:40.600    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000716-110621-245_L1C_049-260-0_D_V1-0.zip
2024-01-10T02:18:40.600    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:18:40.600    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:18:40.600    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:18:40.600    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:18:40.600    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:18:40.601    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:18:40.601    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:18:40.601    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000716-110621-245_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/22/SPOT4-HRVIR1-XS_20000722-105037-637_L1C_049-257-7_D_V1-0/SPOT4-HRVIR1-XS_20000722-105037-637_L1C_049-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000722-105037-637_L1C_049-257-7_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000722-105037-637_L1C_049-257-7_D_V1-0.zip
run script
2024-01-10T02:19:06.726    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:19:06.727    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000722-105037-637_L1C_049-257-7_D_V1-0.zip
2024-01-10T02:19:06.727    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:19:06.727    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:19:06.727    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:19:06.727    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:19:06.727    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:19:06.728    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:19:06.728    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:19:06.728    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000722-105037-637_L1C_049-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/22/SPOT4-HRVIR1-XS_20000722-105039-665_L1C_049-258-0_D_V1-0/SPOT4-HRVIR1-XS_20000722-105039-665_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000722-105039-665_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000722-105039-665_L1C_049-258-0_D_V1-0.zip
run script
2024-01-10T02:20:10.608    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:20:10.609    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000722-105039-665_L1C_049-258-0_D_V1-0.zip
2024-01-10T02:20:10.609    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:20:10.609    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:20:10.609    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:20:10.609    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:20:10.609    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:20:10.609    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:20:10.609    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:20:10.609    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000722-105039-665_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/22/SPOT4-HRVIR1-XS_20000722-105048-018_L1C_049-259-0_D_V1-0/SPOT4-HRVIR1-XS_20000722-105048-018_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000722-105048-018_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000722-105048-018_L1C_049-259-0_D_V1-0.zip
run script
2024-01-10T02:21:03.217    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:21:03.218    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000722-105048-018_L1C_049-259-0_D_V1-0.zip
2024-01-10T02:21:03.218    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:21:03.218    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:21:03.218    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:21:03.218    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:21:03.219    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:21:03.219    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:21:03.219    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:21:03.219    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000722-105048-018_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/22/SPOT4-HRVIR1-XS_20000722-105048-920_L1C_049-259-1_D_V1-0/SPOT4-HRVIR1-XS_20000722-105048-920_L1C_049-259-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000722-105048-920_L1C_049-259-1_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000722-105048-920_L1C_049-259-1_D_V1-0.zip
run script
2024-01-10T02:21:36.586    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:21:36.588    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000722-105048-920_L1C_049-259-1_D_V1-0.zip
2024-01-10T02:21:36.588    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:21:36.588    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:21:36.588    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:21:36.588    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:21:36.588    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:21:36.588    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:21:36.588    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:21:36.588    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000722-105048-920_L1C_049-259-1_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/22/SPOT4-HRVIR2-XS_20000722-105100-008_L1C_054-261-3_D_V1-0/SPOT4-HRVIR2-XS_20000722-105100-008_L1C_054-261-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000722-105100-008_L1C_054-261-3_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000722-105100-008_L1C_054-261-3_D_V1-0.zip
run script
2024-01-10T02:22:10.544    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:22:10.546    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000722-105100-008_L1C_054-261-3_D_V1-0.zip
2024-01-10T02:22:10.546    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:22:10.546    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:22:10.546    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:22:10.546    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:22:10.546    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:22:10.546    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:22:10.546    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:22:10.546    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000722-105100-008_L1C_054-261-3_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/22/SPOT4-HRVIR2-XS_20000722-105105-747_L1C_054-262-0_D_V1-0/SPOT4-HRVIR2-XS_20000722-105105-747_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000722-105105-747_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000722-105105-747_L1C_054-262-0_D_V1-0.zip
run script
2024-01-10T02:24:29.386    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:24:29.387    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000722-105105-747_L1C_054-262-0_D_V1-0.zip
2024-01-10T02:24:29.387    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:24:29.387    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:24:29.387    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:24:29.387    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:24:29.387    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:24:29.387    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:24:29.387    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:24:29.387    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000722-105105-747_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/03/SPOT4-HRVIR2-XS_20000903-102325-068_L1C_049-257-0_D_V1-0/SPOT4-HRVIR2-XS_20000903-102325-068_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000903-102325-068_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000903-102325-068_L1C_049-257-0_D_V1-0.zip
run script
2024-01-10T02:27:02.681    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:27:02.682    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000903-102325-068_L1C_049-257-0_D_V1-0.zip
2024-01-10T02:27:02.682    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:27:02.682    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:27:02.682    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:27:02.683    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:27:02.683    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:27:02.683    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:27:02.683    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:27:02.683    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000903-102325-068_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/30/SPOT4-HRVIR1-XS_20000430-104651-299_L1C_049-258-7_D_V1-0/SPOT4-HRVIR1-XS_20000430-104651-299_L1C_049-258-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000430-104651-299_L1C_049-258-7_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000430-104651-299_L1C_049-258-7_D_V1-0.zip
run script
2024-01-10T02:29:13.161    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:29:13.162    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000430-104651-299_L1C_049-258-7_D_V1-0.zip
2024-01-10T02:29:13.162    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:29:13.162    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:29:13.162    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:29:13.162    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:29:13.162    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:29:13.162    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:29:13.162    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:29:13.162    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000430-104651-299_L1C_049-258-7_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/30/SPOT4-HRVIR1-XS_20000430-104653-318_L1C_049-259-0_D_V1-0/SPOT4-HRVIR1-XS_20000430-104653-318_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000430-104653-318_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000430-104653-318_L1C_049-259-0_D_V1-0.zip
run script
2024-01-10T02:30:22.717    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:30:22.718    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000430-104653-318_L1C_049-259-0_D_V1-0.zip
2024-01-10T02:30:22.718    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:30:22.718    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:30:22.718    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:30:22.718    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:30:22.718    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:30:22.718    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:30:22.718    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:30:22.718    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000430-104653-318_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/30/SPOT4-HRVIR1-XS_20000430-104701-659_L1C_049-260-0_D_V1-0/SPOT4-HRVIR1-XS_20000430-104701-659_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000430-104701-659_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000430-104701-659_L1C_049-260-0_D_V1-0.zip
run script
2024-01-10T02:31:27.813    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:31:27.815    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000430-104701-659_L1C_049-260-0_D_V1-0.zip
2024-01-10T02:31:27.815    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:31:27.815    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:31:27.815    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:31:27.815    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:31:27.815    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:31:27.815    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:31:27.815    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:31:27.815    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000430-104701-659_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/30/SPOT4-HRVIR1-XS_20000430-104703-464_L1C_049-260-2_D_V1-0/SPOT4-HRVIR1-XS_20000430-104703-464_L1C_049-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000430-104703-464_L1C_049-260-2_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000430-104703-464_L1C_049-260-2_D_V1-0.zip
run script
2024-01-10T02:32:09.056    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:32:09.057    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000430-104703-464_L1C_049-260-2_D_V1-0.zip
2024-01-10T02:32:09.057    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:32:09.057    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:32:09.057    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:32:09.057    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:32:09.057    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:32:09.057    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:32:09.057    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:32:09.057    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T02:32:10.922    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 63). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000430-104703-464_L1C_049-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/06/05/SPOT4-HRVIR2-XS_20000605-105438-293_L1C_049-258-5_D_V1-0/SPOT4-HRVIR2-XS_20000605-105438-293_L1C_049-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000605-105438-293_L1C_049-258-5_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000605-105438-293_L1C_049-258-5_D_V1-0.zip
run script
2024-01-10T02:32:13.983    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:32:13.985    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000605-105438-293_L1C_049-258-5_D_V1-0.zip
2024-01-10T02:32:13.985    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:32:13.985    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:32:13.985    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:32:13.985    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:32:13.985    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:32:13.985    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:32:13.985    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:32:13.985    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000605-105438-293_L1C_049-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/05/SPOT4-HRVIR2-XS_20000605-105442-171_L1C_049-259-0_D_V1-0/SPOT4-HRVIR2-XS_20000605-105442-171_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000605-105442-171_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000605-105442-171_L1C_049-259-0_D_V1-0.zip
run script
2024-01-10T02:33:41.650    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:33:41.651    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000605-105442-171_L1C_049-259-0_D_V1-0.zip
2024-01-10T02:33:41.652    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:33:41.652    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:33:41.652    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:33:41.652    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:33:41.652    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:33:41.652    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:33:41.652    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:33:41.652    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000605-105442-171_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/05/SPOT4-HRVIR2-XS_20000605-105450-566_L1C_049-260-0_D_V1-0/SPOT4-HRVIR2-XS_20000605-105450-566_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000605-105450-566_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000605-105450-566_L1C_049-260-0_D_V1-0.zip
run script
2024-01-10T02:34:58.123    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:34:58.124    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000605-105450-566_L1C_049-260-0_D_V1-0.zip
2024-01-10T02:34:58.124    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:34:58.124    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:34:58.124    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:34:58.124    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:34:58.124    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:34:58.124    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:34:58.124    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:34:58.125    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000605-105450-566_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/05/SPOT4-HRVIR2-XS_20000605-105452-371_L1C_049-260-2_D_V1-0/SPOT4-HRVIR2-XS_20000605-105452-371_L1C_049-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000605-105452-371_L1C_049-260-2_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000605-105452-371_L1C_049-260-2_D_V1-0.zip
run script
2024-01-10T02:35:45.190    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:35:45.191    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000605-105452-371_L1C_049-260-2_D_V1-0.zip
2024-01-10T02:35:45.191    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:35:45.191    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:35:45.191    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:35:45.191    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:35:45.191    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:35:45.192    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:35:45.192    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:35:45.192    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T02:35:47.104    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 254). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000605-105452-371_L1C_049-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/01/SPOT4-HRVIR2-XS_20000801-105820-743_L1C_049-258-5_D_V1-0/SPOT4-HRVIR2-XS_20000801-105820-743_L1C_049-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000801-105820-743_L1C_049-258-5_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000801-105820-743_L1C_049-258-5_D_V1-0.zip
run script
2024-01-10T02:35:50.250    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:35:50.250    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000801-105820-743_L1C_049-258-5_D_V1-0.zip
2024-01-10T02:35:50.250    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:35:50.250    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:35:50.250    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:35:50.250    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:35:50.250    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:35:50.250    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:35:50.251    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:35:50.251    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000801-105820-743_L1C_049-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/01/SPOT4-HRVIR2-XS_20000801-105824-647_L1C_049-259-0_D_V1-0/SPOT4-HRVIR2-XS_20000801-105824-647_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000801-105824-647_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000801-105824-647_L1C_049-259-0_D_V1-0.zip
run script
2024-01-10T02:37:19.334    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:37:19.335    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000801-105824-647_L1C_049-259-0_D_V1-0.zip
2024-01-10T02:37:19.335    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:37:19.335    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:37:19.335    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:37:19.336    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:37:19.336    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:37:19.336    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:37:19.336    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:37:19.336    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000801-105824-647_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/01/SPOT4-HRVIR2-XS_20000801-105833-072_L1C_049-260-0_D_V1-0/SPOT4-HRVIR2-XS_20000801-105833-072_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000801-105833-072_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000801-105833-072_L1C_049-260-0_D_V1-0.zip
run script
2024-01-10T02:38:31.970    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:38:31.972    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000801-105833-072_L1C_049-260-0_D_V1-0.zip
2024-01-10T02:38:31.972    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:38:31.972    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:38:31.972    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:38:31.972    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:38:31.972    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:38:31.972    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:38:31.972    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:38:31.972    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000801-105833-072_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/01/SPOT4-HRVIR2-XS_20000801-105834-877_L1C_049-260-2_D_V1-0/SPOT4-HRVIR2-XS_20000801-105834-877_L1C_049-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000801-105834-877_L1C_049-260-2_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000801-105834-877_L1C_049-260-2_D_V1-0.zip
run script
2024-01-10T02:39:16.433    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:39:16.434    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000801-105834-877_L1C_049-260-2_D_V1-0.zip
2024-01-10T02:39:16.434    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:39:16.434    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:39:16.434    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:39:16.434    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:39:16.435    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:39:16.435    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:39:16.435    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:39:16.435    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000801-105834-877_L1C_049-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/14/SPOT4-HRVIR1-XS_20000414-105426-037_L1C_049-259-0_D_V1-0/SPOT4-HRVIR1-XS_20000414-105426-037_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000414-105426-037_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000414-105426-037_L1C_049-259-0_D_V1-0.zip
run script
2024-01-10T02:39:58.277    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:39:58.279    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000414-105426-037_L1C_049-259-0_D_V1-0.zip
2024-01-10T02:39:58.279    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:39:58.279    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:39:58.279    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:39:58.279    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:39:58.279    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:39:58.279    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:39:58.279    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:39:58.279    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000414-105426-037_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/24/SPOT4-HRVIR2-XS_20000424-110224-734_L1C_049-260-0_D_V1-0/SPOT4-HRVIR2-XS_20000424-110224-734_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000424-110224-734_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000424-110224-734_L1C_049-260-0_D_V1-0.zip
run script
2024-01-10T02:41:09.973    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:41:09.974    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000424-110224-734_L1C_049-260-0_D_V1-0.zip
2024-01-10T02:41:09.975    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:41:09.975    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:41:09.975    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:41:09.975    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:41:09.975    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:41:09.975    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:41:09.975    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:41:09.975    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000424-110224-734_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/24/SPOT4-HRVIR2-XS_20000424-110226-539_L1C_049-260-2_D_V1-0/SPOT4-HRVIR2-XS_20000424-110226-539_L1C_049-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000424-110226-539_L1C_049-260-2_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000424-110226-539_L1C_049-260-2_D_V1-0.zip
run script
2024-01-10T02:42:10.488    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:42:10.489    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000424-110226-539_L1C_049-260-2_D_V1-0.zip
2024-01-10T02:42:10.490    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:42:10.490    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:42:10.490    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:42:10.490    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:42:10.490    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:42:10.490    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:42:10.490    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:42:10.490    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000424-110226-539_L1C_049-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/06/SPOT4-HRVIR2-XS_20000606-103533-981_L1C_049-260-1_D_V1-0/SPOT4-HRVIR2-XS_20000606-103533-981_L1C_049-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000606-103533-981_L1C_049-260-1_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000606-103533-981_L1C_049-260-1_D_V1-0.zip
run script
2024-01-10T02:43:11.864    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:43:11.865    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000606-103533-981_L1C_049-260-1_D_V1-0.zip
2024-01-10T02:43:11.866    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:43:11.866    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:43:11.866    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:43:11.866    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:43:11.866    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:43:11.866    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:43:11.866    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:43:11.866    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000606-103533-981_L1C_049-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/10/SPOT4-HRVIR2-XS_20000610-105844-288_L1C_049-260-2_D_V1-0/SPOT4-HRVIR2-XS_20000610-105844-288_L1C_049-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000610-105844-288_L1C_049-260-2_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000610-105844-288_L1C_049-260-2_D_V1-0.zip
run script
2024-01-10T02:43:49.778    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:43:49.780    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000610-105844-288_L1C_049-260-2_D_V1-0.zip
2024-01-10T02:43:49.780    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:43:49.780    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:43:49.780    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:43:49.780    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:43:49.780    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:43:49.780    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:43:49.780    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:43:49.780    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000610-105844-288_L1C_049-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/07/SPOT4-HRVIR2-XS_20000707-103925-067_L1C_049-260-9_D_V1-0/SPOT4-HRVIR2-XS_20000707-103925-067_L1C_049-260-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000707-103925-067_L1C_049-260-9_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000707-103925-067_L1C_049-260-9_D_V1-0.zip
run script
2024-01-10T02:44:41.681    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:44:41.682    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000707-103925-067_L1C_049-260-9_D_V1-0.zip
2024-01-10T02:44:41.682    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:44:41.682    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:44:41.682    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:44:41.682    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:44:41.683    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:44:41.683    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:44:41.683    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:44:41.683    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000707-103925-067_L1C_049-260-9_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/07/SPOT4-HRVIR2-XS_20000707-103930-659_L1C_049-261-6_D_V1-0/SPOT4-HRVIR2-XS_20000707-103930-659_L1C_049-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000707-103930-659_L1C_049-261-6_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000707-103930-659_L1C_049-261-6_D_V1-0.zip
run script
2024-01-10T02:44:44.981    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:44:44.982    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000707-103930-659_L1C_049-261-6_D_V1-0.zip
2024-01-10T02:44:44.982    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:44:44.983    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:44:44.983    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:44:44.983    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:44:44.983    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:44:44.983    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:44:44.983    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:44:44.983    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000707-103930-659_L1C_049-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/07/SPOT4-HRVIR1-XS_20000707-103908-523_L1C_052-259-5_D_V1-0/SPOT4-HRVIR1-XS_20000707-103908-523_L1C_052-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000707-103908-523_L1C_052-259-5_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000707-103908-523_L1C_052-259-5_D_V1-0.zip
run script
2024-01-10T02:44:47.983    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:44:47.984    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000707-103908-523_L1C_052-259-5_D_V1-0.zip
2024-01-10T02:44:47.984    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:44:47.984    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:44:47.984    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:44:47.985    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:44:47.985    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:44:47.985    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:44:47.985    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:44:47.985    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000707-103908-523_L1C_052-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/07/SPOT4-HRVIR1-XS_20000707-103912-340_L1C_052-260-0_D_V1-0/SPOT4-HRVIR1-XS_20000707-103912-340_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000707-103912-340_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000707-103912-340_L1C_052-260-0_D_V1-0.zip
run script
2024-01-10T02:47:41.253    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:47:41.254    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000707-103912-340_L1C_052-260-0_D_V1-0.zip
2024-01-10T02:47:41.254    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:47:41.254    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:47:41.254    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:47:41.254    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:47:41.254    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:47:41.254    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:47:41.254    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:47:41.254    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000707-103912-340_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/13/SPOT4-HRVIR1-XS_20000713-102401-237_L1C_049-261-1_D_V1-0/SPOT4-HRVIR1-XS_20000713-102401-237_L1C_049-261-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000713-102401-237_L1C_049-261-1_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000713-102401-237_L1C_049-261-1_D_V1-0.zip
run script
2024-01-10T02:50:14.129    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:50:14.130    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000713-102401-237_L1C_049-261-1_D_V1-0.zip
2024-01-10T02:50:14.130    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:50:14.130    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:50:14.130    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:50:14.130    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:50:14.130    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:50:14.130    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:50:14.130    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:50:14.130    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000713-102401-237_L1C_049-261-1_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/13/SPOT4-HRVIR1-XS_20000713-102405-749_L1C_049-261-6_D_V1-0/SPOT4-HRVIR1-XS_20000713-102405-749_L1C_049-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000713-102405-749_L1C_049-261-6_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000713-102405-749_L1C_049-261-6_D_V1-0.zip
run script
2024-01-10T02:50:17.600    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:50:17.602    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000713-102405-749_L1C_049-261-6_D_V1-0.zip
2024-01-10T02:50:17.602    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:50:17.602    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:50:17.602    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:50:17.602    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:50:17.602    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:50:17.602    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:50:17.602    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:50:17.602    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000713-102405-749_L1C_049-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/13/SPOT4-HRVIR2-XS_20000713-102324-934_L1C_050-256-8_D_V1-0/SPOT4-HRVIR2-XS_20000713-102324-934_L1C_050-256-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000713-102324-934_L1C_050-256-8_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000713-102324-934_L1C_050-256-8_D_V1-0.zip
run script
2024-01-10T02:50:20.967    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:50:20.967    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000713-102324-934_L1C_050-256-8_D_V1-0.zip
2024-01-10T02:50:20.967    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:50:20.967    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:50:20.967    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:50:20.967    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:50:20.967    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:50:20.968    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:50:20.968    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:50:20.968    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000713-102324-934_L1C_050-256-8_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/13/SPOT4-HRVIR2-XS_20000713-102325-929_L1C_050-257-0_D_V1-0/SPOT4-HRVIR2-XS_20000713-102325-929_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000713-102325-929_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000713-102325-929_L1C_050-257-0_D_V1-0.zip
run script
2024-01-10T02:53:30.052    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:53:30.053    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000713-102325-929_L1C_050-257-0_D_V1-0.zip
2024-01-10T02:53:30.054    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:53:30.054    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:53:30.054    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:53:30.054    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:53:30.054    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:53:30.054    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:53:30.054    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:53:30.054    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000713-102325-929_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/13/SPOT4-HRVIR2-XS_20000713-102334-156_L1C_050-258-0_D_V1-0/SPOT4-HRVIR2-XS_20000713-102334-156_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000713-102334-156_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000713-102334-156_L1C_050-258-0_D_V1-0.zip
run script
2024-01-10T02:56:37.147    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:56:37.149    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000713-102334-156_L1C_050-258-0_D_V1-0.zip
2024-01-10T02:56:37.149    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:56:37.149    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:56:37.149    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:56:37.149    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:56:37.149    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:56:37.149    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:56:37.149    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:56:37.149    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T02:58:35.896    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 506). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000713-102334-156_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/07/13/SPOT4-HRVIR2-XS_20000713-102342-392_L1C_050-259-0_D_V1-0/SPOT4-HRVIR2-XS_20000713-102342-392_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000713-102342-392_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000713-102342-392_L1C_050-259-0_D_V1-0.zip
run script
2024-01-10T02:58:39.577    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T02:58:39.577    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000713-102342-392_L1C_050-259-0_D_V1-0.zip
2024-01-10T02:58:39.577    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T02:58:39.577    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T02:58:39.577    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T02:58:39.577    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T02:58:39.577    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T02:58:39.577    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T02:58:39.578    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T02:58:39.578    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000713-102342-392_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/13/SPOT4-HRVIR2-XS_20000713-102350-637_L1C_050-260-0_D_V1-0/SPOT4-HRVIR2-XS_20000713-102350-637_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000713-102350-637_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000713-102350-637_L1C_050-260-0_D_V1-0.zip
run script
2024-01-10T03:00:51.053    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T03:00:51.054    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000713-102350-637_L1C_050-260-0_D_V1-0.zip
2024-01-10T03:00:51.054    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T03:00:51.054    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T03:00:51.054    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T03:00:51.054    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T03:00:51.054    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T03:00:51.054    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T03:00:51.054    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T03:00:51.054    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000713-102350-637_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/23/SPOT4-HRVIR1-XS_20000723-103147-481_L1C_049-261-2_D_V1-0/SPOT4-HRVIR1-XS_20000723-103147-481_L1C_049-261-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000723-103147-481_L1C_049-261-2_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000723-103147-481_L1C_049-261-2_D_V1-0.zip
run script
2024-01-10T03:02:26.677    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T03:02:26.678    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000723-103147-481_L1C_049-261-2_D_V1-0.zip
2024-01-10T03:02:26.678    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T03:02:26.678    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T03:02:26.678    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T03:02:26.678    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T03:02:26.678    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T03:02:26.678    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T03:02:26.679    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T03:02:26.679    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000723-103147-481_L1C_049-261-2_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/23/SPOT4-HRVIR1-XS_20000723-103151-090_L1C_049-261-6_D_V1-0/SPOT4-HRVIR1-XS_20000723-103151-090_L1C_049-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000723-103151-090_L1C_049-261-6_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000723-103151-090_L1C_049-261-6_D_V1-0.zip
run script
2024-01-10T03:02:29.990    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T03:02:29.991    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000723-103151-090_L1C_049-261-6_D_V1-0.zip
2024-01-10T03:02:29.991    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T03:02:29.991    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T03:02:29.991    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T03:02:29.992    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T03:02:29.992    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T03:02:29.992    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T03:02:29.992    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T03:02:29.992    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000723-103151-090_L1C_049-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/02/27/SPOT4-HRVIR1-XS_20000227-105729-336_L1C_050-254-0_D_V1-0/SPOT4-HRVIR1-XS_20000227-105729-336_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000227-105729-336_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000227-105729-336_L1C_050-254-0_D_V1-0.zip
run script
2024-01-10T03:02:33.699    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T03:02:33.699    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000227-105729-336_L1C_050-254-0_D_V1-0.zip
2024-01-10T03:02:33.699    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T03:02:33.700    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T03:02:33.700    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T03:02:33.700    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T03:02:33.700    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T03:02:33.700    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T03:02:33.700    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T03:02:33.700    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000227-105729-336_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/03/05/SPOT4-HRVIR1-XS_20000305-102247-557_L1C_050-254-0_D_V1-0/SPOT4-HRVIR1-XS_20000305-102247-557_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000305-102247-557_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000305-102247-557_L1C_050-254-0_D_V1-0.zip
run script
2024-01-10T03:02:37.054    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T03:02:37.054    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000305-102247-557_L1C_050-254-0_D_V1-0.zip
2024-01-10T03:02:37.054    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T03:02:37.054    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T03:02:37.055    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T03:02:37.055    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T03:02:37.055    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T03:02:37.055    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T03:02:37.055    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T03:02:37.055    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000305-102247-557_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/03/05/SPOT4-HRVIR2-XS_20000305-102359-971_L1C_051-262-8_D_V1-0/SPOT4-HRVIR2-XS_20000305-102359-971_L1C_051-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000305-102359-971_L1C_051-262-8_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000305-102359-971_L1C_051-262-8_D_V1-0.zip
run script
2024-01-10T03:02:40.270    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T03:02:40.270    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000305-102359-971_L1C_051-262-8_D_V1-0.zip
2024-01-10T03:02:40.270    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T03:02:40.270    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T03:02:40.270    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T03:02:40.270    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T03:02:40.270    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T03:02:40.270    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T03:02:40.270    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T03:02:40.270    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000305-102359-971_L1C_051-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/03/05/SPOT4-HRVIR2-XS_20000305-102401-027_L1C_051-263-0_D_V1-0/SPOT4-HRVIR2-XS_20000305-102401-027_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000305-102401-027_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000305-102401-027_L1C_051-263-0_D_V1-0.zip
run script
2024-01-10T03:03:46.774    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T03:03:46.775    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000305-102401-027_L1C_051-263-0_D_V1-0.zip
2024-01-10T03:03:46.775    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T03:03:46.775    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T03:03:46.775    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T03:03:46.775    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T03:03:46.775    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T03:03:46.775    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T03:03:46.775    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T03:03:46.775    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000305-102401-027_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/03/05/SPOT4-HRVIR2-XS_20000305-102326-400_L1C_053-259-0_D_V1-0/SPOT4-HRVIR2-XS_20000305-102326-400_L1C_053-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000305-102326-400_L1C_053-259-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000305-102326-400_L1C_053-259-0_D_V1-0.zip
run script
2024-01-10T03:04:37.817    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T03:04:37.819    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000305-102326-400_L1C_053-259-0_D_V1-0.zip
2024-01-10T03:04:37.819    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T03:04:37.819    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T03:04:37.819    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T03:04:37.819    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T03:04:37.819    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T03:04:37.819    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T03:04:37.819    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T03:04:37.819    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000305-102326-400_L1C_053-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/03/05/SPOT4-HRVIR2-XS_20000305-102334-663_L1C_053-260-0_D_V1-0/SPOT4-HRVIR2-XS_20000305-102334-663_L1C_053-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000305-102334-663_L1C_053-260-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000305-102334-663_L1C_053-260-0_D_V1-0.zip
run script
2024-01-10T03:07:00.921    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T03:07:00.922    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000305-102334-663_L1C_053-260-0_D_V1-0.zip
2024-01-10T03:07:00.922    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T03:07:00.923    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T03:07:00.923    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T03:07:00.923    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T03:07:00.923    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T03:07:00.923    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T03:07:00.923    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T03:07:00.923    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000305-102334-663_L1C_053-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/03/05/SPOT4-HRVIR2-XS_20000305-102340-980_L1C_053-260-7_D_V1-0/SPOT4-HRVIR2-XS_20000305-102340-980_L1C_053-260-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000305-102340-980_L1C_053-260-7_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000305-102340-980_L1C_053-260-7_D_V1-0.zip
run script
2024-01-10T03:09:19.260    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T03:09:19.261    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000305-102340-980_L1C_053-260-7_D_V1-0.zip
2024-01-10T03:09:19.261    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T03:09:19.261    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T03:09:19.261    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T03:09:19.261    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T03:09:19.262    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T03:09:19.262    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T03:09:19.262    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T03:09:19.262    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000305-102340-980_L1C_053-260-7_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/02/03/SPOT4-HRVIR1-XS_20000203-101857-418_L1C_050-255-4_D_V1-0/SPOT4-HRVIR1-XS_20000203-101857-418_L1C_050-255-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000203-101857-418_L1C_050-255-4_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000203-101857-418_L1C_050-255-4_D_V1-0.zip
run script
2024-01-10T03:12:08.049    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T03:12:08.050    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000203-101857-418_L1C_050-255-4_D_V1-0.zip
2024-01-10T03:12:08.050    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T03:12:08.050    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T03:12:08.050    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T03:12:08.051    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T03:12:08.051    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T03:12:08.051    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T03:12:08.051    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T03:12:08.051    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000203-101857-418_L1C_050-255-4_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/02/03/SPOT4-HRVIR1-XS_20000203-101902-005_L1C_050-256-0_D_V1-0/SPOT4-HRVIR1-XS_20000203-101902-005_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000203-101902-005_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000203-101902-005_L1C_050-256-0_D_V1-0.zip
run script
2024-01-10T03:14:11.261    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T03:14:11.262    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000203-101902-005_L1C_050-256-0_D_V1-0.zip
2024-01-10T03:14:11.262    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T03:14:11.262    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T03:14:11.262    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T03:14:11.263    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T03:14:11.263    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T03:14:11.263    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T03:14:11.263    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T03:14:11.263    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000203-101902-005_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/02/03/SPOT4-HRVIR1-XS_20000203-101906-517_L1C_050-256-5_D_V1-0/SPOT4-HRVIR1-XS_20000203-101906-517_L1C_050-256-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000203-101906-517_L1C_050-256-5_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000203-101906-517_L1C_050-256-5_D_V1-0.zip
run script
2024-01-10T03:17:32.831    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T03:17:32.832    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000203-101906-517_L1C_050-256-5_D_V1-0.zip
2024-01-10T03:17:32.832    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T03:17:32.832    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T03:17:32.832    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T03:17:32.832    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T03:17:32.833    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T03:17:32.833    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T03:17:32.833    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T03:17:32.833    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T03:19:53.091    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 240). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000203-101906-517_L1C_050-256-5_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/06/12/SPOT4-HRVIR1-XS_20000612-101945-177_L1C_050-257-7_D_V1-0/SPOT4-HRVIR1-XS_20000612-101945-177_L1C_050-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000612-101945-177_L1C_050-257-7_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000612-101945-177_L1C_050-257-7_D_V1-0.zip
run script
2024-01-10T03:19:56.337    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T03:19:56.339    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000612-101945-177_L1C_050-257-7_D_V1-0.zip
2024-01-10T03:19:56.339    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T03:19:56.339    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T03:19:56.339    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T03:19:56.339    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T03:19:56.339    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T03:19:56.339    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T03:19:56.339    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T03:19:56.339    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000612-101945-177_L1C_050-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/12/SPOT4-HRVIR1-XS_20000612-101947-079_L1C_050-258-0_D_V1-0/SPOT4-HRVIR1-XS_20000612-101947-079_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000612-101947-079_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000612-101947-079_L1C_050-258-0_D_V1-0.zip
run script
2024-01-10T03:22:56.691    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T03:22:56.692    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000612-101947-079_L1C_050-258-0_D_V1-0.zip
2024-01-10T03:22:56.692    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T03:22:56.692    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T03:22:56.693    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T03:22:56.693    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T03:22:56.693    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T03:22:56.693    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T03:22:56.693    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T03:22:56.693    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T03:25:09.715    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 534). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000612-101947-079_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/07/27/SPOT4-HRVIR1-XS_20000727-105425-964_L1C_050-257-8_D_V1-0/SPOT4-HRVIR1-XS_20000727-105425-964_L1C_050-257-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000727-105425-964_L1C_050-257-8_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000727-105425-964_L1C_050-257-8_D_V1-0.zip
run script
2024-01-10T03:25:12.947    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T03:25:12.949    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000727-105425-964_L1C_050-257-8_D_V1-0.zip
2024-01-10T03:25:12.949    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T03:25:12.949    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T03:25:12.949    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T03:25:12.949    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T03:25:12.949    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T03:25:12.949    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T03:25:12.949    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T03:25:12.949    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000727-105425-964_L1C_050-257-8_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/27/SPOT4-HRVIR1-XS_20000727-105427-137_L1C_050-258-0_D_V1-0/SPOT4-HRVIR1-XS_20000727-105427-137_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000727-105427-137_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000727-105427-137_L1C_050-258-0_D_V1-0.zip
run script
2024-01-10T03:28:07.583    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T03:28:07.584    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000727-105427-137_L1C_050-258-0_D_V1-0.zip
2024-01-10T03:28:07.584    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T03:28:07.584    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T03:28:07.584    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T03:28:07.585    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T03:28:07.585    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T03:28:07.585    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T03:28:07.585    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T03:28:07.585    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T03:30:12.351    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 474). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000727-105427-137_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/07/27/SPOT4-HRVIR1-XS_20000727-105435-538_L1C_050-259-0_D_V1-0/SPOT4-HRVIR1-XS_20000727-105435-538_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000727-105435-538_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000727-105435-538_L1C_050-259-0_D_V1-0.zip
run script
2024-01-10T03:30:15.726    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T03:30:15.727    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000727-105435-538_L1C_050-259-0_D_V1-0.zip
2024-01-10T03:30:15.727    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T03:30:15.727    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T03:30:15.727    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T03:30:15.727    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T03:30:15.727    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T03:30:15.728    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T03:30:15.728    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T03:30:15.728    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000727-105435-538_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/27/SPOT4-HRVIR1-XS_20000727-105437-343_L1C_050-259-2_D_V1-0/SPOT4-HRVIR1-XS_20000727-105437-343_L1C_050-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000727-105437-343_L1C_050-259-2_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000727-105437-343_L1C_050-259-2_D_V1-0.zip
run script
2024-01-10T03:32:14.702    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T03:32:14.703    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000727-105437-343_L1C_050-259-2_D_V1-0.zip
2024-01-10T03:32:14.704    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T03:32:14.704    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T03:32:14.704    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T03:32:14.704    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T03:32:14.704    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T03:32:14.704    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T03:32:14.704    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T03:32:14.704    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000727-105437-343_L1C_050-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/06/SPOT4-HRVIR2-XS_20000806-110202-722_L1C_050-257-6_D_V1-0/SPOT4-HRVIR2-XS_20000806-110202-722_L1C_050-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000806-110202-722_L1C_050-257-6_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000806-110202-722_L1C_050-257-6_D_V1-0.zip
run script
2024-01-10T03:34:11.771    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T03:34:11.773    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000806-110202-722_L1C_050-257-6_D_V1-0.zip
2024-01-10T03:34:11.773    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T03:34:11.773    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T03:34:11.773    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T03:34:11.773    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T03:34:11.773    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T03:34:11.773    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T03:34:11.773    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T03:34:11.773    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000806-110202-722_L1C_050-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/06/SPOT4-HRVIR2-XS_20000806-110205-773_L1C_050-258-0_D_V1-0/SPOT4-HRVIR2-XS_20000806-110205-773_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000806-110205-773_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000806-110205-773_L1C_050-258-0_D_V1-0.zip
run script
2024-01-10T03:38:00.452    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T03:38:00.453    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000806-110205-773_L1C_050-258-0_D_V1-0.zip
2024-01-10T03:38:00.453    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T03:38:00.453    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T03:38:00.453    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T03:38:00.453    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T03:38:00.453    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T03:38:00.453    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T03:38:00.453    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T03:38:00.453    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T03:41:23.646    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 354). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000806-110205-773_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/06/SPOT4-HRVIR2-XS_20000806-110214-243_L1C_050-259-0_D_V1-0/SPOT4-HRVIR2-XS_20000806-110214-243_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000806-110214-243_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000806-110214-243_L1C_050-259-0_D_V1-0.zip
run script
2024-01-10T03:41:26.894    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T03:41:26.894    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000806-110214-243_L1C_050-259-0_D_V1-0.zip
2024-01-10T03:41:26.895    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T03:41:26.895    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T03:41:26.895    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T03:41:26.895    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T03:41:26.895    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T03:41:26.895    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T03:41:26.895    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T03:41:26.895    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000806-110214-243_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/06/SPOT4-HRVIR2-XS_20000806-110216-048_L1C_050-259-2_D_V1-0/SPOT4-HRVIR2-XS_20000806-110216-048_L1C_050-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000806-110216-048_L1C_050-259-2_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000806-110216-048_L1C_050-259-2_D_V1-0.zip
run script
2024-01-10T03:44:05.931    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T03:44:05.932    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000806-110216-048_L1C_050-259-2_D_V1-0.zip
2024-01-10T03:44:05.932    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T03:44:05.932    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T03:44:05.932    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T03:44:05.933    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T03:44:05.933    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T03:44:05.933    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T03:44:05.933    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T03:44:05.933    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000806-110216-048_L1C_050-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/07/SPOT4-HRVIR2-XS_20000807-104248-233_L1C_050-257-7_D_V1-0/SPOT4-HRVIR2-XS_20000807-104248-233_L1C_050-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000807-104248-233_L1C_050-257-7_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000807-104248-233_L1C_050-257-7_D_V1-0.zip
run script
2024-01-10T03:46:32.447    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T03:46:32.449    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000807-104248-233_L1C_050-257-7_D_V1-0.zip
2024-01-10T03:46:32.449    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T03:46:32.449    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T03:46:32.449    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T03:46:32.449    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T03:46:32.449    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T03:46:32.449    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T03:46:32.449    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T03:46:32.449    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000807-104248-233_L1C_050-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/07/SPOT4-HRVIR2-XS_20000807-104250-230_L1C_050-258-0_D_V1-0/SPOT4-HRVIR2-XS_20000807-104250-230_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000807-104250-230_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000807-104250-230_L1C_050-258-0_D_V1-0.zip
run script
2024-01-10T03:49:02.785    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T03:49:02.786    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000807-104250-230_L1C_050-258-0_D_V1-0.zip
2024-01-10T03:49:02.787    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T03:49:02.787    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T03:49:02.787    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T03:49:02.787    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T03:49:02.787    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T03:49:02.787    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T03:49:02.787    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T03:49:02.787    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T03:50:47.757    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 440). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000807-104250-230_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/07/SPOT4-HRVIR2-XS_20000807-104258-547_L1C_050-259-0_D_V1-0/SPOT4-HRVIR2-XS_20000807-104258-547_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000807-104258-547_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000807-104258-547_L1C_050-259-0_D_V1-0.zip
run script
2024-01-10T03:50:51.791    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T03:50:51.793    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000807-104258-547_L1C_050-259-0_D_V1-0.zip
2024-01-10T03:50:51.793    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T03:50:51.793    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T03:50:51.793    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T03:50:51.793    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T03:50:51.793    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T03:50:51.793    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T03:50:51.793    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T03:50:51.793    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000807-104258-547_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/07/SPOT4-HRVIR2-XS_20000807-104300-352_L1C_050-259-2_D_V1-0/SPOT4-HRVIR2-XS_20000807-104300-352_L1C_050-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000807-104300-352_L1C_050-259-2_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000807-104300-352_L1C_050-259-2_D_V1-0.zip
run script
2024-01-10T03:52:45.687    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T03:52:45.689    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000807-104300-352_L1C_050-259-2_D_V1-0.zip
2024-01-10T03:52:45.689    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T03:52:45.689    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T03:52:45.689    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T03:52:45.689    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T03:52:45.689    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T03:52:45.689    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T03:52:45.689    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T03:52:45.689    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000807-104300-352_L1C_050-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/08/SPOT4-HRVIR2-XS_20000808-102329-146_L1C_050-257-7_D_V1-0/SPOT4-HRVIR2-XS_20000808-102329-146_L1C_050-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000808-102329-146_L1C_050-257-7_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000808-102329-146_L1C_050-257-7_D_V1-0.zip
run script
2024-01-10T03:54:35.184    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T03:54:35.186    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000808-102329-146_L1C_050-257-7_D_V1-0.zip
2024-01-10T03:54:35.186    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T03:54:35.186    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T03:54:35.186    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T03:54:35.186    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T03:54:35.186    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T03:54:35.186    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T03:54:35.186    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T03:54:35.186    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000808-102329-146_L1C_050-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/08/SPOT4-HRVIR2-XS_20000808-102331-054_L1C_050-258-0_D_V1-0/SPOT4-HRVIR2-XS_20000808-102331-054_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000808-102331-054_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000808-102331-054_L1C_050-258-0_D_V1-0.zip
run script
2024-01-10T03:57:25.994    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T03:57:25.995    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000808-102331-054_L1C_050-258-0_D_V1-0.zip
2024-01-10T03:57:25.995    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T03:57:25.996    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T03:57:25.996    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T03:57:25.996    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T03:57:25.996    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T03:57:25.996    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T03:57:25.996    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T03:57:25.996    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T03:59:32.170    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 510). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000808-102331-054_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/08/SPOT4-HRVIR2-XS_20000808-102339-289_L1C_050-259-0_D_V1-0/SPOT4-HRVIR2-XS_20000808-102339-289_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000808-102339-289_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000808-102339-289_L1C_050-259-0_D_V1-0.zip
run script
2024-01-10T03:59:35.797    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T03:59:35.798    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000808-102339-289_L1C_050-259-0_D_V1-0.zip
2024-01-10T03:59:35.798    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T03:59:35.798    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T03:59:35.798    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T03:59:35.798    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T03:59:35.798    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T03:59:35.798    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T03:59:35.798    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T03:59:35.798    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000808-102339-289_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/08/SPOT4-HRVIR2-XS_20000808-102341-094_L1C_050-259-2_D_V1-0/SPOT4-HRVIR2-XS_20000808-102341-094_L1C_050-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000808-102341-094_L1C_050-259-2_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000808-102341-094_L1C_050-259-2_D_V1-0.zip
run script
2024-01-10T04:01:49.527    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T04:01:49.528    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000808-102341-094_L1C_050-259-2_D_V1-0.zip
2024-01-10T04:01:49.528    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T04:01:49.529    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T04:01:49.529    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T04:01:49.529    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T04:01:49.529    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T04:01:49.529    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T04:01:49.529    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T04:01:49.529    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T04:03:46.988    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (132 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000808-102341-094_L1C_050-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/08/SPOT4-HRVIR1-XS_20000808-102313-707_L1C_051-256-0_D_V1-0/SPOT4-HRVIR1-XS_20000808-102313-707_L1C_051-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000808-102313-707_L1C_051-256-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000808-102313-707_L1C_051-256-0_D_V1-0.zip
run script
2024-01-10T04:03:50.317    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T04:03:50.318    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000808-102313-707_L1C_051-256-0_D_V1-0.zip
2024-01-10T04:03:50.319    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T04:03:50.319    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T04:03:50.319    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T04:03:50.319    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T04:03:50.319    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T04:03:50.319    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T04:03:50.319    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T04:03:50.319    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000808-102313-707_L1C_051-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/08/SPOT4-HRVIR2-XS_20000808-102403-795_L1C_051-262-0_D_V1-0/SPOT4-HRVIR2-XS_20000808-102403-795_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000808-102403-795_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000808-102403-795_L1C_051-262-0_D_V1-0.zip
run script
2024-01-10T04:06:59.166    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T04:06:59.168    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000808-102403-795_L1C_051-262-0_D_V1-0.zip
2024-01-10T04:06:59.168    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T04:06:59.168    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T04:06:59.168    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T04:06:59.168    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T04:06:59.168    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T04:06:59.168    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T04:06:59.168    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T04:06:59.168    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000808-102403-795_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/08/SPOT4-HRVIR2-XS_20000808-102412-067_L1C_051-263-0_D_V1-0/SPOT4-HRVIR2-XS_20000808-102412-067_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000808-102412-067_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000808-102412-067_L1C_051-263-0_D_V1-0.zip
run script
2024-01-10T04:08:26.962    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T04:08:26.963    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000808-102412-067_L1C_051-263-0_D_V1-0.zip
2024-01-10T04:08:26.963    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T04:08:26.964    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T04:08:26.964    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T04:08:26.964    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T04:08:26.964    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T04:08:26.964    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T04:08:26.964    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T04:08:26.964    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000808-102412-067_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/08/SPOT4-HRVIR1-XS_20000808-102351-533_L1C_054-260-8_D_V1-0/SPOT4-HRVIR1-XS_20000808-102351-533_L1C_054-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000808-102351-533_L1C_054-260-8_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000808-102351-533_L1C_054-260-8_D_V1-0.zip
run script
2024-01-10T04:08:58.268    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T04:08:58.269    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000808-102351-533_L1C_054-260-8_D_V1-0.zip
2024-01-10T04:08:58.269    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T04:08:58.269    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T04:08:58.269    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T04:08:58.269    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T04:08:58.270    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T04:08:58.270    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T04:08:58.270    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T04:08:58.270    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T04:09:00.692    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (182 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000808-102351-533_L1C_054-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/08/SPOT4-HRVIR1-XS_20000808-102352-589_L1C_054-261-0_D_V1-0/SPOT4-HRVIR1-XS_20000808-102352-589_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000808-102352-589_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000808-102352-589_L1C_054-261-0_D_V1-0.zip
run script
2024-01-10T04:09:04.600    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T04:09:04.600    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000808-102352-589_L1C_054-261-0_D_V1-0.zip
2024-01-10T04:09:04.600    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T04:09:04.601    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T04:09:04.601    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T04:09:04.601    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T04:09:04.601    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T04:09:04.601    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T04:09:04.601    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T04:09:04.601    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000808-102352-589_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/12/SPOT4-HRVIR1-XS_20000812-104642-772_L1C_050-257-7_D_V1-0/SPOT4-HRVIR1-XS_20000812-104642-772_L1C_050-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000812-104642-772_L1C_050-257-7_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000812-104642-772_L1C_050-257-7_D_V1-0.zip
run script
2024-01-10T04:11:14.153    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T04:11:14.154    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000812-104642-772_L1C_050-257-7_D_V1-0.zip
2024-01-10T04:11:14.154    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T04:11:14.154    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T04:11:14.154    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T04:11:14.154    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T04:11:14.154    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T04:11:14.154    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T04:11:14.154    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T04:11:14.154    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000812-104642-772_L1C_050-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/12/SPOT4-HRVIR1-XS_20000812-104644-794_L1C_050-258-0_D_V1-0/SPOT4-HRVIR1-XS_20000812-104644-794_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000812-104644-794_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000812-104644-794_L1C_050-258-0_D_V1-0.zip
run script
2024-01-10T04:13:47.137    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T04:13:47.138    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000812-104644-794_L1C_050-258-0_D_V1-0.zip
2024-01-10T04:13:47.139    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T04:13:47.139    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T04:13:47.139    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T04:13:47.139    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T04:13:47.139    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T04:13:47.139    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T04:13:47.139    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T04:13:47.139    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T04:15:42.574    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 223). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000812-104644-794_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/12/SPOT4-HRVIR1-XS_20000812-104653-138_L1C_050-259-0_D_V1-0/SPOT4-HRVIR1-XS_20000812-104653-138_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000812-104653-138_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000812-104653-138_L1C_050-259-0_D_V1-0.zip
run script
2024-01-10T04:15:46.257    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T04:15:46.258    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000812-104653-138_L1C_050-259-0_D_V1-0.zip
2024-01-10T04:15:46.258    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T04:15:46.258    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T04:15:46.258    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T04:15:46.258    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T04:15:46.258    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T04:15:46.258    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T04:15:46.258    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T04:15:46.259    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000812-104653-138_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/12/SPOT4-HRVIR1-XS_20000812-104654-943_L1C_050-259-2_D_V1-0/SPOT4-HRVIR1-XS_20000812-104654-943_L1C_050-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000812-104654-943_L1C_050-259-2_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000812-104654-943_L1C_050-259-2_D_V1-0.zip
run script
2024-01-10T04:17:41.669    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T04:17:41.670    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000812-104654-943_L1C_050-259-2_D_V1-0.zip
2024-01-10T04:17:41.670    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T04:17:41.670    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T04:17:41.670    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T04:17:41.671    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T04:17:41.671    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T04:17:41.671    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T04:17:41.671    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T04:17:41.671    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000812-104654-943_L1C_050-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/23/SPOT4-HRVIR2-XS_20000823-103510-114_L1C_050-257-8_D_V1-0/SPOT4-HRVIR2-XS_20000823-103510-114_L1C_050-257-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000823-103510-114_L1C_050-257-8_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000823-103510-114_L1C_050-257-8_D_V1-0.zip
run script
2024-01-10T04:19:28.236    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T04:19:28.237    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000823-103510-114_L1C_050-257-8_D_V1-0.zip
2024-01-10T04:19:28.238    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T04:19:28.238    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T04:19:28.238    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T04:19:28.238    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T04:19:28.238    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T04:19:28.238    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T04:19:28.238    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T04:19:28.238    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000823-103510-114_L1C_050-257-8_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/23/SPOT4-HRVIR2-XS_20000823-103511-167_L1C_050-258-0_D_V1-0/SPOT4-HRVIR2-XS_20000823-103511-167_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000823-103511-167_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000823-103511-167_L1C_050-258-0_D_V1-0.zip
run script
2024-01-10T04:21:59.168    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T04:21:59.169    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000823-103511-167_L1C_050-258-0_D_V1-0.zip
2024-01-10T04:21:59.169    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T04:21:59.169    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T04:21:59.169    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T04:21:59.170    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T04:21:59.170    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T04:21:59.170    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T04:21:59.170    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T04:21:59.170    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T04:23:46.204    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 444). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000823-103511-167_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/23/SPOT4-HRVIR2-XS_20000823-103519-448_L1C_050-259-0_D_V1-0/SPOT4-HRVIR2-XS_20000823-103519-448_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000823-103519-448_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000823-103519-448_L1C_050-259-0_D_V1-0.zip
run script
2024-01-10T04:23:49.649    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T04:23:49.651    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000823-103519-448_L1C_050-259-0_D_V1-0.zip
2024-01-10T04:23:49.651    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T04:23:49.651    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T04:23:49.651    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T04:23:49.651    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T04:23:49.651    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T04:23:49.651    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T04:23:49.651    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T04:23:49.651    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000823-103519-448_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/23/SPOT4-HRVIR2-XS_20000823-103521-253_L1C_050-259-2_D_V1-0/SPOT4-HRVIR2-XS_20000823-103521-253_L1C_050-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000823-103521-253_L1C_050-259-2_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000823-103521-253_L1C_050-259-2_D_V1-0.zip
run script
2024-01-10T04:26:01.780    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T04:26:01.781    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000823-103521-253_L1C_050-259-2_D_V1-0.zip
2024-01-10T04:26:01.781    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T04:26:01.781    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T04:26:01.781    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T04:26:01.781    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T04:26:01.781    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T04:26:01.781    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T04:26:01.781    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T04:26:01.781    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T04:27:57.974    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (135 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000823-103521-253_L1C_050-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/07/12/SPOT4-HRVIR2-XS_20000712-104301-637_L1C_050-258-9_D_V1-0/SPOT4-HRVIR2-XS_20000712-104301-637_L1C_050-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000712-104301-637_L1C_050-258-9_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000712-104301-637_L1C_050-258-9_D_V1-0.zip
run script
2024-01-10T04:28:01.014    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T04:28:01.014    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000712-104301-637_L1C_050-258-9_D_V1-0.zip
2024-01-10T04:28:01.014    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T04:28:01.014    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T04:28:01.014    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T04:28:01.014    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T04:28:01.014    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T04:28:01.014    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T04:28:01.014    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T04:28:01.014    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000712-104301-637_L1C_050-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/12/SPOT4-HRVIR2-XS_20000712-104310-162_L1C_050-260-0_D_V1-0/SPOT4-HRVIR2-XS_20000712-104310-162_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000712-104310-162_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000712-104310-162_L1C_050-260-0_D_V1-0.zip
run script
2024-01-10T04:29:51.198    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T04:29:51.199    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000712-104310-162_L1C_050-260-0_D_V1-0.zip
2024-01-10T04:29:51.199    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T04:29:51.199    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T04:29:51.199    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T04:29:51.199    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T04:29:51.199    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T04:29:51.199    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T04:29:51.199    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T04:29:51.199    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000712-104310-162_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/17/SPOT4-HRVIR2-XS_20000817-105037-520_L1C_050-258-0_D_V1-0/SPOT4-HRVIR2-XS_20000817-105037-520_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000817-105037-520_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000817-105037-520_L1C_050-258-0_D_V1-0.zip
run script
2024-01-10T04:31:19.305    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T04:31:19.307    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000817-105037-520_L1C_050-258-0_D_V1-0.zip
2024-01-10T04:31:19.307    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T04:31:19.307    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T04:31:19.307    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T04:31:19.307    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T04:31:19.307    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T04:31:19.307    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T04:31:19.307    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T04:31:19.307    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T04:33:14.928    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 228). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000817-105037-520_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/17/SPOT4-HRVIR2-XS_20000817-105045-891_L1C_050-259-0_D_V1-0/SPOT4-HRVIR2-XS_20000817-105045-891_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000817-105045-891_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000817-105045-891_L1C_050-259-0_D_V1-0.zip
run script
2024-01-10T04:33:17.865    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T04:33:17.865    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000817-105045-891_L1C_050-259-0_D_V1-0.zip
2024-01-10T04:33:17.865    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T04:33:17.865    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T04:33:17.865    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T04:33:17.865    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T04:33:17.865    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T04:33:17.865    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T04:33:17.865    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T04:33:17.865    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T04:35:21.136    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (206 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000817-105045-891_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/17/SPOT4-HRVIR2-XS_20000817-105047-696_L1C_050-259-2_D_V1-0/SPOT4-HRVIR2-XS_20000817-105047-696_L1C_050-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000817-105047-696_L1C_050-259-2_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000817-105047-696_L1C_050-259-2_D_V1-0.zip
run script
2024-01-10T04:35:26.734    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T04:35:26.735    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000817-105047-696_L1C_050-259-2_D_V1-0.zip
2024-01-10T04:35:26.735    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T04:35:26.735    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T04:35:26.735    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T04:35:26.735    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T04:35:26.735    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T04:35:26.735    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T04:35:26.735    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T04:35:26.735    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR2-XS_20000817-105047-696_L1C_050-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/18/SPOT4-HRVIR1-XS_20000918-103512-163_L1C_050-258-8_D_V1-0/SPOT4-HRVIR1-XS_20000918-103512-163_L1C_050-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000918-103512-163_L1C_050-258-8_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000918-103512-163_L1C_050-258-8_D_V1-0.zip
run script
2024-01-10T04:37:22.197    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T04:37:22.198    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000918-103512-163_L1C_050-258-8_D_V1-0.zip
2024-01-10T04:37:22.198    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T04:37:22.198    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T04:37:22.198    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T04:37:22.198    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T04:37:22.198    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T04:37:22.198    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T04:37:22.198    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T04:37:22.198    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T04:39:21.727    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (144 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000918-103512-163_L1C_050-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/09/18/SPOT4-HRVIR1-XS_20000918-103513-222_L1C_050-259-0_D_V1-0/SPOT4-HRVIR1-XS_20000918-103513-222_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000918-103513-222_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000918-103513-222_L1C_050-259-0_D_V1-0.zip
run script
2024-01-10T04:39:25.338    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T04:39:25.339    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000918-103513-222_L1C_050-259-0_D_V1-0.zip
2024-01-10T04:39:25.339    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T04:39:25.339    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T04:39:25.339    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T04:39:25.339    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T04:39:25.340    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T04:39:25.340    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T04:39:25.340    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T04:39:25.340    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T04:41:21.575    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (198 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000918-103513-222_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/09/18/SPOT4-HRVIR1-XS_20000918-103521-509_L1C_050-260-0_D_V1-0/SPOT4-HRVIR1-XS_20000918-103521-509_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000918-103521-509_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000918-103521-509_L1C_050-260-0_D_V1-0.zip
run script
2024-01-10T04:41:25.165    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T04:41:25.165    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000918-103521-509_L1C_050-260-0_D_V1-0.zip
2024-01-10T04:41:25.165    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T04:41:25.165    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T04:41:25.165    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T04:41:25.165    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T04:41:25.165    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T04:41:25.165    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T04:41:25.165    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T04:41:25.165    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016258/INPUT/SPOT4-HRVIR1-XS_20000918-103521-509_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016258/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
end
[2024-01-10 04:42:49.631681979+00:00] cnes_level2/barrouz/4016258:  Account (env) = cnes_level2
[2024-01-10 04:42:49.632809308+00:00] cnes_level2/barrouz/4016258:     User (env) = barrouz
[2024-01-10 04:42:49.633900038+00:00] cnes_level2/barrouz/4016258:        GroupId = cesbio(426000053)
[2024-01-10 04:42:49.634997317+00:00] cnes_level2/barrouz/4016258:         UserId = barrouz(9134)
[2024-01-10 04:42:49.636073427+00:00] cnes_level2/barrouz/4016258:        Account = cnes_level2
[2024-01-10 04:42:49.637193327+00:00] cnes_level2/barrouz/4016258:        Account = cnes_level2
[2024-01-10 04:42:49.638272047+00:00] cnes_level2/barrouz/4016258:      Partition = cpu2022
[2024-01-10 04:42:49.639380716+00:00] cnes_level2/barrouz/4016258:            QOS = cpu_2022_1280
[2024-01-10 04:42:49.640463726+00:00] cnes_level2/barrouz/4016258:        JobName = inf_ALP_58_TCD-BLUE_AVG-1200
[2024-01-10 04:42:49.641566676+00:00] cnes_level2/barrouz/4016258:     SubmitTime = 2024-01-09T10:52:03
[2024-01-10 04:42:49.642639996+00:00] cnes_level2/barrouz/4016258:        RunTime = 05:57:55
[2024-01-10 04:42:49.643771365+00:00] cnes_level2/barrouz/4016258:      TimeLimit = 1-16:00:00
[2024-01-10 04:42:49.645005493+00:00] cnes_level2/barrouz/4016258:   EligibleTime = 2024-01-09T10:52:03
[2024-01-10 04:42:49.646149433+00:00] cnes_level2/barrouz/4016258:      StartTime = 2024-01-09T22:44:54
[2024-01-10 04:42:49.647343771+00:00] cnes_level2/barrouz/4016258:        EndTime = 2024-01-10T04:42:49
[2024-01-10 04:42:49.648477301+00:00] cnes_level2/barrouz/4016258:       ExitCode = 0:0
[2024-01-10 04:42:49.649624810+00:00] cnes_level2/barrouz/4016258:       NodeList = trex038
[2024-01-10 04:42:49.650781169+00:00] cnes_level2/barrouz/4016258:      BatchHost = trex038
[2024-01-10 04:42:49.651908739+00:00] cnes_level2/barrouz/4016258:           TRES = 
[2024-01-10 04:42:49.652997068+00:00] cnes_level2/barrouz/4016258:        Command = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
[2024-01-10 04:42:49.654100148+00:00] cnes_level2/barrouz/4016258:        WorkDir = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code
[2024-01-10 04:42:49.655204858+00:00] cnes_level2/barrouz/4016258:         StdErr = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_58_TCD-BLUE_AVG-1200.log
[2024-01-10 04:42:49.656314767+00:00] cnes_level2/barrouz/4016258:         StdOut = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_58_TCD-BLUE_AVG-1200.log

#########################################
#        EVIDEN - CNES                  #
#        Job Accounting                 #
#########################################
Cluster              : trex
JobIDRaw             : 4016258
JobID                : 4016258
JobName              : inf_ALP_58_TCD-BLUE_AVG-1200
Account              : cnes_level2
User                 : barrouz(9134), cesbio(426000053)
Partition            : cpu2022
QOS                  : cpu_2022_1280
Nodelist             : trex038 (1)
State                : COMPLETED  (Exitcode=0:0, DerivedExitCode=0:0, Restarts=0)
Submit date          : 2024-01-09T10:52:03
Start time           : 2024-01-09T22:44:54
End time             : 2024-01-10T04:42:49
Elapsed time         : 05:57:55  (Timelimit=1-16:00:00, Suspended=00:00:00)
TEI                  : 1 day, 23:43:20
Command              : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
StdOut               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_58_TCD-BLUE_AVG-1200.log
StdErr               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_58_TCD-BLUE_AVG-1200.log

STEP(s) : 2
--------- 
   StepID  | JobName      State       Exit   Start               End                 Elapsed   TotalCPU   CPUTime    ConsumedEnergy MaxDiskRead MaxDiskWrite     MaxRSS MaxRSSTask MaxRSSNode NNodes UserCPU    NodeList
   ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 
   batch   | batch        COMPLETED   0:0    2024-01-09T22:44:54 2024-01-10T04:42:49 05:57:55  1-02:58:37 1-23:43:20       3.24125M  178580.24M    75498.09M  99566936K          0    trex038      1 17:40:51   trex038
   extern  | extern       COMPLETED   0:0    2024-01-09T22:44:54 2024-01-10T04:42:49 05:57:55  00:00.001  1-23:43:20        3.2375M       0.00M        0.00M      1696K          0    trex038      1 00:00:00   trex038

